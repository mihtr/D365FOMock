"use strict";var floatingTableHeader;!function(){try{return new window.CustomEvent("t")}catch(e){}function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var o=document.createEvent("CustomEvent");return o.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),o}e.prototype=window.Event.prototype,window.CustomEvent=e}(),Element.prototype.scrollIntoViewIfNeeded||(Element.prototype.scrollIntoViewIfNeeded=function(o){for(var e,t=function(e,t){return{start:e,length:t,end:e+t}},n=function(e,t){return!1===o||t.start<e.end&&e.start<t.end?Math.max(e.end-t.length,Math.min(t.start,e.start)):(e.start+e.end-t.length)/2},i=function(o,n){return{translate:function(e,t){return i(o+e,n+t)},x:o,y:n}},r=function(e,t){for(;e;)t=t.translate(e.offsetLeft,e.offsetTop),e=e.offsetParent;return t},a=r(this,i(0,0)),s=this.parentNode,l=i(this.offsetWidth,this.offsetHeight);s instanceof HTMLElement;)e=r(s,i(s.clientLeft,s.clientTop)),s.scrollLeft=n(t(a.x-e.x,l.x),t(s.scrollLeft,s.clientWidth)),s.scrollTop=n(t(a.y-e.y,l.y),t(s.scrollTop,s.clientHeight)),a=a.translate(-s.scrollLeft,-s.scrollTop),s=s.parentNode}),SVGElement.prototype.contains||(SVGElement.prototype.contains=HTMLDivElement.prototype.contains),function(){function d(e){return"function"==typeof e||"[object Function]"===t.call(e)}function c(e){var t,o=(t=Number(e),isNaN(t)?0:0!==t&&isFinite(t)?(0<t?1:-1)*Math.floor(Math.abs(t)):t);return Math.min(Math.max(o,0),n)}var t,n;Array.from||(Array.from=(t=Object.prototype.toString,n=Math.pow(2,53)-1,function(e,t,o){var n=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var i,r=1<arguments.length?t:void 0;if(void 0!==r){if(!d(r))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(i=o)}for(var a,s=c(n.length),l=d(this)?Object(new this(s)):new Array(s),u=0;u<s;)a=n[u],l[u]=r?void 0===i?r(a,u):r.call(i,a,u):a,u+=1;return l.length=s,l})),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var o=Object(this),n=o.length>>>0;if(0==n)return!1;for(var i=0|t,r=Math.max(0<=i?i:n-Math.abs(i),0);r<n;){if(o[r]===e)return!0;r++}return!1}})}(),"isConnected"in Node.prototype||Object.defineProperty(Node.prototype,"isConnected",{get:function(){return!(this.ownerDocument&&this.ownerDocument.compareDocumentPosition(this)&this.DOCUMENT_POSITION_DISCONNECTED)}}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e}),function(r){r.ErrorWrongTypeForAssociatedDataTableObject="Unsupported type provided for the 'associatedDataTableObject' parameter.",r.ErrorHeaderAndCellCountMismatch="The number of headers and cells elements must match between the target header table and source data table, headers count: {0}, cells count: {1}.",r.ErrorMeasureModePluginMissing="The measure plugin (enterMeasureMode and leaveMeasureMode functions) is required by the floatingTableHeader plugin.",r.createWrapperIfNecessary=function(){if(0===jQuery("> .columnHeaderWrapper",this).length){var e=jQuery(this),t=e.contents(),o=jQuery("<div class='columnHeaderWrapper'/>").resizable({handles:"e",zIndex:"auto"});e.append(o),o.append(t)}},jQuery.fn.extend({layoutFloatingTableHeader:function(o){if(o&&1===o.length){$dyn.debug.gridLayout&&document.body.classList.remove("debugGridLayout");var n=!o[0].hasAttribute("data-dyn-isTable"),e=$("> * > .listItem",o).last(),t="> .listCell:not(.repeater-template,.overlayhost)";n&&(t+=":visible");var a=jQuery(t,e),s=(i=[],function(e){return void 0===i[e]&&(i[e]=a[e].clientWidth),i[e]});jQuery.each(this,function(){var e=".columnHeader:not(.repeater-template)";n&&(e+=":visible");var t=jQuery(e,jQuery(this));t.length===a.length?(jQuery.each(t,r.createWrapperIfNecessary),jQuery.each(t,function(e){!function(e,t){var o=t.attr("data-dyn-explicitcolumnwidth"),n=parseInt(o,10);if(isNaN(n)){if($dyn&&$dyn.layout.sizing.isDiscreteSize(o)){if(jQuery("> .columnHeaderWrapper",t).width(""),$dyn.debug.gridLayout){i=jQuery(t).css("width"),r=jQuery(a[e]).css("width");$dyn.log('Grid: header layout: column - index: %s, header width: %s column width: %s, discrete(%s),%c %s:"%s""',e,i,r,o,i!==r?"background-color:red":"",a[e].getAttribute("data-dyn-controlname"),t.text().trim())}}else if(jQuery("> .columnHeaderWrapper",t).width(s(e)),$dyn.debug.gridLayout){var i=jQuery(t).css("width"),r=jQuery(a[e]).css("width");$dyn.debug.gridLayout&&$dyn.log('Grid: header layout: column - index: %s, header width: %s, column width: %s, calculated, %c %s:"%s"',e,i,r,i!==r?"background-color:red":"",a[e].getAttribute("data-dyn-controlname"),t.text().trim())}}else if(jQuery("> .columnHeaderWrapper",t).width(n),$dyn.debug.gridLayout){i=jQuery(t).css("width"),r=jQuery(a[e]).css("width");$dyn.log('Grid: header layout: column - index: %s, header width: %s, column width: %s, explicit(%s), %c %s:"%s""',e,i,r,n,o,i!==r?"background-color:red":"",a[e].getAttribute("data-dyn-controlname"),t.text().trim())}}(parseInt(e,10),jQuery(this))}),o.attr("data-dyn-headerstate","layout-complete")):0!==a.length&&(o.attr("data-dyn-headerstate","render-error"),$dyn.logError($dyn.format(r.ErrorHeaderAndCellCountMismatch,t.length,a.length)),$dyn.debug.general&&r._debugHeaderMismatch(t,o))}),$dyn.debug.gridLayout&&document.body.classList.add("debugGridLayout")}var i;return this}}),r._debugHeaderMismatch=function(e,t){$dyn.log(""),$dyn.log("Headers:"),e.each(function(e,t){var o=t.getAttribute("data-dyn-columnname")||"[anonymous]";$dyn.log($dyn.format("{0} {1}",e,o))}),$dyn.log(""),$dyn.log("Cells:");var o=$(".listItem").find(t).first();$.each($(".listCell",o),function(e,t){var o="[anonymous]";t&&(o=t.getAttribute("data-dyn-controlname")||o,$dyn.log($dyn.format("{0} {1}",e,o)))}),$dyn.log("")}}(floatingTableHeader=floatingTableHeader||{});var __values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=this&&this.__read||function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,i,r=o.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=r.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(o=r.return)&&o.call(r)}finally{if(i)throw i.error}}return a},__spreadArray=this&&this.__spreadArray||function(e,t,o){if(o||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||((n=n||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))};!function(h){var e,t;function o(){var p=this;this.addFlyout=function(e){0===p.flyoutStack.length&&(document.body.addEventListener("click",h.flyout.flyoutManager.bodyClickHandler,!0),document.body.addEventListener("mousedown",h.flyout.flyoutManager.mouseDownHandler,!0),document.body.addEventListener("keydown",h.util.flyout.keyDownHandler,!0)),p.flyoutStack.push(e)},this.getAllFlyoutElementsByParentFormId=function(e){return p.findAllFlyoutsByParentFormId(e).map(function(e){return h.value(e.flyout)[0]})},this.closeAllFlyoutsByParentFormId=function(e){var t,o,n=p.findAllFlyoutsByParentFormId(e),i=[];if(n.length){var r=function(e){if(e){var t=$.Deferred();e.requestClose().done(function(){p.removeFlyout(e),t.resolve()}).fail(function(e){t.reject(e)}),i.push(t)}};try{for(var a=__values(n),s=a.next();!s.done;s=a.next()){r(s.value)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(t)throw t.error}}}return $.when.apply($,__spreadArray([],__read(i),!1))},this.getAllFlyoutElementsByFormId=function(e){return p.findAllFlyoutsByFormId(e).map(function(e){return h.value(e.flyout)[0]})},this.areAnyFlyoutsOpen=function(){return 0<p.flyoutStack.length},this.areAnyFlyoutsOpenByParentFormId=function(n){return!!p.flyoutStack.find(function(e){var t=h.value(e.flyout)[0],o=h.context(t);return o&&o.Root&&o.Root.Id===n})},this.getFlyoutContextByFormId=function(e){var t=p.getAllFlyoutElementsByFormId(e);if(0<t.length){var o=t[t.length-1];return h.context(o)}return null},this.getFlyoutCount=function(){return p.flyoutStack.length},this.getTopFlyout=function(){return p.flyoutStack[p.flyoutStack.length-1]},this.tryTakeNavigationFocus=function(e){var t=h.flyout.flyoutManager.getTopFlyout();if(t){var o=h.value(t.flyout);if(o&&o.length){var n=o[0],i=h.context(n);if(i&&i.__protoForm&&h.util.isRootedBy(e,i))return i.takeNavigationFocus()}}return!1},this.findFlyoutContainer=function(e){return $(e).closest(".sysPopup")},this.isContainedByFlyoutHierarchy=function(e,t){var o=!1,n=h.flyout.flyoutManager.findFlyoutContainer(t);if(1===n.length){var i=n[0],r=h.context(i),a=h.context(e);r===a||r.Root===a?o=!0:r.Root&&r.Root.element&&(o=p.isContainedByFlyoutHierarchy(e,r.Root.element))}return o},this.removeAllFlyoutsAsync=function(t){var e=p.flyoutStack.map(function(){return""}),o=function(e){if(!e)return!1;var t=p.getMouseClickInfo(e),o=h.flyout.flyoutManager.getTopFlyout();if(!o||!h.value(o.showFlyout))return!1;var n=h.value(o.flyout);return h.util.flyout.IsClickInFlyout(t.clickTarget,n,t.clickX,t.clickY)}(t),n=!!t&&h.util.flyout.wasLightboxClicked(t.target);return e.reduce(function(e){return e.done(function(){return p.removeTopFlyoutAsync(t,o,n)})},$.when())},this.removeFlyout=function(e){var t=p.flyoutStack.lastIndexOf(e);0<=t&&p.flyoutStack.splice(t,1),e.handle&&$(document.body).off(e.handle),e.tabbingHandlerDispose&&e.tabbingHandlerDispose(),0===p.flyoutStack.length&&($(document.body).off(".flyout"),document.body.removeEventListener("click",h.flyout.flyoutManager.bodyClickHandler,!0),document.body.removeEventListener("mousedown",h.flyout.flyoutManager.mouseDownHandler,!0),document.body.removeEventListener("keydown",h.util.flyout.keyDownHandler,!0),h.util.flyout.flyoutTimer&&(window.clearInterval(h.util.flyout.flyoutTimer),h.util.flyout.flyoutTimer=void 0))},this.removeFlyoutByElementId=function(t){var e=p.flyoutStack.filter(function(e){return h.value(e.flyout)[0].getAttribute("id")===t});if(0<e.length){var o=e[e.length-1];p.removeFlyout(o)}},this.removeTopFlyoutAsync=function(e,t,o){var n=$.Deferred();if(0===p.flyoutStack.length)return n.reject("No open flyouts"),n.promise();var i=p.flyoutStack[p.flyoutStack.length-1],r=!1;if(i){var a=h.value(i.flyout);if(a){var s=a[0];if(e){if(o&&!a.hasClass("lightbox-flyout"))return n.reject("Don't close flyout when clicking on lightbox"),n.promise();var l=p.getMouseClickInfo(e),u=h.value(i.showFlyout)&&h.util.flyout.IsClickInFlyout(l.clickTarget,a,l.clickX,l.clickY);if(!i.clickSubscriber({clickInsideTopFlyout:t||!1,clickTarget:l.clickTarget,clickX:l.clickX,clickY:l.clickY,closeCallback:void 0,flyoutElement:a,isClickInsideThisFlyout:u,isRightClick:l.isRightClick}))return n.reject("Flyout does not want to close"),n.promise();u||i.highlyResponsive||s&&s.classList&&!s.classList.contains("allowFlyoutClickPropagation")&&l.clickTarget&&l.clickTarget.classList&&!l.clickTarget.classList.contains("allowFlyoutClickPropagation")&&(e.stopImmediatePropagation(),e.preventDefault(),h.log.stopPropagation&&h.log.stopPropagation("Prevent mouse click event from bubbling to other flyouts."))}}else r=!0}else r=!0;return r?n.reject("Invalid flyout object"):i.requestClose().done(function(){p.removeFlyout(i),n.resolve()}).fail(function(e){n.reject(e)}),n.promise()},this.repositionAllFlyouts=function(){for(var e=p.flyoutStack.length-1;0<=e;e--){var t=h.value(p.flyoutStack[e]),o=null==t?void 0:t.options;if(o){var n=h.applyFunction(o.getAnchor)||o.of,i=t.target;!i&&t.getTarget&&(i=t.getTarget());var r=void 0;r=n&&n.target?$(n.target):n;for(var a=h.util.elementRectangle(r),s=o.scrollParents.length-1;0<=s;s--){var l=h.util.elementRectangle(o.scrollParents[s]);if(!h.util.isElementVisibleInParentContainer(a,l)){0<e?i?i.click():o.show&&o.show(!1):$(document.body).click();break}}var u=t.flyout();if(u){u.css("max-height",""),u.css("max-width",""),u.scrollTop(u.scrollTop());var d=o.getPadding?o.getPadding():o.padding,c=o.useAnchorWidthAsMaxWidth?r.outerWidth():void 0;h.util.resizeFlyoutToScreen(u,n,d,c),h.util.position(o,u)}}}},this.getFlyoutFocusRegion=function(e){var t=e.focusRegion,o=e.target;if(!o&&e.getTarget&&(o=e.getTarget()),void 0===t&&o&&0<o.length&&o[0]){if(!(t=o.closest(".binding-focusRegion")[0])&&1<p.flyoutStack.length)for(var n=p.flyoutStack.indexOf(e)-1;0<=n;n--){var i=p.flyoutStack[n];if(i){var r=h.value(i.flyout);if(r&&r[0]&&$.contains(r[0],o[0])){t=i.focusRegion;break}}}e.focusRegion=t||null}return t},this.isFlyoutInFocusTransferMode=function(e,t){if(e.options&&e.options.highlyResponsive&&e.options.focusTarget&&!h.value(e.options.takeFocus)&&e.options.flyout&&1===e.options.flyout.length){var o="function"==typeof e.options.focusTarget?e.options.focusTarget():e.options.focusTarget,n=e.options.flyout[0],i=h.context(n);if(o&&o.length&&o[0]===t.target&&i.takeFocusToggled)return!0}return!1},this.mouseDownHandler=function(e){p.mouseDownEvent=e},this.bodyClickHandler=function(e){e.mouseDownEvent=p.mouseDownEvent;var t=p.mouseDownEvent=null;if(h.flyout.flyoutManager.areAnyFlyoutsOpen()&&(t=h.flyout.flyoutManager.getTopFlyout()),t){if(!h.util.flyout.isClosableFocusRegion(e.target))return;if(h.flyout.flyoutManager.isFlyoutInFocusTransferMode(t,e))return;if($(e.target).parents().hasClass("qtip"))return;var o=t.target;if(!o&&t.getTarget&&(o=t.getTarget()),!o||!o[0]||o[0]!==e.target&&!$.contains(o[0],e.target)){h.util.flyout.clickHandler(e);var n=h.context(e.target);n&&n.Root&&n.Root.InternalFocusIn&&$(e.target).is(":focusable")&&(n.Root.focusedControl=e.target,n.Root.InternalFocusIn(n.element,n.Root.ActiveElement()))}}},this.findAllFlyoutsByFormId=function(n){return p.flyoutStack.filter(function(e){var t=h.value(e.flyout)[0],o=h.context(t);return o&&o.Id===n})},this.findAllFlyoutsByParentFormId=function(n){return p.flyoutStack.filter(function(e){var t=h.value(e.flyout)[0],o=h.context(t);return o&&o.Root&&o.Root.Id===n})},this.flyoutStack=[],this.mouseDownEvent=null}e=h.flyout||(h.flyout={}),o.prototype.getMouseClickInfo=function(e){var t=e&&"click"===e.type&&3===e.which;return{clickTarget:e.mouseDownEvent?e.mouseDownEvent.target:e.target,clickX:e.mouseDownEvent?e.mouseDownEvent.pageX:e.pageX,clickY:e.mouseDownEvent?e.mouseDownEvent.pageY:e.pageY,isRightClick:t}},t=o,e.flyoutManager=new t}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(G){var e,t,o,n;function i(e,t,o){this._options=e,this._currentFlyout=t,this._lastFlyout=o}function r(w,_){var l=w.flyout,u=G.observable();w.takeFocus=!(void 0!==w.takeFocus&&!G.shell.isPhone)||w.takeFocus,w.requestCloseCalled=!1,w.of=void 0===w.of?w.target:w.of,w.putAnimationOnTarget=void 0!==w.putAnimationOnTarget&&w.putAnimationOnTarget;var e=w.clickSubscriber||G.util.flyout.defaultFlyoutClickSubscriber,t=w.escapeSubscriber||G.util.flyout.defaultFlyoutEscapeSubscriber,S=!1;function d(e){var t,o=$.Deferred();return w.requestCloseCalled=!0,e&&"resetShellOnNavigation"===e.type&&(t=!1),G.getFunction(w.requestClose)(function(){G.getFunction(e)(),o.resolve()},t),o.promise()}var I,T,x={clickSubscriber:e,escapeSubscriber:t,flyout:u,getTarget:w.getTarget,highlyResponsive:w.highlyResponsive,requestClose:w.highlyResponsive?function(e){return w.requestCloseCalled=!0,G.getFunction(w.requestClose)(),G.getFunction(e)(),$.Deferred().resolve()}:d,showFlyout:w.show,target:w.target};l&&1===l.length&&G.util.setVisibility(l[0],!1,_),w.requestPopup=w.requestPopup?w.requestPopup:function(e){return e(l),l},w.requestClose=function(e){u(null),w.show()&&w.show(!1),e&&"function"==typeof e&&e()},w.activeFlyoutSubscriber=G.observe(u,function(e){var t,o;function n(){jQuery(this).removeClass(G.value(w.entranceAnimation)).css("animation-play-state",""),this.removeEventListener("animationend",n),this.removeEventListener("webkitAnimationEnd",n)}function i(){var e=jQuery(this);e.hasClass(G.value(w.entranceAnimation))&&w.show()||(e.removeClass(G.value(w.exitAnimation)).css("animation-play-state",""),this.removeEventListener("animationend",i),this.removeEventListener("webkitAnimationEnd",i),w.show(!1),G.util.setVisibility(I[0],!1,_),T.reparentOnClose())}e&&(I=e),T?T.updateProps(w,e,I):T=new G.flyout.activeFlyoutHelper(w,e,I);var r,a=w.show(),s=w.target;if(!s&&w.getTarget&&0<w.getTarget().length&&(s=w.getTarget()),s&&!G.value(w.skipAria)&&void 0!==a&&G.util.setAriaExpanded(s[0],a.toString()),a&&e&&e[0]){if(r=G.context(e[0]),!S){if(r){var l="resetShellOnNavigation."+r.Id;$(document.body).on(l,x.requestClose),x.handle=l}var u=(x.options=w).scrollTarget||s||(w.of&&w.of.jquery?w.of:void 0);if(!u&&w.getAnchor&&0<w.getAnchor().length&&(u=G.applyFunction(w.getAnchor)),u&&0<u.length){w.scrollParents=[];for(var d=u.scrollParent();0<d.length&&d[0]!==document;)w.scrollParents.push(d),d.off("scroll.flyout"),d.on("scroll.flyout",G.flyout.flyoutManager.repositionAllFlyouts),d=d.scrollParent()}x.tabbingHandlerDispose=G.util.tabbingContainer(e[0]),G.flyout.flyoutManager.addFlyout(x),S=!0,$(document).trigger("flyoutRegistered")}if(T.showPopupPendingAnimation(),!1!==G.value(w.moveTo)&&e[0].parentNode!==document.body){var c=e[0].parentNode,p=e.parents(G.value(w.moveTo)).first();0===p.length&&(p=$("body")),e.detach().appendTo(p),e[0].dynOriginalParent=c}r&&"function"==typeof r.RequestOpen?r.RequestOpen(_):(G.value(w.entranceAnimation)&&(e.removeClass(G.value(w.exitAnimation)).addClass(G.value(w.entranceAnimation)).css("animation-play-state","paused"),e[0].addEventListener("animationend",n),e[0].addEventListener("webkitAnimationEnd",n)),G.util.setVisibility(e[0],!0,_),G.value(w.entranceAnimation)&&e.css("animation-play-state","running"));var h=G.context(e[0]);if(h&&h.Root&&("LightBox"===h.Root.TypeName||null!==(o=null===(t=h.Root.element)||void 0===t?void 0:t.classList)&&void 0!==o&&o.contains("lightbox-flyout"))&&e.addClass("lightbox-flyout"),r&&r.IsActive?r.IsActive(!0):e[0].dynHasArranged||G.layout.arrange(e[0],!0),(w.of||w.getAnchor)&&"manual"!==w.at){var m=G.applyFunction(w.getAnchor)||w.of;if(m&&m.outerWidth){var v=m.outerWidth()-(e.outerWidth()-e.innerWidth());e.css("min-width",v+"px")}w.positionResize?(T.hasPendingAnimation()||T.setupAndRepositionFlyout(),w.repositionFlyout&&G.setValue(w,"repositionFlyout",function(){G.async(T.repositionFlyout,void 0,"Reposition flyout",T)})):G.util.position(w,e)}G.value(w.takeFocus)&&!G.util.isForm(e[0])&&G.util.flyout.focusFirstControlInFlyout(e[0])}else{if(S&&($(document).trigger("flyoutRemoved"),G.flyout.flyoutManager.removeFlyout(x),S=!1),T.unbindRepositionHandlers(),s&&(G.value(w.skipAria)||G.util.setAriaExpanded(s[0],"false"),w.requestPopup&&s.length&&(s[0].dynFlyout=void 0)),I){var g=G.applyFunction(w.getAnchor)||w.of,y=G.util.isFlyoutAPhoneLookup(I,g);if((G.value(w.takeFocus)||$.contains(I[0],document.activeElement))&&s&&!y){var f=s.length&&G.ui.getLiveControl(s[0]);if(f&&f.Root&&f.Root.setControlFocus)f.Root.setControlFocus(f.Name);else if(f&&f.element){var b=G.ui.getNavBar();if(b&&b.element&&b.element.contains(f.element)){var C=G.util.findFirstTabbableControl(f.element);C&&C.focus&&C.focus()}}}G.value(w.exitAnimation)?(I.addClass(G.value(w.exitAnimation)),I[0].addEventListener("animationend",i),I[0].addEventListener("webkitAnimationEnd",i)):(G.util.setVisibility(I[0],!1,_),window.setTimeout(function(){T.reparentOnClose()}))}r&&r.IsActive&&r.IsActive(!1)}}),w.showSubscriber=G.observe(w.show,function(e){var t,o;if(l=w.flyout,e){if(w.requestCloseCalled=!1,w.requestPopup){l=w.flyout=w.requestPopup(u,w);var n=w.target;!n&&w.getTarget&&(n=w.getTarget()),n&&n.length&&(n[0].dynFlyout=l);var i=void 0;if(l&&l[0]&&(i=G.context(l[0]),(l[0].RequestPopupClose||i&&i.Close)&&(w.requestClose=l[0].RequestPopupClose||G.getFunction(i.Close))),i){i.TakeFocus=G.value(w.takeFocus);var r=n&&n.length?G.ui.getLiveControl(n[0]):void 0;r&&w.focusTarget&&"function"==typeof w.focusTarget?i.FindFocusTarget=w.focusTarget.bind(r):i.FindFocusTarget=w.focusTarget}}}else if(w.requestCloseCalled||d(),w.scrollParents){try{for(var a=__values(w.scrollParents),s=a.next();!s.done;s=a.next()){s.value.off("scroll.flyout")}}catch(e){t={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(t)throw t.error}}w.scrollParents=[]}}),G.isObservable(w.skipAria)&&(w.ariaSubscriber=G.observe(w.skipAria,function(e){var t=w.target;if(!t&&w.getTarget&&(t=w.getTarget()),t&&t.length)if(G.value(e))w.target.removeAttr("aria-expanded");else{var o=G.value(w.show);void 0!==o&&G.util.setAriaExpanded(w.target[0],o.toString())}}))}Globalize.addCultureInfo("en",{messages:{Select_Text:"Select {0}"}}),(G.util||(G.util={})).findParentControlElement=function(e){var t;if(e){var o=e.closest("[data-dyn-controlname]");if(o.length){var n=G.ui.getLiveControl(o[0]);t=null!=n&&n.ReferenceGroup?n.ReferenceGroup.element:o[0]}}return t},e=G.flyout||(G.flyout={}),Object.defineProperty(i.prototype,"repositionWrapper",{get:function(){var e=this;return this._repositionCaller||(this._repositionCaller=function(){e.repositionFlyout()}),this._repositionCaller},enumerable:!1,configurable:!0}),i.prototype.updateProps=function(e,t,o){this._options=e,this._currentFlyout=t,this._lastFlyout=o},i.prototype.reparentOnClose=function(){if(this._lastFlyout&&this._lastFlyout[0]){var e=this._lastFlyout[0].dynOriginalParent,t=this._lastFlyout[0].parentNode;e&&t&&e!==t&&(this._lastFlyout.removeClass("sysPopup-hidden"),this._lastFlyout.detach().appendTo(e))}},i.prototype.repositionFlyout=function(){var e,t=this,o=this._currentFlyout||this._options.flyout,n=G.applyFunction(this._options.getAnchor)||this._options.of;if(o&&n)if(0!==(e=n.target?$(n.target):n).closest("html").length){var i=G.context(o[0]);if(G.value(null==i?void 0:i.waitForAsyncRender)&&!this._waitForAsyncObserver)return this._waitForAsyncObserver=G.observe(i.waitForAsyncRender,function(e){if(!e)return t.repositionFlyout(),t._waitForAsyncObserver=void 0,!1}),void(G.log.popups&&G.log.popups("Waiting to reposition until async renders are completed"));var r=o.scrollTop(),a=o.width();o.css("max-height",""),o.css("max-width","");var s=this._options.getPadding?this._options.getPadding():this._options.padding,l=this._options.useAnchorWidthAsMaxWidth?e.outerWidth():void 0;G.util.resizeFlyoutToScreen(o,n,s,l),a!==o.width()&&G.layout.reflow(o),G.util.position(this._options,o),o.scrollTop(r)}else o.detach();else G.log.popups&&G.log.popups("Tried respositioning invalid flyout")},i.prototype.getCurrentTarget=function(){var e=this._options.target;return!e&&this._options.getTarget&&(e=this._options.getTarget()),e},i.prototype.setupRepositionHandlers=function(){var e;if(!this._flyoutReflowHandler){var t=null===(e=this._currentFlyout)||void 0===e?void 0:e[0];t&&G.layout.getFirstReflowElement(t)&&(this._flyoutReflowHandler=G.layout.registerEndReflowHandler(t,this.repositionWrapper))}if(!this._parentReflowHandler){var o=this.getCurrentTarget();if(o){var n=G.util.findParentControlElement(o);n&&(this._parentReflowHandler=G.layout.registerEndReflowHandler(n,this.repositionWrapper))}}this.resizeHandlerId||(this.resizeHandlerId=G.shell.subscribeWindowResize(this.repositionFlyout,this))},i.prototype.unbindRepositionHandlers=function(){this._flyoutReflowHandler&&(this._flyoutReflowHandler.dispose(),this._flyoutReflowHandler=void 0),this._parentReflowHandler&&(this._parentReflowHandler.dispose(),this._parentReflowHandler=void 0),this._waitForAsyncObserver&&(this._waitForAsyncObserver.dispose(),this._waitForAsyncObserver=void 0),this.resizeHandlerId&&(G.shell.unsubscribeWindowResize(this.resizeHandlerId),this.resizeHandlerId=void 0)},i.prototype.hasPendingAnimation=function(){var e,t=this.getCurrentTarget(),o=G.util.findParentControlElement(t),n=G.ui.getLiveControl(o);if(null!==(e=null==n?void 0:n.getActiveIsLoadingAnimation)&&void 0!==e&&e.call(n))return!0;var i=this._options.putAnimationOnTarget?null==t?void 0:t[0]:o;return null!=i&&i.classList?i.classList.contains("is-loading"):void 0},i.prototype.setupAndRepositionFlyout=function(){this.repositionFlyout(),this.setupRepositionHandlers()},i.prototype.showPopupPendingAnimation=function(){var e=this,t=(this._options.of||this._options.getAnchor)&&this._options.positionResize;if(!G.value(this._options.optOutOfWait)&&G.clientBusy()&&t){this._currentFlyout.addClass("sysPopup-hidden"),this.unbindRepositionHandlers();var o=function(){e._currentFlyout&&(e.setupAndRepositionFlyout(),e._currentFlyout.removeClass("sysPopup-hidden"))},n=this.getCurrentTarget();if(n&&n.length&&!this.hasPendingAnimation()){var i=this._options.putAnimationOnTarget?n[0]:G.util.findParentControlElement(n);G.util.activateLoadingAnimation(i,this,function(){return t&&(!e._currentFlyout||0===e._currentFlyout.length||!e._currentFlyout[0].wasPopupOpenedDeferredForExistingClose)},o)}else var r=G.clientBusy.valueChanged.subscribe(function(){G.clientBusy()||(G.callFunction(o,e),G.clientBusy.valueChanged.unsubscribe(r))})}},t=i,e.activeFlyoutHelper=t,(o=G.util||(G.util={})).flyout=r,(n=r=o.flyout||(o.flyout={})).forceFlyoutSelection=!1,n.clickHandler=function(e){G.flyout.flyoutManager.removeAllFlyoutsAsync(e)},n.wasLightboxClicked=function(e){return!!e&&!!(void 0!==e.classList&&e.classList.contains("applicationShell-blockingMessage")||$(e).parents(".lightbox-container").length)},n.keyDownHandler=function(e){var t=null;if(G.flyout.flyoutManager.areAnyFlyoutsOpen()&&(t=G.flyout.flyoutManager.getTopFlyout()),G.util.isShortcutKeyPressed(e,{keyCode:G.ui.KeyCodes.esc})){var o=G.context(e.target)&&G.value(G.context(e.target).pickerOpen)||0<$(e.target).parents(".ui-datepicker").length;if(t&&t.escapeSubscriber&&!o)if(G.util.flyout.forceFlyoutSelection)G.log.stopPropagation&&G.log.stopPropagation("Flyout: escape key / forceFlyoutSelection=true / stopPropagation"),e.stopImmediatePropagation(),e.preventDefault();else{var n=!1;G.value(G.ui.layout)||(G.ui.layout(!0),n=!0),G.getFunction(t.escapeSubscriber)(),G.log.stopPropagation&&G.log.stopPropagation("Flyout: escape key / stopPropagation"),e.stopImmediatePropagation(),e.preventDefault(),n&&G.ui.layout(!1)}}},n.isClosableFocusRegion=function(e){var t=null;if(G.flyout.flyoutManager.areAnyFlyoutsOpen()&&(t=G.flyout.flyoutManager.getTopFlyout()),t){var o=$(e).closest(".binding-focusRegion")[0],n=G.flyout.flyoutManager.getFlyoutFocusRegion(t);if(null!=o&&null!=n&&(n!==o||G.util.flyout.forceFlyoutSelection))return!1}return!0},n.defaultFlyoutClickSubscriber=function(e){var t,o=!1;return e.flyoutElement&&e.flyoutElement[0]&&(t=G.context(e.flyoutElement[0])),e.flyoutElement?t&&!1===G.value(t.IsFormReady)||e.clickInsideTopFlyout||e.isClickInsideThisFlyout?o=!1:e.flyoutElement.length&&(o=!0):o=!0,o},n.getFlyoutWithActionsClickSubscriber=function(o){return function(e){if(e.flyoutElement&&e.flyoutElement.length){var t=e.isClickInsideThisFlyout;if(e.isRightClick&&t)return!1;if(!t||$(e.clickTarget).is(o)||$(e.clickTarget).parentsUntil(e.flyoutElement[0]).is(o))return!0}return!1}},n.IsClickInFlyout=function(e,t,o,n){return null!=t&&0!==t.length&&void 0!==t[0]&&(!!(G.util.isFlightEnabled(G.reactGrid.featureName)&&0<$(e).closest(".dyn-flyout").length)||($(e).is(t[0])||G.util.flyout.isCoordinateInside(o,n,t)||$.contains(t[0],e)))},n.defaultFlyoutEscapeSubscriber=function(){G.flyout.flyoutManager.removeTopFlyoutAsync()},n.isCoordinateInside=function(e,t,o){var n=o.offset();return!!n&&(n.right=n.left+o.outerWidth(),n.bottom=n.top+o.outerHeight(),e>=n.left&&e<=n.right&&t>=n.top&&t<=n.bottom)},n.focusFirstControlInFlyout=function(l){G.observe(G.async.pending,function(e){if(e)return!0;var t=G.util.findFirstFocusableControl(l),o=G.context(t),n=G.context(l);if(o&&o.Root&&o.Root.setControlFocus)o.Root.setControlFocus(o.Name);else if(o&&n&&n.Root&&n.Root.setControlFocus)n.Root.setControlFocus(o.Name);else{var i=G.context(G.shell.getActiveForm()),r=G.context(l),a=!!r&&"NavBar"===r.Id,s=!!r&&"UserButton"===r.Name;!i||a||s||i.setControlFocus(t)}return!1})},o.closePhoneFlyout=function(){G.util.phoneOpenedFlyout&&G.util.phoneOpenedFlyout[0]&&G.util.phoneOpenedFlyout[0].RequestPopupClose&&G.util.phoneOpenedFlyout[0].RequestPopupClose(),G.util.phoneOpenedFlyout=void 0},o.isFlyoutAPhoneLookup=function(e,t){var o,n,i=!1;return e&&0<e.length&&(o=e.find(".rootContent"),t&&0<$(t).length&&0===(n=$(t).find(".dyn-lookup-button")).length&&0===(n=$(t).find(".lookupButton")).length&&(n=$($(t)[0].nextSibling).find(".lookupButton")),G.shell.isPhone&&t&&n&&0<n.length&&o&&0<o.length&&(i=!0)),i},o.resizeFlyoutToScreen=function(e,t,o,n){var i,r;if(e&&e.length)if(G.util.isFlyoutAPhoneLookup(e,t)){var a=e.find(".rootContent"),s="";if(t){var l=G.ui.getLiveControl(t[0]);l&&(s=(s=G.value(l.FieldLabel))||G.value(l.Label))}var u=G.format(G.label("Select_Text"),s);e.addClass("phoneSysPopup"),e.addClass("layout-vertical"),e.addClass("layout-container"),a.addClass("fill-height");var d=e.find(".phonePopupCloseButton");G.util.phoneOpenedFlyout=e,0===d.length&&a.prepend('<div class="layout-horizontal layout-container phonePopupHeaderContainer"><div class="phonePopupLabel">'+u+'</div><button type="button" onclick="$dyn.util.closePhoneFlyout();" class="phonePopupCloseButton button dynamicsButton"></button></div>')}else{var c=0,p=0,h=0,m=0;o&&(c=o.top?o.top:c,p=o.bottom?o.bottom:p,h=o.left?o.left:h,m=o.right?o.right:m);var v=$(window).height(),g=$(window).width(),y=$(t),f=y&&y.closest(".sysPopup"),b=void 0;if(f&&0<f.length){var C=f[0];C&&C.style&&"absolute"!==C.style.position&&(b=C.style.position,C.style.position="absolute")}var w=void 0,_=0;void 0===t.pageY?(w=y.offset(),_=y.outerWidth()):w={left:t.pageX,top:t.pageY},b&&(f[0].style.position=b);var S=0;t.height&&(S="function"==typeof t.height?t.height():t.height),_=0,t.width&&(_="function"==typeof t.width?t.width():t.width);var I=e.offset();if(I&&w){var T=null!==(i=w.top)&&void 0!==i?i:0,x=v-(T+S),F=null!==(r=w.left)&&void 0!==r?r:0,k=g-(F+_);w.bottom=x,w.right=k;var P=e.height(),R=e.width(),M=e.outerWidth(),E=e.outerHeight(),N=M-R,A=E-P,D=void 0,L=w.top<=w.bottom,O=function(e){var t=e+S+P;return v<t?P-(t-v):v-(e+S)-20};D=O(L?w.top:w.bottom),L?w.top+S+P>v&&(D=D-p-A):I.top<c&&(e.css("top",c+"px"),D=D-c-A),e.css("max-height",(0<D?D:0)+"px");var B=void 0;if(n)B=n;else{var V=w.left<=w.right,H=function(e){var t=e+R;return g<t?R-(t-g):g-e};B=H(V?w.left:w.right),V?w.left+R>g&&(B=B-m-N):I.left<h&&(e.css("left",h+"px"),B=B-h-N)}e.css("max-width",(0<B?B:0)+"px")}}}}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(g){var e;(e=g.DynReact||(g.DynReact={})).UI||(e.UI={}),g.React=g.DynReact,String.prototype.startsWith||(String.prototype.startsWith=function(e){return this.substring(0,e.length)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(e){return-1!==this.indexOf(e,this.length-e.length)}),HTMLElement.prototype.remove||(HTMLElement.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),function(e){var t,o,n,i,r,a,s;function l(e){var t=new g.util.UrlBuilder;return t.parseUrl(e),t}function u(e){return!(!e||!e.href)}e.dataAreaId="dataAreaId",e.CLIAllowFullPageTabbingFeature="CLIAllowFullPageTabbingFeature",(t=e.VerticalElementVisibility||(e.VerticalElementVisibility={})).VISIBLE="center",t.PARTIAL="partial",t.INVISIBLE_TOP="top",t.INVISIBLE_BOTTOM="bottom",(o=e.HorizontalElementVisibility||(e.HorizontalElementVisibility={})).VISIBLE="center",o.PARTIAL="partial",o.INVISIBLE_LEFT="left",o.INVISIBLE_RIGHT="right",(n=e.timeSeparators||(e.timeSeparators={})).colon=":",n.dot=".",n.space=" ",n.comma=",",n.slash="/",(i=e.timeSeparators||(e.timeSeparators={})).auto=Globalize.culture().calendar[":"]?Globalize.culture().calendar[":"]:i.space,(r=e.TimeZonePreference||(e.TimeZonePreference={})).auto="Auto",r.user="User",r.none="NoConversion",e._performancePolyfill={},window.performance||(window.performance={},performance.now||(performance.now=function(){return Date.now()}),performance.mark||(performance.mark=function(e){g.util._performancePolyfill[e]||(g.util._performancePolyfill[e]=[]),g.util._performancePolyfill[e].push({duration:0,entryType:"mark",name:e,startTime:performance.now(),toJSON:function(){}})}),performance.getEntriesByName||(performance.getEntriesByName=function(e){return g.util._performancePolyfill[e]})),e.elementVerticalVisibilityInParentContainer=function(e,t){if(!e||!t)return null;var o=e.top,n=e.bottom,i=t.top,r=t.bottom;return i<=o&&n<=r?g.util.VerticalElementVisibility.VISIBLE:n<i?g.util.VerticalElementVisibility.INVISIBLE_TOP:r<o?g.util.VerticalElementVisibility.INVISIBLE_BOTTOM:g.util.VerticalElementVisibility.PARTIAL},e.elementHorizontalVisibilityInParentContainer=function(e,t){if(!e||!t)return null;var o=e.left,n=e.right,i=t.left,r=t.right;return i<=o&&n<=r?g.util.HorizontalElementVisibility.VISIBLE:n<i?g.util.HorizontalElementVisibility.INVISIBLE_LEFT:r<o?g.util.HorizontalElementVisibility.INVISIBLE_RIGHT:g.util.HorizontalElementVisibility.PARTIAL},e.isElementVisibleInParentContainer=function(e,t){var o=g.util.elementHorizontalVisibilityInParentContainer(e,t),n=g.util.elementVerticalVisibilityInParentContainer(e,t);return o!==g.util.HorizontalElementVisibility.INVISIBLE_LEFT&&o!==g.util.HorizontalElementVisibility.INVISIBLE_RIGHT&&n!==g.util.VerticalElementVisibility.INVISIBLE_TOP&&n!==g.util.VerticalElementVisibility.INVISIBLE_BOTTOM},e.elementRectangle=function(e){if(e&&e.offset){var t=e.offset();if(t){var o=t.top,n=o+e[0].offsetHeight,i=t.left;return{top:o,bottom:n,left:i,right:i+e[0].offsetWidth}}}},e.mutationObserverSupported=function(){return!(!window||!window.MutationObserver)},e.getPathResolver=function(t){return new RegExp("^/namespaces/","i").test(t)?(t=(t=t.endsWith("/")?t.slice(0,-1):t).endsWith(".htm")?t.substring(0,t.lastIndexOf("/")):t,function(e){return e&&e.startsWith&&e.startsWith("/")&&!e.startsWith(t)?t+e:e}):function(e){return e}},e.resolveVirtualPath=(a=window.location.pathname,g.util.getPathResolver(a)),e.parseUrl=l,(s=l=e.parseUrl||(e.parseUrl={}))._queryStringRegExp=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),s._decode=function(e){return decodeURIComponent(e)},e.pathCombine=function(e,t){return e.endsWith("/")?e+t:e+"/"+t},e.isLocation=u;var d,c,p,h=(m.prototype.parseUrl=function(e){var t;t=u(e)?(this.location=e).href:e,t=g.util.resolveVirtualPath(t);var o=g.util.parseUrl._queryStringRegExp.exec(t);this.url=t,o&&(this.scheme=o[2]||"",this.authority=o[4]||"",this.path=this.dir=o[5]||"",this.queryString=o[7]||"",this.fragment=o[9]||""),this.isRelative=!this.path.startsWith("/"),this.pathSegments=this.dirSegments=this.path.split("/")||[],this.fileName=this.pathSegments[this.pathSegments.length-1]||"";var n=this.fileName.lastIndexOf(".");-1!==n?(this.dirSegments=this.pathSegments.slice(0),this.dirSegments.pop(),this.dir=this.dirSegments.join("/"),this.fileExt=this.fileName.substring(n+1),this.fileNameWithoutExt=this.fileName.substring(0,n)):this.fileName="",this.dir=0<this.dir.length&&!this.dir.endsWith("/")?this.dir+"/":this.dir,this.query=g.util.parseQueryString(this.queryString)},m.prototype.fromLocation=function(e){this.location=e,this.url=e.href,this.parseUrl(this.url),this.host=e.hostname,this.port=e.port},m.prototype.absoluteUrl=function(){var e=this.scheme+"://";return this.host?(e+=this.host,this.isDefaultPort()||(e+=":"+this.port)):e+=this.authority,e+=this.relativeUrl(this)},m.prototype.relativeTo=function(e){var t;if(this.authority)t=this.url;else if(this.isRelative){for(var o=0;".."===this.dirSegments[o];)o++;var n=e.dirSegments.slice(0,e.dirSegments.length-o).join("/"),i=this.pathSegments.slice(o).join("/");t=g.util.pathCombine(n,i)}else t=this.path;return t},m.prototype.relativeUrl=function(e){var t=(e=e||this).path;if(e.query){var o=!0;for(var n in t+="?",e.query)if(o||(t+="&"),o=!1,""!==n){t+=encodeURIComponent(n);var i=e.query[n];null!=i&&(t+="="+encodeURIComponent(i))}}return t},m.prototype.isDefaultPort=function(){return!this.port||"http"===this.scheme&&"80"===this.port||"https"===this.scheme&&"443"===this.port},m);function m(){}function v(e){for(var t,o,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];try{for(var r=__values(n),a=r.next();!a.done;a=r.next()){var s=a.value;if(null!=s)for(var l in s)s.hasOwnProperty(l)&&(e[l]=s[l])}}catch(e){t={error:e}}finally{try{a&&!a.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}return e}e.UrlBuilder=h,e.parseQueryString=function(e){var t,o;if(!e)return{};var n=e.indexOf("?")+1,i=e.substring(n).split("&"),r={};try{for(var a=__values(i),s=a.next();!s.done;s=a.next()){var l=s.value.split("=");if(1<=l.length){var u=g.util.parseUrl._decode(l[0]),d=u.toLowerCase();switch(l.length){case 1:r[u]=void 0;break;case 2:r[u]=g.util.parseUrl._decode(l[1])}u!==d&&function(t,e){Object.defineProperty(r,e,{configurable:!0,get:function(){return this[t]},set:function(e){this[t]=e}})}(u,d)}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(t)throw t.error}}return r},e.relativeUrl=g.util.UrlBuilder.prototype.relativeUrl,e.scriptUrl=function(e){return g.url(e)},e.htmlUrl=function(e){return g.url(e)},e.styleSheetUrl=function(e){return g.url(e)},e.imagesUrl=function(e){return g.url(e)},e.fullHost=function(){if(window.location.pathname&&"/"!==window.location.pathname){var e=window.location.pathname.split("/");if("namespaces"===e[1])return window.location.host+"/"+e[1]+"/"+e[2]}return window.location.host},e.getOrigin=function(e){return e.protocol+"//"+e.hostname+(e.port?":"+e.port:"")},e.InternetCheckUrl="https://content.powerapps.com/resource/uci-infra/uci_cdn_connection_check",e.performConnectionCheck=function(e){var t=new XMLHttpRequest;t.open("GET",g.appConfig&&g.appConfig.internetCheckURL||g.util.InternetCheckUrl,!0),t.setRequestHeader("Cache-Control","no-cache"),t.onreadystatechange=function(){4===t.readyState&&e(!(200<=t.status&&t.status<304))},t.send()},e.internetReachable=function(){function e(e){var t="internetRestrictedOn",o=document.getElementsByTagName("body")[0].classList;g.shell.hasRestrictedInternet(e),e?o.add(t):o.remove(t),g.shell.buildHelpMenu()}$.when(g.deferred.onTrue(function(){var e=g.value(g.user);return!!e&&null!==g.value(e.ClientConnectivityEnabled)})).done(function(){g.value(g.value(g.user).ClientConnectivityEnabled)?g.flags.disableConnectivityCheck?e(!1):g.util.performConnectionCheck(e):e(!0)})},e.historySupported=function(){var e=!1;return history.state?e=!0:(window.history.replaceState({test:1},null,null),history.state&&history.state.test&&(e=!0,window.history.replaceState(null,null,null))),e},e.isIE=function(){return!(!$.ua||!$.ua.browser||"IE"!==$.ua.browser.name)},e.localStorageSupported=function(){if(void 0!==g.util._localStorageSupported)return g.util._localStorageSupported;try{return window.localStorage?(localStorage.setItem("testkey","1"),localStorage.getItem("testkey"),localStorage.removeItem("testkey"),g.util._localStorageSupported=!0):g.util._localStorageSupported=!1}catch(e){return g.util.localStorageErorrHandler(e.name),g.util._localStorageSupported=!1}},e.localStorageErorrHandler=function(e){"QuotaExceededError"===e||"NS_ERROR_DOM_QUOTA_REACHED"===e?g.logError(g.label("Framework_LocalStorageQuotaError")):g.logError(g.label("Framework_LocalStorage")+": %s",e)},e.getFlightValue=function(e){var t=g.value(g.user);if(t&&g.value(t.FlightingFlags))return g.user().FlightingFlags()[e]},e.getAxArrayFieldIndex=function(e){return(16711680&e)>>16},e.getBuildString=function(){var e="";if(g.flags.staticGenerators)return"test build";if(g.user()&&g.user().AppVersion&&g.user().AppVersion()){var t=g.user().AppVersion().split(": ",2)[1];e=t||""}return g.user()&&g.user().PlatformVersion&&g.user().PlatformVersion()&&(e+=" : "+g.user().PlatformVersion()),e+=e?" : "+g.version.fullVerString:g.version.fullVerString},e.isPreviewBuild=function(){return!(!g.user||!g.user().ProductIsPreview)&&g.value(g.user().ProductIsPreview())},e.isEnhancedTabSequenceEnabled=function(){var e=!1;return g.peek(g.user)&&g.peek(g.peek(g.user).EnhancedTabSequence)&&(e=!0),e},e.isTooltipOnFocusEnabled=function(){var e=!1;return(g.peek(g.user)&&g.peek(g.peek(g.user).TooltipOnFocus)||g.flags.enableFocusTooltip)&&(e=!0),e},e.isFlightEnabled=function(e){if(g.debug.flights&&void 0!==g.debug.flights[e])return g.util.stringToBoolean(g.debug.flights[e]);var t=g.value(g.user);return!(!t||!g.value(t.FlightingFlags))&&!!g.user().FlightingFlags()[e]},(d=e.HtmlNodeType||(e.HtmlNodeType={}))[d.text=3]="text",(c=e.converters||(e.converters={})).boolean=function(e){return!!e},c.booleanString=function(e){return"boolean"==typeof e?e:null!=e&&("true"===(e=e.toString().toLowerCase())||"1"===e||"yes"===e)},c.string=function(e){return"string"==typeof e?e:null==e?null:e.toString()},c.notNullString=function(e){return null==e?"":e.toString()},c.number=function(e,t,o){return"number"==typeof e?e:o},c.numberString=function(e){if("number"==typeof e)return e;if("string"!=typeof e)return null;var t=Number.parseInt(e,10);return isNaN(t)?null:t},c.toObject=function(e){return e},e.stringToBoolean=g.util.converters.booleanString,e.enumNames=function(e){if(e._enumNames)return e._enumNames;for(var t in e._enumNames={_enum:e},e)"_"!==t[0]&&(e._enumNames[e[t]]=t);return e._enumNames},e.enumName=function(e,t){return g.util.enumNames(t)[e]},e.empty=function(e){var t;if(e)for(;t!==e.lastChild;)(t=e.lastChild)&&(t.nodeType!==g.util.HtmlNodeType.text&&8!==t.nodeType&&g.unbind(t),$(t).remove())},e.emptyfunction=function(){},e.encodeUrlPathSegment=function(e){return g.logDeprecated("$dyn.util.encodeUrlPathSegment"),e},e.elementMatches=HTMLElement.prototype.matches||HTMLElement.prototype.matchesSelector||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.msMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.oMatchesSelector,e.filter=function(e,t){for(var o=[],n=0,i=e.length;n<i;n++){var r=e[n];r&&g.util.elementMatches.call(r,t)&&o.push(r)}return o},e.parseFileNameWithDirectory=function(e){if(!e)return"";var t=new RegExp("[\\\\/]"),o=e.split(t);return o[o.length-1]},e.elapsedTimeDisplayText=function(e,t){var o=t;void 0===o&&(o=moment.utc());var n=moment.duration(o.diff(e)),i=Math.abs(n.asMinutes());return i<1?g.label("Framework_ElapsedTimeLessThanMinute"):60<i?g.label("Framework_ElapsedTimeMoreThanHour"):1===Math.floor(i)?g.label("Framework_ElapsedTimeMinute"):g.format(g.label("Framework_ElapsedTimeMinutes"),Math.floor(i).toString())},e.waitForClientBusy=function(){return!1},e.isWebKit=function(){return!!navigator.webkitPersistentStorage},e.isRTLMode=function(){return"rtl"===document.documentElement.dir},e.isNullOrUndefined=function(e){return null==e},e.objectAssign=v,void 0===Object.assign&&(Object.assign=v),e.convertItems=function(e){for(var t=[],o=0;o<e.length;o++)t.push({index:o,text:e[o].Label,value:e[o].Value});return t},e.createDispatcherBigNumOptions=function(e,t){var o,n=t.BigNumber.defaultFormat,i=g.util.objectAssign({},n);if(i[","]="","Integer"===e.TypeName||"Int64"===e.TypeName)o=!(i.decimals=0);else{o=!1;var r=e,a=g.value(r.NoOfDecimals);void 0!==a&&a!==g.ui.autoValue&&(i.decimals=a);var s=g.value(r.MinNoOfDecimals);void 0!==s&&s!==g.ui.autoValue?i.minDecimals=s:delete i.minDecimals}g.value(e.SignDisplay)===g.ui.SignDisplayType.None&&(i.pattern=["n"]);var l=g.value(e.RotateSign);return{ignoreDecimal:o,numberFormat:i,rotateSign:l!==g.ui.autoValue&&g.util.stringToBoolean(l)}},e.createBigNumOptions=function(e){var t,o=ControlLibrary.LocalizationManager.instance.getNumberFormat(),n=g.util.objectAssign({},o);if("Integer"===e.TypeName||"Int64"===e.TypeName)t=!(n.decimals=0),n[","]="";else{t=!1;var i=e,r=g.value(i.NoOfDecimals);switch(void 0!==r&&r!==g.ui.autoValue&&(n.decimals=r),g.value(i.DecimalSeparator)){case g.ui.DecimalSeparator.comma:n["."]=",";break;case g.ui.DecimalSeparator.dot:n["."]=".";break;case g.ui.DecimalSeparator.auto:}switch(g.value(i.ThousandSeparator)){case g.ui.ThousandSeparator.none:n[","]="";break;case g.ui.ThousandSeparator.comma:n[","]=",";break;case g.ui.ThousandSeparator.space:n[","]=" ";break;case g.ui.ThousandSeparator.apostrophe:n[","]="'";break;case g.ui.ThousandSeparator.dot:n[","]=".";break;case g.ui.ThousandSeparator.auto:}var a=g.value(i.MinNoOfDecimals);void 0!==a&&a!==g.ui.autoValue?n.minDecimals=a:delete n.minDecimals}switch(g.value(e.SignDisplay)){case g.ui.SignDisplayType.None:n.pattern=["n"];break;case g.ui.SignDisplayType.Prefixed:n.pattern=["-n"];break;case g.ui.SignDisplayType.Suffixed:n.pattern=["n-"];break;case g.ui.SignDisplayType.Parentheses:n.pattern=["(n)"]}var s,l=g.value(e.RotateSign);s=l!==g.ui.autoValue&&g.util.stringToBoolean(l);var u,d=g.value(e.ShowZero);u=d===g.ui.autoValue||g.util.stringToBoolean(d);var c=g.value(e.DisplaceNegative);return{hasDisplaceNegative:c&&c!==g.ui.autoValue&&0<parseInt(c,10),ignoreDecimal:t,numberFormat:n,rotateSign:s,showZero:u}},e.elementsFromPoint=function(e,t){var o=[];return document.elementsFromPoint?o=document.elementsFromPoint(e,t):document.msElementsFromPoint?o=(o=document.msElementsFromPoint(e,t))||[]:document.elementFromPoint&&(document.elementsFromPoint=function(e,t){for(var o,n=[];o!==document.elementFromPoint(e,t)?(o=document.elementFromPoint(e,t),n.push(o),o.style.pointerEvents="none"):o=void 0,o;);return n.forEach(function(e){return e.style.pointerEvents="all"}),n},o=document.elementsFromPoint(e,t)),o},e.stringDup=function(e,t){g.logDeprecated("$dyn.util.stringDup");for(var o="",n=0;n<t;n++)o+=e;return o},e.setVisibility=function(e,t,o){if(void 0===o&&(o=!0),e){var n;void 0===o&&(o=!0);var i=e.getAttribute("data-dyn-lastvisible");null==i?n=o:"true"===i?n=!0:"false"===i&&(n=!1),t?n||(e.style.display="",e.removeAttribute("aria-hidden")):n&&(e.style.setProperty("display","none","important"),e.setAttribute("aria-hidden","true")),e.setAttribute("data-dyn-lastvisible",t?"true":"false"),(!n&&t||n&&!t)&&(e.classList.contains(g.layout.RootScopeMarker)?t&&g.layout.queueArrange(e):g.layout.queueArrange(e.parentNode))}},e.deselectText=function(e){e&&(g.ui.selectionEnd(e,0),g.ui.selectionStart(e,0));var t=g.ui.getSelection();if(t)try{t.removeAllRanges&&0<t.rangeCount&&0<t.getRangeAt(0).getClientRects().length&&t.removeAllRanges()}catch(e){}},e.clickedText=function(e){if($(e).hasClass("lookupButton"))return!1;if(!(e instanceof HTMLInputElement))return!0;var t=e.value,o=g.ui.selectionStart(e);return t&&0<t.length&&o<t.length},e.activateLoadingAnimation=function(s,l,u,d,e){var t,o;if(void 0===e&&(e=1e3),g.clientBusy()){var c,p,n=void 0;if(s&&(n=null===(t=null==(p=g.ui.getLiveControl(s))?void 0:p.getActiveIsLoadingAnimation)||void 0===t?void 0:t.call(p)),!n){var h=g.util.addLoadingAnimation(s,e);null!==(o=null==p?void 0:p.setActiveIsLoadingAnimation)&&void 0!==o&&o.call(p,{cancel:function(e){(e=void 0===e||e)&&g.util.removeLoadingAnimation(s),p.setActiveIsLoadingAnimation(void 0),c&&g.clientBusy.valueChanged.unsubscribe(c),h&&(clearTimeout(h),h=void 0)}}),c=g.clientBusy.valueChanged.subscribe(function(){var e,t,o,n,i;if(!g.clientBusy()){if(h&&(clearTimeout(h),h=void 0),(!u||u.apply(l))&&(g.callFunction(d,l),s)){g.util.removeLoadingAnimation(s);var r=null===(t=null===(e=null==p?void 0:p.listControl)||void 0===e?void 0:e.ControlLibGridRef)||void 0===t?void 0:t.getActiveCellRef(p.Name),a=null===(o=null==r?void 0:r.getControlRef)||void 0===o?void 0:o.call(r);null!==(n=null==a?void 0:a.setSpinnerState)&&void 0!==n&&n.call(a,!1),null!==(i=null==p?void 0:p.setActiveIsLoadingAnimation)&&void 0!==i&&i.call(p,void 0)}g.clientBusy.valueChanged.unsubscribe(c)}})}}},e.addLoadingAnimation=function(e,t){return void 0===t&&(t=1e3),window.setTimeout(function(){e&&e.classList.add("is-loading")},t)},e.removeLoadingAnimation=function(e){e&&e.classList.remove("is-loading")},e.isRootedBy=function(e,t){return e===t||!!t.Root&&g.util.isRootedBy(e,t.Root)},e.swap=function(e,t){var o=e.parentNode,n=t.parentNode,i=t.nextSibling;i===e?(i=i.nextSibling,o.insertBefore(e,t)):(o.replaceChild(t,e),i?n.insertBefore(e,i):n.appendChild(e))},e.mergeAttributes=function(e,t){for(var o=e.attributes,n=o.length,i=0;i<n;i++){var r=o[i];t.setAttribute(r.name,r.value)}},e.renderForEach=function(e,t,o,n,i,r,a){g.logDeprecated("$dyn.util.renderForeach"),g.util.empty(e);var s=document.createDocumentFragment();o.classList.remove("dyn-prototype"),s.appendChild(o),g.debug.profile&&window.console&&console.profile&&(console.timeStamp&&console.timeStamp("foreach begin"),console.profile("foreach"));var l=performance.now();if(i&&o)for(var u=0,d=i.length;u<d;u++){var c,p=i[u],h=void 0;if(a()===u)(c=new g.DataContext(p,r)).scopeVars.$index=u,(h=n.cloneNode(!0)).setAttribute("aria-posinset",u+1),h.setAttribute("aria-selected","true"),g.role(h).doDataBinding(c);else(c=new g.DataContext(p,r)).scopeVars.$index=u,(h=o.cloneNode(!0)).setAttribute("aria-posinset",u+1),h.classList.add("dyn-virtual"),t.dataBindItem(h,c);s.appendChild(h)}e.appendChild(s),s=null,o.classList.add("dyn-prototype");var m=performance.now();g.debug.profile&&window.console&&console.profile&&(console.log("foreach: "+(m-l)),console.profileEnd(),console.timeStamp&&console.timeStamp("foreach end"))},e.observeContent=function(e,t,o){var n=!1;g.isObservable(e)&&(n=!0),t[0].dynContent=g.observe(e,o),t[0].dynContent.contentChanged=n?function(){o(g.value(e))}:function(){o(e())}},e.calculateAssociativeArraySize=function(e){var t=0;for(var o in e)e.hasOwnProperty(o)&&t++;return t},e.isBehindOtherElement=function(e,t){var o=e.getBoundingClientRect(),n=o.left+1,i=o.right-1,r=o.top+1,a=o.bottom-1;if(document.elementFromPoint(n,r)&&document.elementFromPoint(n,r).parentNode===e)return!1;void 0===t&&(t=e);var s=document.elementFromPoint(n,r);return s!==t&&s!==e||((s=document.elementFromPoint(i,r))!==t&&s!==e||((s=document.elementFromPoint(n,a))!==t&&s!==e||(s=document.elementFromPoint(i,a))!==t&&s!==e))},e.isElementInView=function(e){var t=$(e),o="none"!==t.css("display"),n=$(window).scrollTop(),i=n+window.innerHeight,r=t.offset().top,a=r+t.height(),s=$(window).scrollLeft(),l=s+window.innerWidth,u=t.offset().left,d=u+t.width();return a<=i&&n<=r&&d<=l&&s<=u&&o},e.stringHasDoubleByte=function(e){return/[^\u0000-\u00ff]/.test(e)},e.position=function(e,t){e.flyout&&t&&e.flyout!==t&&g.log("$dyn.util.position has a different flyout in options than currentFlyout.");var o=t||e.flyout,n=g.callFunction(e.getAnchor)||(e.of?e.of:null);if(!g.util.isFlyoutAPhoneLookup($(o),n)){var i=void 0,r=void 0;r=g.util.isRTLMode()?(i=void 0!==e.at?e.at:"right bottom",void 0!==e.my?e.my:"right top"):(i=void 0!==e.at?e.at:"left bottom",void 0!==e.my?e.my:"left top");var a=void 0!==e.collision?e.collision:"",s=e.using?e.using:null,l=e.within?e.within:null;if(g.util.isRTLMode())$(o).css("position","absolute");else{var u=$("body > .sysPopup"),d=u[u.length-2];$(d).css("position","absolute")}o.position({of:n,my:r,at:i,collision:a,using:s,within:l})}},e.recordabilityDefault=function(){return{copy:this.copy_Value?function(t){g.callFunction(this.copy_Value,this,[],function(e){t&&t({Value:e.Value,Id:e.ReferenceId,Label:e.Label})})}:void 0,paste:this.paste_Value?function(e,t){g.callFunction(this.paste_Value,this,[e,t])}:void 0,validate:this.validate_Value?function(e){g.callFunction(this.validate_Value,this,[e])}:void 0,validateAllowEditMode:g.value(this.ValidateEditableAllowed)?function(){g.callFunction(this.validate_AllowEdit,this,[])}:void 0,validateDisabled:g.value(this.ValidateDisabledAllowed)?function(){g.callFunction(this.validate_Enabled,this,[])}:void 0,validateEnabled:g.value(this.ValidateEnabledAllowed)?function(){g.callFunction(this.validate_Enabled,this,[])}:void 0,validateReadOnlyMode:g.value(this.ValidateReadOnlyAllowed)?function(){g.callFunction(this.validate_AllowEdit,this,[])}:void 0}},e.focusElement=function(e,t){var o;if(0<$(e.getAttribute("data-dyn-focus"),e).length){var n=$(e.getAttribute("data-dyn-focus"),e).first();if(n.is(":focus")||document.activeElement===e)return g.log.focus&&g.log.focus("Focus: Control was already focused: %s",t||e?e.getAttribute("data-dyn-controlname"):""),void g.focusCompleted(!0);o=n[0]}else o=e;o.focus(),g.focusCompleted(!0),g.log.focus&&g.log.focus("Focus: Control->Setting focus to %s completed",t||e?e.getAttribute("data-dyn-controlname"):"")},e.findFirstFocusableControl=function(e,t,o,n){if(!g.ax.personalizationUtil||!g.ax.personalizationUtil.isPersonalizationModeTurnedOn()){var i=$(e),r=":tabbable",a=".ignore-first-focus",s=$(),l=g.util.isEnhancedTabSequenceEnabled();if(!1===t||l||(!1!==o&&(s=i.find("input, textarea").filter(r+":not([readonly])").not(a),n&&s.length&&(s=s.filter(function(){return 0===$(this).parents(".quickFilter").length}))),0===s.length&&(s=i.find("input, textarea").filter(r).not(a))),0===s.length&&(s=i.find(r).not(a)).length){var u=s[0],d=u.getAttribute("data-dyn-focus");d&&(s=$(u).find(d))}if(0===s.length&&(s=i.find('[data-dyn-role="Part"]').not(a)),s.length)return s[0];g.log.focus&&g.log.focus.error&&g.log.focus.error("Focus: findFirstFocusableControl no controls to focus inside %o",i[0])}},e.findFirstTabbableControl=function(e){return $(e).find(":tabbable:not(.firstFocusable)").first()[0]},e.findLastTabbableControl=function(e){return $(e).find(":tabbable:not(.lastFocusable)").last()[0]},e.isControlFocused=function(e,t){var o;if(e&&0<$(e.getAttribute("data-dyn-focus"),e).length){var n=$(e.getAttribute("data-dyn-focus"),e).first();if(n&&(n.is(":focus")||document.activeElement===n[0])&&(g.log.focus&&g.log.focus("Focus: Form(Form.Id: %s)->isControlFocused (control is focused no-op) control name: %s ",t.Id,e.getAttribute("data-dyn-controlname")),t&&t.ActiveElement()===e))return!0}else{var i=g.context(e);if(null!==(o=null==i?void 0:i.isControlFocused)&&void 0!==o&&o.call(i))return!0}return!1},e.isColumnFocused=function(e){return!(!e||!document.activeElement||$(e).closest("[data-dyn-controlname]").attr("data-dyn-controlname")!==$(document.activeElement).closest("[data-dyn-controlname]").attr("data-dyn-controlname"))},e.isChild=function(t,e){if(!t||!e)return!1;var o=!1,n=$(e).parents().addBack();return 0!==n.filter(function(e){return n[e]===t}).length&&(o=!0),o},e.isForm=function(e){return e.hasAttribute("data-dyn-formid")},e.tabbingContainer=function(r,o,e,t){if(!r)return g.util.emptyfunction;if(g.util.isFlightEnabled(g.util.CLIAllowFullPageTabbingFeature)&&!(r.classList.contains("sysPopup")||"dialog"===r.getAttribute("role")||r.classList.contains("dialog-popup-content")||r.classList.contains("qtip-content")||r.classList.contains("appBar-flyout")))return g.util.emptyfunction;var n,i=$(r);if(i.attr("data-dyn-tabbingContainer","true"),o&&!0!==e&&i.on("focusin.tabbingContainer",function(e){i.attr("dyn-has-focus")||i.attr("dyn-has-focus","true")}),i.prepend('<div aria-hidden="true" tabindex="0" class="firstFocusable ignore-first-focus"></div>'),i.append('<div aria-hidden="true" tabindex="0" class="lastFocusable ignore-first-focus"></div>'),!t){n=new MutationObserver(function(e){if(n.disconnect(),!i.find(":tabbable").first().hasClass("firstFocusable")){var t=i.children(".firstFocusable").detach();t&&t.length&&i.prepend(t)}if(!i.find(":tabbable").last().hasClass("lastFocusable")){var o=i.children(".lastFocusable").detach();o&&o.length&&i.append(o)}n.observe(r,a)});var a={childList:!0};n.observe(r,a)}var s=!1,l=!1;return i.on("keydown.tabbingContainer",function(e){e.which===g.ui.KeyCodes.tab&&(e.shiftKey?l=!0:s=!0)}),i.on("focusout.tabbingContainer",function(e){var t=document.activeElement;e&&e.relatedTarget&&(t=e.relatedTarget),$(t).closest(r).length<=0&&(l=s=!1),o&&!$.contains(i[0],t)&&i.removeAttr("dyn-has-focus")}),i.children(".firstFocusable").on("focusin.tabbingContainer",function(e){if(l){var t=g.util.findLastTabbableControl(r),o=g.context(t);o&&o.element?o.element.scrollIntoView():t&&t.scrollIntoView(),g.log.focus&&g.log.focus("TabbingContainer Focus: Set focus to last focusable control in container: %s",r.id),t&&t.focus(),e.stopPropagation()}else{var n=g.util.findFirstTabbableControl(r),i=g.context(n);i&&i.element?i.element.scrollIntoView():n&&n.scrollIntoView(),g.log.focus&&g.log.focus("TabbingContainer Focus: Set focus to first focusable control in container: %s",r.id),n&&n.focus(),e.stopPropagation()}}),i.children(".lastFocusable").on("focusin.tabbingContainer",function(e){if(s){var t=g.util.findFirstTabbableControl(r),o=g.context(t);o&&o.element?o.element.scrollIntoView():t&&t.scrollIntoView(),g.log.focus&&g.log.focus("TabbingContainer Focus: Set focus to first focusable control in container: %s",r.id),t&&t.focus(),e.stopPropagation()}else{var n=g.util.findLastTabbableControl(r),i=g.context(n);i&&i.element?i.element.scrollIntoView():n&&n.scrollIntoView(),g.log.focus&&g.log.focus("TabbingContainer Focus: Set focus to last focusable control in container: %s",r.id),n&&n.focus(),e.stopPropagation()}}),function(){!t&&n&&(n.disconnect(),n=void 0),i.removeAttr("data-dyn-tabbingContainer"),i.off(".tabbingContainer"),i.children(".firstFocusable, .lastFocusable").off(".tabbingContainer").remove()}},e.scrollingContainer=function(e,t,o){if(!e)return g.util.emptyfunction;var n=$(e),i=n.scrollParent();for(n.scrollParents=[];0<i.length&&i[0]!==document;)n.scrollParents.push(i),i.on("scroll."+t,function(){o(t)}),i=i.scrollParent();return function(){if(n.scrollParents){for(var e=0;e<n.scrollParents.length;e++)n.scrollParents[e].off("scroll."+t);n.scrollParents=[]}}},e.validateChildren=function(e){if(e&&e.Root&&e.Root.HasInvalidControls()){var t=g.value(e.Children);if(t&&t.length)for(var o=0,n=t.length;o<n;o++)t[o]&&(t[o].IsValid&&t[o].IsValid(!0),t[o].Children&&g.util.validateChildren(t[o]))}},e.validateDynChildren=function(e){var t,o,n;if(null!==(o=null===(t=null==e?void 0:e.Root)||void 0===t?void 0:t.HasInvalidControls)&&void 0!==o&&o.call(t)){var i=g.value(g._getChildren(e._element));if(null!=i&&i.length)for(var r=0,a=i.length;r<a;r++){var s=i[r].dynOptions;null!==(n=null==s?void 0:s.isValid)&&void 0!==n&&n.call(s,!0);var l=g.value(g._getChildren(i[r]));null!=l&&l.length&&g.util.validateDynChildren(s)}}},e.includeJavaScript=function(e,t){if(t&&"function"!=typeof t){var o="Error loading file "+e+". callback has wrong type, expected type 'function', got '"+typeof t+"'";g.error({Message:o,Label:o})}var n=document.getElementsByTagName("head")[0],i=document.createElement("script");function r(){a||(t&&t(),g.async.pending.decrement("Finished loading "+e),i.onreadystatechange=null,i.onload=null,a=!0)}i.setAttribute("type","text/javascript"),i.setAttribute("src",e);var a=!1;i.onreadystatechange=function(){"complete"===i.readyState&&r()},i.onload=r,g.async.pending.increment("Started loading "+e),n.appendChild(i)},e.includeJavaScripts=function(e,t,o){if(e.length!==t){g.util.includeJavaScript(e[t],function(){return g.util.includeJavaScripts(e,t+1,o)})}else o&&o(!0,!0)},e.copyMessageDiagnosticsToClipBoard=function(e){var t=document.activeElement,o=document.createElement("textarea");if(o.value=g.value(e.TitleText)+"\n",o.value=g.value(g.browserActivity.TraceLogTenant)?o.value+g.label("MessageBox_Tenant")+g.value(g.browserActivity.TraceLogTenant)+"\n":o.value,o.value=g.value(e.BrowserSessionActivityId)?o.value+g.value(e.BrowserSessionActivityId)+"\n":o.value,o.value=g.value(e.BrowserInteractionTimestamp)?o.value+g.value(e.BrowserInteractionTimestamp)+"\n":o.value,o.value=g.value(e.AOSRoleInstance)?o.value+g.value(e.AOSRoleInstance)+"\n":o.value,o.value=e.buildInformation?o.value+e.buildInformation+"\n":o.value,g.value(e.HasMultipleMessages))for(var n=g.length(e.Messages),i=0;i<n;i++)o.value=o.value+g.value(e.Messages()[i].Label)+"\n";g.value(e.SecondaryText)&&(o.value=o.value+g.value(e.SecondaryText)+"\n"),document.body.appendChild(o),o.select();var r=g.label("Copy_Failed"),a="";try{document.execCommand("copy");r=g.label("Copy_Passed")}catch(e){a=e}document.body.removeChild(o),g.superTooltip.tryOpenSuperTooltip(t,r,a),null!=t&&t.focus()},e.isZoomSupported=function(){return g.layout.provider.name===g.layout.Providers.css3flexbox},e.isInZoomWidthMode=function(){return g.shell.CurrentShellViewPortWidthSize<g.shell.ShellViewPortSizes.smallScreenSize},e.isInZoomHeightMode=function(){return Math.max(document.documentElement.clientHeight||0)<g.shell.ShellViewPortHeightSizes.smallScreenSize},e.hasHorizontalOverflow=function(e){return e.clientWidth<e.scrollWidth},e.navigateHref=function(e){window.location.href=e},e.setAriaExpanded=function(e,t){"DIV"===e.nodeName&&!e.getAttribute("role")||e.setAttribute("aria-expanded",t)},e.warningIECutoffDate="2021-08-17",e.errorIECutoffDate="2022-01-01",e.browserVersionCheck=function(e){if(g.util.isIE()){var t=g.util.isFlightEnabled("CLIIgnoreIEBlockErrorFeature"),o=g.util.isFlightEnabled("CLIIgnoreIEDeprecatedErrorFeature"),n=g.util.isFlightEnabled("CLIIEDeprecatedWarningFeature");if(t){if(n||!o){var i=void 0;i=void 0;var r={Label:g.label("InternetExplorerDeprecationLabel"),Message:""},a=g.label("InternetExplorerDeprecationLearnMore"),s=moment().isAfter(g.util.errorIECutoffDate);if(!o&&s)r.Message=g.label("InternetExplorerDeprecationError"),i=g.messaging.MessageType.error;else if(n){var l=moment().isBefore(g.util.warningIECutoffDate);l?(r.Message=g.label("InternetExplorerDeprecationInfo"),i=g.messaging.MessageType.information):l||(r.Message=g.label("InternetExplorerDeprecationWarning"),i=g.messaging.MessageType.warning)}void 0!==i&&g.persistentMessage(r,g.label("WhatsNew_LinkButton"),!0,a,i,e)}}else g.util.navigateHref("/Error/BrowserNotSupported.htm")}else{if(!g.util.isFlightEnabled("CLIOldBrowserCheckOffFeature")){var u=!1;if($.ua&&$.ua.browser&&("Edge"===$.ua.browser.name&&parseInt($.ua.browser.major,10)<83||"Chrome"===$.ua.browser.name&&parseInt($.ua.browser.major,10)<83)&&(u=!0),u){r={Label:g.label("OldBrowserVersionLabel"),Message:g.label("OldBrowserDeprecationWarning")},a=g.label("InternetExplorerDeprecationLearnMore"),i=g.messaging.MessageType.warning;g.persistentMessage(r,g.label("WhatsNew_LinkButton"),!0,a,i,e)}else g.shell._isSupportedBrowserVersion(!0)}else g.shell._isSupportedBrowserVersion(!0)}},e.hasUserLicense=function(){return!!g.user&&g.value(g.user().HasUserLicense)},e.userLicenseCheck=function(e){var t,o=g.util.isFlightEnabled("UserLicenseCheckErrorMessageFlight"),n=g.util.isFlightEnabled("UserLicenseCheckWarningMessageFlight"),i=g.util.isFlightEnabled("UserLicenseCheckFeature");t=void 0;var r={Label:g.label("UserLicenseCheckLabel"),Message:""},a=g.label("UserLicenseCheckLearnMore");i&&(o||n)&&(g.util.hasUserLicense()||(o?(r.Message=g.label("UserLicenseCheckErrorMessage"),t=g.messaging.MessageType.error):n&&(r.Message=g.label("UserLicenseCheckWarningMessage"),t=g.messaging.MessageType.warning)),void 0!==t&&g.persistentMessage(r,g.label("WhatsNew_LinkButton"),!0,a,t,e))},e.isTouchEnabled=function(){return void 0!==window.ontouchstart||0<navigator.maxTouchPoints},e.isEventListenerOptionsSupported=function(){if(void 0===p)try{var e=Object.defineProperty({},"passive",{get:function(){p=!0}});window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch(e){}return p}}(g.util||(g.util={}))}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(e){var t=(o.prototype.subscribe=function(e,t){var o=this._idAllocator++;return this._subscribers[o]=arguments,o},o.prototype.unsubscribe=function(e){delete this._subscribers[e]},o.prototype.raise=function(e,t){var o,n,i,r;if(0!==this._subscribers.length)if(this._subscribers.length<10){var a=this._subscribers.slice(0);try{for(var s=__values(a),l=s.next();!l.done;l=s.next())(p=l.value)&&(h=p[0])&&h.apply(p[1],[e,t])}catch(e){o={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(o)throw o.error}}}else{var u=Object.keys(this._subscribers);try{for(var d=__values(u),c=d.next();!c.done;c=d.next()){var p,h,m=c.value;(p=this._subscribers[m])&&(h=p[0])&&h.apply(p[1],[e,t])}}catch(e){i={error:e}}finally{try{c&&!c.done&&(r=d.return)&&r.call(d)}finally{if(i)throw i.error}}}},o.prototype.clear=function(){this._subscribers=[]},o.prototype.peek=function(){},o);function o(){this._subscribers=[],this._idAllocator=0,this.id=e._observableId++}e.eventHost=t}($dyn=$dyn||{});var __extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(p){function u(e){return!(!e||!e.valueChanged)}function e(e,t,o,n,i){n&&p.dispose(n);var r=null,a=!1;if(u(e))r=e;else{if("function"!=typeof e)return t.apply(o,[e]),p.observe._objectDispose;r=p.computed(e),a=!0}var s=r.valueChanged.subscribe(function(e){!1===t.apply(o,[p.value(e)])&&r.valueChanged.unsubscribe(s)}),l=p.value(r);return r.__skipFirstTimeFire||i||!1===t.apply(o,[l])&&r.valueChanged.unsubscribe(s),{_observable:r,_subscriptionId:s,dispose:function(){r&&r.valueChanged&&(r.valueChanged.unsubscribe(s),a&&r.valueChanged.clearAllDependencies&&(r.valueChanged.clearAllDependencies(),r=null),this._subscriptionId=null,this._observable=null)}}}function t(e){return new p.observable._ObservableHost(e)._observable}function o(e){var o=i.call(this)||this;return o._observable=Object.assign(function(e,t){return void 0!==e?o.setValue(e,t):o.getValue()},{_current:e,toString:function(){return o.toString()},valueChanged:o}),o}var n,i,r;p._observableId=1,p.isObservable=u,p.value=function(e){return e&&e.valueChanged?e():e},p.peek=function(e){return e&&e.valueChanged?e.valueChanged.peek():e},p.dispose=function(e){e&&(e.valueChanged&&e.valueChanged.dispose?e.valueChanged.dispose():e.dispose&&e.dispose())},p.setValue=function(e,t,o,n){if(e){var i=e[t];p.isObservable(i)?i(o,n):e[t]=o}},p.setObservableValue=function(e,t,o,n){var i=e[t];return p.isObservable(i)?i(o,n):(i=e[t]=p.observable(o),p.debug.general&&(e[t].__prop=t)),i},p.observe=e,(e=p.observe||(p.observe={}))._objectDispose={_observable:void 0,_subscriptionId:void 0,dispose:function(){}},p.bulkObserve=function(o,n,i,r,e,t,a){e&&p.dispose(e);var s,l={},u=[];function d(e){l[e]?l[e]++:l[e]=1}for(var c in p.isObservable(i)?s=i.valueChanged.subscribe(function(e){if(!1===p.value(e)&&l&&Object.keys(l).length){var t={};$.extend(!0,t,l),l={},n.call(r,t)}}):i=!1,o)t&&!t[c]||function(t){var e=o[t];p.isObservable(e)&&e!==i&&u.push(p.observe(e,function(){if(p.value(i))d(t);else{d(t);var e={};$.extend(!0,e,l),l={},n.call(r,e)}},r,void 0,a))}(c);return{_observable:i,_subscriptionId:s,dispose:function(){if(i&&i.valueChanged&&null!=s&&i.valueChanged.unsubscribe(s),u){for(var e=0,t=u.length;e<t;++e)u[e].dispose&&u[e].dispose();u=null}l=null}}},p.oneWayBinding=function(e,t){if(!p.isObservable(e))throw new Error("The parameter 'source' is not observable in binding");if(!p.isObservable(t))throw new Error("The parameter 'target' is not observable in binding");p.disposeOneWayBinding(t),t.__bindingUpdating=!0,t.valueChanged.setValue(e()),t.__bindingUpdating=!1,t.__oneWayBindingSource=e,t.__oneWayBindingId=e.valueChanged.subscribe(function(){t.__bindingUpdating=!0,t.valueChanged.setValue(e()),t.__bindingUpdating=!1})},p.disposeOneWayBinding=function(e){e&&void 0!==e.__oneWayBindingId&&(e.__oneWayBindingSource.valueChanged.unsubscribe(e.__oneWayBindingId),p.debug.general&&(e.__prevOneWayBindings||(e.__prevOneWayBindings=[]),e.__prevOneWayBindings.push({oneWayBindingId:e.__oneWayBindingId,oneWayBindingSource:e.__oneWayBindingSource})),delete e.__oneWayBindingId,delete e.__oneWayBindingSource)},p.observableObject=function(o,n){return void 0===n&&(n=!1),o.__observableObject=void 0,p.observe(o,function(e){if(!o.__syncingObservableObject){var t=n?o:void 0;o.__syncingObservableObject=!0,o.__observableObject=p.syncObservableObject(o.__observableObject,e,void 0,void 0,t),o.__syncingObservableObject=!1}}),o.__observableObject},p.syncObservableObject=function(a,e,t,o,s){if(void 0===o&&(o=!0),e){var l,u;if(u=void 0===t?e:e[t],$.isPlainObject(u))for(var n in o?(a?l=p.value(a):(l={},a=p.observable(l)),a.__source=u):a=l={},u)n&&" "!==n[0]&&(l[n]=p.syncObservableObject(l[n],u,n,void 0,s));else if($.isArray(u)){a=a||p.observable([]),l=a(),a.__source=u,l.length=u.length;for(var i=0,r=u.length;i<r;i++)l[i]=p.syncObservableObject(l[i],u,i.toString(),!1,s);a.push=function(e){var t=l.length;u[t]=e;var o=l.push(p.syncObservableObject(l[t],u,t,!1,s));return a.valueChanged.raise(),s&&(s.__syncingObservableObject=!0,s.valueChanged.raise(),s.__syncingObservableObject=!1),o},a.splice=function(e,t){for(var o=[],n=2;n<arguments.length;n++)o[n-2]=arguments[n];var i=u.splice.apply(u,arguments);l.length=u.length;for(var r=e;r<l.length;r++)l[r]=p.syncObservableObject(null,u,r,!1,s);return a.valueChanged.raise(),s&&(s.__syncingObservableObject=!0,s.valueChanged.raise(),s.__syncingObservableObject=!1),i},a.valueChanged.raise()}else(a=void 0===t?a||p.observable(e):a||p.mappedObservable(e,t,s)).__source=e;return a}},p.mappedObservable=function(e,t,o){var n=p.observable();return n.__source=e,n.__property=t,Object.defineProperty(n,"_current",{get:function(){return n.__source[t]},set:function(e){n.__source[t]=e,o&&(o.__syncingObservableObject=!0,o.valueChanged.raise(void 0,!0),o.__syncingObservableObject=!1)}}),n},p.observable=t,n=t=p.observable||(p.observable={}),i=p.eventHost,__extends(o,i),o.prototype.peek=function(){return this._observable._current},o.prototype.raise=function(e,t){void 0===t&&(t=!1),i.prototype.raise.call(this,this._observable,t)},o.prototype.getValue=function(){var e=p.computed.scope;return e&&this.lastSeenScope!==e&&(e.valueChanged.addDependency(this._observable),this.lastSeenScope=e),this._observable._current},o.prototype.setValue=function(e,t){if(void 0===t&&(t=!1),e===this._observable)throw new Error("Cycle detected in observable");return this._observable._current!==e?(this._observable._current=e,this.raise(this._observable)):t&&this.raise(this._observable,t),this._observable._current},o.prototype.toString=function(){return this._observable._current+" [Observable]"},r=o,n._ObservableHost=r}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){function e(e,t,o){return new r.computed._ComputedHost(e,t,o)._computed}function t(e,t,o){var n=i.call(this)||this;return n.getter=e,n.setter=t,n._computed=Object.assign(function(e,t){return 0<arguments.length?this.setValue(e,t):this.getValue()}.bind(n),{__isOptions:!1,_current:void 0,toString:function(){return n.toString()},valueChanged:n}),n.that=o,n}var o,i,n;r.options=function(n,e){var t=r.computed(function(){var e;e="function"==typeof n?n():n;var t={};for(var o in e)t[o]=r.value(e[o]);return t});return t.__isOptions=!0,r.isObservable(e)&&r.makeDependentOn(t,e),t},r.makeDependentOn=function(t,o){t.__skipFirstTimeFire=t._notificationPending=!!r.peek(o),o&&!t.__updatingFlagChanged&&(t.__updatingFlagChanged=function(e){!r.peek(e)&&t._notificationPending&&(!1===t.valueChanged.isUpdating&&(t._notificationPending=!1,t.valueChanged.raise()),o.valueChanged.unsubscribe(t.__updatingSubscription),t.__updatingSubscription=void 0)},r.peek(o)&&!t.__updatingSubscription&&(t.__updatingSubscription=o.valueChanged.subscribe(t.__updatingFlagChanged)),t.valueChanged.onDependencyChanged=function(){!1===t.valueChanged.isUpdating&&(r.peek(o)?(t._notificationPending=!0,t.__updatingSubscription||(t.__updatingSubscription=o.valueChanged.subscribe(t.__updatingFlagChanged))):t.valueChanged.raise())})},r.performChange=function(e,t,o){var n=e[t];if(r.isObservable(n)){n.__changes=e.__change||[];var i=r.peek(n);n.__changes.push({object:e,type:"update",name:t,oldValue:i}),i!==o&&(n.valueChanged instanceof r.computed._ComputedHost?e.valueChanged.setter(o):n._current=o,n.__microTaskScheduled||(n.__microTaskScheduled=!0,r.microTask(function(){n.__changes=void 0,n.__microTaskScheduled=!1,n.valueChanged.raise()})))}else e[t]=o},r.computed=e,o=e=r.computed||(r.computed={}),i=r.eventHost,__extends(t,i),t.prototype.addDependency=function(e){if(void 0===this.dependencies&&(this.dependencies={}),this._computed===e)throw new Error("Circular dependency");this.dependencies[e.valueChanged.id]||(this.dependencies[e.valueChanged.id]=[e,e.valueChanged.subscribe(this.onDependencyChanged,this)])},t.prototype.clearAllDependencies=function(){if(this.dependencies){for(var e in this.dependencies){var t=this.dependencies[e],o=t[0].valueChanged,n=t[1];o.unsubscribe(n),o.lastSeenScope===this._computed&&(o.lastSeenScope=void 0)}this.dependencies=void 0}this.lastSeenScope&&(this.lastSeenScope=void 0)},t.prototype.peek=function(){return this.getter.apply(this.that)},Object.defineProperty(t.prototype,"value",{get:function(){return this.peek()},enumerable:!1,configurable:!0}),t.prototype.raise=function(){i.prototype.raise.call(this,this._computed)},t.prototype.onDependencyChanged=function(){!1===this.isUpdating&&this.raise()},t.prototype.getValue=function(){var e=r.computed.scope;return r.computed.scope=this._computed,this.isUpdating=!0,this._computed._current=this.getter.apply(this.that),this.isUpdating=!1,(r.computed.scope=e)&&this.lastSeenScope!==e&&(e.valueChanged.addDependency(this._computed),this.lastSeenScope=e),this._computed._current},t.prototype.setValue=function(e,t){return void 0===t&&(t=!1),this.setter&&(this.isUpdating=!0,this.setter.call(this.that,e,t),this.isUpdating=!1,this.raise()),e},t.prototype.toString=function(){return this._computed._current+" [Computed]"},n=t,o._ComputedHost=n}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){function e(e){return new r.observableArray._ObservableHost(e)._observable}r.isObservableArray=function(e){return!(!e||!e.__isObservableArray)},r.observableArray=e,function(e){e._arrayMethods=["pop","push","shift","reverse","sort","splice","unshift"];var t,o=(t=r.observable._ObservableHost,__extends(n,t),n);function n(e){var i=t.call(this,e)||this;return i._observable.__isObservableArray=!0,i._observable.__array=[],Object.defineProperty(i._observable,"len",{get:function(){return this.__array.length}}),Object.defineProperty(i._observable,"_current",{get:function(){return this.__array},set:function(e){if(e){var t=e.length;this.__array.length=t;for(var o=0;o<t;o++)this.__array[o]=e[o]}else this.__array.length=0}}),r.observableArray._arrayMethods.forEach(function(o){i._observable[o]=function(){var e=this._observable.__array,t=e[o].apply(e,arguments);return this._observable.valueChanged.raise(),t}.bind(i)}),i._observable.setAt=function(e,t){var o=i._observable.__array[e]=t;return i.raise(),o},i._observable.clear=function(){i._observable.__array.length=0,i.raise()},i._observable.swap=function(e,t){var o=i._observable.__array,n=o[e];o[e]=o[t],o[t]=n,i.raise()},i._observable._current=e,i}e._ObservableHost=o}(e=r.observableArray||(r.observableArray={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(n){function e(e,t,o){return new n.cachedComputed._CachedComputedHost(e,t,o)._computed}function t(e,t,o){var n=this;return(n=i.call(this,function(){return n._isDirty&&(n._current=e.apply(n.that),n._isDirty=!1),n._current},t,o)||this)._isDirty=!0,n._getter=e,n}var o,i,r;n.cachedComputed=e,o=e=n.cachedComputed||(n.cachedComputed={}),i=n.computed._ComputedHost,__extends(t,i),t.prototype.peek=function(){return this._current=this._getter.apply(this.that),this._current},t.prototype.onDependencyChanged=function(){this._isDirty=!0,i.prototype.onDependencyChanged.call(this)},r=t,o._CachedComputedHost=r}($dyn=$dyn||{}),function(u){var e,t;(e=u.logGroups||(u.logGroups={})).focus="focus",e.performance="performance",e.interactionThrottle="interactionThrottle",e.blockUserInteraction="blockUserInteraction",e.stopPropagation="stopPropagation",e.navigation="navigation",e.boot="Logs events done at start up",e.resources="resources",e.server="Server form log",e.list="list",e.reactList="reactList",e.framework="framework",e.preview="preview",e.async="async",e.form="form",e.shell="shell",e.popups="popups",e.syncManager="syncManager",e.copilot="copilot",e.controlLib="controlLib",e.pcfControlFramework="pcfControlFramework",u.debug={log:{}},u.debugSettings={bindingErrorAsMessages:{category:"Framework",title:"Outputs binding failures to the infolog"},combinedSearch:{category:"Experiments",title:"Enable the combined action/pages search."},develop:{resources:["/Resources/Html/DeveloperTools.htm","/Resources/Html/InternalDeveloperTools.htm"],title:"Loads client developer tools"},domPerformance:{category:"Performance",title:"Enables the dynPerformance property on dom elements for performance analysis (degrades performance a medium amount)"},fieldHelp:{category:"General",title:"Show field level help icon"},findControl:{category:"Framework",degradesPerf:!0,title:"Debugs the finding of controls"},general:{resources:["/Resources/Html/DeveloperTools.htm","/Resources/Html/InternalDeveloperTools.htm"],title:"Also known as '&debug=true', starts debug mode which logs to the console and captures various debug information"},gridAppend:{category:"Experiments",title:"Appends (Inserts below existing) new rows in grid"},gridFastEdit:{category:"Experiments",title:"Enables fast grid row creation/edit"},latency:{category:"Performance",title:"Additional latency on all interaction calls to simulate a real environment"},layoutFlex:"Enable the flexbox layout for all browsers",layoutGrid:"Shows the layout grid to verify the UI conforms to grid unit",logOnlyActive:{title:"Logs only the active groups in the console"},noConfirmExit:"Leave without confirming exit",performance:{category:"Performance",title:"When doing an ETW performance capture this option should be enabled"},profile:{category:"Performance",title:"Enables profile captures (obsolete, use individual debug flags)"},profileInteractions:{category:"Performance",title:"Enables profiling interaction processing time (the server form processInteractions method)"},settings:{resources:["/Resources/Html/DeveloperTools.htm","/Resources/Html/InternalDeveloperTools.htm"]},showErrors:{title:"Shows call stacks of errors in the error box"},staticLoaderOn:{category:"Experiments",title:"Enable static loader"},template:{category:"Framework",title:"Debug issues with loading templates"},traceParser:{category:"Performance",title:"Enables access to Trace Parser button in the Navigation Bar"},trackFormPerformance:{category:"Performance",title:"Track form render performance over time (uses local storage)"},typeAheadTimer:{category:"Performance",title:"Configures the timeout interval for type-ahead launched lookups"},useRTL:{category:"General",title:"Run the site in RTL mode"},verboseBinding:{category:"Framework",degradesPerf:!0,title:"*Very* verbose, outputs the results of all binding handlers"},verboseForeach:{category:"Framework",degradesPerf:!0,title:"Logs the timing for each interaction of the foreach"},verboseLayoutControlName:{category:"Framework",degradesPerf:!0,title:"Add the control or form name to the arrange method"},verboseModels:{category:"Framework",degradesPerf:!0,title:"Logs the models being used by bindings"},verboseStopPropagation:"Captures places where we stop event propagation"},u.flagsSettings={confirmExit:"Enables the confirm exit dialog",disableAnimations:"Disable animations.",disableBrowserVersionCheck:"Disables the browser version check",disableCaptureRightClick:"Enables easier debugging by grid by allowing the inspect in the right click menu.",disableConnectivityCheck:"Disables the check to see if the client is online (assumes connected)",disableFastFetch:"Disables grids from using fast fetch to fill data cache",disableFocusReactions:"Disable reactions to focus",disableGlobalErrors:{title:"Uses the $dyn.error api to report unhandled exceptions."},disableNPS:"Disables the NPS prompt",disablePing:"Disables pinging the server",disablePreview:"Disables previews",disableUserLicenseCheck:"Disabled the user license check",enableAutoClose:{title:"Auto close is currently causing problems in the control gallery, this flag disables auto close"},enableFocusTooltip:"Enable Tooltips on focus",enableResources:"Enables the &resource=x query string option to enable loading the initial form as a resource",fromVS:"Used by the &vs=true query string",popoutKeepOpen:"Keep popped out windows open when root navigation events happen",searchTraceLog:"Search local node trace log with browser activity IDs.",staticGenerators:"Should we use static values (normally used in tests)",updateURL:"Updates the browser url",useBrowserContextMenu:"Shows the normal browser context menu, instead of the custom menu",useHtmlImports:"Enables native resource loading using the html imports specification"},u.flags={confirmExit:!1,disableAnimations:!1,disableBrowserVersionCheck:!1,disableConnectivityCheck:!1,disableFastFetch:!1,disableFocusReactions:!0,disableGlobalErrors:!1,disableNPS:!1,disablePing:!1,disablePreview:!1,disableUserLicenseCheck:!1,enableAutoClose:!0,enableFocusTooltip:!1,enableResources:!0,fromVS:!1,observableControlOptions:!1,officeNavBar:!1,popoutKeepOpen:!1,searchTraceLog:!0,staticGenerators:!1,updateURL:!1,useBrowserContextMenu:!1,useDesignTimeView:!1,useHtmlImports:!1},(u.resources||(u.resources={})).required={},(t=u.util||(u.util={})).location=u.util.parseUrl(window.location),t.location.query=u.util.parseQueryString(window.location.search),u.util.location.query.staticGenerators&&(u.flags.staticGenerators=!0),u.util.location.query.popout&&(u.popout=!0),"true"===u.util.location.query.embedded&&(u.isEmbedded=!0),(u.util.location.query.limitednav||u.popout||u.isEmbedded)&&(u.restrictedNavigation=!0),u.util.location.query.disableConnectivityCheck&&(u.flags.disableConnectivityCheck=!0),$(document).on("updateUtilLocationQuery",function(){var e=window.location.search,t=e.indexOf("?")+1;e=e.substring(t),u.util.location.queryString!==e&&(u.util.location.queryString=e,u.util.location.query=u.util.parseQueryString(e))}),function(){var e=u.util.location.query.debug;try{if(window.dynEnableSavedSettings&&window.localStorage){var t=localStorage.getItem("$dyn.debug");t&&(u.debug=JSON.parse(t));var o=localStorage.getItem("$dyn.flags");o&&(u.flags=JSON.parse(o))}}catch(e){console.log("Error using local storage for debug settings: %o",e)}if("true"===e)u.debug.general=!0;else if(e)if("{"===e.charAt(0)){var n=JSON.parse(e);$.extend(!0,u.debug,n)}else for(var i=0,r=(e=e.split(",")).length;i<r;i++)u.debug[e[i]]=!0;for(var a in!0===u.debug.vs&&((u.flags.fromVS=!0)===u.debug.confirmExit&&(u.flags.confirmExit=!0),u.debug.develop=!0,u.debug.showErrors=!0),u.debug.general&&(u.debug.showErrors=!0),u.debug)if(u.debug[a]){var s=u.debugSettings[a];if(s){var l=s.resources;if(l)for(i=0,r=l.length;i<r;i++)u.resources.required[l[i]]=!0}}}(),u.util.location.query.flights&&(u.debug.flights=JSON.parse(u.util.location.query.flights)),u.debug.noConfirmExit&&(u.flags.confirmExit=!1),u.enableLogging=function(e){if(window.console){var t=Function.prototype.bind.call(console.log,console);console.group?u._log=t:u._log=Object.assign(function(){0<arguments.length&&(arguments[0]=Array(Math.max(u._log.groupDepth,0)).join("  >  ")+arguments[0]),t.apply(console,arguments)},{groupDepth:0})}else u._log=Object.assign(function(){},{groupDepth:0});u.log=e?u._log:function(){};var o=u.debug.logOnlyActive;if(o&&(u.log=function(){}),u.debug.log)for(var n in u.logGroups)(!o&&e||u.debug.log[n])&&(u.log[n]=u._log,window.console&&(u.log[n].error=Function.prototype.bind.call(console.error,console),u.log[n].warn=Function.prototype.bind.call(console.warn,console),u.log[n].info=Function.prototype.bind.call(console.info,console),u.log[n].trace=Function.prototype.bind.call(console.trace,console)));if(e&&window.console?u.logWarning=Function.prototype.bind.call(console.warn,console):u.logWarning=function(){},window.console?u.logError=Function.prototype.bind.call(console.error,console):u.logError=function(){},window.console){var i=Function.prototype.bind.call(console.error,console);u.logDeprecated=function(){i.apply(console,["DEPRECATED: "].concat(Array.prototype.slice.call(arguments)))}}else u.logDeprecated=function(){};e&&window.console&&window.console.time&&window.console.timeEnd?(u.time=Function.prototype.bind.call(console.time,console),u.timeEnd=Function.prototype.bind.call(console.timeEnd,console)):(u.time=function(){},u.timeEnd=function(){}),e&&window.console&&console.group?(u._logGroup=Function.prototype.bind.call(console.group,console),u._logGroupEnd=Function.prototype.bind.call(console.groupEnd,console)):(u._logGroup=function(){u._log.groupDepth++,u._log.apply(null,arguments)},u._logGroupEnd=function(){u._log.groupDepth--}),e&&(window.console&&console.group?(u.logGroup=Function.prototype.bind.call(console.group,console),u.logGroupEnd=Function.prototype.bind.call(console.groupEnd,console),u.supportsLogGroup=!0):(u.logGroup=function(){u.log.groupDepth++,u.log.apply(null,arguments)},u.logGroupEnd=function(){u.log.groupDepth--})),u.logGroup||(u.logGroup=u.logGroupEnd=function(){})},u.enableLogging(u.debug.general),u.saveSettings=function(){try{window.localStorage&&(delete u.debug.settings,localStorage.setItem("$dyn.debug",JSON.stringify(u.debug)),localStorage.setItem("$dyn.flags",JSON.stringify(u.flags)))}catch(e){"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name?u.logError("Binding Debug: local storage space quota error"):u.logError("Binding Debug: local storage error: %s",e.name)}},u.resetSettings=function(){try{window.localStorage&&(localStorage.removeItem("$dyn.debug"),localStorage.removeItem("$dyn.flags"))}catch(e){}}}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(a){Globalize.addCultureInfo("en",{messages:{Framework_ElapsedTimeLessThanMinute:"Less than a minute",Framework_ElapsedTimeMinute:"One minute",Framework_ElapsedTimeMinutes:"{0} minutes",Framework_ElapsedTimeMoreThanHour:"More than a hour",Framework_LocalStorageError:"Local Storage space error",Framework_LocalStorageQuotaError:"Local Storage space quota exceeded error",Framework_UnexpectedError:"An unexpected client error has occurred"}});var r,o,i=!(a._microTasks=[]);a.clientBusy=a.observable(!1),a.extendedStyles={},a.isDisposable=function(e){return e&&e.dispose},(r=a.boot||(a.boot={})).start=function(){a.log.boot&&a.log.boot("Boot: start"),a.time("Init"),a.boot.preBoot(),a.resources.getRequired().always(function(){a.boot.preStart(),a.boot.loadShell(),a.boot.initShell(),a.boot.init(),a.timeEnd("Init"),a.boot.loadInitalForm(),a.log.boot&&a.log.boot("Boot: unlocking layout"),a.ui.layout(!1),a.boot.postNavigate(),a.boot.startMonitoring(),"undefined"!=typeof msWriteProfilerMark&&msWriteProfilerMark("initShell,StopTM"),a.log.boot&&a.log.boot("Boot: started")})},r.preBoot=function(){a.layout.supportsFlexOrGrid()&&a.util.historySupported()&&a.util.mutationObserverSupported()||a.util.navigateHref("/Error/BrowserNotSupported.htm")},r.preStart=function(){},r.loadShell=function(){var e=new a.PerformanceTask("dataBindShell").start();a.flags.useDesignTimeView&&(a.isEmbedded=!0,a.restrictedNavigation=!0,a.flags.disableBrowserVersionCheck=!0,a.flags.disableUserLicenseCheck=!0),a.shell.isShellInitializing()||(a.async.pending.increment("Starting to initialize isShellInitializing true"),a.shell.isShellInitializing(!0)),a.restrictedNavigation&&(a.shell.NavBarDocumentId="PopoutNavBar",a.shell.CompanyDocumentId="PopoutCompany",a.shell.UserDocumentId="PopoutUser",a.shell.restartNavigationStack=function(){},a.popout?a.shell.goHome=function(){}:a.shell.goHome=function(){window.location.reload()}),a.isEmbedded&&($(document.body).addClass("isEmbedded"),a.dataBind(document.getElementById(a.shell.MessageCenterEmbeddedId))),a.dataBind(document.getElementById(a.shell.NavBarDocumentId)),$("#mainContainer").css("visibility","hidden"),a.serverForm||(a.shell.ProductName(a.shell._NoServerProductName),a.shell.ProductShortName(a.shell._NoServerProductName)),a.dataBind(document.getElementById("ShellBlockingDiv")),a.dataBind(document.getElementById("O365Switcher")),e.stop()},r.initShell=function(){a.shell.init()},r.startMonitoring=function(){a.value(a.shell.hasRestrictedInternet)||a.observe(function(){return a.util.isFlightEnabled("CLIEnableMOITelemetryFeature")},function(e){if(e){var t="".concat(a.shell.rootPath,"Scripts/ext/fpv2.").concat(a.IsDebugBuild?"":"min.","js"),o=document.createElement("script");o.setAttribute("src",t);var n=function(){var e=a.browserActivity.TraceLogTenant,t=a.browserActivity.BrowserSessionActivity.Id;window.Footprint.start("d365fo",["fpc.msedge.net/conf/v2/d365fo/fpconfig.min.json"],0,JSON.stringify({oid:e,sid:t}),"",{"placeholder.dynamics.com":a.util.fullHost()},function(e){a.debug.vs&&e.forEach(function(e){console.log("".concat(e.Conn," ").concat(i[e.T],": ").concat(e.Result.toString()))})})},i={1:"Latency",8:"Throughput"};return o.onload=function(){n(),r.monitoringInterval=window.setInterval(n,6e5)},document.head.appendChild(o),!1}})},r.init=function(){},r.loadInitalForm=function(){},r.postNavigate=function(){},a._performMicroTasks=function(){i=!0,a.log.framework&&a.log.framework("Framework: performing micro tasks");for(var e=a._microTasks.slice(0),t=a._microTasks.length=0,o=e.length;t<o;t++){var n=e[t];n.func.call(n.thisArg)}i=!1};var n,s=0;if(a.util.mutationObserverSupported())n=new MutationObserver(a._performMicroTasks);else{a.logError("The browser you are currently using is not supported for this application. Please switch to Microsoft Edge or another modern browser.")}a.microTask=function(e,t){i?e.call(t):n&&(a._microTasks.push({func:e,thisArg:t}),o||(o=document.createElement("span"),n.observe(o,{attributes:!0})),s++,o.setAttribute("count",s))},a.url=function(e){var t=a.util.parseUrl(e);return 0!==t.path.indexOf("/")?a.shell.rootPath+a.applicationRoot+t.path:t.url},a.applicationRoot="Resources/Html/",a.extendPrototype=function(e,t){return Object.create(e,a.getOwnPropertyDescriptors(t))},a.getOwnPropertyDescriptors=function(e){var t,o,n=Object.getOwnPropertyNames(e),i={};try{for(var r=__values(n),a=r.next();!a.done;a=r.next()){var s=a.value;i[s]=Object.getOwnPropertyDescriptor(e,s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}return i},window.msWriteProfilerMark||(window.msWriteProfilerMark=a.debug.performance&&window.console&&console.timeStamp&&Function.prototype.bind.call(console.timeStamp,console)||function(){});var e=(t.prototype.start=function(e){var t;return t=this.enableDetails&&void 0!==e?this.taskName+" "+e+a.PerformanceTask.startSuffix:this.startTaskName,msWriteProfilerMark(t),this.log&&this.log("performance: "+t),this},t.prototype.stop=function(e){var t;return t=this.enableDetails&&void 0!==e?this.taskName+" "+e+a.PerformanceTask.stopSuffix:this.endTaskName,msWriteProfilerMark(t),this.log&&this.log("performance: "+t),this},t.startSuffix=",StartTM",t.stopSuffix=",StopTM",t);function t(e,t){this.taskName=e,this.startTaskName=e+a.PerformanceTask.startSuffix,this.endTaskName=e+a.PerformanceTask.stopSuffix,this.enableDetails=!0,this.log=t?a.log.performance:null}a.PerformanceTask=e;var l,u,d,c=(p.prototype.start=function(e,t){if(this.enableDetails?this._writeDetails(a.PerformanceTask.startSuffix,e,t):(msWriteProfilerMark(this.startTaskName),this.log&&this.log("performance: "+this.startTaskName)),this.verbose){var o=e.dynPerformance;t=void 0!==t?" "+t:"",(o=o||(e.dynPerformance=[])).push(a.performanceMark(this.startTaskName+t))}return this},p.prototype.stop=function(e,t){if(this.enableDetails?this._writeDetails(a.PerformanceTask.stopSuffix,e,t):(msWriteProfilerMark(this.endTaskName),this.log&&this.log("performance: "+this.endTaskName)),this.verbose){var o=e.dynPerformance;(o=o||(e.dynPerformance=[])).push&&(t=void 0!==t?" "+t:"",o.push(a.performanceMark(this.endTaskName+t)))}},p.prototype._writeDetails=function(e,t,o){o=void 0!==o?o:"";var n=$(t).addBack().closest("[data-dyn-controlname]"),i=n.attr("data-dyn-role")||"";msWriteProfilerMark(this.taskName+".ByType "+i+e);var r=n.attr("data-dyn-controlname")||"";r&&msWriteProfilerMark(this.taskName+".ByName "+r+"-"+i+e),o=o?" "+o:"";var a=this.taskName+o+e;msWriteProfilerMark(a),this.log&&this.log("performance: "+a)},p);function p(e,t){void 0===t&&(t=!1),this.taskName=e,this.startTaskName=e+a.PerformanceTask.startSuffix,this.endTaskName=e+a.PerformanceTask.stopSuffix,this.verbose=a.debug.domPerformance,this.log=t?a.log.performance:null,this.enableDetails=!0}function h(e){var t=a.value(e);return"function"==typeof t?t:a.util.emptyfunction}function m(e,t){return void 0!==e?e:t}a.DomPerformanceTask=c,a.performanceMark=function(e){var t=Object.assign(function(){},{markName:e,startTime:performance.now()});return t.toString=function(){return this.markName+": "+this.startTime},t},a.controlOptions=function(e){if(!e)throw new Error("Argument null or undefined: controlElement");var t=a.ui.getLiveControl(e);return t||e.dynOptions},(u=l=a.Const||(a.Const={})).roleAttribute="data-dyn-role",u.roleInstance="dynRoleInstance",u.stopBindingAttribute="data-dyn-stop-binding",u.templateApplied="data-dyn-template-applied",u.templateAttribute="data-dyn-template",u.templateResolveAction="dynTemplateResolveAction",a.const=l,a.scrollIntoView=function(e,t){t.scrollTop=e.offsetTop},a.length=function(e){var t=a.value(e);if(t)return t.len?t.len:a.value(t.length)},a.getFunction=h,a.function=h,a.callFunction=function(e,t){for(var o=[],n=2;n<arguments.length;n++)o[n-2]=arguments[n];var i=a.value(e);return i&&"function"==typeof i?i.apply(t,Array.prototype.slice.call(arguments,2)):null},a.applyFunction=function(e,t,o){var n=a.value(e);return n&&"function"==typeof n?n.apply(t,o):null},a.label=function(e){var t=Globalize.localize(e);return void 0!==t?t:e},a.getDefault=m,a.default=m,a.focusCompleted=a.observable(!1),a.clientInError=a.observable(!1),(a.date||(a.date={})).format=function(e,t){var o=a.value(e);return o?o instanceof Date?Globalize.format(o,t):Globalize.format(new Date(o),t):""},a.format=function(e){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];return null!=e&&e.replace?e.replace(/{(\d+)}/g,function(e,t){var o=Number(t);if(isNaN(o)||void 0===i[o])return"";var n=a.value(i[o]);if("object"!=typeof n)return n;if(n&&"function"==typeof n.hasOwnProperty&&n.hasOwnProperty("toString"))return n.toString();try{return JSON.stringify(n)}catch(e){return n}}):e},a.logNonFatalError=function(e){var t={};(a.debug.showErrors||a.version&&"debug"===a.version.buildType)&&(t.SecondaryText=e),a.telemetry.handleClientError(t,"Framework_UnexpectedError",{callStack:e}),a.logError(e)},a.assert=a.debug.general?function(e,t){if(!e)throw new Error(t||a.label("Assertion failed"))}:function(){},a.templatedParentElement=function(e){return e.dynTemplatedParent},a.children=function(e){return a._getChildren(e)()},a._setParent=function(e,t){var o=e.dynTemplatedParent;if(o&&o!==t){var n=a._getChildren(o),i=a.value(n),r=-1;i&&(r=i.indexOf(e)),0<=r&&(i.splice(r,1),n.valueChanged.raise())}e.dynTemplatedParent=t},a._getChildren=function(o){var e=o.dynChildren;if(!o.dynChildren){var n=[];o.dynChildren=e=a.observable(n),e.__templateChildren=!0,e.set=function(e,t){a._setParent(t,o),n[e]=t},e.get=function(e){return n[e]},e.splice=function(){for(var e=arguments.length,t=2;t<e;t++)a._setParent(arguments[t],o);return n.splice.apply(n,arguments)}}return e},a.childHierarchyChanged=function(e){return a.computed(function(){var i=function(e){if(e)for(var t=0,o=e.length;t<o;t++){var n=e[t];i(a.value(n.dynChildren))}};i(a.value(e.dynChildren))})},a.isServerBoundDataSource=function(e){return e&&void 0!==e.__dataSourceName},(d=a.htmlDocument||(a.htmlDocument={})).setFavicon=function(e){var t=document.createElement("link");t.type="image/x-icon",t.rel="shortcut icon",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)},d.setMetaValue=function(e,t,o){var n=document.getElementsByName(e);n&&n[0].setAttribute("content",o+t)},d.setLinkIconValue=function(e,t,o){for(var n=document.getElementsByTagName("link"),i=n.length,r=0;r<i;r++){var a=n[r];if(a.rel===e){var s=a.getAttribute("sizes");s===t.small[0]?a.setAttribute("href",o+t.small[1]):s===t.medium[0]?a.setAttribute("href",o+t.medium[1]):s===t.large[0]?a.setAttribute("href",o+t.large[1]):s===t.xlarge[0]&&a.setAttribute("href",o+t.xlarge[1])}}}}($dyn=$dyn||{}),function(F){!function(e){var t,o,n,i,r,a,s,l,u,d,c,p,h,m,v,g,y,f,b,C,w,_,S,I;e.updating=F.observable(!1),e.layout=F.observable(!1),e.typeAheadTimer=450,(t=e.ButtonDisplay||(e.ButtonDisplay={})).textOnly="TextOnly",t.imageOnly="ImageOnly",t.textWithImageAbove="TextWithImageAbove",t.textWithImageBelow="TextWithImageBelow",t.textWithImageLeft="TextWithImageLeft",t.textWithImageRight="TextWithImageRight",t.backgroundImage="BackgroundImage",(o=e.ButtonStyle||(e.ButtonStyle={})).none="",o.commandLink="CommandLink",o.link="Link",(n=e.ChangeMode||(e.ChangeMode={}))[n.modified=0]="modified",n[n.dirty=1]="dirty",(i=e.ImageType||(e.ImageType={})).symbol="Symbol",i.url="URL",i.base64="Base64",i._axResource="AOTResource",(r=e.SortDirection||(e.SortDirection={}))[r.none=-1]="none",r[r.ascending=0]="ascending",r[r.descending=1]="descending",(a=e.GridLines||(e.GridLines={})).Auto="Auto",a.None="None",a.Vertical="Vertical",a.All="All",(s=e.SignDisplayType||(e.SignDisplayType={})).None="None",s.Prefixed="Prefixed",s.Suffixed="Suffixed",s.Parentheses="Parentheses",s.Auto="Auto",(l=e.ThousandSeparator||(e.ThousandSeparator={})).comma="Comma",l.space="Space",l.apostrophe="Apostrophe",l.dot="Dot",l.none="None",l.auto="Auto",(u=e.DecimalSeparator||(e.DecimalSeparator={})).comma="Comma",u.dot="Dot",u.auto="Auto",(d=e.DateFormat||(e.DateFormat={})).auto="Auto",d.YMD="YMD",d.YDM="YDM",d.MYD="MYD",d.MDY="MDY",d.DYM="DYM",d.DMY="DMY",(c=e.ControlTypes||(e.ControlTypes={})).String="Input",c.Date="Date",c.DateTime="DateTime",c.Time="Time",c.Integer="Integer",c.Int64="Int64",c.Real="Real",c.Enum="Enum",c.Guid="Guid",c.ComboBox="ComboBox",e.autoValue="Auto",(p=e.DialogSize||(e.DialogSize={})).small="Small",p.medium="Medium",p.large="Large",p.full="Full",(h=e.ReadyState||(e.ReadyState={})).uninitialized="uninitialized",h.request="request",h.preloadRequest="preloadRequest",h.preloading="preloading",h.loading="loading",h.ready="ready",h.aborted="aborted",h.closed="closed",(m=e.FrameOptionButton||(e.FrameOptionButton={})).Hide="Hide",m.Radio="Radio",m.Check="Check",m.None="None",(v=e.TileType||(e.TileType={})).standard="Standard",v.link="Link",v.count="Count",v.kpi="KPI",(g=e.ViewSelectorButtonOption||(e.ViewSelectorButtonOption={})).largeViewSelector="largeViewSelector",g.largeViewSelectorExtendedStyle="headerLarge",g.smallViewSelectorExtendedStyle="headerSmall",g.showSeperator="showSeperator",g.viewButtonWithContext="viewButtonWithContext",g.viewButtonWithNoContext="viewButtonWithNoContext",g.viewButtonWithEntity="viewButtonWithEntity",(y=e.FormCaptionContainerOptions||(e.FormCaptionContainerOptions={})).smallCaptionContainer="formCaptionSmallOverride",y.largeCaptionContainer="formCaptionLargeOverride",e.TileFastestRetryFrequencyMilliseconds=5e3,e.TileStandardRetryFrequencyMilliseconds=6e5,e.ChangeEvent="dyn-change",e.ReadOnlyEvent="dyn-readonly-event",e.PasswordString="**********",(f=e.InputType||(e.InputType={}))[f.notSpecified=0]="notSpecified",f[f.mouse=1]="mouse",f[f.keyboard=2]="keyboard",(b=e.ScrollDirection||(e.ScrollDirection={}))[b.none=-1]="none",b[b.up=0]="up",b[b.down=1]="down",(C=e.MouseButtonCodes||(e.MouseButtonCodes={}))[C.leftButton=1]="leftButton",C[C.middleButton=2]="middleButton",C[C.rightButton=3]="rightButton",(w=e.MouseEventButtonCodes||(e.MouseEventButtonCodes={})).leftButton=0,w.middleButton=1,w.rightButton=2,w.fromMouseButtonCode=function(e){return e-1},(_=e.StatusIndicator||(e.StatusIndicator={}))[_.none=0]="none",_[_.mandatory=1]="mandatory",_[_.warning=2]="warning",(S=e.CheckBoxStyle||(e.CheckBoxStyle={})).auto="Auto",S.checkbox="Checkbox",S.toggle="Toggle",(I=e.TabStyle||(e.TabStyle={})).standard="Tabs",I.vertical="VerticalTabs",I.panorama="Panorama",I.fasttab="FastTab",I.droplist="DropList",e.tabWidth=function(e){return F.ui.autoProperty(F.layout.Size.available,e,"Width")},e.tabHeight=function(e){return F.ui.autoProperty(F.layout.Size.available,e,"Height")},e.columnsProperty=function(t,o){return F.computed(function(){var e=F.value(o.Columns);return e===F.layout.Columns.fill&&(e=t),e},function(e){F.setValue(o,"Columns",e)})},e.layoutBlock=function(e){var t=F.ui.layout();t||F.ui.layout(!0),e(),t||F.ui.layout(!1)},e.updateBlock=function(e,t,o){var n=!1;F.peek(F.ui.updating)||(F.ui.updating(!0),n=!0);var i=!1;e&&((i=F.ui.layout())||F.ui.layout(!0)),t.call(o),n&&F.ui.updating(!1),e&&(F.layout.queueArrange(e),i||F.ui.layout(!1))},e.uniqueId=1,e.setAttribute=function(e,t,o,n){void 0!==o&&(null==t?e.removeAttribute(n):e.setAttribute(n,t))},e.getSelection=function(){var e;try{document.selection?e=document.selection:window.getSelection?e=window.getSelection():document.getSelection&&(e=document.getSelection())}catch(e){}return e},e.selectionStart=function(e,t){try{if(e)return t||0===t?e.selectionStart=t:e.selectionStart}catch(e){return 0}},e.selectionEnd=function(e,t){try{if(e)return t||0===t?e.selectionEnd=t:e.selectionEnd}catch(e){return 0}},e.stringAttributeSetter=function(n){return F.logDeprecated("$dyn.ui.stringAttributeSetter"),function(e,t,o){null!=t?e.setAttribute(n,t):null!=o&&e.removeAttribute(n)}},e.stringAttributeGetter=function(t){return F.logDeprecated("$dyn.ui.stringAttributeGetter"),function(e){return e.getAttribute(t)}},e.booleanAttributeSetter=function(n){return function(e,t,o){t!==o&&(t?e.setAttribute(n,""):e.removeAttribute(n))}},e.replaceCssClass=function(e,t,o){F.isObservable(o)&&(o=F.value(o)),o&&e&&e.classList.remove(o),F.isObservable(t)&&(t=F.value(t)),t&&e&&e.classList.add(t)},e.toggleCssClass=function(e,t,o,n){F.isObservable(t)&&(t=F.value(t)),t?e.classList.add(n):e.classList.remove(n)},e.boolCssGetter=function(t){return F.logDeprecated("$dyn.ui.boolCssGetter"),function(e){return e.classList.contains(t)}},e.boolCssSetter=function(n){return F.logDeprecated("$dyn.ui.boolCssSetter"),function(e,t,o){t?e.classList.add(n):e.classList.remove(n)}},e.formHeaderCreate=function(e){return F.ui.controlOptions(function(){return{Caption:e.Caption,FormType:e.TypeName,HeaderClicked:function(){e.GoGridView()},TitleFields:e.ParentTitleFields}},e)},e.createControl=function(e,t,o,n){n=n||"div";var i=document.createElement(n);return F.ui.updateBlock(i,function(){i.setAttribute("data-dyn-role",e),i.dynOptions=t,F.dataBind(i,o)}),i},e.createChildControl=function(i,r,e,a){var s=F.context(e);if(!s)throw new TypeError("Parameter 'parentControl' is required");var l,u=(a=a||{}).tagName;return u=u||"div",F.ui.updateBlock(e,function(){s.Updating&&s.Updating(!0),(l=document.createElement(u)).setAttribute("data-dyn-role",i),a.class&&l.classList.add(a.class),l.dynOptions=r;var e=F._getChildren(s.element),t=F.length(e),o=a.insertSelector?s.element.querySelector(a.insertSelector):s.element,n=a.index;void 0===n?(o.appendChild(l),e.set(t,l)):(o.insertBefore(l,e.get(n)),e.splice(n,0,l)),F.role(l.parentElement||l).dataBindChild(l,s.element.dynContext),e.valueChanged.raise(),s.Children&&s.Children.valueChanged.raise(),s.Updating&&s.Updating(!1)}),l},e.removeChildControl=function(e,t){F.unbind(e),e.remove();var o=F.context(t);if(o){var n=F._getChildren(o.element),i=n().indexOf(e);0<=i&&n.splice(i,1)}},e.removeFocus=function(e){var t;try{t=document.activeElement}catch(e){}if(t&&(void 0===e||e.length&&(0<e.filter(t).length||0<e.has(t).length))){F.log.focus&&F.log.focus("$dyn.ui.removeFocus from %s",t.id);var o=F.shell.clearBodyFocusCorrection();return $(t).blur(),F.shell.bodyFocusCorrection=o,{element:t,selectionStart:F.ui.selectionStart(t),selectionEnd:F.ui.selectionEnd(t)}}},e.restoreFocus=function(e){var t,o,n;if(e.element?(t=e.element,o=e.selectionStart,n=e.selectionEnd):t=e,t&&t!==document.activeElement&&t.focus&&(F.log.focus&&F.log.focus("$dyn.ui.restoreFocus to %s",t.id),t.focus(),t.value)){var i=t;void 0===(o||n)?(F.ui.selectionStart(i,i.value.length),F.ui.selectionEnd(i,i.value.length)):(F.ui.selectionStart(i,o),F.ui.selectionEnd(i,n))}},e.selector=function(){return new F.ui.CssSelector};var T=(x.prototype.id=function(e){return this._selectorString+="#"+this._serializeIdentifier(e),this},x.prototype.tag=function(e){return this._selectorString+=this._serializeIdentifier(e),this},x.prototype.css=function(e){return this._selectorString+="."+this._serializeIdentifier(e),this},x.prototype.desc=function(){return this._selectorString+=" ",this},x.prototype.child=function(){return this._selectorString+=" > ",this},x.prototype.sibling=function(){return this._selectorString+=" + ",this},x.prototype.following=function(){return this._selectorString+=" ~ ",this},x.prototype.nthChild=function(e){if(!(0<=e))throw new Error("index must be a number greater than or equal 0");return this._selectorString+=":nth-child("+e+")",this},x.prototype.not=function(e){if(!(e instanceof F.ui.CssSelector))throw new Error('Invalid value for argument "selector"');return this._selectorString+=":not("+e.toString()+")",this},x.prototype.attr=function(e,t,o){var n="["+this._serializeIdentifier(e);if(void 0!==t){if(o)switch(o){case"=":case"~=":case"|=":case"^=":case"$=":case"*=":break;default:o="="}else o="=";n+=o,null===t?t="":"string"!=typeof t&&(t=t.toString()),n+='"'+this._serializeString(t)+'"'}return n+="]",this._selectorString+=n,this},x.prototype.toString=function(){return this._selectorString},x.prototype.find=function(e){return e.querySelectorAll(this.toString())},x.prototype._serializeString=function(e){for(var t="",o=!1,n=0,i=e.length;n<i;n++){var r=e.charCodeAt(n);if(0===r)throw new Error("InvalidCharacterError");1<=r&&r<=31||127<=r&&r<=159?(!o&&0<n&&(t=e.substring(0,n)),t+="\\"+r.toString(16)+" ",o=!0):34===r||92===r?(!o&&0<n&&(t=e.substring(0,n)),t+="\\"+String.fromCharCode(r),o=!0):o&&(t+=String.fromCharCode(r))}return o||(t=e),t},x.prototype._serializeIdentifier=function(e){for(var t,o="",n=e.charCodeAt(0),i=!1,r=0,a=e.length;r<a;r++){if(0===(t=e.charCodeAt(r)))throw new Error("InvalidCharacterError");1<=t&&t<=31||127<=t&&t<=159||0===r&&48<=t&&t<=57||1===r&&48<=t&&t<=57&&45===n?(!i&&0<r&&(o=e.substring(0,r)),o+="\\"+t.toString(16)+" ",i=!0):128<=t||45===t||95===t||48<=t&&t<=57||65<=t&&t<=90||97<=t&&t<=122?i&&(o+=String.fromCharCode(t)):(!i&&0<r&&(o=e.substring(0,r)),o+="\\"+String.fromCharCode(t),i=!0)}return i||(o=e),o},x);function x(){this._selectorString=""}e.CssSelector=T,window.CSS&&window.CSS.escape&&(F.ui.CssSelector.prototype.__serializeIdentifier=F.ui.CssSelector.prototype._serializeIdentifier,F.ui.CssSelector.prototype._serializeIdentifier=window.CSS.escape)}(F.ui||(F.ui={}))}($dyn=$dyn||{}),function(s){var e,t;function o(e){var t,o,n=$.Deferred();if(s.isObservable(e))(t=e())?n.resolve(t):o=e.valueChanged.subscribe(function(){(t=e())&&(e.valueChanged.unsubscribe(o),n.resolve(t))});else if("function"==typeof e){var i=s.computed(e);(t=i())?(i.valueChanged.clearAllDependencies(),n.resolve(t)):o=i.valueChanged.subscribe(function(){(t=i())&&(i.valueChanged.unsubscribe(o),i.valueChanged.clearAllDependencies(),n.resolve(t))})}else e&&n.resolve(e);return n}function n(e,t,o,n){if("function"!=typeof e)throw new TypeError("First argument to $dyn.async must be a function");var i=0,r=!0;s.async.pending.increment("$dyn.async id "+i+", message: '"+o+"' timeout (ms) "+(void 0===t?0:t));function a(){try{e.call(n,arguments)}finally{s.async.pending.decrement("$dyn.async id "+i+", message: '"+o+"' complete"),r=!1}}return s.async.debugForceSync?a():i=window.setTimeout(a,t),{cancel:function(){r&&(window.clearTimeout(i),r=!1,s.async.pending.decrement("$dyn.async "+i+", message:'"+o+"' cancel"))}}}s.callWhenNotBusy=function(t){s.value(s.clientBusy)?(s.shell.blockUserInteractionNoWait("callWhenNotBusy"),s.observe(s.clientBusy,function(e){if(!e)return s.shell.unBlockUserInteraction(),s.callFunction(t),!1})):s.callFunction(t)},(e=s.deferred||(s.deferred={})).onTrue=o,e.onHasValue=o,s.async=n,(t=n=s.async||(s.async={})).nonThrottled=0,t.throttledCommandProcessing=!1,t.pending=Object.assign(s.observable(0),{decrement:function(e){var t=s.peek(s.async.pending);t--,s.log.async&&s.log.async("$dyn.async.pending decrement, count = %d : %s",t,e),t<0&&(t=0,s.logError("$dyn.async.pending decremented to <0 ")),0===t&&window.setTimeout(function(){0===s.value(s.async.pending)&&s.clientBusy(!1)});var o=s.computed.scope;s.computed.scope=void 0,s.async.pending(t),s.computed.scope=o},increment:function(e){var t=s.peek(s.async.pending);t++,s.log.async&&s.log.async("$dyn.async.pending increment, count = %d : %s",t,e);var o=s.computed.scope;s.computed.scope=void 0,s.async.pending(t),1==t&&s.clientBusy(!0),s.computed.scope=o}}),t.IsClientProcessing=function(){return s.clientBusy()&&(0<s.async.nonThrottled||s.async.throttledCommandProcessing)},$(document).on("ajaxStart",function(){s.async.pending.increment("ajaxStart")}),$(document).on("ajaxStop",function(){s.async.pending.decrement("ajaxStop")})}($dyn=$dyn||{}),function(h){var e,t,o,n;function m(e,t){return e.descriptionText.localeCompare(t.descriptionText,h.peek(h.user)&&h.peek(h.peek(h.user).Locale)?h.peek(h.peek(h.user).Locale):void 0)}(e=h.ui||(h.ui={})).KeyCodesText={8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:String.fromCharCode(8592),38:String.fromCharCode(8593),39:String.fromCharCode(8594),40:String.fromCharCode(8595),46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",110:".",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",186:";",188:",",190:".",191:"/",222:"'",numbers:"[1..9]"},(t=e.KeyCodes||(e.KeyCodes={}))[t.backSpace=8]="backSpace",t[t.tab=9]="tab",t[t.enter=13]="enter",t[t.shift=16]="shift",t[t.ctrl=17]="ctrl",t[t.alt=18]="alt",t[t.esc=27]="esc",t[t.spacebar=32]="spacebar",t[t.pageUp=33]="pageUp",t[t.pageDown=34]="pageDown",t[t.end=35]="end",t[t.home=36]="home",t[t.leftArrow=37]="leftArrow",t[t.upArrow=38]="upArrow",t[t.rightArrow=39]="rightArrow",t[t.downArrow=40]="downArrow",t[t.deleteKey=46]="deleteKey",t[t.Number0=48]="Number0",t[t.Number1=49]="Number1",t[t.Number2=50]="Number2",t[t.Number3=51]="Number3",t[t.Number4=52]="Number4",t[t.Number5=53]="Number5",t[t.Number6=54]="Number6",t[t.Number7=55]="Number7",t[t.Number8=56]="Number8",t[t.Number9=57]="Number9",t[t.semicolon_ff=59]="semicolon_ff",t[t.letterA=65]="letterA",t[t.letterB=66]="letterB",t[t.letterC=67]="letterC",t[t.letterD=68]="letterD",t[t.letterE=69]="letterE",t[t.letterF=70]="letterF",t[t.letterG=71]="letterG",t[t.letterH=72]="letterH",t[t.letterI=73]="letterI",t[t.letterJ=74]="letterJ",t[t.letterK=75]="letterK",t[t.letterL=76]="letterL",t[t.letterM=77]="letterM",t[t.letterN=78]="letterN",t[t.letterO=79]="letterO",t[t.letterP=80]="letterP",t[t.letterQ=81]="letterQ",t[t.letterR=82]="letterR",t[t.letterS=83]="letterS",t[t.letterT=84]="letterT",t[t.letterU=85]="letterU",t[t.letterV=86]="letterV",t[t.letterW=87]="letterW",t[t.letterX=88]="letterX",t[t.letterY=89]="letterY",t[t.letterZ=90]="letterZ",t[t.decimal=110]="decimal",t[t.f1=112]="f1",t[t.f2=113]="f2",t[t.f3=114]="f3",t[t.f4=115]="f4",t[t.f5=116]="f5",t[t.f6=117]="f6",t[t.f7=118]="f7",t[t.f8=119]="f8",t[t.f9=120]="f9",t[t.f10=121]="f10",t[t.f11=122]="f11",t[t.f12=123]="f12",t[t.semicolon=186]="semicolon",t[t.comma=188]="comma",t[t.period=190]="period",t[t.forwardslash=191]="forwardslash",t[t.apostrophe=222]="apostrophe",t[t.numbers=[49,50,51,52,53,54,55,56,57]]="numbers",(o=e.ShortcutCategory||(e.ShortcutCategory={})).ElementAction="ElementAction",o.Navigate="Navigate",o.ActOnData="ActOnData",o.Close="Close",o.Other="Other",e.isInChordMode=!1,e.chordKeysPressed=null,e.isChangeableKeyCombo=function(e){var t=!1;if(e.ctrlKey||e.metaKey)switch(e.which){case h.ui.KeyCodes.letterV:case h.ui.KeyCodes.letterX:case h.ui.KeyCodes.letterY:case h.ui.KeyCodes.letterZ:t=!0}return t},e.isPrintableKeyCode=function(e){return 45<e&&e<58||e===h.ui.KeyCodes.spacebar||e===h.ui.KeyCodes.backSpace||e===h.ui.KeyCodes.enter||64<e&&e<91||95<e&&e<112||185<e&&e<193||218<e&&e<223||255<e},e.isTextualKeyEvent=function(e){return h.ui.isPrintableKeyCode(e.which)&&e.which!==h.ui.KeyCodes.enter&&(!e.ctrlKey||e.which===h.ui.KeyCodes.backSpace||e.which===h.ui.KeyCodes.deleteKey)&&(!e.metaKey||e.which===h.ui.KeyCodes.backSpace||e.which===h.ui.KeyCodes.deleteKey)&&!e.altKey},((n=h.util||(h.util={})).Lookup||(n.Lookup={})).KeysToSendToLookup=[h.ui.KeyCodes.downArrow,h.ui.KeyCodes.upArrow,h.ui.KeyCodes.enter,h.ui.KeyCodes.pageUp,h.ui.KeyCodes.pageDown],n.getTextFromKeydownEvent=function(e){var t="";return e.which!==h.ui.KeyCodes.shift&&e.which!==h.ui.KeyCodes.ctrl&&e.which!==h.ui.KeyCodes.alt&&(e.altKey&&(t+="Alt+"),e.ctrlKey&&(t+="Ctrl+"),e.shiftKey&&(t+="Shift+")),t+=h.ui.KeyCodesText[e.which]},n.getTextFromKeysObject=function(e){var o="";if(e.alt&&(o+="Alt+"),e.ctrl&&(o+="Ctrl+"),e.shift&&(o+="Shift+"),e.keyCode)if(e.keyCode instanceof Array)if(e.keyCode===h.ui.KeyCodes.numbers)o+=h.ui.KeyCodesText.numbers;else{var n=e.keyCode.length-1;e.keyCode.forEach(function(e,t){o+=h.ui.KeyCodesText[e],t<n&&(o+=" or ")})}else o+=h.ui.KeyCodesText[e.keyCode];return o},n.getShortcutsTextForControl=function(e,t,o,n){void 0===n&&(n=!1);var i={};if(o=o||{},e&&e.Shortcuts)for(var r in e.Shortcuts){var a=e.Shortcuts[r],s=!1!==a.ShowToUser;if(s&&a.ShowToUser instanceof Function&&(s=h.applyFunction(a.ShowToUser,e,[t])),s){var l="",u="",d=a.ChordKeys;d&&(l+=h.util.getTextFromKeysObject(d)+",");var c=a.Keys;if(c&&(l+=h.util.getTextFromKeysObject(c)),!o[l]){o[l]=!0,a.Description&&(u=a.Description instanceof Function?h.applyFunction(a.Description,e,[t]):a.Description);var p=void 0;i[p=n?a.Category?a.Category:h.ui.ShortcutCategory.Other:h.ui.ShortcutCategory.ElementAction]||(i[p]=[]),i[p].push({descriptionText:u,keyText:l})}}}return!n&&i[h.ui.ShortcutCategory.ElementAction]&&i[h.ui.ShortcutCategory.ElementAction].sort(m),i},n.getAvailableShortcutsText=function(e,t){var o={};for(var n in h.ui.ShortcutCategory)o[n]=[];var i=e.element,r=e,a={},s=h.util.getShortcutsTextForControl(e,t,a);for(o[h.ui.ShortcutCategory.ElementAction]=s[h.ui.ShortcutCategory.ElementAction];i;){var l=h.context(i);if(l&&r!==l)for(var u in r=l,s=h.util.getShortcutsTextForControl(r,t,a,!0))Array.prototype.push.apply(o[u],s[u]);i=i.parentNode}var d=h.util.getShortcutsTextForControl(h.shell,t,a,!0);for(var c in d)Array.prototype.push.apply(o[c],d[c]);for(var p in o)p!==h.ui.ShortcutCategory.ElementAction&&o[p].sort(m);return o},n.handleShortcuts=function(r,a){if(r&&a){var s=!!a.originalEvent&&a.originalEvent.IgnoreShortcuts;$.each(r.Shortcuts,function(e,t){if(!s||t.Force){var o=!h.ui.isInChordMode;if(t.ChordKeys)if(h.ui.chordKeysPressed)o=h.util.isChordKeyPressed(h.ui.chordKeysPressed,t.ChordKeys);else{if(h.util.isShortcutKeyPressed(a,t.ChordKeys)){h.ui.chordKeysPressed=t.ChordKeys,h.ui.isInChordMode=!0;var n=h.util.getTextFromKeysObject(t.ChordKeys);return $(h.shell.chordNotification).text(h.format(h.label("Framework_ChordStarted"),n)).show(),a.preventDefault(),h.log.stopPropagation&&h.log.stopPropagation("ExecuteShortcuts: Matched chord"),a.stopPropagation(),!1}o=!1}if(o&&h.util.isShortcutKeyPressed(a,t.Keys)){if(void 0===t.RecordTelemetry||t.RecordTelemetry){var i={inputType:h.telemetry.InputType.keyboard,extendedData:e+": "+JSON.stringify(t.Keys)};t.ChordKeys&&(i.extendedData+=", "+JSON.stringify(t.ChordKeys)),1<t.Keys.keyCode.length&&(i.userDefined1=a.which),r.IsForm?h.telemetry.addFormActionEvent(r,h.telemetry.ActionEvents.hotKeyUsed,i):h.telemetry.addControlActionEvent(r,null,h.telemetry.ActionEvents.hotKeyUsed,i)}if(h.ui.isInChordMode&&($(h.shell.chordNotification).text("").hide(),h.ui.isInChordMode=!1,h.ui.chordKeysPressed=null),t.Handler)!1!==h.callFunction(t.Handler,r,a)&&(a.preventDefault(),h.log.stopPropagation&&h.log.stopPropagation("ExecuteShortcuts"),a.stopPropagation());return!1}}})}},n.isChordKeyPressed=function(e,t){return e===t||e.shift===t.shift&&e.ctrl===t.ctrl&&e.alt===t.alt&&e.keyCode===t.keyCode},n.isShortcutKeyPressed=function(e,t){if(!e)return!1;if(e.which===h.ui.KeyCodes.shift||e.which===h.ui.KeyCodes.ctrl||e.which===h.ui.KeyCodes.alt)return!1;var o=t.ctrl||!1,n=t.alt||!1,i=t.shift||!1,r=e.ctrlKey||!1,a=e.metaKey||!1,s=e.altKey||!1,l=e.shiftKey||!1,u=!1;if(((r||a)===o||t.isCtrlKeyAgnostic)&&s===n&&(l===i||t.isShiftKeyAgnostic))if(t.keyCode instanceof Array)for(var d=t.keyCode.length-1;!u&&0<=d;)u=e.which===t.keyCode[d--];else u=e.which===t.keyCode;return u}}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(v){function e(e,t){void 0===t&&(t=!1);var o=v.showMessageBox.convertTextParameter(e),n=o.Label;if(n&&""!==n||(n="errorMessageBox_called"),v.shell.activeMessageBox){var i=1===v.length(v.shell.activeMessageBox.Messages)?v.value(v.value(v.shell.activeMessageBox.Messages)[0].Label):"",r="";o.Text&&(r=$.isArray(o.Text)?1===o.Text.length?o.Text[0]:"":o.Text),i&&i===r||v.shell.activeMessageBox.addMessages(o.Text,o.callback)}else{var a=!1,s=void 0,l=void 0;if((v.isObservableArray(e)||e instanceof Array)&&(l=e[0])&&l.FindRelatedControl&&(s=l.FindRelatedControl())&&v.value(s._fastEdit)&&(a=!0),a){var u=s.Root;u&&(u.MessageBar.ClearMessages(),u.MessageBar.AddMessage(l))}else{var d=void 0,c=!1;l&&l.activityId&&(d=l.activityId,c=!0);var p=$.extend({ActivityId:d,ImageName:v.messaging.getMessageIconType(e),ImageType:"Symbol",SecondaryText:v.errorMessageBox.getSecondaryText(e),ShowActivityId:c,showCancelButton:!1,showCloseButton:!0,showNoButton:!1,showNoToAllButton:!1,showOkButton:!1,showYesButton:!1,showYesToAllButton:!1,Tooltip:v.messaging.getMessageIconAltText(e)},o,{callback:function(e){v.clientInError(!1),"function"==typeof o.callback&&o.callback(e)}});p.ActiveControl||(p.ActiveControl=v.messaging.getFirstFocusButton(p));var h={context:p,role:"Dialog",templateId:"LightBoxMessage"};v.shell.createForm(h),v.clientInError(!0),v.shell.dialog(h)}}if(!t){var m=v.context(v.shell.getCurrentRootForm());v.telemetry.addErrorEvent({errorLabel:n,formName:m?m.FormName:"",formUniqueId:m?m.Id:""})}}function t(e){var t=v.showMessageBox.convertTextParameter(e);t.ActiveControl||(t.ActiveControl=v.messaging.getFirstFocusButton(t));var o={context:t,role:"Dialog",templateId:"LightBoxMessage"};v.shell.createForm(o),v.shell.dialog(o),v.telemetry.addErrorEvent({errorLabel:"showMessageBox called",formName:"",formUniqueId:""})}var o,n,i,r,a,s;if(v.messageHelper=function(e){var t="",o="";if(e.Message){t=e.Message,e.Label&&(o=e.Label)}else t=e,v.logError("$dyn.error, warn, info: need message and label: "+t);return{Message:t,Label:o}},v.warn=function(e,t){var o=v.messageHelper(e),n=new v.messaging.Message;if(n.text=o.Message,n.type=v.messaging.MessageType.warning,n.formUniqueId="0",n.timeStamp=new Date,n.errorLabel=o.Label,t)if(t.Root){var i=t.Root;n.formName=v.value(i.FormName),n.formUniqueId=i.Id,n.targetName=t.Name,n.relatedControl=t}else if(t.IsForm){i=t;n.formName=v.value(i.FormName),n.formUniqueId=i.Id,n.targetName=t.Name,n.relatedControl=t}return v.telemetry.addErrorEvent(n),v.messageManager.add(n)},v.error=function(e,t){var o=v.messageHelper(e),n=new v.messaging.Message;if(n.text=o.Message,n.type=v.messaging.MessageType.error,n.formUniqueId="0",n.errorLabel=o.Label,t&&t.Root){var i=t.Root;n.formName=v.value(i.FormName),n.formUniqueId=i.Id,n.targetName=t.Name}return v.telemetry.addErrorEvent(n),v.messageManager.add(n)},v.info=function(e,t){var o=v.messageHelper(e),n=new v.messaging.Message;if(n.text=o.Message,n.type=v.messaging.MessageType.information,n.formUniqueId="0",n.errorLabel=o.Label,t&&t.Root){var i=t.Root;n.formName=v.value(i.FormName),n.formUniqueId=i.Id,n.targetName=t.Name}return v.telemetry.addErrorEvent(n),v.messageManager.add(n)},v.persistentMessage=function(e,t,o,n,i,r){var a;if((i===v.messaging.MessageType.information||i===v.messaging.MessageType.warning)&&!1!==v.messageManager.getPersistentMessageVisibleState(i)&&void 0===r.MessageBar.getPersistentMessageId(i)||i===v.messaging.MessageType.error&&void 0===r.MessageBar.getPersistentMessageId(i)){var s=v.messageHelper(e),l=new v.messaging.Message;if(l.text=s.Message,l.type=i,l.originType=v.messaging.OriginType.Persistent,l.formUniqueId="0",l.timeStamp=new Date,l.errorLabel=s.Label,l.ActionMessageText=t,l.isStaticAction=o,l.ActionURL=n,r)if(r.Root){var u=r.Root;l.formName=v.value(u.FormName),l.formUniqueId=u.Id,l.targetName=r.Name,l.relatedControl=r}else if(r.IsForm){u=r;l.formName=v.value(u.FormName),l.formUniqueId=u.Id,l.targetName=r.Name,l.relatedControl=r}v.telemetry.addErrorEvent(l),(a=v.messageManager.add(l))&&(v.messageManager.setPersistentMessageVisibleState(i,!0),r.MessageBar.setPersistentMessageId(i,a))}return a},v.errorMessageBox=e,(e=v.errorMessageBox||(v.errorMessageBox={})).getSecondaryText=function(e){var t,o,n;if(v.isObservableArray(e)||e instanceof Array){var i=v.value(e);try{for(var r=__values(i),a=r.next();!a.done;a=r.next()){var s=a.value;if(s.stackTrace){n=s.stackTrace;break}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}}else n=e.SecondaryText;return n},v.showMessageBox=t,(t=v.showMessageBox||(v.showMessageBox={})).convertTextParameter=function(e){var t,o;if(v.isObservableArray(e)||e instanceof Array){var n=[],i=v.value(e);try{for(var r=__values(i),a=r.next();!a.done;a=r.next()){var s=a.value;n.push(s.text)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}return{Text:n}}return e},v.AddMessage=function(e,t,o,n){v.logDeprecated("$dyn.AddMessage");var i=new v.messaging.Message;if(i.text=t,i.type=e,i.formUniqueId="0",i.errorLabel=n,o&&o.Root){var r=o.Root;i.formName=v.value(r.FormName),i.formUniqueId=r.Id,i.targetName=o.Name}return v.telemetry.addErrorEvent(i),v.messageManager.add(i)},(n=o=o||{}).alert="Alert",n.watchdog="Watchdog",n.application="ApplicationNotification",n.whatsNew="WhatsNew",(r=i=i||{}).informational="Informational",r.warning="Warning",r.error="Error",(s=a=a||{}).display="AxDisplayMenuFunction",s.action="AxActionMenuFunction",v.BuildNotification=function(o){var n=new v.messaging.Notification;switch(n.text=o.Title,n.notificationId=o.Id,n.createdDateTime=o.CreatedDateTime,o.Actions&&0<o.Actions.length&&o.Actions.forEach(function(e){var t={ExecuteHyperlink:function(){v.user().executeNotificationAction(e.Id).done(function(e){e&&v.messaging.MessageCenterManager.RemoveAndDismissMessage(o.Id,!1)})},showLink:!0,Value:e.Message};n.notificationActions.push(t)}),n.message=o.Message,n.state=o.State,o.Severity){case"Error":n.severity=v.messaging.Severity.error;break;case"Warning":n.severity=v.messaging.Severity.warning;break;case"Informational":n.severity=v.messaging.Severity.information}return n},v.AddNotification=function(e){"WhatsNew"===e.Type?v.whatsNew.processWhatsNewMessage(e):v.messaging.MessageCenterManager.AddNotifications([v.BuildNotification(e)])},v.ClientErrorsToIgnore=["ResizeObserver loop limit exceeded","ResizeObserver loop completed with undelivered notifications"],v.AddNotifications=function(e){for(var t=[],o=0,n=e.length;o<n;o++)"WhatsNew"===e[o].Type?v.whatsNew.processWhatsNewMessage(e[o]):t.push(v.BuildNotification(e[o]));v.messaging.MessageCenterManager.AddNotifications(t)},!v.flags.disableGlobalErrors&&!window.dynDisableGlobalErrors){var d=window.onerror;window.onerror=function(t,e,o,n,i){var r=i&&i.stack,a={callStack:r=r||v.format("{0} ({1}:{2}:{3})",t,o,n,e)},s="Framework_UnexpectedError";if("string"==typeof t&&-1!==v.ClientErrorsToIgnore.findIndex(function(e){return-1!==t.indexOf(e)})){var l=v.value(v.clientInError);v.telemetry.addClientErrorEvent(s,a,l)}else{var u={callback:function(){v.clientInError(!1)},SecondaryText:""};(v.debug.showErrors||v.version&&"debug"===v.version.buildType)&&(u.SecondaryText=r),v.telemetry.handleClientError(u,s,a)}return d&&d.apply(window,arguments),!1}}}($dyn=$dyn||{}),function(r){r.context=function(e){if(e){var t=e.dynContext;return t?t.current:void 0}},r.jqueryContext=function(e){if(e){if(e.jquery){var t=e[0];return r.context(t)}return r.context(e)}},r.contextValue=function(e){return e instanceof r.DataContext?e.current:e},r.rootContext=function(e){r.logDeprecated("$dyn.rootContext");var t=e.dynContext;if(t&&t.scopeVars)return t.scopeVars.$root},r.rootElement=function(e){var t=e.dynContext;if(!t||!t.scopeVars)throw TypeError("Can not get the root of element that is not data bound.");return t.scopeVars.$root&&t.scopeVars.$root.element},r._contextValue=function(e){return e instanceof r.DataContext?e.current:e},r.evalDataContext=function(e,t,o){t instanceof r.DataContext||(t=new r.DataContext(t,void 0));var n=r._parseDataContext(e,o);if(n){var i=new r.DataContext(n(t,e),t);return r.debug.binding&&(i.expression=e.getAttribute("data-dyn-context")),e[o]=i}return t},r._parseDataContext=function(e,t){var o=e.getAttribute(t);return o?r._parseBindingExpression(o):null},r.evalDataBinding=function(e,t){var o=r._parseDataBinding(e);if(o)return o(t instanceof r.DataContext?t:new r.DataContext(t),e)};var e=(t.prototype.parent=function(e){return this.parentContext?void 0===e||0===e?this.parentContext.current:this.parentContext.parent(e-1):{}},t);function t(e,t){!t||t instanceof r.DataContext||(t=new r.DataContext(t)),this.current=void 0===e?null:e,this.parentContext=t,this.scopeVars=t?Object.create(t.scopeVars):{}}r.DataContext=e}($dyn=$dyn||{}),function(p){var e;function t(e,t){var o=e.getAttribute("data-dyn-bind");return o?p._bindingsCache[o]||(p._bindingsCache[o]=p._parseBindingExpressions(o)):null}p.applyHandler=function(e,t,o,n){p.logDeprecated("$dyn.applyHandler");var i=p.bindingHandlers[t];i.apply?i(e).apply(o,e.dynContext):p._invokeHandler(t,e,o,n)},p._invokeHandler=function(e,t,o,n){if(t){var i,r;p.debug.performance&&(r=!1,i=performance.now());var a=p.bindingHandlers[e];!1!==a.unwrapObservable&&(o=p.value(o)),t.dynHandlersExecuted||(t.dynHandlersExecuted={}),a.apply&&p.logError("Handler "+e+" is not refactored.");var s,l=!t.dynHandlersExecuted[e];if(a.setup&&l&&(void 0!==(s=a.setup(t,o,n))&&(t.dynStates||(t.dynStates={}),t.dynStates[e]=s),t.dynHandlersExecuted[e]=!0),t.dynLastHandlerValue||(t.dynLastHandlerValue={}),a.invoke){var u=t.dynLastHandlerValue?t.dynLastHandlerValue[e]:void 0;s=t.dynStates?t.dynStates[e]:void 0,(!a.shouldInvoke&&o!==u||a.shouldInvoke&&a.shouldInvoke(o,u,s,t,n))&&(a.invoke(t,o,u,s,n),r=!0,t.dynLastHandlerValue[e]=o)}if(p.debug.performance){var d=performance.now(),c=p.ui.PerformanceTimer._handlerTimings[e];(c=c||(p.ui.PerformanceTimer._handlerTimings[e]={time:0,count:0,invoked:0})).time+=d-i,c.count++,c.invoked+=r?1:0}return s}p.logError('_invokeHandler for handler type "%s" was called with a null or undefined target element.',e)},(e=p.bindingFunctions||(p.bindingFunctions={})).$model=function(e,t){var o=p.parseModel(e,t instanceof p.DataContext?t.current:t);return p.debug.verboseModels&&p.log("[html-binding] Model: %o, Selector: %o, Context: %o",p.value(o),e,t instanceof p.DataContext?t.current:t),o},e.$models=function(e,t){var o=p.parseModelCollection(e,t instanceof p.DataContext?t.current:t);return p.debug.verboseModels&&p.log("[html-binding] Models: %o, Selector: %o, Context: %o",p.value(o),e,t),o},e.$modelCollection=function(e,t){var o=p.parseModelCollection(e,t instanceof p.DataContext?t.current:t,!0);return p.debug.verboseModels,o},p._bindingUnwrapCache={},p._bindingCache={},p._bindingsCache={},p.getBasicBindings=function(e){return e.dynBasicBindings||p._parseBasicBindings(e),e.dynBasicBindings},p._parseBasicBindings=function(e){var t=e.getAttribute("data-dyn-bind");if(t&&""!==t)try{e.dynBasicBindings=new Function("$data","$element","return {"+t+"};")}catch(e){}},p._parseBindingExpression=function(t,e){var o;if(void 0===e&&(e=!1),e){if(t="{"+t+"}",o=p._bindingCache,p._bindingCache[t])return p._bindingCache[t]}else{var n=(o=p._bindingUnwrapCache)[t];if(n)return n}var i=!0===e?"$dyn.value(dataContextWrapper.current)":"dataContextWrapper.current";try{return o[t]=new Function("dataContextWrapper","$element","var $data = "+i+";\r\n  if ($data === null || $data === undefined) { \r\n    $data = {};\r\n  } \r\n  var $value = $dyn.value;\r\n  var $format = $dyn.format;\r\n  var $label = $dyn.label;\r\n  var $parent = function (i) { return dataContextWrapper.parent(i); };\r\n  var $model = function (modelSelector, context) { return $dyn.bindingFunctions.$model(modelSelector, context !== undefined ? context : dataContextWrapper); };\r\n  var $modelCollection =  function (modelSelector, context) { return $dyn.bindingFunctions.$modelCollection(modelSelector, context !== undefined ? context : dataContextWrapper); };\r\n  var $models = function (modelSelector, context) { return $dyn.bindingFunctions.$models(modelSelector, context !== undefined ? context : dataContextWrapper); };\r\n  var $field = function (fieldName, modelSelector) { return $dyn.getFieldObservable(fieldName, $model(modelSelector)); };\r\n  with (dataContextWrapper.scopeVars) {\r\n    if($data != null && !($data && $data.valueChanged)) { \r\n      with($data)\r\n      {\r\n        return ("+t+");\r\n      }\r\n    } else {\r\n      return ("+t+");\r\n    }\r\n  }")}catch(e){return p.debug.bindingErrorAsMessages&&p.warn({Message:p.label("Invalid binding expression, see console for more details"),Label:"Invalid binding expression, see console for more details"}),p.logError("Invalid binding expression: %s",t),function(){}}},p._parseDataBinding=function(e){var t=e.getAttribute("data-dyn-bind");return t?p._parseBindingExpression(t,!0):null},p.getBindings=t,p._parseDataBindings=t,p._parseBindingExpressions=function(e){if("string"==typeof e){e+=",";for(var t,o,n=[],i=0,r=0,a=0,s=0;s<e.length;s++){var l=e.charCodeAt(s);if(0===r)58===l&&(r=1,t=e.slice(i,s),i=s+1);else if(3===r)34===l&&92!==e.charCodeAt(s-1)&&(r=1);else if(2===r)39===l&&92!==e.charCodeAt(s-1)&&(r=1);else switch(l){case 44:if(0===a){var u;if(t=t.trim(),o=e.slice(i,s),t)(u={})[t]=p._parseBindingExpression(t+": "+o,!0),n.push(u);else p.logWarning("Syntax error: missing binding handler name: %s",e);i=s+1,r=0}break;case 123:case 91:case 40:a++;break;case 125:case 93:case 41:a--;break;case 34:r=3;break;case 39:r=2}}if(0!==r&&0<e.length)t=t.trim(),o=e.slice(i),(u={})[t]=p._parseBindingExpression(t+": "+o,!0),n.push(u),p.logWarning("Syntax error: '%s' for binding '%s'",o,t);return n}},p.hasDataBinding=function(e){return!!e.getAttribute("data-dyn-bind")},p.parseModel=function(e,t){return null==e?t:(t&&"DataSource"in t&&(t=t.DataSource),"string"==typeof e?p.getModel(e,t):e)},p.parseModelCollection=function(e,t,o){return null==e?t:(t&&"DataSource"in t&&(t=t.DataSource),"string"==typeof e?p.getModelCollection(e,t,o):e)},p.getModel=function(t,o){return o?(o.navigationObservables||(o.navigationObservables={}),o.navigationObservables[t]||(o.navigationObservables[t]=p.computed(function(){var e=p.value(o);if(e)return e.getRelated?p.value(e.getRelated(t)):e[t]}),o.navigationObservables[t].__getModel=t),o.navigationObservables[t]):null},p.getModelCollection=function(o,n,i){if(!n)return null;if(p.serverForm&&p.serverForm.isModelCollection(n))return n;var e=i?"__navigationCollectionObservables":"__navigationItemsObservables";n[e]||(n[e]={});var t=n[e][o];return t=t||(n[e][o]=p.computed(function(){var e=p.value(n);if(e instanceof Array)return e;if(e){if(!e.getRelatedCollection)return e[o];var t=p.value(e.getRelatedCollection(o));if(t)return i?t:p.value(t.items)}return null}))},p.getFieldObservable=function(o,n){if(null==n)return null;if(n&&n.valueChanged)return n.fieldObservables||(n.fieldObservables={}),n.fieldObservables[o]||(n.fieldObservables[o]=p.computed(function(){return p.value(p.getFieldObservable(o,p.value(n)))},function(e){var t=p.getFieldObservable(o,p.value(n));t&&t(e)}),n.fieldObservables[o].__getFieldObservable=o),n.fieldObservables[o];var t=n;if(!t)return null;var i=o;if(t.fieldObservables||(t.fieldObservables={},t.fieldTrackers={}),!t.fieldObservables[i]){var e=t.fieldTrackers[i]=p.observable(1);t.fieldObservables[i]=p.computed(function(){return e(),t.getValue?t.getValue(i):t[i]},function(e){t.setValue?t.setValue(i,e):t[i]=e})}return t.fieldObservables[i]},p.getFieldValue=function(e,t,o){return void 0!==o?p.getFieldObservable(e,t)(o):p.value(p.getFieldObservable(e,t))},p.getBindableChildren=function(e){return e.children},p.getModelName=function(e,t){return t=p.value(t),e=p.value(e),t&&!t.GetNavigationCollection||(e+="_ds"),e},p.getFieldName=function(e,t){return t=p.value(t),e=p.value(e),t&&!t.GetNavigationProperty||(e+="_field"),e}}($dyn=$dyn||{}),function(u){var e,t;function o(e){this.targetElement=e,this.shouldDataBindChildren=!1,this.childrenDataBound=!1,this.disposed=!1,this._isDataBound=!1,this.type="Html",u.debug.performance&&(this._dataBindingTask=new u.DomPerformanceTask("dataBinding"),this._dataBindingChildrenTask=new u.DomPerformanceTask("dataBindingChildren"),this._bindingCreatedTask=new u.DomPerformanceTask("bindingCreated"),this._bindingUpdatedTask=new u.DomPerformanceTask("bindingUpdated"),this._bindingValueUpdatedTask=new u.DomPerformanceTask("bindingValueUpdated"))}u._cachedRoleExpression={},u.roleContext=function(e){var t,o=e.getAttribute(u.Const.roleAttribute);if(o)if(u._cachedRoleExpression[o])t=u._cachedRoleExpression[o];else{var n=o[o.length-1];t="'"===n||"}"===n||'"'===n?new Function(" return {"+o+"}; ").call(null):{Control:o},u._cachedRoleExpression[o]=t}return t},u.roleType=function(e){var t=u.roleContext(e);return t.Control.type?t.Control.type:t.Control},u.role=function(e){if(!e)throw new Error("Argument 'targetElement' must be a non-null html element");var t=e[u.Const.roleInstance];if(u.Const.roleInstance in e&&void 0===t&&u.logWarning("Framework: $dyn.role called on a disposed element"),!t){var o=e.getAttribute(u.Const.roleAttribute);o&&(t=new u.roleHandlers.Control(e,o)),t=t||new u.roleHandlers.Default(e),e[u.Const.roleInstance]=t}return t},u.dataBind=function(e,t,o){u.role(e).dataBind(t,o)},u.unbind=function(e){if(e){var t=e[u.Const.roleInstance];t&&(t.dispose(),e[u.Const.roleInstance]=void 0)}},u.isUnbound=function(e){return!e||!e[u.Const.roleInstance]},e=u.roleHandlers||(u.roleHandlers={}),o.prototype.getHandlerClass=function(e){return u.bindingHandlers[e]},o.prototype.getHandler=function(e){this._handlers||(this._handlers={});var t=this._handlers[e];if(!t){var o=u.bindingHandlers[e];if(o)"function"==typeof o?(t=o(this.targetElement,this),this._handlers[e]=t):this._handlers[e]=t=o;else if(u.logError("Unknown binding type: %s, element: %o",e,this.targetElement),u.debug.bindingErrorAsMessages){var n=void 0;n=this.targetElement.getAttribute("data-dyn-role")?u.format("Unknown binding type: {0}, role: {1}",e,this.targetElement.getAttribute("data-dyn-role")):u.format("Unknown binding type: {0}",e),u.warn({Message:n,Label:n})}}return t},o.prototype.evalDataContext=function(e,t){return u.evalDataContext(this.targetElement,e,"data-dyn-context")},o.prototype.hasBinding=function(){return u.hasDataBinding(this.targetElement)},o.prototype.applyBinding=function(e,t,o){if(e)for(var n in e){var i=e[n];this.applyHandler(n,i,t)}},o.prototype.applyHandler=function(o,n,i){var r=this,a=this.getHandler(o);if(a){var s=!0,e=u.observe(function(){return u.value(n)},function(e){var t=u.contextValue(i);t&&t.bindingTrigger||(s||r._bindingValueUpdatedTask&&r._bindingValueUpdatedTask.start(r.targetElement,o),u.debug.verboseBinding&&u.log("[html-binding] Binding: %s, Value: %o, Role: %o, Element: %o",o,e,r,r.targetElement),a.apply?a.apply(e,i,n):u._invokeHandler(o,r.targetElement,n,u.value(r.context.current)),s?s=!1:r._bindingValueUpdatedTask&&r._bindingValueUpdatedTask.stop(r.targetElement,o))});e.__name="applyHandler",u.debug.general&&(e.__name+="_"+o)}},o.prototype.dataBindChildren=function(e,t,o){if(void 0===o&&(o=!1),this.shouldDataBindChildren&&(!this.childrenDataBound||o)){var n=this.targetElement.children;if(n)for(var i=0,r=n.length;i<r;i++){var a=n[i];a&&!a.hasAttribute(u.Const.stopBindingAttribute)&&this.dataBindChild(a,e,t)}e&&e.current&&e.current.postDataBindChildren&&e.current.postDataBindChildren(),this.childrenDataBound=!0}},o.prototype.dataBindItem=function(e,t,o){var n,i=null==t?void 0:t.parentContext;i&&null!==(n=this.shadowedContext)&&void 0!==n&&n.scopeVars.$root&&void 0===i.scopeVars.$root&&(i.scopeVars.$root=this.shadowedContext.scopeVars.$root),this.getChildRole(e).dataBind(t,null,o,i)},o.prototype.dataBindChild=function(e,t,o){if(this.shouldDataBindChildren){var n=e.dynTemplatedParent,i=void 0;if(n){var r=n===this.targetElement?this:u.role(n),a=r.context;a&&((i=r.getChildRole(e)).context||i.dataBind(a.scopeVars._dataSourceContext,null,o,t))}else(i=this.getChildRole(e)).context||i.dataBind(t,null,o,this.shadowedContext)}},o.prototype.getChildRole=function(e){return u.role(e)},o.prototype.expandTemplate=function(){var r=this,e=this.targetElement.getAttribute(u.Const.templateAttribute),t=this.targetElement.getAttribute(u.Const.templateApplied);if(e&&!t)u.loadTemplateInstance(e,function(e){r.targetElement.setAttribute(u.Const.templateApplied,!0);for(var t=u.getBindableChildren(r.targetElement),o=0,n=t.length;o<n;o++){var i=t[o];r.getChildRole(i).expandTemplate()}},this.targetElement);else for(var o=u.getBindableChildren(this.targetElement),n=0,i=o.length;n<i;n++){var a=o[n];this.getChildRole(a).expandTemplate()}},o.prototype.dataBind=function(t,o,n,e){var i=this,r=this.targetElement.getAttribute(u.Const.templateAttribute),a=this.targetElement.getAttribute(u.Const.templateApplied);this.shadowedContext=e,r&&!a?u.loadTemplateInstance(r,function(e){i.targetElement.setAttribute(u.Const.templateApplied,!0),i.doDataBinding(t,n),o&&o()},this.targetElement):(this.doDataBinding(t,n),o&&o())},o.prototype.doDataBinding=function(e,t){var i=this;if(this._dataBindingTask&&this._dataBindingTask.start(this.targetElement),u.debug.general&&this.context)u.logError("Rebind called: %o",this);else{if(this.shouldDataBindChildren=!0,this.context=this.targetElement.dynContext=this.evalDataContext(e,t),this.hasBinding()){var r=u.contextValue(this.context);if(r&&r.bindingTrigger)u.observe(r.bindingTrigger,function(){var e=u.getBasicBindings(i.targetElement);if(e){var t=e(i.context.current,i.targetElement);for(var o in t){var n=t[o];u._invokeHandler(o,i.targetElement,n,r)}}});else{var o=this._getBindings();if(o)for(var n=0,a=o.length;n<a;n++){var s=o[n];for(var l in s)this._handleBinding(l,s[l],this.context,t)}}}this._dataBindingTask&&this._dataBindingTask.stop(this.targetElement),this._dataBindingChildrenTask&&this._dataBindingChildrenTask.start(this.targetElement),this.dataBindChildren(this.context,t,!1),this.childrenDataBound&&this._setDataBound(),this._dataBindingChildrenTask&&this._dataBindingChildrenTask.stop(this.targetElement)}},o.prototype.dispose=function(){var o=this;if(this.disposed=!0,this._handlers&&$.each(this._handlers,function(e,t){t.dispose&&(t.dispose(o.targetElement,o.targetElement&&o.targetElement.dynStates?o.targetElement.dynStates[e]:void 0,o.targetElement&&o.targetElement.dynLastHandlerValue?o.targetElement.dynLastHandlerValue[e]:void 0),o.targetElement&&o.targetElement.dynHandlersExecuted&&o.targetElement.dynHandlersExecuted[e]&&delete o.targetElement.dynHandlersExecuted[e])}),this._handlers=void 0,this._bindings&&$.each(this._bindings,function(e,t){t.dispose&&t.dispose()}),this._bindings=void 0,this.targetElement){if(this.targetElement.dynHandlersExecuted){for(var e in this.targetElement.dynHandlersExecuted){var t=u.bindingHandlers[e];t&&t.dispose&&t.dispose(this.targetElement,this.targetElement.dynStates?this.targetElement.dynStates[e]:void 0,this.targetElement.dynLastHandlerValue?this.targetElement.dynLastHandlerValue[e]:void 0)}this.targetElement.dynHandlersExecuted=null}this.targetElement.dynStates&&(this.targetElement.dynStates=null),this.targetElement.dynLastHandlerValue&&(this.targetElement.dynLastHandlerValue=null),this.targetElement.dynBasicBindings&&(this.targetElement.dynBasicBindings=null)}if(this.shouldDataBindChildren&&this.childrenDataBound){var n=this.targetElement.children;if(n)for(var i=0,r=n.length;i<r;i++){var a=n[i];a&&!a.hasAttribute(u.Const.stopBindingAttribute)&&u.unbind(a)}}this.targetElement.dynContext&&(this.targetElement.dynContext=null),this.targetElement.dynContent&&(this.targetElement.dynContent.dispose&&this.targetElement.dynContent.dispose(),this.targetElement.dynContent=null)},o.prototype.dataContext=function(){return this.context},o.prototype._getIsDataBound=function(){return this.__isDataBound?u.peek(this.__isDataBound):this._isDataBound},o.prototype._setDataBound=function(){this.__isDataBound&&this.__isDataBound(!0),this._isDataBound=!0},Object.defineProperty(o.prototype,"isDataBound",{get:function(){return this.__isDataBound||(this.__isDataBound=u.observable(this._isDataBound)),this.__isDataBound},enumerable:!1,configurable:!0}),o.prototype._getBindings=function(e){return u.getBindings(this.targetElement,e)},o.prototype._handleBinding=function(t,e,o,n){var i=this;if(e){var r=!0,a=u.observe(function(){return e(o,i.targetElement)},function(e){e&&(r?i._bindingCreatedTask&&i._bindingCreatedTask.start(i.targetElement,t):i._bindingUpdatedTask&&i._bindingUpdatedTask.start(i.targetElement,t),u.debug.general&&(i._lastBindingsApplied=i._lastBindingsApplied||{},i._lastBindingsApplied[t]=e[t]),i.applyBinding(e,o,n),r?(i._bindingCreatedTask&&i._bindingCreatedTask.stop(i.targetElement,t),r=!1):i._bindingUpdatedTask&&i._bindingUpdatedTask.stop(i.targetElement,t))});this._bindings||(this._bindings={}),this._bindings[t]=a,u.debug.general&&(a.__name="BindingEval")}},t=o,e.Html=t,e.Default=u.roleHandlers.Html}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(a){var e,n,t;function o(e,t){var o=n.call(this,e)||this;return o.type=t,o}e=a.roleHandlers||(a.roleHandlers={}),n=e.Html,__extends(o,n),o.prototype.dataBind=function(e,t,o,n){var i=this;if(this.context)a.logError("Rebind called: %o",this);else{this.shadowedContext=n,this.parentContext=e;var r=function(){i.loadTemplate(),i.doDataBinding(e,o),t&&t()};this.targetElement.classList.contains("unresolved")?this.targetElement[a.Const.templateResolveAction]=r:r()}},o.prototype.evalDataContext=function(e){this._initContext(e),this._initParameters(),this._initName();var t=this.createControl(this.parameters);return this._initId(),this.initControl(t,this.targetElement),t.setUpdating(!1),this.context},o.prototype.createControl=function(e){this.controlCtor||(this.controlCtor=a.ui.Control,a.logError(a.format(a.label("Framework_UnknownControl"),this.type,e.Name)));var t=new this.controlCtor(e,this.targetElement,this.parentControlContext?this.parentControlContext.current:null,this);return this.context&&this.context.scopeVars&&(this.context.scopeVars.$control=t,this.context.current=t),t},o.prototype.initControl=function(e,t){},o.prototype.hasBinding=function(){return!0},o.prototype.dataBindChildren=function(e,t,o){n.prototype.dataBindChildren.call(this,e,t,o),this._children&&this._children.valueChanged.raise()},Object.defineProperty(o.prototype,"children",{get:function(){var t=this;return this._children||(this._children=a.computed(function(){var e=a.children(t.targetElement);return $.map(e,function(e){return a.context(e)})})),this._children},set:function(e){this._children=e},enumerable:!1,configurable:!0}),o.prototype.dispose=function(){var e=this.context&&this.context.current;e&&e.dispose&&e.dispose(),this.targetElement&&(this.targetElement.dynOptions&&(this.targetElement.dynOptions=null),this.targetElement.dynChildren&&(this.targetElement.dynChildren=null),this.targetElement.dynTemplatedParent&&(this.targetElement.dynTemplatedParent=null)),this._children&&(this._children.valueChanged&&this._children.valueChanged.clearAllDependencies&&this._children.valueChanged.clearAllDependencies(),this._children=null),n.prototype.dispose.call(this)},o.prototype.loadTemplate=function(){if(this.controlCtor=a.controls[this.type],this.controlCtor||(this.controlCtor=a.ui.Control),this.template=this.controlCtor.prototype.template||""===this.controlCtor.prototype.template?this.controlCtor.prototype.template:this.type,this.template){var e=a._getTemplate(this.template);e?a._mergeTemplate(e,this.targetElement):a.logError(a.format(a.label("Framework_MissingTemplate"),this.template))}},o.prototype._initContext=function(e){this.targetElement.hasAttribute("data-dyn-context")&&(e=a.roleHandlers.Html.prototype.evalDataContext.call(this,e)),e instanceof a.DataContext||(e=new a.DataContext(e)),this._dataSourceContext=e,this._dataSourceContext.current instanceof a.ui.Control?(this.parentControlContext=this._dataSourceContext,this.root=this.parentControlContext&&this.parentControlContext.scopeVars.$root):this.shadowedContext&&this.shadowedContext.current&&(this.shadowedContext.current instanceof a.ui.Control&&(this.parentControlContext=this.shadowedContext),this.root=this.shadowedContext.scopeVars.$root),this.context=new a.DataContext(null,this._dataSourceContext);var t=this.context.scopeVars;t._dataSourceContext!==this._dataSourceContext&&(t._dataSourceContext=this._dataSourceContext),"$root"in t||!this.root||(t.$root=this.root)},o.prototype._initParameters=function(){var o=this;if(this.parameters=this.targetElement.dynOptions,void 0===this.parameters)if(this.targetElement.hasAttribute("data-dyn-options")){var n=a._parseDataContext(this.targetElement,"data-dyn-options");n&&(a.flags.observableControlOptions?a.observe(function(){var e=o._dataSourceContext.current;o._dataSourceContext.current=a.value(e);var t=n(o._dataSourceContext,o.targetElement);return o._dataSourceContext.current=e,t},function(e){if(o.context.current){for(var t in a.callFunction(o.context.current.setUpdating,o.context.current,!0),e)a.setValue(o.context.current,t,a.value(e[t]));a.callFunction(o.context.current.setUpdating,o.context.current,!1)}else o.parameters=o.targetElement.dynOptions=e}):this.parameters=this.targetElement.dynOptions=n(this._dataSourceContext,this.targetElement))}else if(a.serverForm){var e=a.serverForm.InteractionHandler.prototype.clone(this);e&&(this.parameters=this.targetElement.dynOptions=e)}void 0!==this.parameters&&null!==this.parameters||(this.parameters=this.targetElement.dynOptions={}),this.parameters.Root=this.root,this.parameters.TypeName=this.type,"DataSource"in this.parameters?this._dataSourceContext=new a.DataContext(this.parameters.DataSource,this._dataSourceContext):this.parameters.DataSource=this._dataSourceContext?this._dataSourceContext.current:null},o.prototype._initName=function(){this.parameters.Name?this.name=this.parameters.Name:this.targetElement.hasAttribute("data-dyn-controlname")?this.name=this.parameters.Name=this.targetElement.getAttribute("data-dyn-controlname"):this.name=this.parameters.Name=(a.ui.uniqueId++).toString()},o.prototype._initId=function(){if(!this.targetElement.hasAttribute("data-dyn-stop-initid")){var e=this.context.scopeVars.$index,t=this.targetElement.getAttribute("id");if(!t||void 0!==e){var o=void 0,n=this.root;n?(o=(a.value(n.ObjectName)||"")+"_"+(n.ClientId?n.ClientId:"")+"_"+this.name,void 0!==e&&(o=o+"_"+e)):o=this.name,o&&o!==t&&(this.context.current.Id=o)}}},t=o,e.Control=t}($dyn=$dyn||{}),function(C){var e;C.applyContent=function(e,t){if(e){var o,n=C._parseContent(e[0]),i=C._isContentWrapper(t)?t:C._createContentWrapper(t),r=e.children();if(n&&(o=n(i)),o)for(var a in o){var s=o[a],l=C.contentHandlers[a];l&&l(e,s,i)}for(var u=r.length-1;0<=u;--u)C.applyContent($(r[u]),i);return e}},C.updateContent=function(e){if(e){var t=e.dynContent;t&&t.contentChanged&&t.contentChanged();for(var o=e.children,n=o.length-1;0<=n;--n)C.updateContent(o[n])}},C._parseContentExpression=function(e){return e.match("^[^\\{]+\\:")&&(e="{"+e+"}"),new Function("contentWrapper","var scope = { $content:  $dyn.value(contentWrapper.current), $parent: contentWrapper.parent };if (contentWrapper.scopeVars) { $.extend(scope, contentWrapper.scopeVars); }with(scope) {return ("+e+");}")},C._parseContent=function(e){var t=$(e).attr("data-dyn-content");return t?C._parseContentExpression(t):null},C._createContentWrapper=function(e,t,o){return{__isContentWrapper:!0,current:void 0===e?null:e,parent:function(e){return null===t?null:void 0===e||0===e?t.current:t.parent(e-1)},scopeVars:o}},C._isContentWrapper=function(e){return null!=e&&!0===e.__isContentWrapper},C.getContentOptions=function(e,t){var o;if($.isPlainObject(e)){var n=e;return"string"==typeof n.content?(o=C.value(t.current))?(n.content="*"===n.content?o:C.util.filter(o,n.content),n.name=n.content):n.content=$():"string"==typeof n.find&&((o=C.value(t.current))?(n.content=o.find(n.find),n.name="find "+n.find):n.content=$()),n}return"string"==typeof e?(o=C.value(t.current))?{name:e,content:"*"===e?o:C.util.filter(o,e),clone:!1}:{content:$(),clone:!1}:{content:e,clone:!1}},(e=C.contentHandlers||(C.contentHandlers={})).replace=function(a,e,t){var s,l=!0;C.util.observeContent(function(){return C.getContentOptions(e,t)},a,function(n){var e=n.content;if(a.trigger("contentHandlersReplaceStarted"),0<e.length){var i,t=$(e),o=C.ui.removeFocus(t),r=C.shell.bodyFocusCorrection;o&&(C.shell.bodyFocusCorrection=!1),n.tagName?(i=$(),t.each(function(e,t){$(t).detach();var o=document.createElement(n.tagName);C.util.mergeAttributes(t,o),$(o).append($(t).children().clone(!0)),i=i.add(o)})):i=n.clone?t.clone():t,l?(a.hide().after(i),l=!1):(s&&$(s).detach(),a.after(i)),s=i.slice(0),n.mutator instanceof Function&&i.each(function(e,t){n.mutator(t,e,i)}),o&&(C.ui.restoreFocus(o),C.shell.bodyFocusCorrection=r)}else s&&$(s).detach(),s=null;a.trigger("contentHandlersReplaceFinished")}),a[0].setAttribute("data-dyn-content-applied","true"),C.debug.general&&(a[0].dynContent.__name="replaceContent-"+e)},e.append=function(f,e,t,o){var b=o;C.util.observeContent(function(){return C.getContentOptions(e,t)},f,function(n){if(b)b=!1;else{var e,t,o=n.content,i=C.ui.removeFocus(f),r=C.shell.bodyFocusCorrection;i&&(C.shell.bodyFocusCorrection=!1);var a,s=$(o);n.tagName?(a=$(),s.each(function(e,t){$(t).detach();var o=document.createElement(n.tagName);C.util.mergeAttributes(t,o),$(o).append($(t).children().clone(!0)),a=a.add(o)})):a=n.clone?s.clone():s,C.layout.removeArrange(f[0],!0);var l=f.children(".firstFocusable, .lastFocusable").detach(),u=f[0].children,d=a.length,c=u.length,p=Math.min(d,c);for(e=0;e<p;e++){t=a[e];var h=u[e];if(!h)break;t!==h&&(h.nextSibling?f[0].insertBefore(t,h.nextSibling):f[0].appendChild(t),h.parentNode&&h.parentNode.removeChild(h))}if(d<(c=u.length)){var m=[];for(e=d;e<c;e++){var v=f[0].children[e];v&&m.push(v)}for(e=0;e<m.length;e++)m[e].parentNode.removeChild(m[e])}if((c=u.length)<d){var g=d-c,y=document.createDocumentFragment();for(e=0;e<g;e++){t=a[c+e],y.appendChild(t)}f[0].appendChild(y)}l.length&&l.appendTo(f),n.mutator instanceof Function&&f.children().each(function(e,t){n.mutator(t,e,f.children())}),i&&(C.ui.restoreFocus(i),C.shell.bodyFocusCorrection=r)}}),f[0].setAttribute("data-dyn-content-applied","true"),C.debug.general&&(f[0].dynContent.__name="appendContent-"+e)}}($dyn=$dyn||{}),function(m){var e;Globalize.addCultureInfo("en",{messages:{Framework_MissingTemplate:"{0} has no template"}}),m.templates={},m.templatesLoaded=!1,m.loadTemplates=function(){$(".dyn_templates > [id]").each(function(e,t){t.parentNode.removeChild(t),m.templates[t.id]=t,m._processTemplate(t.id,t)}),m.templatesLoaded=!0},(e=m.resources||(m.resources={})).getRequired=function(){var e=[];for(var t in m.resources.required)e.push(new m.HtmlImports(t,!0).promise());return $.when.apply($.when,e)},e.addResource=function(e,t){var o=e.dynResources;(o=o||(e.dynResources=m.observableArray([]))).push(t)},e.getResource=function(e){var t=e.dynResources;return t=t||(e.dynResources=m.observableArray([]))},e._addUnresolvedElement=function(t,e,o){var n,i=(n=e instanceof m.HtmlImports?e:new m.HtmlImports(e)).promise();"resolved"!==i.state()&&(o.dynResources=o.dynResources||m.observableArray([]),o.dynResources.push(n),m.async.pending.increment("Requesting external resource"),i.then(function(){t.classList.remove("unresolved"),m.async.pending.decrement("External resource loaded"),m.ui.updateBlock(t.parentNode,function(){var e=t[m.Const.templateResolveAction];e&&(t[m.Const.templateResolveAction]=void 0,"function"==typeof e&&e())})}),t.classList.add("unresolved"))},m.getTemplateInstance=function(e,t){t=t||"div";var o=document.createElement(t),n=m.parseTemplateSelector(e),i=m._getTemplate(n);return i?m._mergeTemplate(i,o):m.logError(m.format(m.label("Framework_MissingTemplate"),n)),$(o)},m.loadTemplateInstance=function(e,t,o){var n,i,r=m.parseTemplateSelector(e);function a(){var e=m._getTemplate(n);return e?m._mergeTemplate(e,o):m.logError(m.format(m.label("Framework_MissingTemplate"),n)),$(o)}"string"==typeof r?n=i=r:(n=r.templateId,i=r.resource),n=n||i,i?m.requireResourceBundle(i,function(){var e=a();t(e)}):t(a())},m._getTemplate=function(e){m.templatesLoaded||m.loadTemplates();var t=m.templates[e];return t||(t=document.getElementById(e))&&(t.parentNode.removeChild(t),m.templates[e]=t),t&&m._processTemplate(e,t),t},m._processTemplate=function(e,t){m._processedTemplates[e]||($(t).find("*").addBack().each(function(e,t){m._parseContent(t),m._parseDataContext(t,void 0),m._parseBasicBindings(t),m._preprocessBindings(m._parseDataBindings(t),t)}),m._processedTemplates[e]=!0)};var t=(o.prototype.subscribeEvent=function(e,t){var o;this.templateElement.getAttribute(e)?0!==(o=this.templateElement.getAttribute(e)).indexOf("$dyn._evt")&&m.logError("Cannot subscribe static event. Template element already contains "+e+' attribute. "'+o+'"'):o="$dyn._evt(this, event)",m.templateHandler._eventHandlers.push({handler:this._handlerType,callbackName:t,templateHandler:this}),o=o.replace(")",", "+(m.templateHandler._eventHandlers.length-1)+")"),this.templateElement.setAttribute(e,o)},o._eventHandlers=[],o);function o(e,t,o){this.templateElement=e,this._handlerType=t,this.expression=o}m.templateHandler=t,m._evt=function(e,t){for(var o=2;o<arguments.length;o++){var n=arguments[o],i=m.templateHandler._eventHandlers[n],r=i.handler,a=m.bindingHandlers[r],s=e.dynStates?e.dynStates[r]:void 0,l=e.dynLastEval?e.dynLastEval[r]:void 0;void 0===l&&(l=e.dynLastHandlerValue?e.dynLastHandlerValue[r]:void 0);var u=void 0;void 0===l&&(u=(u=e.dynContext)||m.ui._findVirtualizedContextWrapper(e),l=m.peek(i.templateHandler.expression(u,e)[r]),!s&&a.setup&&void 0!==(s=a.setup(e,l))&&(e.dynStates||(e.dynStates={}))),m.callFunction(a[i.callbackName],a,t,e,l,s,u&&u.current)}},m._preprocessBindings=function(e,t){var o=t.getAttribute("data-dyn-role");if((!o||""===o)&&e)for(var n=0;n<e.length;n++){var i=e[n];for(var r in i){var a=m.bindingHandlers[r];a&&a.setupTemplate&&a.setupTemplate(new m.templateHandler(t,r,i[r]))}}},m._mergeTemplate=function(e,t){var o,n,i=function(e,t){t.dynBasicBindings=e.dynBasicBindings;for(var o=0;o<e.childNodes.length;o++)i(e.childNodes[o],t.childNodes[o])},r=e.cloneNode(!0);i(e,r),t.dynBasicBindings=e.dynBasicBindings;var a=$(r),s=$(t),l=t.getAttribute("data-dyn-bind");l&&t.setAttribute("data-dyn-options","{"+l+"}");var u=r.attributes;for(n=u.length,o=0;o<n;o++){var d=u[o],c=d.name;switch(c){case"class":s.addClass(r.getAttribute("class"));break;case"id":break;default:t.setAttribute(c,d.value)}}var p=t.hasAttribute("data-dyn-container");if(t.children.length||p){var h=void 0;if(t.dynChildren)h=t.dynChildren;else for(h=m._getChildren(t),o=0,n=t.children.length;o<n;o++)h.set(o,t.children[o]);p&&$(t.children).detach(),s.prepend(a.children()),p?m.applyContent($(t),h):e.children.length?m.logError("The data-dyn-container needs to be set when both the template and the target have children"):m.contentHandlers.append(s,"*",m._createContentWrapper(h),!0)}else s.prepend(a.children());t.setAttribute(m.Const.templateApplied,"true")},m.makeTemplatedContainer=function(e){var t;if(e.dynChildren)t=e.dynChildren;else{t=m._getChildren(e);for(var o=0,n=e.children.length;o<n;o++)t.set(o,e.children[o])}m.contentHandlers.append($(e),"*",m._createContentWrapper(t),!0)},m.makeContainer=function(e){var t=e.dynChildren;if(!e.dynChildren){var o=[];e.dynChildren=t=m.observable(o),t.__templateChildren=!0,t.set=function(e,t){o[e]=t},t.splice=function(e,t){o.splice.apply(o,arguments)}}for(var n=0,i=e.children.length;n<i;n++)t.set(n,e.children[n]);return m.contentHandlers.append($(e),"*",m._createContentWrapper(t),!0),t},m.getResourceManager=function(e){return new m.HtmlImports(e)};var s=m.flags.useHtmlImports&&"import"in document.createElement("link"),n=(Object.defineProperty(d.prototype,"loaded",{get:function(){return"resolved"===this.deferred.state()},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"state",{get:function(){return this.deferred.state()},enumerable:!1,configurable:!0}),d.prototype._loadImportContent=function(e){var l=this;l.log&&l.log("Resources: loaded content for import '%s'",l.importUrl.url);var t=document.createElement("div");t.setAttribute("data-dyn-resource",this.importUrl.url);var u=[];for(var o in e=e.replace(d._parseContent,function(e,t,o,n,i,r){var a=t||o;if(o&&m.logError("Resources: <div data-dyn-script> is obsolete, please use <script src=\"url\"><\/script> instead '%s' for '%s'",o,l.importUrl.url),a)u.push(m.util.parseUrl(a).relativeTo(l.importUrl));else if(n)l.imports.push(m.util.parseUrl(n).relativeTo(l.importUrl));else{var s=i||r;i&&m.logError("Resources: data-dyn-css is obsolete, please use href instead '%s' for '%s'",i,l.importUrl.url),s&&(l.styleSheets[m.util.parseUrl(s).relativeTo(l.importUrl)]=!0)}return""}),this.actions=$.Deferred().resolve(),l.styleSheets)if(!(o in d.allStyleSheets)){m.flags.useDesignTimeView&&"."!==o.substring(0,1)&&(o="."+o),l.log&&l.log("Resources: stylesheet '%s' required for '%s'",o,l.importUrl.url);var n=document.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href",o),document.head.appendChild(n)}this.actions=l.imports.reduce(function(e,t){return e.then(function(){return l.log&&l.log("Resources: import required '%s' for '%s'",t,l.importUrl.url),(d.allImports[t]=new m.HtmlImports(t,l.ignoreErrors)).promise()})},this.actions),this.actions=u.reduce(function(e,t){var s=t;return m.flags.useDesignTimeView&&"."!==s.substring(0,1)&&(s="."+s),l.log&&l.log("Resources: script required '%s' for '%s'",s,l.importUrl.url),l.scripts[s]=e.then(function(){var t=d.allScripts[s];if(!t){t=d.allScripts[s]=$.Deferred();var o=document.createElement("script"),n=function(){l.log&&l.log("Resources: loaded script '%s' for '%s'",s,l.importUrl.url),$(this).attr("data-dyn-script","loaded"),t.resolve(s),o.removeEventListener("load",n,!1),o.removeEventListener("error",a,!1)},i=0,r=function(e){l.ignoreErrors?(t.resolve(e),m.logError("Resources: Error loading %s",e)):(t.reject(e),m.logNonFatalError("Failed to load: "+e)),o.removeEventListener("load",n,!1),o.removeEventListener("error",a,!1)},a=function(){!function(t){if(i<3){i++;var e=1e3*Math.pow(2,i);setTimeout(function(){l.log&&l.log("Retrying script '%s' (attempt %d)",t,i);var e=document.createElement("script");e.addEventListener("load",n,!1),e.addEventListener("error",a,!1),e.setAttribute("src","".concat(t,"?retry=").concat(i)),e.setAttribute("data-dyn-script","loading"),document.head.appendChild(e)},e)}else r(t)}(s)};o.addEventListener("load",n,!1),o.addEventListener("error",a,!1),o.setAttribute("src",s),o.setAttribute("data-dyn-script","loading"),document.head.appendChild(o)}return t})},this.actions),t.innerHTML=e,$(".dyn_templates").append(t),$(t).children("[id]").each(function(e,t){t.parentNode&&t.parentNode.removeChild(t),m.templates[t.id]=t,m._processTemplate(t.id,t)}),this.actions.then(function(){l.log&&l.log("Resources: loaded import: %s",l.importUrl.url);var e=m.ui.layout();e||m.ui.layout(!0),l.deferred.resolve(l.importUrl.url),e||m.ui.layout(!1)}).fail(function(){l.deferred.reject()})},d.prototype.getTemplateContainer=function(){if(!m.__templateContainer&&(m.__templateContainer=$(".dyn_templates")[0],!m.__templateContainer)){var e=$('<div class="dyn_templates" style="display:none"></div>');$("body",document).append(e),m.__templateContainer=e[0]}return m.__templateContainer},d.prototype.promise=function(){return this.deferred.promise()},d.onResourceLoaded=new m.eventHost,d.allImports={},d.allStyleSheets={},d.allScripts={},d._parseContent=/<script src=\"(.*)\"><\/script>|<div data-dyn-script=\"(.*)\"><\/div>|<link href=\"(.*)\" rel=\"import\" \/>|<link data-dyn-css=\"(.*)\" rel=\"stylesheet\" type=\"text\/css\" \/>|<link href=\"(.*)\" rel=\"stylesheet\" type=\"text\/css\" \/>/g,d);function d(n,e){var i=this;this.log=m.log.resources,this.useNative=s,this.ignoreErrors=e;var t=d.allImports[n];if(t)this.deferred=t.deferred;else if(this.deferred=$.Deferred(),this.deferred.then(function(e){m.HtmlImports.onResourceLoaded.raise(e)}),this.importUrl=m.util.parseUrl(n),this.importUrl.fileName||(this.importUrl=m.util.parseUrl(n+".htm")),this.imports=[],this.scripts={},this.styleSheets={},(d.allImports[n]=this).useNative){var o=this,r=document.createElement("link");r.setAttribute("href",this.importUrl.url);r.addEventListener("load",function(){"loading"!=this.import.readyState&&(o.log&&o.log("Resources: loading import: %s",n),$(this.import.body).children().each(function(e,t){t.parentNode.removeChild(t),m.templates[t.id]=t,m._processTemplate(t.id,t)}),o.deferred.resolve(n))},!1),r.setAttribute("rel","import"),document.head.appendChild(r)}else{var a={type:"GET"};a.url=this.importUrl.url,a.beforeSend=function(){m.ui.PerformanceTimer&&m.ui.PerformanceTimer._addAction("HtmlImport"),m.ui.PerformanceTimer&&m.ui.PerformanceTimer._startAjax()},a.success=function(e){m.ui.PerformanceTimer&&m.ui.PerformanceTimer._stopAjax(),i._loadImportContent(e)},a.error=function(e,t,o){m.ui.PerformanceTimer&&m.ui.PerformanceTimer._stopAjax(),i.ignoreErrors?i.deferred.resolve():(m.logNonFatalError("Error: "+o+" - Failed to load HtmlImport: "+n),i.deferred.reject(o))},this.log&&this.log("Resources: loading import: %s",n),$.ajax(a)}}m.HtmlImports=n,m.HtmlImports.prototype.onResourceLoaded=m.HtmlImports.onResourceLoaded,m.requireResourceBundle=function(e,t){e?m.getResourceManager(e).promise().then(t):t()},m._templateExpressionCache={},m.parseTemplateSelector=function(e){if("string"==typeof e){if(m._templateExpressionCache[e])return m._templateExpressionCache[e];if(0<=e.indexOf(":"))return m._templateExpressionCache[e]=new Function(" return {"+e+"};").call(void 0),m._templateExpressionCache[e]}return e},m._processedTemplates={}}($dyn=$dyn||{}),function(Zt){var e;Globalize.addCultureInfo("en",{messages:{Framework_No_Alt_Text:"Image",Framework_No_Image_Description:"No image"}}),(Zt.onKeyDownEvent||(Zt.onKeyDownEvent={})).callKeyDownFunction=function(e){if(Zt.util.isShortcutKeyPressed(e,{alt:!0,keyCode:Zt.ui.KeyCodes.upArrow})){var t=e.target;i(t,e)||t.removeEventListener("keydown",Zt.onKeyDownEvent.callKeyDownFunction)}},(e=Zt.onFocusEvent||(Zt.onFocusEvent={}))._focusEventTimeout=3e3,e.callFocusInFunction=function(e){var t=e.currentTarget;if(Zt.util.isTooltipOnFocusEnabled()){var o=Zt.context(t);o&&o.optOutFocusTimer&&o.optOutFocusTimer()||(t.dynFocusedTimer=window.setTimeout(function(){i(t,e)||Zt.onFocusEvent.clearFocusEvents(t)},Zt.onFocusEvent._focusEventTimeout))}},e.callFocusOutFunction=function(e){var t=e.currentTarget;t.getAttribute("dyn-data-preview")&&Zt.preview.tryClosePreview(t,e),t.getAttribute("dyn-data-fieldoptions")&&Zt.fieldOptions.fieldOptionsRemove(t),t.dynFocusedTimer&&(window.clearTimeout(t.dynFocusedTimer),t.dynFocusedTimer=void 0)},e.clearFocusEvents=function(e){e.hasAttribute("dyn-data-preview")||e.hasAttribute("dyn-data-supertooltip")||e.hasAttribute("dyn-data-fieldoptions")||($(e).off("focus",Zt.onFocusEvent.callFocusInFunction),$(e).off("blur",Zt.onFocusEvent.callFocusOutFunction))};var t,o,n,i=function(e,t){var o=!1;if(e.hasAttribute("dyn-data-preview"))o=!0,Zt.preview.tryOpenPreview(e,t);else if(e.hasAttribute("dyn-data-supertooltip")){o=!0;var n=e.hasAttribute("dyn-data-supertooltip-skip-overflow");Zt.superTooltip.tryOpenSuperTooltip(e,void 0,void 0,n)}return e.hasAttribute("dyn-data-fieldoptions")&&(o=!0,Zt.fieldOptions.fieldOptionsAdd(e)),o&&e.dynFocusedTimer&&(window.clearTimeout(e.dynFocusedTimer),e.dynFocusedTimer=void 0),o};(t=Zt.onMouseEvent||(Zt.onMouseEvent={})).callMouseEnterFunction=function(e){var t=e.currentTarget;i(t,e)||Zt.onMouseEvent.clearMouseEvents(t)},t.callMouseLeaveFunction=function(e){var t=e.currentTarget;t.getAttribute("dyn-data-preview")&&Zt.preview.tryClosePreview(t,e),t.getAttribute("dyn-data-fieldoptions")&&Zt.fieldOptions.fieldOptionsRemove(t)},t.clearMouseEvents=function(e){e.hasAttribute("dyn-data-preview")||e.hasAttribute("dyn-data-supertooltip")||e.hasAttribute("dyn-data-fieldoptions")||($(e).off("mouseenter",Zt.onMouseEvent.callMouseEnterFunction),$(e).off("mouseleave",Zt.onMouseEvent.callMouseLeaveFunction))},(o=Zt.fieldOptions||(Zt.fieldOptions={})).fieldOptionsAdd=function(e){var t=Zt.context(e);if(t){var o=t.Root;if(o&&"Workspace"!==o.Style&&!e.hasAttribute("disabled")&&!$(e).closest(".filterDisplay-addField-flyOut")[0]&&!$(e).closest(".SidePanel")[0]&&!$(e).closest(".preview")[0]&&!$(e).closest(".CustomFilter")[0]&&!$(e).closest(".list-listMode")[0]){var n=Zt.context(Zt.shell.getActiveForm());if("FactBoxForm"!==o.TypeName&&n&&n.CanSwitchViewMode()&&n.IsInViewMode()&&Zt.value(t.IsViewMode)){var i=e.querySelector(".fieldOptions");i&&(t.isFocused()?i.classList.add("fieldOptionsShowIsFocusedControl"):i.classList.add("fieldOptionsShow"))}}}},o.fieldOptionsRemove=function(e){var t=Zt.context(e).Root;if(t&&"FactBoxForm"!==t.TypeName&&"Workspace"!==t.Style&&!e.hasAttribute("disabled")){var o=Zt.context(Zt.shell.getActiveForm());if(o&&o.CanSwitchViewMode()&&o.IsInViewMode()){var n=e.querySelector(".fieldOptionsShow");n&&n.classList.remove("fieldOptionsShow"),(n=e.querySelector(".fieldOptionsShowIsFocusedControl"))&&n.classList.remove("fieldOptionsShowIsFocusedControl")}}},(n=Zt.preview||(Zt.preview={})).storeToolTip=function(e){var t=$(e).find(":input")[0];t&&t.getAttribute("title")||(t=e);var o=t.getAttribute("title");o&&(t.setAttribute("data-dyn-savedtooltip",o),t.setAttribute("data-dyn-previewenabled","true"),t.removeAttribute("title"))},n.restoreToolTip=function(e){var t=$(e).find(":input")[0];if(t&&t.getAttribute("data-dyn-savedtooltip")||(t=e),t){var o=t.getAttribute("data-dyn-savedtooltip");o&&t.setAttribute("title",o)}t.removeAttribute("data-dyn-previewenabled")},n.tryOpenPreview=function(n,e){if(n&&"false"!==n.getAttribute("data-dyn-canhavepreview")&&!n.dynHoveredTimer){var i=Zt.ui.getLiveControl(n),t=function(e){if(!i)return Zt.preview.restoreToolTip(n),void(n.dynHoveredTimer=void 0);if(i.isPreviewControlHovered?(i.isPreviewControlHovered(!0),i.isPreviewHovered(!1)):(i.isPreviewControlHovered=Zt.observable(!0),i.isPreviewHovered=Zt.observable(!1)),n.dynPreviewContext=i,Zt.value(i.CanHavePreview)&&i.RequestEnhancedPreview){i.PreviewRequested=!0;var t=i.isPreviewControlHovered.valueChanged.subscribe(function(e){Zt.value(e)||(Zt.log.preview&&Zt.log.preview("Preview: isPreviewControlHovered changed %s, %s, %s",i.PreviewRequested,i.isPreviewControlHovered,i.isPreviewHovered),!i.PreviewRequested||Zt.value(i.isPreviewControlHovered)||Zt.value(i.isPreviewHovered)||(Zt.shell.previewManager.closePreview(i),i.isPreviewControlHovered.valueChanged.unsubscribe(t)))}),o=Zt.shell.previewManager.canOpenPreview(i,n,e);Zt.log.preview&&Zt.log.preview("Preview: hovered %s",o),o?(Zt.ui.layout(!0),Zt.shell.previewManager.displayPreview(i,n,e),i.PreviewRequested=!0,Zt.ui.layout(!1)):Zt.preview.restoreToolTip(n)}};i&&Zt.value(i.CanHavePreview)?(Zt.preview.storeToolTip(n),e&&Zt.util.isShortcutKeyPressed(e,{alt:!0,keyCode:Zt.ui.KeyCodes.upArrow})?t(!0):n.dynHoveredTimer=window.setTimeout(t,1e3)):n.setAttribute("data-dyn-canhavepreview","false")}},n.tryClosePreview=function(e,t){if(e&&(e.dynHoveredTimer||e.dynFocusedTimer)){$(document.body).off("keydown.Preview");var o=e.dynPreviewContext;Zt.log.verbosePreview=Zt.log.preview,e.dynHoveredTimer&&(window.clearTimeout(e.dynHoveredTimer),e.dynHoveredTimer=void 0),e.dynFocusedTimer&&(window.clearTimeout(e.dynFocusedTimer),e.dynFocusedTimer=void 0);var n=e;o&&o.element&&(n=o.element),Zt.preview.restoreToolTip(n),o?(Zt.log.preview&&Zt.log.preview("Preview: isPreviewControlHovered false"),o.isPreviewControlHovered(!1)):Zt.log.preview&&Zt.log.preview("Preview: preview not open")}else Zt.log.verbosePreview&&Zt.log.verbosePreview("Preview: no pending preview")},function(e){var t=(o.prototype.apply=function(e,t){if(e&&t)for(var o in e)t.scopeVars[o]=e[o]},o.prototype.dispose=function(){},o);function o(e){this.targetElement=e}e.vars=function(e){return new t(e)};var n=(i.prototype.invoke=function(e,t){e.id=t},i);function i(){}e.id=new n;function g(r){return function(e){function t(){n&&Zt.value(n).apply(i,arguments)}var n,o=$(e),i=Zt.context(e);return o.on(r,t),{apply:function(e,t,o){n=e},dispose:function(){o.off(r,t)}}}}function y(s){return function(o){for(var n,e=Zt.context(o),i=function(){n&&Zt.value(n).apply(e,arguments)},r=s.split(" "),t=0,a=r.length;t<a;t++)o.addEventListener(r[t],i,!0);return{apply:function(e,t,o){n=e},dispose:function(){for(var e=0,t=r.length;e<t;e++)o.removeEventListener(r[e],i,!0)}}}}var r=(a.prototype.setup=function(e,t){var o=(this.captureMode?y:g)("click contextmenu")(e),i=t,r=!1,a=!1,s=!1,l=!1,n=0,u=!1,d=!1,c=Zt.role(e),p=Zt.contextValue(c.context);function h(){u||(Zt.shell.startExtendedEventLoop(),u=!0),d&&p&&!p.optOutOfAllowSave&&(p.optOutOfAllowSave=!0),n&&window.clearTimeout(n),n=window.setTimeout(m,5e3),window.addEventListener("mouseup",v,!0)}t&&"function"!=typeof t&&(i=t.callBack,r=!!t.captureRightClick&&!Zt.flags.useBrowserContextMenu,d=!!t.optOutOfAllowSave,a=!!t.preventDefault,s=!!t.stopPropagation,l=!!t.stopRightClickPropagation);var m=function(){u&&(Zt.shell.endExtendedEventLoop(),u=!1),p&&p.optOutOfAllowSave&&(p.optOutOfAllowSave=!1),n&&(window.clearTimeout(n),n=0)},v=function(){m(),window.removeEventListener("mouseup",v,!0)};return $(e).on("mousedown",h),o.apply(function(e){a&&e.preventDefault();var t=e.which===Zt.ui.MouseButtonCodes.rightButton,o="contextmenu"===e.type||t;if(s&&(!o||o&&l)&&(e.stopPropagation(),o?(Zt.log.stopPropagation&&Zt.log.stopPropagation("$dyn.bindingHandlers.click - right click"),e.preventDefault()):Zt.log.stopPropagation&&Zt.log.stopPropagation("$dyn.bindingHandlers.click")),!o||r&&o){var n=!1;Zt.value(Zt.ui.updating)||(Zt.ui.updating(!0),Zt.ui.layout(!0),n=!0),Zt.getFunction(i).apply(p,arguments),n&&(Zt.ui.updating(!1),Zt.ui.layout(!1))}},p),{handler:o,mouseDownHandler:h}},a.prototype.dispose=function(e,t){t&&t.handler&&t.handler.dispose&&t.handler.dispose(),$(e).off("mousedown",t.mouseDownHandler)},a);function a(e){void 0===e&&(e=!1),this.captureMode=e}e.click=new r(!1),e.captureClick=new r(!0);var s=(l.prototype.setupTemplate=function(e){e.subscribeEvent("onclick","clickCallback")},l.prototype.clickCallback=function(e,t,o,n,i){Zt.logDeprecated("$dyn.bindingHandlers.readonlyClick"),o&&!e.defaultPrevented&&Zt.callFunction(o,i,e)},l.prototype.invoke=function(){},l);function l(){}e.readonlyClick=new s;var u=(d.prototype.setupTemplate=function(e){e.subscribeEvent(this.eventName,this.callbackName)},d.prototype.invoke=function(){},d);function d(e,t){this.name=e,this.eventName=t,this.callbackName=e+"Callback",this[e+"Callback"]=function(e,t,o,n,i){o&&!e.defaultPrevented&&Zt.callFunction(o,i,e)}}e.onClick=new u("onClick","onclick"),e.onChange=new u("onChange","onchange"),e.onKeyDown=new u("onKeyDown","onkeydown"),e.onKeyPress=new u("onKeyPress","onkeypress"),e.onFocusIn=new u("onFocusIn","onfocusin"),e.onFocusOut=new u("onFocusOut","onfocusout"),e.onBlur=new u("onBlur","onblur"),e.onMouseEnter=new u("onMouseEnter","onmouseenter"),e.onMouseLeave=new u("onMouseLeave","onmouseleave"),e.onMouseUp=new u("onMouseUp","onmouseup"),e.onMouseDown=new u("onMouseDown","onmousedown"),e.onCut=new u("onCut","oncut"),e.onCopy=new u("onCopy","oncopy"),e.onPaste=new u("onPaste","onpaste"),e.onScroll=new u("onScroll","onscroll"),e.onInput=new u("onInput","oninput");var c=(p.prototype.setup=function(e){function t(){o.func&&o.func.apply(Zt.context(e),arguments)}var o={};return o.handler=t,$(e).on(this.eventName,t),o},p.prototype.invoke=function(e,t,o,n){n.func=t},p.prototype.dispose=function(e,t){t.handler&&$(e).off(this.eventName,t.handler)},p);function p(e){this.eventName=e}e.keyDown=new c("keydown"),e.keyPress=new c("keypress"),e.keyUp=new c("keyup"),e.focusIn=new c("focusin"),e.focusOut=new c("focusout"),e.blur=new c("blur"),e.mouseEnter=new c("mouseenter"),e.mouseLeave=new c("mouseleave"),e.mouseUp=new c("mouseup"),e.mouseDown=new c("mousedown"),e.cut=new c("cut"),e.copy=new c("copy"),e.paste=new c("paste"),e.scroll=new c("scroll"),e.input=new c("input");var h=(m.prototype.invoke=function(t,o,n){n&&Object.keys(n).forEach(function(e){$(t).off(e,n[e])}),o&&Object.keys(o).forEach(function(e){$(t).on(e,o[e])})},m.prototype.dispose=function(t,e,o){o&&Object.keys(o).forEach(function(e){$(t).off(e,o[e])})},m);function m(){}e.event=new h;var v=(f.prototype.setup=function(e,n){$(e).on("secondaryNavigation",function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];n instanceof Function?n(e):n[e.inputMode]instanceof Function&&n[e.inputMode](e)})},f.prototype.dispose=function(e){$(e).off("secondaryNavigation")},f);function f(){}e.secondaryNavigation=new v;var b=(C.prototype.setup=function(t,o){$(t).on("resize",function(e){o instanceof Function&&o.apply(Zt.context(t),[e])})},C.prototype.dispose=function(e){$(e).off("resize")},C);function C(){}e.resize=new b;var w=(_.prototype.setup=function(e,t){var o=$(e);o.hasClass("ui-resizable")||0!==o.closest(".repeater-template").length||o.resizable(t)},_.prototype.dispose=function(e){var t=$(e);t.resizable("instance")&&t.resizable("destroy")},_);function _(){}e.resizable=new w;var S=(I.prototype.invoke=function(e,t,o){t?("menuitem"!==e.getAttribute("role")&&e.setAttribute("aria-selected","true"),e.classList.add("selected")):("menuitem"!==e.getAttribute("role")&&e.setAttribute("aria-selected","false"),e.classList.remove("selected"))},I);function I(){}e.selected=new S;var T=(x.prototype.invoke=function(e,t,o){t&&(t&&t.length?(e.setAttribute("aria-valuemax",t.length.toString()),e.setAttribute("aria-valuemin","1")):(e.removeAttribute("aria-valuemax"),e.removeAttribute("aria-valuemin")))},x);function x(){}e.enumAriaItems=new T;var F=(k.prototype.invoke=function(e,t,o){if(null!=t)if(t<0)e.removeAttribute("aria-valuenow"),e.removeAttribute("aria-valuetext");else{var n=Zt.context(e);if("combobox"===e.getAttribute("role")&&e.tagName&&"input"===e.tagName.toLowerCase()&&n&&n.hasEmptyItems()||e.setAttribute("aria-valuenow",(t+1).toString()),n&&Zt.value(n.Items)){var i=Zt.value(n.Items)[t];switch(typeof i){case"string":if(i){e.setAttribute("aria-valuetext",i);break}case"object":if(Zt.value(i.Label)){e.setAttribute("aria-valuetext",Zt.value(i.Label));break}default:e.removeAttribute("aria-valuetext")}}else e.removeAttribute("aria-valuetext")}else e.removeAttribute("aria-valuenow"),e.removeAttribute("aria-valuetext")},k);function k(){}e.enumAriaSelection=new F;var P=(R.prototype.invoke=function(e,t){if(t)e.focus();else{var o=Zt.shell.clearBodyFocusCorrection();e.blur(),Zt.shell.bodyFocusCorrection=o}},R);function R(){}e.focus=new P;var M=(E.prototype.setup=function(t,e){var o=this,n=Zt.computed(function(){var o={};return $.each(Zt.value(e),function(e,t){o[e]=Zt.value(t)}),o});return n.__skipFirstTimeFire=!0,[n,Zt.observe(n,function(e){o.invoke(t,e)})]},E.prototype.shouldInvoke=function(){return!0},E.prototype.invoke=function(o,e,n){$.each(e,function(e,t){n&&Zt.value(t)===Zt.value(n[e])||o.setAttribute(e,Zt.value(t))})},E.prototype.dispose=function(e,t){for(var o in t)t[o].dispose&&t[o].dispose()},E);function E(){}e.AttributeBindingHandler=M,e.attr=new M;var N=(A.prototype.setup=function(){return{lastObserver:void 0}},A.prototype.invoke=function(o,e,t,n){n.lastObserver&&n.lastObserver.dispose(),n.lastObserver=Zt.observe(function(){var o={};return $.each(Zt.value(e),function(e,t){o[e]=Zt.value(t)}),o},function(e){$.each(e,function(e,t){o.style[e]=t})})},A.prototype.shouldInvoke=function(e,o){var n=!0;return void 0!==e&&void 0!==o&&Object.keys(e).length===Object.keys(o).length&&(n=!1,$.each(Zt.value(e),function(e,t){Zt.value(t)!==Zt.value(o[e])&&(n=!0)})),n},A.prototype.dispose=function(e,t){t.lastObserver&&(t.lastObserver.dispose(),t.lastObserver=void 0)},A);function A(){}e.style=new N;var D=(L.prototype.setup=function(){return Zt.logDeprecated("$dyn.bindingHandlers.prop"),{lastObserver:void 0}},L.prototype.invoke=function(o,e,t,n){n.lastObserver&&n.lastObserver.dispose(),n.lastObserver=Zt.observe(function(){var o={};return $.each(Zt.value(e),function(e,t){o[e]=Zt.value(t)}),o},function(e){$.each(e,function(e,t){$(o).prop(e,t)})})},L.prototype.shouldInvoke=function(e,o){var n=!0;return void 0!==e&&void 0!==o&&Object.keys(e).length===Object.keys(o).length&&(n=!1,$.each(Zt.value(e),function(e,t){Zt.value(t)!==Zt.value(o[e])&&(n=!0)})),n},L.prototype.dispose=function(e,t){t.lastObserver&&(t.lastObserver.dispose(),t.lastObserver=void 0)},L);function L(){}e.prop=new D;var O=(B.prototype.setup=function(t,e){var o=this,n={css:{},firstTime:!0};return n.lastObserver=Zt.observe(function(){var n={};return $.each(Zt.value(e),function(e,t){var o=Zt.value(t);o instanceof Function&&(o=o()),Zt.value(o.value),n[e]=o}),n},function(e){o.setCss(t,e,n)}),n},B.prototype.invoke=function(e,t,o,n){n.firstTime?n.firstTime=!1:this.setCss(e,Zt.peek(t),n)},B.prototype.shouldInvoke=function(){return!0},B.prototype.dispose=function(e,t){t.lastObserver&&t.lastObserver.dispose()},B.prototype.setCss=function(i,e,r){$.each(e,function(e,t){var o=r.css[e];for(var n in void 0!==o&&$(i).removeClass(o),t.options)if(t.options[n]===Zt.value(t.value)){$(i).addClass(n),r.css[e]=n;break}})},B);function B(){}e.chooseCss=new O;var V=(H.prototype.setup=function(n,i){var r=!0,a=[];return $.each(i,function(t,e){var o=Zt.observe(i[t],function(e){r||((e=Zt.value(e))&&"false"!==e?$(n).addClass(t):$(n).removeClass(t))});a.push(o)}),r=!1,a},H.prototype.shouldInvoke=function(e,t){return e===t&&Zt.logError("CSS binding handler does not support passing the same complex object."),!0},H.prototype.invoke=function(n,i,r,e){$.each(i,function(e,t){var o=Zt.value(t);i[e]=o,r&&o===r[e]||(o&&"false"!==o?$(n).addClass(e):$(n).removeClass(e))})},H.prototype.dispose=function(e,t){for(var o in t)t[o].dispose&&t[o].dispose()},H);function H(){}e.css=new V;var G=(z.prototype.setup=function(){return{DynGlobalStyles:{}}},z.prototype.shouldInvoke=function(e,t){return!(!e&&!t||!(e&&!t||!e&&t)&&e.css===t.css&&e.active===t.active)},z.prototype.invoke=function(e,t,o,n){var i=n.DynGlobalStyles,r=i[t.css];if(r||(r=[],i[t.css]=r),t.active&&"false"!==t.active)-1===r.indexOf(e)&&(r.push(e),$("body").addClass(t.css));else{var a=r.indexOf(e);-1!==a&&(r.splice(a,1),0===r.length&&$("body").removeClass(t.css))}},z);function z(){}e.globalstyle=new G;var U=(W.prototype.invoke=function(e,t,o){t&&"false"!==t?(e.classList.add("viewMode"),e.classList.remove("editMode")):(e.classList.add("editMode"),void 0!==o&&e.classList.remove("viewMode"))},W);function W(){}e.viewMode=new U;var K=(q.prototype.invoke=function(e,t){var o=t,n="";$.isPlainObject(t)&&(o=Zt.value(t.text),void 0!==t.emptyStr&&(n=Zt.value(t).emptyStr)),o&&""!==o||(o=n),e.textContent=o},q);function q(){}e.text=new K;var j=(Q.prototype.shouldInvoke=function(e,t){return $.isPlainObject(e)?e&&t?e.unit!==t.unit||e.value!==t.value:!t&&!!e:e!==t},Q.prototype.invoke=function(e,t){$.isPlainObject(t)||(t={value:t,unit:"px"}),t.unit||(t.unit="px"),t.value?e.style[this.item]=t.value+t.unit:e.style[this.item]="0"},Q);function Q(e){this.item=e}e.width=new j("width"),e.height=new j("height");var Y=(Z.prototype.shouldInvoke=function(e,t){return void 0===e||e!==t},Z.prototype.invoke=function(e,t,o){var n=!1;Zt.value(Zt.ui.layout)||(Zt.ui.layout(!0),n=!0);var i=Zt.role(e),r=i.context;if(i)if(i.childrenDataBound||t){if(!i.childrenDataBound&&t&&(i.shouldDataBindChildren=!0,r)){var a=!1;Zt.value(Zt.ui.updating)||(Zt.ui.updating(!0),a=!0),i.dataBindChildren(r),i.childrenDataBound&&i._setDataBound(),a&&Zt.ui.updating(!1)}}else i.shouldDataBindChildren=!1;Zt.util.setVisibility(e,t),n&&Zt.ui.layout(!1)},Z);function Z(){}e.visible=new Y;var J=(X.prototype.shouldInvoke=function(e,t){return void 0===e||e!==t},X.prototype.invoke=function(e,t,o){var n=!1;Zt.value(Zt.ui.layout)||(Zt.ui.layout(!0),n=!0),Zt.util.setVisibility(e,!t),n&&Zt.ui.layout(!1)},X);function X(){}e.hidden=new J;var ee=(te.prototype.shouldInvoke=function(e,t){return!(!e||e&&t&&e.ShowLabel===t.ShowLabel)},te.prototype.invoke=function(e,t,o){var n;n=void 0===t.ShowLabel?""===t.Label&&!0===t.AllowBlankLabel||!!t.Label:Zt.value(t.ShowLabel),Zt.util.setVisibility(e,n)},te);function te(){}e.showLabel=new ee;var oe=(ne.prototype.setupTemplate=function(e){e.subscribeEvent("oninput","onValueNowInput"),e.subscribeEvent("onkeypress","onValueNowKeyPress")},ne.prototype.shouldInvoke=function(e,t){return Zt.value(e.value)!==(t&&Zt.value(t.value))},ne.prototype.invoke=function(e,t,o){var n=Zt.value(t.value);e.value=void 0!==n?n:""},ne.prototype.onValueNowInput=function(e,t,o,n,i){var r=i[o.setter];r&&r.call(i,t.value,t)},ne.prototype.onValueNowKeyPress=function(e,t,o,n,i){var r=i[o.setter];r&&r.call(i,t.value,t)},ne.prototype.setValue=function(e,t){},ne.prototype.getValue=function(e){return e.value},ne);function ne(){}e.valueNow=new oe;var ie=(re.prototype.setup=function(o,e){if(!1!==e.allowEdit){var n=$(o),i=!1,r=e.binder,t=o.cloneNode(!1),a={changeMode:Zt.ui.ChangeMode.modified,isUpdating:!1,oldValue:void 0,focusInValue:void 0,inputTesterElement:t};return r.notifyCommitted=function(){a.oldValue=o.value,a.isUpdating=!1},a.changeMode=e.changeMode||Zt.ui.ChangeMode.modified,i=e.allowEnter||i,n.on("change.boundValue",function(){var e=o.value;e!==a.oldValue?(a.isUpdating=!1,a.oldValue=void 0,r.setValue(e,!1)):a.oldValue=void 0}),n.on("input.boundValue",function(e){a.isUpdating=!0}),n.on("keydown.boundValue",function(e){if(!o.readOnly&&(!r.shouldExecute||r.shouldExecute(e,i,a.isUpdating))){var t=o.value;(t!==a.oldValue||a.isUpdating&&a.changeMode===Zt.ui.ChangeMode.dirty)&&(a.isUpdating=!1,a.oldValue=t,r.performCleanup&&r.performCleanup(),r.setValue(t,!0),n.select())}}),n.on("focusin.boundValue",function(){a.isUpdating||o.readOnly||(void 0===a.oldValue&&(a.oldValue=o.value),void 0===a.focusInValue&&(a.focusInValue=o.value)),o.boundValueHandledBlur=void 0}),n.on("blur.boundValue",function(){o.boundValueHandledBlur=!0;var e=o.value;e===a.focusInValue&&(e!==a.oldValue||a.isUpdating&&a.changeMode===Zt.ui.ChangeMode.dirty?(a.isUpdating=!1,a.oldValue=void 0,r.preventForceChange&&r.preventForceChange()?r.setValue(e,!1):r.setValue(e,!0)):a.oldValue=void 0),a.focusInValue=void 0}),a}},re.prototype.shouldInvoke=function(e,t,o,n){if(void 0===e.binder)return!1;e.value=e.binder.getValue();var i=!1;return void 0===t?i=!0:void 0!==o.oldValue?i=e.value!==o.oldValue:(i=e.value!==t.value)||o.isUpdating||!o.inputTesterElement||(o.inputTesterElement.value=e.value,i=o.inputTesterElement.value!==n.value),i},re.prototype.invoke=function(e,t,o,n){if(t&&t.binder&&!n.isUpdating){var i=t.binder.getValue(),r=void 0!==i?i:"";e.value=r,void 0!==n.oldValue&&(n.oldValue=e.value),document.activeElement===e&&(Zt.ui.selectionStart(e,0),Zt.ui.selectionEnd(e,e.value.length))}},re.prototype.dispose=function(e,t){t&&($(e).off(".boundValue"),delete t.inputTesterElement)},re);function re(){}e.boundValue=new ie,e.value=function(n){function i(){var e=n.value;u&&e!==d&&(u(e),m=!1,d=void 0)}function r(){d||m||n.readOnly||(d=n.value)}function a(e){if(!n.readOnly){var t=e.ctrlKey||e.metaKey||!1;if(v||e.which!==Zt.ui.KeyCodes.enter)!m&&(!t&&Zt.ui.isPrintableKeyCode(e.which)||Zt.ui.isChangeableKeyCombo(e))&&(m=!0);else{var o=n.value;u&&(m||o!==d)&&(u(o,!0),m=!1,d=o)}}}function s(e){n.readOnly||!u||v||e.which!==Zt.ui.KeyCodes.enter||u(n.value)}function l(){var e=n.value;m&&u&&e===d&&(u(e,!0),m=!1,d=void 0)}var u,d,c,p=$(n),h=Zt.ui.ChangeMode.modified,m=!1,v=!1;return{apply:function(e,t,o){if($.isPlainObject(e))o=e.value,h=e.changeMode||h,v=e.allowEnter||v,c&&c.dispose(),c=Zt.observe(o,function(e){n.value=void 0!==e?e:""});else{n.value=void 0!==e?e:""}u=Zt.isObservable(o)?o:void 0,p.off("change",i).on("change",i),h===Zt.ui.ChangeMode.dirty?(p.off("focusin",r).on("focusin",r),p.off("keydown.value").on("keydown.value",a),p.off("blur",l).on("blur",l)):p.off("keydown.value").on("keydown.value",s)},dispose:function(){p.off("change",i),p.off("keydown.value"),h===Zt.ui.ChangeMode.dirty&&(p.off("focusin",r),p.off("blur",l)),c&&(c.dispose(),c=void 0)}}},e.selectedValue=function(s){Zt.logDeprecated("$dyn.bindingHandlers.selectedValue");function e(){l&&l(s.options[s.selectedIndex].value)}var l=void 0;return s.addEventListener("change",e),{apply:function(e,t,o){Zt.isObservable(o)&&(l=o);for(var n=Zt.value(o),i=0,r=s.options.length;i<r;i++){var a=s.options[i];a.value==n&&(a.selected=!0)}},dispose:function(){s.removeEventListener("change",e)}}};var ae=(se.prototype.setup=function(e){function t(){o.trigger("focusin")}Zt.logDeprecated("$dyn.bindingHandlers.focusInOnMouseDown");var o=$(e);return o.on("mousedown",t),t},se.prototype.dispose=function(e,t){$(e).off("mousedown",t)},se);function se(){}e.focusInOnMouseDown=new ae;var le=(ue.prototype.setup=function(e){var t={boundObservable:void 0,onChange:void 0};return t.onChange=function(){t.boundObservable&&e instanceof HTMLInputElement&&t.boundObservable(e.checked)},$(e).on("change",t.onChange),t},ue.prototype.invoke=function(e,t,o,n){Zt.isObservable(t)&&(n.boundObservable=t);var i=Zt.value(t);"string"==typeof i&&(i=Zt.util.stringToBoolean(i)),i?(e.setAttribute("aria-checked","true"),e instanceof HTMLInputElement&&(e.checked=!0)):(e.setAttribute("aria-checked","false"),e instanceof HTMLInputElement&&(e.checked=!1))},ue.prototype.shouldInvoke=function(e,t){return e&&"function"==typeof e&&t&&"function"==typeof t?e()!==t():e!==t},ue.prototype.dispose=function(e,t){$(e).off("change",t.onChange)},ue);function ue(){}e.checked=new le;var de=(ce.prototype.invoke=function(e,t){void 0===t&&(t=""),$(e).val(t)},ce);function ce(){}e.valueReadonly=new de;var pe=(he.prototype.invoke=function(t,e,o){var n,i=t.getAttribute("role"),r=he.TagsSupportingReadOnly.includes(t.tagName.toLowerCase()),a=he.RoleSupportsAriaReadOnly.includes(i),s=t.hasAttribute("dyn-aria-readonly-forced");if(e?s||!r?(t.removeAttribute("data-dyn-readonly"),a&&(t.removeAttribute("aria-readonly"),"switch"===i&&Zt.value(null===(n=Zt.context(t))||void 0===n?void 0:n.Enabled)&&t.removeAttribute("aria-disabled"))):r&&t.removeAttribute("readonly"):s||!r?(t.setAttribute("data-dyn-readonly","true"),a&&(t.setAttribute("aria-readonly","true"),"switch"===i&&t.setAttribute("aria-disabled","true"))):r&&t.setAttribute("readonly","true"),t===document.activeElement&&$(document.activeElement).is(":input")){var l,u=function(){if(t===document.activeElement&&Zt.shell.isActiveWindow()){Zt.log.focus&&Zt.log.focus("Focus: AllowEdit binding handler -> blurring and setting focus back to %s",t.id);var e=Zt.shell.clearBodyFocusCorrection();t.blur(),t.focus(),$(t).select(),Zt.shell.bodyFocusCorrection=e}l&&Zt.ui.updating.valueChanged.unsubscribe(l)};Zt.value(Zt.ui.updating)?l=Zt.ui.updating.valueChanged.subscribe(u):u()}},he.TagsSupportingReadOnly=["input","textarea"],he.RoleSupportsAriaReadOnly=["textbox","grid","gridcell","checkbox","switch","listbox"],he);function he(){}e.allowEdit=new pe;var me=(ve.prototype.invoke=function(e,t){t?e.setAttribute("aria-readonly","false"):e.setAttribute("aria-readonly","true"),e.setAttribute("dyn-aria-readonly-forced","true")},ve);function ve(){}e.ariaAllowEdit=new me;var ge=(ye.prototype.invoke=function(e,t,o){Zt.logDeprecated("$dyn.bindingHandlers.disabled"),t?e.setAttribute("disabled","disabled"):void 0!==o&&e.removeAttribute("disabled")},ye);function ye(){}e.disabled=new ge;var fe=(be.prototype.invoke=function(e,t,o){var n="input"===e.tagName.toLowerCase()||"textarea"===e.tagName.toLowerCase()||"button"===e.tagName.toLowerCase()||"option"===e.tagName.toLowerCase(),i=e.hasAttribute("dyn-aria-disabled");t?void 0!==o&&(i||!n?(e.removeAttribute("data-dyn-disabled"),"button"!==e.getAttribute("role")&&"listbox"!==e.getAttribute("role")||e.removeAttribute("aria-disabled")):n&&e.removeAttribute("disabled")):i||!n?(e.setAttribute("data-dyn-disabled","true"),"button"!==e.getAttribute("role")&&"listbox"!==e.getAttribute("role")||e.setAttribute("aria-disabled","true")):n&&e.setAttribute("disabled","disabled")},be);function be(){}e.enabled=new fe;var Ce=(we.prototype.invoke=function(e,t){t?e.removeAttribute("aria-disabled"):e.setAttribute("aria-disabled","true")},we);function we(){}e.ariaEnabled=new Ce;var _e=(Se.prototype.invoke=function(e,t,o){t?e.setAttribute(this.attributeName,t):o&&e.removeAttribute(this.attributeName)},Se);function Se(e){this.attributeName=e}e.href=new _e("href"),e.target=new _e("target"),e.Status=new _e("Status"),e.Trend=new _e("Trend"),e.dir=new _e("dir"),e.Value=new _e("Value"),e.src=new _e("src");var Ie=(Te.prototype.invoke=function(e,t,o){t=parseFloat(t),o=parseFloat(o),!isNaN(t)&&t||!o?t&&e.setAttribute("maxlength",t.toString()):e.removeAttribute("maxlength")},Te);function Te(){}e.maxlength=new Ie;var xe=(Fe.prototype.invoke=function(e,t,o){t=parseFloat(t),o=parseFloat(o),isNaN(t)&&o?e.removeAttribute(this.attributeName):0<=t&&e.setAttribute(this.attributeName,t.toString())},Fe);function Fe(e){this.attributeName=e}e.ariaValueNow=new xe("aria-valuenow"),e.dynValue=new xe("data-dyn-value");var ke=(Pe.prototype.invoke=function(e,t){t&&e.setAttribute(this.attributeName,t)},Pe);function Pe(e){this.attributeName=e}e.label=new ke("aria-label"),e.controlName=new ke("data-dyn-controlname"),e.Name=new ke("data-dyn-form-name");var Re=(Me.prototype.invoke=function(e,t){t?e.setAttribute(this.attributeName,"true"):e.removeAttribute(this.attributeName)},Me.prototype.shouldInvoke=function(e,t){return e!==t},Me);function Me(e){this.attributeName=e}e.required=new Re("required"),e.isIndeterminate=new Re("data-dyn-indeterminateprogress");var Ee=(Ne.prototype.invoke=function(e,t){t?e.removeAttribute(this.attributeName):e.setAttribute(this.attributeName,"true")},Ne.prototype.shouldInvoke=function(e,t){return e!==t},Ne);function Ne(e){this.attributeName=e}e.showMarkColumn=new Ee("data-dyn-hidemarkcolumn");var Ae=(De.prototype.invoke=function(e,t,o){void 0===t&&void 0!==o?e.removeAttribute(this.attributeName):t&&"false"!==t?e.setAttribute(this.attributeName,"true"):void 0===t||t&&"false"!==t||e.setAttribute(this.attributeName,"false")},De.prototype.shouldInvoke=function(e,t){return e!==t&&null!==e},De);function De(e){this.attributeName=e}e.ariaPressed=new Ae("aria-pressed"),e.ariaMultiselectable=new Ae("aria-multiselectable"),Zt.bindingHandlers["aria-multiselectable"]=e.ariaMultiselectable,e.extendedStyle={invoke:Zt.ui.replaceCssClass};var Le=(Oe.prototype.invoke=function(e,t){if(t){var o="alignment"+t;e.setAttribute("data-dynamics-input-alignment",t),e.classList.add(o)}},Oe);function Oe(){}e.textAlign=new Le;var Be=($e.prototype.invoke=function(e,t){t!==("password"===e.type)&&(t?e.setAttribute("type","password"):e.setAttribute("type","text"))},$e.prototype.shouldInvoke=function(e,t){return void 0!==e&&e!==t},$e);function $e(){}e.password=new Be;var Ve=(He.prototype.invoke=function(e,t){var o=void 0!==t.skip&&Zt.value(t.skip),n=void 0===t.enabled||Zt.value(t.enabled),i=void 0===t.visible||Zt.value(t.visible),r="true"===e.getAttribute("aria-hidden");o||!n||!i||r?e.setAttribute("tabindex","-1"):e.setAttribute("tabindex","0")},He.prototype.shouldInvoke=function(e,t){return!t||(Zt.value(e.skip)||!1===Zt.value(e.enabled))!==(Zt.value(t.skip)||!1===Zt.value(t.enabled))||Zt.value(e.visible)!==Zt.value(t.visible)},He);function He(){}e.skip=new Ve;var Ge=(ze.prototype.setup=function(a,e){function t(e){var t=a.dynTypeToSelectOptions,o=void 0!==Zt.value(t.skipCollapsedSelection)&&Zt.value(t.skipCollapsedSelection),n=void 0!==Zt.value(t.expanded)&&Zt.value(t.expanded);Zt.value(t.allowEdit)&&(o&&!n||!Zt.util.isShortcutKeyPressed(e,{keyCode:Zt.ui.KeyCodes.upArrow})?o&&!n||!Zt.util.isShortcutKeyPressed(e,{keyCode:Zt.ui.KeyCodes.downArrow})?!o&&Zt.util.isShortcutKeyPressed(e,{keyCode:Zt.ui.KeyCodes.home})?(m(),e.stopImmediatePropagation(),e.preventDefault()):!o&&Zt.util.isShortcutKeyPressed(e,{keyCode:Zt.ui.KeyCodes.end})&&(v(),e.stopImmediatePropagation(),e.preventDefault()):(p(),e.stopImmediatePropagation(),e.preventDefault()):(h(),e.stopImmediatePropagation(),e.preventDefault()))}function o(e){var t=a.dynTypeToSelectOptions;Zt.value(t.allowEdit)&&(l+=String.fromCharCode(e.which),clearTimeout(n),n=window.setTimeout(function(){var e=d(l);0<=e&&t.selectedIndex(e),u()},r._typeToSelectTimeoutValue),Zt.util.isShortcutKeyPressed(e,{keyCode:Zt.ui.KeyCodes.spacebar})&&(e.stopPropagation(),e.preventDefault()))}var n,i,r=this,s=$(a),l="",u=function(){l=""},d=function(e){var t=a.dynTypeToSelectOptions,o=t.shownIndex(),n=t.items;if(-1<=o&&o<n.length){for(var i=e.toLocaleLowerCase(),r=o+1;r<n.length;r++)if(c(i,n[r]))return r;for(r=0;r<o;r++)if(c(i,n[r]))return r}return-1},c=function(e,t){return t.Label.toLocaleLowerCase().startsWith(e)},p=function(){var e=a.dynTypeToSelectOptions,t=void 0!==Zt.value(e.expanded)&&Zt.value(e.expanded),o=t?e.listShownIndex()+1:e.shownIndex()+1;o<e.items.length?t?e.listShownIndex(o):(e.shownIndex(o),g(e)):m()},h=function(){var e=a.dynTypeToSelectOptions,t=void 0!==Zt.value(e.expanded)&&Zt.value(e.expanded),o=t?e.listShownIndex()-1:e.shownIndex()-1;0<=o?t?e.listShownIndex(o):(e.shownIndex(o),g(e)):v()},m=function(){var e=a.dynTypeToSelectOptions;void 0!==Zt.value(e.expanded)&&Zt.value(e.expanded)?e.listShownIndex(0):(e.shownIndex(0),g(e))},v=function(){var e=a.dynTypeToSelectOptions,t=void 0!==Zt.value(e.expanded)&&Zt.value(e.expanded),o=Zt.length(e.items)-1;t?e.listShownIndex(o):(e.shownIndex(o),g(e))},g=function(e){clearTimeout(i),i=window.setTimeout(function(){e.selectedIndex(e.shownIndex())},r._typeToSelectTimeoutValue)};return s.keydown(t),s.keypress(o),{keydown:t,keypress:o}},ze.prototype.invoke=function(e,t){e.dynTypeToSelectOptions=t},ze.prototype.dispose=function(e,t){for(var o in t)$(e).off(o,t[o]);e.dynTypeToSelectOptions&&(e.dynTypeToSelectOptions=null)},ze);function ze(){this._typeToSelectTimeoutValue=500}e.typeToSelect=new Ge;var Ue=(We.prototype.setup=function(i,r){function e(e){var t=Zt.value(r.skipCollapsedSelection),o=Zt.value(r.expanded);if(Zt.value(r.allowEdit)){if(e.which===Zt.ui.KeyCodes.backSpace){var n=i.value;0<n.length&&(n=n.slice(0,-1)),s(n,o)}t&&!o||!Zt.util.isShortcutKeyPressed(e,{keyCode:Zt.ui.KeyCodes.upArrow})?t&&!o||!Zt.util.isShortcutKeyPressed(e,{keyCode:Zt.ui.KeyCodes.downArrow})?!t&&Zt.util.isShortcutKeyPressed(e,{keyCode:Zt.ui.KeyCodes.home})?(c(),e.stopImmediatePropagation(),e.preventDefault()):!t&&Zt.util.isShortcutKeyPressed(e,{keyCode:Zt.ui.KeyCodes.end})&&(p(),e.stopImmediatePropagation(),e.preventDefault()):(u(),e.stopImmediatePropagation(),e.preventDefault()):(d(),e.stopImmediatePropagation(),e.preventDefault())}}function t(e){Zt.ui.isTextualKeyEvent(e)&&Zt.value(r.allowEdit)&&(s(i.value,Zt.value(r.expanded)),Zt.util.isShortcutKeyPressed(e,{keyCode:Zt.ui.KeyCodes.spacebar})&&(e.stopPropagation(),e.preventDefault()))}var o,n=this,a=$(i),s=function(e,t){t||l();for(var o=[],n=Zt.value(r.items),i=0;i<n.length;i++)n[i].Label.toLocaleLowerCase().startsWith(e.toLocaleLowerCase())&&(n[i].RealIndex=i,o.push(n[i]));0<o.length&&r.listShownIndex(0),r.filteredItems&&r.filteredItems(o),Zt.flyout.flyoutManager.repositionAllFlyouts()},l=function(){Zt.value(r.enabled)&&Zt.value(r.visible)&&r.expanded(!0)},u=function(){if(r.filteredItems){var e,t=Zt.value(r.expanded),o=Zt.value(r.filteredItems);o&&Zt.value(r.items).length!==o.length?(e=r.listShownIndex()+1)<o.length?r.listShownIndex(e):c():(e=t?r.listShownIndex()+1:r.shownIndex()+1)<Zt.value(r.items).length?t?r.listShownIndex(e):(r.shownIndex(e),r.listShownIndex(e),h(r)):c()}},d=function(){if(r.filteredItems){var e,t=Zt.value(r.expanded),o=Zt.value(r.filteredItems);o&&Zt.value(r.items).length!==o.length?-1<(e=r.listShownIndex()-1)?r.listShownIndex(e):p():0<=(e=t?r.listShownIndex()-1:r.shownIndex()-1)?t?r.listShownIndex(e):(r.shownIndex(e),r.listShownIndex(e),h(r)):p()}},c=function(){if(r.filteredItems){var e=Zt.value(r.expanded),t=Zt.value(r.filteredItems);t&&Zt.value(r.items).length!==t.length||e?r.listShownIndex(0):(r.shownIndex(0),r.listShownIndex(0),h(r))}},p=function(){if(r.filteredItems){var e=Zt.value(r.expanded),t=Zt.value(r.filteredItems);if(t&&Zt.value(r.items).length!==t.length)r.listShownIndex(t.length-1);else{var o=Zt.length(r.items)-1;e?r.listShownIndex(o):(r.shownIndex(o),r.listShownIndex(o),h(r))}}},h=function(e){clearTimeout(o),o=window.setTimeout(function(){e.selectedIndex(e.shownIndex())},n._typeToAutoCompleteTimeoutValue),a.val(m())},m=function(){return Zt.value(r.items)[Zt.value(r.shownIndex)].Label};return a.keydown(e),a.keyup(t),{keydown:e,keyup:t}},We.prototype.invoke=function(e,t){e.dynTypeToAutoCompleteOptions=t},We.prototype.dispose=function(e,t){for(var o in t)$(e).off(o,t[o]);e.dynTypeToAutoCompleteOptions&&(e.dynTypeToAutoCompleteOptions=null)},We);function We(){this._typeToAutoCompleteTimeoutValue=500}e.typeToAutoComplete=new Ue;var Ke=(qe.prototype.setupTemplate=function(e){e.subscribeEvent("onkeypress","typeToSelectKeypress"),e.subscribeEvent("onkeydown","typeToSelectKeydown")},qe.prototype.setup=function(){return{currentPrefix:""}},qe.prototype.typeToSelectKeypress=function(e,t,o,n,i){var r=this;Zt.value(o.allowEdit)&&(n.currentPrefix+=String.fromCharCode(e.which),clearTimeout(n.typeToSelectTimeoutId),n.typeToSelectTimeoutId=window.setTimeout(function(){var e=r.findNextWithPrefix(n.currentPrefix,o);0<=e&&o.selectedIndex(e),r.resetTypeToSelect(n)},500),Zt.util.isShortcutKeyPressed(e,{keyCode:Zt.ui.KeyCodes.spacebar})&&(e.stopPropagation(),e.preventDefault()))},qe.prototype.typeToSelectKeydown=function(e,t,o,n,i){var r=!Zt.value(o.expanded);Zt.value(o.allowEdit)&&(r||(Zt.util.isShortcutKeyPressed(e,{keyCode:Zt.ui.KeyCodes.upArrow})?(this.selectPreviousItem(o,n),e.stopImmediatePropagation(),e.preventDefault()):Zt.util.isShortcutKeyPressed(e,{keyCode:Zt.ui.KeyCodes.downArrow})&&(this.selectNextItem(o,n),e.stopImmediatePropagation(),e.preventDefault())))},qe.prototype.resetTypeToSelect=function(e){e.currentPrefix=""},qe.prototype.findNextWithPrefix=function(e,t){var o=t.shownIndex(),n=t.items;if(-1<=o&&o<n.length){for(var i=e.toLocaleLowerCase(),r=o+1;r<n.length;r++)if(this.isPrefix(i,n[r]))return r;for(r=0;r<o;r++)if(this.isPrefix(i,n[r]))return r}return-1},qe.prototype.isPrefix=function(e,t){return t.Label.toLocaleLowerCase().startsWith(e)},qe.prototype.selectNextItem=function(e,t){var o=e.shownIndex()+1;o<e.items.length&&(e.shownIndex(o),this.updateSelectedItem(e,t))},qe.prototype.selectPreviousItem=function(e,t){var o=e.shownIndex()-1;0<=o&&(e.shownIndex(o),this.updateSelectedItem(e,t))},qe.prototype.updateSelectedItem=function(e,t){clearTimeout(t.arrowNavigationTimeoutId),t.arrowNavigationTimeoutId=window.setTimeout(function(){e.selectedIndex(e.shownIndex())},500)},qe);function qe(){this.typeToSelectKeypress=this.typeToSelectKeypress.bind(this),this.typeToSelectKeydown=this.typeToSelectKeydown.bind(this)}e.OnTypeToSelectBindingHandler=Ke,e.onTypeToSelect=new Ke;var je=(Qe.prototype.shouldInvoke=function(e,t){return void 0===e||e!==t},Qe.prototype.invoke=function(e,t){Zt.value(t)?e.classList.remove("hideCheckBox"):e.classList.add("hideCheckBox")},Qe);function Qe(){}e.treeCheckBox=new je;var Ye=(Ze.prototype.setupTemplate=function(e){e.subscribeEvent("onclick","clickCallback"),e.subscribeEvent("onmousedown","mousedownCallback"),e.subscribeEvent("onkeydown","keyDownCallback")},Ze.prototype.clickCallback=function(e,t,o,n,i){o&&!e.defaultPrevented&&this.executeLink(e,t,o,n,i)},Ze.prototype.keyDownCallback=function(e,t,o,n,i){o&&!e.defaultPrevented&&e.which===Zt.ui.KeyCodes.enter&&this.executeLink(e,t,o,n,i)},Ze.prototype.executeLink=function(t,o,n,e,i){this.getShowLink(o)&&Zt.util.clickedText(o)&&Zt.async(function(){var e=!0;0<Zt.ui.selectionEnd(o)-Zt.ui.selectionStart(o)&&(e=!1),e&&Zt.callFunction(n.click,i,t)},void 0,"Hyperlink clickCallback")},Ze.prototype.mousedownCallback=function(e,t){e.which!==Zt.ui.MouseButtonCodes.rightButton&&Zt.util.deselectText(t)},Ze.prototype.invoke=function(e,t,o){var n=o&&o.showLink,i=t&&t.showLink;n!==i&&this.setShowLink(e,i)},Ze.prototype.getShowLink=function(e){return e.classList.contains("link-content-validLink")},Ze.prototype.setShowLink=function(e,t){t?e.classList.add("link-content-validLink"):e.classList.remove("link-content-validLink")},Ze);function Ze(){this.clickCallback=this.clickCallback.bind(this),this.mousedownCallback=this.mousedownCallback.bind(this),this.keyDownCallback=this.keyDownCallback.bind(this)}e.readonlyLink=new Ye;var Je=(Xe.prototype.updateValidLinkClass=function(e,t){var o=Zt.role(e).context,n=e.getAttribute("role");if(t.isNavigable=!1,e.dynLinkOptions.showLink){if(e.classList.add("link-content-validLink"),"link"===n||e.classList.contains("field")||e.setAttribute("role","link"),t.isNavigable=!0,e.dynLinkOptions.byElementId)e.setAttribute("aria-labelledby",e.dynLinkOptions.byElementId+" "+e.id);else if(e.dynLinkOptions.label){var i=e.dynLinkOptions.label,r=t.isDiv?e.textContent:e.value;r&&(i+=" "+r),e.setAttribute("aria-label",i)}o&&o.current&&(o.current.textChangedInternal=function(){e.dynLinkOptions.showLink=!1,Zt.bindingHandlers.link.updateValidLinkClass(e,t)})}else{if(e.classList.contains("link-content-validLink")){e.classList.remove("link-content-validLink");var a=e.getAttribute("role");"link"===a&&t.oldRole?t.oldRole!==a&&e.setAttribute("role",t.oldRole):"link"===a&&e.removeAttribute("role")}t.isNavigable=!1,e.dynLinkOptions.byElementId?e.setAttribute("aria-labelledby",e.dynLinkOptions.byElementId):e.dynLinkOptions.label&&e.setAttribute("aria-label",e.dynLinkOptions.label),o&&o.current&&(o.current.textChangedInternal=void 0)}},Xe.prototype.shouldInvoke=function(e,t){return!t||e.showLink!==t.showLink||e.readonly!==t.readonly||e.byElementId!==t.byElementId||e.label!==t.label},Xe.prototype.invoke=function(e,t,o,n){e.dynLinkOptions=t,this.updateValidLinkClass(e,n)},Xe.prototype.dispose=function(e,t){$(e).off(".link"),e.dynLinkOptions&&(e.dynLinkOptions=null)},Xe.prototype.setup=function(r,e){var a={isNavigable:!1,isDiv:"DIV"===r.tagName},s=$(r);return r.dynLinkOptions=e,a.oldRole=r.getAttribute("role"),s.on("click.link",function(o){var n=r.dynLinkOptions,i=!0;a.isDiv||0<Zt.ui.selectionEnd(r)-Zt.ui.selectionStart(r)&&(i=!1),Zt.util.clickedText(r)&&i&&Zt.async(function(){if(i){var e=function(){var e=$.Event("secondaryNavigation",{inputMode:"mouse",isMetaKeyPressed:o.ctrlKey||o.metaKey});s.trigger(e),a.isNavigable&&!e.isDefaultPrevented()&&Zt.getFunction(n.click)(),e.isDefaultPrevented()&&o.stopImmediatePropagation()},t=Zt.context(r);t&&t.Root&&t.Root.IsPreviewForm?Zt.flyout.flyoutManager.removeAllFlyoutsAsync().done(function(){e()}):e()}},0,"linkHandler click"),n.stopPropagation&&o.stopPropagation()}),s.on("keydown.link",function(e){var t=r.dynLinkOptions;if(e.which===Zt.ui.KeyCodes.enter&&(e.ctrlKey||e.metaKey)){var o=$.Event("secondaryNavigation",{inputMode:"keyboard"});s.trigger(o),a.isNavigable&&!e.isDefaultPrevented()&&Zt.getFunction(t.click)()}}),s.on("blur.link",function(e){Zt.bindingHandlers.link.updateValidLinkClass(r,a)}),s.on("mousedown.link",function(e){a.isDiv||e.which===Zt.ui.MouseButtonCodes.rightButton||Zt.util.deselectText(r)}),a},Xe);function Xe(){}e.link=new Je;var et=(tt.prototype.invoke=function(e,t){void 0!==t&&""!==t?e.title=t:e.removeAttribute("title")},tt);function tt(){}e.title=new et;var ot=(nt.prototype.shouldInvoke=function(e,t){return!t||e&&(e.showLabel!==t.showLabel||e.text!==t.text)},nt.prototype.invoke=function(e,t){t&&(t.showLabel?(t.forElement.setAttribute("aria-labelledby",e.id),t.text?e.textContent=t.text:t.emptyStr&&(e.textContent=t.emptyStr),"none"===e.style.display&&(e.style.display="")):e.style.display="none")},nt);function nt(){}e.labelFor=new ot;var it=(rt.prototype.shouldInvoke=function(e,t){return!t||e&&(e.showLabel!==t.showLabel||e.text!==t.text)},rt.prototype.invoke=function(e,t){t&&(t.forElementId&&e.setAttribute("for",t.forElementId),t.text?e.textContent=t.text:t.emptyStr&&(e.textContent=t.emptyStr),t.showLabel?"none"===e.style.display&&(e.style.display=""):e.style.display="none")},rt);function rt(){}e.ariaLabelFor=new it;var at=(st.prototype.shouldInvoke=function(e,t){return!t||e&&e.label!==t.label},st.prototype.invoke=function(e,t){if(t){var o=e.getAttribute("data-dyn-image-type");t.label?e.setAttribute("aria-label",t.label):o&&(!o||e.getAttribute("aria-label"))||e.removeAttribute("aria-label")}},st);function st(){}e.ariaLabel=new at;var lt=(ut.prototype.shouldInvoke=function(e,t){return!t||e&&(e.label!==t.label||e.toolTip!==t.toolTip)},ut.prototype.invoke=function(e,t){if(t){var o="";t.label?e.setAttribute("aria-labelledby",t.id+"_label"):t.toolTip?o=t.toolTip:(o=Zt.label("Framework_No_Alt_Text")+" ",t.imageName&&t.type===Zt.ui.ImageType.symbol?o+=t.imageName:t.name&&(o+=t.name)),o?e.setAttribute("aria-label",o):e.removeAttribute("aria-label")}},ut);function ut(){}e.ariaLabelImage=new lt;var dt=(ct.prototype.shouldInvoke=function(e,t){return!t||e&&e.byElementId!==t.byElementId},ct.prototype.invoke=function(e,t){var o,n,i,r,a;if(t)if(o=void 0!==t.isInGrid&&t.isInGrid,n=void 0===t.showLabel||t.showLabel,a=void 0!==t.removeIfBlank&&t.removeIfBlank,i=t.byElementId,void 0===t.label){var s=Zt.context(e);s&&Zt.value(s.Label)&&(r=Zt.value(s.Label))}else r=t.label;if(!i||!n&&a&&!r)return e.removeAttribute("aria-label"),void e.removeAttribute("aria-labelledby");o?r?e.setAttribute("aria-label",r):a?(e.removeAttribute("aria-label"),e.removeAttribute("aria-labelledBy")):e.setAttribute("aria-label",Zt.label("No_LabelFound")):n?(e.hasAttribute("aria-label")&&e.removeAttribute("aria-label"),e.setAttribute("aria-labelledby",i)):(e.hasAttribute("aria-labelledBy")&&e.removeAttribute("aria-labelledBy"),r?e.setAttribute("aria-label",r):a?e.removeAttribute("aria-label"):e.setAttribute("aria-label",Zt.label("No_LabelFound")))},ct);function ct(){}e.ariaLabelledBy=new dt;var pt=(ht.prototype.invoke=function(e,t){void 0===t?e.removeAttribute("aria-expanded"):t&&"false"!==t?e.setAttribute("aria-expanded","true"):void 0===t||t&&"false"!==t||e.setAttribute("aria-expanded","false")},ht);function ht(){}e.ariaExpanded=new pt;var mt=(vt.prototype.invoke=function(e,t){e.setAttribute("aria-controls",t&&t[0]&&t[0].id)},vt.prototype.shouldInvoke=function(e,t){return!t||(e&&e[0]&&e[0].id)!==(t&&t[0]&&t[0].id)},vt);function vt(){}function gt(e){for(var t=$(":header, [role='heading']"),o=2,n=t.length-1;0<n;n--){var i=$(t[n]),r=i.parent();if(r.hasClass("group_header")||"header"===r[0].tagName.toLocaleLowerCase())r=r.parent();else if(i.hasClass("mainInstruction")&&r.hasClass("group_content")){var a=r.parent();a.hasClass("TOCTitleContainer")&&(r=a.parent())}if(0<r.find(e).length){var s=parseInt(i.attr("aria-level"),10)||parseInt(i[0].tagName.substring(1),10);if(!isNaN(s)){o=s+1;break}}}return o}e.ariaControls=new mt;var yt=(ft.prototype.invoke=function(e,t){var o,n=Zt.context(e);if(Zt.value(n.Label)&&"heading"===e.getAttribute("role")){var i=$(n.element).find(".group_title");if(i){var r=gt(i);e.setAttribute("aria-level",r.toString())}}else e.classList.contains("formCaption")&&e.textContent&&"heading"!==e.getAttribute("role")?(e.setAttribute("aria-level","1"),e.setAttribute("role","heading")):"mainInstruction"===Zt.value(n.Style)&&Zt.value(n.Text)&&"TOCTitleContainer"===Zt.value(null===(o=n._parent)||void 0===o?void 0:o.Style)&&"heading"!==e.getAttribute("role")&&(r=gt($(e)),e.setAttribute("aria-level",r.toString()),e.setAttribute("role","heading"))},ft);function ft(){}e.ariaLevel=new yt;var bt=(Ct.prototype.setup=function(o,e){(0,$.isPlainObject)(e)||(e={flyout:e});var t=e.flyout,n=e.target=e.target||$(o),i=e.of=e.of||n,r=void 0===e.openOnClick||e.openOnClick;e.moveTo=void 0===e.moveTo?"body":e.moveTo,e.optOutOfWait=void 0!==e.optOutOfWait&&e.optOutOfWait;var a,s,l=e.show=Zt.isObservable(e.show)?e.show:Zt.observable(e.show);return r&&(n[0].dynFlyout=t,n[0].dynFlyoutLocation=i,n[0].dynShowFlyout=l),r?(t&&1===t.length&&(t[0].style.display="none"),Zt.util.flyout(e,!1),a=function(e){if(Zt.log.stopPropagation&&Zt.log.stopPropagation("Flyout button click"),e.stopPropagation(),l()||n.prop("disabled"))Zt.util.flyout.clickHandler(e);else{Zt.util.flyout.clickHandler(e);var t=Zt.context(o);t&&(t.TelemetryOptions={inputType:Zt.telemetry.InputType.mouse}),Zt.ui.layout(!0),l(!0),Zt.ui.layout(!1)}},s=function(e){if(Zt.util.isShortcutKeyPressed(e,{keyCode:[Zt.ui.KeyCodes.enter,Zt.ui.KeyCodes.spacebar]})||Zt.util.isShortcutKeyPressed(e,{alt:!0,keyCode:Zt.ui.KeyCodes.downArrow})){var t=Zt.context(o);t&&(t.TelemetryOptions={inputType:Zt.telemetry.InputType.keyboard}),n.is("button")&&!Zt.util.isShortcutKeyPressed(e,{alt:!0,keyCode:Zt.ui.KeyCodes.downArrow})||(e.preventDefault(),a(e))}},e.timeoutId=window.setTimeout(function(){n.click(a),n.keydown(s),e.timeoutId=void 0})):Zt.util.flyout(e,!0),{options:e,buttonClick:a,keyDown:s}},Ct.prototype.invoke=function(e,t,o,n){var i=n.options.timeoutId;n.options=t,n.options.timeoutId=i},Ct.prototype.dispose=function(e,t){t&&(t.options&&(t.options.timeoutId&&window.clearTimeout(t.options.timeoutId),t.options.showSubscriber&&t.options.showSubscriber.dispose(),t.options.ariaSubscriber&&t.options.ariaSubscriber.dispose(),t.options.activeFlyoutSubscriber&&t.options.activeFlyoutSubscriber.dispose()),t.buttonClick&&$(e).off("click",t.buttonClick),t.keyDown&&$(e).off("keydown",t.keyDown)),e.dynFlyout=null,e.dynFlyoutLocation=null,e.dynShowFlyout=null},Ct);function Ct(){}e.flyout=new bt;var wt=(_t.prototype.setupTemplate=function(e){e.subscribeEvent("onclick","flyoutClick"),e.subscribeEvent("onkeydown","flyoutKeyDown")},_t.prototype.flyoutClick=function(e,t,o,n){e.stopPropagation();var i=n.options,r=i.target,a=i.show;if(a()||r.prop("disabled"))Zt.util.flyout.clickHandler(e);else{Zt.util.flyout.clickHandler(e);var s=Zt.context(t);s&&(s.TelemetryOptions={inputType:Zt.telemetry.InputType.mouse}),Zt.ui.layout(!0),a(!0),Zt.ui.layout(!1)}},_t.prototype.flyoutKeyDown=function(e,t,o,n){var i=n.options.target;if(Zt.util.isShortcutKeyPressed(e,{keyCode:[Zt.ui.KeyCodes.enter,Zt.ui.KeyCodes.spacebar]})||Zt.util.isShortcutKeyPressed(e,{alt:!0,keyCode:Zt.ui.KeyCodes.downArrow})){var r=Zt.context(t);r&&(r.TelemetryOptions={inputType:Zt.telemetry.InputType.keyboard}),i.is("button")&&!Zt.util.isShortcutKeyPressed(e,{alt:!0,keyCode:Zt.ui.KeyCodes.downArrow})||this.flyoutClick.apply(this,arguments)}},_t.prototype.setup=function(e,t){(0,$.isPlainObject)(t)||(t={flyout:t});var o=t.flyout,n=t.target=t.target||$(e),i=t.of=t.of||n,r=void 0===t.openOnClick||t.openOnClick;t.moveTo=void 0===t.moveTo?"body":t.moveTo,t.optOutOfWait=void 0!==t.optOutOfWait&&t.optOutOfWait;var a=t.show=Zt.isObservable(t.show)?t.show:Zt.observable(t.show);return r&&(n[0].dynFlyout=o,n[0].dynFlyoutLocation=i,n[0].dynShowFlyout=a),r?(o&&1===o.length&&(o[0].style.display="none"),Zt.util.flyout(t,!1)):Zt.util.flyout(t,!0),{options:t}},_t.prototype.invoke=function(e,t,o,n){n.options=t},_t.prototype.dispose=function(e,t){t&&t.options&&(t.options.showSubscriber&&t.options.showSubscriber.dispose(),t.options.activeFlyoutSubscriber&&t.options.activeFlyoutSubscriber.dispose())},_t);function _t(){this.flyoutClick=this.flyoutClick.bind(this),this.flyoutKeyDown=this.flyoutKeyDown.bind(this)}e.OnFlyoutBindingHandler=wt,e.onFlyout=new wt;var St=(It.prototype.setup=function(e,t){t&&t.CanHavePreview&&t.RequestEnhancedPreview&&e.setAttribute("dyn-data-preview","true")},It.prototype.invoke=function(e,t){t&&t.CanHavePreview&&t.RequestEnhancedPreview?($(e).on("mouseenter",Zt.onMouseEvent.callMouseEnterFunction),$(e).on("mouseleave",Zt.onMouseEvent.callMouseLeaveFunction),$(e).on("focus",Zt.onFocusEvent.callFocusInFunction),$(e).on("blur",Zt.onFocusEvent.callFocusOutFunction)):(e.removeAttribute("dyn-data-preview"),Zt.onMouseEvent.clearMouseEvents(e),Zt.onFocusEvent.clearFocusEvents(e))},It.prototype.shouldInvoke=function(e,t){return!(!e||e&&t&&e.CanHavePreview===t.CanHavePreview&&e.RequestEnhancedPreview===t.RequestEnhancedPreview)},It.prototype.dispose=function(e){e.removeAttribute("dyn-data-preview"),Zt.onMouseEvent.clearMouseEvents(e),e.dynHoveredTimer&&(window.clearTimeout(e.dynHoveredTimer),e.dynHoveredTimer=void 0),e.dynPreviewContext&&(e.dynPreviewContext=null)},It);function It(){}e.PreviewBindingHandler=St,e.preview=new St;var Tt=(xt.prototype.invoke=function(e,t){t?e.setAttribute("data-dyn-helptext",t):e.removeAttribute("data-dyn-helptext")},xt.prototype.shouldInvoke=function(e,t){return!(!e||e&&t)},xt);function xt(){}e.helpText=new Tt;var Ft=(kt.prototype.setup=function(e,t){t&&!t.AllowTyping&&Zt.context(e)&&Zt.context(e).Root&&"FactBoxForm"!==Zt.context(e).Root.TypeName&&e.setAttribute("dyn-data-fieldoptions","true")},kt.prototype.invoke=function(e,t){t&&!t.AllowTyping&&Zt.context(e)&&Zt.context(e).Root&&"FactBoxForm"!==Zt.context(e).Root.TypeName?($(e).on("mouseenter",Zt.onMouseEvent.callMouseEnterFunction),$(e).on("mouseleave",Zt.onMouseEvent.callMouseLeaveFunction)):(e.removeAttribute("dyn-data-fieldoptions"),Zt.onMouseEvent.clearMouseEvents(e))},kt.prototype.shouldInvoke=function(e,t){return!(!e||e&&t)},kt.prototype.dispose=function(e){e.removeAttribute("dyn-data-fieldoptions"),Zt.onMouseEvent.clearMouseEvents(e)},kt);function kt(){}e.fieldOptions=new Ft;var Pt=(Rt.prototype.setup=function(n,t){var i=this,r=null,a=null,s=null;function o(){if(r&&n.appendChild(r),r&&a&&l.children(".formCaption").length<1&&r.appendChild(a),r&&s&&l.children(".formCaption-context").length<1&&r.appendChild(s),r){var e=l.children("[data-dyn-controlname='SystemDefinedManageViewFilters']")[0];if(e&&u&&u.adjustSystemDefinedManageViewFilters){i.viewSelectorSubscription&&i.viewSelectorSubscription.dispose();var t=Zt.context(e),o="ExtendedStyle";t&&t.properties&&t.properties[o]?i.viewSelectorSubscription=t.observe(t.properties[o],function(e){u.adjustSystemDefinedManageViewFilters(e)}):u.adjustSystemDefinedManageViewFilters()}}}"Dialog"!==t.FormType&&((r=document.createElement("h1")).classList.add("formCaptionContainerWrapper"),(a=document.createElement("span")).classList.add("formCaption"),a.tabIndex=-1,$(a).on("click",function(e){t.HeaderClicked(e)}),$(a).on("keydown",function(e){Zt.util.isShortcutKeyPressed(e,{keyCode:Zt.ui.KeyCodes.enter})&&t.HeaderClicked(e)}),(s=document.createElement("span")).classList.add("formCaption-context"),Zt.util.isEnhancedTabSequenceEnabled()?s.tabIndex=0:s.tabIndex=-1,r.appendChild(a),r.appendChild(s),n.appendChild(r));var l=$(n),u=Zt.context(n);o();var d=new MutationObserver(function(e){d.disconnect(),o(),d.observe(n,c)}),c={childList:!0};return d.observe(n,c),{captionH1:r,captionSpan:a,captionContextSpan:s,mutationObserver:d}},Rt.prototype.invoke=function(e,t,o,n){n&&n.captionH1&&n.captionSpan&&n.captionContextSpan&&(n.captionSpan.textContent=Zt.value(t.Caption),n.captionContextSpan.textContent=Zt.value(t.TitleFields),Zt.value(t.TitleFields)?(n.captionContextSpan.removeAttribute("aria-hidden"),n.captionH1.classList.remove("NoContext")):(n.captionContextSpan.setAttribute("aria-hidden","true"),n.captionH1.classList.add("NoContext")))},Rt.prototype.dispose=function(e,t){t&&(t.mutationObserver&&t.mutationObserver.disconnect(),t.captionSpan&&$(t.captionSpan).off()),this.viewSelectorSubscription&&(this.viewSelectorSubscription.dispose(),this.viewSelectorSubscription=null)},Rt);function Rt(){}e.formHeaderCreate=new Pt;var Mt=(Et.prototype.setup=function(e,t){t&&(e.setAttribute("dyn-data-supertooltip","true"),t.SkipOverflowCheck&&e.setAttribute("dyn-data-supertooltip-skip-overflow","true"))},Et.prototype.invoke=function(e,t){t?($(e).on("keydown",Zt.onKeyDownEvent.callKeyDownFunction),t.OnlyKeyboard||($(e).on("mouseenter",Zt.onMouseEvent.callMouseEnterFunction),$(e).on("focus",Zt.onFocusEvent.callFocusInFunction),$(e).on("blur",Zt.onFocusEvent.callFocusOutFunction))):(e.removeAttribute("dyn-data-supertooltip"),$(e).off("keydown",Zt.onKeyDownEvent.callKeyDownFunction),Zt.onMouseEvent.clearMouseEvents(e),Zt.onFocusEvent.clearFocusEvents(e))},Et.prototype.shouldInvoke=function(e,t){return!(!e||e&&t)},Et.prototype.dispose=function(e){e.removeAttribute("dyn-data-supertooltip"),e.removeAttribute("dyn-data-supertooltip-skip-overflow"),$(e).off("keydown",Zt.onKeyDownEvent.callKeyDownFunction),Zt.onMouseEvent.clearMouseEvents(e),Zt.onFocusEvent.clearFocusEvents(e)},Et);function Et(){}e.superTooltip=new Mt;var Nt=(At.prototype.setup=function(){return{lastImageClass:""}},At.prototype.invoke=function(n,e,t,o){function i(e,t){if((a=document.createElement("img")).setAttribute("src",e),a.classList.add("imageBinder-image"),n.appendChild(a),a.removeAttribute("width"),a.removeAttribute("height"),t)a.setAttribute("alt",t),n.setAttribute("title",t);else{var o=Zt.context(n)&&Zt.context(n).Name||"";t=Zt.label("Framework_No_Alt_Text")+" "+o,a.setAttribute("alt",t)}}var r,a,s="";if(n.classList.remove("imageBinder-emptyImage"),n.removeAttribute("data-dyn-image-type"),n.removeAttribute("title"),Zt.util.empty(n),o&&o.lastImageClass&&n.classList.remove(o.lastImageClass),r="imageBinder-emptyImage",s="",e&&e.imageName){var l=Zt.context(n)&&Zt.context(n).Label||null;switch(n.removeAttribute("aria-description"),e.imageType){case Zt.ui.ImageType.symbol:e.imageName.match(/\s+/g)||(r=e.imageName+"-symbol",s="Symbol"),e.altText&&n.setAttribute("title",e.altText),Zt.value(l)||e.altText||n.setAttribute("aria-hidden","true");break;case Zt.ui.ImageType.url:case Zt.ui.ImageType._axResource:i(e.imageName,e.altText),r="",s="Image";break;case Zt.ui.ImageType.base64:i("data:image/png;base64,"+e.imageName,e.altText),r="",s="Image"}}else n.setAttribute("aria-description",Zt.label("Framework_No_Image_Description"));r&&(o.lastImageClass=r,n.classList.add(r)),s&&n.setAttribute("data-dyn-image-type",s)},At);function At(){}e.ImageBindingHandler=Nt,e.img=new Nt;var Dt=(Lt.prototype.invoke=function(e,t){if(t&&"imageType"in t)if("Symbol"!==t.imageType||t.inGrid)$(e).css("line-height","").css("font-size","");else{var o=parseInt(t.height),n=parseInt(t.width),i=!isNaN(o),r=!isNaN(n);if(i||r){var a=0,s=0;i&&r&&(a=.4*Math.min(o,n),s=o),$(e).css("line-height",s+"px").css("font-size",a+"px")}else $(e).css("line-height","").css("font-size","")}},Lt.prototype.shouldInvoke=function(e,t){return!(!e||e&&t&&e.height===t.height&&e.imageType===t.imageType&&e.width===t.width)},Lt);function Lt(){}e.imgFontSize=new Dt;var Ot=(Bt.prototype.setup=function(e){var t={appliedBinding:!1,lastValue:void 0,listObserver:void 0,list:void 0,disposed:!1,collection:void 0,reuseItems:!1,getIdentifier:void 0,getVersion:void 0,foreachObserver:void 0,renderForEachTask:this.task,deferred:void 0,preRender:void 0,postRender:void 0,updating:void 0,template:void 0,setAriaAttributes:!0,iterationCallback:void 0},o=$(e);return t.template=e.dynForeachTemplate,t.template||(t.template=o.children(),t.template.attr(Zt.Const.stopBindingAttribute,"true"),e.dynForeachTemplate=t.template,Zt.util.empty(e)),t.context=Zt.context(e),t},Bt.prototype.applyForeach=function(I,T){T.disposed&&Zt.log.foreach&&Zt.log.foreach.error("Foreach: Apply after dispose error"),$(I);var x=this.itemTask,F=this.createCoreRow,k=this.setAttributes,P=this.removeCoreRow,e=Zt.role(I),t=e.context;if(t&&!(t instanceof Zt.DataContext))throw new TypeError("The argument 'dataContext' must be a an instance of $dyn.DataContext");var R={dataContext:t,role:e,template:T.template},M=Zt.value(T.collection);if(null!=M){if(I.dynForeachBinding&&Zt.log.foreach&&Zt.log.foreach("Foreach: Binding already pending"),T.getIdentifier&&"function"!=typeof T.getIdentifier)throw new TypeError("The argument 'getIdentifier' must be a function");I.dynForeachBinding=!0;var E=document.createDocumentFragment(),N=null,A=[E],D=[N],L=function(){E||(E=document.createDocumentFragment(),A.push(E),D.push(N))},o=function(){if(T.rendering)Zt.logError("Foreach render was invoked while in the middle of render. Verify the constructor of the object generated does not have unexpected side-effects.");else{T.rendering=!0;var e=void 0;if(Zt.log.performance&&(e=performance.now()),T.renderForEachTask&&T.renderForEachTask.start(),T.reuseItems&&M.length&&T.lastValue||(Zt.util.empty(I),T.lastValue=void 0),M){var t=void 0;T.deferred&&(t=!1,Zt.peek(Zt.ui.updating)||(Zt.ui.updating(!0),t=!0),T.deferred=!1);var o=Zt.ui.layout();if(o||Zt.ui.layout(!0),T.template[0]){var n=M.length,i={elements:{},orders:{},versions:{}},r=void 0,a=void 0,s=void 0,l=-1;T.lastValue&&(r=T.lastValue.elements,a=T.lastValue.orders,s=T.lastValue.versions);for(var u=0,d=void 0;u<n;u++){if(x&&x.start(u.toString()),T.reuseItems){var c=T.getIdentifier(M[u]),p=Zt.callFunction(T.getVersion,T,M[u]),h=r&&r[c],m=s&&s[c];if(i.elements[c]){Zt.logError("Foreach: Duplicate itemId: %s, position=%s/%s",c,i.orders[c],u);continue}if(h&&m===p){var v=a[c];l<v?(E=null,N=h,l=v):L(),d=h,r[c]=void 0,a[c]=void 0,s[c]=void 0}else L(),d=F(M[u],u,n,R);i.elements[c]=d,i.orders[c]=u,i.versions[c]=p}else d=F(M[u],u,n,R);d&&k(d,u,n,T.setAriaAttributes),E&&d&&E.appendChild(d),Zt.applyFunction(T.iterationCallback,T.context,[d,u]),x&&x.stop(u.toString())}if(T.reuseItems&&T.lastValue)for(var g=0,y=Object.keys(r),f=y.length;g<f;++g){var b=r[y[g]];b&&P(I,b)}for(g=0,f=A.length;g<f;++g){var C=D[g];C?I.insertBefore(A[g],C.nextSibling):0===g&&null===C&&I.insertBefore(A[g],I.firstChild)}I.childNodes.length!==n&&Zt.logError("Foreach: Unexpected elements in DOM, element count: %s, data count: %s",I.childNodes.length,n),Zt.applyFunction(T.postRender,T.context),T.lastValue=i}t&&Zt.ui.updating(!1),I.classList.contains(Zt.layout.ScopeMarker)?Zt.layout.queueArrange(I):Zt.layout.queueArrange(I.parentNode),o||Zt.ui.layout(!1)}if(T.renderForEachTask&&T.renderForEachTask.stop(),Zt.log.performance){var w=performance.now(),_="<unknown>",S=Zt.context(I);S&&S.Name&&(_=S.Name),Zt.log.performance("Foreach: foreach render time: %s, %s, %s (ms)",_,I.className,w-e)}T.rendering=!1}};Zt.applyFunction(T.preRender,T.context),T.deferred?Zt.async(o,void 0,"Render foreach"):o(),T.appliedBinding=!0,I.dynForeachBinding=!1}},Bt.prototype.invoke=function(o,e,t,n){var i=this;$(o),n.foreachObserver=Zt.observe(e,function(e){var t=Zt.value(e);n.collection=t,n.reuseItems=!1,null!=t&&(t instanceof Array||(n.collection=t.collection,n.reuseItems=t.reuseItems,n.getIdentifier=t.getIdentifier,n.getVersion=t.getVersion,n.deferred=t.deferred,n.preRender=t.preRender,n.postRender=t.postRender,n.updating=t.updating,n.setAriaAttributes=void 0===t.setAriaAttributes||t.setAriaAttributes,n.iterationCallback=t.iterationCallback),n.list=Zt.options(function(){return{collection:n.collection}},n.updating),n.listObserver=Zt.observe(n.list,function(e){o.dynForeachOptions=e,i.applyForeach(o,n)},void 0,n.listObserver))},void 0,n.foreachObserver)},Bt.prototype.dispose=function(e,t){Zt.dispose(t.selectedIndexSubscription),Zt.dispose(t.listObserver),Zt.dispose(t.list),Zt.dispose(t.foreachObserver),t.disposed=!0,t.appliedBinding&&($(e).children().each(function(e,t){Zt.unbind(t)}),t.appliedBinding=!1),e&&e.dynForeachOptions&&(e.dynForeachOptions=null)},Bt.prototype.createCoreRow=function(e,t,o,n){var i=new Zt.DataContext(e,n.dataContext);i.scopeVars.$index=t,i.scopeVars.$length=o;var r=n.template[0];return r=r.cloneNode(!0),n.role.dataBindItem(r,i),r},Bt.prototype.removeCoreRow=function(e,t){return!!e&&(e.removeChild(t),Zt.unbind(t),!0)},Bt.prototype.setAttributes=function(e,t,o,n){if(e.setAttribute("data-dyn-index",t.toString()),n){var i=e.getAttribute("aria-hidden"),r=e.getAttribute("role");r&&"presentation"!==r&&"none"!==r&&!i&&(e.setAttribute("aria-posinset",t+1),e.setAttribute("aria-setsize",o))}},Bt);function Bt(){this.unwrapObservable=!1,this.task=Zt.debug.performance?new Zt.PerformanceTask("foreach"):null,this.itemTask=Zt.debug.verboseForeach?new Zt.PerformanceTask("foreachItem"):null}e.foreach=new Ot,e.inlineForeach=function(e){var c=Zt.bindingHandlers.foreach.task,t=$(e),p=e.dynForeachTemplate,h=Zt.templatedParentElement(e);(h=h||e.parentNode)&&!h.dynChildren&&Zt.makeContainer(h);var m=Zt.role(h),v=Zt._getChildren(h),o=!1;return p||((p=t.children()).attr(Zt.Const.stopBindingAttribute,"true"),e.dynForeachTemplate=p,t.detach(),h.templatedForeach=e),{apply:function(e,d){e&&(Zt.observe(e,function(e){if(e){c&&c.start();var t=$();if(v().length=0,p[0]){for(var o=0,n=e.length;o<n;o++){var i=p[0].cloneNode(!0);t=t.add(i),v.set(o,i)}v.valueChanged.raise();var r=0;for(n=t.length;r<n;r++){var a=t[r],s=e[r],l=new Zt.DataContext(s,d),u=l.scopeVars;u.$index=r,u.$length=n,m.dataBindItem(a,l)}Zt.context(h)&&Zt.context(h).Children.valueChanged.raise()}c&&c.stop()}}),o=!0)},setup:function(){o&&(t.children().each(function(e,t){Zt.unbind(t)}),e.dynForeachTemplate&&(e.dynForeachTemplate=null),h&&h.templatedForeach&&(h.templatedForeach=null),o=!1)}}};var $t=(Vt.prototype.setup=function(e,t){return{appliedBinding:!1,shouldForceInvoke:void 0===t}},Vt.prototype.invoke=function(e,t,o,n){var i=n.template;if(i||(i=$(e).children(),n.template=i),i.detach(),t&&"false"!==t){var r=Zt.role(e),a=r.context;i.attr(Zt.Const.stopBindingAttribute,"true"),i.each(function(e,t){r.getChildRole(t)._getIsDataBound()||r.dataBindChild(t,a)}),$(e).append(i),n.appliedBinding=!0}},Vt.prototype.dispose=function(e,t){if(t.appliedBinding){var o=t.template;o&&o.each(function(e,t){Zt.unbind(t)}),t.appliedBinding=!1}},Vt.prototype.shouldInvoke=function(e,t,o){return o.shouldForceInvoke?!(o.shouldForceInvoke=!1):e!==t},Vt);function Vt(){}e.conditional=new $t,Zt.bindingHandlers.if=e.conditional,e.inlineIf=function(i){Zt.logDeprecated("$dyn.bindingHandlers.inlineIf");var e=Zt.templatedParentElement(i);!e&&i.parentNode&&(e=i.parentNode,Zt.makeContainer(e));var r=Zt.role(e),a=Zt._getChildren(e),s=!1,l=!1,u=i.dynIfContents;return u||(u=$(i).children(),(i.dynIfContents=u).attr(Zt.Const.stopBindingAttribute,"true")),$(i).hide(),{apply:function(e,o){var t=Zt.value(a).indexOf(i);if(!(0<=t))throw new Error("Inline-if: Target element is not in the child array of its parent. TargetElement: "+i);if(!0===e){if(!s){var n=$.merge([t+1,0],u);a.splice.apply(a,n),s=!0,a.valueChanged.raise(),l||(u.each(function(e,t){Zt.role(t).isDataBound()||r.dataBindChild(t,o)}),l=!0)}}else s?(u.each(function(e,t){var o=Zt.value(a).indexOf(t);0<=o&&a.splice(o,1)}),a.valueChanged.raise(),s=!1):u.detach()},setup:function(){l&&(u.each(function(e,t){Zt.unbind(t)}),l=!1)}}};var Ht=(Gt.prototype.setup=function(){return{lastValue:void 0}},Gt.prototype.invoke=function(e,t,o,n){t&&(void 0!==n.lastValue&&e.classList.remove(n.lastValue),t===Zt.ui.DialogSize.small?(n.lastValue="dialogSize-small",e.classList.add("dialogSize-small")):t===Zt.ui.DialogSize.medium?(n.lastValue="dialogSize-medium",e.classList.add("dialogSize-medium")):t===Zt.ui.DialogSize.large?(n.lastValue="dialogSize-large",e.classList.add("dialogSize-large")):t===Zt.ui.DialogSize.full&&(n.lastValue="dialogSize-full",e.classList.add("dialogSize-full")))},Gt.prototype.shouldInvoke=function(e,t){return e&&e!==t},Gt);function Gt(){}e.DialogSizeBindingHandler=Ht,e.dialogSize=new Ht;var zt=(Ut.prototype.shouldInvoke=function(e,t){return e&&t?e.useBackColor!==t.useBackColor||e.useTextColor!==t.useTextColor||e.fontWeight!==t.fontWeight||e.textDecoration!==t.textDecoration||e.backcolor!==t.backcolor||e.textcolor!==t.textcolor||e.useColorOnSelectedRow!==t.useColorOnSelectedRow:!t&&!!e},Ut.prototype.invoke=function(e,t){var o=!1;if(t&&0!==Object.keys(t).length){var n=Zt.context(e),i=t.useColorOnSelectedRow&&"true"===t.useColorOnSelectedRow;if(t.backcolor&&(e.style.backgroundColor="transparent"),t.textcolor&&(e.style.color="inherit"),!n||!n.isInSelectedGridRow()||n.isInSelectedGridRow()&&i){if(t.useBackColor&&"true"===t.useBackColor&&t.backcolor||i){var r="rgb("+(a=(16711680&t.backcolor)>>16)+","+(s=(65280&t.backcolor)>>8)+","+(l=255&t.backcolor)+")";e.style.backgroundColor=r,o=!0}else e.style.backgroundColor="inherit";if(t.useTextColor&&"true"===t.useTextColor&&t.textcolor||i){var a=(16711680&t.textcolor)>>16,s=(65280&t.textcolor)>>8,l=255&t.textcolor;e.style.color="rgb("+a+", "+s+", "+l+")",o=!0}else e.style.color="inherit"}t.fontWeight&&"true"===t.fontWeight?(e.style.fontWeight="bold",o=!0):e.style.fontWeight="",t.fontStyle&&"true"===t.fontStyle?(e.style.fontStyle="italic",o=!0):e.style.fontStyle="",t.textDecoration?(e.style.textDecoration=t.textDecoration,o=!0):e.style.textDecoration=""}o&&!e.classList.contains("field-displayOption")?e.classList.add("field-displayOption"):!o&&e.classList.contains("field-displayOption")&&e.classList.remove("field-displayOption")},Ut);function Ut(){}e.DisplayOptionsBindingHandler=zt,e.displayOptions=new zt;var Wt=(Kt.prototype.invoke=function(e,t){var o,n;""===t||void 0===t?($(e).css(this.cssAttributeName)&&$(e).css(this.cssAttributeName,""),"background-color"===this.cssAttributeName&&null!==(o=null==e?void 0:e.classList)&&void 0!==o&&o.remove("color-field")):($(e).css(this.cssAttributeName,this.getRGBValues(t)),"background-color"===this.cssAttributeName&&null!==(n=null==e?void 0:e.classList)&&void 0!==n&&n.add("color-field"))},Kt.prototype.getRGBValues=function(e){var t=e.split(" ",3);return"rgb("+t[0]+","+t[1]+","+t[2]+")"},Kt);function Kt(e){this.cssAttributeName=e}e.ColorBindingHandler=Wt,e.backgroundColor=new Wt("background-color"),e.foregroundColor=new Wt("color");var qt=(jt.prototype.shouldInvoke=function(){return!0},jt.prototype.invoke=function(e,t,o,n){n.enabled=t.enabled,n.showFlyout=t.showFlyout},jt.prototype.setup=function(o,e){var n,i,r={enabled:!0};return $.isPlainObject(e)&&(r.showFlyout=e.showFlyout,void 0!==e.enabled&&(r.enabled=e.enabled),r.focusOutCallbackFunc=e.focusOutCallBack,r.focusInCallbackFunc=e.focusInCallBack),r.onFocusIn=function(e){if(i=!0,n&&window.clearTimeout(n),n=window.setTimeout(function(){i=!1},300),!1===Zt.value(r.enabled))return Zt.log.focus&&Zt.log.focus("Boundary Focus: gaining focus not enabled %s calling callback",o.id),void r.focusInCallbackFunc.apply(Zt.context(o),[e]);var t=document.activeElement;e&&e.target&&(t=e.target),e&&0<$(t).closest(o).length&&($(t).hasClass("boundary-focus-skip")?($(o).trigger("focusout"),o.setAttribute("data-dyn-boundary-focused","false")):o.setAttribute("data-dyn-boundary-focused","true")),("true"===o.getAttribute("data-dyn-boundary-focused")||Zt.value(r.showFlyout))&&r.focusInCallbackFunc&&(Zt.log.focus&&Zt.log.focus("Boundary Focus: gaining focus from %s to %s and browser's active element is %s",o.id,t&&t.id,document.activeElement?document.activeElement.id:""),r.focusInCallbackFunc.apply(Zt.context(o),[e]))},r.onFocusOut=function(e){Zt.log.focus&&Zt.log.focus("Boundary Focus: onFocusOut callback called from %s",o.id);var t=document.activeElement;if(e&&e.relatedTarget&&(t=e.relatedTarget),!t||t!==Zt.shell.blockingDiv){if(t===document.body||null===t||t===document.getElementsByTagName("html")[0]){if(i&&Zt.shell.bodyFocusCorrection)return Zt.log.focus&&Zt.log.focus("Boundary Focus: losing focus to body, resetting focus to control %s",o?o.getAttribute("data-dyn-controlname"):""),void Zt.util.focusElement(o);Zt.shell.bodyFocusCorrection?Zt.log.focus&&Zt.log.focus("Boundary Focus: losing focus to body, but not resetting because it was outside of the correction time"):Zt.log.focus&&Zt.log.focus("Boundary Focus: losing focus to body, but not resetting because the body focus was on purpose")}if(!1===Zt.value(r.enabled))return Zt.log.focus&&Zt.log.focus("Boundary Focus: losing focus not enabled %s calling callback",o.id),void r.focusOutCallbackFunc.apply(Zt.context(o),[e]);e&&(!$(t).hasClass("boundary-focus-skip")&&0<$(t).closest(o).length?o.setAttribute("data-dyn-boundary-focused","true"):o.setAttribute("data-dyn-boundary-focused","false")),"false"!==o.getAttribute("data-dyn-boundary-focused")||void 0!==r.showFlyout&&Zt.value(r.showFlyout)||!r.focusOutCallbackFunc||(Zt.log.focus&&Zt.log.focus("Boundary Focus: losing focus from %s to %s and browser's active element is %s",o.id,t?t.id:"",document.activeElement?document.activeElement.id:""),r.focusOutCallbackFunc.apply(Zt.context(o),[e]))}},Zt.isObservable(r.showFlyout)&&r.showFlyout.valueChanged.subscribe(function(e){Zt.value(r.showFlyout)?r.onFocusIn():r.onFocusOut()}),$(o).on("focusin",r.onFocusIn),$(o).on("focusout",r.onFocusOut),r},jt.prototype.dispose=function(e,t){t&&($(e).off("focusin",t.onFocusIn),$(e).off("focusout",t.onFocusOut))},jt);function jt(){}e.boundaryFocus=new qt,e.boundaryFocusOut={setup:function(n,e){var i,r;Zt.logDeprecated("$dyn.bindingHandlers.boundaryFocusOut");var a=!0;$.isPlainObject(e)?(r=e.showFlyout,void 0!==e.enabled&&(a=e.enabled),i=e.focusOutCallBack):"function"==typeof e&&(i=e.focusOutCallBack);function t(e){if(!Zt.value(a))return Zt.log.focus&&Zt.log.focus("Boundary Focus: losing focus not enabled %s calling callback",n.id),void i(e);var t=document.activeElement;e&&e.relatedTarget&&(t=e.relatedTarget);var o=!1;t&&t===Zt.shell.blockingDiv||(!$(t).hasClass("boundary-focus-skip")&&0<$(t).closest(n).length&&(o=!0),o||void 0!==r&&Zt.value(r)||!i||(Zt.log.focus&&Zt.log.focus("Boundary Focus: losing focus from %s to %s and browser's active element is %s",n.id,t.id,document.activeElement?document.activeElement.id:""),i(e)))}return Zt.isObservable(r)&&Zt.observe(r,function(e){e||t()}),$(n).on("focusout",t),{onFocusOut:t}},dispose:function(e,t){t&&$(e).off("focusout",t.onFocusOut)}},e.boundaryFocusIn={setup:function(n,e){var i;Zt.logDeprecated("$dyn.bindingHandlers.boundaryFocusIn");var r=!0;function t(e){if(!Zt.value(r))return Zt.log.focus&&Zt.log.focus("Boundary Focus: gaining focus not enabled %s calling callback",n.id),void i(e);var t=e&&e.target||document.activeElement,o=!1;t&&t===Zt.shell.blockingDiv||(0<$(t).closest(n).length&&($(t).hasClass("boundary-focus-skip")?$(n).trigger("focusout"):o=!0),o&&i&&(Zt.log.focus&&Zt.log.focus("Boundary Focus: gaining focus from %s to %s and browser's active element is %s",n.id,t.id,document.activeElement?document.activeElement.id:""),i(e)))}return $.isPlainObject(e)?(void 0!==e.enabled&&(r=e.enabled),i=e.focusInCallBack):"function"==typeof e&&(i=e.focusInCallBack),$(n).on("focusin",t),{onFocusIn:t}},dispose:function(e,t){t&&$(e).off("focusin",t.onFocusIn)}};var Qt=(Yt.prototype.setup=function(n,i){function e(e){var t,o;e.shiftKey||e.ctrlKey||e.metaKey||e.defaultPrevented||(t=i.height?i.height():n.offsetHeight,o=i.width?i.width():n.offsetWidth,n.scrollHeight>t?(n.scrollTop-=e.wheelDelta,e.preventDefault()):n.scrollWidth>o&&(n.scrollLeft-=e.wheelDelta,e.preventDefault()))}return n.addEventListener("mousewheel",e),e},Yt.prototype.dispose=function(e,t){e.removeEventListener("mousewheel",t)},Yt);function Yt(){}e.horizontalScrollWithWheel=new Qt}(Zt.bindingHandlers||(Zt.bindingHandlers={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(_){var e,t,o,n,i,r,a,s,l,u,d;function c(e,t,o,n,i){return{height:e.LayoutHeight,heightOverride:n,minFlexHeight:o,minFlexWidth:t,width:e.LayoutWidth,widthOverride:i}}function p(){}e=_.layout||(_.layout={}),(t=e.ArrangeMethod||(e.ArrangeMethod={})).horizontalWrap="HorizontalWrap",t.horizontalLeft="Horizontal, flush left",t.horizontalRight="Horizontal, flush right",t.vertical="Vertical",t.none="None",(o=e.Alignment||(e.Alignment={})).top="Top",o.bottom="Bottom",(n=e.Providers||(e.Providers={})).css3flexbox="CSS3Flex",n.css3grid="CSS3Grid",(i=e.qTipPosition||(e.qTipPosition={})).topLeft="top left",i.topCenter="top center",i.topRight="top right",i.bottomLeft="bottom left",i.bottomCenter="bottom center",i.bottomRight="bottom right",i.leftTop="left top",i.leftCenter="left center",i.leftBottom="left bottom",i.rightTop="right top",i.rightCenter="right center",i.rightBottom="right bottom",e._defaultLimitHeight=3,e.supportsFlexOrGrid=function(){var e=$(window.document.createElement("div"));$("body").append(e);var t,o=!1;return $("body").append(e),o=(o=(o=o||"-webkit-flex"===e.css("display","-webkit-flex").css("display"))||"-webkit-box"===e.css("display","-webkit-box").css("display"))||"flex"===e.css("display","flex").css("display"),o=(t="-ms-grid"===e.css("display","-ms-grid").css("display"))?window.CSS&&window.CSS.supports&&window.CSS.supports("display","flex"):o,e.remove(),_.debug.layoutFlex||o?($("body").addClass(_.layout.Providers.css3flexbox),_.layout.provider=new _.layout.css3flexbox(_.layout.provider)):t&&($("body").addClass(_.layout.Providers.css3grid),_.layout.provider=new _.layout.css3grid(_.layout.provider)),o||t},(r=e.Size||(e.Size={})).available="SizeToAvailable",r.content="SizeToContent",r.fixed="fixed",r.xsmall="xsmall",r.small="small",r.medium="medium",r.large="large",(a=e.Columns||(e.Columns={})).fill="Fill",a.balanced="Balanced",a.limitHeight="LimitHeight",e.ScopeMarker="layout-reflow-scope",e.RootScopeMarker="layout-root-scope",e.layoutContainer=function(e){var t;if(e){var o=e.dynLayoutContainer;t=o||e}return t},e.breakableGroupsOptions=function(e){return{enabled:e.Enabled,extendedStyle:e.Style,visible:e.Visible}},e.containerBinding=function(e){return _.options(function(){return{alignment:e.LayoutAlignment,arrangeMethod:e.LayoutArrangeMethod,children:e.Children,columns:e.LayoutColumns}},e.Updating)},e.layoutCompleteEvent="layoutComplete",function(e){e.layoutCompleted=function(){var t=null;return{apply:function(e){t=e,$(document.body).on(_.layout.layoutCompleteEvent,t)},dispose:function(){t&&$(document.body).off(_.layout.layoutCompleteEvent,t)}}};var t=(o.prototype.invoke=function(e,t){e.dynIsBreakable=t},o.prototype.dispose=function(e){e.dynIsBreakable=void 0},o);function o(){}e.breakable=new t;var n=(i.prototype.invoke=function(e,t){e.dynIsBreakable&&_.layout.copyBreakableGroupProperties(t,e)},i);function i(){}e.breakableGroups=new n}(_.bindingHandlers||(_.bindingHandlers={})),(s=_.layout||(_.layout={})).copyBreakableGroupProperties=function(n,e){var t=e.dynBreakableGroups;t&&0<t.length&&$.each(t,function(e,o){n&&$.each(n,function(e,t){"visible"===e?_.util.setVisibility(o,_.value(n.visible)):_._invokeHandler(e,o,t)})})},s.sizing=c,(c=s.sizing||(s.sizing={})).isDiscreteSize=function(e){return e!==_.layout.Size.available&&e!==_.layout.Size.content&&e!==_.ui.autoValue&&"undefined"!==e&&!!e},function(e){var t=(o.prototype.setup=function(t,e){var o=this,n=!0,i={};return i.widthObserver=_.observe(e.width,function(e){n||(o.widthChanged(t,e),_.layout.queueArrange(t.parentNode))},this),i.heightObserver=_.observe(e.height,function(e){n||(o.heightChanged(t,e),_.layout.queueArrange(t.parentNode))},this),n=!1,t.dynMinFlexWidth=e.minFlexWidth,t.dynWidthOverride=e.widthOverride,t.dynMinFlexHeight=e.minFlexHeight,t.dynHeightOverride=e.heightOverride,t.dynLayoutIgnoreSiblings=e.ignoreSiblings,i},o.prototype.shouldInvoke=function(e,t){return e===t&&_.logError("sizing handler does not support passing the same complex object, or no object at all."),e.width=_.peek(e.width),e.height=_.peek(e.height),e.minFlexHeight=_.peek(e.minFlexHeight),e.minFlexWidth=_.peek(e.minFlexWidth),!t||e.width!==t.width||e.height!==t.height||e.minFlexHeight!==t.minFlexHeight||e.minFlexWidth!==t.minFlexWidth},o.prototype.invoke=function(e,t,o){this.widthChanged(e,t.width,t.minFlexWidth),this.heightChanged(e,t.height,t.minFlexHeight),_.layout.queueArrange(e.parentNode)},o.prototype.dispose=function(e,t){e.dynLayoutIgnoreSiblings=void 0,e.dynPreferredWidth=void 0,e.dynMinFlexWidth=void 0,e.dynWidthOverride=void 0,e.dynPreferredHeight=void 0,e.dynMinFlexHeight=void 0,e.dynHeightOverride=void 0,t.widthObserver&&(t.widthObserver.dispose(),this.removeSize(e,"width")),t.heightObserver&&(t.heightObserver.dispose(),this.removeSize(e,"height"))},o.prototype.widthChanged=function(e,t,o){e.dynPreferredWidth=t,this.applySize(e,t,"width"),void 0!==(e.dynMinFlexWidth=o)&&e.dynIsStaticallySized&&(e.dynMinFlexWidth=void 0)},o.prototype.heightChanged=function(e,t,o){e.dynPreferredHeight=t,this.applySize(e,t,"height"),void 0!==(e.dynMinFlexHeight=o)&&e.dynIsStaticallySized&&(e.dynMinFlexHeight=void 0)},o.prototype.applySize=function(e,t,o){e.dynIsStaticallySized=!1,e.removeAttribute(o),"width"===o?(e.style.width="",e.style.minWidth=""):e.style.height="";var n=$(e),i=parseInt(t);if(this.resetDiscreteSizeClasses(e,o),isNaN(i))_.layout.sizing.isDiscreteSize(t)?(e.classList.add("hasdiscretesize-"+o),e.classList.add("discretesize-"+o+"-"+t),"width"===o?_.layout.provider.setFixedWidth(e):_.layout.provider.setFixedHeight(e),"width"===o?_.layout.provider.removeFillWidth(e):_.layout.provider.removeFillHeight(e)):e.classList.contains("fixed-"+o)&&("width"===o?_.layout.provider.removeFixedWidth(e):_.layout.provider.removeFixedHeight(e));else{var r=i+"px";e.dynIsStaticallySized=!0,"width"===o?(_.layout.provider.setFixedWidth(e),_.layout.provider.removeFillWidth(e),n[0].style.width=r,n[0].style.minWidth=r):(_.layout.provider.setFixedHeight(e),_.layout.provider.removeFillHeight(e),n[0].style.height=r)}},o.prototype.removeSize=function(e,t){e.removeAttribute(t),"width"===t?(e.style.width="",e.style.minWidth=""):e.style.height="",this.resetDiscreteSizeClasses(e,t),e.classList.contains("fixed-"+t)&&("width"===t?_.layout.provider.removeFixedWidth(e):_.layout.provider.removeFixedHeight(e))},o.prototype.resetDiscreteSizeClasses=function(e,t){e.classList.remove("hasdiscretesize-"+t),e.classList.remove("discretesize-"+t+"-large"),e.classList.remove("discretesize-"+t+"-medium"),e.classList.remove("discretesize-"+t+"-small"),e.classList.remove("discretesize-"+t+"-xsmall"),e.classList.remove("discretesize-"+t+"-fixed")},o);function o(){}e.sizing=new t;var n=(i.prototype.shouldInvoke=function(e,t){return!t||e.height!==t.height||e.width!==t.width},i.prototype.invoke=function(e,t){t.height?(e.dynIncreasingHeight=!0,t.heightChanged&&$(e).on("dynamicHeightChanged",function(){return t.heightChanged&&t.heightChanged(),!1})):(e.dynIncreasingHeight=!1,$(e).off("dynamicHeightChanged")),t.width?(e.dynIncreasingWidth=!0,t.widthChanged&&$(e).on("dynamicWidthChanged",function(){return t.widthChanged&&t.widthChanged(),!1})):(e.dynIncreasingWidth=!1,$(e).off("dynamicWidthChanged"))},i.prototype.dispose=function(e){e.dynIncreasingHeight=void 0,e.dynIncreasingWidth=void 0,$(e).off("dynamicHeightChanged"),$(e).off("dynamicWidthChanged")},i);function i(){}e.dynamicSizing=new n}(_.bindingHandlers||(_.bindingHandlers={})),(l=_.layout||(_.layout={})).gridLayoutMinWidth=function(e,t){return _.layout._retrieveGridLayoutMin(e,t,"width",["left","right"])},l.gridLayoutMinHeight=function(e,t){return _.layout._retrieveGridLayoutMin(e,t,"height",["top","bottom"])},l._retrieveGridLayoutMin=function(e,t,o,n){_.layout.gridLayoutMinSizes||(_.layout.gridLayoutMinSizes={});var i=_.densityThemeManager._getCurrentDensity().toString(),r=_.layout.gridLayoutMinSizes[i],a=(r=r||(_.layout.gridLayoutMinSizes[i]={}))[e];if(!(a=a||(r[e]={}))[o]){var s=$(document.createElement("div")),l=$(document.createElement("div"));l.addClass(e),l.addClass("layout-container"),l.addClass("fill-"+o),l.hide(),s.append(l),s.addClass("layout-container"),$(t).append(s);var u=$(s.children(_.format(".{0}",e))[0]);_.layout.gridLayoutMinSizes[i][e][o]=parseInt(u.css(_.format("min-{0}",o)));var d=u.css(_.format("margin-{0}",n[0])),c=u.css(_.format("margin-{0}",n[1]));_.layout.gridLayoutMinSizes[i][e][n[0]]=parseInt(d)+parseInt(c),s.detach()}return _.format("{0}px",_.layout.gridLayoutMinSizes[i][e][o]+_.layout.gridLayoutMinSizes[i][e][n[0]])},u=_.bindingHandlers||(_.bindingHandlers={}),p.prototype.shouldInvoke=function(e,t){return!t||e.arrangeMethod!==t.arrangeMethod||e.columns!==t.columns||!this.compareChildren(e.children,t.children)},p.prototype.invoke=function(e,t){var o=_.value(t.arrangeMethod)||_.ui.autoValue;if(o!=_.layout.ArrangeMethod.none){var n=_.value(t.columns)||1;o===_.ui.autoValue&&(o=_.layout.ArrangeMethod.vertical);var i=_.value(t.alignment)||_.layout.Alignment.bottom;e.dynColumns=n,e.dynAlignment=i}e.dynArrangeMethod=o,_.layout.queueArrange(e)},p.prototype.dispose=function(e){e.dynArrangeMethod=void 0,e.dynColumns=void 0,e.dynAlignment=void 0},p.prototype.compareChildren=function(e,t){if(e===t)return!0;if(!e||!t)return!1;if(e.length!==t.length)return!1;for(var o=0;o<e.length;o++)if(e[o]!==t[o])return!1;return!0},d=p,u.layout=new d,function(n){n.topArrangeElements={scopes:[],elements:[]},n.inArrangeOrReflow=!1,n.reflowElements=$([]),n.endReflowHandlers={},n.startReflowHandlers={},n._reflowScopeId=1,n._reflowScopeHandlerId=1,n.registerEndReflowHandler=function(e,t){return _.layout._registerReflowHandler(e,t,_.layout.endReflowHandlers)},n.registerStartReflowHandler=function(e,t){return _.layout._registerReflowHandler(e,t,_.layout.startReflowHandlers)},n._registerReflowHandler=function(e,t,n){var o=$(e).closest(_.format(".{0},.{1}",_.layout.ScopeMarker,_.layout.RootScopeMarker)),i=o.parents(_.format(".{0},.{1}",_.layout.ScopeMarker,_.layout.RootScopeMarker));if(o&&i){i=i.add(o);for(var r=_.layout._reflowScopeHandlerId++,a=0;a<i.length;++a){var s=i[a];void 0===s.dynReflowScopeId&&(s.dynReflowScopeId=_.layout._reflowScopeId,_.layout._reflowScopeId++),n[s.dynReflowScopeId]||(n[s.dynReflowScopeId]={}),n[s.dynReflowScopeId][r]=t}return{dispose:function(){for(var e=0;e<i.length;++e){var t=i[e];if(void 0!==t.dynReflowScopeId){var o=n[t.dynReflowScopeId];o&&(delete o[r],0===Object.keys(o).length&&delete n[t.dynReflowScopeId])}}}}}},n._notifyReflowHandlers=function(e,t){for(var o=$(e),n=0;n<o.length;++n){var i=o[n],r=i.dynReflowScopeId;if(void 0!==r){var a=t[r];if(a)for(var s=Object.keys(a),l=0;l<s.length;++l)a[s[l]]&&a[s[l]](i)}}},n.getFirstReflowElement=function(e){var t=$(e),o=_.format(".{0},.{1}",_.layout.ScopeMarker,_.layout.RootScopeMarker);return t.find(o).addBack(o).first()[0]},n.subscribeArrangeToLayout=function(){var e;return _.observe(_.ui.layout,function(){_.value(_.ui.layout)||e||(e=!0,_.layout.arrangeTopLevelElement(),e=!1)})},n.reflowRootForm=function(){var e=_.shell.getCurrentRootForm(),t=_.context(e);if(e&&t){_.layout.reflow(e,!0);for(var o=_.value(t.dialogStack),n=0;n<_.length(o);n++){var i=_.context(_.value(o)[n]);i&&i.element&&_.layout.reflow(i.element,!0)}}e=_.shell.getActiveAsideForm(),t=_.context(e),_.value(_.shell.isAsidePaneOpen)&&e&&t&&_.layout.reflow(e,!0)},n._arrangeTopLevelElement=_.debug.performance?new _.DomPerformanceTask("arrangeTopLevelElement"):null,n.arrangeTopLevelElement=function(){if(_.layout.topArrangeElements.elements.length){for(var e=_.shell.bodyFocusCorrection,t=0;t<_.layout.topArrangeElements.elements.length;t++){var o=$(_.layout.topArrangeElements.elements[t]);_.layout._arrangeTopLevelElement&&_.layout._arrangeTopLevelElement.start(o[0]),_.layout.arrange(_.layout.topArrangeElements.elements[t],!1,!0),_.layout._arrangeTopLevelElement&&_.layout._arrangeTopLevelElement.stop(o[0])}_.layout.topArrangeElements.scopes=[],_.layout.topArrangeElements.elements=[],_.layout._originalActiveElement&&(_.ui.restoreFocus(_.layout._originalActiveElement),_.layout._originalActiveElement=void 0,_.shell.bodyFocusCorrection=e)}_.layout.reflowElements.length&&(_.layout.reflow(_.layout.reflowElements),_.layout.reflowElements=$([]),$(document.body).trigger(_.layout.layoutCompleteEvent))},n.queueReflow=function(e){var t=_.format(".{0}:not(.fixed-increasing-height),.{1}",_.layout.ScopeMarker,_.layout.RootScopeMarker),o=$(e).closest(t);o.length||(t=_.format(".{0},.{1}",_.layout.ScopeMarker,_.layout.RootScopeMarker),o=$(e).closest(t)),_.layout.reflowElements.length&&(_.layout.reflowElements.filter(o).length||_.layout.reflowElements.find(o).length)||(_.layout.reflowElements=_.layout.reflowElements.add(o))},n.queueArrange=function(e){if(!_.layout.inArrangeOrReflow&&e&&e.dynHasArranged){if(e.classList){var t=$(e).parent();t[0]&&t[0].dynIsBreakable&&(e=e.parentNode.parentNode),e&&e.classList&&e.classList.contains("layout-breakable-group")&&(e=e.parentNode),e&&e.classList&&e.classList.contains("layout-column")&&(e=e.parentNode)}if(e)if(_.value(_.ui.layout)){var o=$(e).closest(_.format(".{0},.{1}",_.layout.ScopeMarker,_.layout.RootScopeMarker));if(o.length){var n=_.layout.topArrangeElements.scopes.indexOf(o[0]);if(n<0)_.layout.topArrangeElements.scopes.push(o[0]),_.layout.topArrangeElements.elements.push(e),_.layout.queueReflow(o);else{var i=_.layout.topArrangeElements.elements[n];if(e!=i){var r=!1,a=$(i).parents().addBack();$(a[0]).is("html")||(r=!0);var s=!1,l=$(e).parents().addBack();if($(l[0]).is("html")||(s=!0),r&&s)_.layout.topArrangeElements.scopes.splice(n,1),_.layout.topArrangeElements.elements.splice(n,1);else if(r)_.layout.topArrangeElements.elements[n]=e;else if(!s){var u=a.filter(l);0<u.length&&(_.layout.topArrangeElements.elements[n]=u.last()[0])}}}}}else _.layout.arrange(e)}},n.arrange=function(e,t,o){if(_.layout.inArrangeOrReflow=!0,_.layout.layoutContainer(e)){e.dynHasArranged=!0;var n=e.dynArrangeMethod,i=e.dynColumns,r=e.dynAlignment;if(void 0!==n&&n!==_.layout.ArrangeMethod.none){!o||t||_.layout._originalActiveElement||(_.layout._originalActiveElement=_.ui.removeFocus($(e)),o=!1,_.layout._originalActiveElement&&(_.shell.bodyFocusCorrection=!1)),void 0===i&&(i=1),i!=_.layout.Columns.balanced&&i!=_.layout.Columns.fill&&_.layout.removeArrange(e);var a=_.layout.getChildrenAsFlexUnits(e),s=a.flexUnits,l=a.visibleFlexUnits,u=_.layout.provider.isFillWidth(e)||_.layout.provider.isFixedWidth(e),d=_.layout.provider.isFillHeight(e)||_.layout.provider.isFixedHeight(e);if(n==_.layout.ArrangeMethod.horizontalLeft)_.layout.provider.setHorizontalLeftContainer(e),r===_.layout.Alignment.bottom&&_.layout.provider.setHorizontalBottomAlign(e),_.layout.applyFlexSizes(e,s,u,d,"horizontal");else if(n==_.layout.ArrangeMethod.horizontalRight)_.layout.provider.setHorizontalRightContainer(e),r===_.layout.Alignment.bottom&&_.layout.provider.setHorizontalBottomAlign(e),_.layout.applyFlexSizes(e,s,u,d,"horizontal");else if(i==_.layout.Columns.fill||i==_.layout.Columns.balanced){var c=0<$(e).children(".balanced-column").length,p=0<$(e).children(".fill-column").length;if(!c&&!p)_.layout.provider.setHorizontalLeftContainer(e),(m=_.layout.columnize(e,1,l,n,i))&&_.layout.applyFlexSizes(e,m,!1,!0,"horizontal")}else{if(i==_.layout.Columns.limitHeight){var h=_.layout._defaultLimitHeight;i=Math.max(1,Math.ceil(l/h))}if(1==i&&n!==_.layout.ArrangeMethod.horizontalWrap)_.layout.provider.setVerticalContainer(e),_.layout.applyFlexSizes(e,s,u,d,"vertical");else if(_.layout.provider.setHorizontalLeftContainer(e),n===_.layout.ArrangeMethod.horizontalWrap||i!=l){var m=_.layout.columnize(e,i,l,n,"");_.layout.applyFlexSizes(e,m,u,d,"horizontal")}else _.layout.applyFlexSizes(e,s,u,d,"horizontal"),_.layout.provider.setHorizontalTopAlign(e)}_.layout.provider.apply(e)}}$(e).children().each(function(e,t){"false"==t.getAttribute("data-dyn-lastvisible")||t.classList&&t.classList.contains("layout-ignoreArrange")||_.layout.arrange(t,!1,o)}),t&&_.layout.queueReflow(e),_.layout.inArrangeOrReflow=!1},n.breakGroups=function(e){for(var g=function(e,t){var o=document.createElement("div");return $(o).addClass("layout-breakable-group"),$(o)[0].id="".concat(e.id,"-").concat(t),o.dynHasArranged=!0,_.dataBind(o),o},t=function(e,t,o){var n=_.layout.layoutContainer(e),i=e,r=[],a=_.layout.getChildrenAsFlexUnits(n),s=1;if(a.visibleFlexUnits>o+t){for(var l=void 0,u=0,d=0;u<a.visibleFlexUnits-o;){var c=a.flexUnits[d];c.visible&&(t<u&&(n.removeChild(c.element),l&&r.push(l),(l=g(e,s++)).appendChild(c.element),$(l).insertAfter(i),i=l),u++),!c.visible&&l&&l.appendChild(c.element),d++}l&&r.push(l);var p=g(e,s++);for(_.layout.provider.setVerticalContainer(p);d<a.flexUnits.length;){var h=a.flexUnits[d];p.appendChild(h.element),d++}$(p).insertAfter(i),r.push(p)}for(var m=[],v=1;v<s;v++)m.push("".concat(e.id,"-").concat(v));return m.length&&e.setAttribute("aria-owns",m.join(" ")),r},o=_.layout.getChildrenAsFlexUnits(e).flexUnits,n=0;n<o.length;n++){var i=o[n];if(i.element&&i.element.dynIsBreakable&&!i.element.dynBreakableGroups&&i.visible){var r=_.debug.leadinggroup?_.debug.leadinggroup:0,a=_.debug.tailgroup?_.debug.tailgroup:_.context(i.element).hasNoCaptionCSS?1:2,s=t(i.element,r,a);if(0<s.length){var l=s[s.length-1];$(l).addClass("layout-breakable-tail-group"),$(i.element).addClass("layout-breakable-group"),i.element.dynBreakableGroups=s,0;var u=_.context(i.element);if(u){var d=_.layout.breakableGroupsOptions(u);_.layout.copyBreakableGroupProperties(d,i.element)}}else $(i.element).addClass("layout-breakable-tail-group")}}},n.getChildrenAsFlexUnits=function(e){for(var t=[],o=0,n=$(e).children(),i=0;i<n.length;i++){var r=n[i];if(!r.classList.contains("layout-ignore")){var a=_.layout.createFlexUnit(r);a&&(a.visible&&o++,t.push(a))}}return{flexUnits:t,visibleFlexUnits:o}},n.createFlexUnit=function(e){var t=new _.layout.FlexUnit;t.element=e,t.preferFlexWidth=e.dynPreferredWidth===_.layout.Size.available,t.preferFlexHeight=e.dynPreferredHeight===_.layout.Size.available,t.ignoreSiblingSizes=e.dynLayoutIgnoreSiblings,t.children=[],t.control=_.context(e);var o=$(e).attr("data-dyn-lastvisible");return"none"==e.style.display?t.visible=!1:t.control?t.visible=_.value(t.control.Visible):t.visible=o?"true"==o:$(e).is(":visible"),t},n.removeArrange=function(e,t){var o=$(e);if(!o.hasClass("layout-column")){var n=o.children(".layout-column");n.detach(),o.prepend(n.children()),t&&(!1===e.dynNeedsReflow&&(e.dynNeedsReflow=!0),e.parentNode&&e.parentNode.dynBreakableGroups&&0<e.parentNode.dynBreakableGroups.length&&(e=e.parentNode.parentNode)),e&&(_.layout.removeBreakableGroups(e),1==e.dynIsBroken&&(e.dynIsBroken=!1))}},n.getBreakableGroups=function(e){return e&&e.dynBreakableGroups?e.dynBreakableGroups:[]},n.getTailBreakableGroup=function(e){var t=_.layout.getBreakableGroups(e);return 0<t.length?t[t.length-1]:null},n.removeBreakableGroups=function(e){$(e).children().each(function(e,t){if(t.dynIsBreakable){if($(t).removeClass("layout-breakable-group"),t.dynBreakableGroups&&0<t.dynBreakableGroups.length){var o=_.layout.layoutContainer(t);$(o).append($(t.dynBreakableGroups).children()),$(t.dynBreakableGroups).remove(),t.dynBreakableGroups=void 0}t.classList&&1==t.classList.length&&t.classList.contains("layout-breakable-group")&&$(t).is(":empty")&&$(t).remove()}})},n.applyFlexSizes=function(e,t,o,n,i){for(var r=function(e,t){e&&_.isObservable(e)&&e(t)},a=!0,s=!0,l=0;l<t.length;l++){!(u=t[l]).preferFlexHeight&&u.visible&&(a=!1),!u.preferFlexWidth&&u.visible&&(s=!1)}for(l=0;l<t.length;l++){var u;(u=t[l]).preferFlexWidth&&(o||!u.ignoreSiblingSizes&&!s&&"vertical"===i)?(_.layout.provider.setFillWidth(u.element),r(u.element.dynWidthOverride,!1)):(_.layout.provider.removeFillWidth(u.element),u.preferFlexWidth&&r(u.element.dynWidthOverride,!0),!_.layout.provider.isFixedWidth(u.element)&&u.element.dynIncreasingWidth&&_.layout.provider.setFixedIncreasingWidth(u.element)),u.preferFlexHeight&&(n||!u.ignoreSiblingSizes&&!a&&"horizontal"==i)?(_.layout.provider.setFillHeight(u.element),r(u.element.dynHeightOverride,!1)):(_.layout.provider.removeFillHeight(u.element),u.preferFlexHeight&&r(u.element.dynHeightOverride,!0),!_.layout.provider.isFixedHeight(u.element)&&u.element.dynIncreasingHeight&&_.layout.provider.setFixedIncreasingHeight(u.element))}},n.columnize=function(e,t,o,n,i){var r=[],a=$(e),s=a.children();(t=Math.min(t,o))<1&&(t=1);for(var l=0;l<t;l++){var u=_.layout.createColumn(n==_.layout.ArrangeMethod.horizontalWrap,i==_.layout.Columns.fill,i==_.layout.Columns.balanced,!1);r.push(u),a.append(u.element)}if(0<s.length){var d=o/t,c=o%t,p=0,h=0;for(l=0;l<s.length;l++){var m=s[l];if(!m.classList.contains("layout-ignore")){var v=_.layout.createFlexUnit(m);if(v){if(v.visible)d+(h<c?1:0)<++p&&r[h+1]&&(h++,p=1),r[h].preferFlexWidth=r[h].preferFlexWidth||v.preferFlexWidth,r[h].preferFlexHeight=r[h].preferFlexHeight||v.preferFlexHeight;r[h].children.push(v),r[h].element.appendChild(v.element)}}}}return r},n.createColumn=function(e,t,o,n){var i=new _.layout.FlexUnit,r=document.createElement("div");r.classList.add("layout-column"),i.element=r,i.visible=!0,i.children=[],r.dynHasArranged=!0,_.dataBind(r);var a=t||o||e,s=t||o;return e&&r.classList.add("wrap-column"),o?r.classList.add("balanced-column"):t&&r.classList.add("fill-column"),n?(a||_.layout.provider.setVerticalContainer(r),s&&r.classList.add("fill-height")):(a||_.bindingHandlers.layout.invoke(r,{arrangeMethod:_.layout.ArrangeMethod.vertical}),s&&(i.preferFlexHeight=!0)),i};function e(){}var t,o;n.FlexUnit=e,n._reflowTask=_.debug.performance?new _.DomPerformanceTask("reflow"):null,n.reflow=function(e,t){_.layout._notifyReflowHandlers(e,_.layout.startReflowHandlers);var o=$(e)[0];_.layout._reflowTask&&_.layout._reflowTask.start(o),_.layout.inArrangeOrReflow=!0;var n,i=$(".fill-column",e).parent().filter(":visible"),r=$(".balanced-column",e).parent().filter(":visible"),a=i.length&&(n=_.ui.removeFocus(i))||r.length&&(n=_.ui.removeFocus(r)),s=_.shell.bodyFocusCorrection;n&&(_.shell.bodyFocusCorrection=!1),_.layout.breakAndReflow(i,".fill-column",_.layout.precomputeReflowSizes.fill,_.layout.fillColumn.reflow),_.layout.breakAndReflow(r,".balanced-column",_.layout.precomputeReflowSizes.balanced,_.layout.balancedColumn.reflow),a&&(_.ui.restoreFocus(n),_.shell.bodyFocusCorrection=s),_.layout.resizeDynamicContainers(e,t),_.layout._notifyReflowHandlers(e,_.layout.endReflowHandlers),_.layout.inArrangeOrReflow=!1,_.layout._reflowTask&&_.layout._reflowTask.stop(o)},n.breakAndReflow=function(e,t,o,n){for(var i,r,a,s=0;s<e.length;s++){var l=e[s],u=$(l).children().first()[0],d=l.dynIsBroken;if(d||(_.layout.breakGroups(u),l.dynIsBroken=!0),o(l),l.dynNeedsReflow){var c=(i=t,r=l,a=void 0,(a=$(r).children(i)).first().append(a.children()),$(i+":empty",r).remove(),!!(a=$(r).children(i)).length);d&&l.dynNeedsBroken&&(_.layout.removeBreakableGroups(u),_.layout.breakGroups(u),o(l)),c&&n(l)}}},(t=n.precomputeReflowSizes||(n.precomputeReflowSizes={})).measureChildren=function(e){for(var t=0,o=$(e).children(),n=0;n<o.length;n++){var i=o[n];$(i).addClass("layout-reflow-measure");for(var r=$(i).children(),a=0;a<r.length;a++){var s=r[a],l=_.context(s),u=$(s);if(l&&_.value(l.Visible)||(!l||void 0===l.Visible)&&u.is(":visible")){var d=u.outerWidth(!0),c=u.outerHeight(!0);d==s.dynReflowWidth&&c==s.dynReflowHeight||(e.dynNeedsReflow=!0,e.dynNeedsBroken=!0,s.dynReflowHeight=c,s.dynReflowWidth=d),1!=s.dynReflowVisible&&(e.dynNeedsBroken=!0,e.dynNeedsReflow=!0,s.dynReflowVisible=!0),t++}else 0!=s.dynReflowVisible&&(e.dynNeedsReflow=!0,e.dynNeedsBroken=!0,s.dynReflowVisible=!1),s.dynReflowWidth=0,s.dynReflowHeight=0}$(i).removeClass("layout-reflow-measure")}e.dynVisibleChildren=t,null==e.dynMinColumnWidth&&(e.dynMinColumnWidth={});var p=_.densityThemeManager._getCurrentDensity();if(null==e.dynMinColumnWidth.value||e.dynMinColumnWidth.density!=p){var h=o.first();h.addClass("layout-hide-children"),e.dynMinColumnWidth.value=h.outerWidth(!0),e.dynMinColumnWidth.density=p,e.dynColumnPadding=e.dynMinColumnWidth.value-h.width(),h.removeClass("layout-hide-children")}},t.fill=function(e){e.dynNeedsBroken=!1;var t=e.clientHeight-15;t!=e.dynContainerHeight&&(e.dynNeedsReflow=!0,e.dynContainerHeight=t),_.layout.precomputeReflowSizes.measureChildren(e)},t.balanced=function(e){e.dynNeedsBroken=!1;var t=e.clientWidth-15;t!=e.dynContainerWidth&&(e.dynNeedsReflow=!0,e.dynContainerWidth=t),_.layout.precomputeReflowSizes.measureChildren(e)},(n.fillColumn||(n.fillColumn={})).reflow=function(e){var t=$(e),o=t.children(".fill-column").first(),n=o.hasClass("wrap-column");if(o&&0<o.length){var i=e.dynContainerHeight,r=e.dynMinColumnWidth.value;if(i<=0)return;for(var a=[],s=o.children(),l=s.length;0<l;){for(var u=0,d=0,c=0,p=0,h=0;u<i&&0<l;){var m=s[s.length-l],v=!1;if(0<d&&u+Math.max(h,m.dynReflowHeight)>i)break;if((!n||0<p&&c+m.dynReflowWidth>r)&&(v=!0),v){if(u+=h,h=m.dynReflowHeight,c=m.dynReflowWidth,r=Math.max(c,r),(p=0)<d&&u+m.dynReflowHeight>i)break}else h=Math.max(h,m.dynReflowHeight),c+=m.dynReflowWidth,r=Math.max(c,r);p++,d++,l--}a.push(d)}for(var g=1;g<a.length;g++){var y=$(_.layout.createColumn(o.hasClass("wrap-column"),!0,!1,!0).element);t.append(y);for(var f=0;f<a[g];f++)y.append(o.children()[a[0]])}_.layout.provider.apply(e)}e.dynNeedsReflow=!1},(n.balancedColumn||(n.balancedColumn={})).reflow=function(e){var t=$(e),o=t.children().first(),n=o[0],i=e.dynVisibleChildren,r=e.dynColumnPadding,a=e.dynMinColumnWidth.value,s=e.dynContainerWidth,l=[];l.push(o.children().length);for(var u=_.layout.sizeCache.getCachedColumnHeight(0,l,0,n),d=1,c=u/d,p=Math.max(_.layout.sizeCache.getCachedColumnWidth(0,l,0,n)+r,a),h=p,m=p;d<i&&h<=s-p;){d++,l.push(0),c=u/d;var v=0;n=o[0];for(var g=0;v<d-1;){var y=_.layout.sizeCache.getCachedColumnHeight(v,l,g,n),f=$(n).children()[g+l[v]-1];1<_.layout.sizeCache.visibleChildrenCount(v,l,g,n)&&y-f.dynReflowHeight/2>c?(l[v]--,l[v+1]++):(g+=l[v],v++)}0==(p=Math.max(_.layout.sizeCache.getCachedColumnWidth(v,l,g,n)+r,a))?p=m:m=p,h+=p}for(var b=1;b<l.length;b++){var C=$(_.layout.createColumn(o.hasClass("wrap-column"),!1,!0,!0).element);t.append(C);for(var w=0;w<l[b];w++)C.append(o.children()[l[0]])}_.layout.provider.apply(e),e.dynNeedsReflow=!1},(o=n.sizeCache||(n.sizeCache={})).getCachedColumnHeight=function(e,t,o,n){for(var i=0,r=$(n).children(),a=t[e],s=o;s<o+a;s++)i+=r[s].dynReflowHeight;return i},o.getCachedColumnWidth=function(e,t,o,n){for(var i=0,r=$(n).children(),a=t[e],s=o;s<o+a;s++)i=Math.max(r[s].dynReflowWidth,i);return i},o.visibleChildrenCount=function(e,t,o,n){for(var i=0,r=$(n).children(),a=t[e],s=o;s<o+a;s++)r[s].dynReflowVisible&&i++;return i},n.resizeDynamicContainers=function(e,a){$(e).parent().find(".fixed-increasing-height").addBack(".fixed-increasing-height").each(function(e,t){a&&(t.style.minHeight="");var o=$(t),n=o.is(":visible")?o.height():0,i=o.data("dynamicHeight");if(a||null==i||i<n){var r=n+"px";t.style.minHeight=r,o.data("dynamicHeight",n),o.trigger("dynamicHeightChanged"),_.layout.provider.apply(t.parentNode)}}),$(e).parent().find(".fixed-increasing-width").addBack(".fixed-increasing-width").each(function(e,t){a&&(t.style.minWidth="");var o=$(t),n=o.is(":visible")?o.width():0,i=o.data("dynamicWidth");if(a||null==i||i<n){var r=n+"px";t.style.minWidth=r,o.data("dynamicWidth",n),o.trigger("dynamicWidthChanged"),_.layout.provider.apply(t.parentNode)}})};var i=(r.prototype.setHorizontalLeftContainer=function(e){e.classList.add("layout-container"),e.classList.add("layout-horizontal"),e.classList.remove("layout-vertical"),e.classList.remove("layout-right")},r.prototype.setHorizontalRightContainer=function(e){e.classList.add("layout-container"),e.classList.add("layout-horizontal"),e.classList.add("layout-right"),e.classList.remove("layout-vertical")},r.prototype.setHorizontalBottomAlign=function(e){e.classList.add("layout-horizontal-bottomalign")},r.prototype.setHorizontalTopAlign=function(e){e.classList.add("layout-horizontal-topalign")},r.prototype.isHorizontal=function(e){return e.classList.contains("layout-horizontal")},r.prototype.setVerticalContainer=function(e){e.classList.add("layout-container"),e.classList.add("layout-vertical"),e.classList.remove("layout-horizontal"),e.classList.remove("layout-right")},r.prototype.isVertical=function(e){return e.classList.contains("layout-vertical")},r.prototype.removeLayoutContainer=function(e){e.classList.remove("layout-container")},r.prototype.isFillWidth=function(e){return e.classList.contains("fill-width")},r.prototype.setFillWidth=function(e){e.classList.add("fill-width")},r.prototype.removeFillWidth=function(e){e.classList.remove("fill-width")},r.prototype.isFixedWidth=function(e){return e.classList.contains("fixed-width")},r.prototype.setFixedWidth=function(e){e.classList.add("fixed-width")},r.prototype.removeFixedWidth=function(e){e.classList.remove("fixed-width")},r.prototype.isFixedIncreasingWidth=function(e){return e.classList.contains("fixed-increasing-width")},r.prototype.setFixedIncreasingWidth=function(e){e.classList.add("fixed-increasing-width")},r.prototype.removeFixedIncreasingWidth=function(e){e.classList.remove("fixed-increasing-width")},r.prototype.isFillHeight=function(e){return e.classList.contains("fill-height")},r.prototype.setFillHeight=function(e){e.classList.add("fill-height")},r.prototype.removeFillHeight=function(e){e.classList.remove("fill-height")},r.prototype.isFixedHeight=function(e){return e.classList.contains("fixed-height")},r.prototype.setFixedHeight=function(e){e.classList.add("fixed-height")},r.prototype.removeFixedHeight=function(e){e.classList.remove("fixed-height")},r.prototype.isFixedIncreasingHeight=function(e){return e.classList.contains("fixed-increasing-height")},r.prototype.setFixedIncreasingHeight=function(e){e.classList.add("fixed-increasing-height")},r.prototype.removeFixedIncreasingHeight=function(e){e.classList.remove("fixed-increasing-height")},r.prototype.removeScopeMarker=function(e){e.classList.remove(_.layout.ScopeMarker)},r.prototype.apply=function(e){},r);function r(e){void 0===e&&(e=null),this.name=e}n.provider=new i;var a,s=(__extends(l,a=i),l);function l(e){return a.call(this,_.layout.Providers.css3flexbox)||this}n.css3flexbox=s;var u,d=(__extends(c,u=i),c.prototype.apply=function(e){this.updateColumnsRows(e)},c.prototype.updateColumnsRows=function(e){if(e&&e.dynHasArranged){var s,l="",u="",t="",d="",o="",c="";s=n.provider.isHorizontal(e)?(l="fill-width",u="fill-height",t="msGridColumns",d="msGridColumn",o="msGridRows",c="msGridRow","dynMinFlexWidth"):(l="fill-height",u="fill-width",t="msGridRows",d="msGridRow",o="msGridColumns",c="msGridColumn","dynMinFlexHeight");var p=!1,h=!1,m=e.classList.contains("layout-right")?"1fr":"",v=e.classList.contains("layout-right")?2:1;$(e).children().each(function(e,t){if($(t),"false"!=t.getAttribute("data-dyn-lastvisible")&&!t.classList.contains("layout-ignore")){h=h||t.classList.contains(u),p=p||!t.classList.contains(u);var o="min-content",n=" minmax({0}, max-content)",i=void 0,r=$(t).data(s);if(r)i=r;else{var a=t[s];a&&t.classList.contains(l)&&(i="function"==typeof a.minSizeFunction?a.minSizeFunction(a.cssClassArgument,t):""+a)}t.classList.contains(l)?(o="0px",n=" minmax({0}, 1fr)"):"0px"!=i&&i||(i="min-content"),m+=_.format(n,i||o),t.style[d]=v.toString(),t.style[c]="",v++}}),e.style[t]=m,e.style[o]="",p&&h?(e.classList.add("grid-crossaxis-mixed"),e.classList.remove("grid-crossaxis-fill")):(h?e.classList.add("grid-crossaxis-fill"):e.classList.remove("grid-crossaxis-fill"),e.classList.remove("grid-crossaxis-mixed"))}},c);function c(e){return u.call(this,_.layout.Providers.css3grid)||this}n.css3grid=d}(_.layout||(_.layout={}))}($dyn=$dyn||{}),function(u){var e,t,o,n,i,r;e=u.splitter||(u.splitter={}),(t=e.SplitterModes||(e.SplitterModes={})).top="Top",t.bottom="Bottom",t.left="Left",t.right="Right",t.both="Both",t.none="None",(o=e.HandleDirections||(e.HandleDirections={})).west="w",o.east="e",o.north="n",o.south="s",(n=e.CssClasses||(e.CssClasses={})).left="left-splitter",n.right="right-splitter",n.top="top-splitter",n.bottom="bottom-splitter",(i=e.Attributes||(e.Attributes={})).horizontal="data-dyn-horizontalsplitter",i.vertical="data-dyn-verticalsplitter",function(e){var t=(o.prototype.setup=function(){return{widthObserver:void 0}},o.prototype.shouldInvoke=function(e,t){return t!==e&&(void 0!==t||!!e)},o.prototype.invoke=function(e,t,o,n){var i=$(e),r=i.attr(u.splitter.Attributes.vertical);if(t===u.splitter.SplitterModes.none)void 0!==r&&r!==u.splitter.SplitterModes.none&&(i.attr(u.splitter.Attributes.vertical,u.splitter.SplitterModes.none),u.splitter.RemoveHandle(i,u.splitter.HandleDirections.east),u.splitter.RemoveHandle(i,u.splitter.HandleDirections.west)),n.widthObserver&&(n.widthObserver.dispose(),n.widthObserver=void 0);else{t===u.splitter.SplitterModes.left?(i.attr(u.splitter.Attributes.vertical,u.splitter.SplitterModes.left),i.addClass(u.splitter.CssClasses.left)):(t===u.splitter.SplitterModes.right?i.attr(u.splitter.Attributes.vertical,u.splitter.SplitterModes.right):(i.attr(u.splitter.Attributes.vertical,u.splitter.SplitterModes.both),i.addClass(u.splitter.CssClasses.left)),i.addClass(u.splitter.CssClasses.right)),u.splitter.CreateHandles(i);var a=u.context(e);a&&(n.widthObserver=u.observe(a.LayoutWidth,function(e){e===u.layout.Size.content&&u.setValue(a,"LayoutWidth",u.layout.Size.fixed)},void 0,n.widthObserver,!1))}},o.prototype.dispose=function(e,t){u.resizableHandle._destroyResizableHandles(e),t.widthObserver&&(t.widthObserver.dispose(),t.widthObserver=void 0)},o);function o(){}e.verticalSplitter=new t;var n=(i.prototype.setup=function(){return{heightObserver:void 0}},i.prototype.shouldInvoke=function(e,t){return t!==e&&(void 0!==t||!!e)},i.prototype.invoke=function(e,t,o,n){var i=$(e),r=i.attr(u.splitter.Attributes.horizontal);if(t===u.splitter.SplitterModes.none)void 0!==r&&r!==u.splitter.SplitterModes.none&&(i.attr(u.splitter.Attributes.horizontal,u.splitter.SplitterModes.none),u.splitter.RemoveHandle(i,u.splitter.HandleDirections.north),u.splitter.RemoveHandle(i,u.splitter.HandleDirections.south)),n.heightObserver&&(n.heightObserver.dispose(),n.heightObserver=void 0);else{t===u.splitter.SplitterModes.top?(i.attr(u.splitter.Attributes.horizontal,u.splitter.SplitterModes.top),i.addClass(u.splitter.CssClasses.top)):(t===u.splitter.SplitterModes.bottom?i.attr(u.splitter.Attributes.horizontal,u.splitter.SplitterModes.bottom):(i.attr(u.splitter.Attributes.horizontal,u.splitter.SplitterModes.both),i.addClass(u.splitter.CssClasses.top)),i.addClass(u.splitter.CssClasses.bottom)),u.splitter.CreateHandles(i);var a=u.context(e);a&&(n.heightObserver=u.observe(a.LayoutHeight,function(e){e===u.layout.Size.content&&u.setValue(a,"LayoutHeight",u.layout.Size.fixed)},void 0,n.heightObserver,!1))}},i.prototype.dispose=function(e,t){u.resizableHandle._destroyResizableHandles(e),t.heightObserver&&(t.heightObserver.dispose(),t.heightObserver=void 0)},i);function i(){}e.horizontalSplitter=new n}(u.bindingHandlers||(u.bindingHandlers={})),(r=u.splitter||(u.splitter={})).RemoveHandle=function(e,t){var o=e.children(".ui-resizable-"+t);0<o.length&&o.remove(),0===e.children(".ui-resizable-handle").length&&e.removeClass("ui-resizable")},r.CreateHandles=function(n){var e=u.splitter.GetHandlesFromMode(n);u.resizableHandle._destroyResizableHandles(n),u.resizableHandle._addResizableHandle(n,e,25,25,function(e,t){if(t.size){n[0].style.minWidth="";var o=u.context(n[0]);o&&o._parent&&o._parent.element&&u.layout.reflow(o._parent.element,!0)}}),n.children(".ui-resizable-handle").mousedown(u.splitter.SplitterMoved),n.children(".ui-resizable-handle").mouseup(u.splitter.SplitterPlaced),n.children(".ui-resizable-handle").keydown(u.splitter.SplitterMoved),n.children(".ui-resizable-handle").keyup(u.splitter.SplitterPlaced),n.children(".ui-resizable-handle").each(function(e,t){t._hammer&&(t._hammer.on("panstart",u.splitter.SplitterMoved),t._hammer.on("panend",u.splitter.SplitterPlaced))})},r.SplitterMoved=function(e){var t=$(e.target),o=$(e.target).parent(),n=u.context(o[0]);if((t.hasClass("ui-resizable-"+u.splitter.HandleDirections.east)||t.hasClass("ui-resizable-"+u.splitter.HandleDirections.west))&&n&&u.value(n.LayoutWidth)===u.layout.Size.available){var i=o.width();u.setValue(n,"LayoutWidth",i),t.attr("aria-valuenow","".concat(i));var r=o.next(),a=o.parent();if(a.hasClass("layout-column")&&(r=a.next().children().first()),0<r.length)(s=u.context(r[0]))&&u.value(s.LayoutWidth)!==u.layout.Size.available&&u.setValue(s,"LayoutWidth",u.layout.Size.available)}if((t.hasClass("ui-resizable-"+u.splitter.HandleDirections.north)||t.hasClass("ui-resizable-"+u.splitter.HandleDirections.south))&&n&&u.value(n.LayoutHeight)===u.layout.Size.available){var s,l=o.height();if(u.setValue(n,"LayoutHeight",l),t.attr("aria-valuenow","".concat(l)),0<(r=o.next()).length)(s=u.context(r[0]))&&u.value(s.LayoutHeight)!==u.layout.Size.available&&u.setValue(s,"LayoutHeight",u.layout.Size.available)}},r.SplitterPlaced=function(e){var t=$(e.target),o=t.parent(),n=u.context(o[0]);(t.hasClass("ui-resizable-"+u.splitter.HandleDirections.east)||t.hasClass("ui-resizable-"+u.splitter.HandleDirections.west))&&n&&u.callFunction(n.PersistPersonalization,n,["width",o.width()]),(t.hasClass("ui-resizable-"+u.splitter.HandleDirections.north)||t.hasClass("ui-resizable-"+u.splitter.HandleDirections.south))&&n&&u.callFunction(n.PersistPersonalization,n,["height",o.height()])},r.GetHandlesFromMode=function(e){var t="",o=e.attr("data-dyn-horizontalsplitter");o===u.splitter.SplitterModes.top?t=u.splitter.HandleDirections.north:o===u.splitter.SplitterModes.bottom?t=u.splitter.HandleDirections.south:o===u.splitter.SplitterModes.both&&(t=u.splitter.HandleDirections.north+","+u.splitter.HandleDirections.south);var n=0<t.length?",":"",i=e.attr("data-dyn-verticalsplitter");return i===u.splitter.SplitterModes.left?t=t+n+u.splitter.HandleDirections.west:i===u.splitter.SplitterModes.right?t=t+n+u.splitter.HandleDirections.east:i===u.splitter.SplitterModes.both&&(t=t+n+u.splitter.HandleDirections.west+","+u.splitter.HandleDirections.east),t}}($dyn=$dyn||{}),function(h){var e;function i(a,s){if(a&&s){for(var e in s)l=e,function(){var e,t,o=l,n=s[o];"object"!=typeof n&&(n=s[o]={attribute:n,defaultValue:n}),n.name=l,n.attribute=n.attribute||o.toLowerCase();var i,r=n.converter||h.util.converters[typeof n.defaultValue]||h.util.converters.string;n.serialize=void 0!==n.serialize&&n.serialize,n.invokeHandlers=void 0===n.invokeHandlers||n.invokeHandlers,n.serialize&&(i=n.attributeSetter?n.attributeSetter:"boolean"==typeof n.defaultValue?h.ui.booleanAttributeSetter(n.attribute):h.ui.setAttribute),n.backingField=n.backingField||"_"+o,t=n.observable?(e=h.ui._observableGetter,h.ui._observableSetter):(e=h.ui._propertyGetter,h.ui._propertySetter),a[n.backingField]=n.defaultValue,Object.defineProperty(a,o,{get:e(n.backingField),set:t(n.backingField,o,n.attribute,r,i,n.defer,n.defaultValue,n.invokeHandlers)})}()}var l}(e=h.ui||(h.ui={})).extendPrototype=function(e,t){t.ObservableProperties&&h.ui._initObservableProperties(t,e);var o=h.extendPrototype(e,t),n=t.properties;return n&&(i(o,n),e.properties&&o.properties&&(o.properties=h.extendPrototype(e.properties,o.properties))),o},e.extend=h.ui.extendPrototype,e.addPropertiesToPrototype=function(e,t){t&&(i(e,t),e.properties?e.properties=h.extendPrototype(e.properties,t):e.properties=t)},e.addObservablePropertiesToPrototype=function(e,t){if(Object.defineProperties(e,h.getOwnPropertyDescriptors(t)),e&&e.ObservableProperties&&(t=Object.create(e.ObservableProperties,h.getOwnPropertyDescriptors(t))),t&&(e.ObservableProperties=t),e.ObservableProperties)for(var o in e._observablePropertyList=[],e.ObservableProperties)e._observablePropertyList.push(o)},e._observableGetter=function(t){return function(){var e=this[t];return null!=e&&e.valueChanged||(e=this[t]=h.observable(e)),e()}},e._observableSetter=function(r,a,s,l,u,d,c,e){var p=a+"Changed";return function(i){this.updatingBlock.call(this,function(){var e=this,t=this,o=this[a];if(h.isObservable(i))throw new TypeError("Cannot set a control property to an observable object.");if(o!==i){this[r](l(i,o,c));var n=this[p];d?h.microTask(function(){n&&n.call(e,i,o),u&&u.call(t,t.element,i,o,s)}):(n&&n.call(this,i,o),u&&u.call(t,t.element,i,o,s))}})}},e._propertyGetter=function(e){return function(){return this[e]}},e._propertySetter=function(r,a,s,l,u,d,c,e){var p=a+"Changed";return function(i){this.updatingBlock.call(this,function(){var e=this;if(h.isObservable(i))throw new TypeError("Cannot set a control property to an observable object.");var t=this[a],o=l(i,t,c);if(t!==o){this[r]=o;var n=this[p];d?h.microTask(function(){n&&n.call(e,i,t),u&&u.call(e,e.element,i,t,s)}):(n&&n.call(this,i,t),u&&u.call(e,e.element,i,t,s))}})}},e.getObservableProperty=function(e,t){if(e&&t){var o=e[t];if(h.isObservable(o))return o;var n=e.properties&&e.properties[t];return n&&n.observable?e[n.backingField]:o}},e._initObservableProperties=function(e,t){if(Object.defineProperties(e,h.getOwnPropertyDescriptors(e.ObservableProperties)),t&&t.ObservableProperties&&(e.ObservableProperties=Object.create(t.ObservableProperties,h.getOwnPropertyDescriptors(e.ObservableProperties))),e.ObservableProperties)for(var o in e._observablePropertyList=[],e.ObservableProperties)e._observablePropertyList.push(o)},e.applyDefaults=function(e,t,o){for(var n in t=t||{},o){var i=t[n],r=e;n in e?h.isObservable(r[n])?(i=h.value(i),r[n](void 0!==i?i:o[n]),t[n]=r[n]):e.properties&&e.properties[n]?t[n]=r[n]=void 0!==h.value(i)?h.value(i):o[n]:t[n]=r[n]=h.observable(void 0!==h.value(i)?h.value(i):o[n]):h.isObservable(i)?r[n]=i:t[n]=r[n]=h.observable(void 0!==h.value(i)?h.value(i):o[n])}},e.autoProperty=function(t,o,n){return h.computed(function(){var e=h.value(o[n]);return e===h.ui.autoValue&&(e=t),e},function(e){h.setValue(o,n,e)})}}($dyn=$dyn||{}),function(C){var e,t,o,n;Globalize.addCultureInfo("en",{messages:{Framework_UnknownControl:"Unknown control: {0}, name: {1}",Framework_InvalidKeyCombo:"The key combination ({0}) is not a command.",Framework_ChordStarted:"({0}) was pressed.  Waiting for second part of key sequence..."}}),(C.controls||(C.controls={})).__namespace_created=!0,(e=C.ui||(C.ui={})).makeRoot=function(e){if(e&&e.element){var t=C.role(e.element).context;t&&(t.scopeVars.$root=e)}},(t=e.RootType||(e.RootType={})).form="Form",t.appBar="AppBarSection",t.dialog="Dialog",t.dropDialog="DropDialog",t.lookupPicker="LookupPicker",t.columnHeader="ColumnHeader",e.findRootElement=function(e){var t;if(C.debug.findControl&&C.logGroup("Call to findRootElement: root type: %o",e),!e)return C.debug.findControl&&C.log("Result findRootElement: not found"),void(C.debug.findControl&&C.logGroupEnd());if(e.nodeType)return C.debug.findControl&&C.log("Result findRootElement: html control"),C.debug.findControl&&C.logGroupEnd(),e;if(e instanceof jQuery)return e[0];switch(e){case C.ui.RootType.form:var o=C.shell.getCurrentRootForm();o&&C.value(o.dynReadyState)===C.ui.ReadyState.ready&&(t=o);break;case C.ui.RootType.appBar:t=$(".active-form .appBar")[0];break;case C.ui.RootType.dialog:var n=C.shell.getCurrentDialog();n&&C.value(n.dynReadyState)===C.ui.ReadyState.ready&&(t=n);break;case C.ui.RootType.lookupPicker:t=$("[data-dyn-role=Popup]")[0];break;case C.ui.RootType.dropDialog:t=$("[data-dyn-role=DropDialogPopup]")[0];break;case C.ui.RootType.columnHeader:t=$("[data-dyn-role=ColumnHeaderPopup][data-dyn-lastvisible=true]")[0]}return C.debug.findControl&&C.log("Result findRootElement: %o",t),C.debug.findControl&&C.logGroupEnd(),t},e.findRootControl=function(e){var t=C.ui.findRootElement(e);return C.context(t)},e.findControl=function(e,t){C.debug.findControl&&C.logGroup("Call to findControl: control: %o, root: %o",e,t);var o=C.ui.findControlElement(e,t);C.debug.findControl&&C.log("Return value findControl: %o",o),C.debug.findControl&&C.logGroupEnd();var n=C.context(o);return C.util.isFlightEnabled(C.reactGrid.featureName)&&o&&(n&&("ReactList"!==n.TypeName||o===n.element)||(n=C.ui.getLiveControl(o))),n},e.findControlElement=function(e,t){var o,n,b=$(C.ui.findRootElement(t));if(!b.length)return C.logWarning("Couldn't find root element identified by "+t),null;var i=function(e){var t,o,n,i;if(e){var r=b.find(".listView [data-dyn-controlname='"+e+"']");if(r&&r.length||(r=b.find(".listHeader [data-dyn-columnname='"+e+"']")),r&&r.length){var a=C.context(r.closest(".listRoot")[0]);a&&(a.findFieldByNameInServerSelectedRow&&(i=a.findFieldByNameInServerSelectedRow(e)),i&&i.length||(i=a.findFieldByName(e)),i&&i.length||(i=r))}else{var s=b.find(".reactGrid [data-dyn-controlname='"+e+"']");if(s&&s.length){var l=b.find(".reactGrid .dyn-activeRowCell [data-dyn-controlname='"+e+"']");if(l&&l.length){if(1<(i=l).length){var u=i.first().parents(".reactGrid").first(),d=C.context(u[0]);if(d){var c=d.getActiveRowAriaNumber().toString(),p=u.find("[aria-rowindex='".concat(c,"']"));if(p&&1===p.length){var h=p.find("[data-dyn-controlname='".concat(e,"']"));h&&h.length&&(i=h)}else{var m=null===(o=null===(t=d.ControlLibGridRef)||void 0===t?void 0:t.getActiveCellRef)||void 0===o?void 0:o.call(t,e),v=null===(n=null==m?void 0:m.getControlRef)||void 0===n?void 0:n.call(m);if(v){var g=ReactDOM.findDOMNode(v);g&&(i=$(g))}}}}}else{var y=b.find(".reactGrid .dyn-headerCell[data-dyn-controlname='"+e+"']");y&&y.length&&(i=y)}}}if(!i||!i.length){var f=b.find("[data-dyn-controlname='"+e+"']");i=[],f.each(function(e,t){t.isHiddenFromFind||i.push(t)})}}else i=b;return i}(e);if(i&&1===i.length)return i[0];if(i){for(var r=null===(o=C.context(b[0]))||void 0===o?void 0:o.Id,a=void 0,s=void 0,l=void 0,u=0,d=i.length;u<d;u++){var c=i[u];if(c){a=a||c;var p=C.context(c);if(p){if(r&&(null===(n=p.Root)||void 0===n?void 0:n.Id)===r){l=c;break}if(!s&&(s=c,!r))break}}}if(l)return l;if(s)return s;if(a)return a}},e.findFlyoutControlElement=function(e,t){if(e)for(var o=void 0,n=C.flyout.flyoutManager.getAllFlyoutElementsByParentFormId(t),i=0;i<n.length;i++){var r=n[i];if(o=C.ui.findControlElement(e,r))return o}},e._findVirtualizedContextWrapper=function(e){if(e.dynContext)return e.dynContext;var t=$(e).closest("[data-dyn-controlname]").addBack()[0],o=$(t).closest("[data-dyn-virtualcontext]")[0];if(o&&o.dynVirtualContext){var n=o.dynVirtualContext.getContext(e);if(n)return n}return new C.DataContext},e.getLiveControl=function(e){if(e){var t=null,o=C.ui._findVirtualizedContextWrapper(e);if(o&&o.current)t=o.current;else{var n=$(e).closest("[data-dyn-controlname]").addBack()[0];if(n&&!(t=C.context(n))){var i=$(n).closest(".react-listRoot")[0];if(!i){var r=$(n).closest(".dyn-flyout")[0];if(r){var a=r.getAttribute("data-flyoutkey"),s=ControlLibrary.FlyoutAnchor.getAnchorForFlyout(a);s&&(i=$(s).closest(".react-listRoot")[0])}}i&&(t=C.context(i))}}return t&&t.getLiveControl&&(t=t.getLiveControl(e)),t}},e.shouldFieldShowHelp=function(e){return!!(C.value(e.ShowLabel)&&C.value(e.Label)&&C.value(e.HelpText))},C.dataSource=function(e){var t=C.context(e);if(t)return t.DataSource},C.adapter=function(e){e.controlType||(e.controlType=e.id);var t=C.controls;if(!t[e.id]){var o=t[e.controlType];t[e.id]=function(){o.apply(this,arguments)},t[e.id].prototype=Object.create(t[e.controlType].prototype)}return t[e.id].prototype.template=e.template,t[e.id]},C.cellAdapter=function(e){var t=e.type===o.editor?"cellEditor":"cellRoleName";return e.cellRoleName||(e.cellRoleName=e.id+(e.type===o.editor?"CellEditor":"Cell")),e.controlType||(e.controlType=e.id),e.template||(e.template=e.cellRoleName),C.controls[e.id].prototype[t]=e.cellRoleName,e.id=e.cellRoleName,C.adapter(e)},(n=o=C.cellTypes||(C.cellTypes={}))[n.readOnly=1]="readOnly",n[n.editor=2]="editor"}($dyn=$dyn||{}),function(m){!function(e){e.defaults={};var t=(Object.defineProperty(o.prototype,"Id",{get:function(){return void 0===this._id&&this.element&&(this._id=this.element.getAttribute("id")),this._id},set:function(e){e=m.value(e),this._id&&this._id!==e&&m.logError("The id of a control can not be changed"),!this._id&&this.element&&this.element.setAttribute("id",m.value(e)),this._id=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"Name",{get:function(){return void 0===this._name&&this.element&&(this._name=this.element.getAttribute("data-dyn-controlname")),this._name},set:function(e){e=m.value(e),this._name&&this._name!==e&&m.logError("The name of the control scan not be changed"),!this._name&&this.element&&this.element.setAttribute("data-dyn-controlname",e),this._name=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"LayoutWidth",{get:function(){return this._layoutWidth||(this._layoutWidth=m.ui.autoProperty(m.layout.Size.content,this,"Width")),this._layoutWidth},set:function(e){this._layoutWidth=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"LayoutHeight",{get:function(){return this._layoutHeight||(this._layoutHeight=m.ui.autoProperty(m.layout.Size.content,this,"Height")),this._layoutHeight},set:function(e){this._layoutHeight=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"IsDataBound",{get:function(){return this._role&&this._role.isDataBound},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"Children",{get:function(){return this._role&&this._role.children},set:function(e){this._role||(this._role={}),this._role.children=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"Updating",{get:function(){return this.__updating||this.createUpdatingObservable(),this.__updating},enumerable:!1,configurable:!0}),o.prototype.showShortcutsHandler=function(c){var p=this;if(this.shortcutToolTip)$(".shortcutHelp .viewAllShortcuts").click();else{var h=m.util.getShortcutsTextForControl(this,c);this.qtipRepositionInterval&&(window.clearInterval(this.qtipRepositionInterval),this.qtipRepositionInterval=null),this.shortcutToolTip=$(c).qtip({id:"shortcutToolTip",content:{text:function(e,t){var o=document.createElement("div");if(h&&h[m.ui.ShortcutCategory.ElementAction]){var n=document.createElement("div");n.classList.add("shortcutsList");for(var i=0,r=h[m.ui.ShortcutCategory.ElementAction].length;i<r;i++){var a=h[m.ui.ShortcutCategory.ElementAction][i],s=document.createElement("div");s.classList.add("shortcutDiv");var l=document.createElement("span");l.classList.add("descriptionText"),l.textContent=a.descriptionText,s.appendChild(l);var u=document.createElement("span");u.classList.add("keyText"),u.textContent=a.keyText,s.appendChild(u),n.appendChild(s)}o.appendChild(n)}var d=document.createElement("a");return d.classList.add("viewAllShortcuts"),d.href="javascript:void(0)",d.textContent="View all currently available shortcuts",d.onclick=function(){t.hide(),m.showAvailableShorcutsDialog(m.util.getAvailableShortcutsText(p,c))},o.appendChild(d),o},title:m.label("Framework_ElementActions")},style:{classes:"baseDirection fieldToolTipBase shortcutHelp",tip:!0,width:"280px"},position:{at:"center right",effect:!m.flags.disableAnimations&&void 0,my:"center left",viewport:$(window)},show:{delay:m.flags.disableAnimations?0:500,effect:!m.flags.disableAnimations&&void 0,ready:!0},hide:{effect:!m.flags.disableAnimations&&void 0,event:"unfocus",fixed:!0},events:{focus:function(e,t){e.preventDefault()},hide:function(e,t){p.shortcutToolTip&&(p.shortcutToolTip.destroy(!0),p.shortcutToolTip=null),p.qtipRepositionInterval&&(window.clearInterval(p.qtipRepositionInterval),p.qtipRepositionInterval=null),p.shortcutToolTipEscapeHandler&&(document.removeEventListener("keydown",p.shortcutToolTipEscapeHandler,!0),p.shortcutToolTipEscapeHandler=null)},render:function(e,t){p.shortcutToolTipEscapeHandler=function(e){e.keyCode===m.ui.KeyCodes.esc&&(document.removeEventListener("keydown",p.shortcutToolTipEscapeHandler,!0),e.stopPropagation(),m.log.stopPropagation&&m.log.stopPropagation("Escape handler for qtip"),e.preventDefault(),t.hide())},document.addEventListener("keydown",p.shortcutToolTipEscapeHandler,!0)}}}).qtip("api"),this.shortcutToolTip&&(this.qtipRepositionInterval=window.setInterval(function(){m.value(p.Visible)&&p.shortcutToolTip.reposition(null,!0)},500))}},o.prototype.init=function(e,t){this.element=t,this.bindUpdate&&(this.bindingTrigger=m.observable(0)),this.applyParameters(e)},o.prototype.usingDisposable=function(e){return this._disposables||(this._disposables=[]),this._disposables.push(e),e},o.prototype.dispose=function(){if(this._disposables){for(var e=0;e<this._disposables.length;e++)this._disposables[e].dispose();this._disposables=void 0}if(this._timeoutIds){for(var e in this._timeoutIds)clearTimeout(this._timeoutIds[e]);this._timeoutIds=void 0}},o.prototype.getTaskGuideParams=function(e){return $.extend(e,{adjustMethod:"flip",at:m.layout.qTipPosition.rightCenter,my:m.layout.qTipPosition.leftCenter,target:$(this.element)}),e},o.prototype.getPersonalizationElements=function(){return[this.element]},o.prototype.getContextMenuOptions=function(e){var t=this;return[{Label:m.label("Framework_ViewShortcuts"),Command:function(){m.showAvailableShorcutsDialog(m.util.getAvailableShortcutsText(t,t.element))}}]},o.prototype.observe=function(e,t){if(!e.observable)throw new TypeError("Property must be observable in order to observe it.");return m.isObservable(this[e.backingField])||this[e.name],m.observe(this[e.backingField],function(e){t(e)})},o.prototype.setUpdating=function(e){this.__updating||this.createUpdatingObservable(),this.__updating(e)},o.prototype.isInGrid=function(){if(void 0===this._isInGrid){for(var e=!1,t=this.element;t&&t.classList&&!e;)(e=t.classList.contains("listCellControl")||t.classList.contains("listItem"))||(t=t.parentNode);this._isInGrid=e}return this._isInGrid},o.prototype.isInTable=function(){var e;return"RowTemplate_Table"===(null===(e=this._parent)||void 0===e?void 0:e.TypeName)},o.prototype.isInSelectedGridRow=function(){for(var e=!1,t=this.element,o=!1;t&&t.classList&&!o;)if(o=t.classList.contains("listItem")){var n=t.getAttribute("data-dyn-row-active");e=m.util.stringToBoolean(n)}else t=t.parentNode;return e},o.prototype.updatingBlock=function(e){this.parametersApplied&&!m.peek(this.__updating)?(this.setUpdating(!0),e.apply(this),this.setUpdating(!1)):e.apply(this)},o.prototype.allowUserChanges=function(){return m.value(this.AllowEdit)&&m.value(this.Enabled)&&m.value(this.Visible)},o.prototype.focusCallback=function(e){var t=e[0]?e[0]:this.element,o=$(t).addBack().closest("[data-dyn-controlname]")[0],n=o?o.getAttribute("data-dyn-controlname"):"";m.log.focus&&m.log.focus("Focus: Control->focusCallback - set focus to : %s",n),m.util.focusElement(t)},o.prototype.attached=function(){},o.prototype.applyParameters=function(e){var t,o,n=this;for(t in e)o=e[t],"DataSource"===t&&(this.DataSource=e.DataSource),t in n?m.isObservable(n[t])?void 0!==(o=m.peek(o))&&n[t](o):m.isObservable(o)?n.properties&&n.properties[t]?function(t,e,o){t.usingDisposable(m.observe(e,function(e){t[o]=e}))}(n,o,t):(void 0===m.peek(o)&&(o._current=n[t]),n[t]=o):void 0!==o&&(n[t]=o):m.isObservable(o)?n[t]=o:n[t]=void 0!==o?o:n[t],this.bindUpdate&&m.isObservable(n[t])&&n[t].valueChanged.subscribe(this.onObservablePropChange,this),e[t]=n[t];var i=n._observablePropertyList;if(i)for(var r=0,a=i.length;r<a;r++)o=n[t=i[r]],m.isObservable(o)||(n[t]=m.observable(o),this.bindUpdate&&n[t].valueChanged.subscribe(this.onObservablePropChange,this));this.bindUpdate&&this.Children&&this.Children.valueChanged.subscribe(this.onObservablePropChange,this),this.parametersApplied=!0},o.prototype.onObservablePropChange=function(){m.peek(this.__updating)||(this.setUpdating(!0),this.setUpdating(!1))},o.prototype.setTimeout=function(e,t){var o=this;this._timeoutIds||(this._timeoutIds={});var n=window.setTimeout(function(){e&&e.call(o),o._timeoutIds&&delete o._timeoutIds[n]},t);return this._timeoutIds[n]=n},o.prototype.RaiseEvent=function(e,t){var o=new CustomEvent(e,t);this.element.dispatchEvent(o)},o.prototype.setFocus=function(e,t){if(e){var o=m.ui.getLiveControl(e),n=o?o.Name:e.getAttribute("data-dyn-controlname");if(o&&o!==this){if(o&&!m.value(o.Enabled))return void(m.log.focus&&m.log.focus("Focus: Form(Form.Id: %s)->Focus prevented for disabled control name: %s",t.Id,n));if(m.util.isControlFocused(e,t))return;var i=e.getAttribute("data-dyn-focus");o&&m.value(o.isContainer)&&(""==i||void 0===i)&&o.setChildControlFocus(),t&&(t.elementToFocus=e,t.elementToFocusName=n,m.log.focus&&m.log.focus("Focus: Control->setFocus->Delay setting focus to - control name:' %s ' as a microTask",t.elementToFocusName),t.isSetControlFocusCalled||(t.isSetControlFocusCalled=!0,m.microTask(function(){m.log.focus&&m.log.focus("Controls->setFocus->Execute micro task to set focus to a control '%s'.",t.elementToFocusName),m.callFunction(t.form_setFocus,t,t.elementToFocus),t.elementToFocus=null,t.elementToFocusName="",t.isSetControlFocusCalled=!1})))}}},o.prototype.createUpdatingObservable=function(){var t=this;this.__updating=m.observable(!1),this.__updating.valueChanged.subscribe(function(e){m.peek(e)||t.bindingTrigger&&t.bindingTrigger(m.peek(t.bindingTrigger)+1)})},o);function o(e,t,o,n){var i;this.ServiceBoundary=null,this.ServerFocusableControl=null,this.IsServerFocusable=(i=!0,function(e){return 0<arguments.length&&(i=e),i}),this._role=n,this._parent=o,this.focusCallback=this.focusCallback.bind(this),this.init(e,t)}(e.Control=t).prototype.Visible=!0,t.prototype.Skip=!1,t.prototype.Enabled=!0,t.prototype.AllowEdit=!0,t.prototype.Width=m.layout.Size.content,t.prototype.Height=m.layout.Size.content,t.prototype.IsViewMode=!1,t.prototype.AllowPersonalization=!0,t.prototype.Style="",t.prototype.PersistPersonalization=null,t.prototype.ExecutePersonalizationCommand=null,t.prototype.RequestEnhancedPreview=null,t.prototype.CanHavePreview=!1,t.prototype.Shortcuts={AvailableShortcuts:{Keys:{alt:!0,shift:!0,keyCode:m.ui.KeyCodes.letterK},Handler:function(e){this.showShortcutsHandler?this.showShortcutsHandler(e.target):this.Shortcuts&&m.ui.Control.prototype.showShortcutsHandler.call(this,e.target)},ShowToUser:!1}},t.prototype.properties={},m.ui.addPropertiesToPrototype(t.prototype,{ExtendedStyle:{attributeSetter:m.ui.replaceCssClass,converter:m.util.converters.notNullString,defaultValue:"",observable:!0,serialize:!0}})}(m.ui||(m.ui={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(i){var e,r,t;function o(){return null!==r&&r.apply(this,arguments)||this}e=i.ui||(i.ui={}),r=i.ui.Control,__extends(o,r),o.prototype.init=function(e,t){var o=this;if(r.prototype.init.call(this,e,t),this.element){var n=this.element.getAttribute("data-dyn-container");"true"!==n&&(this.element.dynLayoutContainer=$(this.element).find(n)[0])}this.LayoutArrangeMethod=i.ui.autoProperty(i.layout.ArrangeMethod.vertical,this,"ArrangeMethod"),this._zoomModeWidthColumnObserver=i.observe(i.shell.zoomModeWidth,function(e){o._processZoomWidthChanges(e)},this,void 0,!0)},o.prototype.dispose=function(){this._zoomModeWidthColumnObserver&&this._zoomModeWidthColumnObserver.dispose(),r.prototype.dispose.call(this)},o.prototype.setChildControlFocus=function(){var e=i.util.findFirstFocusableControl(this.element);if(e)return this.setFocus(e,this.Root),e},o.prototype._processZoomWidthChanges=function(e){if(e){var t=i.value(this.LayoutColumns),o="number"==typeof t?t:parseInt(t,10);!isNaN(o)&&1<o&&(this._dynColumns=i.value(this.LayoutColumns),i.setValue(this,"LayoutColumns",1))}else e||void 0!==this._dynColumns&&(i.setValue(this,"LayoutColumns",this._dynColumns),this._dynColumns=void 0)},t=o,(e.Container=t).prototype.Columns=1,t.prototype.ArrangeMethod=i.layout.ArrangeMethod.vertical,t.prototype.isContainer=!0}($dyn=$dyn||{}),function(c){var e;(e=c.ui||(c.ui={})).controlOptions=function(e,t){if(t&&t.bindUpdate){var o=void 0;for(var n in o="function"==typeof e?e():e)o[n]=c.peek(o[n]);return o}return c.options(e,t.Updating)},e.link=function(o){return c.ui.controlOptions(function(){var e=o.getLabelledByData&&o.getLabelledByData(),t=!e||e.showLabel&&!e.isInGrid;return{byElementId:e&&t?e.byElementId:"",click:o.ExecuteHyperlink,label:e&&!t?e.label:"",readonly:o.readOnly,showLink:o.showLink,value:o.Value}},o)},e.getDescribedByData=function(e){var t,o,n,i,r;e&&(i=e.Id+"_helptext");var a=null===(t=null==e?void 0:e.element)||void 0===t?void 0:t.parentElement,s=null==e?void 0:e._parent;if(c.value(null==s?void 0:s.IsTabularControl)&&null!=a&&a.children){var l=Array.from(a.children).indexOf(e.element),u=s.$tabularHeaderElement;if(-1!==l&&u){var d=u.children()[1];r=null===(n=null===(o=null==d?void 0:d.children)||void 0===o?void 0:o[l])||void 0===n?void 0:n.id}}return r&&(i=r+" "+e.Id+"_helptext"),i},e.getHelpFieldText=function(e){var t=c.value(e.HelpText);if(c.value(e.LookupButton)||c.value(e.isComboboxBehavior)){var o=c.label("Input_LookupGuideHelpText")+" ";c.value(e.LookupOnly)&&(o=c.label("Input_LookupOnlyGuideHelpText")+" "+o),t=o+t}return t},e.preview=function(e){return c.ui.controlOptions(function(){return{CanHavePreview:e.CanHavePreview,RequestEnhancedPreview:e.RequestEnhancedPreview}},e)},e.fieldOptions=function(e){return c.ui.controlOptions(function(){return{AllowTyping:!!e.allowTyping&&e.allowTyping()}},e)},e.superTooltip=function(e,t,o){return c.ui.controlOptions(function(){return{HelpText:e.HelpText,OnlyKeyboard:o,SkipOverflowCheck:t}},e)},e.status=function(e){var t={"":c.ui.StatusIndicator.none,"Required-symbol statusMandatory":c.ui.StatusIndicator.mandatory,"Warning-symbol statusWarning":c.ui.StatusIndicator.warning};return c.ui.controlOptions(function(){return{value:e.StatusIndicator,options:t}},e)},e.checkBoxStyle=function(e){var t={autoStyle:c.ui.CheckBoxStyle.auto,standardStyle:c.ui.CheckBoxStyle.checkbox,toggleStyle:c.ui.CheckBoxStyle.toggle};return c.ui.controlOptions(function(){return{value:e.Style,options:t}},e)},e.skip=function(e){return c.ui.controlOptions(function(){return{skip:e.Skip,enabled:e.Enabled,visible:e.Visible}},e)},e.img=function(e){return c.ui.controlOptions(function(){return{imageName:e.ImageName,imageType:e.ImageType}},e)},e.labelFor=function(e,t,o,n){return void 0===o&&(o=void 0===t.ShowLabel?!(!t.Label&&void 0===n):t.ShowLabel),c.ui.controlOptions(function(){return{forElement:e,text:t.Label,showLabel:o,emptyStr:n}},t)},e.ariaLabelFor=function(e,t,o,n){return void 0===o&&(o=void 0===t.ShowLabel?!(!t.Label&&void 0===n):t.ShowLabel),c.ui.controlOptions(function(){return{forElementId:e,text:t.Label,showLabel:o,emptyStr:n}},t)},e.ariaLabel=function(e){return c.ui.controlOptions(function(){return{label:e.Label}},e)},e.ariaLabelImage=function(e){return c.ui.controlOptions(function(){return{id:e.Id,imageName:c.value(e.ImageName),label:c.value(e.Label),name:e.Name,toolTip:c.value(e.Tooltip),type:c.value(e.ImageType)}},e)},e.summaryFieldLink=function(e){return c.options(function(){return{click:e.ExecuteHyperlink,readonly:!0,showLink:c.value(e.IsHyperlink)&&c.value(e.Enabled)&&c.value(e.IsValid)&&c.value(e.formattedValue),stopPropagation:!0,value:c.value(e.Label)+": "+c.value(e.formattedValue)}},e.Updating)}}($dyn=$dyn||{}),function(c){var e;(e=c.ui||(c.ui={})).isPopupHost=function(e){return!!e.Popup},e.popupHost=function(u){var d=this;this.Popup=c.observable(),this.PopupId=c.observable(),void 0!==this.ShowFlyout?c.isObservable(this.ShowFlyout)||(this.ShowFlyout=c.observable(this.ShowFlyout)):this.ShowFlyout=c.observable(!1),this.popupHostElement=void 0,this.showPopup=function(t,e){var o,n=d.Popup();if(n){if(n[0]&&(c.value(null===(o=c.context(n[0]))||void 0===o?void 0:o.ReadyState)===c.ui.ReadyState.aborted||n[0].isClosing)){if(n[0].wasPopupOpenedDeferredForExistingClose=!0,d&&d.pendingPopup){l={cancel:function(){var e=c.context(d.popupHostElement);c.log.popups&&c.log.popups("Popups: Deferred lookup canceled for %s (flyout id %s)",d._element&&d._element.id?d._element.id:"<unknown>",e&&e.Name?e.Name:"<unknown>"),n[0].wasPopupOpenedDeferredForExistingClose=!1,d.ShowFlyout(!1),d.pendingPopup(void 0)}};d.pendingPopup(l)}c.log.popups&&c.log.popups("Popups: Deferred lookup queued for %s; current ShowFlyout value is %s",d._element&&d._element.id?d._element.id:"<unknown>",c.peek(d.ShowFlyout)),c.peek(d.ShowFlyout)?t.valueChanged.raise():d.ShowFlyout(!0)}else if(d.popupHostElement=n[0],c.log.popups){var i=c.context(n[0]);c.log.popups("Popups: Skipping generating lookup for control %s / %s (flyout id %s) -- popup already created",d.Name?d.Name:"<unknown>",d._element&&d._element.id?d._element.id:"<unknown>",i.Name?i.Name:"<unknown>")}}else{var r=d.PopupId();if(r)c.log.popups&&c.log.popups("Popups: Recycling lookup for control %s / (flyout id %s) -- popup ID already set",d.Name?d.Name:"<unknown>",d._element&&d._element.id?d._element.id:"<unknown>"),n=d.Popup($("#form_"+r));else{var a=u?c.util.objectAssign({},u):{role:"Popup"};d.popupHostElement=c.shell.createForm(a),c.log.popups&&c.log.popups("Popups: Popup ID set from %s to %s",c.peek(d.PopupId),d.popupHostElement.getAttribute("data-dyn-formid")),r=d.PopupId(d.popupHostElement.getAttribute("data-dyn-formid"));var s=c.context(d.popupHostElement);if(s&&(s.highlyResponsive=d.highlyResponsivePopups,e&&(s.routeMessagesToParent=e.routeMessagesToParent),d&&d.pendingPopup)){var l={cancel:function(){c.log.popups&&c.log.popups("Popups: Lookup canceled for %s (flyout id %s)",d._element&&d._element.id,s&&s.Name?s.Name:"<unknown>"),s&&c.value(s.ReadyState)!==c.ui.ReadyState.closed&&s.ReadyState(c.ui.ReadyState.aborted),d.ShowFlyout(!1),d.pendingPopup(void 0)}};c.observe(s.ReadyState,function(e){if(e===c.ui.ReadyState.ready)return c.setValue(d,"FlyoutId",s.element.id),!1}),d.pendingPopup(l)}n=d.Popup($(d.popupHostElement)),c.async(function(){d.popupHostElement&&(c.context(d.popupHostElement).onPopupReceived=function(e){d.pendingPopup&&d.pendingPopup(void 0);var t=null;n&&(t=c.context(n[0])),c.async(function(){n&&t&&c.value(t.ReadyState)!==c.ui.ReadyState.aborted&&(t.isActivePopup()||(c.log.popups&&c.log.popups("Popups: Closing lookup for control %s / %s (flyout id %s) -- no longer the active form",d.Name?d.Name:"<unknown>",d._element&&d._element.id?d._element.id:"<unknown>",s&&s.Name?s.Name:"<unknown>"),e.cancel()))},0,"Wait for interactions to check popup")});d.Root&&d.Root.updateLastClientSelectedControl&&!0===c.value(d.RequiresSelectedControl)&&!0===c.value(d.Root.IsForm)&&d.Root.updateLastClientSelectedControl();var e="";d.displayedValues&&(e=d.displayedValues(!0)),d.$inputElement&&d.$inputElement[0]&&((e=e||{}).__selectionStart=String(c.ui.selectionStart(d.$inputElement[0])),e.__selectionEnd=String(c.ui.selectionEnd(d.$inputElement[0]))),c.log.popups&&c.log.popups("Popups: Requesting lookup for control %s/%s (flyout id %s)",d&&d.Name?d.Name:"<unknown>",d._element&&d._element.id?d._element.id:"<unknown>",s&&s.Name?s.Name:"<unknown>"),c.callFunction(d.RequestPopup,d,[r,e],function(e){var t=null;n&&(t=c.context(n[0])),t&&(c.value(t.ReadyState)===c.ui.ReadyState.request||void 0!==e&&0!=e?(c.log.popups&&c.log.popups("Popups: Closing lookup for control %s / %s (flyout id %s) -- there was an error",d.Name?d.Name:"<unknown>",d._element&&d._element.id?d._element.id:"<unknown>",s&&s.Name?s.Name:"<unknown>"),c.value(t.ReadyState)!==c.ui.ReadyState.closed&&c.shell.close({form:t})):!t.popupAborted&&t.Children&&0===t.Children().length&&(c.log.popups&&c.log.popups("Popups: Closing lookup for control %s / %s (flyout id %s) -- empty lookup form",d.Name?d.Name:"<unknown>",d._element&&d._element.id?d._element.id:"<unknown>",s&&s.Name?s.Name:"<unknown>"),d.pendingPopup&&d.pendingPopup(void 0),c.getFunction(t.Close)()))},void 0,void 0,void 0,function(){var e=null;n&&(e=c.context(n[0])),e&&c.getFunction(e.Close)()})},0,"$dyn.ui.popupHost RequestPopup")}}return n[0]&&(n[0].dynClose=function(){d.Popup&&d.Popup(null),d.PopupId&&(c.log.popups&&c.log.popups("Popups: Popup ID set from %s to null",c.peek(d.PopupId)),d.PopupId(null)),t(null),d.FlyoutId&&c.setValue(d,"FlyoutId",""),c.flyout.flyoutManager.removeFlyoutByElementId(n[0].getAttribute("id")),d.popupHostElement&&$(d.popupHostElement).remove();var e=c.context(n[0]);c.shell.getActiveForm()===n[0]&&c.shell.tryActivateParentElement(d,{takeNavigationFocus:!e||!e.shouldResetFocusOnClose||e.shouldResetFocusOnClose()}),e&&!e.closeCallback&&c.value(d.ShowFlyout)&&!n[0].wasPopupOpenedDeferredForExistingClose&&d.ShowFlyout(!1),n[0].wasPopupOpenedDeferredForExistingClose&&(c.async(function(){if(c.log.popups){var e=c.context(d.popupHostElement);c.log.popups("Popups: Deferred lookup being performed for %s (flyout id %s) -- lookup was requested while still handling aborted lookup",d._element&&d._element.id?d._element.id:"<unknown>",e&&e.Name?e.Name:"<unknown>")}c.peek(d.ShowFlyout)?d.ShowFlyout.valueChanged.raise():d.ShowFlyout(!0)},0,"Waiting for aborted popup to close before opening popup lookup"),n[0].wasPopupOpenedDeferredForExistingClose=!1),d.popupHostElement=void 0,n[0].dynClose=c.util.emptyfunction,n[0].isClosed=!0,n[0].RequestPopupClose=c.util.emptyfunction},n[0].RequestPopupClose=function(e,t){var o=c.context(n[0]);o&&o.Close&&(o.element&&c.value(o.element.dynReadyState)===c.ui.ReadyState.ready?(d.highlyResponsivePopups&&(d.ShowFlyout(!1),n[0].isClosing=!0),c.getFunction(o.Close)({closeCallback:function(){c.getFunction(e)(),d.highlyResponsivePopups||d.ShowFlyout(!1)},record:t})):(c.flyout.flyoutManager.removeFlyoutByElementId(o.element.getAttribute("id")),"function"==typeof e&&e(),d.ShowFlyout(!1)))}),t(n),n}},e.disposePopupHost=function(){this.Popup&&delete this.Popup,this.PopupId&&(c.log.popups&&c.log.popups("Popups: disposing popup host (Id: %s)",c.peek(this.PopupId)),delete this.PopupId),this.showPopup&&delete this.showPopup,this.popupHostElement&&delete this.popupHostElement}}($dyn=$dyn||{}),$dyn.flags.disableTimer||($dyn.ui.PerformanceTimer={duration:$dyn.observable(),trivialTime:70,expectedTime:$dyn.observable(),ajaxTime:$dyn.observable(0),pendingBlockingDivRequests:0,blockingDivStart:0,blockingDivEnd:0,blockingDivTime:0,blockingDivDescription:"",interactionType:$dyn.observable(""),pendingAjaxRequests:0,bandwidth:$dyn.observable(0),indicator:$dyn.observable(),startTime:void 0,actionSet:{},log:$dyn.log.performance,actions:$dyn.observable([]),action:"",timings:$dyn.observable([]),segments:[],steps:$dyn.observable([]),renderTime:$dyn.computed(function(){var e=$dyn.ui.PerformanceTimer;return e.duration()-e.ajaxTime()}),oppTiming:$dyn.observable(),clientType:0,serverType:1,_startAjax:function(e){var t=$dyn.ui.PerformanceTimer;0==t.pendingAjaxRequests?(t.inClient&&(t.clientEnd=performance.now(),$dyn.timeEnd("client"),t.inClient=!1,t.segments.push({Name:$dyn.label("PerformanceTimer_ClientAction"),Duration:t.clientEnd-t.clientStart,StartTime:t.clientStart,Type:t.clientType})),t.ajaxStart=performance.now(),t.startTime||(t.startTime=t.ajaxStart),t.ajaxEnd||(t.ajaxEnd=t.ajaxStart),t.ajaxActivityId||(t.ajaxActivityId=e),$dyn.time("ajax"),t.log&&t.log("performance: ajax started: duration since last end: %s, overall: %s",t.ajaxStart-t.ajaxEnd,t.ajaxStart-t.startTime)):t.log&&t.log("performance: ajax started with pending ajax requests: %s",t.pendingAjaxRequests),t.pendingAjaxRequests++},_stopAjax:function(){var e=$dyn.ui.PerformanceTimer;if(e.pendingAjaxRequests--,0==e.pendingAjaxRequests){e.clientStart=e.ajaxEnd=performance.now();var t=e.ajaxStart,o=e.ajaxEnd-t,n=e.ajaxTime()+o;e.ajaxTime(n),$dyn.timeEnd("ajax"),e.log&&e.log("performance: ajax completed: %s, ajax total: %s, overall duration %s",o,n,e.ajaxEnd-e.startTime),e.ajaxStart=null,e.lastAjaxSegment={Name:$dyn.label("PerformanceTimer_ServerAction"),Duration:o,StartTime:t,Type:e.serverType},e.segments.push(e.lastAjaxSegment),e.inClient=!0,$dyn.time("client")}else e.log&&e.log("performance: ajax completed with pending ajax requests: %s",e.pendingAjaxRequests)},_ajaxResponse:function(e){var t=$dyn.ui.PerformanceTimer;if(e&&e.responseText){var o=e.responseText.length,n=t.bandwidth()+e.responseText.length;t.bandwidth(n),t.log&&t.log("performance: ajax content length: %s, total: %s",o,n)}},_startBlockingDiv:function(e){var t=$dyn.ui.PerformanceTimer;0==t.pendingBlockingDivRequests?(t.blockingDivStart=performance.now(),t.blockingDivTime=0,t.blockingDivDescription=e,t.log&&t.log("performance: blockingDiv %s started: duration since last end: %s",e,t.blockingDivStart-t.blockingDivEnd)):(t.blockingDivDescription+=", "+e,t.log&&t.log("performance: blockingDiv %s started with pending blockingDiv requests: %s",e,t.pendingBlockingDivRequests)),t.pendingBlockingDivRequests++},_stopBlockingDiv:function(){var e=$dyn.ui.PerformanceTimer;e.pendingBlockingDivRequests=0,e.blockingDivEnd=performance.now();var t=e.blockingDivEnd-e.blockingDivStart;e.blockingDivTime+=t,e.log&&e.log("performance: blockingDiv completed: %s",e.blockingDivTime)},_update:function(){var e=$dyn.ui.PerformanceTimer,t=performance.now(),o=t-e.startTime,n=o<e.trivialTime,i=t-e.ajaxEnd,r=e.ajaxTime(),a=e.blockingDivTime,s=e.blockingDivDescription||"BlockingDiv",l=o-r,u=e.action||$dyn.label("PerformanceTimer_ClientAction"),d={Duration:o,StartTime:e.startTime,Counters:[{Name:"PerformanceTimer_TotalClient",Value:l},{Name:"PerformanceTimer_TotalServer",Value:r}],SimpleAttributes:[{Name:"PerformanceTimer_Action",Value:u}],ajaxTime:r,currentClient:i,totalClient:l,size:e.bandwidth(),Name:u,ShortName:u,Label:"PerformanceTimer_TotalTime",handlerTimings:e.handlerTimings,Trivial:n,Steps:e.segments};if(e.segments=[],!n||0<r){if(e.timings().unshift(d),25<e.timings().length&&(e.timings().length=25),e.oppTiming(d),e.timings.valueChanged.raise(),e.log&&e.log("performance: overall: %s, ajax: %s, current client: %s, overall client: %s, size: %s, action: %s, browser session activity ID: %s, browser interation activity ID: %s",d.Duration,d.ajaxTime,d.currentClient,d.totalClient,d.size,d.Name,$dyn.browserActivity.BrowserSessionActivity.Id,$dyn.browserActivity.BrowserInteractionActivity.Id),$dyn.telemetry){var c=l-i;$dyn.telemetry.PerformanceTimer(c,r,i,u,e.ajaxActivityId,a,s)}e.duration(o),e.updateExpected&&e.updateExpected()}},_clientBusy:function(){var e=$dyn.ui.PerformanceTimer;$dyn.boot.booting||($dyn.clientBusy()?(e.log&&e.log("performance: client busy - begin tracking time"),$dyn.time("busy"),e.inClient=!0,$dyn.time("client"),e.startTime=e.clientStart=e.ajaxEnd=performance.now(),e.ajaxTime(0),e.bandwidth(0),e.actionSet={},e.action="",e.lastAjaxSegment=null,e.openedForm=!1,e.handlerTimings={},e.ajaxActivityId="",e.blockingDivTime=0,e.blockingDivDescription=""):(e.inClient&&(e.clientEnd=performance.now(),e.segments.push({Name:$dyn.label("PerformanceTimer_ClientAction"),Duration:e.clientEnd-e.clientStart,StartTime:e.clientStart,Type:e.clientType}),$dyn.timeEnd("client"),e.inClient=!1),e.log&&e.log("performance: client not busy - ending tracking times"),e._update(),e.actions(Object.keys(e.actionSet)),$dyn.timeEnd("busy")))},_addNavBarButton:function(){},_addAction:function(e){var t=$dyn.ui.PerformanceTimer;t.action?t.action+=" "+e:t.action=e},_getTimings:function(){var e=$dyn.ui.PerformanceTimer,t=e.timings;return e.timings=[],t},_logLastHandlerTimings:function(){var e=$dyn.ui.PerformanceTimer;console.table?console.table(e.timings[e.timings.length-1].handlerTimings):e.log&&e.log(e.timings[e.timings.length-1].handlerTimings)}},$dyn.clientBusy.valueChanged.subscribe($dyn.ui.PerformanceTimer._clientBusy),$(document).on("ajaxSuccess",function(e,t){$dyn.ui.PerformanceTimer._ajaxResponse(t)})),function(a){!function(e){var t,o,n;t=e.theme||(e.theme={}),o=null,t.get=function(){return o&&void 0!==o.accent||(o=function(){for(var e=[a.ui.theme._retrieveStylesFor("primaryColorsThemeInformation"),a.ui.theme._retrieveStylesFor("shadesOfGrayThemeInformation"),a.ui.theme._retrieveStylesFor("textColorsThemeInformation"),a.ui.theme._retrieveStylesFor("otherColorsPack1ThemeInformation"),a.ui.theme._retrieveStylesFor("otherColorsPack2ThemeInformation"),a.ui.theme._retrieveStylesFor("gridColorsThemeInformation"),a.ui.theme._retrieveStylesFor("appBarColorsThemeInformation"),a.ui.theme._retrieveStylesFor("chartThemeInformation"),a.ui.theme._retrieveStylesFor("unitsPack1ThemeInformation"),a.ui.theme._retrieveStylesFor("unitsPack2ThemeInformation"),a.ui.theme._retrieveStylesFor("fontsThemeInformation")],t={},o=0;o<e.length;o++){var n=e[o];for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}return t}()),o},t.getUnitValue=function(e){var t=a.ui.theme.get();if(t[e]){var o=t[e];return o.endsWith("px")&&(o=o.substring(0,o.length-2)),parseInt(o,10)}},t.invalidate=function(){o=null},t.getCssId=function(e){return a.densityThemeManager._getCssId(e,a.densityThemeManager._getCurrentDensity(),a.densityThemeManager._getCurrentTheme())},t.lighten=function(e,t){var o;e=0===(o=(o=e).toLowerCase()).indexOf("hsla(")?o:0===o.indexOf("hsl(")?o.replace("hsl(","hsla(").replace(")",",1)"):function(e){var t=e.r/255,o=e.g/255,n=e.b/255,i=Math.max(t,o,n),r=Math.min(t,o,n),a=i-r,s=i+r,l=0,u=0,d=s/2;if(0!=a){u=d<.5?a/s:a/(2-s);var c=((i-t)/6+i/2)/a,p=((i-o)/6+i/2)/a,h=((i-n)/6+i/2)/a;switch(i){case t:l=h-p;break;case o:l=1/3+(c-h);break;case n:l=2/3+(p-c)}l<0&&(l+=1),1<l&&--l,l=Math.round(360*l)}return u=Math.round(100*u),d=Math.round(100*d),"hsla({h},{s}%,{l}%,{a})".replace("{h}",l.toString()).replace("{s}",u.toString()).replace("{l}",d.toString()).replace("{a}",e.a.toString())}(function(e){if(0===(e=e.toLowerCase()).indexOf("#"))return 4===e.length&&(e="#"+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),{r:parseInt(e.substr(1,2),16),g:parseInt(e.substr(3,2),16),b:parseInt(e.substr(5,2),16),a:1};var t=/(\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d\.]+))?/.exec(e);return{r:parseInt(t[1]),g:parseInt(t[2]),b:parseInt(t[3]),a:null!=t[4]?parseFloat(t[4]):1}}(o));var n=/(.*,\s*)([\d\.%]+)(,.*)$/.exec(e),i=parseFloat(n[2])+parseFloat(t+"")+"%";return n[1]+i+n[3]},t._retrieveStylesFor=function t(o,n){void 0===n&&(n=0);var e=function(e){var t=document.getElementsByClassName(e);if(0<t.length)return getComputedStyle(t[0]);var o=document.createElement("div");return o.classList.add(e),o.style.display="none",document.body.appendChild(o),getComputedStyle(o)}(o),i=e.fontFamily;i=i.substring(1,e.fontFamily.length-1).replace(/\\'/g,"'").replace(/\\"/g,'"');try{return JSON.parse(i)}catch(e){return console.error("Unable to parse AX7 style as a JSON. Error message: ".concat(e.message)),console.debug(i),n<r?t(o,++n):(console.error("Retrieving styles failed."),{})}},(n=e.motionTiming||(e.motionTiming={}))[n.quickest=50]="quickest",n[n.quicker=100]="quicker",n[n.quick=167]="quick",n[n.basic=267]="basic",n[n.slow=750]="slow";var r=3}(a.ui||(a.ui={}))}($dyn=$dyn||{}),function(e){var t,o,n,i,r,a;t=e.ui||(e.ui={}),n=!0,r="disable-animation",a=i=null,(o=t.animation||(t.animation={})).enabled=e.computed(function(){return n},function(e){e?this.enableAnimation():this.disableAnimation()}),o.enableAnimation=function(){if(!n){n=!0,$.fx.off=!1;for(var e=document.getElementById(r);e;)e.remove(),e=document.getElementById(r)}},o.disableAnimation=function(){n&&(n=!1,$.fx.off=!0,i||((i=document.createElement("style")).id=r,i.type="text/css",i.innerText="*,*::before,*::after{                                -webkit-animation-duration: 0s !important;                                -webkit-transition-duration: 0s !important;                                -moz-animation-duration: 0s !important;                                -moz-transition-duration: 0s !important;                                -ms-animation-duration: 0s !important;                                -ms-transition-duration: 0s !important;                                -o-animation-duration: 0s !important;                                -o-transition-duration: 0s !important;                                animation-duration: 0s !important;                                transition-duration: 0s !important;                                -webkit-transition-delay: 0s !important;                                transition-delay: 0s !important;                                -webkit-animation-delay: 0s !important;                                animation-delay: 0s !important;                            }"),document.getElementsByTagName("head")[0].appendChild(i))},o.disableInputCursor=function(){a||((a=document.createElement("style")).id="disable-inputCursor",a.type="text/css",a.innerText="*{                            caret-color: transparent !important;                        }"),document.getElementsByTagName("head")[0].appendChild(a)},e.util.location.query.disableanimation&&(e.ui.animation.disableAnimation(),e.flags.disableAnimations=!0),"true"===e.util.location.query.enableFocusTooltip&&(e.flags.enableFocusTooltip=!0),e.util.location.query.disableFocusReactions&&(e.ui.animation.disableInputCursor(),e.flags.disableFocusReactions=!0,e.flags.enableFocusTooltip=!1)}($dyn=$dyn||{}),function(l){!function(a){a._npsUrlOrigin="",a._npsUserGuid="",a._npsPlatformVersionParameter="",a._npsApplicationVersionParameter="";var n="ccsctp.net";function i(){var r,e="".concat(a._npsUrlOrigin,"/display/").concat(l.shell.ProductId,"?culture=").concat(Globalize.culture().name,"&puid=").concat(a._npsUserGuid).concat(a._npsPlatformVersionParameter);$.ajax({beforeSend:function(){r=moment.now()},cache:!1,global:!1,type:"GET",url:e}).done(function(e){s(e.display)}).fail(function(e,t,o){l.logWarning(o)}).always(function(e,t,o){var n=moment.now()-r,i=JSON.stringify({duration:n,npsEndpoint:a._npsUrlOrigin,statusCode:null==o?void 0:o.status});l.telemetry.addActionEvent(l.telemetry.ActionEvents.custom,"nps",{extendedData:i,userDefined1:n},l.context(l.shell.getActiveForm()))})}function s(e){if(!0===e){var t="".concat(a._npsUrlOrigin,"/render/").concat(l.shell.ProductId,"?culture=").concat(Globalize.culture().name,"&puid=").concat(a._npsUserGuid).concat(a._npsPlatformVersionParameter).concat(a._npsApplicationVersionParameter),o=document.getElementById("npsServiceModal"),n=document.createElement("iframe");n.title=l.label("NPS_iFrameTitle"),n.id="npsServiceModaliFrame",n.src=t,n.className="npsServiceModaliFrame",window.addEventListener("message",l._npsHandler.ModalMessageHandler,!1),o.appendChild(n),o.style.display="block"}}a.init=function(){var e,t,o=!1;if(!l.flags.disableNPS&&l.user()&&l.user().UserGuid&&l.user().UserGuid()){if(t=l.value(null===(e=l.value(l.user))||void 0===e?void 0:e.Alias),o="string"==typeof t&&t.endsWith(n),a._npsUrlOrigin=l.value(l.user().NpsEndpoint),!a._npsUrlOrigin)return;a._npsUserGuid=l.user().UserGuid(),"dyntalent"!==l.shell.ProductId&&"dynrcs"!==l.shell.ProductId||(a._npsUserGuid=a._npsUserGuid.toLowerCase()),a._npsPlatformVersionParameter="&productVersion="+l.user().PlatformVersion(),a._npsApplicationVersionParameter="&custom="+encodeURIComponent(JSON.stringify({applicationVersion:l.user().AppVersion()})),"{"===a._npsUserGuid.charAt(0)&&"}"===a._npsUserGuid.charAt(a._npsUserGuid.length-1)&&(a._npsUserGuid=a._npsUserGuid.substr(1),a._npsUserGuid=a._npsUserGuid.substr(0,a._npsUserGuid.length-1)),l.restrictedNavigation||window.setTimeout(function(){l.util.location.query.forceNPS?s(!0):o||i()},3e4)}},a.CheckDisplayValid=i,a.DisplayDialog=s,a.ModalMessageHandler=function(e){var t=e.data||{};if(e&&e.origin&&!(l._npsHandler._npsUrlOrigin.indexOf(e.origin)<0))switch(t.msgType){case"closeNpsDialog":window.removeEventListener("message",l._npsHandler.ModalMessageHandler,!1);var o=document.getElementById("npsServiceModal"),n=document.getElementById("npsServiceModaliFrame");o&&(n&&o.removeChild(n),o.style.display="none");break;case"thankyouNpsDialog":var i=document.getElementById("npsServiceModaliFrame");i&&i.classList.add("npsThankYou")}}}(l._npsHandler||(l._npsHandler={}))}($dyn=$dyn||{}),function(){if($dyn.uwa=$dyn.uwa||{},$dyn.uwa.isUWA="undefined"!=typeof Windows&&void 0!==Windows.UI&&void 0!==Windows.ApplicationModel,$dyn.uwa.isUWA){$(document).ready(function(){o("AXSiteLoaded",!0),$dyn.observe($dyn.shell.canGoBack,function(e){var t=$dyn.value(e);o("ShowBackButton",t)})}),$dyn.uwa.openInExternalBrowser=function(e){o("ExternalUrl",e)};var o=function(e,t){var o={Type:e,Argument:t};window.external.notify(JSON.stringify(o))}}}();__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(y){var e,t,o;function n(){return null!==t&&t.apply(this,arguments)||this}Globalize.addCultureInfo("en",{messages:{Shell_ProcessingMessage:"Please wait. We're processing your request.",Shell_LeavingSession:"You might lose data that you haven't saved yet, and you might have to restart AX.",Shell_LeavingDebugIE:"For improved performance, it is recommended that this Internet Explorer instance be left open and debugging stopped from within Visual Studio. This is so future debug sessions will be able to re-use this instance of Internet Explorer.",Shell_BrowserTitleFormat:"{0} -- {1}",Shell_LoadingTitle:"Loading",Shell_AbortedNavigation:"The navigation request was canceled due to unfinished work on this form.",Shell_AbortedNavigationPopout:"Please fix all validation errors in open forms before navigating.",Shell_ClosedForm:"The page has been closed.",Shell_MultipleNotifications:"You have new messages.",Shell_HideNotificationPopup:"Close",Shell_PopupBlocked:"The window could not be opened. Please check your pop-up blocker settings and add an exception for Microsoft Dynamics 365 {0} ",Shell_D365ShortTitle:"Dynamics 365",Shell_OfficeWaffleTitle:"Office 365",Shell_OpenMessageCenter:"Open message center",Shell_OpenCompanyPicker:"Open company picker",Shell_MainFormContainer:"Go to main form container",Shell_GoHome:"Go to the dashboard",Shell_OpenTraceParser:"Open the trace parser",Shell_GoToNavBar:"Go to the navigation bar",Shell_OpenNavPane:"Open navigation pane",Shell_GoToNavPane:"Go to the navigation pane",Shell_CloseNavPane:"Close the navigation pane",Shell_OpenTaskRecorder:"Open the Task recorder pane",Shell_MoveFocusToTaskRecorder:"Move focus to the Task recorder pane",Shell_Splitter:"Splitter",NPS_iFrameTitle:"User satisfaction region"}}),e=y.controls||(y.controls={}),t=y.ui.Control,__extends(n,t),o=n,e.Shell=o,y.adapter({id:"NavBar",controlType:"Shell",template:"NavBar"}),y.adapter({id:"MessageCenterEmbedded",controlType:"Shell",template:"MessageCenterEmbedded"});var i,p,u,r,a,s,l,d,c,h={21:{viewportWidth:245,gutterWidth:33},30:{viewportWidth:320,gutterWidth:48}};(i=y.bindingHandlers||(y.bindingHandlers={})).FormViewportSize=function(){var o;return{apply:function(e,t){o||(o=e.bind(t),$(document.body).on(y.shell.formViewportSizeEvent,o))},dispose:function(){o&&$(document.body).off(y.shell.formViewportSizeEvent,o)}}},i.ShellViewportSize=function(){var o;return{apply:function(e,t){o=e,$(document.body).on(y.shell.shellViewportSizeEvent,o.bind(t))},dispose:function(){o&&$(document.body).off(y.shell.shellViewportSizeEvent,o)}}},i.ShellViewportWidthSize=function(){var o;return{apply:function(e,t){o=e,$(document.body).on(y.shell.shellViewportWidthSizeEvent,o.bind(t))},dispose:function(){o&&$(document.body).off(y.shell.shellViewportWidthSizeEvent,o)}}},$(window).on("resize",function(e){y.shell.pendingResize||window.setTimeout(function(){var e=!1;y.shell.viewportSizeChanged();var t=$(window).height();y.shell._lastWindowHeight!==t&&(y.shell._lastWindowHeight=t,e=!0);var o=$(window).width();for(var n in y.shell._lastWindowWidth!==o&&(y.shell._lastWindowWidth=o,e=!0),e&&y.layout.reflowRootForm(),y.shell.resizeHandlers){var i=y.shell.resizeHandlers[n];y.applyFunction(i.func,i.thisArg)}y.shell.pendingResize=!1},0),y.shell.pendingResize=!0}),y.user=y.observable(),y.company=y.observable(),y.activeForm=y.observable(),(p=y.shell||(y.shell={}))._nextId=1,p.stack=y.observableArray([]),p._currentStackIndex=-1,p._asidePaneStack=y.observableArray([]),p.dialogStack=y.observableArray([]),p.showModulesFlyout=y.observable(!1),p.clientInitialFormRequested=y.observable(!1),p._timerHandle=-1,p._shellBlockingCount=0,p._blockingTextAnimated=!1,p._blockingDivDescription="",p._blockingDivKeystrokeLossCount=0,p._blockingDivTextClearOutDelay=3e3,p._navigationCompleteEvent=null,p._shellReflowEvent=null,p._navBar=null,p._navigationPaneIsOpen=!1,p.isNavigationPanePinned=y.observable(!1),p.isSmallViewPort=y.observable(!1),p._extendedEventLoopCount=0,p._popstateLoopCount=0,p._popstateLoopCountResetId=null,p._noNavigationPane=!1,p._NoServerProductName="Finance and Operations",p._isSupportedBrowserVersion=y.observable(!1),p._isWorkspaceNavigationMode=y.observable(!1),p.formRenderingComplete=y.observable(!1),p.hasRestrictedInternet=y.observable(void 0),(r=u=p.CalledCommandButtonFunction||(p.CalledCommandButtonFunction={})).New="New",r.DeleteRecord="DeleteRecord",(a=p.QueryStringKeys||(p.QueryStringKeys={})).sessionKey="sid",a.companyKey="cmp",a.partitionKey="prt",a.languageKey="lng",a.themeKey="theme",a.densityKey="density",a.fromVS="vs",a.hideSplashKey="hidesplash",a.menuItem="mi",a.formName="f",a.limitedNav="limitednav",a.embedded="embedded",a.browserActivityKey="bid",a.activityKey="aid",a.expirationKey="exp",a.financialReportingViewerKey="financialreportingviewerquery",a.officeNavBarKey="officenavbar",a.pageType="pageType",p.isShellInitializing=y.observable(!1),p.rootPath="",p.buildThemeValue=0,p.isSingleThemed=null,p.hideSplash=!1,p.officeNavBarKey=!1,p.bodyFocusCorrection=!0,p.canUseLocalStorage=y.util.localStorageSupported(),p.isAsidePaneOpen=y.observable(!1),p.isTaskRecorderToolbarOpen=y.observable(!1),p.isPreProcessing=!1,p.isExiting=!1,p.isClosingOpenForms=!1,p.closingAllIndex=null,p.closingAllCallback=null,p.closingErrorCallback=null,p.closingAllCloseDashboard=!1,p.closingAllDestinationCompany=null,p.closingAllRetainCrumb=!1,p.queuedFocusCallbacks=[],p.blockingDivAllowedEvents=[],p.NavBarDocumentId="NavBar",p.MessageCenterEmbeddedId="MessageCenterEmbedded",p.CompanyDocumentId="Company",p.UserDocumentId="User",p.companyElement=null,p.processingTimer=1e3,p.CurrentFormViewportSize=null,p.CurrentShellViewPortSize=null,p.CurrentShellViewPortWidthSize=null,p.formViewportSizeEvent="viewportSizeEvent",p.shellViewportSizeEvent="shellViewportSizeEvent",p.shellViewportWidthSizeEvent="shellViewportWidthSizeEvent",p.FavIconUrl="",p.SplashScreenImageUrl="",p.SplashScreenAnimation="",p.ProductShortName=y.observable(""),p.ProductShortNameHelpText=y.observable(y.label("NavBar_GoToDashboard")),p.ProductName=y.observable(""),p.OperatedByName=y.observable(""),p.ProductId="",p._ariaLiveMessage="",p._ariaLiveMessageFireTimer=null,p._ariaLiveMessageDiv=null,p._ariaLiveMessagesAdded={},p.asidePaneWidth=y.observable(0),p.zoomModeWidth=y.observable(!1),p.zoomModeHeight=y.observable(!1),(s=p.ViewportSize||(p.ViewportSize={}))[s.Small=0]="Small",s[s.Medium=1]="Medium",s[s.Large=2]="Large",s[s.XLarge=3]="XLarge",(l=p.NavBarSizes||(p.NavBarSizes={}))[l.xsmallNavBarSize=400]="xsmallNavBarSize",l[l.smallNavBarSize=640]="smallNavBarSize",l[l.mediumNavBarSize=800]="mediumNavBarSize",l[l.largeNavBarSize=959]="largeNavBarSize",l[l.xlargeNavBarSize=1366]="xlargeNavBarSize",l[l.xxlargeNavBarSize=1920]="xxlargeNavBarSize",l[l.xxxlargeNavBarSize=2560]="xxxlargeNavBarSize",(d=p.ShellViewPortSizes||(p.ShellViewPortSizes={}))[d.xsmallScreenSize=320]="xsmallScreenSize",d[d.smallScreenSize=480]="smallScreenSize",d[d.mediumScreenSize=640]="mediumScreenSize",d[d.largeScreenSize=960]="largeScreenSize",d[d.xlargeScreenSize=1366]="xlargeScreenSize",d[d.xxlargeScreenSize=1920]="xxlargeScreenSize",d[d.xxxlargeScreenSize=2560]="xxxlargeScreenSize",(c=p.ShellViewPortHeightSizes||(p.ShellViewPortHeightSizes={}))[c.smallScreenSize=500]="smallScreenSize",p.CurrentViewportSizes=h[30],p.extendedEventLoopOn=y.observable(!1),p.openHelpPane=function(){},p.pack=function(){return{ProductName:y.value(y.shell.ProductName),OperatedByName:y.value(y.shell.OperatedByName)}},p.unpack=function(e){e&&(y.shell.ProductName(e.ProductName),y.shell.OperatedByName(e.OperatedByName))},p.buildHelpMenu=function(){y.restrictedNavigation||y.deferred.onTrue(function(){return y.value(y.shell.clientInitialFormRequested)}).done(function(){var e=y.ui.getNavBar();e&&(e.loadNavMenus(),e._getNavMenu("SysMenuHelp",e.helpMenu))})},p.addAriaAlertMessage=function(e){y.shell._ariaLiveMessagesAdded[e]||(y.shell._ariaLiveMessagesAdded[e]=!0,y.shell._ariaLiveMessageDiv||(y.shell._ariaLiveMessageDiv=document.getElementById("AriaAlertArea")),y.shell._ariaLiveMessageDiv&&(y.shell._ariaLiveMessage=y.shell._ariaLiveMessage+" "+e,y.shell._ariaLiveMessageFireTimer&&(window.clearTimeout(y.shell._ariaLiveMessageFireTimer),y.shell._ariaLiveMessageFireTimer=void 0),y.shell._ariaLiveMessageFireTimer||(y.shell._ariaLiveMessageFireTimer=window.setTimeout(function(){y.shell._ariaLiveMessageDiv&&y.shell._ariaLiveMessageDiv.textContent!==y.shell._ariaLiveMessage&&(y.shell._ariaLiveMessageDiv.textContent=y.shell._ariaLiveMessage),y.shell._ariaLiveMessage="",y.shell._ariaLiveMessageFireTimer=void 0,y.shell._ariaLiveMessagesAdded={}},y.shell._ariaLiveMessageFireTimerPreset))))},p.clearAriaAlertMessage=function(e){y.shell._ariaLiveMessagesAdded[e]?(y.shell._ariaLiveMessageDiv||(y.shell._ariaLiveMessageDiv=document.getElementById("AriaAlertArea")),y.shell._ariaLiveMessageDiv&&(y.shell._ariaLiveMessage="",y.shell._ariaLiveMessageDiv.textContent=y.shell._ariaLiveMessage)):(y.shell._ariaLiveMessageDiv||(y.shell._ariaLiveMessageDiv=document.getElementById("AriaAlertArea")),y.shell._ariaLiveMessageDiv&&y.shell._ariaLiveMessageDiv.textContent.trim()===e.trim()&&(y.shell._ariaLiveMessageDiv.textContent=""))},p.setControlLibraryCultureSettings=function(){if(ControlLibrary){var e=ControlLibrary.LocalizationManager.instance,t=Globalize.culture();e.setDateFormat(t.calendar.patterns.d),e.setTimeFormat(t.calendar.patterns.t),e.setDateTimeFormat("{1} {0}"),e.setNumberFormat(t.numberFormat),e.setTimeSeparator(t.calendar[":"]),e.setMonthNames(t.calendar.months),e.setDayNames(t.calendar.days);var o=y.util.getFirstDayNumber(t);e.setFirstDayOfWeek(o)}},p.controlLibMessagePrefix="ControlLib_",p.setControlLibraryMessages=function(){if(ControlLibrary){var e=y.shell.controlLibMessagePrefix.length,t=Globalize.culture().messages,o={};for(var n in t)n.startsWith(y.shell.controlLibMessagePrefix)&&(o[n.substring(e)]=t[n]);o.DateEdit_GoToToday=y.label("Input_DatePickerToday"),o.DatePicker_Clear=y.label("Input_DatePickerClear"),o.DatePicker_Month=y.label("Input_DatePickerMonthLabel"),o.DatePicker_NextMonthButton=y.label("Input_DatePickerNextMonth"),o.DatePicker_PreviousMonthButton=y.label("Input_DatePickerPreviousMonth"),o.DatePicker_Year=y.label("Input_DatePickerYearLabel"),o.Grid_TotalAverage=y.label("Grid_TotalAverage"),o.Grid_TotalMaximum=y.label("Grid_TotalMaximum"),o.Grid_TotalMinimum=y.label("Grid_TotalMinimum"),o.Grid_TotalSum=y.label("Grid_TotalSum"),o.GroupHeader_Collapse=y.label("Group_Collapse"),o.GroupHeader_Expand=y.label("Group_Expand"),ControlLibrary.LocalizationManager.instance.setMessages(o)}},p.setProductName=function(){y.util.isPreviewBuild()&&(y.shell.ProductShortName(y.value(y.shell.ProductShortName())+" "+y.label("Product_IsPreview")),y.shell.ProductName(y.value(y.shell.ProductName)+" "+y.label("Product_IsPreview")))},p.taskRecorderFocusHandler=function(){y.shell.updateActiveFocusRegion("TaskRecorderToolbar")},p.asidePaneFocusHandler=function(){y.shell.updateActiveFocusRegion("AsidePane")},p.mainPaneFocusHandler=function(){y.shell.updateActiveFocusRegion("MainPane")},p.updateActiveFocusRegion=function(e){y.shell._activeRegion=e},p.getActiveRegion=function(){return y.shell._activeRegion},p.updateProductNameItems=function(e){e&&(y.shell.ProductShortName(e),y.shell.BrowserTitleFormat=y.shell.BrowserTitleFormat+y.shell.ProductShortName(),y.htmlDocument.setMetaValue("application-name",y.shell.ProductShortName(),""))},p.loadAppSpecificItems=function(){function o(){y.appConfig&&("true"===y.appConfig.noNavigationPane&&(y.shell._noNavigationPane=!0),"Workspace"===y.appConfig.navigationMode&&(y.shell._isWorkspaceNavigationMode=!0),y.appConfig.appShortTitle&&y.shell.updateProductNameItems(y.appConfig.appShortTitle),y.appConfig.appTitle&&y.shell.ProductName(y.appConfig.appTitle),y.appConfig.appId&&(y.shell.ProductId=y.appConfig.appId),y.appConfig["msapplication-tooltip"]&&y.htmlDocument.setMetaValue("msapplication-tooltip",y.appConfig["msapplication-tooltip"],""),y.appConfig.images&&(y.appConfig.images.favIconUrl&&void 0===y.appConfig.images.favIconName&&(y.shell.FavIconUrl=y.appConfig.images.favIconUrl,y.htmlDocument.setFavicon(y.shell.FavIconUrl)),void 0===y.appConfig.images.tileImagesUrl&&(y.appConfig.images["msapplication-TileImage"]&&y.htmlDocument.setMetaValue("msapplication-TileImage",y.appConfig.images["msapplication-TileImage"],""),y.appConfig.images["apple-touch-icon"]&&y.htmlDocument.setLinkIconValue("apple-touch-icon",y.appConfig.images["apple-touch-icon"],"")))),document.title=y.shell.ProductShortName(),y.deferred.onTrue(function(){return y.value(y.shell.clientInitialFormRequested)}).done(function(){y.restrictedNavigation||y.shell._noNavigationPane?(y.shell.mainPane.classList.add("gutter-isHidden"),y.shell.mainPane.classList.remove("modulesPane-isPinned")):(y.DynReact.ModuleStore.getMenuPaneSettings(function(e){if(y.value(y.shell._isWorkspaceNavigationMode))y.shell.mainPane.classList.add("modulesPane-isWorkspaceMode");else{var t="1"===e;y.shell.CurrentShellViewPortSize===y.shell.ViewportSize.Small?y.value(y.shell.isNavigationPanePinned)&&y.shell.toggleIsNavigationPanePinned({skipSaveValue:!0}):y.value(y.shell.isNavigationPanePinned)!==t&&y.shell.toggleIsNavigationPanePinned({skipSaveValue:!0})}}),y.shell.isPhone&&!y.value(y.shell._isWorkspaceNavigationMode)&&y.shell.isNavigationPanePinned(!0),y.shell._modulesPaneElement=document.getElementsByClassName("modulesPane")[0],y.shell.viewportSizeChanged())})}"complete"===document.readyState||y.appConfig?o():(y.async.pending.increment("load listener"),window.addEventListener("load",function e(t){window.removeEventListener("load",e,!1),o(),y.async.pending.decrement("load listener")},!1))},p.startExtendedEventLoop=function(){y.shell._extendedEventLoopCount++,1===y.shell._extendedEventLoopCount&&y.shell.extendedEventLoopOn(!0)},p.endExtendedEventLoop=function(){0<y.shell._extendedEventLoopCount&&y.shell._extendedEventLoopCount--,0===y.shell._extendedEventLoopCount&&y.shell.extendedEventLoopOn(!1)},p.callCommandButtonFunction=function(e,t){var o,n=t.target;if(n&&(o=y.context(n)),o&&o.Root){var i=o.Root.element;if(i){var r=$(i).find('[data-dyn-role="List"]'),a=void 0;if(r&&o)for(var s=0;s<r.length;s++)if((a=y.context(r[s]))&&a.ServiceBoundary&&o.ServiceBoundary&&y.value(a.ServiceBoundary)===y.value(o.ServiceBoundary)){if(e===u.DeleteRecord&&!y.peek(a._syncManager.isQueueEmpty))break;if(e===u.New)break;a=null}else a=null;if(a){var l=a._renderer.getUserSelectedElement();e===u.New?a._newRecord(l)&&t&&(t.preventDefault(),t.stopPropagation()):e===u.DeleteRecord&&a._renderer.deleteRecord(l,t)}}}},p.cancelExtendedEventLoop=function(){y.shell._extendedEventLoopCount=0,y.shell.extendedEventLoopOn(!1)},p.giveNavBarFocus=function(){if(y.log.focus&&y.log.focus("Focus: Shell->Shortcuts(GiveNavBarFocus)"),y.ui.getNavBar().element.contains(document.activeElement)){var e=y.context(y.shell.getActiveForm());e&&(y.log.focus&&y.log.focus("Focus: Shell->Shortcuts(GiveNavBarFocus) return focus to form Id: %s calling takeNavigationFocus",e.Id),e.takeNavigationFocus())}else{var t=y.util.findFirstTabbableControl(y.ui.getNavBar().element);t&&(y.log.focus&&y.log.focus("Focus: Shell->Shortcuts(GiveNavBarFocus) focus nav bar"),t.focus())}},p.Shortcuts=__assign(__assign(__assign(__assign({IgnoreCtrlG:{Keys:{ctrl:!0,keyCode:y.ui.KeyCodes.letterG},Handler:function(e){return!0},Force:!0,ShowToUser:!1},GoToMessageCenter:{Keys:{ctrl:!0,shift:!0,keyCode:y.ui.KeyCodes.f7},Handler:function(e){y.restrictedNavigation&&!y.isEmbedded||(y.log.focus&&y.log.focus("Focus: Shell->Shortcuts(GoToMessageCenter)"),y.value(y.messaging.MessageCenterManager.notificationPopupVisible)?y.messaging.MessageCenterManager.FocusOnNotificationPopup():y.messaging.MessageCenterManager.messageCenterVisible(!0))},Description:y.label("Shell_OpenMessageCenter"),Category:y.ui.ShortcutCategory.Navigate}},!y.restrictedNavigation&&{GoToCompanyPicker:{Keys:{ctrl:!0,shift:!0,keyCode:y.ui.KeyCodes.letterO},Handler:function(){y.log.focus&&y.log.focus("Focus: Shell->Shortcuts(GoToCompanyPicker)"),y.shell.companyElement||(y.shell.companyElement=$(y.ui.getNavBar().element).find(".navigationBar-companyButton")[0]),y.shell.companyElement&&(y.log.focus&&y.log.focus("Focus: Shell->Shortcuts(GoToCompanyPicker) open company picker"),y.shell.companyElement.click())},Description:y.label("Shell_OpenCompanyPicker")}}),{GoToFormContainer:{ChordKeys:{alt:!0,keyCode:y.ui.KeyCodes.letterM},Keys:{keyCode:y.ui.KeyCodes.letterM},Handler:function(e){var t,o=y.context(y.shell.getActiveForm());o&&(null!==(t=y.ui.getNavBar())&&void 0!==t&&t.element.contains(e.target)?o.takeNavigationFocus():o.RestoreFocusToMainFormContainer())},Description:y.label("Shell_MainFormContainer"),Category:y.ui.ShortcutCategory.Navigate}}),!y.restrictedNavigation&&{GoToHome:{Keys:{alt:!0,shift:!0,keyCode:y.ui.KeyCodes.home},Handler:function(){y.ui.getNavBar().navigateToDashboard()},ShowToUser:function(){return!y.restrictedNavigation},Description:y.label("Shell_GoHome"),Category:y.ui.ShortcutCategory.Navigate},GoToTaskRecorder:{ChordKeys:{alt:!0,keyCode:y.ui.KeyCodes.letterR},Keys:{keyCode:y.ui.KeyCodes.letterO},Handler:function(){var e=!1;if(y.shell.isTaskRecorderOpen()||y.shell.isTaskRecorderGuideOpen()||y.value(y.ax.taskRecording.isRecording)?y.value(y.ax.taskRecording.isRecording)&&!y.shell.isTaskRecorderGuideOpen()?(y.ax.taskRecording.toolbarOpenPane(),e=!0):!y.shell.isTaskRecorderOpen()&&!y.shell.isTaskRecorderGuideOpen()||$(document.activeElement).parents().hasClass("asidePane")||(e=!0):(y.ax.taskRecording.open(),e=!0),e){if(document.querySelector('[data-dyn-form-name="TaskRecorderPane"]'))y.ax.taskRecording.setTaskRecorderFocus();else if(y.value(y.ax.taskRecording.isRecording)){var t=y.context(y.shell.getActiveAsideForm());t&&(y.log.focus&&y.log.focus("Focus: Shell->Shortcuts(GoToTaskRecorder) return focus to aside pane, form Id: %s calling takeNavigationFocus",t.Id),t.takeNavigationFocus())}else y.ax.taskRecording.setTaskGuideFocus()}else{var o=y.context(y.shell.getActiveForm());o&&(y.log.focus&&y.log.focus("Focus: Shell->Shortcuts(GoToTaskRecorder) return focus to form Id: %s calling takeNavigationFocus",o.Id),o.takeNavigationFocus())}},Description:function(){return y.shell.isTaskRecorderOpen()?y.label("Shell_MoveFocusToTaskRecorder"):y.label("Shell_OpenTaskRecorder")},Category:y.ui.ShortcutCategory.Navigate},GoToTracing:{Keys:{alt:!0,shift:!0,keyCode:y.ui.KeyCodes.letterT},Handler:function(){y.ax._tracing.open()},Description:y.label("Shell_OpenTraceParser"),Category:y.ui.ShortcutCategory.Navigate},GiveNavBarFocus:{ChordKeys:{alt:!0,keyCode:y.ui.KeyCodes.letterM},Keys:{keyCode:y.ui.KeyCodes.letterN},Handler:function(){y.shell.giveNavBarFocus()},Description:function(e){var t;return null!==(t=y.ui.getNavBar())&&void 0!==t&&t.element.contains(e)?y.label("Shell_MainFormContainer"):y.label("Shell_GoToNavBar")},Category:y.ui.ShortcutCategory.Navigate},GiveNavBarFocusAlt:{Keys:{alt:!0,shift:!0,keyCode:y.ui.KeyCodes.f1},Handler:function(){y.shell.giveNavBarFocus()},ShowToUser:!1},ToggleNavigationPaneState:{Keys:{alt:!0,keyCode:y.ui.KeyCodes.f1},Handler:function(e){if(y.value(y.shell._isWorkspaceNavigationMode)){!y.value(y.shell.isNavigationPanePinned)||y.shell.eventIsInNavigationPane(e)?y.shell.toggleIsNavigationPanePinned():y.shell._renderNavigationPane();var t=y.shell._modulesPaneElement.querySelector(".gutterPane-link");t&&t.focus(),y.log.focus&&y.log.focus("Focus: NavigationPane focused first navigation bar element.")}else y.shell._navigationPaneIsOpen?y.shell.eventIsInNavigationPane(e)?y.shell.toggleIsNavigationPanePinned():y.shell._renderNavigationPane():y.shell.setNavigationPaneIsOpen(!0)},Description:function(e){return y.value(y.shell._isWorkspaceNavigationMode)?y.value(y.shell.isNavigationPanePinned)?0===$(e).closest(".modulesPane").length?y.label("Shell_GoToNavPane"):y.label("Shell_CloseNavPane"):y.label("Shell_OpenNavPane"):y.shell._navigationPaneIsOpen?0===$(e).closest(".modulesPane").length?y.label("Shell_GoToNavPane"):y.label("Shell_CloseNavPane"):y.label("Shell_OpenNavPane")}}}),{FocusNextWhatsNew:{ChordKeys:{alt:!0,keyCode:y.ui.KeyCodes.letterM},Keys:{keyCode:y.ui.KeyCodes.letterC},Handler:function(){y.whatsNew.moveNextWhatsNewFocus()},ShowToUser:function(){return y.whatsNew.areWhatsNewShown()},Description:function(){return y.label("WhatsNew_ShortCutDescription")},Category:y.ui.ShortcutCategory.Navigate}}),p.loadBlockingDivs=function(){void 0===y.shell.blockingDiv&&(y.shell.blockingDiv=document.getElementById("ShellBlockingDiv"),y.shell.blockingDiv.style.display="none"),void 0===y.shell._shellProcessingDiv&&(y.shell._shellProcessingDiv=document.getElementById("ShellProcessingDiv"),y.shell._shellProcessingDiv.style.display="none")},p.init=function(){(y.debug.vs||y.util.location.query[y.shell.QueryStringKeys.hideSplashKey]||y.shell.isSingleThemed)&&(y.shell.hideSplash=!0,$("#splashScreen").css("visibility","hidden")),y.util.internetReachable(),y.layout.subscribeArrangeToLayout(),y.shell.subscribeAsidePaneToggle(),y.shell.browserInit(),y.shell.loadBlockingDivs(),y.shell.documentTitleInit(),y.shell.initializeUser(),y.shell.initializeUserSettingsFromURL(),y.shell.loadAppSpecificItems(),y.shell.initializeBrowserActivityFromURL(),y.shell.setContainersWithBorderRadius(),y.shell.setBodyLanguageMode(),y.shell.activateNavBar(),y.shell.setDeviceMode(),(y.shell.isSingleThemed||y.debug.settings)&&y.shell.displayFirstRendering(),window.addEventListener("focus",y.shell.onWindowFocus),window.addEventListener("blur",y.shell.onWindowBlur),document.body.addEventListener("selectstart",function(e){var t=e.target;t&&t.classList&&t.classList.contains("unselectable")&&(y.log.shell&&y.log.shell("Shell: Preventing focus of unselectable element: %s",t),e.preventDefault())}),$(document).on("ajaxError",function(e,t,o,n){n&&y.logWarning(n)}),y.shell._registerDensityChangeHandler(),(y.util.location.query[y.shell.QueryStringKeys.officeNavBarKey]||y.flags.officeNavBar)&&y.ui.getNavBar().OfficeNavBarVisible(!0)},Object.defineProperty(y.shell,"mainPane",{get:function(){return y.shell._mainPane||(y.shell._mainPane=document.querySelector("#mainPane")),y.shell._mainPane}}),Object.defineProperty(y.shell,"chordNotification",{get:function(){return y.shell._chordNotification||(y.shell._chordNotification=document.querySelector("#ChordNotification")),y.shell._chordNotification}}),p.subscribeWindowResize=function(e,t){y.shell.resizeHandlers||(y.shell.resizeHandlers={},y.shell._resizeHandlerId=0),y.shell._resizeHandlerId++;var o={func:e,thisArg:t};return y.shell.resizeHandlers[y.shell._resizeHandlerId]=o,y.shell._resizeHandlerId},p.unsubscribeWindowResize=function(e){y.shell.resizeHandlers&&delete y.shell.resizeHandlers[e]},p.clearBodyFocusCorrection=function(){var e=y.shell.bodyFocusCorrection;return y.shell.bodyFocusCorrection=!1,e},p.isActiveWindow=function(){return!y.serverForm||!y.serverForm._windowManager||y.serverForm._windowManager.isFocused()},p.onWindowFocus=function(){y.serverForm&&y.serverForm._windowManager&&y.serverForm._windowManager.focusWindow();for(var e=0,t=y.shell.queuedFocusCallbacks.length;e<t;e++)y.callFunction(y.shell.queuedFocusCallbacks[0].callback,y.shell.queuedFocusCallbacks[0].context,[y.shell.queuedFocusCallbacks[0].focusElement]),y.shell.queuedFocusCallbacks.splice(0,1);y.shell.overwrittenFocusCallback&&(y.callFunction(y.shell.overwrittenFocusCallback.callback,y.shell.overwrittenFocusCallback.context,[y.shell.overwrittenFocusCallback.focusElement]),y.shell.overwrittenFocusCallback=void 0)},p.onWindowBlur=function(){var e=document.activeElement,t=y.context(e);t&&t.updateValue&&!e.boundValueHandledBlur&&t.updateValue(!0)},p.displayFirstRendering=function(){if(y.shell._formRenderingObserver&&(y.shell._formRenderingObserver.dispose(),y.shell._formRenderingObserver=void 0),y.shell._formRenderingObserver=y.observe(y.shell.formRenderingComplete,function(e){e&&($("#mainContainer").css("visibility","visible"),y.shell.hideSplash?y.telemetry.addSessionBeginEvent():(y.shell.hideSplash=!0,$("#splashScreen").fadeOut(y.ui.motionTiming.quick,function(){y.telemetry.addSessionBeginEvent()})),y.deferred.onTrue(function(){return y.value(y.shell._isSupportedBrowserVersion)&&y.value(y.user)&&y.value(y.value(y.user).NpsEnabled)}).done(function(){y._npsHandler.init()}))}),y.ui.layout(!0),y.shell.isShellInitializing()){y.shell.isShellInitializing(!1),y.async.pending.decrement("Finished initializing isShellInitializing false");var e=y.context(y.shell.getActiveForm());e&&(y.log.focus&&y.log.focus("Focus: Shell->Finished initializing return focus"),e.setControlFocus(e.ActiveControl())),y.ui.layout(!1)}},p.setContainersWithBorderRadius=function(){-1===navigator.userAgent.indexOf("Trident/")?$(document.body).addClass("ContainersWithBorderRadius"):$(document.body).removeClass("ContainersWithBorderRadius")},p.setBodyLanguageMode=function(){var e=Globalize.culture().language;document.documentElement.lang=e,Globalize.culture().isRTL||y.debug.useRTL?($(document.body).removeClass("ltr"),document.documentElement.dir="rtl",$(document.body).addClass("rtl")):(document.documentElement.dir="ltr",$(document.body).addClass("ltr"),$(document.body).removeClass("rtl")),y.shell.optimizeCJKFonts(e)},p.optimizeCJKFonts=function(e){var t,o=document.getElementById("ms-dyn-cjkFontFace");switch(o&&document.head.removeChild(o),e){case"zh-CHS":t="local('Microsoft YaHei UI'), local('HeiTi SC'), local('Noto Sans CJK'), sans-serif";break;case"zh-Hant":t="local('Microsoft JhengHei UI'), local('HeiTi ST'), local('Noto Sans CJK'), sans-serif";break;case"ko":t="local('Malgun Gothic'), local('Apple Gothic'), local('Noto Sans CJK'), sans-serif";break;case"ja":t="local('Yu Gothic UI'), local('Mincho'), local('Noto Sans CJK'), local('Meiryo UI'), sans-serif"}if(t){(o=document.createElement("style")).setAttribute("id","ms-dyn-cjkFontFace");var n="@font-face {font-family: 'Segoe UI'; src: "+t+";font-style: normal;unicode-range: U+A5, U+4E00-9FFF, U+30??, U+FF00-FF9F; }";o.innerText=n,document.head.appendChild(o)}},p.joinArrayWithChevron=function(e){return"rtl"===document.documentElement.dir?e.reverse().join(" < "):e.join(" > ")},p.isFormRootOfEnhancedPreview=function(e,t){return e&&e.IsPreviewForm&&e.Root===t},p._registerDensityChangeHandler=function(){var e=y.value(y.user);if(e)return y.observe(e.Density,function(e){0<e&&(y.shell.CurrentViewportSizes=h[e.toString()],y.shell.viewportSizeChanged())})},p.viewportSizeChanged=function(t){var o,n,e,i,r=Math.max(document.documentElement.clientWidth||0),a=r-y.shell.CurrentViewportSizes.gutterWidth;y.shell._getViewPortSize=function(e){var t;return e<2?t=y.shell.ViewportSize.Small:2===e?t=y.shell.ViewportSize.Medium:3===e?t=y.shell.ViewportSize.Large:4<=e&&(t=y.shell.ViewportSize.XLarge),t},y.shell._shellViewPortSizeChanged=function(){var e=Math.floor(r/y.shell.CurrentViewportSizes.viewportWidth);return void 0===t&&e<2&&(y.shell.hideAsidePane(),t=!1),e=!0===(t=t||y.value(y.shell.isAsidePaneOpen))?e-Math.floor(y.shell._asidePane.offsetWidth/y.shell.CurrentViewportSizes.viewportWidth):e,n=y.shell._getViewPortSize(e),e},y.shell._formViewPortSizeChanged=function(){var e=Math.floor(a/y.shell.CurrentViewportSizes.viewportWidth);return e=!0===t?e-1:e,o=y.shell._getViewPortSize(e),e},e=y.shell._shellViewPortSizeChanged(),i=y.shell._formViewPortSizeChanged(),y.value(y.shell.isNavigationPanePinned)&&(e<2?y.value(y.shell._isWorkspaceNavigationMode)||y.shell.toggleIsNavigationPanePinned({skipSaveValue:!0}):(i--,o=y.shell._getViewPortSize(i))),y.shell._navigationPaneIsOpen&&!y.value(y.shell.isNavigationPanePinned)&&y.shell.setNavigationPaneIsOpen(!1),o!==y.shell.CurrentFormViewportSize&&(y.shell.CurrentFormViewportSize=o,$(document.body).trigger(y.shell.formViewportSizeEvent,o)),n!==y.shell.CurrentShellViewPortSize&&(y.shell.CurrentShellViewPortSize=n,$(document.body).trigger(y.shell.shellViewportSizeEvent,n),n===y.shell.ViewportSize.Small?y.shell.isSmallViewPort(!0):y.shell.isSmallViewPort(!1)),y.shell.CurrentShellViewPortWidthSize=r,y.shell._modulesPaneElement&&y.shell._renderNavigationPane(),y.util.isZoomSupported()&&(y.util.isInZoomWidthMode()?y.shell.zoomModeWidth(!0):y.shell.zoomModeWidth(!1),y.util.isInZoomHeightMode()?y.shell.zoomModeHeight(!0):y.shell.zoomModeHeight(!1)),$(document.body).trigger(y.shell.shellViewportWidthSizeEvent,r)},p.isFormRootOfNonFocusableActiveForm=function(e,t){var o=!1;if(e){var n=e.FindFocusTarget?e.FindFocusTarget():void 0;if(!e.TakeFocus&&n&&n.length&&n[0]){var i=y.context(n[0]);i&&(o=i.Root===t)}}return o},p.canFocus=function(e){if(!e)return y.log.focus&&y.log.focus("Focus: Shell->canFocus - form is falsy; return false "),!1;if((e.Part?e.Part():null)&&!e.TakeFocus)return y.log.focus&&y.log.focus("Focus: $dyn.shell.focus exiting early as the FormPart is in a TakeFocus === false hierarchy"),!1;var t=!0,o=y.context(y.shell.getActiveForm());return y.log.focus&&y.log.focus("Focus: Shell->canFocus - form trying to focus: %s active from: %s ",e.Id,o?o.Id:"none"),0<y.shell._shellBlockingCount&&(y.log.focus&&y.log.focus("Focus: Shell->canFocus - blocking div present"),t=!1),e.isNavigationActiveForm()||y.shell.isFormRootOfEnhancedPreview(o,e)||y.shell.isFormRootOfNonFocusableActiveForm(o,e)||(y.log.focus&&y.log.focus("Focus: Shell->canFocus - not active form"),t=!1,o&&o.focusFirstControl()),t},p.canOpenPreview=function(e){var t=!0,o=y.context(y.shell.getCurrentDialog());return o&&o!==e&&(t=!1),t},p.activateNavBar=function(){var e=document.getElementById(y.shell.NavBarDocumentId);e&&y.layout.arrange(e,!0)},p.setNavigationPaneIsOpen=function(e){y.shell._navigationPaneIsOpen=e,y.shell._renderNavigationPane()},p.toggleIsNavigationPanePinned=function(e){var t="modulesPane-isPinned";y.value(y.shell.isNavigationPanePinned)?(y.shell._navigationPaneIsOpen=!1,y.shell.mainPane.classList.remove(t)):y.shell.mainPane.classList.add(t),y.shell.isPhone?y.shell.isNavigationPanePinned(!0):y.shell.isNavigationPanePinned(!y.value(y.shell.isNavigationPanePinned)),y.shell._renderNavigationPane(),e&&e.skipSaveValue||y.DynReact.ModuleStore.saveMenuPaneSettings(y.shell._navigationPaneIsOpen),y.shell._handleTransitions()},p._handleTransitions=function(){var t=function(e){$(e.target).is(".primaryConductor")&&"left"===e.originalEvent.propertyName&&($(window).trigger("resize"),$(window).off("transitionend",t))};$(window).on("transitionend",t)},p.eventIsInNavigationPane=function(e){var t=!1;return(y.shell._navigationPaneIsOpen||y.value(y.shell.isNavigationPanePinned)||y.value(y.shell._isWorkspaceNavigationMode))&&(t=!!(e&&e.target&&$(e.target).closest(".modulesPane").length)),t},p._renderNavigationPane=function(){if(!y.restrictedNavigation&&!y.shell._noNavigationPane&&y.shell._modulesPaneElement){var e=y.value(y.shell.isAsidePaneOpen)?y.shell.CurrentViewportSizes.viewportWidth:0;!(y.shell.CurrentShellViewPortWidthSize<=y.shell.NavBarSizes.smallNavBarSize+e)||y.shell._navigationPaneIsOpen?y.shell._modulesPaneElement.style.display="block":y.shell._modulesPaneElement.style.display="none",ReactDOM&&ReactDOM.render(React.createElement(y.DynReact.UI.ModulesPane,{PaneIsPinned:y.value(y.shell.isNavigationPanePinned),ToggleIsPinned:y.shell.toggleIsNavigationPanePinned,paneIsExpanded:y.shell._navigationPaneIsOpen,setIsExpanded:y.shell.setNavigationPaneIsOpen,ViewportSize:y.shell.isPhone||y.shell._isPhoneSize?y.shell.ViewportSize.Small:y.shell.CurrentShellViewPortSize,navigationModeIsWorkspace:y.value(y.shell._isWorkspaceNavigationMode),isPhoneDevice:y.shell.isPhone||y.shell._isPhoneSize}),y.shell._modulesPaneElement)}},p.browserInit=function(){y.shell.browserHistory.initialState(),y.shell.browserHistory.init(),y.shell.resetAsidePane(!0),document.addEventListener("mousedown",function(){y.ui.isInChordMode&&($(y.shell.chordNotification).text("").hide(),y.ui.isInChordMode=!1,y.ui.chordKeysPressed=null)},!0),$("#mainPane").focusin(y.shell.mainPaneFocusHandler),$(document).on("keydown",function(e){if(e.ctrlKey&&116===e.which&&(y.flags.confirmExit=!1),!y.util.isShortcutKeyPressed(e,{keyCode:y.ui.KeyCodes.esc})||!y.shell.isAsidePaneOpen()||y.shell.isTaskRecorderOpen()&&y.value(y.ax.taskRecording.isRecording)||e&&$(e.target).closest(".modulesPane").length){var t;y.context(e.target)&&(t=y.context(e.target).Root);var o=t||y.context(y.shell.getActiveForm());if(o&&!y.shell.disableShortcuts&&e.target!==document.body&&o.keydown&&o.keydown(e),!e.isPropagationStopped()&&(y.util.handleShortcuts(y.shell,e),!e.isPropagationStopped()&&e.which!==y.ui.KeyCodes.shift&&e.which!==y.ui.KeyCodes.ctrl&&e.which!==y.ui.KeyCodes.alt&&y.ui.isInChordMode)){var n=y.util.getTextFromKeysObject(y.ui.chordKeysPressed)+", "+y.util.getTextFromKeydownEvent(e);$(y.shell.chordNotification).text(y.format(y.label("Framework_InvalidKeyCombo"),n)),window.setTimeout(function(){$(y.shell.chordNotification).text("").hide()},5e3),y.ui.isInChordMode=!1,y.ui.chordKeysPressed=null,e.stopPropagation(),e.preventDefault()}}else y.shell.resetAsidePane(!1)})},p.documentTitleInit=function(){y.observe(y.shell.primaryForm,function(e){e&&(y.shell._formCaptionObserver=y.observe(e.FormCaption,function(e){e?y.shell.primaryFormCaption(e):y.shell.primaryFormCaption(y.shell.ProductShortName())},null,y.shell._formCaptionObserver))}),y.observe(y.options({caption:y.shell.primaryFormCaption},y.async.pending),function(e){y.shell.browserHistory.newStatePending()||y.shell.browserHistory.waitForPopStateHandler()||y.shell.setDocumentTitle(e.caption)})},p.initializeUser=function(){var e=document.getElementById(y.shell.UserDocumentId),t=y.context(e);t.element=e,y.densityThemeManager._getCurrentLocalTheme(),"PopoutUser"===y.shell.UserDocumentId&&(y.setValue(t,"Density",y.densityThemeManager._previousDensity),y.setValue(t,"Theme",y.densityThemeManager._previousTheme)),y.user(t),y.deferred.onTrue(function(){return!(!y.value(y.user)||!y.value(y.value(y.user).UserName))}).done(function(){y.user().setUserAvatar()}),y.user()&&(y.user().addFlightChangeListener(y.reactGrid.featureName,y.reactGrid.featureValueChange),y.user().addFlightChangeListener(y.ui.LegacyNavBarFeatureName,y.ui.legacyNavBarChanged),y.user().addFlightChangeListener(y.util.CLIAllowFullPageTabbingFeature,y.ui.allowFullPageTabbingFeatureChanged));var o=document.getElementById(y.shell.CompanyDocumentId),n=y.context(o);y.company(n)},p.isProcessing=function(){return 0<y.shell._shellBlockingCount||y.async.IsClientProcessing()},p._shellBlockingDivKeydown=function(e){y.logError("Keydown event was eaten by the blocking div."),y.shell._blockingDivKeystrokeLossCount++},p.blockingDivKeydown=function(e){y.util.isShortcutKeyPressed(e,{ctrl:!0,keyCode:y.ui.KeyCodes.f5})||y.util.isShortcutKeyPressed(e,{ctrl:!1,keyCode:y.ui.KeyCodes.f5})||y.util.isShortcutKeyPressed(e,{keyCode:y.ui.KeyCodes.f12})||(y.shell._shellBlockingDivKeydown(e),y.shell.animateBlockingText(e))},p._addTelemetryForBlockingDivKeyDown=function(){y.shell._keystrokeLossEventArgs=y.telemetry.addControlActionEvent({Name:"BlockingDiv"},y.shell._keystrokeLossEventArgs,y.telemetry.ActionEvents.keystrokeLoss,{userDefined1:y.shell._blockingDivKeystrokeLossCount,extendedData:y.shell._blockingDivDescription}),y.shell._blockingDivKeystrokeLossCount=0},p.blockUserInteraction=function(e){window.setTimeout(function(){y.shell._shellBlockingCount++,y.log.blockUserInteraction&&y.log.blockUserInteraction("BlockUserInteraction: Shell->blockUserInteraction - _shellBlockingCount: %d",y.shell._shellBlockingCount),y.shell.blockUserInteractionInternal(e)},100)},p.blockUserInteractionNoWait=function(e){y.shell._shellBlockingCount++,y.log.blockUserInteraction&&y.log.blockUserInteraction("BlockUserInteraction: Shell->blockUserInteractionNoWait - _shellBlockingCount: %d",y.shell._shellBlockingCount),y.shell.blockUserInteractionInternal(e)},p._blockLeavingWaiting=function(e){var t,o;if(y.log.stopPropagation&&y.log.stopPropagation("Shell: blockLeavingWaiting / stopPropagation"),e.preventDefault(),e.stopImmediatePropagation(),e.relatedTarget){var n=null===(o=null===(t=y.context(e.relatedTarget))||void 0===t?void 0:t.Root)||void 0===o?void 0:o.Id;y.shell.updateFocusableElement({element:e.relatedTarget,formId:n,selectionStart:y.ui.selectionStart(e.relatedTarget),selectionEnd:y.ui.selectionEnd(e.relatedTarget)})}y.shell.blockingDiv.focus()},p.blockUserInteractionInternal=function(e){if(e&&(y.shell._blockingDivDescription=e),0<y.shell._shellBlockingCount&&y.shell.blockingDiv){if(y.ui.PerformanceTimer&&y.ui.PerformanceTimer._startBlockingDiv&&y.ui.PerformanceTimer._startBlockingDiv(e),!y.shell._shellBlockingDivAriaBusyElement&&y.shell.getActiveForm()&&(y.shell._shellBlockingDivAriaBusyElement=y.shell.getActiveForm().parentNode),y.shell._shellBlockingDivAriaBusyElement&&y.shell._shellBlockingDivAriaBusyElement.setAttribute("aria-busy","true"),y.shell.blockingDiv.style.display="",y.shell._blockingTextAnimated=!1,y.shell.blockingDiv&&1===y.shell._shellBlockingCount){y.shell.focusCallback(function(){var e=document.activeElement;if(null!==(null==e?void 0:e.getAttribute("aria-activedescendant"))&&e.parentElement&&null!==e.parentElement.getAttribute("aria-owns")){var t=e.parentElement.getAttribute("aria-owns");""!==t?e.parentElement.setAttribute("aria-owns","ShellBlockingDiv "+t):e.parentElement.setAttribute("aria-owns","ShellBlockingDiv")}var o=y.context(y.shell.getActiveForm());if(o){var n=y.ui.removeFocus($(o.element));n&&(n.formId=o.Id,y.shell.updateFocusableElement(n))}y.shell.blockingDiv.focus(),y.log.blockUserInteraction&&y.log.blockUserInteraction("BlockUserInteraction: Shell->blockUserInteractionInternal - force the div to have focus"),y.shell.blockingDiv.addEventListener("focusout",y.shell._blockLeavingWaiting)},y.shell,null,{overwrite:!0})}-1===y.shell._timerHandle&&(y.shell._timerHandle=window.setTimeout(function(){y.shell.blockingDiv&&"none"!==y.shell.blockingDiv.style.display&&(y.shell._blockingTextAnimated||y.shell.animateBlockingText())},y.shell.processingTimer))}},p.updateFocusableElement=function(e){if(y.log.blockUserInteraction&&y.log.blockUserInteraction("BlockUserInteraction: Shell->updateFocusableElement - %o",e),y.shell._oldFocusedControlOptions=e,y.shell._oldFocusedControlOptions){y.shell._oldFocusedControlOptions.formId=e.formId;var t=$(y.shell._oldFocusedControlOptions.element).closest("[data-dyn-controlname]");y.shell._oldFocusedControlOptions.controlName=t.length?t[0].getAttribute("data-dyn-controlname"):""}},p.unBlockUserInteractionInternal=function(){if(y.log.blockUserInteraction&&y.log.blockUserInteraction("BlockUserInteraction: Shell->unBlockUserInteraction - remove div and reset focus"),y.shell._shellProcessingDiv&&(y.shell._shellProcessingDiv.style.display="none",y.shell._shellProcessingDiv.classList.remove("statusBarIn")),y.shell.blockingDiv&&(y.shell.blockingDiv.removeEventListener("focusout",y.shell._blockLeavingWaiting),y.shell.blockingDiv.style.display="none",y.shell._blockingTextAnimated&&(y.shell._blockingTextAnimated=!1,window.setTimeout(function(){y.shell.clearAriaAlertMessage(y.label("Shell_ProcessingMessage"))},y.shell._blockingDivTextClearOutDelay))),!y.shell.isShellInitializing()){y.shell.focusCallback(function(){var e,t=y.ui.getNavBar();if(null!==(e=y.shell._oldFocusedControlOptions)&&void 0!==e&&e.element&&null!=t&&t.element&&$.contains(t.element,y.shell._oldFocusedControlOptions.element))y.log.focus&&y.log.focus("Focus: Shell->unBlockUserInteraction return focus to navbar element: %o",y.shell._oldFocusedControlOptions.element),y.shell._oldFocusedControlOptions.element.focus(),y.microTask(function(){y.shell._oldFocusedControlOptions&&y.shell._oldFocusedControlOptions.element&&document.activeElement&&document.activeElement.value&&document.activeElement===y.shell._oldFocusedControlOptions.element&&(y.ui.selectionStart(document.activeElement,y.shell._oldFocusedControlOptions.selectionStart),y.ui.selectionEnd(document.activeElement,y.shell._oldFocusedControlOptions.selectionEnd)),y.shell._oldFocusedControlOptions=null});else{var o=y.context(y.shell.getActiveForm());if(o){if(y.log.focus&&y.log.focus("Focus: Shell->unBlockUserInteraction return focus form Id: %s calling takeNavigationFocus",o.Id),o.takeNavigationFocus(),o.focusedControl&&null!==o.focusedControl.getAttribute("aria-owns")){var n=o.focusedControl.getAttribute("aria-owns");"ShellBlockingDiv"===n?o.focusedControl.setAttribute("aria-owns",n.replace("ShellBlockingDiv","")):o.focusedControl.setAttribute("aria-owns",n.replace("ShellBlockingDiv ",""))}y.microTask(function(){y.shell._oldFocusedControlOptions&&y.shell._oldFocusedControlOptions.formId===o.Id&&y.shell._oldFocusedControlOptions.controlName===y.value(o.ActiveControl)&&document.activeElement&&document.activeElement.value&&(y.ui.selectionStart(document.activeElement,y.shell._oldFocusedControlOptions.selectionStart),y.ui.selectionEnd(document.activeElement,y.shell._oldFocusedControlOptions.selectionEnd)),y.shell._oldFocusedControlOptions=null})}}},y.shell,null,{overwrite:!0})}window.clearTimeout(y.shell._timerHandle),y.shell._timerHandle=-1,0<y.shell._blockingDivKeystrokeLossCount&&y.shell._addTelemetryForBlockingDivKeyDown(),y.shell._shellBlockingDivAriaBusyElement&&y.shell._shellBlockingDivAriaBusyElement.setAttribute("aria-busy","false"),y.ui.PerformanceTimer&&y.ui.PerformanceTimer._stopBlockingDiv&&y.ui.PerformanceTimer._stopBlockingDiv()},p.unBlockUserInteraction=function(){0===y.shell._shellBlockingCount?y.logError("Attempted to decrement the shell blocking count below 0."):(y.shell._shellBlockingCount--,y.log.blockUserInteraction&&y.log.blockUserInteraction("BlockUserInteraction: Shell->unBlockUserInteraction - _shellBlockingCount: %d",y.shell._shellBlockingCount)),0===y.shell._shellBlockingCount&&y.shell.unBlockUserInteractionInternal()},p.forceUnBlockUserInteraction=function(){y.logError("Resetting the shell blocking count to 0."),y.shell._shellBlockingCount=0,y.serverForm&&y.serverForm.interactionManager.resetGlobalBlockingFlag(),y.shell.unBlockUserInteractionInternal()},p.focusCallback=function(e,t,o,n){y.shell.isActiveWindow()?y.callFunction(e,t,[o]):n.overwrite?(y.log.focus&&y.log.focus("Focus: overwritten focus callback was set up"),y.shell.overwrittenFocusCallback={callback:e,context:t,focusElement:o}):n.queue&&(y.log.focus&&y.log.focus("Focus: control focus callback was added to the queue"),y.shell.queuedFocusCallbacks.push({callback:e,context:t,focusElement:o}))},p.animateBlockingText=function(e){e&&(e.stopImmediatePropagation(),e.preventDefault()),!y.shell._blockingTextAnimated&&y.shell.hideSplash&&y.shell._shellProcessingDiv&&(y.shell._shellProcessingDiv.style.display="",y.shell._shellProcessingDiv.classList.add("statusBarIn"),y.shell.addAriaAlertMessage(y.label("Shell_ProcessingMessage")),y.shell._blockingTextAnimated=!0)},p.initialForm=function(){var e=y.shell.defaultForm;if(y.flags.enableResources){var t=y.util.location.query;if(t.resource){/^[a-z_][a-z0-9_]*$/i.test(t.resource)&&(e={resource:(y.url(t.resource)+".htm").toLowerCase(),templateId:t.resource.toLowerCase()})}}return e},p.open=function(e){var t=e.form;if(void 0!==t){var o=y.value(t.DisplayTarget),n=t.TypeName;if(o===y.forms.DisplayTarget.Hidden)t._openedDisplayTarget=y.forms.DisplayTarget.Hidden;else{switch(n){case"Dialog":case"LightBox":o===y.forms.DisplayTarget.AsidePane?(t.shouldDisplayHelpIcon(!1),t.shouldDisplayCopilotIcon(!1),y.shell.showAside({targetElement:t.element}),t._openedDisplayTarget=y.forms.DisplayTarget.AsidePane):y.shell.dialog({typeName:n,targetElement:t.element});break;case"Form":y.shell.navigate({targetElement:t.element});break;case"Popup":case"DropDialogPopup":case"PartForm":case"FactBoxForm":break;default:y.log.navigation&&y.log.navigation("shell.open() -> unknown form type: "+n)}t.Open&&t.Open()}}else y.log.navigation&&y.log.navigation("shell.open() -> no form")},p.close=function(e){var t=e.form;if(void 0!==t){y.log.navigation&&y.log.navigation("Navigation: shell.close: "+t._formName);var o=t.TypeName;if(y.whatsNew.closeTipsForForm(t._formName),t._openedDisplayTarget===y.forms.DisplayTarget.Hidden)y.shell._removeForm(t.element);else{switch(o){case"Dialog":case"LightBox":if(t.onClose.raise(),t._openedDisplayTarget===y.forms.DisplayTarget.AsidePane)y.shell.removeFromAside({targetElement:t.element});else y.shell.previewManager.removePreview(),t.IsLightBox||y.flyout.flyoutManager.removeAllFlyoutsAsync(),y.shell.activeMessageBox=void 0,y.shell.dialogBack({element:t.element})&&t.IsOpen(!1);break;case"Form":t.onClose.raise(),y.shell.previewManager.removePreview(),y.flyout.flyoutManager.removeAllFlyoutsAsync(),y.shell.removePrimaryForm({targetElement:t.element});break;case"PartForm":case"FactBoxForm":y.shell.previewManager.removePreview(),y.flyout.flyoutManager.removeAllFlyoutsAsync(),y.shell._removeForm(t.element);break;case"Popup":case"DropDialogPopup":t.onClose.raise(),y.shell.previewManager.removePreview(),y.flyout.flyoutManager.removeFlyoutByElementId(t.element.id),y.getFunction(t.element.dynClose)(),y.shell._removeForm(t.element);break;default:t.element&&y.shell._removeForm(t.element),y.log.navigation&&y.log.navigation("shell.close() -> unknown form type: "+o)}t.element&&t.element.dynReadyState&&t.element.dynReadyState(y.ui.ReadyState.closed),t._close&&t._close()}}else y.log.navigation&&y.log.navigation("shell.close() -> no form")},p.dialog=function(o){var e,n=y.context(y.shell.getCurrentRootForm()),t="Dialog"===o.role||"LightBox"===o.typeName;e=t?y.shell.dialogStack:(n||(n=y.shell.getPlaceholderForm(),y.shell.navigate({targetElement:n.element})),n.dialogStack);var i=y.length(e),r=e()[i-1];r!==o.targetElement&&y.shell.deactivateElement(r,{doNotHide:!0});var a=y.context(o.targetElement);if(a.canGoBack(o.canGoBack||0<y.length(e)),void 0!==o.back&&(a.back=o.back),y.shell.isClosingOpenForms){var s=y.value(y.shell.stack)[y.shell.closingAllIndex+1];if(s){s.style.display="";var l=y.context(s);if(l){var u=y.length(l.dialogStack);u&&(y.value(l.dialogStack)[u-1].style.display="")}}}function d(){y.shell.activateElement(o.targetElement,{forceActivation:t}),n&&y.shell._placeholderForm&&n===y.shell._placeholderForm&&!p.activeFormObserver&&(p.activeFormObserver=y.observe(y.activeForm,function(e){return y.shell._placeholderForm?e===y.shell._placeholderForm.element?(y.shell.close({form:y.shell._placeholderForm}),p.activeFormObserver=void 0,y.shell._placeholderForm=void 0,!1):void 0:(p.activeFormObserver=void 0,!1)}))}if(y.shell.mainPane.appendChild(o.targetElement),e.push(o.targetElement),n&&n.PendingGrid&&n.PendingGrid.syncManager&&!y.value(y.clientInError)?n.PendingGrid.syncManager.setResumeCallback(function(){d();var e=y.context(o.targetElement);if(e&&e.onClose)var t=e.onClose.subscribe(function(){n&&n.PendingGrid&&n.PendingGrid.syncManager&&n.PendingGrid.syncManager.resumeCallbackComplete(),e.onClose.unsubscribe(t)})}):d(),t){var c=function(e){y.debug.verboseStopPropagation&&y.log("shell.dialog() -> MessageBox stopPropagation"),e.stopImmediatePropagation()};"LightBox"===o.typeName&&$(o.targetElement).find(".titleField").attr("id","titleField"),$(o.targetElement).find(".popupShadow").on("click",c),$(o.targetElement).find(".popupShadow").on("keydown",function(e){if(o.targetElement.contains(e.target)){var t=y.context(o.targetElement);t&&t.keydown&&t.keydown(e)}c(e)})}o.targetElement.dynReadyState()===y.ui.ReadyState.uninitialized&&o.targetElement.dynReadyState(y.ui.ReadyState.ready),!t&&n&&y.shell.resetShellOnNavigation()},p.showAside=function(e){if(e.targetElement){y.log.navigation&&y.log.navigation("Navigation: Opening form in the aside pane.");var t=e.targetElement;if(y.shell._asidePane?y.shell._asidePaneResizeHandle&&!y.value(y.shell.isSmallViewPort)&&(y.shell._asidePaneResizeHandle.style.display="block"):(y.shell._asidePane=$("#asidePane")[0]||document.body,y.dataBind(y.shell._asidePane),y.shell._asidePane.getElementsByClassName("ui-resizable-handle")[0]&&(y.shell._asidePaneResizeHandle=y.shell._asidePane.getElementsByClassName("ui-resizable-handle")[0])),y.shell._asidePane.classList.add("expanded"),y.shell._asidePane.style.width=y.value(y.shell.isSmallViewPort)||0===y.value(y.shell.asidePaneWidth)?null:"".concat(y.value(y.shell.asidePaneWidth),"px"),y.shell._asidePaneCurrentContent!==t){1<y.shell._asidePane.children.length&&(y.context(y.shell._asidePane.children[1]).onHide(null),y.shell._asidePane.removeChild(y.shell._asidePane.children[1]),y.shell._asidePaneCurrentContent=null);var o=y.peek(y.shell._asidePaneStack).lastIndexOf(t);0<=o&&o<y.shell._asidePaneStack.len-1&&y.shell._asidePaneStack.splice(o,1),y.shell._asidePaneStack.push(t);var n=y.context(t);if(void 0===n.onHide&&(n.onHide=y.observable()),n.onHide(function(){y.shell.hideAsidePane(t)}),y.shell._asidePane.appendChild(t),y.shell._asidePaneCurrentContent=t,n.IsActive(!0),y.shell.updateActiveFocusRegion("AsidePane"),y.shell.isAsidePaneOpen(!0),t.style.display="",y.applyFunction(n.takeNavigationFocus,n),t.dynReadyState()===y.ui.ReadyState.aborted||t.dynReadyState()!==y.ui.ReadyState.uninitialized&&t.dynReadyState()!==y.ui.ReadyState.loading||t.dynReadyState(y.ui.ReadyState.ready),!y.value(y.shell.isSmallViewPort)){var i=function(e){var t=y.value(e.PersonalizedWidth);t&&t!==y.shell.asidePaneWidth()&&y.ui.layoutBlock(function(){y.shell._asidePane.style.width="".concat(t,"px"),y.shell.asidePaneWidth(t),y.layout.reflowRootForm()})};y.shell.isClientDefinedAsideForm(t)?y.shell.resizeAsideAfterWait(t,i):i(y.context(t))}}}},p.removeFromAside=function(e){if(e&&e.targetElement){var t=e.targetElement;if(y.shell._asidePaneCurrentContent===t){var o=y.peek(y.shell._asidePaneStack);1<o.length?y.shell.showAside({targetElement:o[o.length-2]}):(y.context(t).onHide(null),y.shell._asidePane.removeChild(t),y.shell._asidePaneCurrentContent=null,y.shell.isAsidePaneOpen(!1))}var n=y.peek(y.shell._asidePaneStack).lastIndexOf(t);0<=n&&y.shell._asidePaneStack.splice(n,1),y.shell._removeForm(t)}},p.getActiveAsideForm=function(){var e=y.value(y.shell._asidePaneStack);return 0<e.length?e[e.length-1]:null},p.getAsideFormChildForm=function(e){var t,o,n,i,r,a,s=null,l=null;return e===(null===(o=null===(t=y.ax.helpPane)||void 0===t?void 0:t.pane)||void 0===o?void 0:o.targetElement)?l=y.ax.helpPane.getPart():e===(null===(i=null===(n=y.ax.taskRecording)||void 0===n?void 0:n.pane)||void 0===i?void 0:i.targetElement)?l=y.ax.taskRecording.getPart():e===(null===(a=null===(r=y.ax.appDesigner)||void 0===r?void 0:r.pane)||void 0===a?void 0:a.targetElement)&&(l=y.ax.appDesigner.getPart()),l&&(s=(s=l.PartForm)||l.getChildForms()[0]),s},p.isClientDefinedAsideForm=function(e){var t,o,n,i,r,a;return e===(null===(o=null===(t=y.ax.helpPane)||void 0===t?void 0:t.pane)||void 0===o?void 0:o.targetElement)||e===(null===(i=null===(n=y.ax.taskRecording)||void 0===n?void 0:n.pane)||void 0===i?void 0:i.targetElement)||e===(null===(a=null===(r=y.ax.appDesigner)||void 0===r?void 0:r.pane)||void 0===a?void 0:a.targetElement)},p.resizeAsideAfterWait=function(o,n){var e,t,i,r,a,s,l;o===(null===(t=null===(e=y.ax.helpPane)||void 0===e?void 0:e.pane)||void 0===t?void 0:t.targetElement)?l=y.ax.helpPane.paneIsOpen:o===(null===(r=null===(i=y.ax.taskRecording)||void 0===i?void 0:i.pane)||void 0===r?void 0:r.targetElement)?l=y.ax.taskRecording.paneIsOpen:o===(null===(s=null===(a=y.ax.appDesigner)||void 0===a?void 0:a.pane)||void 0===s?void 0:s.targetElement)&&(l=y.ax.appDesigner.paneIsOpen),l&&y.observe(l,function(e){if(e)return y.async(function(){var t=y.shell.getAsideFormChildForm(o);t&&y.observe(t.IsOpen,function(e){if(e)return n(t),!1})},0,"ResizeAsidePaneWidth"),!1})},p.hideAsidePane=function(e,t){var o;if(y.peek(y.shell.isAsidePaneOpen)){if(null!=e&&e!==y.shell._asidePaneCurrentContent)return;var n=y.shell._asidePaneCurrentContent;if(n&&(y.context(n).onHide(null),y.shell._asidePane.removeChild(n),y.shell._asidePaneCurrentContent=null),y.shell.isAsidePaneOpen(!1),y.shell._clearAsidePaneStack(t),y.shell._asidePane){if("AsidePane"===y.shell.getActiveRegion()){y.shell.updateActiveFocusRegion(void 0);var i=!1;if(y.shell.isCopilotSidePane(n)){var r=null===(o=y.ui.getNavBar())||void 0===o?void 0:o.element.querySelector("[data-dyn-controlname='NavBarActions_SysCopilotChatPanel']");r&&(y.log.focus&&y.log.focus("Focus: Shell->hideAsidePane focus on copilot button"),r.focus(),i=!0)}if(!i){var a=y.context(y.shell.getActiveForm());a&&a.takeNavigationFocus()}}if(y.shell._asidePane.classList.remove("expanded"),y.shell._asidePaneResizeHandle&&(y.shell._asidePaneResizeHandle.style.display="none"),""!==y.shell._asidePane.style.width){var s=parseInt(y.shell._asidePane.style.width.replace("px",""),10);y.shell.asidePaneWidth(isNaN(s)?0:s),y.shell._asidePane.style.width="",y.shell._asidePane.style.left=""}}}},p.resetAsidePane=function(e){y.shell.hideAsidePane(null,e)},p.eventInAsidePane=function(e){return y.value(y.shell.isAsidePaneOpen)&&e&&e.target&&$(e.target).closest("#asidePane").length},p._clearAsidePaneStack=function(e){if(!e){for(var t=y.peek(y.shell._asidePaneStack),o=void 0,n=0;n<t.length;n++){var i=y.context(t[n]);i&&y.peek(i.PreventAutoClose)||t[n]===y.shell._asidePaneCurrentContent||(o=o||[]).push(t[n])}if(o)for(n=0;n<o.length;n++){var r=y.context(o[n]);r&&r.Close&&y.applyFunction(r.Close)}}y.shell._asidePaneStack._current=[]},p.subscribeAsidePaneToggle=function(){return y.observe(y.shell.isAsidePaneOpen,function(e){e?(y.shell.mainPane.classList.add("asidePane-opened"),y.shell._asidePane.setAttribute("aria-hidden","false"),y.shell._asidePane.style.display="block"):(y.shell.mainPane.classList.remove("asidePane-opened"),y.shell._asidePane.setAttribute("aria-hidden","true"),y.shell._asidePane.style.display="none"),y.shell.viewportSizeChanged(e),y.layout.reflowRootForm(),y.shell.reflowShell()},y.shell,null,!0)},p._asidePaneStartResize=function(e,t){var o=y.shell._returnAsidePaneCalculatedSize(t);o!=t.size.width&&(e.target.style.width=o+"px"),y.shell.asidePaneWidth(o)},p._asidePaneStopResize=function(e,t){var o=y.shell._returnAsidePaneCalculatedSize(t);o!=t.size.width&&(e.target.style.width=o+"px"),y.shell.asidePaneWidth(o);var n=y.shell.getActiveAsideForm(),i=y.context(n);if(y.shell.isClientDefinedAsideForm(n)){var r=y.shell.getAsideFormChildForm(n);r&&(i=r)}i&&y.callFunction(i.PersistPersonalization,i,["width",o]),y.layout.reflowRootForm()},p._returnAsidePaneCalculatedSize=function(e){var t=e.size.width;return e.size.width<y.shell.CurrentViewportSizes.viewportWidth?t=y.shell.CurrentViewportSizes.viewportWidth:e.size.width>2*y.shell.CurrentViewportSizes.viewportWidth&&(t=2*y.shell.CurrentViewportSizes.viewportWidth),t},p.isTaskRecorderOpen=function(){return y.shell.isAsidePaneOpen()&&y.shell.isTaskRecorder(y.shell.getActiveAsideForm())},p.isTaskRecorder=function(e){return e&&"TaskRecorderPane"===e.getAttribute("data-dyn-form-name")},p.isTaskRecorderGuideOpen=function(){return y.shell.isAsidePaneOpen()&&y.shell.isTaskRecorderGuide(y.shell.getActiveAsideForm())},p.isTaskRecorderGuide=function(e){return e&&"SysTaskGuidePane"===e.getAttribute("data-dyn-form-name")},p.isCopilotSidePane=function(e){return e&&"SysCopilotChatPanel"===e.getAttribute("data-dyn-form-name")},p.isCopilotSidePaneOpen=function(){return y.shell.isAsidePaneOpen()&&y.shell.isCopilotSidePane(y.shell.getActiveAsideForm())},p.reflowShell=function(){y.shell.shellReflowEvent().raise()},p.shellReflowEvent=function(){return y.shell._shellReflowEvent||(y.shell._shellReflowEvent=new y.eventHost),y.shell._shellReflowEvent},p.loadInitialForm=function(){if(y.serverForm){var e=y.serverForm.initialForm();e.menuItem?y.telemetry.addNavigationEvent("url",e.menuItem,["menuItem"]):e.name&&y.telemetry.addNavigationEvent("url",e.name,["formName"]),y.shell.createForm(e),y.shell.clientInitialFormRequested(!0)}},p.createForm=function(e){var t;e.targetElement?t=e.targetElement:(t="Dialog"===e.role||"LightBox"===e.role||"Popup"===e.role||"DropDialogPopup"===e.role||"Preview"===e.role?document.createElement("div"):document.createElement("form"),e.targetElement=t),e.name&&t.setAttribute("data-dyn-form-name",e.name);var o,n=(y.shell._nextId++).toString();if(t.setAttribute("data-dyn-clientId",n),t.dynOptions=e.parameters,e.id?(t.setAttribute("id","form_"+e.id),t.setAttribute("data-dyn-formid",e.id.toString())):(t.setAttribute("id","form_"+n),t.setAttribute("data-dyn-formid",n)),e.role?t.setAttribute("data-dyn-role",e.role):e.role=t.getAttribute("data-dyn-role"),t.dynReadyState=y.observable(y.ui.ReadyState.uninitialized),y.debug.trackFormPerformance&&(t.dynPerformance=[],t.dynPerformance.navigationStart=performance.now()),t.style.display="none",t.parentNode||(e.parentNode?e.parentNode.appendChild(t):document.body.appendChild(t)),e.context?o=e.context:y.serverForm&&(o=e.context=y.serverForm.getModel(n)),y.callFunction(e.elementCreated,null,e),e.templateId||e.resource){e.templateId=e.templateId||e.resource;var i={templateId:e.templateId,resource:e.resource};t.setAttribute("data-dyn-template",JSON.stringify(i).slice(1,-1)),e.Parameters&&(o.Parameters=e.Parameters),y.loadTemplateInstance(i,function(){t.removeAttribute(y.Const.templateApplied),t.getAttribute("data-dyn-role")&&(y.dataBind(t,new y.DataContext(o,e.parentContext)),y.applyFunction(e.dataBound))},t)}else e.role&&y.dataBind(t,new y.DataContext(o,e.parentContext));e.updateQuery&&(y.shell.browserHistory.updateQuery=!0,y.shell.browserHistory.queryMI=e.menuItem);var r=y.context(t);return r&&r.OnClientFormLoaded&&r.OnClientFormLoaded(),t},p.setActiveForm=function(e){if(y.log.focus&&y.log.focus("Focus: Shell->setActiveForm Form(Form.Id: %s)->InternalFocusIn",e.getAttribute("data-dyn-formid")),e&&y.shell.activeFormElement!==e){if(y.shell.activeFormElement){y.log.focus&&y.log.focus("Focus: Shell->setActiveForm - remove as active form Id: %s",y.shell.activeFormElement.getAttribute("data-dyn-formid")),y.shell.activeFormElement.classList.remove("active-form");var t=y.context(y.shell.activeFormElement);t&&!y.value(t.IsActive)&&y.shell.activeFormElement.setAttribute("aria-hidden","true")}(y.shell.activeFormElement=e).style.display="",y.log.navigation&&y.log.navigation("Navigation: Set active form: %s",e.getAttribute("data-dyn-form-name"));var o=y.shell.activeFormElement.getAttribute("data-dyn-role");if("PartForm"===o||"FactBoxForm"===o){var n=y.context(y.shell.activeFormElement);n&&n.Part()&&n.Part().Root&&(y.log.focus&&y.log.focus("Focus: Shell->setActiveForm - set as active part parent form Id: %s",n.Part().Root.element.getAttribute("data-dyn-formid")),y.shell.activeFormElement=n.Part().Root.element)}y.log.focus&&y.log.focus("Focus: Shell->setActiveForm - set as active form Id: %s",y.shell.activeFormElement.getAttribute("data-dyn-formid")),y.shell.activeFormElement.classList.add("active-form"),y.shell.activeFormElement.setAttribute("aria-hidden","false"),y.activeForm(y.shell.activeFormElement),!y.restrictedNavigation&&y.ui.getNavBar()&&y.ui.getNavBar().IsFormPersonalizable&&y.context(y.shell.activeFormElement)&&y.ui.getNavBar().IsFormPersonalizable(y.value(y.context(y.shell.activeFormElement).AllowExplicitPersonalization))}},p.navigationCompleteEvent=function(){return y.shell._navigationCompleteEvent||(y.shell._navigationCompleteEvent=new y.eventHost),y.shell._navigationCompleteEvent},p.subscribeToNavigationCompleteEvent=function(e,t){return y.shell.navigationCompleteEvent().subscribe(e,t)},p.unsubscribeToNavigationCompleteEvent=function(e){y.shell.navigationCompleteEvent().unsubscribe(e)},p.navigateToForm=function(t){y.shell.closeAllFormsBeforeNavigating(function(){y.shell.createForm(t),y.observe(y.async.pending,function(e){if(0===e)return y.shell.navigationCompleteEvent().raise(t),!1})})},p.getActiveForm=function(){return y.shell.activeFormElement},p.isCurrrentIndex=function(e){return e===y.shell._currentStackIndex},p.getCurrentRootForm=function(){var e,t=y.shell.stack();return 0<=y.shell._currentStackIndex&&(e=t[y.shell._currentStackIndex]),y.log.navigation&&0<=y.shell._currentStackIndex&&!e&&!y.shell.browserHistory.goingBack&&y.log.navigation("Navigation: Target element not found in $dyn.shell.stack for _currentStackIndex of %s.",y.shell._currentStackIndex),e},p.getPlaceholderForm=function(){if(!p._placeholderForm){var e=document.createElement("form");e.setAttribute("data-dyn-role","Form"),y.dataBind(e),p._placeholderForm=y.context(e)}return p._placeholderForm},p.isCurrentFormDefaultForm=function(){return y.shell.defaultForm.name&&y.context(y.shell.getCurrentRootForm())&&y.context(y.shell.getCurrentRootForm())._formName===y.shell.defaultForm.name},p.getCurrentDialog=function(){var e,t=y.length(y.shell.dialogStack);if(0<t&&y.shell.dialogStack()[t-1])e=y.shell.dialogStack()[t-1];else{var o=y.context(y.shell.getCurrentRootForm());if(o){var n=y.length(o.dialogStack);0<n&&o.dialogStack()[n-1]&&(e=o.dialogStack()[n-1])}}return e},p.getFocusedControl=function(){var e=y.context(y.shell.getActiveForm()),t=null;return e&&(t=y.context(e.GetFocusedControl())),t},p.deactivateElement=function(e,t){if(e){t&&t.doNotHide||e.style&&(e.style.display="none");var o=y.context(e);if(o){y.log.navigation&&y.log.navigation("Navigation: Deactivating the %s/%s form (%s)",o.Name?o.Name:"<unknown>",o._formName?o._formName:"<unknown>",o.Id);for(var n=void 0,i=void 0,r=y.length(o.dialogStack)-1;0<=r;r--)(n=o.dialogStack()[r]).style.display="none",(i=y.context(n))&&i.IsActive&&i.IsActive(!1);y.whatsNew.closeTipsForForm(o._formName),o.IsActive&&o.IsActive(!1)}}},p.tryActivateParentElement=function(e,t){if(e.Root&&e.Root.canActivate&&e.Root.element&&!$(e.Root.element).parents().hasClass("asidePane"))y.shell.activateElement(e.Root.element,t);else{var o=y.shell.getCurrentRootForm();if(e.element){var n=y.flyout.flyoutManager.findFlyoutContainer(e.element);if(1===n.length){var i=y.context(n[0]);i&&i.Root&&i.Root.canActivate&&i.Root.element&&(o=i.Root.element)}}y.shell.activateElement(o,t)}},p.activateElement=function(e,t){var o,n,i=y.context(e);if(i&&i.canActivate){if(i&&y.log.navigation&&y.log.navigation("Navigation: Activating the %s/%s form (%s)",i.Name?i.Name:"<unknown>",i._formName?i._formName:"<unknown>",i.Id),!t||!t.forceActivation){var r=i.dialogStack;if("Dialog"===i.TypeName){var a=y.context(y.shell.getCurrentRootForm());if(a&&r!==a.dialogStack)try{for(var s=__values(a.dialogStack()),l=s.next();!l.done;l=s.next()){l.value===e&&(r=a.dialogStack)}}catch(e){o={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(o)throw o.error}}}if(y.shell.trimDialogs(r),0<(h=y.length(r))){e.style.display="";for(var u=0;u<h-1;u++)r()[u].style.display="";e=r()[h-1],i=y.context(e)}}var d=y.ui.layout();!1===y.value(i.IsActive)&&(d||y.ui.layout(!0),i.IsActive(!0));var c=i.isNavigationActiveForm&&!i.isNavigationActiveForm();c&&y.shell.setActiveForm(e),y.restrictedNavigation||y.flags.useDesignTimeView?y.shell.formRenderingComplete(!0):y.deferred.onTrue(function(){return!(!y.value(y.user)&&!y.value(y.clientInError))}).done(function(){y.shell.formRenderingComplete(!0)}),d||y.ui.layout(!1);var p=!t||void 0===t.takeNavigationFocus||t.takeNavigationFocus;if(c&&i.takeNavigationFocus&&p&&(y.log.focus&&y.log.focus("Focus: Shell->activateElement Id: %s calling takeNavigationFocus",i.Id),i.takeNavigationFocus()),0<y.length(y.shell.dialogStack)){var h=y.length(y.shell.dialogStack),m=y.shell.dialogStack()[h-1],v=y.context(m);"LightBox"===v.TypeName&&(v.IsActive(!0),y.shell.setActiveForm(m),v.takeNavigationFocus&&p&&(y.log.focus&&y.log.focus("Focus: Shell->activateElement shell dialog Id: %s calling takeNavigationFocus",v.Id),v.takeNavigationFocus()))}if(y.shell.isCurrentFormDefaultForm()){var g=y.ui.getNavBar();g&&g.clearCrumb&&g.clearCrumb()}else i&&i.FormName&&y.DynReact.ModuleStore.updateFormCrumbs(i.FormName)}else y.log.navigation&&y.log.navigation("Navigation: Element can not be activated.")},p.resetShellOnNavigation=function(){$(document.body).trigger("resetShellOnNavigation"),$("body").trigger(jQuery.Event("click"))},p.getNavigationBar=function(){return null===y.shell._navBar&&(y.shell._navBar=document.getElementById(y.shell.NavBarDocumentId)),y.shell._navBar},p.getUserSettingButton=function(){return null==y.shell._userSettingButton&&(y.shell._userSettingButton=document.getElementById(y.shell.UserDocumentId)),y.shell._userSettingButton},p.stackContainerId="PrimaryConductor",p.navigate=function(e){if(e){var t=e.host?e.host:document.getElementById(y.shell.stackContainerId);y.shell.getCurrentRootForm()!==e.targetElement&&(y.shell.deactivateElement(y.shell.getCurrentRootForm()),t&&t.appendChild(e.targetElement),"Dialog"===e.typeName?y.shell.dialogStack.push(e.targetElement):(y.shell._currentStackIndex=y.length(y.shell.stack),y.shell.stack.push(e.targetElement)),y.shell.activateElement(e.targetElement),y.shell.browserHistory.createState(e.targetElement,e)),y.shell.resetShellOnNavigation()}},p.selectTabs=function(e,t,o){var n=y.ui.findControl(this[e],y.ui.RootType.form);n&&n.Activate?n.Activate():y.log.navigation&&y.log.navigation("Navigation: unable to find pivot %s during back navigation.",e)},p.openWindow=function(e){var t;if(!y.uwa||!y.uwa.isUWA)return(t=e.features?window.open(e.url,e.target,e.features):window.open(e.url,e.target))||y.showMessageBox({showOkButton:!0,Text:y.format(y.label("Shell_PopupBlocked"),y.value(y.shell.ProductName))}),t;y.uwa.openInExternalBrowser(e.url)},p.navigateUrl=function(e){e&&(void 0===e.openInNewTab&&(e.openInNewTab=!0),void 0===e.showExitWarning&&(e.showExitWarning=!0),e.openInNewTab?y.shell.openWindow({url:e.url,target:"_blank"}):(e.showExitWarning?y.resetConfirmExitFlag&&(y.flags.confirmExit=!0,y.resetConfirmExitFlag=!1):(y.flags.confirmExit&&(y.resetConfirmExitFlag=!0),y.flags.confirmExit=!1),window.location.href=e.url))},p.canGoBack=y.computed(function(){return 1<y.length(y.shell.browserHistory.navigationHistory)}),p.initiateBack=function(){var e=y.shell.getCurrentDialog();0<y.length(y.shell.dialogStack)?y.log.navigation&&y.log.navigation("Navigation: initiateBack was called, but the shell took no action.  All open dialogs must be closed before going back"):e?(y.log.navigation&&y.log.navigation("Navigation: initiateBack was called while a slider was open.  Closing the slider."),y.applyFunction(y.context(e).Close)):y.shell.canGoBack()?(y.log.navigation&&y.log.navigation("Navigation: initiateBack was called, going back 1 entry in browser history."),y.shell.browserHistory.backNavigationInitiatedByBrowser=!1,history.back()):(y.log.navigation&&y.log.navigation("Navigation: initiateBack was called when we have only 1 form in the navigation stack."),y.shell.closeAllFormsBeforeNavigating(function(){y.restrictedNavigation&&y.popout&&y.serverForm?y.serverForm._windowManager.closePopoutWindow(!1):y.shell.goHome()}))},p.removePrimaryForm=function(e){var t,o=-1;e?0<=e.index?(o=e.index,t=y.shell.stack()[o]):(t=e.targetElement,o=y.shell.stack().lastIndexOf(t)):(o=y.shell._currentStackIndex,t=y.shell.stack()[o]),t||(y.logError("Shell: Target element not found in $dyn.shell.stack, removePrimaryForm() tried to remove index %s.",o),y.log.navigation&&y.log.navigation("Shell: Target element not found in $dyn.shell.stack, removePrimaryForm() tried to remove index %s.",o)),y.log.navigation&&y.log.navigation("Navigation: Closing client form at stack position: ",o),(y.length(y.shell.dialogStack)||y.length(y.context(t).dialogStack))&&y.log.navigation&&y.log.navigation("Navigation: Root form was closed when a dialog was still open."),y.shell._removeForm(t),y.shell.stack.setAt(o,null),o===y.shell._currentStackIndex&&(y.shell.browserHistory.removeExtraNavigationHistoryEntries(o),y.shell.trimStack(o),y.length(y.shell.stack)?y.observe(y.shell.browserHistory.waitForPopStateHandler,function(e){if(!y.value(e))return y.shell.browserHistory.completeBackNavigation(),!1}):y.shell.isExiting?history.back():y.restrictedNavigation&&!y.shell.isClosingOpenForms&&y.serverForm&&y.serverForm._windowManager?y.callFunction(y.serverForm._windowManager.closePopoutWindow,y.serverForm._windowManager,!0):y.shell.restartNavigationStack())},p.trimStack=function(e){e!==y.length(y.shell.stack)-1||!y.shell.isClosingOpenForms&&y.shell.browserHistory.checkForReferences(e)||(y.shell._currentStackIndex=e-1,y.shell.stack.pop())},p.trimDialogs=function(e){for(var t=y.length(e);0<t&&y.context(e()[t-1]).willBeClosed;){var o=e.pop();y.shell._removeForm(o),t=y.length(e)}},p.dialogBack=function(e){var t;if(y.length(y.shell.dialogStack))t=y.shell.dialogStack,0;else{var o=y.context(y.shell.getCurrentRootForm());if(null==o)return y.log.navigation&&y.log.navigation("Navigation: dialogBack() was called but not dialogs were open on the shell or active form."),!0;0<y.length(o.dialogStack)&&(t=o.dialogStack)}var n=y.length(t);if(!t||!t()[n-1])return y.log.navigation&&y.log.navigation("Navigation: dialogBack() was called when no dialogs were in the dialogs stacks."),!0;if(t()[n-1].id!==y.shell.getActiveForm().id||e&&e.element&&e.element.id!==t()[n-1].id){var i=void 0,r=e&&e.element?y.context(e.element):void 0;return r&&!(i=y.shell.findFormById(y.shell.dialogStack,r.Id))&&y.context(y.shell.getCurrentRootForm())&&(i=y.shell.findFormById(y.context(y.shell.getCurrentRootForm()).dialogStack,r.Id)),i?i.willBeClosed=!0:y.log.navigation&&y.log.navigation("Navigation: A close form request was received for a dialog that is not on the dialog stack."),!1}var a=t.pop();y.shell._removeForm(a),y.shell.trimDialogs(t);var s=y.length(t);if(!y.shell.isClosingOpenForms)if(y.flyout.flyoutManager.areAnyFlyoutsOpen()){var l=y.flyout.flyoutManager.getTopFlyout();if(l&&l.flyout){var u=y.value(l.flyout);u&&u.length&&y.shell.activateElement(u[0],{forceActivation:!0})}}else 0<y.length(t)?y.shell.activateElement(t()[s-1]):0===y.shell._currentStackIndex&&0===y.length(y.shell.stack())||-1===y.shell._currentStackIndex?y.shell.restartNavigationStack():y.length(y.shell.stack())>y.shell._currentStackIndex?y.shell.activateElement(y.shell.stack()[y.shell._currentStackIndex]):y.log.navigation&&y.log.navigation("Navigation: Error, _currentStackIndex of %s is >= than $dyn.shell.stack.length of %s.",y.shell._currentStackIndex,y.length(y.shell.stack()));return!0},p.isRightGutterOpen=function(){var e,t;return null===(t=null===(e=y.shell.getActiveForm())||void 0===e?void 0:e.classList)||void 0===t?void 0:t.contains("showRightPaneGutter")},p._removeForm=function(e){if(e){var t=y.context(e);t&&(y.setValue(t,"IsActive",!1),!1!==y.value(t.disposeOnClose)&&y.unbind(e)),e.dynOptions&&(e.dynOptions=null),e.dynResources&&(e.dynResources=null),e.dynClose&&(e.dynClose=null),$(e).remove()}},p.goHome=function(){var e=y.ui.getNavBar();e&&e.clearCrumb&&e.clearCrumb();var t=y.shell.defaultForm;t.targetElement=void 0,t.context=void 0,t.updateQuery=!0;var o=t.menuItem?t.menuItem:"";y.telemetry.addNavigationEvent("goHome",o,[]),y.shell.createForm(t),y.deferred.onTrue(function(){return 0===y.value(y.async.pending)}).done(function(){void 0!==y.shell.getCurrentRootForm()&&(y.shell.defaultForm.name=y.context(y.shell.getCurrentRootForm()).FormName)})},p.restartNavigationStack=function(){y.shell.isClosingOpenForms||y.deferred.onTrue(function(){return 0===y.value(y.async.pending)}).done(function(){y.length(y.shell.stack)||y.length(y.shell.dialogStack)||(y.log.navigation&&y.log.navigation("Navigation: All open forms were closed, resetting navigation artifacts and then running $dyn.shell.goHome()"),y.shell._resetNavigationStack(),y.shell.goHome())})},p._resetNavigationStack=function(){y.shell._currentStackIndex=-1,y.shell.activeFormElement=null,y.shell.stack.clear(),y.shell.dialogStack.clear(),y.shell.browserHistory.init()},p.cleanWindowFormsBeforeNavigating=function(e){if(y.serverForm){for(var t in y.serverForm.interactionHandler.forms)y.serverForm.interactionHandler.closeFormByRootId(t);y.serverForm.interactionHandler.forms={},y.serverForm.forceCloseAllPopouts()}e&&y.applyFunction(e)},p.closeAllFormsBeforeNavigating=function(e,t){function o(){y.shell.closeWindowFormsBeforeNavigating(e,void 0,t)}y.serverForm?y.serverForm.closeAllPopouts(o,function(){y.error({Message:y.label("Shell_AbortedNavigationPopout"),Label:"Shell_AbortedNavigationPopout"})}):o()},p.closeWindowFormsBeforeNavigating=function(e,t,o){if(e===y.shell.goHome&&y.shell.isCurrentFormDefaultForm())y.shell.isClosingOpenForms=!1,y.shell.closingAllCallback=void 0,y.shell.closingErrorCallback=void 0,y.ui.getNavBar()&&y.ui.getNavBar().clearCrumb(),0<y.length(y.shell.stack)&&y.shell.activateElement(y.value(y.shell.stack)[y.length(y.shell.stack)-1]),y.shell.refreshData(!0);else if(y.shell.isClosingOpenForms&&y.shell.closingAllCallback===y.shell.goHome&&1===y.length(y.shell.stack)&&y.shell.isCurrentFormDefaultForm()){y.shell.isClosingOpenForms=!1,y.shell.closingAllCallback=void 0,y.shell.closingErrorCallback=void 0,y.ui.getNavBar()&&y.ui.getNavBar().clearCrumb();for(var n=0;1<y.length(y.shell.browserHistory.navigationHistory);)y.shell.browserHistory.navigationHistory.pop(),n++;0<n&&(y.shell.browserHistory.waitForPopStateHandler(!0),history.go(-n)),y.deferred.onTrue(function(){return 0===y.value(y.async.pending)&&!y.value(y.shell.browserHistory.waitForPopStateHandler)}).done(function(){window.setTimeout(function(){y.shell.activateElement(y.value(y.shell.stack)[0]),y.shell.refreshData(!1),y.shell.browserHistory.clearForward()})})}else y.shell.isClosingOpenForms||(y.shell.isClosingOpenForms=!0,"function"==typeof y.getFunction(e)?y.shell.closingAllCallback=e:(y.logWarning("Shell:  closeWindowFormsBeforeNavigating should be called with a callback."),y.shell.closingAllCallback=y.shell.goHome),"function"==typeof t&&(y.shell.closingErrorCallback=t),o&&o.closeDashboard?y.shell.closingAllCloseDashboard=!0:y.shell.closingAllCloseDashboard=!1,o&&o.retainCrumb?y.shell.closingAllRetainCrumb=!0:y.shell.closingAllRetainCrumb=!1,o&&o.destinationCompany?y.shell.closingAllDestinationCompany=o.destinationCompany:y.shell.closingAllDestinationCompany=y.value(y.user().Company)),y.deferred.onTrue(function(){return 0===y.value(y.async.pending)}).done(function(){for(y.shell.closingAllIndex=y.length(y.shell.stack)-1;0<=y.shell.closingAllIndex&&(!y.value(y.shell.stack)[y.shell.closingAllIndex]||!y.value(y.shell.stack)[y.shell.closingAllIndex].id);)y.shell.closingAllIndex--;if(0<y.shell.closingAllIndex||0===y.shell.closingAllIndex&&(y.shell.closingAllCloseDashboard||!y.shell.isCurrentFormDefaultForm())){var e=y.context(y.shell.stack()[y.shell.closingAllIndex]);y.shell.closingAllIndex--,e?y.async(function(){y.log.navigation&&y.log.navigation("Navigation: closeWindowFormsBeforeNavigating is calling form.Close for form: "+y.value(e.FormName)),y.callFunction(e.Close,void 0,{closeCallback:y.shell.closeWindowFormsBeforeNavigating})},void 0,"Navigation: closeWindowFormsBeforeNavigating"):(y.log.navigation&&y.log.navigation("Navigation: Error, closeWindowFormsBeforeNavigating could not find the form context."),y.shell.closeWindowFormsBeforeNavigating())}else{y.log.navigation&&y.log.navigation("Navigation: All open forms were closed, executing the callback"),y.shell.isClosingOpenForms=!1;var t=y.shell.closingAllCallback;for(y.shell.closingAllCallback=void 0,y.shell.closingErrorCallback=void 0,!y.shell.closingAllRetainCrumb&&y.ui.getNavBar()&&y.ui.getNavBar().clearCrumb&&y.ui.getNavBar().clearCrumb();y.length(y.shell.browserHistory.navigationHistory)>y.length(y.shell.stack);)y.shell.browserHistory.navigationHistory.pop();window.setTimeout(function(){y.user().updateCompany(y.shell.closingAllDestinationCompany),y.deferred.onTrue(function(){return 0===y.value(y.async.pending)&&!y.value(y.shell.browserHistory.waitForPopStateHandler)}).done(function(){y.shell.browserHistory.clearForward(),y.applyFunction(t)})})}})},p.refreshData=function(e,t){var o,n=y.context(t);(o=n&&n.Root?n.Root:y.context(y.shell.getActiveForm()))&&y.callFunction(o.RefreshData,o,e)},p.logOut=function(){y.flags.confirmExit=!1,y.serverForm.endSession(),window.location.href="Logout"},p.preventFormAction=!0,p.formAction=function(e){y.shell.preventFormAction&&e.preventDefault()},p.isActiveControl=function(e){var t=!1,o=y.context(y.shell.getActiveForm());return o&&o.isActiveControl&&(t=o.isActiveControl(e.Name)),t},p.findFormById=function(e,t){for(var o,n=y.length(e)-1;0<=n;n--)if((o=y.context(y.value(e)[n]))&&o.Id===t)return o},p.initializeUserSettingsFromURL=function(){var e=y.util.location.query,t=y.user();y.setObservableValue(t,"Company",e[y.shell.QueryStringKeys.companyKey.toLowerCase()]),y.setObservableValue(t,"Language",e[y.shell.QueryStringKeys.languageKey.toLowerCase()]),y.setObservableValue(t,"RequestPartition",e[y.shell.QueryStringKeys.partitionKey.toLowerCase()]);var o=e[y.shell.QueryStringKeys.themeKey.toLowerCase()];y.densityThemeManager._setCurrentTheme(o);var n=e[y.shell.QueryStringKeys.densityKey.toLowerCase()];y.densityThemeManager._setCurrentDensity(n),!0===y.debug.vs&&((y.flags.fromVS=!0)===y.debug.confirmExit&&(y.flags.confirmExit=!0),y.shell.hideSplash=!0),y.observe(y.options(function(){return{company:t.Company,partition:t.RequestPartition}},t.Updating),y.shell.updateURLFromUserSettings)},p.initializeBrowserActivityFromURL=function(){var e=y.util.location.query,t=y.shell.QueryStringKeys.browserActivityKey.toLowerCase(),o=y.shell.QueryStringKeys.expirationKey.toLowerCase(),n=y.shell.QueryStringKeys.activityKey.toLowerCase(),i=e[t],r=e[o],a=Date.now();if(i&&r&&a<r&&y.browserActivity){var s={bid:i,expiration:r,aid:e[n]};y.browserActivity.resetBrowserSessionActivity(a,s)}var l=t in e||o in e||n in e;delete e[t],delete e[o],delete e[n],l&&window.history.replaceState(window.history.state,null,y.util.location.absoluteUrl())},p.isTrialMode=function(){return"trial"===y.util.parseQueryString(window.location.search).mode},p.updateURLFromUserSettings=function(e){var n=$.extend({},y.util.location);n.query=y.util.parseQueryString(window.location.search);var t=y.shell.QueryStringKeys.companyKey.toLowerCase(),o=y.shell.QueryStringKeys.partitionKey.toLowerCase(),i=!1;i=void 0!==n.query[t]&&""!==n.query[t]||!e.company?s(t,e.company):(n.query[t]=e.company,!0);var r=s(o,e.partition);if(i||r){var a=y.util.relativeUrl(n);window.history.replaceState(window.history.state,null,a),$(document).trigger("updateUtilLocationQuery")}function s(e,t){var o=t&&t.toLowerCase?t.toLowerCase():t;return!(!n.query[e]||n.query[e].toLowerCase()===o)&&(n.query[e]=o,!0)}},p._updateUrlParameters=function(o){var e;if(o){var n=$.extend({},y.util.location);"//"===(null===(e=null==n?void 0:n.path)||void 0===e?void 0:e.substring(0,2))&&(n.path=n.path.substring(1,n.path.length)),Object.keys(o).forEach(function(e){var t=o[e];null==t?delete n.query[e]:n.query[e]=t}),window.history.replaceState(window.history.state,null,y.util.relativeUrl(n)),$(document).trigger("updateUtilLocationQuery")}},p.setStartPage=function(){var t=y.user();y.shell.defaultForm={menuItem:t.Startpage(),role:"Form",elementCreated:function(e){y.serverForm&&y.serverForm.getForm(e)}},t.Startpage()&&void 0===y.shell.defaultForm.name&&y.deferred.onTrue(function(){return 0===y.value(y.async.pending)}).done(function(){var e=y.context(y.shell.getCurrentRootForm());e&&t.Startpage().toLowerCase()===y.value(e.MenuItemName).toLowerCase()&&(y.shell.defaultForm.name=e.FormName)})},p.getQueryStringForNewMenuItem=function(e){var t=$.extend({},y.util.location);t.query=y.util.parseQueryString(window.location.search);var o=e;if(o){var n=o.split(":");"Display"===n[0]&&(o=n[1])}return o?(y.log.navigation&&y.log.navigation("Navigation: Updating the ?mi parameter to %s",o),t.query[y.shell.QueryStringKeys.menuItem]=o):(y.log.navigation&&y.log.navigation("Navigation: Clearing the ?mi parameter from the URL"),delete t.query[y.shell.QueryStringKeys.menuItem]),t.query[y.shell.QueryStringKeys.formName]&&(delete t.query[y.shell.QueryStringKeys.formName.toLowerCase()],delete t.query[y.shell.QueryStringKeys.formName.toUpperCase()]),t.query[y.shell.QueryStringKeys.pageType.toLowerCase()]&&(delete t.query[y.shell.QueryStringKeys.pageType],delete t.query[y.shell.QueryStringKeys.pageType.toLowerCase()],delete t.query[y.shell.QueryStringKeys.pageType.toUpperCase()]),y.util.relativeUrl(t)},p._viewportChangeHandler=function(e,t){if(t){var o=t<y.shell.CurrentViewportSizes.viewportWidth+y.shell.CurrentViewportSizes.gutterWidth;y.shell.isPhone||y.shell._isPhoneSize||!o?y.shell._isPhoneSize&&!o&&($(document.body).removeClass("xsmallView"),y.shell._isPhoneSize=!1,y.shell.isPhone=!1,y.shell.isNavigationPanePinned(!1),y.shell._renderNavigationPane(),$(window).trigger("resize")):($(document.body).addClass("xsmallView"),y.shell._isPhoneSize=!0,y.shell.isPhone=!0,y.shell.isNavigationPanePinned(!0),y.shell._renderNavigationPane(),$(window).trigger("resize"))}},p.setDeviceMode=function(){window.navigator.standalone&&$(document.body).addClass("iOSApp"),-1!==window.navigator.userAgent.indexOf("Edge")&&(y.shell.isEdge=!0,$(document.body).addClass("MSEdge"));var e=new RegExp("Android|webOS|iPhone|BlackBerry|Windows Phone|Opera Mini|IEMobile|Mobile","i");"false"===y.util.location.query.usePhoneLayout||"true"!==y.util.location.query.usePhoneLayout&&!e.test(navigator.userAgent)?($(document.body).removeClass("phoneDevice"),y.shell.isPhone=!1):window.innerWidth<=y.shell.NavBarSizes.smallNavBarSize&&($(document.body).addClass("phoneDevice"),y.shell.isPhone=!0),y.shell._viewportChangeHandler(null,y.shell.CurrentShellViewPortWidthSize),y.shell.viewportBindingHandler=y.bindingHandlers.ShellViewportWidthSize(),y.shell.viewportBindingHandler.apply(y.shell._viewportChangeHandler,y.shell)},p.primaryForm=y.computed(function(){return y.context(y.shell.getCurrentRootForm())}),p.primaryFormCaption=y.observable(""),p.setDocumentTitle=function(e){e!==y.shell.ProductShortName()?document.title=y.format(y.label("Shell_BrowserTitleFormat"),e,y.shell.ProductShortName()):document.title=y.shell.ProductShortName(),y.log.navigation&&y.log.navigation("Navigation: Browser title changed to: %s",document.title)},p._unsavedChangesMap={},p.registerUnsavedChanges=function(e){y.shell._unsavedChangesMap[e]=!0,y.flags.confirmExit=!0},p.unregisterUnsavedChanges=function(e){y.shell._unsavedChangesMap[e]&&(delete y.shell._unsavedChangesMap[e],y.shell.hasUnsavedChanges()||!y.flags.confirmExit||y.flags.fromVS||(y.flags.confirmExit=!1))},p.unregisterAllUnsavedChanges=function(){y.shell._unsavedChangesMap={},y.flags.confirmExit&&!y.flags.fromVS&&(y.flags.confirmExit=!1)},p.hasUnsavedChanges=function(){return 0<Object.keys(y.shell._unsavedChangesMap).length},$(window).on("PreviousView",function(e){e.preventDefault(),y.callWhenNotBusy(y.shell.initiateBack)}),$(window).on("Refresh",function(e){e.preventDefault(),y.shell.refreshData(!0,e.target)}),$(window).on("DeleteRecord",function(e){y.shell.callCommandButtonFunction(y.shell.CalledCommandButtonFunction.DeleteRecord,e)}),$(window).on("New",function(e){y.shell.callCommandButtonFunction(y.shell.CalledCommandButtonFunction.New,e)}),y.resetConfirmExitFlag=!1;window.addEventListener("beforeunload",function(e){if(y.flags.confirmExit){e&&e.preventDefault();var t="";return t=y.flags.fromVS?y.label("Shell_LeavingDebugIE"):y.label("Shell_LeavingSession"),e&&(e.returnValue=t),t}y.resetConfirmExitFlag&&window.setTimeout(function(){y.flags.confirmExit=!0,y.resetConfirmExitFlag=!1},500)},{capture:!0})}($dyn=$dyn||{}),function(c){var e,t;$(document).on("mousemove",function(e){c.shell.previewManager._displayedPreviewMouseMoveEvent=e}),e=c.shell||(c.shell={}),(t=e.previewManager||(e.previewManager={}))._displayedPreview=null,t._displayedPreviewMouseMoveEvent=null,t._previewCloseTimer=-1,t._displayedPreviewControlClass=null,t._displayedPreviewControlElement=null,t._closeInterval=-1,t._hostControlOffset=null,t._previewRequestPending=!1,t.hasOpenPreview=function(){return!!c.shell.previewManager._displayedPreview},t.setActive=function(){c.shell.previewManager._displayedPreview&&c.context(c.shell.previewManager._displayedPreview).IsActive(!0)},t.enhancedPreviewShortcutHandler=function(e,t){if(e.CanHavePreview&&e.RequestEnhancedPreview){if(c.shell.previewManager.hasOpenPreview()){c.shell.previewManager.removePreview();var o=e.element;window.setTimeout(function(){c.preview.tryOpenPreview(o,t)},250)}else c.value(e.CanHavePreview)?c.preview.tryOpenPreview(e.element,t):c.superTooltip.tryOpenSuperTooltip(e.element);return!0}return!1},t.displayPreview=function(e,t,o){if(!c.shell.previewManager.hasOpenPreview()){$(document.body).on("resetShellOnNavigation.dynPreviewManager",function(){c.shell.previewManager.removePreview()});var n=c.shell.previewManager.createPreview(e,t,o);n&&(c.shell.previewManager._displayedPreviewControlClass=e,c.shell.previewManager._displayedPreviewControlElement=t,c.shell.previewManager._displayedPreview=n,$(n).position({at:"center top",collision:"fit flip",my:"center bottom",of:c.shell.previewManager._displayedPreviewControlElement,offset:"-20 -10"}),n.style.display="")}},t.configurePreviewForm=function(e,t,o){if(t&&(t.TakeFocus=!0===o,t.IsPreviewForm=!0,t.takeFocusOnOpen=!1,t.IgnoreBlockingDiv=function(e){return"RequestClose"===e},e.Root)){var n=$(e.Root.GetFocusedControl());t.FindFocusTarget=function(){return n},n.on("keydown.showPreview",function(e){e.which===c.ui.KeyCodes.tab&&window.setTimeout(function(){c.shell.previewManager.closePreview(c.shell.previewManager._displayedPreviewControlClass,!0)})})}},t.createPreview=function(n,e,i){var t=c.shell.createForm({role:"Preview"}),o=t.getAttribute("data-dyn-formid");c.shell.previewManager._hostControlOffset=e?$(e).offset():$(n.element).offset();var r=c.context(t);c.shell.previewManager.configurePreviewForm(n,r,i);var a=0<=n.serverIndex?n.serverIndex:-1,s=!1;n.Root&&n.Root.UseReactGrid()&&n.convertMasterTrackingId&&(s=!0);var l=c.value(n.RequestEnhancedPreview);return l&&(l([o,a,s],void 0,function(){window.setTimeout(function(){if(c.shell.previewManager._previewRequestPending=!1,c.shell.canOpenPreview(n.Root)){if(c.shell.previewManager.positionPreview(),r&&r.element)if(i){var e=c.util.findFirstFocusableControl($(r.element)),t=!1;e?(e.focus(),t=!0):r.element.focus();var o=function(e){c.shell.previewManager.removePreview(),n&&n.Root&&n.Root.takeNavigationFocus&&n.Root.takeNavigationFocus(),e.which===c.ui.KeyCodes.esc?(c.log.stopPropagation&&c.log.stopPropagation("Preview close shortcut."),e.stopPropagation()):$(document.body).off("mousedown.Preview")};$(document.body).on("mousedown.Preview",function(e){c.util.flyout.isCoordinateInside(e.clientX,e.clientY,$(r.element))||o(e)}),r.element.onkeydown=function(e){e.which===c.ui.KeyCodes.esc&&o(e),t||e.which!==c.ui.KeyCodes.tab||(e.preventDefault(),e.stopPropagation())}}else{$(document.body).on("keydown.Preview",function(e){var t;e.which===c.ui.KeyCodes.esc&&(t=e,c.shell.previewManager.removePreview(),n&&n.Root&&n.Root.takeNavigationFocus&&n.Root.takeNavigationFocus(),c.log.stopPropagation&&c.log.stopPropagation("Preview close shortcut."),t.stopPropagation(),$(document.body).off("keydown.Preview"))})}}else c.shell.previewManager.removePreview()},0)}),c.shell.previewManager._previewRequestPending=!0),c.shell.previewManager.updateBorderDisplayProperty(t,"none"),t.classList.remove("sysPopup"),$(t).on("mouseleave",function(e){var t;"ShellBlockingDiv"!==(null===(t=null==e?void 0:e.relatedTarget)||void 0===t?void 0:t.id)&&(n.isPreviewHovered(!1),c.shell.previewManager.closePreview(n))}),$(t).on("mouseenter",function(){n.isPreviewHovered(!0)}),t},t.removePreview=function(){c.shell.previewManager._displayedPreviewControlClass&&(c.shell.previewManager._displayedPreview&&(c.shell.previewManager._displayedPreview.style.display="none"),c.shell.previewManager._displayedPreviewControlClass.isPreviewControlHovered(!1),c.shell.previewManager._displayedPreviewControlClass.isPreviewHovered(!1),c.shell.previewManager.closePreview(c.shell.previewManager._displayedPreviewControlClass))},t.closePreview=function(e,t){if(t){c.log.test&&c.log.test.error&&c.log.test.error("Preview -force close");var o=c.context(c.shell.previewManager._displayedPreview);o&&(c.shell.previewManager.cleanupPreviewForm(),o.IsActive(!1)),c.shell.previewManager._displayedPreview&&(c.shell.previewManager._displayedPreview.style.display="none")}else!e||c.shell.previewManager._displayedPreviewControlClass!==e||e.isPreviewControlHovered()||e.isPreviewHovered()||c.shell.previewManager.hasOpenPreview()&&-1===c.shell.previewManager._previewCloseTimer&&(c.shell.previewManager._previewCloseTimer=window.setTimeout(function(){c.shell.previewManager._previewCloseTimer=-1,e.isPreviewControlHovered()||e.isPreviewHovered()||!c.shell.previewManager.hasOpenPreview()||(c.shell.previewManager.clearPreviewCloseInterval(),c.context(c.shell.previewManager._displayedPreview)&&c.shell.previewManager.cleanupPreviewForm(),c.shell.previewManager._displayedPreview&&(c.shell.previewManager._displayedPreview.style.display="none"))},50))},t.cleanupPreviewForm=function(){var t=!1,e=c.shell.previewManager._displayedPreview;0<$(document.activeElement).closest(e).length&&(t=!0);var o=c.context(e);o&&(c.shell.previewManager._previewRequestPending?window.setTimeout(c.shell.previewManager.cleanupPreviewForm,20):(o._close=function(){if(t){var e=c.context(c.shell.getActiveForm());e&&(c.log.focus&&c.log.focus("Focus: cleanupPreviewForm Form(Form.Id: %s) setting focus back to the active form",o.Id),e.takeNavigationFocus())}c.shell.previewManager.cleanupClientPreview()},c.getFunction(c.context(c.shell.previewManager._displayedPreview).Close)()))},t.cleanupClientPreview=function(){$(c.shell.previewManager._displayedPreview).remove(),$(c.shell.previewManager._displayedPreviewControlElement).off(".showPreview");var e=c.context(c.shell.previewManager._displayedPreview);if(e){var t=e.FindFocusTarget?e.FindFocusTarget():void 0;t&&t.off(".showPreview"),e.Id&&c.serverForm&&c.serverForm.ModelManager.removeFormModelsAndCollections(e.Id)}c.shell.previewManager._displayedPreviewControlClass&&(c.shell.previewManager._displayedPreviewControlClass.PreviewRequested=!1,c.shell.previewManager._displayedPreviewControlClass.isPreviewControlHovered(!1),c.shell.previewManager._displayedPreviewControlClass.isPreviewHovered(!1)),c.shell.previewManager._displayedPreview=null,c.shell.previewManager._displayedPreviewControlClass=null,c.shell.previewManager._displayedPreviewControlElement=null,$(document.body).off("resetShellOnNavigation.dynPreviewManager")},t.positionPreview=function(){var l=c.shell.previewManager._displayedPreviewControlClass,e=c.value(l.Visible)&&$(c.shell.previewManager._displayedPreviewControlElement).is(":visible"),u=c.shell.previewManager._displayedPreviewControlElement,d=$(u),t=$(c.shell.previewManager._displayedPreview).find(".rootLayout")[0],o=0;if(t&&(o=$(t).children().length),e&&0!==o){c.telemetry.addControlActionEvent(l,null,c.telemetry.ActionEvents.previewDisplayed,{userDefined1:1}),c.shell.previewManager.setActive();var n=c.context(c.shell.previewManager._displayedPreview),i=function(){if(c.shell.previewManager._displayedPreview){c.shell.previewManager._displayedPreview.classList.add("sysPopup"),c.shell.previewManager.updateBorderDisplayProperty(c.shell.previewManager._displayedPreview,"");var e=$(c.shell.previewManager._displayedPreview).outerHeight(),t=d.offset().top,o=d.height(),n=$(window).height()-(t+o+25),i=t-25,r=n<i?i:n;r<e&&$(c.shell.previewManager._displayedPreview).find(".preview-inner").css({"max-height":r+"px"});var a=u,s=c.value(l.IsViewMode);l.isInGrid()||s||!l.$inputElement?!l.isInGrid()&&s&&l.$addedLinkElement&&(a=l.$addedLinkElement[0]):a=l.$inputElement[0],$(c.shell.previewManager._displayedPreview).position({at:"center top",collision:"fit flip",my:"left-22 bottom",of:a,using:function(e){var t=$(u).offset().top,o=$(u).offset().left,n=$(c.shell.previewManager._displayedPreview).find(".preview-Beak");o>e.left+20&&n.css({position:"absolute",left:o-e.left-22+"px"}),t<e.top&&(n.removeClass("preview-Beak-Down"),n.addClass("preview-Beak-Up"),n.css({top:"0"})),$(c.shell.previewManager._displayedPreview).css({top:e.top}),$(c.shell.previewManager._displayedPreview).css({left:e.left})}}),$(c.shell.previewManager._displayedPreviewControlElement).on("mousedown.showPreview DOMMouseScroll.showPreview mousewheel.showPreview",function(){c.shell.previewManager.closePreview(c.shell.previewManager._displayedPreviewControlClass,!0)}),c.shell.previewManager._closeInterval=window.setInterval(c.shell.previewManager.checkPreviewClose,500)}};n&&c.value(n.waitForAsyncRender)?c.observe(n.waitForAsyncRender,function(e){if(!e)return c.async(function(){i()},void 0,"Position form after grid is done rendering"),!1}):i()}else{l&&(0===o&&c.setValue(l,"CanHavePreview",!1),u&&c.preview.restoreToolTip(u)),c.telemetry.addControlActionEvent(l,null,c.telemetry.ActionEvents.previewDisplayed,{userDefined1:0}),c.shell.previewManager.cleanupClientPreview();var r={currentTarget:u,target:u};c.onMouseEvent.callMouseEnterFunction(r)}},t.updateBorderDisplayProperty=function(e,t){var o=e.querySelector(".preview-inner");o&&(o.style.display=t);var n=e.querySelector(".preview-Beak");n&&(n.style.display=t)},t.checkPreviewClose=function(){var e=c.shell.previewManager._displayedPreviewControlClass;if(c.shell.previewManager.hasOpenPreview()&&e){var t=!1,o=c.shell.previewManager._hostControlOffset;if(o){var n=$(c.shell.previewManager._displayedPreviewControlElement).offset();void 0!==n&&o.left===n.left&&o.top===n.top||(t=!0)}void 0!==c.value(e.Value)&&$.contains(document.body,e.element)||(t=!0),t&&(c.shell.previewManager.clearPreviewCloseInterval(),c.shell.previewManager.closePreview(e,!0))}else c.shell.previewManager.clearPreviewCloseInterval()},t.clearPreviewCloseInterval=function(){-1!==c.shell.previewManager._closeInterval&&(window.clearInterval(c.shell.previewManager._closeInterval),c.shell.previewManager._closeInterval=-1)},t.canOpenPreview=function(e,t,o){if(c.flags.disablePreview)return!1;var n=!1,i=!1,r=c.value(e.Visible)&&$(t).is(":visible"),a=!0;return t.dynContext&&e.controlIsValid?a=e.controlIsValid():i=!0,!(r&&a&&c.value(e.isPreviewControlHovered))||c.shell.previewManager._previewRequestPending||c.shell.previewManager.hasOpenPreview()&&-1===c.shell.previewManager._previewCloseTimer||(c.value(e.Value)&&""!==c.value(e.Value)||e.SelectedItem||"Image"===e.TypeName)&&(e.ShowFlyout&&c.value(e.ShowFlyout)||c.shell.isActiveControl(e)&&!o&&!i||(n=!0)),a||n||c.preview.restoreToolTip(t),n}}($dyn=$dyn||{}),function(l){var e,t,u;(e=l.ui||(l.ui={})).updateQueryStringParameter=function(e,t){e||l.logError("Shell: updateQueryStringParameter requires a key parameter."),l.shell.browserHistory.pendingUrlParameters[e]=t,l.shell.browserHistory.urlParameterPending(!0)},e.getQueryStringParameter=function(e){return e||l.logError("Shell: getQueryStringParameter requires a key parameter."),l.util.location.query[e]},t=l.shell||(l.shell={}),(u=t.browserHistory||(t.browserHistory={})).backNavigationInitiatedByBrowser=!0,u.duplicateRecord=!1,u.goingBack=!1,u.goToPreviousFormPending=l.observable(!1),u.newStatePending=l.observable(!1),u.pivotEvaluationPending=0,u.revert=!1,u.undo=!1,u.updateQuery=!1,u.urlParameterPending=l.observable(!1),u.waitForPopStateHandler=l.observable(!1),u.activePivots={},u.navigationHistory=l.observableArray([]),u.newHistoryState={},u.pendingNewHistoryStates=[],u.pendingFormCloseStates=[],u.pendingUrlParameters={},u.init=function(){u.backNavigationInitiatedByBrowser=!0,u.duplicateRecord=!1,u.goingBack=!1,u.newStatePending(!1),u.pivotEvaluationPending=0,u.goToPreviousFormPending(!1),u.revert=!1,u.undo=!1,u.updateQuery=!1,u.urlParameterPending(!1),u.waitForPopStateHandler(!1),u.activePivots={},u.pendingFormCloseStates=[],u.pendingNewHistoryStates=[],u.pendingUrlParameters={},u.navigationHistory.clear(),u.newHistoryState={},u.queryMI=void 0},u.initialState=function(){document.title=l.label("Shell_LoadingTitle"),window.history.replaceState({stackIndex:-1,historyIndex:-1,formName:"NoFormLoaded",placeHolderState:!0},null,null),document.title=l.shell.ProductShortName()},u.createState=function(e,t){var o,n=l.context(e);jQuery.isEmptyObject(u.newHistoryState)||u.pendingNewHistoryStates.push(l.util.objectAssign({},u.newHistoryState)),u.newHistoryState={},u.newHistoryState.stackIndex=l.shell._currentStackIndex,u.newHistoryState.formName=e.getAttribute("data-dyn-form-name"),u.newHistoryState.formID=e.getAttribute("data-dyn-formid"),u.newHistoryState.pivot=u.activePivots,t&&t.preserveForm&&(u.newHistoryState.preserveForm=!0),t&&t.path?u.newHistoryState.path=t.path:u.updateQuery?(u.newHistoryState.path=l.shell.getQueryStringForNewMenuItem(u.queryMI),u.updateQuery=!1,u.queryMI=void 0):n&&""!==l.value(n.MenuItemName)&&l.value(n.AllowRootNavigation)&&(u.newHistoryState.path=l.shell.getQueryStringForNewMenuItem(l.value(n.MenuItemName))),"//"===(null===(o=u.newHistoryState.path)||void 0===o?void 0:o.substring(0,2))&&(u.newHistoryState.path=u.newHistoryState.path.substring(1,u.newHistoryState.path.length)),u.newStatePending(!0),l.log.navigation&&l.log.navigation("Navigation: BrowserHistory -> created new history state for form %s .",u.newHistoryState.formName)},u.requestClose=function(){var e=l.context(l.shell.stack()[l.length(l.shell.stack)-1]);e?("DefaultDashboard"===l.value(e.FormName)&&l.log.navigation&&l.log.navigation("Navigation: form.Close for form: "+l.value(e.FormName)),l.log.navigation&&l.log.navigation("Navigation: form.Close for form: "+l.value(e.FormName)),l.applyFunction(e.Close)):u.goingBack?(l.log.navigation&&l.log.navigation("Navigation: Shell was requested to close a form that was already closed."),u.completeBackNavigation()):l.log.navigation&&l.log.navigation("Navigation: Error, Shell attempted to close the top primary form, but no form was found.")},u.failedClose=function(){if(l.shell.isClosingOpenForms){l.shell.isClosingOpenForms=!1,l.user().updateCompany(l.util.parseQueryString(window.location.search)[l.shell.QueryStringKeys.companyKey.toLowerCase()]),l.shell.closingAllCallback=void 0,"function"==typeof l.shell.closingErrorCallback&&l.shell.closingErrorCallback(),l.shell.closingErrorCallback=void 0;for(var e=l.length(l.shell.stack)-1;0<l.length(l.shell.browserHistory.navigationHistory)&&l.value(l.shell.browserHistory.navigationHistory)[l.length(l.shell.browserHistory.navigationHistory)-1].stackIndex>e;)l.log.navigation&&l.log.navigation("Navigation: navigationHistory.pop() from failedClose - isClosingOpenForms."),l.shell.browserHistory.navigationHistory.pop();$.when(l.deferred.onTrue(function(){return 0===l.value(l.async.pending)})).done(function(){0<=e?l.shell.activateElement(l.value(l.shell.stack)[e]):(l.shell.goHome(),e=0),l.shell._currentStackIndex=e,l.shell.browserHistory.clearForward(),l.shell.resetShellOnNavigation(),l.error({Message:l.label("Shell_AbortedNavigation"),Label:"Shell_AbortedNavigation"})})}else{for(var t=void 0;0<this.pendingFormCloseStates.length;)t=this.pendingFormCloseStates.pop(),l.log.navigation&&l.log.navigation("Navigation: navigationHistory.push failedClose"),this.navigationHistory.push(t),history.pushState(t,null,null);$(document).trigger("updateUtilLocationQuery"),this.goingBack=!1,this.isExiting=!1}},u.addPivot=function(t){var o=t.activeItemName();0<o.length&&t.Root&&(u.pivotEvaluationPending++,l.observe(t.Root.ReadyState,function(e){if(e===l.ui.ReadyState.ready||e===l.ui.ReadyState.closed||e===l.ui.ReadyState.aborted)return u.pivotEvaluationPending--,e===l.ui.ReadyState.ready&&u.activePivots[t.Name]!==o&&l.value(t.IsPageView)&&(u.activePivots[t.Name]=o,u.newStatePending(!0)),!1}))},u.changePivot=function(e){0<e.activeItemName().length&&(jQuery.isEmptyObject(u.activePivots)&&history&&history.state&&(u.activePivots=jQuery.extend(!0,{},history.state.pivot)),u.addPivot(e))},u.clearPivots=function(){u.activePivots={}},u.clearForward=function(){u.duplicateRecord||(l.shell.setDocumentTitle(l.shell.primaryFormCaption()),l.log.navigation&&l.log.navigation("Navigation: push null state to clear forward"),window.history.pushState(history.state,null,null),u.duplicateRecord=!0,u.clearPivots(),$(document).trigger("updateUtilLocationQuery"))},u.write=function(){if(jQuery.isEmptyObject(u.newHistoryState)&&(u.newHistoryState=jQuery.extend(!0,{},history.state),u.newHistoryState.path=window.location.search,u.newHistoryState.preserveForm=!0),u.newHistoryState.pivot=u.activePivots,u.goingBack)u.goingBack=!1;else{var e=u.newHistoryState.path?u.newHistoryState.path:null;u.newHistoryState.historyIndex=l.length(u.navigationHistory),l.log.navigation&&l.log.navigation("Navigation: navigationHistory.push write"),u.navigationHistory.push(u.newHistoryState),u.duplicateRecord?(l.log.navigation&&l.log.navigation("Navigation: replace state for duplicate record"),history.replaceState(u.newHistoryState,null,e),u.duplicateRecord=!1):(l.log.navigation&&l.log.navigation("Navigation: push new state"),history.pushState(u.newHistoryState,null,e)),$(document).trigger("updateUtilLocationQuery")}u.newStatePending()&&(u.newStatePending(!1),u.pivotEvaluationPending=0),l.log.navigation&&l.log.navigation("Navigation: BrowserHistory -> Adding to history with form %s, the new stack height will be: %d.",u.newHistoryState.formName,u.newHistoryState.stackIndex+1),l.shell.setDocumentTitle(l.shell.primaryFormCaption()),u.clearPivots(),u.newHistoryState={}},u.completeBackNavigation=function(){if(u.goingBack){u.pendingFormCloseStates.shift();var e=history.state;if(e){var t=e.stackIndex,o=l.shell.stack()[t];if(o){o!==l.shell.getActiveForm()&&(l.shell.activateElement(o),l.shell._currentStackIndex=t);var n=l.context(o);n&&l.value(n.IsActive)&&0!==Object.keys(e.pivot).length&&o.getAttribute("id")&&(l.value(n.ShowLinkToGridView)&&n.OpenGridView?l.getFunction(n.OpenGridView)():Object.keys(e.pivot).forEach(l.shell.selectTabs,e.pivot))}else if(0===u.pendingFormCloseStates.length){if(l.shell.canGoBack())return l.shell.trimStack(t),void l.shell.browserHistory.goToPreviousFormPending(!0);l.shell.restartNavigationStack()}}for(;0<u.pendingFormCloseStates.length&&u.pendingFormCloseStates[0].preserveForm;)u.pendingFormCloseStates.shift();0<u.pendingFormCloseStates.length?u.requestClose():(u.goingBack=!1,l.async(function(){l.value(l.shell.browserHistory.goToPreviousFormPending)||(u.clearForward(),l.shell.resetShellOnNavigation())}),l.shell.isCurrentFormDefaultForm()&&$.when(l.deferred.onTrue(function(){return 0===l.value(l.async.pending)})).done(function(){l.shell.refreshData(!1)}))}else if(l.shell.isClosingOpenForms){l.log.navigation&&l.log.navigation("Navigation: navigationHistory.pop() from completeBackNavigation - isClosingOpenForms");var i=u.navigationHistory.pop();if(i){for(var r=1,a=l.value(u.navigationHistory)[l.length(u.navigationHistory)-1];a&&a.stackIndex===i.stackIndex;)l.log.navigation&&l.log.navigation("Navigation: navigationHistory.pop() from completeBackNavigation - isClosingOpenForms - while"),l.shell.browserHistory.navigationHistory.pop(),a=l.value(u.navigationHistory)[l.length(u.navigationHistory)-1],r++;l.shell.browserHistory.undo=!0,l.shell.browserHistory.waitForPopStateHandler(!0),history.go(-r)}}else if(l.shell.canGoBack())l.log.navigation&&l.log.navigation("Navigation: completeBackNavigation with server initiated close."),l.shell.browserHistory.goToPreviousFormPending(!0);else if(l.value(l.shell.browserHistory.newStatePending)){l.log.navigation&&l.log.navigation("Navigation: a close was initiated while we were waiting to write a new state.");var s=l.shell.browserHistory.newStatePending.valueChanged.subscribe(function(e){l.value(e)||(l.shell.browserHistory.goToPreviousFormPending(!0),l.shell.browserHistory.newStatePending.valueChanged.unsubscribe(s))})}},u.activeFormHasMultipleReferences=function(){if(u.navigationHistory&&1<l.length(u.navigationHistory)){var e=u.navigationHistory()[l.length(u.navigationHistory)-1].stackIndex;return u.checkForReferences(e)}return!1},u.checkForReferences=function(e){for(var t=l.length(u.navigationHistory)-2;0<=t;t--)if(u.navigationHistory()[t].stackIndex===e)return!0;return!1},u.removeExtraNavigationHistoryEntries=function(e){l.log.navigation&&l.log.navigation("Navigation: removeExtraNavigationHistoryEntries called.");for(var t=0,o=l.length(u.navigationHistory)-2;0<=o&&u.navigationHistory()[o].stackIndex===e;o--)l.log.navigation&&l.log.navigation("Navigation: navigationHistory.pop() from removeExtraNavigationHistoryEntries."),u.navigationHistory.pop(),t++;0!==t&&(l.log.navigation&&l.log.navigation("Navigation: Removed %s extra history entries.",t),l.shell.browserHistory.undo=!0,l.shell.browserHistory.waitForPopStateHandler(!0),history.go(-t))},u.backNavigationTelemetry=function(e){var t="";history.state&&history.state.formName&&(t=history.state.formName);var o=l.context(l.shell.getActiveForm()),n={extendedData:t,userDefined1:Number(u.backNavigationInitiatedByBrowser),userDefined2:e};l.telemetry.addFormActionEvent(o,l.telemetry.ActionEvents.backNavigation,n),l.shell.browserHistory.backNavigationInitiatedByBrowser=!0},u.triggerHistoryOperation=function(e){l.log.navigation&&l.log.navigation("Navigation: browser history operation will be triggered with newStatePending: %s, goToPreviousFormPending: %s, and urlParameterPending: %s.",e.newStatePending,e.goToPreviousFormPending,e.urlParameterPending),e.goToPreviousFormPending&&(u.goToPreviousFormPending._current=!1,l.log.navigation&&l.log.navigation("Navigation: navigationHistory.pop() from async pending."),u.navigationHistory.pop(),u.waitForPopStateHandler(!0),e.newStatePending?u.undo=!0:u.revert=!0,history.back()),e.newStatePending&&l.observe(u.waitForPopStateHandler,function(e){if(!e){if(l.log.navigation&&l.log.navigation("Navigation: navigationHistory.write() from async pending."),u.goingBack&&(u.goingBack=!1),0<u.pendingNewHistoryStates.length){var t=l.util.objectAssign({},u.newHistoryState);u.pendingNewHistoryStates.forEach(function(e){u.newHistoryState=e,u.write()}),u.pendingNewHistoryStates=[],u.newHistoryState=t}return u.write(),!1}}),e.urlParameterPending&&(e.goToPreviousFormPending||l.shell._updateUrlParameters(u.pendingUrlParameters),u.pendingUrlParameters={},u.urlParameterPending._current=!1)},l.observe(l.options(function(){return{goToPreviousFormPending:u.goToPreviousFormPending,newStatePending:u.newStatePending,urlParameterPending:u.urlParameterPending}},l.async.pending),function(e){l.util.isFlightEnabled("CLIDisableDelayedHistoryOperation")||!u.undo&&!u.revert?u.triggerHistoryOperation(e):(l.log.navigation&&l.log.navigation("Navigation: Delaying browser history operation because undo: %s, revert: %s",u.undo,u.revert),setTimeout(function(){l.log.navigation&&l.log.navigation("Navigation: Processing delayed browser history operation because undo: %s, revert: %s",u.undo,u.revert),u.triggerHistoryOperation(e)},0))}),window.addEventListener("popstate",function(e){var t=l.shell.navigationPopstateHandler(e);return l.shell.browserHistory.waitForPopStateHandler(!1),t})}($dyn=$dyn||{}),function(v){(v.shell||(v.shell={})).navigationPopstateHandler=function(e){if(v.log.navigation&&v.log.navigation("Navigation: popstate handler -> start of handler."),100<v.shell._popstateLoopCount)return v.logError("Navigation: Unable to complete browser navigation request."),!1;if(v.shell._popstateLoopCount++,v.shell._popstateLoopCountResetId||(v.shell._popstateLoopCountResetId=window.setTimeout(function(){v.shell._popstateLoopCount=0,v.shell._popstateLoopCountResetId=null},100)),null==e.state)return v.log.navigation&&v.log.navigation("Navigation: popstate handler -> Empty popstate event"),!0;if(v.shell.browserHistory.revert){if(v.shell.browserHistory.duplicateRecord)return v.log.navigation&&v.log.navigation("Navigation: popstate handler -> remove duplicate record before making the browser history correction."),v.shell.browserHistory.duplicateRecord=!1,history.back(),!0;var t=v.length(v.shell.browserHistory.navigationHistory)-(e.state.historyIndex+1);if(v.log.navigation&&v.log.navigation("Navigation: popstate handler -> Syncing browser history with client navigation stack, delta = %d",t),0==t){v.shell.browserHistory.revert=!1,v.shell.browserHistory.goingBack=!1,v.shell.browserHistory.undo&&(v.log.navigation&&v.log.navigation("Navigation: popstate handler -> undo and revert are both true, set undo to false as revert takes precedence."),v.shell.browserHistory.undo=!1);var o=history.state.stackIndex;if(!(d=v.shell.stack()[o]))return v.shell.canGoBack()?(v.shell.browserHistory.goingBack=!0,void history.back()):void v.shell.restartNavigationStack();v.shell.activateElement(d),v.shell._currentStackIndex=o,v.shell.resetShellOnNavigation(),v.shell.browserHistory.clearForward()}else history.go(t);return!0}if(v.shell.browserHistory.undo)return v.log.navigation&&v.log.navigation("Navigation: popstate handler -> undo flag was true, set the flag to false and ignore this popstate event."),!(v.shell.browserHistory.undo=!1);if(v.shell.isProcessing()||v.value(v.shell.browserHistory.newStatePending)||v.shell.browserHistory.pivotEvaluationPending||v.shell.isClosingOpenForms){var n=v.length(v.shell.browserHistory.navigationHistory)-(e.state.historyIndex+1)+(v.shell.browserHistory.duplicateRecord?1:0);return 0<n&&(v.log.navigation&&v.log.navigation("Navigation: popstate handler -> Until the interactions are processed, we need to unwind the user back action.  Go forward %d browser history entries.",n),e.state.placeHolderState&&(document.title=v.label("Shell_LoadingTitle")),v.shell.browserHistory.undo=!0,history.go(n)),!0}var i=v.flyout.flyoutManager.areAnyFlyoutsOpen();if(!v.shell.browserHistory.goingBack&&(i||v.shell.getCurrentDialog())){var r=v.length(v.shell.browserHistory.navigationHistory)-(e.state.historyIndex+1)+(v.shell.browserHistory.duplicateRecord?1:0);return v.log.navigation&&v.log.navigation("Navigation: popstate handler -> Browser back command issued when flyout or dialog was open"),i?(v.log.navigation&&v.log.navigation("Navigation: popstate handler -> click to dismiss flyout"),$("body").trigger(jQuery.Event("click"))):$(v.shell.getCurrentDialog()).trigger(jQuery.Event("keydown",{which:v.ui.KeyCodes.esc,shiftKey:!1,ctrlKey:!1,metaKey:!1,altKey:!1})),0<r?(v.log.navigation&&v.log.navigation("Navigation: popstate handler -> Until the flyouts or dialogs are closed, we need to unwind the user action.  Go forward %d browser history entries.",r),e.state.placeHolderState&&(document.title=v.label("Shell_LoadingTitle")),v.shell.browserHistory.undo=!0,history.go(r)):v.shell.setDocumentTitle(v.shell.primaryFormCaption()),i&&$.when(v.deferred.onTrue(function(){return 0===v.value(v.async.pending)}).done(function(){v.log.navigation&&v.log.navigation("Navigation: popstate handler -> non-dialog flyouts should not block the original user interaction with the browser back button.  Replay that action if that the flyout is closed."),v.flyout.flyoutManager.areAnyFlyoutsOpen()||(v.log.navigation&&v.log.navigation("Navigation: popstate handler -> go(-%d).",r),history.go(-r))})),!0}if(v.shell.browserHistory.duplicateRecord)return v.log.navigation&&v.log.navigation("Navigation: popstate handler -> Browser back request when duplicate record is present, executing window.history.back()."),v.shell.browserHistory.duplicateRecord=!1,window.history.back(),!0;if(v.length(v.shell.browserHistory.navigationHistory)===e.state.historyIndex+1)return v.log.navigation&&v.log.navigation("Navigation: shell stack is already at the position provided by the popstate event."),!0;if(v.length(v.shell.browserHistory.navigationHistory)<e.state.historyIndex+1)return v.log.navigation&&v.log.navigation("Navigation: shell stack is shorter than the position provided by the popstate event."),!0;var a=v.length(v.shell.browserHistory.navigationHistory)-(e.state.historyIndex+1);if(v.popout&&e.state.placeHolderState)return 1==a?(v.shell.browserHistory.undo=!0,v.shell.isExiting=!1,history.go(1)):v.log.navigation&&v.log.navigation("Navigation: Deep back navigation was requested in a popout. This navigation event is not supported."),!0;v.log.navigation&&v.log.navigation("Navigation: popstate handler -> Received request to go back %d steps in the browser navigation history.",a),v.shell.browserHistory.backNavigationTelemetry(a),v.shell.browserHistory.goingBack=!0,v.shell.isExiting=!!e.state.placeHolderState;for(var s,l=0,u=0;u<a;u++)v.log.navigation&&v.log.navigation("Navigation: navigationHistory.pop() from popstate handler."),s=v.shell.browserHistory.navigationHistory.pop(),v.shell.browserHistory.pendingFormCloseStates.push(s),!s.preserveForm&&v.shell.stack()[s.stackIndex]||l++;if(0<a-l)v.shell.browserHistory.requestClose();else if(history.state&&v.shell.stack()[history.state.stackIndex]){var d=v.shell.stack()[history.state.stackIndex],c=v.context(d),p=c.ActiveElement(),h=!1;if(p){var m=v.context(p);m&&(m.updateValue&&m.updateValue(!0),m.isDisplayedValueDirty&&(h=m.isDisplayedValueDirty()))}c.HasUnchangedInvalidControls()||!c.AreDataSourcesDirty()&&!h||c.executeShortcuts(!1,"SaveRecord"),$.when(v.deferred.onTrue(function(){return 0===v.value(v.async.pending)})).done(function(){!c||c.HasInvalidControls()||c.AreDataSourcesDirty()?v.shell.browserHistory.failedClose():(v.shell.browserHistory.pendingFormCloseStates=[],v.shell.browserHistory.completeBackNavigation())})}else v.shell.browserHistory.pendingFormCloseStates=[],v.shell.browserHistory.completeBackNavigation()}}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(y){var e,t;function o(e,t){this.clickHandler=e,this.blockingDivClasses=t,this.blocksInitialized=!1,this.blocksShown=!1,this.blockingDivClasses||(this.blockingDivClasses=[]),this.surroundedElement=null,this.topBlock=null,this.topBlockUsed=!1,this.rightBlock=null,this.rightBlockUsed=!1,this.bottomBlock=null,this.bottomBlockUsed=!1,this.leftBlock=null,this.leftBlockUsed=!1,this.messagingBlock=null,this.messagingBlockUsed=!1}e=y.shell||(y.shell={}),o.prototype.init=function(){if(!this.blocksInitialized){var e=$(y.shell.mainPane);this.topBlock||(this.topBlock=$("<div tabindex='-1'></div>"),this.topBlockUsed=!1,e.append(this.topBlock),this.topBlock[0].style.position="absolute",this.topBlock[0].style.display="none",this.messagingBlock||(this.messagingBlock=$("<div class='blockingDivMessaging'></div>"),this.messagingBlockUsed=!1,this.topBlock.append(this.messagingBlock),this.messagingBlock[0].style.position="absolute",this.messagingBlock[0].style.display="none")),this.bottomBlock||(this.bottomBlock=$("<div tabindex='-1'></div>"),this.bottomBlockUsed=!1,e.append(this.bottomBlock),this.bottomBlock[0].style.position="absolute",this.bottomBlock[0].style.display="none"),this.leftBlock||(this.leftBlock=$("<div tabindex='-1'></div>"),this.leftBlockUsed=!1,e.append(this.leftBlock),this.leftBlock[0].style.position="absolute",this.leftBlock[0].style.display="none"),this.rightBlock||(this.rightBlock=$("<div tabindex='-1'></div>"),this.rightBlockUsed=!1,e.append(this.rightBlock),this.rightBlock[0].style.position="absolute",this.rightBlock[0].style.display="none"),this.registerClickHandler(),this.addBlockingDivClasses(),this.blocksInitialized=!0}},o.prototype.show=function(e){var t=$(e),o=$(y.shell.mainPane);if($.contains(o[0],t[0])){this.blocksInitialized||this.init(),this.surroundedElement=e;var n=o.offset(),i=n.top,r=n.left,a=o.height(),s=(o.width(),t.offset()),l=s.top,u=s.left,d=t.outerHeight(),c=t.outerWidth(),p=l-i,h=u-r,m=a-p-d,v=p;v<0&&(v=0);var g=h;g<0&&(g=0),this.topBlock.css({display:"block",top:0,left:0,right:0,height:+v+"px"}),this.topBlockUsed=!0,this.bottomBlock.css({display:"block",top:+(p+d)+"px",left:0,right:0,bottom:0}),this.bottomBlockUsed=!0,this.leftBlock.css({display:"block",top:+p+"px",left:0,height:+d+"px",width:+g+"px"}),this.leftBlockUsed=!0,this.rightBlock.css({display:"block",top:+p+"px",left:+(h+c)+"px",right:0,bottom:+m+"px"}),this.rightBlockUsed=!0,this.blocksShown=!0}},o.prototype.display=function(){this.blocksShown=!0,this.topBlock&&this.topBlockUsed&&this.topBlock.css("display","block"),this.bottomBlock&&this.bottomBlockUsed&&this.bottomBlock.css("display","block"),this.leftBlock&&this.leftBlockUsed&&this.leftBlock.css("display","block"),this.rightBlock&&this.rightBlockUsed&&this.rightBlock.css("display","block")},o.prototype.hide=function(){this.blocksShown=!1,this.topBlock&&this.topBlock.css("display","none"),this.bottomBlock&&this.bottomBlock.css("display","none"),this.leftBlock&&this.leftBlock.css("display","none"),this.rightBlock&&this.rightBlock.css("display","none")},o.prototype.showMessagingDiv=function(e){if(this.messagingBlock&&(this.messagingBlock[0].style.display="block",this.messagingBlockUsed=!0,e)){var t=e.getBoundingClientRect(),o=t.left+t.width/2-this.messagingBlock.outerWidth()/2;this.messagingBlock[0].style.left=o.toString()+"px"}},o.prototype.hideMessagingDiv=function(){this.messagingBlock&&(this.messagingBlock[0].style.display="none"),this.messagingBlockUsed=!1},o.prototype.setMessagingContent=function(e){this.messagingBlock&&(this.messagingBlock.empty(),e&&this.messagingBlock.append(e))},o.prototype.addBlockingDivClasses=function(){var t,e;if(this.blockingDivClasses&&this.blockingDivClasses.length)try{for(var o=__values(this.blockingDivClasses),n=o.next();!n.done;n=o.next()){var i=n.value;this.topBlock&&this.topBlock[0].classList.add(i),this.bottomBlock&&this.bottomBlock[0].classList.add(i),this.leftBlock&&this.leftBlock[0].classList.add(i),this.rightBlock&&this.rightBlock[0].classList.add(i)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},o.prototype.removeBlockingDivClass=function(e){this.topBlock&&this.topBlock[0].classList.remove(e),this.bottomBlock&&this.bottomBlock[0].classList.remove(e),this.leftBlock&&this.leftBlock[0].classList.remove(e),this.rightBlock&&this.rightBlock[0].classList.remove(e)},o.prototype.destroy=function(){this.blocksInitialized=!1,this.blocksShown=!1,this.topBlock&&this.topBlock.remove(),this.bottomBlock&&this.bottomBlock.remove(),this.leftBlock&&this.leftBlock.remove(),this.rightBlock&&this.rightBlock.remove(),this.topBlock=null,this.topBlockUsed=!1,this.bottomBlock=null,this.bottomBlockUsed=!1,this.leftBlock=null,this.leftBlockUsed=!1,this.rightBlock=null,this.rightBlockUsed=!1,this.messagingBlockUsed=!1,this.messagingBlock=null,this.surroundedElement=null},o.prototype.registerClickHandler=function(){this.clickHandler&&(this.topBlock[0].addEventListener("click",this.clickHandler,!0),this.bottomBlock[0].addEventListener("click",this.clickHandler,!0),this.leftBlock[0].addEventListener("click",this.clickHandler,!0),this.rightBlock[0].addEventListener("click",this.clickHandler,!0))},t=o,e.surroundingBlockingDiv=t}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(c){var e,t;function d(e,t){this.clickHandler=e,this.blockingDivClasses=t,this.blocksShown=!1,this.blockingDivs=[],this.blockingDivClasses||(this.blockingDivClasses=[])}e=c.shell||(c.shell={}),d.findClosest=function(e,t,o,n,i){var r,a,s,l=8===i||2===i,u=$(e[t]).offset();switch(i){case 8:r=u.top;break;case 2:r=u.top+e[t].offsetHeight;break;case 4:r=u.left;break;case 6:r=u.left+e[t].offsetWidth}r=Math.ceil(r);for(var d=0;d<e.length;d++)if(d!==t){var c=$(e[d]).offset(),p=l?c.left:c.top,h=l?p+e[d].offsetWidth:p+e[d].offsetHeight;if(p<=n&&o<=p||h<=n&&o<=h||p<=o&&n<=h){var m=void 0;switch(i){case 8:var v=Math.ceil(c.top+e[d].offsetHeight);v<=r&&(m=r-v);break;case 2:var g=Math.ceil(c.top);r<=g&&(m=g-r);break;case 4:var y=Math.ceil(c.left+e[d].offsetWidth);y<=r&&(m=r-y);break;case 6:var f=Math.ceil(c.left);r<=f&&(m=f-r)}void 0!==m&&(void 0===a||m<a)&&(a=m,s=d)}}return{distance:a,index:s}},d.prototype.show=function(e){if(this.blockingDivs.length&&this.destroy(),e&&0!==e.length){for(var t=c.shell.mainPane,o=$(t).offset(),n={bottom:o.top+t.offsetHeight,left:o.left,right:o.left+t.offsetWidth,top:o.top},i=0;i<e.length;i++){var r=new c.shell.surroundingBlockingDiv(this.clickHandler,this.blockingDivClasses);r.init(),r.surroundedElement=e[i];var a=$(e[i]).offset(),s=e[i].offsetHeight,l=e[i].offsetWidth,u={bottom:a.top+s,height:s,index:i,left:a.left,right:a.left+l,top:a.top,width:l},d={leftWidth:this.createLeftBlock(e,r,u,n),rightWidth:this.createRightBlock(e,r,u,n)};this.createTopBlock(e,i,r,u,n,d),this.createBottomBlock(e,i,r,u,n,d),r.blocksShown=!0,this.blockingDivs.push(r)}this.blocksShown=!0}},d.prototype.display=function(){var t,e;try{for(var o=__values(this.blockingDivs),n=o.next();!n.done;n=o.next())n.value.display()}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this.blocksShown=!0},d.prototype.hide=function(){var t,e;try{for(var o=__values(this.blockingDivs),n=o.next();!n.done;n=o.next())n.value.hide()}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this.blocksShown=!1},d.prototype.destroy=function(){var t,e;try{for(var o=__values(this.blockingDivs),n=o.next();!n.done;n=o.next())n.value.destroy()}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this.blockingDivs.length=0,this.blocksShown=!1},d.prototype.addClass=function(e){var t,o;if(-1===this.blockingDivClasses.indexOf(e)){try{for(var n=__values(this.blockingDivs),i=n.next();!i.done;i=n.next()){var r=i.value;r.blockingDivClasses.push(e),r.addBlockingDivClasses()}}catch(e){t={error:e}}finally{try{i&&!i.done&&(o=n.return)&&o.call(n)}finally{if(t)throw t.error}}this.blockingDivClasses.push(e)}},d.prototype.removeClass=function(e){var t,o,n=this.blockingDivClasses.indexOf(e);if(-1<n){try{for(var i=__values(this.blockingDivs),r=i.next();!r.done;r=i.next()){var a=r.value,s=a.blockingDivClasses.indexOf(e);-1<s&&(a.blockingDivClasses.splice(s,1),a.removeBlockingDivClass(e))}}catch(e){t={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}this.blockingDivClasses.splice(n,1)}},d.prototype.addMessagingContent=function(e,t){var o,n;try{for(var i=__values(this.blockingDivs),r=i.next();!r.done;r=i.next()){var a=r.value;if(e===a.surroundedElement){a.setMessagingContent(t),null===t?a.hideMessagingDiv():a.showMessagingDiv(e);break}}}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}},d.prototype.hasMessagingContent=function(e){var t,o;try{for(var n=__values(this.blockingDivs),i=n.next();!i.done;i=n.next()){var r=i.value;if(e===r.surroundedElement)return r.messagingBlockUsed}}catch(e){t={error:e}}finally{try{i&&!i.done&&(o=n.return)&&o.call(n)}finally{if(t)throw t.error}}},d.prototype.createLeftBlock=function(e,t,o,n){var i=d.findClosest(e,o.index,o.top,o.bottom,4),r=i.distance;if(t.leftBlockUsed=!0,void 0===r)r=o.left-n.left;else if(0===r)t.leftBlockUsed=!1;else if(void 0!==i.index&&this.blockingDivs.length>i.index&&this.blockingDivs[i.index].rightBlockUsed){var a=Math.ceil(this.blockingDivs[i.index].rightBlock[0].offsetWidth);a===r?(r=0,t.leftBlockUsed=!1):r-=a}return t.leftBlockUsed&&t.leftBlock.css({display:"block",height:"".concat(o.height,"px"),left:"".concat(o.left-r,"px"),top:"".concat(o.top,"px"),width:"".concat(r,"px")}),r},d.prototype.createRightBlock=function(e,t,o,n){var i=d.findClosest(e,o.index,o.top,o.bottom,6),r=i.distance;if(t.rightBlockUsed=!0,void 0===r)r=n.right-o.right;else if(0===r)t.rightBlockUsed=!1;else if(void 0!==i.index&&this.blockingDivs.length>i.index&&this.blockingDivs[i.index].leftBlockUsed){var a=Math.ceil(this.blockingDivs[i.index].leftBlock[0].offsetWidth);a===r?(r=0,t.rightBlockUsed=!1):r-=a}return t.rightBlockUsed&&t.rightBlock.css({display:"block",height:"".concat(o.height,"px"),left:"".concat(o.right,"px"),top:"".concat(o.top,"px"),width:"".concat(r,"px")}),r},d.prototype.createTopBlock=function(e,t,o,n,i,r){var a=d.findClosest(e,t,n.left-r.leftWidth,n.right+r.rightWidth,8),s=a.distance;if(o.topBlockUsed=!0,void 0===s)s=n.top-i.top;else if(0===s)o.topBlockUsed=!1;else if(void 0!==a.index&&this.blockingDivs.length>a.index&&this.blockingDivs[a.index].bottomBlockUsed){var l=Math.ceil(this.blockingDivs[a.index].bottomBlock[0].offsetHeight);l===s?(s=0,o.topBlockUsed=!1):s-=l}if(o.topBlockUsed){var u=r.leftWidth+n.width+r.rightWidth;o.topBlock.css({display:"block",height:"".concat(s,"px"),left:"".concat(n.left-r.leftWidth,"px"),top:"".concat(n.top-s,"px"),width:"".concat(u,"px")})}},d.prototype.createBottomBlock=function(e,t,o,n,i,r){var a=d.findClosest(e,t,n.left-r.leftWidth,n.right+r.rightWidth,2),s=a.distance;if(o.bottomBlockUsed=!0,void 0===s)s=i.bottom-n.bottom;else if(0===s)o.bottomBlockUsed=!1;else if(void 0!==a.index&&this.blockingDivs.length>a.index&&this.blockingDivs[a.index].topBlockUsed){var l=Math.ceil(this.blockingDivs[a.index].topBlock[0].offsetHeight);l===s?(s=0,o.bottomBlockUsed=!1):s-=l}if(o.bottomBlockUsed){var u=r.leftWidth+n.width+r.rightWidth;o.bottomBlock.css({display:"block",height:"".concat(s,"px"),left:"".concat(n.left-r.leftWidth,"px"),top:"".concat(n.bottom,"px"),width:"".concat(u,"px")})}},t=d,e.multiElementSurroundingBlockingDiv=t}($dyn=$dyn||{}),function(u){var e,t;function o(){var l=this;this._navBarHeights={21:33,30:48},this._previousTheme="",this._previousDensity="",this._themes=["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14"],this._densities=["21","30"],this._defaultTheme=-1,this._defaultDensity=-1,this._urlDensity="",this._urlTheme="",this._setCurrentDensity=function(e){e&&l._isDensityValid(e)&&(l._urlDensity=e,u.setObservableValue(u.user(),"Density",e))},this._getCurrentDensity=function(){var e=u.user();return e?u.value(e.Density):l._defaultDensity},this._getCurrentTheme=function(){var e=u.user();return e?u.value(e.Theme):l._defaultTheme},this._getDefaultTheme=function(){return l._defaultTheme},this._getDefaultDensity=function(){return l._defaultDensity},this._getCurrentLocalTheme=function(){var e,t;u.shell.canUseLocalStorage&&(t=localStorage.getItem("theme"))&&(e=JSON.parse(t)),null==t||u.shell.isSingleThemed?l._setDefautTheme():(l._previousDensity=parseInt(e.cssLinkDensity),l._previousTheme=parseInt(e.cssLinkTheme));var o=l._getCoreCssLink(l._previousDensity,l._previousTheme);u.shell.isSingleThemed||(document.head.appendChild(o),l._appendCustomCss(l._previousDensity,l._previousTheme),o.onload=function(){u.ui.theme.invalidate(),u.shell.displayFirstRendering()})},this._getCssId=function(e,t,o){var n=e+"_"+t+"_"+o;return u.debug.useRTL&&(n+="_rtl"),"debug"===u.version.buildType&&(n+="_debug"),n},this._setCurrentTheme=function(e){e&&l._isThemeValid(e)&&(l._urlTheme=e,u.setObservableValue(u.user(),"Theme",e))},this._singleThemeUpdate=function(){l._setDefautTheme();var e=0<l._urlDensity.length?l._urlDensity:l._previousDensity,t=0<l._urlTheme.length?l._urlTheme:u.shell.buildThemeValue,o={coreLink:{id:"core_"+e+"_"+t}},n={coreLink:l._getCoreCssLink(e,t)},i=!0;if(u.util.isRTLMode())document.getElementById(o.coreLink.id+"_debug")&&(o={coreLink:{id:o.coreLink.id+"_debug"}});else{var r="debug"===u.version.buildType?"_rtl_debug":"_rtl";document.getElementById(o.coreLink.id+r)?o={coreLink:{id:o.coreLink.id+r}}:i=!1}i&&document.getElementById(o.coreLink.id)?l._replaceTheme(n,o,e,t):u.util.isFlightEnabled(u.reactGrid.featureName)&&t&&"0"!==t&&l.updateReactTheme()},this._updateThemeAndDensity=function(){var e=u.user();if(e){var t=0<l._urlDensity.length?l._urlDensity:u.value(e.Density),o=0<l._urlTheme.length?l._urlTheme:u.value(e.Theme),n=l._getValidThemeAndDensity(o,t);if((l._previousDensity!==n.density||l._previousTheme!==n.theme)&&n.theme!==l._defaultTheme&&n.density!==l._defaultDensity){var i={coreLink:l._getCoreCssLink(n.density,n.theme)},r=l._getCssId("core",l._previousDensity,l._previousTheme),a={coreLink:document.getElementById(r)};l._replaceTheme(i,a,n.density,n.theme)}l._previousDensity=n.density,l._previousTheme=n.theme,$(document).trigger("densitychanged",n.density),u.ui.theme.invalidate()}},this.updateReactTheme=function(){var e=u.ui.theme.get();e&&(ControlLibrary.ThemeManager.instance.setCurrentTheme("AXTheme",{colors:{Accent:e.accent,AccentDark:e.accentDark,AccentDarkDark:e.accentDarkDark,AccentLight:e.accentLight,AccentLightLight:e.accentLightLight,AlertError:e.errorStatusColor,AlertWarning:e.warningStatusColor,button:{BorderFocused:e.dark,icon:e.accent,iconHover:e.reactGridLink,lightIcon:{disabled:{Color:e.disabled},enabled:{Color:e.darkGray6}},lightPrimary:{enabled:{Color:e.accentDarkDark}},lightSecondary:{disabled:{Color:e.disabled},enabled:{Color:e.darkGray6}},pressed:e.buttonDefaultPressedBackground,primary:{disabled:{BackgroundColor:e.darkGray},enabled:{active:{BackgroundColor:e.buttonPressedBackground,Color:e.light},BackgroundColor:e.buttonBackgroundColor,Color:e.accent,hover:{BackgroundColor:e.buttonToggledBackground}}},secondary:{disabled:{BackgroundColor:e.appBarDisabledColor,Color:e.darkGray6},enabled:{active:{BackgroundColor:e.lightGray4,Color:e.light},BackgroundColor:e.lightGray,Color:e.darkGray,hover:{BackgroundColor:e.lightGray3}}}},card:{footer:{backgroundColor:e.accent,TextColor:e.light}},checkBox:{Color:e.listActiveCheckboxColor,disabled:{Color:e.disabled},focused:{Color:e.checkBoxViewModeColor},hovered:{Color:e.checkBoxViewModeColor},notEditable:{Color:e.checkBoxViewModeColor}},comboBox:{item:{ActiveBackgroundColor:e.toolbarHover,ActiveColor:e.toolbarText,HoveredBackgroundColor:e.toolbarHover,HoveredColor:e.toolbarText}},dialog:{header:{BackgroundColor:e.lightGray2}},FocusedBorderColor:e.focusOutlineColor,grid:{borderColor:e.borderColor,checkBox:{disabledColor:e.checkboxDisabledHover,hoveredColor:e.checkboxEnabledHover},columnHeader:{TextColor:e.darkDarkGray,TextColorOnHover:e.columnHeaderTextOnHover},footer:{buttonBackgroundColor:e.lightGray2,buttonBorderColor:e.lightGray4,hoverButtonBackgroundColor:e.lightGray0,hoveredSVGColor:e.darkDarkGray,svgColor:e.darkGray9},header:{BackgroundColor:e.white,BorderColor:e.focusOutlineColor,Color:e.labelTextColor},image:{PlaceholderColor:e.darkGray},linesColor:e.borderColor,markingColumn:{activeMarkedBackgroundColor:e.accentLightLight,headerCheckboxBorderColor:e.labelTextColor,inactiveMarkedBackgroundColor:e.accentLightLightLight,markedListBackgroundColor:e.accent,markedSVGBackgroundColor:e.accent,selectedHoverCheckboxBorderColor:e.selectedHoverCheckboxBorderColor,selectedHoverMarkedCheckboxBackgroundColor:e.checkBoxHoverOnColor,unselectedActiveCheckboxBorderColor:e.labelTextColor,unselectedHoverCheckboxBorderColor:e.unselectedHoverCheckboxBorderColor},paging:{BackgroundColor:e.listPaging,ButtonColor:e.darkGray12,HoveredButtonBackgroundColor:e.LightGray5,HoveredButtonColor:e.accent},row:{ActiveBackgroundColor:e.listActiveRowColor,ActiveCellBorderColor:e.listActiveRowColor,ActiveColor:e.fieldTextColor,ActiveEditColor:e.fieldTextColor,GroupHeaderBackgroundColor:e.lightGray2,HoveredBackgroundColor:e.listRowHighlight,HoveredColor:e.fieldTextColor,InactiveBackgroundColor:e.light,MarkedBackgroundColor:e.listMarkRowColor,MarkedColor:e.fieldTextColor},scrollBarColor:e.scrollBarColor,scrollBarColorHover:e.scrollBarColorHover},HoverBorderColor:e.toolbarHover,input:{BackgroundColor:e.lightGray1,BackgroundColorEdit:e.lightGray0},invalidIndicator:{BackgroundColor:e.invalidIndicatorBackground,Color:e.warningStatusColor},LabelColor:e.labelTextColor,listGrid:{sidePanel:{BackgroundColor:e.light},TextColorOnFocus:e.fieldTextColor,TextColorOnHover:e.textColorOnHover,TextLink:e.linkInGridSelectedRow,TextLinkOnFocus:e.reactGridLink},loadingIndicator:{Spinner:e.accentDarkDark},menuButton:{listItem:{BackgroundColor:e.light,EnabledHoverBackgroundColor:e.lightGray2}},navigationBar:{hover:{BackgroundColor:e.lightGray}},navigationPane:{BackgroundColor:e.darkGray},OverlayBackgroundColor:e.appBarFlyoutBackground,PrimaryBorderColor:e.appBarBorderColor,search:{BackgroundColor:"transparent"},SecondaryButtonTextColor:e.darkGray,StaticTextLink:e.accent,TextColor:e.fieldTextColor,TextColorInverted:e.textOnAccent,TextColorOnFocus:e.fieldTextColor,TextColorOnHover:e.textColorOnHover,TextDisabled:e.disabled,TextLink:e.link,TextLinkOnFocus:e.linkInGridSelectedRow,TextLinkOnHover:e.reactGridLinkHover,TextLinkOnHoverSelected:e.linkRowSelectedHover,TextLinkSelected:e.linkInGridSelectedRow,TextSecondaryLight:e.darkGray9,tileCard:{backgroundColor:e.tileColor1,hovered:e.tileColor1Hover,selected:e.tileColor1Selected},waitingIndicator:{BackgroundColor:e.waitingIndicatorBackground,Color:e.errorStatusColor}},scaleFactor:u.value(u.user().Density)/o.baseDensity}),$(document).trigger("themechanged"))},this._isThemeValid=function(e){return 0<=l._themes.indexOf(e.toString())},this._isDensityValid=function(e){return 0<=l._densities.indexOf(e.toString())},this._setDefautTheme=function(){l._previousDensity="30",l._previousTheme="0"},this._getCoreCssLink=function(e,t){var o,n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.id=l._getCssId("core",e,t);var i=Globalize.culture().isRTL||u.debug.useRTL;return o=i&&"debug"===u.version.buildType?"core-rtl.css":i?u.version.fullVerString?"core-rtl.min-"+u.version.fullVerString+".css":"core-rtl.min.css":"debug"===u.version.buildType?"core.css":u.version.fullVerString?"core.min-"+u.version.fullVerString+".css":"core.min.css",n.href=u.shell.rootPath+"Resources/themes/"+e+"/"+t+"/"+o,n},this._getCssLink=function(e,t,o){var n,i=document.createElement("link");i.rel="stylesheet",i.type="text/css";var r=l._getCssId(o.name,e,t);n=Globalize.culture().isRTL||u.debug.useRTL?o.name+"-rtl.css":o.name+".css";var a="WebContent/"+o.model+"/less/"+e+"/"+t+"/"+n,s=document.head.querySelectorAll("[id^="+r+'][href^="'+a+'"]');return 0===s.length&&0<(s=document.head.querySelectorAll("[id^="+r+"]")).length&&(r+="_"+s.length),i.href=u.shell.rootPath+a,i.id=r,i},this._replaceTheme=function(e,t,o,n){var i=!1;if((0<l._previousDensity.toString().length||0<l._previousTheme.toString().length)&&e.coreLink&&!document.getElementById(e.coreLink.id)){l._clearCurrentLocalTheme(),l._saveCurrentLocalTheme(o,n),(t.coreLink?document.getElementById(t.coreLink.id):null)||u.shell.isShellInitializing()||l._previousDensity===l._defaultDensity||l._previousTheme===l._defaultTheme||u.logError("Shell: could not find old theme %s, density %s",l._previousTheme,l._previousDensity),u.shell.isSingleThemed||$("#mainContainer").fadeOut(u.ui.motionTiming.basic);var r=u.async(function(){u.shell.hideSplash||($("#splashScreen").fadeOut(u.ui.motionTiming.basic,function(){i=!1,$("#mainContainer").fadeIn(u.ui.motionTiming.basic),r=void 0}),u.logError("Shell: did not receive CSS prior to timeout from server"))},2e4),a=u.async(function(){u.shell.hideSplash||u.shell.isSingleThemed||(console.log("app:"+performance.now()),$("#splashScreen").css("visibility","visible"),$("#splashScreen").css("display","block"),i=!0,a=void 0,$("#splashScreen").fadeIn(u.ui.motionTiming.basic))},1500);l._appendCustomCss(o,n),document.getElementById(e.coreLink.id)?(i&&($("#splashScreen").fadeOut(u.ui.motionTiming.basic),i=!1),$("#mainContainer").fadeIn(u.ui.motionTiming.basic)):(u.async.pending.increment("Adding new Theme file to body"),document.head.appendChild(e.coreLink),e.coreLink.onload=function(){r&&r.cancel(),a&&a.cancel(),setTimeout(function(){l._cleanupThemesInDom(e),u.async.pending.decrement("Adding new Theme file to body")}),i&&($("#splashScreen").fadeOut(u.ui.motionTiming.basic),i=!1),$("#mainContainer").fadeIn(u.ui.motionTiming.basic),u.util.isFlightEnabled(u.reactGrid.featureName)&&l.updateReactTheme()})}},this._cleanCustomCss=function(){if(u.appConfig&&u.appConfig.styles){var e=void 0;for(var t in u.appConfig.styles)u.appConfig.styles[t].name&&u.appConfig.styles[t].model&&(e=l._getCssId(u.appConfig.styles[t].name,l._previousDensity,l._previousTheme),l._clearOldTheme(e,u.appConfig.styles[t].name))}},this._appendCustomCss=function(e,t){if(u.appConfig&&u.appConfig.styles){var o=void 0;for(var n in u.appConfig.styles)u.appConfig.styles[n].name&&u.appConfig.styles[n].model&&(o=l._getCssLink(e,t,{cssName:n,name:u.appConfig.styles[n].name,model:u.appConfig.styles[n].model}),document.head.appendChild(o))}},this._clearOldTheme=function(e,t){var o=0;if(document.head.querySelectorAll("[id="+e+"]")[0]){var n=document.head.querySelectorAll("[id^="+t+"_]");if(0<n.length)for(o=0;o<n.length;o++)n[o].id!==e&&n[o].remove()}},this._cleanupThemesInDom=function(e){l._clearOldTheme(e.coreLink.id,"core"),l._cleanCustomCss()},this._getValidThemeAndDensity=function(e,t){return null!=e&&l._isThemeValid(e)||(e=l._defaultTheme),null!=t&&l._isDensityValid(t)||(t=l._defaultDensity),{theme:e,density:t}}}e=u.shell||(u.shell={}),o.prototype._saveCurrentLocalTheme=function(e,t){if(u.shell.canUseLocalStorage)try{localStorage.setItem("theme",JSON.stringify({cssLinkDensity:e,cssLinkTheme:t}))}catch(e){u.util.localStorageErorrHandler(e.name)}},o.prototype._clearCurrentLocalTheme=function(){u.shell.canUseLocalStorage&&localStorage.removeItem("theme")},o.baseDensity=30,t=o,e.DensityThemeManager=t,u.densityThemeManager=new u.shell.DensityThemeManager}($dyn=$dyn||{}),function(e){var t,o,n,i,r,a;t=e.forms||(e.forms={}),(o=t.DisplayTarget||(t.DisplayTarget={}))[o.Default=0]="Default",o[o.AsidePane=1]="AsidePane",o[o.Hidden=2]="Hidden",(n=t.Styles||(t.Styles={})).DetailsFormMaster="DetailsFormMaster",n.ListPage="ListPage",n.SimpleList="SimpleList",n.DetailsFormTransaction="DetailsFormTransaction",n.SimpleListDetails="SimpleListDetails",n.Dialog="Dialog",(i=t.ViewsButtonLocation||(t.ViewsButtonLocation={})).MainCaption="MainCaption",i.TopEntityName="TopEntityName",i.DialogCaption="DialogCaption",i.TopContext="TopContext",(r=t.FactBoxFocusTarget||(t.FactBoxFocusTarget={}))[r.Form=1]="Form",r[r.FactBox=2]="FactBox",(a=t.Events||(t.Events={})).partCreated="partCreated",a.gridLayoutCompleted="gridLayoutCompleted",a.personalize="PersonalizeForm"}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){var e,a,t;function o(e,t,o,n){var i=a.call(this,e,t,o,n)||this;return i.__protoForm=!0,r.ui.makeRoot(i),i}e=r.controls||(r.controls={}),a=r.ui.Container,__extends(o,a),o.prototype.init=function(e,t){a.prototype.init.call(this,e,t),this.trackInternalFocus()},o.prototype.dispose=function(){this.element&&$(this.element).off("focusin"),a.prototype.dispose.call(this)},o.prototype.takeNavigationFocus=function(){return!!this.lastFocusedElement&&(r.util.focusElement(this.lastFocusedElement),!0)},o.prototype.trackInternalFocus=function(){var t=this;this.element&&$(this.element).on("focusin",function(e){e.target&&(t.lastFocusedElement=e.target)})},t=o,(e.ProtoForm=t).prototype.__protoForm=!0,t.prototype.lastFocusedElement=null}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(w){Globalize.addCultureInfo("en",{messages:{BoundaryError:"Some of the information that you entered is not valid. You must enter valid information before you can continue.",FactBoxPane_Close:"Close the Related Information pane",FactBoxPane_Next:"Move to the next FactBox",FactBoxPane_nthFactBox:"Move to the nth FactBox",FactBoxPane_Prev:"Move to the previous FactBox",FactBoxPane_ToggleHelpText:"(Ctrl+F2)",FactBoxPane_ToggleToolTip:"Toggle Related Information pane",Form_AttachDocument:"Attach a document",Form_Close:"Close the form",Form_DefaultAction:"Execute default action",Form_DeleteRecord:"Delete record",Form_DetailsView:"Switch to details view",Form_DoYouWantToLeave:"Are you sure you want to leave this page?",Form_DoYouWantToSave:"Do you want to save your changes before closing?",Form_EditMode:"Edit mode",Form_ExportExcel:"Export to Excel",Form_FirstRecord:"Move to the first record",Form_ForceClose:"Close the form discarding any unsaved changes",Form_GoToActionPane:"Go to action pane",Form_GoToActionSearch:"Go to action search",Form_GoToFactBoxPane:"Go to Related Information pane",Form_GoToFilterPane:"Go to filter pane",Form_GoToFirstVisible:"Move to the first visible field on the form",Form_GoToMessageBar:"Go to the message bar",Form_GoToNavList:"Go to the navigation list",Form_GoToNavSearch:"Go to navigation search",Form_GridView:"Switch to grid view",Form_HeaderView:"Switch to header view",Form_LastRecord:"Move to the last record",Form_LinesView:"Switch to lines view",Form_LookupForm:"Lookup form",Form_NewRecord:"Create a new record",Form_NextRecord:"Move to the next record",Form_OpenAdvancedSort:"Open advanced filtering and sorting",Form_Personalize:"Personalize this page",Form_PrevRecord:"Move to the previous record",Form_ReactGridUnsupported:"An unsupported scenario was detected with the New grid control feature. Please refresh to use the existing grid for this page.",Form_Refresh:"Data Refresh",Form_RegionTitle:"Form Region",Form_RequestClose:"Close the form with explicit save",Form_Revert:"Revert any changes",Form_SaveRecord:"Save record",Form_SelectAll:"Select or clear all rows",Form_ViewMode:"View mode",InternetExplorerDeprecationError:"Internet Explorer support has ended and will be blocked soon. Please switch to a modern browser.",InternetExplorerDeprecationInfo:"Internet Explorer support is stopping on Aug 17th 2021. Please switch to a modern browser.",InternetExplorerDeprecationLabel:"Internet Explorer deprecation notice",InternetExplorerDeprecationLearnMore:"https://go.microsoft.com/fwlink/?LinkID=2162742",InternetExplorerDeprecationWarning:"Internet Explorer support has ended. Please switch to a modern browser.",LostConnectionDialog_Message:"It appears you lost network connectivity.",LostConnectionDialog_RetryButtonText:"Reconnect",OldBrowserDeprecationLabel:"Old Browser notice",OldBrowserDeprecationWarning:"Youre using a browser version that is older than recommended. Please update your browser.",ProgressMessage_CancelText:"Stop",ProgressMessage_Text:"We're working on it. This may take a while.",SidePanel_Close:"Close the side panel",SidePanel_RegionTitle:"Side Panel Region",UserLicenseCheckErrorMessage:"You will lose access to Dynamics 365 Finance and Operations apps on August 30 2025 without a valid license. Contact your admin to assign a license as soon as possible.",UserLicenseCheckLabel:"User license validation notice",UserLicenseCheckLearnMore:"https://go.microsoft.com/fwlink/?linkid=2311768",UserLicenseCheckWarningMessage:"You will lose access to Dynamics 365 Finance and Operations apps on August 30 2025 without a valid license. Contact your admin to assign a license as soon as possible."}}),w.ui.defaults.Form={ActiveControl:null,AddInfoStep:function(){},AllowExplicitPersonalization:!0,AllowPersonalization:!1,AllowRootNavigation:!1,ApplyViewForFormPart:function(e){},ArrangeMethod:w.layout.ArrangeMethod.vertical,CanSwitchViewMode:!1,Caption:"",Columns:"1",CurrentViewKey:"",DefaultAction:null,DefaultActionEnabled:!1,DialogSize:w.ui.DialogSize.small,DisplayTarget:w.forms.DisplayTarget.Default,ExecuteActionSearch:null,ExecuteActionSearchClick:null,ExecutePersonalizationCommand:function(){},ExecuteShortcuts:null,FactBoxPaneInitiallyExpanded:!1,Filter:function(e){},FilterPane:null,FormCompany:"",FormCompanyName:"",FormSetDefaultCompany:!1,GlobalStyle:{},Height:w.layout.Size.available,IsActive:!1,IsFormReady:!1,IsInViewMode:!1,LinkedViewDirty:function(){},MenuItemName:"",OnSelectControlEnabled:!1,OpenGridView:function(){},Parameters:"",ParentTitleFields:"",PersistFormPartViewChanges:function(e){},PersistMultiplePersonalization:function(e){},PersistPersonalization:function(){},PersonalizationData:"",PersonalizationViewsSaveModel:0,PersonalizedWidth:0,PreventAutoClose:!1,Recordable:!1,Refresh:function(e){},RequestClose:function(){},RequestCloseCancel:function(){},Save:function(){},SaveLinkedViews:0,SetServerSelectedControl:function(e){var t=e[0];this.ActiveControl(t)},ShowLinkToGridView:!1,Style:"",TriggerLocalRefresh:!1,UnsavedViewChanges:0,UpdateLastSelectedControl:null,UpdatePersonalizationData:function(){},UpdateRecordContext:function(){},Width:w.layout.Size.available},function(e){var s,t=(s=w.ui.Container,__extends(l,s),Object.defineProperty(l.prototype,"TakeFocus",{get:function(){var e=!0;return!1===this._takeFocus?e=!1:this.Root&&this.Root!==this&&void 0!==this.Root.TakeFocus&&(e=this.Root.TakeFocus),e},set:function(e){this._takeFocus=w.peek(e)},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"Id",{get:function(){return!this._formId&&this.element&&(this._formId=this.element.getAttribute("data-dyn-formid")),this._formId},set:function(e){e=w.value(e),this.element&&(this.element.setAttribute("data-dyn-formid",e),this.element.setAttribute("id","form_"+e)),this._formId=e},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"Name",{get:function(){return this._name},set:function(e){this._name=w.value(e)},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"FormName",{get:function(){return!this._formName&&this.element&&(this._formName=this.element.getAttribute("data-dyn-form-name")),this._formName},set:function(e){e=w.value(e),this.element&&e&&this.element.setAttribute("data-dyn-form-name",e),this._formName=e},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"ObjectName",{get:function(){return this._objectName||(this._objectName=w.value(this.MenuItemName)||w.value(this.FormName)||w.value(this.Name)||""),this._objectName},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"ClientId",{get:function(){return this._clientId||(this._clientId=this.element.getAttribute("data-dyn-clientId")),this._clientId},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"ReadyState",{get:function(){if(this.element)return this.element.dynReadyState},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"canActivate",{get:function(){return!w.value(this.disposeOnClose)||!this.willBeClosed},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"MessageBar",{get:function(){if(!this._messageBar&&this.element){var e=$(this.element).find('[data-dyn-role="MessageBar"]');e[0]&&(this._messageBar=w.context(e[0]))}return this._messageBar},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"FilterManager",{get:function(){return this._filterManager},set:function(e){this._filterManager=e},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"FilterPaneControl",{get:function(){return this._filterPane},set:function(e){this._filterPane=e},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"SidePanel",{get:function(){if(!this._sidePanel&&this.element){var e=this.element.getElementsByClassName("SidePanel")[0],t=w.util.tabbingContainer(e,w.label("SidePanel_RegionTitle")),o=w.context(this.element.getElementsByClassName("button_showList")[0]),n=w.context(e);this._sidePanel={Shortcuts:{Escape:{Keys:{keyCode:w.ui.KeyCodes.esc},Handler:function(e){return this.toggleVisibility()},Description:w.label("SidePanel_Close"),Category:w.ui.ShortcutCategory.Close}},TabbingHandlerDispose:t,SidePanelElement:e,SidePanelContext:n,SidePanelListButton:o,toggleVisibility:function(){return!!(o&&o.Clicked&&w.value(o.Visible)&&w.value(o.Enabled))&&(o.Clicked(),!0)},Id:n&&w.value(n.Id),isOpen:function(){return n&&w.value(n.Visible)},close:function(){return!!this.isOpen()&&(w.async(function(){this.toggleVisibility()},0,void 0,this),!0)}}}return this._sidePanel},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"FactBoxPane",{get:function(){if(!this._factBoxPane&&this.element){for(var t=this,e=$(this.element).find(".factBoxPane-container"),o=w.util.tabbingContainer(e[0],w.label("FactBox_RegionTitle")),n=e.find(".factbox-pane"),i=n.outerWidth(),r=[],a=function(){var e=n.outerWidth();i!==e&&(i=e,t.reflow())},s=0,l=n.find('[data-dyn-role="FactBox"]'),u=[],d={},c=0,p=0;p<l.length;p++){var h=w.context(l[p]);h&&(r.push(w.layout.registerEndReflowHandler(l[p],a)),u.push(h),d[h.Name]=c++)}var m=function(e){u[s=e]&&u[s].expand()},v=function(e,t){var o,n;o=t,n=w.context($(o.target).closest('[data-dyn-role="FactBox"]')[0]).Name,s=d[n],m(((s+e)%c+c)%c)};this._factBoxPane={Shortcuts:{Escape:{Keys:{keyCode:w.ui.KeyCodes.esc},Handler:function(e){t.ToggleFactBoxPane(e)},Description:w.label("FactBoxPane_Close"),Category:w.ui.ShortcutCategory.Close},FactBoxPane:{Keys:{ctrl:!0,keyCode:w.ui.KeyCodes.f2},Handler:function(e){t.ToggleFactBoxPane(e,w.forms.FactBoxFocusTarget.Form)},ShowToUser:!1},NextFactBox:{Keys:{alt:!0,shift:!0,keyCode:w.ui.KeyCodes.downArrow},Handler:function(e){return v(1,e)},Description:w.label("FactBoxPane_Next"),Category:w.ui.ShortcutCategory.Navigate},PreviousFactBox:{Keys:{alt:!0,shift:!0,keyCode:w.ui.KeyCodes.upArrow},Handler:function(e){return v(-1,e)},Description:w.label("FactBoxPane_Prev"),Category:w.ui.ShortcutCategory.Navigate},nthFactBox:{Keys:{alt:!0,keyCode:w.ui.KeyCodes.numbers},Handler:function(e){var t=e.which-w.ui.KeyCodes.Number1;return m(t)},Description:w.label("FactBoxPane_nthFactBox"),Category:w.ui.ShortcutCategory.Navigate}},TabbingHandlerDispose:o,ReflowWatchersDispose:function(){var t,e;try{for(var o=__values(r),n=o.next();!n.done;n=o.next()){var i=n.value;i&&i.dispose&&i.dispose()}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},Id:"factBoxPane",isOpen:function(){return!w.value(t.FactBoxPaneCollapsed)},close:function(){return!!this.isOpen()&&(w.async(function(){this.ToggleFactBoxPane()},0,void 0,t),!0)},hasFactBox:0<c}}return this._factBoxPane},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"SystemDefinedManagedViewFiltersElement",{get:function(){return this._systemDefinedManagedViewFiltersElement||(this._systemDefinedManagedViewFiltersElement=$(this.element).find("[data-dyn-controlname=SystemDefinedManageViewFilters]")[0]),this._systemDefinedManagedViewFiltersElement},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"Preloaded",{get:function(){if(this.element)return!0===this.element.dynPreloaded},enumerable:!1,configurable:!0}),l.prototype.containsPartForm=function(e){var t,o,n=!1;if(this._formParts&&0<this._formParts.length)try{for(var i=__values(this._formParts),r=i.next();!r.done;r=i.next())if(r.value.Id===e){n=!0;break}}catch(e){t={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}return n},l.prototype.PrepareClientOnlyClose=function(){this.RequestClose=function(){},this.RequestCloseCancel=function(){},this._formParts&&0<this._formParts.length&&this._formParts.forEach(function(e){e.PrepareClientOnlyClose()})},l.prototype.OnClientFormLoaded=function(){w.value(this.DelayedFactBoxLoad)&&this.ObserveFactBoxes&&(this.DelayedFactBoxLoad=!1,this.ObserveFactBoxes()),w.observe(this.CurrentViewKey,this.ApplyViewForParts.bind(this)),w.observe(this.SaveLinkedViews,this.ProcessSaveLinkedViews.bind(this))},l.prototype.ShowOrHideHiddenFields=function(e){w.callFunction(this.ExecutePersonalizationCommand,this,["ShowHiddenFields",e])},l.prototype.SavePendingPersonalization=function(e){w.callFunction(this.PersistMultiplePersonalization,this,[e])},l.prototype.IsViewsEnabled=function(){var e=!1,t=$("[data-dyn-controlName = SystemDefinedManageViewFilters]");return t&&0<t.length&&(e=!0),e},l.prototype.controlRenderPending=function(e){this.controlsWithAsyncRender[e]=!0,w.value(this.waitForAsyncRender)||this.waitForAsyncRender(!0)},l.prototype.controlRenderComplete=function(e){this.controlsWithAsyncRender[e]&&(delete this.controlsWithAsyncRender[e],w.value(this.waitForAsyncRender)&&0===Object.keys(this.controlsWithAsyncRender).length&&this.waitForAsyncRender(!1))},l.prototype.reflow=function(){this.element&&w.layout.reflow(this.element,!0)},l.prototype.RegisterFormPart=function(e){this._formParts.push(e),w.observe(e.UnsavedViewChanges,this.LinkedPartViewChanged.bind(this))},l.prototype.ApplyViewForParts=function(){var o=this;w.async(function(){for(var e=o._formParts.length,t=0;t<e;t++)o._formParts[t]&&o._formParts[t].ApplyViewForFormPart&&""!==w.value(o.CurrentViewKey)&&w.callFunction(o._formParts[t].ApplyViewForFormPart,o._formParts[t],[w.value(o.CurrentViewKey)])},void 0,"Part from changes should fire after form has finished its other interactions")},l.prototype.LinkedPartViewChanged=function(e){e&&!this.pendingViewDirtySync&&(this.pendingViewDirtySync=w.async(this.SetDirtyLinkedViewState.bind(this)))},l.prototype.ExecuteDefaultAction=function(e){if(this.isNavigationActiveForm()&&w.value(this.DefaultActionEnabled)&&w.value(this.DefaultAction)){if(e){var t=w.context(e.target);t&&t.updateValue&&t.updateValue(!0),e.preventDefault()}this.updateLastClientSelectedControl(),w.applyFunction(this.DefaultAction,this)}},l.prototype.isNavigationActiveForm=function(){return this.element.classList.contains("active-form")||$(this.element).parents().hasClass("active-form")||$(this.element).parents().hasClass("navigationBar")||$(this.element).parents().hasClass("asidePane")},l.prototype.isFormActive=function(){return w.value(this.IsActive)},l.prototype.isInActiveFocusRegion=function(){var e,t=w.shell.getActiveRegion();if(!t)return!0;var o=$(this.element).closest(".binding-focusRegion").attr("data-dyn-focus-region");if(!o){var n=$(this.element).closest(".sysPopup"),i=w.flyout.flyoutManager.getTopFlyout();if(n&&i){var r=w.value(i.flyout);if(r&&($.contains(r[0],n[0])||$(n[0]).is(r[0])||(null===(e=w.context(r[0]))||void 0===e?void 0:e.Root)===this))return!0}}return o===t},l.prototype.Open=function(){this.IsOpen(!0)},l.prototype.isPopup=function(){return"Popup"===this.TypeName},l.prototype.IgnoreBlockingDiv=function(e){return e===this.RequestCloseCommandName&&w.value(this.ReadyState)===w.ui.ReadyState.aborted},l.prototype.GoGridView=function(){w.value(this.ShowLinkToGridView)&&w.getFunction(this.OpenGridView)()},l.prototype.SetEditMode=function(e){w.setValue(this,"IsInViewMode",e)},l.prototype.getTaskGuideParams=function(e){var t;if(-1!==e.action.indexOf("RequestClose"))t=$(this.element).find('[data-dyn-controlname="SystemDefinedCloseButton"]')[0];else if(-1!==e.action.indexOf("Refresh"))t=$(this.element).find('[data-dyn-controlname="SystemDefinedRefreshButton"]')[0];else if(-1!==e.action.indexOf("ExecuteActionSearchClick"))return this.getTaskGuideParamsActionSearch(e);return t?$.extend(e,{target:$(t),my:"top center",at:"bottom center",adjustMethod:"flip"}):$.extend(e,{target:$(this.element),my:"top right",at:"top right",adjust:{x:-10,y:10,method:"none"},styles:{hideTip:!0}}),e},l.prototype.RefreshData=function(e){var t=w.value(this.Refresh);"function"==typeof t?t(void 0===e||e):this.TriggerLocalRefresh(!0)},l.prototype.GetAllPartForms=function(){for(var e=[],t=$("[data-dyn-role='PartForm']",this.element),o=0;o<t.length;o++){var n=t[o],i=w.context(n);i&&e.push(i)}return e},l.prototype.GetAllFactBoxForms=function(){for(var e=[],t=$("[data-dyn-role='FactBoxForm']",this.element),o=0;o<t.length;o++){var n=t[o],i=w.context(n);i&&e.push(i)}return e},l.prototype.ToggleFactBoxPane=function(e,t){var o=this;t&&!w.value(this.FactBoxPaneCollapsed)||(this.HandleFactBoxPaneOpenClose(w.value(this.FactBoxPaneCollapsed)),w.async(function(){w.callFunction(o.PersistPersonalization,o,["factboxpaneexpanded",!w.value(o.FactBoxPaneCollapsed)])},void 0,"async call ToggleFactBoxPane: Async required so that it does not interfere with opening of fact box"),w.isObservable(this.FactBoxPaneInitiallyExpanded)&&this.FactBoxPaneInitiallyExpanded(!w.value(this.FactBoxPaneCollapsed)));var n=!!e;this.HandleFactBoxPaneFocus(n,t)},l.prototype.escape=function(t){var o=this,e=t?w.context(t.target):void 0,n=!1;e&&e.updateValue&&e.updateValue(!0),e&&e.isDisplayedValueDirty&&(n=e.isDisplayedValueDirty()),w.flyout.flyoutManager.areAnyFlyoutsOpen()?w.flyout.flyoutManager.removeTopFlyoutAsync():w.value(this.IsInViewMode)||!this.AreDataSourcesDirty()&&!this.HasInvalidControls()&&!n?w.debug.EscPromptWhenNotDirty?w.showMessageBox({showYesButton:!0,showNoButton:!0,ShowActivityId:!1,Text:w.label("Form_DoYouWantToLeave"),callback:function(e){e===w.controls.MessageBox.Button.Yes&&(o.hasMultipleNavigationEntries()?o.AllowSave(w.shell.initiateBack):o.executeShortcuts(!1,"EscapeSaveYES"))}}):this.hasMultipleNavigationEntries()?this.AllowSave(w.shell.initiateBack):this.executeShortcuts(!1,"EscapeSaveYES"):w.showMessageBox({showYesButton:!0,showNoButton:!0,showCancelButton:!0,ShowActivityId:!1,Text:w.label("Form_DoYouWantToSave"),callback:function(e){e===w.controls.MessageBox.Button.Yes?o.EscapeSaveYes():e===w.controls.MessageBox.Button.No&&(o.hasMultipleNavigationEntries()?(o.executeShortcuts(!1,"Restore",t),o.AllowSave(w.shell.initiateBack)):o.executeShortcuts(!1,"EscapeSaveNO"))}})},l.prototype.EscapeSaveYes=function(){this.hasMultipleNavigationEntries()?this.AllowSave(w.shell.initiateBack):this.executeShortcuts(!0,"EscapeSaveYES")},l.prototype.AreDataSourcesDirty=function(){if(this.DataSource&&this.DataSource._relatedCollections)for(var e in this.DataSource._relatedCollections)if(this.DataSource._relatedCollections[e].IsDirty)return!0;return!1},l.prototype.personalize=function(){w.value(this.AllowExplicitPersonalization)&&$(window).trigger(w.forms.Events.personalize)},l.prototype.executeShortcuts=function(e,t,o,n){var i=this,r=o?w.context(o.target):void 0;r&&(r.updateValue&&r.updateValue(!0),r.focusOutCleanup&&r.focusOutCleanup(!0)),e?this.AllowSave(function(){i.MessageBar&&i.MessageBar.ClearMessages(),w.callFunction(i.ExecuteShortcuts,i,[t],n)}):w.callFunction(this.ExecuteShortcuts,this,[t],n)},l.prototype.keydown=function(e){var t=!1;$(e.target).parents().is(".SidePanel")&&(w.util.handleShortcuts(this.SidePanel,e),t=e.isPropagationStopped()),t||w.util.handleShortcuts(this,e)},l.prototype.FactBoxPanekeyDown=function(e){w.util.handleShortcuts(this.FactBoxPane,e)},l.prototype.goToActionSearch=function(){if(w.value(w.debug.combinedSearch))this.goToSearchField(".combinedSearch-actions",2);else{var e=this.element.getElementsByClassName("actionSearch")[0],t=w.context(e);this.focusSearchControl(t,e)}},l.prototype.FocusIn=function(e){if(w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->FocusIn",this.Id),!w.shell.canFocus(this))return w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->FocusIn invalid focus attempt",this.Id),e.stopImmediatePropagation(),void e.preventDefault();var t=this.ActiveElement(),o=e.target;o=$(o).addBack().closest("[data-dyn-controlname]")[0];var n=w.ui.getLiveControl(o);n&&n.Root&&this.Id!==n.Root.Id||(this.focusedControl=o,this.InternalFocusIn(o,t))},l.prototype.activateControl=function(e,t,o,n){o&&(this.ActiveBoundaryInfo={DataSource:e.DataSource,ServiceBoundary:e.ServiceBoundary}),!n&&w.value(this.ActiveControl)===e.Name||(w.setValue(this,"ActiveControl",e.Name,n),this.SetServerSelectedControl&&t&&w.callFunction(this.SetServerSelectedControl,this,[e.Name]))},l.prototype.isActiveControl=function(e){if(this.focusedControl){var t=w.ui.getLiveControl(this.focusedControl);if(t&&t.Name===e)return!0}return!1},l.prototype.GetFocusedControl=function(){return this.focusedControl},l.prototype.ActiveElementInMainFormContainer=function(){return this._formActiveElement},l.prototype.RestoreFocusToMainFormFirstVisibleControl=function(){var e,t=this.element.querySelector(".rootContent");t&&(e=w.util.findFirstFocusableControl(t),this.InternalFocusIn(e,this.ActiveElement(),!0))},l.prototype.RestoreFocusToMainFormContainer=function(){var e=this.ActiveElementInMainFormContainer();e?this.InternalFocusIn(e,this.ActiveElement(),!0):this.focusFirstControl(!0)},l.prototype.InternalFocusIn=function(e,t,o){var n,i=this;if(w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->InternalFocusIn",this.Id),t!==e){var r=t?t.id:"",a=e?e.id:"";if(r&&a&&r===a&&!t.isConnected)return w.log.focus&&w.log.focus("Setting focus to same id but previous element is no longer connected to DOM"),void this.updateActiveElement(e)}var s=w.ui.getLiveControl(t),l=w.ui.getLiveControl(e);if(l){if(w.log.focus){var u=void 0,d="";l&&(u=l.Name,l.DataSource&&w.value(l.DataSource.collectionIndex)&&(u+="["+w.value(l.DataSource.collectionIndex)+"]")),s?(d=s.Name,s.DataSource&&w.value(s.DataSource.collectionIndex)&&(d+="["+w.value(s.DataSource.collectionIndex)+"]")):t&&(d=$(t).addBack().closest("[data-dyn-controlname]").attr("data-dyn-controlname")),w.log.focus("Focus: Form(Form.Id: %s)->InternalFocusIn - active control: %s, last active control: %s, document.activeElement: %o",this.Id,u,d,document.activeElement)}if(t!==e){if(l.isContainer&&!o)return void(w.log.focus&&w.log.focus("Opting out of focusing container control: %s",l.Name));var c=this.AreControlsCrossBoundary(l,s),p=void 0,h=void 0;if(s){p=w.value(s.OnLeaveEnabled),h=l.ReferenceGroup&&s.ReferenceGroup&&l.ReferenceGroup===s.ReferenceGroup;var m=void 0===s.CanAcquireFocus||w.util.stringToBoolean(w.value(s.CanAcquireFocus));c||m||!this.ActiveBoundaryInfo||(c=this.AreControlsCrossBoundary(l,this.ActiveBoundaryInfo))}var v=void 0;if(c)if(s&&s.listControl&&l&&l.listControl&&l.listControl===s.listControl)c=l.listControl.AreControlsCrossBoundary(l,s),v=!0;else{var g=this._getParentListByElement(t),y=this._getParentListByElement(e);if(y&&(v=w.value(y.FastEdit)),!v&&g&&(v=w.value(g.FastEdit)),g&&y&&y.AreElementsCrossBoundary&&y===g){var f=y.AreElementsCrossBoundary(e,t);void 0!==f&&(c=f)}}var b=void 0===l.CanAcquireFocus||w.util.stringToBoolean(w.value(l.CanAcquireFocus));if(!h&&b&&(p||c||w.value(l.OnEnterEnabled)||w.value(this.OnSelectControlEnabled)))if(c)if(w.log.focus&&w.log.focus("Crossing service boundary: %s, from: %s, active control: %s, previous control: %s",l.ServiceBoundary,s?s.ServiceBoundary:"",l.Name,s?s.Name:""),l.optOutOfAllowSave)this.activateControl(l,!1,!0,o);else{var C=null===(n=null==s?void 0:s.waitForClientBusyOnBlur)||void 0===n?void 0:n.call(s);C||this.HasInvalidControls()||w.async.IsClientProcessing()||w.util.waitForClientBusy()?this.AllowSave(function(){i.activateControl(l,!0,!0,o)},void 0,v,C):this.activateControl(l,!0,!0,o)}else this.activateControl(l,!0,!1,o);else this.activateControl(l,!1,!1,o)}}else w.log.focus&&w.log.focus("Unable to get active control from active element")},l.prototype.updateLastClientSelectedControl=function(){if(this.UpdateLastSelectedControl){var e=this.ActiveElementInMainFormContainerOrSidePanel();e&&$(e).is(":visible")||(e=w.value(this.ActiveElement));var t=w.ui.getLiveControl(e);t&&(t.ServerFocusableControl&&(t=t.ServerFocusableControl),!1!==w.value(t.CanAcquireFocus)&&w.callFunction(this.UpdateLastSelectedControl,this,[t.Name]))}},l.prototype.takeNavigationFocus=function(){var e=this;if(!w.flyout.flyoutManager.tryTakeNavigationFocus(this)){var t=this.ActiveControl();if(!t)return w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s  Control: %s)->takeNavigationFocus no ActiveControl",this.Id,t),void this.focusFirstControl();var o=this.findControl(t);if(o)w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s Control: %s)->takeNavigationFocus",this.Id,t),this.setControlFocus(this.ActiveControl());else{var n=function(){(o=e.findControl(t))?(w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s Control: %s)->takeNavigationFocus focusDelay",e.Id,t),e.setControlFocus(e.ActiveControl())):w.value(e.waitForAsyncRender)?(w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s Control: %s)->takeNavigationFocus delay for grid render",e.Id,t),w.observe(e.waitForAsyncRender,function(e){if(!e)return n(),!1},e,void 0,!0)):(w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s Control: %s)->takeNavigationFocus focusDelay no ActiveControl",e.Id,t),e.focusFirstControl())};if(w.async.IsClientProcessing()){w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s Control: %s)->takeNavigationFocus IsClientProcessing delaying focus to allow parts / grids to load",this.Id,t);var i=w.clientBusy.valueChanged.subscribe(function(e){n(),w.clientBusy.valueChanged.unsubscribe(i)})}else w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s Control: %s)->takeNavigationFocus microTask delaying focus to allow parts / grids to load",this.Id,t),w.microTask(function(){n()})}}},l.prototype.changeDetailsViewElement=function(e,t){if(e&&e.Root&&e.Root.SystemDefinedManagedViewFiltersElement){var o=void 0,n=w.context(e.Root.SystemDefinedManagedViewFiltersElement);switch(n?n.ExtendedStyle:null){case w.ui.ViewSelectorButtonOption.largeViewSelectorExtendedStyle:o=w.forms.ViewsButtonLocation.MainCaption;break;case w.ui.ViewSelectorButtonOption.smallViewSelectorExtendedStyle:o=w.forms.ViewsButtonLocation.TopEntityName;break;default:var i=$(e.element).find('[data-dyn-controlname="'+t+'"]')[0];o=i&&w.context(i)&&"Grid"===w.value(w.context(i).PanelStyle)?w.forms.ViewsButtonLocation.MainCaption:w.forms.ViewsButtonLocation.TopEntityName}e.Root.moveSystemDefinedManageViewFilters(o),e.Root.systemDefinedManagedViewFiltersElementDetailsMasterMoved=!0}},l.prototype.adjustSystemDefinedManageViewFilters=function(e){if(!this.Root&&this.SystemDefinedManagedViewFiltersElement)if(e===w.ui.ViewSelectorButtonOption.largeViewSelectorExtendedStyle)this.moveSystemDefinedManageViewFilters(w.forms.ViewsButtonLocation.MainCaption,!0);else if(e===w.ui.ViewSelectorButtonOption.smallViewSelectorExtendedStyle)switch(w.value(this.Style)){case w.forms.Styles.DetailsFormMaster:case w.forms.Styles.DetailsFormTransaction:this.moveSystemDefinedManageViewFilters(w.forms.ViewsButtonLocation.TopEntityName);break;case w.forms.Styles.ListPage:case w.forms.Styles.SimpleList:default:this.moveSystemDefinedManageViewFilters(w.forms.ViewsButtonLocation.TopContext,!0)}else switch(w.value(this.Style)){case w.forms.Styles.ListPage:case w.forms.Styles.SimpleList:this.moveSystemDefinedManageViewFilters(w.forms.ViewsButtonLocation.MainCaption,!0);break;case w.forms.Styles.DetailsFormMaster:case w.forms.Styles.DetailsFormTransaction:var t=w.context($(this.element).find("[data-dyn-role=Pivot]")[0]);t&&t.ActiveItemName&&this.changeDetailsViewElement(t,w.value(t.ActiveItemName));break;default:this.moveSystemDefinedManageViewFilters(w.forms.ViewsButtonLocation.TopContext)}},l.prototype.restoreFocus=function(e){var t;if(w.value(this.ActiveControl)){var o=w.ui.findControlElement(this.ActiveControl(),this.element);o&&w.util.isChild(e,o)&&(w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->restoreFocus setting focus to ActiveControl: %s",this.Id,this.ActiveControl()),t=this.ActiveControl())}else if(w.value(this.ActiveElement)&&w.util.isChild(e,this.ActiveElement())){var n=w.ui.getLiveControl(this.ActiveElement());n&&(w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->restoreFocus setting focus to ActiveElement: %s",this.Id,n.Name),t=n.Name)}this.isFormActive()&&t?this.setControlFocus(t):w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->restoreFocus tried to restore focus on a non-active form or didn't find a control",this.Id)},l.prototype.setControlFocus=function(e,t){var o=this;if(w.value(this.ReadyState)!==w.ui.ReadyState.aborted)if(this.TakeFocus)if(e){var n=void 0,i=void 0;if("string"==typeof e){if((i=e)!==w.value(this.ActiveControl))return void this.ActiveControl(i);n=this.findControl(e)}else if(n=e,(i=$(n).addBack().closest("[data-dyn-controlname]")[0]?$(n).addBack().closest("[data-dyn-controlname]")[0].getAttribute("data-dyn-controlname"):"")!==w.value(this.ActiveControl))return void this.ActiveControl(i);if(!n)return void(w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->setControlFocus (control not found no-op) control name: %s",this.Id,i));if(n){if((d=w.ui.getLiveControl(n))&&!w.value(d.Enabled))return void(w.log.focus&&w.log.focus("Focus prevented for disabled control name: %s",i));if(d&&d.isInOverflow){var r=$(n).closest(".overflow-menu");if(r&&r.length){var a=w.context(r[0]);if(a&&!w.value(a.MenuOpen))return void this.ActiveControl(a.Name)}}if(w.util.isControlFocused(n,this)||d&&d.Root&&d.Root.UseReactGrid()&&d.isInGrid()&&w.util.isColumnFocused(n))return void this.updateActiveElement(n);var s=n.getAttribute("data-dyn-focus");if(d&&w.value(d.isContainer)&&(""===s||null==s)){w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->setControlFocus container control name: %s",this.Id,i);var l=d.getHeader?d.getHeader():void 0;if(!l||l instanceof jQuery||(l=$(l)),l&&0<l.length){var u=l.attr("data-dyn-controlName");if(u&&u===i)return void l.focus()}if(d.setChildControlFocus&&d.setChildControlFocus())return}w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->setControlFocus->Delay setting focus to - control name:' %s ' as a microTask",this.Id,i),this.elementToFocus=n,this.elementToFocusName=i,this.isSetControlFocusCalled||(this.isSetControlFocusCalled=!0,w.microTask(function(){w.log.focus&&w.log.focus("Focus: Form->SetControlFocus->Executing MicroTask to set focus to control '%s'",o.elementToFocusName),w.callFunction(o.form_setFocus,o,o.elementToFocus,t),o.elementToFocus=null,o.elementToFocusName="",o.isSetControlFocusCalled=!1}))}}else w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->setControlFocus - No control name to set focus to",this.Id);else{w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->setControlFocus takeFocus is false",this.Id);var d,c=this.FindFocusTarget?this.FindFocusTarget():void 0;c&&c[0]&&((d=w.ui.getLiveControl(c[0]))&&d.Root?d.Root.setControlFocus(d.Name,this.isNavigationActiveForm()||d.Root.isNavigationActiveForm&&d.Root.isNavigationActiveForm()):c.focus())}},l.prototype.updateActiveElement=function(e){this.ActiveElement(e);var t=$(e).parents();t.is(".appBar,.appBar-flyout,.navigationBar,.toolbar,.filterPane,.filterDisplay-addField-flyOut,.asidepane,.SidePanel,.factBoxPane-container,.overflow-menu,.messageBar")?t.is(".SidePanel")&&(this._formOrSidePanelActiveElement=e):(this._formActiveElement=e,this._formOrSidePanelActiveElement=e)},l.prototype.form_setFocus=function(e,t){var i=this;if(e){var r,a;if("string"==typeof e)r=this.findControl(e),a=e;else{r=e;var o=w.ui.getLiveControl(e);a=o?o.Name:e.getAttribute("data-dyn-controlname")}w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->form_setFocus (Enter) - control name: %s",this.Id,a);var n=$(r),s=w.value(this.UseReactGrid)?".react-listRoot":".listRoot",l=n.closest(s),u=!0;if(0<l.length){var d=w.context(l[0]);if(d)if(w.value(this.UseReactGrid))u=(u=!this.controlsWithAsyncRender[d.Name])&&d.tryFocus(r);else{var c=d,p=l.find(".rowTemplate");if(0!==p.length&&!p.hasClass("place-holder")||0!==n.closest(".listAsTable-HeaderRow").length&&w.value(c.AllowHeaderFocus)||(r=null),c.tryFocus&&(u=c.tryFocus(r))&&c.getNoRowIndicator){var h=c.getNoRowIndicator();h&&0<h.length&&document.activeElement===h[0]&&(r=h[0])}}}if(this.updateActiveElement(r),u)if(t||this.isNavigationActiveForm())if(r){var m=w.ui.getLiveControl(r);if(m&&m.IsServerFocusable&&!m.IsServerFocusable())w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->form_setFocus (Exit) - Could not set focus to: %s",this.Id,a);else{w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->form_setFocus (Enter) - Set focus to: %s",this.Id,a),w.focusCompleted(!1),this.focusCompletedSubscription&&(w.focusCompleted.valueChanged.unsubscribe(this.focusCompletedSubscription),this.focusCompletedSubscription=void 0),this.focusCompletedSubscription=w.focusCompleted.valueChanged.subscribe(function(e){if(w.value(e)){i.focusedControl=r;var t=document.activeElement;if(w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->form_setFocus (Exit) - Focus set to: %s, %o",i.Id,a,t),t&&t.focus&&document.activeElement!==document.body&&setTimeout(function(){document.activeElement!==document.body&&null!==document.activeElement||(t.focus(),w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->form_setFocus (retry) - focus set to: %s, %o",i.Id,a,t))}),document.activeElement===document.body){w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->form_setFocus->focusCompletedSubscription - Focus failed try to keep foucs in the form: %s, %o",i.Id,a,t);var o=!w.value(i.IsInViewMode),n=w.util.findFirstFocusableControl(i.element,!0,o,o);n&&n.focus()}w.focusCompleted.valueChanged.unsubscribe(i.focusCompletedSubscription),i.focusCompletedSubscription=void 0}});var v=m?m.focusCallback:function(e){e&&e[0]&&w.util.focusElement(e[0],a)};w.shell.focusCallback(v,m,r,{queue:!0})}}else w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->form_setFocus (Exit) - Control element not found to set focus to: %s",this.Id,a);else w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->form_setFocus (Exit) - Can not set focus to %s because the form is not active",this.Id,a)}else w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->form_setFocus (Enter) - no-op with empty controlParam: %s",this.Id)},l.prototype.findControl=function(e){var t=w.ui.findControlElement(e,this.element);return t=t||w.ui.findFlyoutControlElement(e,this.Id)},l.prototype.focusFirstControl=function(e){w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->focusFirstControl (Enter)",this.Id);var t=!w.value(this.IsInViewMode),o=e?this.element.querySelector(this.element.getAttribute("data-dyn-container")):this.element,n=w.util.findFirstFocusableControl(o,!0,t,t);if(n){var i=w.ui.getLiveControl(n);i&&i.Root?(w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->focusFirstControl (Exit) focus control: %s",this.Id,i.Name),i.Root.setControlFocus(i.Name)):i&&(w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->focusFirstControl (Exit) focus control: %s",this.Id,i.Name),this.setControlFocus(i.Name))}},l.prototype.HasInvalidControls=function(){return 0<Object.keys(this.invalidControls).length},l.prototype.HasInvalidUnboundControls=function(){return 0<Object.keys(this.invalidUnboundControls).length},l.prototype.HasUnchangedInvalidControls=function(){return 1<Object.keys(this.invalidControls).length||1===Object.keys(this.invalidControls).length&&(!this.invalidControls[Object.keys(this.invalidControls)[0]].isDisplayedValueDirty||!this.invalidControls[Object.keys(this.invalidControls)[0]].isDisplayedValueDirty())},l.prototype.UpdateInvalidControlList=function(e){e.IsValid&&(this.invalidControls[e.Name]?e.IsValid()&&(delete this.invalidControls[e.Name],this.invalidUnboundControls[e.Name]&&delete this.invalidUnboundControls[e.Name],e.transitStateSubscriptionId&&(this.serializeTransitState.unsubscribe(e.transitStateSubscriptionId),e.transitStateSubscriptionId=null)):e.IsValid()||(e.ServiceBoundary&&w.value(e.ServiceBoundary)||(this.invalidUnboundControls[e.Name]=e),(this.invalidControls[e.Name]=e).onSerializeTransitState&&!e.transitStateSubscriptionId&&(e.transitStateSubscriptionId=this.serializeTransitState.subscribe(e.onSerializeTransitState.bind(e)))))},l.prototype.SetFocusToInvalidControl=function(e){for(var t=Object.keys(this.invalidControls),o=0;o<t.length;o++){var n=this.invalidControls[t[o]],i=!0,r=$(n.element).closest(".listRoot");if(0<r.length){var a=w.context(r[0]);a.tryFocus&&(i=a.tryFocus(n.element,!0))}return void(i&&!e&&(this.ActiveControl(n.Name),w.errorMessageBox({Text:w.label("BoundaryError")})))}e||w.errorMessageBox({Text:w.label("BoundaryError"),Label:"BoundaryError"}),w.log.focus&&w.log.focus.error&&w.log.focus.error("SetFocusToInvalidControl - no invalid controls could be focused, focused control is invalid")},l.prototype.AllowSave=function(e,t,o,n){function i(){r.HasInvalidControls()?(r.SetFocusToInvalidControl(o),w.applyFunction(t,r)):w.applyFunction(e,r)}var r=this;if(n||w.util.waitForClientBusy()){w.shell.blockUserInteractionNoWait("Allow save");var a=w.clientBusy.valueChanged.subscribe(function(e){w.value(e)||(w.shell.unBlockUserInteraction(),w.clientBusy.valueChanged.unsubscribe(a),i())})}else i()},l.prototype._close=function(){this.closeCallback&&w.getFunction(this.closeCallback)()},l.prototype.IsCloseRequested=function(){return this._isCloseRequested},l.prototype.callRequestClose=function(e,t){this._isCloseRequested=!0,w.callFunction(this.RequestClose,this,[!1],e)},l.prototype.dispose=function(){this._sidePanel&&this.SidePanel.TabbingHandlerDispose(),this._factBoxPane&&(this.FactBoxPane.TabbingHandlerDispose(),this.FactBoxPane.ReflowWatchersDispose()),this.readyStatePromise&&this.readyStatePromise.reject&&this.readyStatePromise.reject(),this.UseReactGrid&&this.UseReactGrid.valueChanged&&this.UseReactGrid.valueChanged.clearAllDependencies(),this.serializeTransitState&&this.serializeTransitState.clear&&this.serializeTransitState.clear(),this.onClose&&this.onClose.clear&&this.onClose.clear(),this._formZoomModeWidthObserver&&(this._formZoomModeWidthObserver.dispose(),this._formZoomModeWidthObserver=void 0),this._formZoomModeHeightObserver&&(this._formZoomModeHeightObserver.dispose(),this._formZoomModeHeightObserver=void 0),s.prototype.dispose.call(this),this._formParts&&(this._formParts=[])},l.prototype.goToNavigationSearch=function(){if(w.debug.combinedSearch)this.goToSearchField(".combinedSearch-navigation",1);else{var e=w.context($("#NavigationSearch")[0]);if(e){var t=!1;w.value(e.SearchFieldVisible)&&(t=!0),e.click(),t&&this.takeNavigationFocus()}}},l.prototype.executeDefaultActionOrDefaultButton=function(e){w.value(this.DefaultActionEnabled)?this.ExecuteDefaultAction(e):this.executeShortcuts(!1,"InvokeDefaultButton",e)},l.prototype.ObserveFactBoxes=function(){var a=this;this._childFactBoxObserver=w.observe(w.options(function(){var e=[];return a.element&&(e=w.children(a.element)),{Children:e}},this.Updating),function(e){for(var r=e.Children,t=function(e,t){var o=r[e];if("FactBox"===o.getAttribute("data-dyn-role")){var n=w.context(o);if(!n)return a.DelayedFactBoxLoad=!0,{value:void 0};if(w.value(n.Visible))return a.NoShowableFactBoxes(!1),a._childFactBoxObserver&&(a._childFactBoxObserver.dispose(),a._childFactBoxObserver=null),{value:void 0};var i={factBox:n};i.observer=w.observe(i.factBox.Visible,function(e){(e=w.value(e))&&(a.NoShowableFactBoxes(!1),i.observer&&(i.observer.dispose(),i.observer=null),a._childFactBoxObserver&&(a._childFactBoxObserver.dispose(),a._childFactBoxObserver=null))})}},o=0,n=r.length;o<n;o++){var i=t(o);if("object"==typeof i)return i.value}})},l.prototype._adjustBodyElementsForZoom=function(e){var t=!1;if(e&&!1===this._zoomElementsMoved){var o=$(this.element).find("[data-dyn-role='AppBarSection']")[0],n=w.context(o);n&&((r=$(this.element).find(".button_showFilters")[0])&&(n.addHostedButton(r),t=!0),(i=$(this.element).find(".factBoxPane-toggleButton")[0])&&(n.addHostedButton(i),t=!0),t&&this.ShouldRightPaneGutterBeVisible(!1),this._zoomElementsMoved=!0)}else if(!e&&!0===this._zoomElementsMoved){var i,r=$(this.element).find(".button_showFilters")[0],a=$(this.element).find(".rootLevelSystemDefinedButtons")[0];if(r&&a&&(a.appendChild(r),t=!0),(i=$(this.element).find(".factBoxPane-toggleButton")[0])&&a&&(a.append(i),t=!0),t&&r&&i){var s=w.context(r),l=w.context(i);(s&&w.value(s.Visible)||l&&w.value(l.Visible))&&this.ShouldRightPaneGutterBeVisible(!0)}this._zoomElementsMoved=!1}},l.prototype.LocalRefresh=function(e){w.value(e)&&(this.Refreshing(!0),this.Refreshing._current=!1),w.isObservable(this.TriggerLocalRefresh)&&(this.TriggerLocalRefresh._current=!1)},l.prototype.ProcessSaveLinkedViews=function(e){1===e&&(this.pendingViewSync||(this.pendingViewSync=w.async(this.SyncViewSave.bind(this))))},l.prototype.SetDirtyLinkedViewState=function(){w.callFunction(this.LinkedViewDirty,this,[1]),this.pendingViewDirtySync=void 0},l.prototype.ClearDirtyLinkedViewState=function(){w.callFunction(this.LinkedViewDirty,this,[0]),this.pendingViewDirtySync=void 0},l.prototype.SyncViewSave=function(){for(var e=this._formParts.length,t=0;t<e;t++)w.callFunction(this._formParts[t].PersistFormPartViewChanges,this._formParts[t],[w.value(this.CurrentViewKey)]);this.pendingViewSync=void 0,1===w.value(this.SaveLinkedViews)&&w.async(this.ClearDirtyLinkedViewState.bind(this))},l.prototype.hasMultipleNavigationEntries=function(){return this.isNavigationActiveForm()&&w.shell.browserHistory.activeFormHasMultipleReferences()},l.prototype.getTaskGuideParamsActionSearch=function(i){i.avoidRailsModeBlocks=!0;var o=w.context($(this.element).find('[data-dyn-controlname="AppBarSearch"]')[0]),n=$(o.element).find(".actionSearch-icon"),r=$(o.element).find(".actionSearch-field"),a=$.extend(i,{target:w.observable(n),my:"right center",at:"left center"}),s=null,e=w.observe(o.SearchFieldShown,function(e){if(w.value(e)){a.target(r);var t=null;s=o.ShowResultPicker.valueChanged.subscribe(function(e){w.value(e)?t=o.ResultList.valueChanged.subscribe(function(e){var t=w.value(e);if(0===t.length)a.target(r);else for(var o=0;o<t.length;o++)if(i.arguments[0]===t[o].Name){var n=$($(document).find(".actionSearch-results").children()[o]);a.target(n);break}}):(a.target(r),t&&(o.ResultList.valueChanged.unsubscribe(t),t=void 0))})}else a.target(n),s&&(o.ShowResultPicker.valueChanged.unsubscribe(s),s=void 0)});return $.extend(i,{targetSubscriptions:[e]}),i},l.prototype.SetRootContentVisibility=function(e){e?this.element.classList.remove("hide-rootContent"):this.element.classList.add("hide-rootContent")},l.prototype.HandleFactBoxPaneOpenClose=function(e){this.FactBoxPaneCollapsed(!e),this.FactBoxPaneHelpText(this.FactBoxPaneCollapsed()?w.label("FactBoxPane_ToggleHelpText"):"")},l.prototype.HandleFactBoxPaneFocus=function(e,t){var o=this;if(w.value(this.FactBoxPaneCollapsed)||t===w.forms.FactBoxFocusTarget.Form){var n=this.ActiveElementInMainFormContainer();n&&this.form_setFocus(n)}else if(e){var i=$("[data-dyn-role='FactBox']",this.element).first();if(i.length){var r=w.util.findFirstTabbableControl(i[0]);w.async(function(){o.InternalFocusIn(r,o.ActiveElementInMainFormContainer(),!0)},void 0,"async call HandleFactBoxPaneFocus: Async required to handle focus after fact box is completed rendering")}}},l.prototype.goToSearchField=function(e,t){var o=$(w.ui.getNavBar().element).find(e)[0],n=w.context(o),i=$(w.ui.getNavBar().element).find(".combinedSearch")[0],r=w.context(i);r&&w.setValue(r,"SelectedSearchType",t),this.focusSearchControl(n,o)},l.prototype.focusSearchControl=function(e,t){e&&(w.util.isChild(t,this.ActiveElement())?e.closeResultPicker():(e.showField&&e.showField(),this.form_setFocus(t,this.ActiveElement())))},l.prototype.ActiveElementInMainFormContainerOrSidePanel=function(){return this._formOrSidePanelActiveElement},l.prototype.AreControlsCrossBoundary=function(e,t){if(!e)return!1;if(!t)return!0;if(w.value(e.ServiceBoundary)!==w.value(t.ServiceBoundary))return null!=w.value(t.ServiceBoundary)&&""!=w.value(t.ServiceBoundary);var o=w.value(e.DataSource),n=w.value(t.DataSource);if(o&&n){if(o.collectionIndex!==n.collectionIndex)return void 0!==o.collectionIndex&&(void 0!==n.collectionIndex||!o.parent||o.collectionIndex!==w.value(o.parent.selectedIndex))}else if(n)return!0;return!1},l.prototype._getParentListByElement=function(e){if(e){var t=w.value(this.UseReactGrid)?".react-listRoot":".listRoot",o=$(e).closest(t);if(o[0])return w.context(o[0]);var n=$(e).closest(".rowTemplate");if(n[0]){var i=n[0].id,r=i.substring(0,i.indexOf("_RowTemplate"));if(r=r||i.substring(0,i.indexOf("_row")))return w.context($("#"+r)[0])}}},l.prototype.moveSystemDefinedManageViewFilters=function(e,t){var o,n,i,r;void 0===t&&(t=!1);var a=null,s=null,l=null,u=!0,d=!1,c=null;if(this&&!this.Root){switch(this.SystemDefinedManagedViewFiltersElement.classList.remove(w.ui.ViewSelectorButtonOption.showSeperator),this.SystemDefinedManagedViewFiltersElement.classList.remove(w.ui.ViewSelectorButtonOption.largeViewSelector),this.SystemDefinedManagedViewFiltersElement.classList.remove(w.ui.ViewSelectorButtonOption.viewButtonWithEntity),this.SystemDefinedManagedViewFiltersElement.classList.remove(w.ui.ViewSelectorButtonOption.viewButtonWithContext),this.SystemDefinedManagedViewFiltersElement.classList.remove(w.ui.ViewSelectorButtonOption.viewButtonWithNoContext),(i=$(this.element).find(".formCaptionContainer")[0]).classList.remove(w.ui.FormCaptionContainerOptions.smallCaptionContainer),i.classList.remove(w.ui.FormCaptionContainerOptions.largeCaptionContainer),e){case w.forms.ViewsButtonLocation.MainCaption:a=".formCaption-context",s=w.ui.ViewSelectorButtonOption.largeViewSelector,c=w.ui.FormCaptionContainerOptions.smallCaptionContainer;break;case w.forms.ViewsButtonLocation.TopEntityName:a=w.value(this.ParentTitleFields)?".formCaption-context":".formCaption",s=w.ui.ViewSelectorButtonOption.viewButtonWithContext,(w.value(this.FormCaption())||w.value(this.ParentTitleFields))&&(l=w.ui.ViewSelectorButtonOption.showSeperator);break;case w.forms.ViewsButtonLocation.TopContext:default:w.value(this.ParentTitleFields)?(a=".formCaption",n=this.element.querySelector(".formCaption-context"),d=!0,s=w.ui.ViewSelectorButtonOption.viewButtonWithContext,l=w.ui.ViewSelectorButtonOption.showSeperator):(u=!(a=".formCaption"),s=w.ui.ViewSelectorButtonOption.viewButtonWithNoContext),c=w.ui.FormCaptionContainerOptions.largeCaptionContainer}null!=a&&(o=$(this.element).find(a)[0])&&(d&&!o.parentElement.classList.contains("positionContainer")?((r=this.element.querySelector(".positionContainer"))||(r=document.createElement("div")).classList.add("positionContainer"),o.before(r),n?r.appendChild(n):r.appendChild(o),r.appendChild(this.SystemDefinedManagedViewFiltersElement)):u?$(this.SystemDefinedManagedViewFiltersElement).insertAfter(o):o.before(this.SystemDefinedManagedViewFiltersElement),this.SystemDefinedManagedViewFiltersElement.classList.add(s),s===w.ui.ViewSelectorButtonOption.largeViewSelector?(o.classList.add(w.ui.ViewSelectorButtonOption.largeViewSelector),o.classList.remove(w.ui.ViewSelectorButtonOption.viewButtonWithNoContext),o.classList.remove(w.ui.ViewSelectorButtonOption.viewButtonWithContext),o.classList.remove(w.ui.ViewSelectorButtonOption.showSeperator),this.SystemDefinedManagedViewFiltersElement.classList.remove(w.ui.ViewSelectorButtonOption.viewButtonWithNoContext),this.SystemDefinedManagedViewFiltersElement.classList.remove(w.ui.ViewSelectorButtonOption.viewButtonWithContext),this.SystemDefinedManagedViewFiltersElement.classList.remove(w.ui.ViewSelectorButtonOption.showSeperator)):o.classList.remove(w.ui.ViewSelectorButtonOption.largeViewSelector),t&&i.classList.add(c)),null!=l&&this.SystemDefinedManagedViewFiltersElement.classList.add(l)}},l.prototype.updateFormHeadingLevel=function(){if("Dashboard"===w.value(this.Style)&&void 0===this.element.getElementsByTagName("h1")[0]){var e=this.element.querySelector("[data-dyn-controlname=CompanyName]");(e=e||this.element.querySelector(".formCaption"))&&(e.setAttribute("aria-level","1"),e.setAttribute("role","heading"))}},l.PanelManager=(o.prototype.init=function(){var t=this;this.panels=[],this.formThis.FilterPaneControl&&(this.panels.push(this.formThis.FilterPaneControl),w.observe(this.formThis.FilterPaneControl.Visible,function(e){t._panelVisibleHandler(e,t.formThis.FilterPaneControl)},this,null,!0)),this.formThis.SidePanel.SidePanelContext&&(this.panels.push(this.formThis.SidePanel),w.observe(this.formThis.SidePanel.SidePanelContext.Visible,function(e){t._panelVisibleHandler(e,t.formThis.SidePanel)},this,null,!0)),this.formThis.FactBoxPane.hasFactBox&&(this.panels.push(this.formThis.FactBoxPane),w.observe(this.formThis.FactBoxPaneCollapsed,function(e){t._panelVisibleHandler(!e,t.formThis.FactBoxPane)},this,null,!0),w.isObservable(this.formThis.FactBoxPaneInitiallyExpanded)&&w.observe(this.formThis.FactBoxPaneInitiallyExpanded,function(e){t.formThis.HandleFactBoxPaneOpenClose(e),t.formThis.HandleFactBoxPaneFocus(!0)})),0<this.panels.length&&(w.shell.CurrentFormViewportSize===w.shell.ViewportSize.Small&&this._panelsResponsiveHandler(),this.viewPortBreakHandler=w.bindingHandlers.FormViewportSize(),w.observe(this.formThis.IsActive,function(e){e?(t._viewportChangeHandler(null,w.shell.CurrentFormViewportSize),t.viewPortBreakHandler.apply(t._viewportChangeHandler,t)):t.viewPortBreakHandler.dispose()}))},o.prototype._panelsResponsiveHandler=function(e){if(this.panels&&0<this.panels.length){var t=void 0,o=!0;w.shell.CurrentFormViewportSize===w.shell.ViewportSize.Small?(t=0,e&&(o=!1)):t=w.shell.CurrentFormViewportSize===w.shell.ViewportSize.Medium?1:w.shell.CurrentFormViewportSize===w.shell.ViewportSize.Large?2:this.panels.length,this.formThis.SetRootContentVisibility(o);for(var n=this._getOpenPanelsCount()-t,i=void 0,r=0;0<n&&r<this.panels.length;)i=this.panels[r++],e&&e.Id===i.Id||w.callFunction(i.close,i)&&n--}},o.prototype._getOpenPanelsCount=function(){var t=0;return this.panels.map(function(e){e.isOpen()&&t++}),t},o.prototype._panelVisibleHandler=function(e,t){e?this._panelsResponsiveHandler(t):0===this._getOpenPanelsCount()&&this.formThis.SetRootContentVisibility(!0)},o.prototype._viewportChangeHandler=function(e,t){this.lastViewportSize!==t&&(this._panelsResponsiveHandler(),this.lastViewportSize=t)},o),l);function l(e,n,t,o){var i,r,a=s.call(this,e,n,t,o)||this;return a.EnterToggleFactBoxPane=function(e){w.util.isShortcutKeyPressed(e,{keyCode:w.ui.KeyCodes.enter})&&a.ToggleFactBoxPane(e)},w.ui.makeRoot(a),a.Loading=w.observable(),a.Refreshing=w.observable(!1),a.Processing=w.observable(),a.ActiveElement=w.observable(),a.LayoutWidth=w.ui.autoProperty(w.layout.Size.available,a,"Width"),a.LayoutHeight=w.ui.autoProperty(w.layout.Size.available,a,"Height"),a.Loaded=w.observable(),a.dialogStack=w.observableArray([]),a.invalidControls={},a.invalidUnboundControls={},a.IsOpen=w.observable(!1),a._takeFocus=!0,a._formParts=[],a.controlsWithAsyncRender={},a.waitForAsyncRender=w.observable(!1),a.FindFocusTarget=void 0,a.serializeTransitState=new w.eventHost,a.onClose=new w.eventHost,a.FactBoxPaneCollapsed=w.observable(!0),a.FactBoxPaneTooltip=w.observable(w.label("FactBoxPane_ToggleToolTip")),a.FactBoxPaneHelpText=w.observable(w.label("FactBoxPane_ToggleHelpText")),a.NoShowableFactBoxes=w.observable(!0),a.ShouldRightPaneGutterBeVisible=w.observable(!1),a.DelayedFactBoxLoad=!1,a._zoomElementsMoved=!1,a.ObserveFactBoxes(),w.ui.applyDefaults(a,e,w.ui.defaults.Form),w.ui.PerformanceTimer&&(w.ui.PerformanceTimer.openedForm=!0),a.LayoutArrangeMethod=a.ArrangeMethod,a.LayoutColumns=w.ui.columnsProperty(w.layout.Columns.balanced,a),a.isRootFormActive=w.computed(function(){return w.value(a.IsActive)}),a.ShouldFactBoxButtonBeVisible=w.computed(function(){return!w.value(a.NoShowableFactBoxes)}),a.FactBoxButtonToggled=w.computed(function(){return!w.value(a.FactBoxPaneCollapsed)}),a.Close=w.observable(function(i){var e=w.context(w.value(a.ActiveElement));e&&e.updateValue&&e.updateValue(!0);var r=function(){i&&"function"==typeof w.value(i.closeCallback)?a.closeCallback=i.closeCallback:a.closeCallback&&(a.closeCallback=void 0);function e(e){e||(a._isCloseRequested=!1,w.log.navigation&&w.log.navigation("Navigation: form.RequestClose returned without success."),w.shell.browserHistory.failedClose()),a.IsOpen(!1)}w.flyout.flyoutManager.areAnyFlyoutsOpenByParentFormId(a.Id)&&w.flyout.flyoutManager.closeAllFlyoutsByParentFormId(a.Id);for(var t=!0,o=w.length(a.dialogStack)-1;0<=o;o--){var n=w.context(w.value(a.dialogStack)[o]);if(n){t=!1,w.log.navigation&&w.log.navigation("Navigation: close dialog before closing primary form: "+w.value(n.FormName));w.callFunction(n.Close,void 0,{closeCallback:function(){w.async(function(){a.dialogStack.pop(),r()},void 0,"Calling execute close in callback to close the next form or dialog")}});break}a.dialogStack.pop()}t&&($(a.element).trigger("formClose"),i&&i.hasOwnProperty("record")?a.callRequestClose(e,i.record):a.callRequestClose(e))};a._alwaysAllowClose?r():a.AllowSave(r,function(){w.shell.browserHistory.failedClose()})}),w.value(a.RequestClose)===w.ui.defaults.Form.RequestClose&&a.RequestClose(function(){w.shell.close({form:a})}),w.observe(a.IsActive,function(e){if(e){if(w.shell.isShellInitializing())var t=w.shell.isShellInitializing.valueChanged.subscribe(function(){w.shell.isShellInitializing()||(w.layout.arrange(n,!0),w.shell.isShellInitializing.valueChanged.unsubscribe(t))});else w.layout.arrange(n,!0);if(a.IsTabbingContainer){r="Dialog"===a.TypeName?n.querySelector(".dialog-popup-content")||n:n.querySelector(".rootContent")||n;var o=a instanceof w.controls.Dialog||a instanceof w.controls.Popup||a instanceof w.controls.Form;i=w.util.tabbingContainer(r,w.label("Form_RegionTitle"),o)}a.updateFormHeadingLevel(),a._formZoomModeWidthObserver=w.observe(w.shell.zoomModeWidth,function(e){"Dashboard"!==w.value(a.Style)&&"Dialog"!==a.TypeName&&a._adjustBodyElementsForZoom(e)}),a._formZoomModeHeightObserver=w.observe(w.shell.zoomModeHeight,function(e){"Dashboard"!==w.value(a.Style)&&"Dialog"!==a.TypeName&&(e&&w.value(a.LayoutHeight)===w.layout.Size.available?(a.dynLayoutHeight=w.value(a.LayoutHeight),w.setValue(a,"LayoutHeight",w.layout.Size.content),w.layout.arrange(a.element,!0)):e||w.value(a.LayoutHeight)!==w.layout.Size.content||a.dynLayoutHeight!==w.layout.Size.available||(w.setValue(a,"LayoutHeight",a.dynLayoutHeight),a.dynLayoutHeight=void 0,w.layout.arrange(a.element,!0)))})}else i&&(i(),r=i=void 0),a._formZoomModeWidthObserver&&a._formZoomModeWidthObserver.dispose(),a._formZoomModeHeightObserver&&a._formZoomModeHeightObserver.dispose()}),w.observe(a.ShowLinkToGridView,function(e){var t=$(n).find(".formCaption");e?($(t).addClass("link-content-validLink"),$(t).attr("role","link"),$(t).attr("tabindex","0")):($(t).removeClass("link-content-validLink"),$(t).removeAttr("role"),$(t).attr("tabindex",w.util.isEnhancedTabSequenceEnabled()?"0":"-1"))}),w.observe(a.ActiveControl,function(e){if(e){if(w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->ActiveControl observer fired call setControlFocus control name %s",a.Id,e),!a.ActiveBoundaryInfo){var t=w.context(a.findControl(e));t&&(a.ActiveBoundaryInfo={DataSource:t.DataSource,ServiceBoundary:t.ServiceBoundary})}a.isFormActive()&&a.isInActiveFocusRegion()&&a.setControlFocus(e)}else w.log.focus&&w.log.focus("Focus: Form(Form.Id: %s)->ActiveControl observer fired call with no control name no-op",a.Id)}),w.isObservable(a.TriggerLocalRefresh)&&a.TriggerLocalRefresh.valueChanged.subscribe(a.LocalRefresh.bind(a)),a.FormCaption=w.computed(function(){if(w.restrictedNavigation&&w.value(a.FormCompany)){var e=w.value(a.FormCompany).toUpperCase();return w.format("{0} - {1}",w.value(a.Caption),e)}return w.value(a.Caption)}),a.UseReactGrid=w.computed(function(){return a.DataSource&&a.DataSource.getValue?w.value(a.DataSource.getValue("UseReactGrid")):w.util.isFlightEnabled(w.reactGrid.featureName)}),a.ForceLegacyGrid=w.observable(void 0),a._INTERNAL_ForceLegacyGrid_Prev=w.value(a.ForceLegacyGrid),w.observe(a.ForceLegacyGrid,function(e){0==a._INTERNAL_ForceLegacyGrid_Prev&&1==e&&w.warn({Message:w.label("Form_ReactGridUnsupported"),Label:"Form_ReactGridUnsupported"},a),a._INTERNAL_ForceLegacyGrid_Prev=e}),a.panelManager=new l.PanelManager(a),a.readyStatePromise=w.deferred.onTrue(function(){return w.value(a.ReadyState)===w.ui.ReadyState.ready}),a.readyStatePromise.done(function(){var e;w.observe(w.options(function(){return{viewMode:a.IsInViewMode,isActive:a.IsActive,formType:a.TypeName}}),function(e){e.isActive&&!w.flags.disableBrowserVersionCheck&&"Form"===e.formType&&w.util.browserVersionCheck(a),e.isActive&&!w.flags.disableUserLicenseCheck&&"Form"===e.formType&&w.util.userLicenseCheck(a)}),!a._zoomElementsMoved&&(null!==(e=a.FilterPaneControl)&&void 0!==e&&e.ShowFiltersButton||w.value(a.ShouldFactBoxButtonBeVisible))&&a.ShouldRightPaneGutterBeVisible(!0),a.panelManager.init()}),a}function o(e){this.formThis=e}(e.Form=t).prototype.IsForm=!0,t.prototype.MenuItemName="",t.prototype.elementToFocus=null,t.prototype.elementToFocusName="",t.prototype.isSetControlFocusCalled=!1,t.prototype.TypeName="Form",t.prototype.RequestCloseCommandName="RequestClose",t.prototype.IsTabbingContainer=!0,t.prototype.disposeOnClose=!0,t.prototype.Width=w.layout.Size.available,t.prototype.Height=w.layout.Size.available,t.prototype.systemDefinedManagedViewFiltersElementDetailsMasterMoved=!1,t.prototype._isCloseRequested=!1;var n=__assign(__assign(__assign(__assign({AdvancedFilterSort:{Keys:{ctrl:!0,shift:!0,keyCode:w.ui.KeyCodes.f3},Handler:function(e){this.executeShortcuts(!0,"AdvancedFilterSort",e)},Description:w.label("Form_OpenAdvancedSort"),Category:w.ui.ShortcutCategory.Navigate},AltSave:{Keys:{alt:!0,keyCode:w.ui.KeyCodes.letterS},Handler:function(e){this.executeShortcuts(!0,"SaveRecord",e)},Description:w.label("Form_SaveRecord"),Category:w.ui.ShortcutCategory.ActOnData},Attach:{Keys:{ctrl:!0,shift:!0,keyCode:w.ui.KeyCodes.letterA},Handler:function(e){return"Dashboard"!==w.value(this.Style)&&"Workspace"!==w.value(this.Style)&&(this.executeShortcuts(!0,"AttachRecord",e),!0)},Description:w.label("Form_AttachDocument"),ShowToUser:function(){return"Dashboard"!==w.value(this.Style)&&"Workspace"!==w.value(this.Style)}},DefaultAction:{Keys:{keyCode:w.ui.KeyCodes.enter},Handler:function(e){this.ExecuteDefaultAction(e)},ShowToUser:!1},DefaultActionAlternate:{Keys:{alt:!0,keyCode:w.ui.KeyCodes.enter},Handler:function(e){this.ExecuteDefaultAction(e)},ShowToUser:function(){return w.value(this.DefaultActionEnabled)&&!!w.value(this.DefaultAction)},Description:w.label("Form_DefaultAction")},Delete:{Keys:{alt:!0,keyCode:w.ui.KeyCodes.deleteKey},Handler:function(e){this.executeShortcuts(!1,"DeleteRecord",e)},Description:w.label("Form_DeleteRecord"),Category:w.ui.ShortcutCategory.ActOnData},DeleteF9:{Keys:{alt:!0,keyCode:w.ui.KeyCodes.f9},Handler:function(e){this.executeShortcuts(!1,"DeleteRecord",e)},ShowToUser:!1},DetailsView:{Keys:{ctrl:!0,shift:!0,keyCode:w.ui.KeyCodes.letterD},Handler:function(e){this.executeShortcuts(!0,"DetailsView",e)},Description:w.label("Form_DetailsView"),Category:w.ui.ShortcutCategory.Navigate},Escape:{Keys:{keyCode:w.ui.KeyCodes.esc},Handler:function(e){(!w.isEmbedded||w.isEmbedded&&1<w.length(w.shell.stack))&&this.escape(e)},Description:w.label("Form_Close"),Category:w.ui.ShortcutCategory.Close},ExportToExcel:{Keys:{ctrl:!0,shift:!0,keyCode:w.ui.KeyCodes.letterE},Handler:function(e){this.executeShortcuts(!0,"ExportToExcel",e)},Description:w.label("Form_ExportExcel")},FactBoxPane:{Keys:{ctrl:!0,keyCode:w.ui.KeyCodes.f2},Handler:function(e){this.ToggleFactBoxPane(e,w.forms.FactBoxFocusTarget.FactBox)},ShowToUser:!1},FactBoxPaneAlt:{ChordKeys:{alt:!0,keyCode:w.ui.KeyCodes.letterM},Keys:{keyCode:w.ui.KeyCodes.letterB},Handler:function(e){if(w.value(this.FactBoxPaneCollapsed))this.ToggleFactBoxPane(e,w.forms.FactBoxFocusTarget.FactBox);else{var t=$("[data-dyn-role='FactBox']",this.element).first();if(t.length){var o=w.util.findFirstTabbableControl(t[0]);this.form_setFocus(o,!0)}}},Description:w.label("Form_GoToFactBoxPane"),Category:w.ui.ShortcutCategory.Navigate},FirstRecord:{Keys:{ctrl:!0,keyCode:w.ui.KeyCodes.home},Handler:function(e){this.executeShortcuts(!0,"FirstRecord",e)},Description:w.label("Form_FirstRecord"),Category:w.ui.ShortcutCategory.Navigate},ForceClose:{Keys:{alt:!0,shift:!0,keyCode:w.ui.KeyCodes.letterQ},Handler:function(e){(!w.isEmbedded||w.isEmbedded&&1<w.length(w.shell.stack))&&this.executeShortcuts(!1,"ForceClose")},Description:w.label("Form_ForceClose"),Category:w.ui.ShortcutCategory.Close},GoToActionPane:{Keys:{ctrl:!0,keyCode:w.ui.KeyCodes.f6},Handler:function(e){if(0===$(this.ActiveElement()).parents(".appBar").length){var t=w.util.findFirstFocusableControl($(this.element).find("[data-dyn-role='AppBarSection']:visible").first()[0],!1);this.InternalFocusIn(t,this.ActiveElement(),!0)}else this.RestoreFocusToMainFormContainer()},ShowToUser:!1},GoToActionPaneAlt:{ChordKeys:{alt:!0,keyCode:w.ui.KeyCodes.letterM},Keys:{keyCode:w.ui.KeyCodes.letterA},Handler:function(e){if(0===$(this.ActiveElement()).parents(".appBar").length){var t=w.util.findFirstFocusableControl($(this.element).find("[data-dyn-role='AppBarSection']:visible").first(),!1);this.InternalFocusIn(t,this.ActiveElement(),!0)}},Description:w.label("Form_GoToActionPane"),Category:w.ui.ShortcutCategory.Navigate},GoToActionSearchField:{Keys:{ctrl:!0,keyCode:w.ui.KeyCodes.apostrophe},Handler:function(e){this.goToActionSearch()},ShowToUser:!1},GoToActionSearchFieldAlt:{Keys:{alt:!0,keyCode:w.ui.KeyCodes.letterQ},Handler:function(e){this.goToActionSearch()},Description:w.label("Form_GoToActionSearch"),Category:w.ui.ShortcutCategory.Navigate},GoToFilterPane:{Keys:{ctrl:!0,keyCode:w.ui.KeyCodes.f3},Handler:function(e){var t=this.FilterPaneControl;if(t)if(w.value(t.Visible)){var o=void 0;0===$(this.ActiveElement()).parents(".filterPane").length?(t.element&&(o=w.util.findFirstFocusableControl(t.element)),this.InternalFocusIn(o,this.ActiveElement())):this.RestoreFocusToMainFormContainer()}else t.toggleVisibility&&t.toggleVisibility()},ShowToUser:!1},GoToFilterPaneAlt:{ChordKeys:{alt:!0,keyCode:w.ui.KeyCodes.letterM},Keys:{keyCode:w.ui.KeyCodes.letterF},Handler:function(e){var t=this.FilterPaneControl;if(t)if(w.value(t.Visible)){var o=void 0;0===$(this.ActiveElement()).parents(".filterPane").length&&(t.element&&(o=w.util.findFirstFocusableControl(t.element)),this.InternalFocusIn(o,this.ActiveElement()))}else t.toggleVisibility&&t.toggleVisibility()},ShowToUser:function(){return!!this.FilterPaneControl},Description:w.label("Form_GoToFilterPane"),Category:w.ui.ShortcutCategory.Navigate},GoToFirstFormVisibleField:{Keys:{ctrl:!0,shift:!0,keyCode:w.ui.KeyCodes.letterF},Handler:function(e){this.RestoreFocusToMainFormFirstVisibleControl()},Description:w.label("Form_GoToFirstVisible"),Category:w.ui.ShortcutCategory.Navigate},GoToMessageBar:{Keys:{ctrl:!0,keyCode:w.ui.KeyCodes.f7},Handler:function(e){this.MessageBar&&w.value(this.MessageBar.IsVisible)&&this.MessageBar.shortcutFocus()},ShowToUser:function(){return this.MessageBar&&w.value(this.MessageBar.IsVisible)},Description:w.label("Form_GoToMessageBar"),Category:w.ui.ShortcutCategory.Navigate}},!w.isEmbedded&&{GoToNavigationList:{Keys:{ctrl:!0,keyCode:w.ui.KeyCodes.f8},Handler:function(e){var t=this.SidePanel.SidePanelElement;if(t&&w.value(this.SidePanel.SidePanelContext.Visible)){var o=void 0;$(e.target).parents().is(".SidePanel")?this.RestoreFocusToMainFormContainer():(o=w.util.findFirstFocusableControl(t),this.InternalFocusIn(o,this.ActiveElement()))}else w.callFunction(this.SidePanel.toggleVisibility,this)},ShowToUser:!1},GoToNavigationListAlt:{ChordKeys:{alt:!0,keyCode:w.ui.KeyCodes.letterM},Keys:{keyCode:w.ui.KeyCodes.letterS},Handler:function(e){var t=this.SidePanel.SidePanelElement;if(t&&w.value(this.SidePanel.SidePanelContext.Visible)){if(!$(e.target).parents().is(".SidePanel")){var o=w.util.findFirstFocusableControl(t);this.InternalFocusIn(o,this.ActiveElement())}}else w.callFunction(this.SidePanel.toggleVisibility,this)},ShowToUser:function(){return!!this.SidePanel},Description:w.label("Form_GoToNavList"),Category:w.ui.ShortcutCategory.Navigate},GoToNavigationSearch_Primary:{Keys:{ctrl:!0,keyCode:w.ui.KeyCodes.forwardslash},Handler:function(){this.goToNavigationSearch()},ShowToUser:!1},GoToNavigationSearch_Alternate:{Keys:{alt:!0,keyCode:w.ui.KeyCodes.letterG},Handler:function(){this.goToNavigationSearch()},Description:w.label("Form_GoToNavSearch"),Category:w.ui.ShortcutCategory.Navigate}}),{GridView:{Keys:{ctrl:!0,shift:!0,keyCode:w.ui.KeyCodes.letterG},Handler:function(e){this.executeShortcuts(!0,"GridView",e)},Description:w.label("Form_GridView")},HeaderView:{Keys:{ctrl:!0,shift:!0,keyCode:w.ui.KeyCodes.letterH},Handler:function(e){this.executeShortcuts(!0,"HeaderView",e)},Description:w.label("Form_HeaderView"),Category:w.ui.ShortcutCategory.Navigate},LastRecord:{Keys:{ctrl:!0,keyCode:w.ui.KeyCodes.end},Handler:function(e){this.executeShortcuts(!0,"LastRecord",e)},Description:w.label("Form_LastRecord"),Category:w.ui.ShortcutCategory.Navigate},LinesView:{Keys:{ctrl:!0,shift:!0,keyCode:w.ui.KeyCodes.letterL},Handler:function(e){this.executeShortcuts(!0,"LinesView",e)},Description:w.label("Form_LinesView"),Category:w.ui.ShortcutCategory.Navigate},New:{Keys:{alt:!0,keyCode:w.ui.KeyCodes.letterN},Handler:function(e){this.executeShortcuts(!0,"NewRecord",e)},Description:w.label("Form_NewRecord"),Category:w.ui.ShortcutCategory.ActOnData},NextRecord:{Keys:{ctrl:!0,keyCode:w.ui.KeyCodes.downArrow},Handler:function(e){this.executeShortcuts(!0,"NextRecord",e)},Description:w.label("Form_NextRecord"),Category:w.ui.ShortcutCategory.Navigate},PageSelect:{Keys:{ctrl:!0,keyCode:w.ui.KeyCodes.letterA},Handler:function(e){return!(w.value(this.UseReactGrid)&&e&&e.target)||!$(e.target).parents().hasClass("reactGrid")},ShowToUser:!1}}),!w.isEmbedded&&{Personalize:{Keys:{ctrl:!0,shift:!0,keyCode:w.ui.KeyCodes.letterP},Handler:function(e){this.personalize()},ShowToUser:function(){return w.value(this.AllowExplicitPersonalization)},Description:w.label("Form_Personalize")}}),{PreviousRecord:{Keys:{ctrl:!0,keyCode:w.ui.KeyCodes.upArrow},Handler:function(e){this.executeShortcuts(!0,"PreviousRecord",e)},Description:w.label("Form_PrevRecord"),Category:w.ui.ShortcutCategory.Navigate},Refresh:{Keys:{shift:!0,keyCode:w.ui.KeyCodes.f5},Handler:function(e){this.executeShortcuts(!0,"Refresh",e)},Description:w.label("Form_Refresh")},RequestClose:{Keys:{shift:!0,keyCode:w.ui.KeyCodes.esc},Handler:function(e){this.EscapeSaveYes()},Description:w.label("Form_RequestClose"),Category:w.ui.ShortcutCategory.Close},Restore:{Keys:{ctrl:!0,shift:!0,keyCode:w.ui.KeyCodes.f5},Handler:function(e){this.executeShortcuts(!1,"Restore",e)},Description:w.label("Form_Revert")},Save:{Keys:{ctrl:!0,keyCode:w.ui.KeyCodes.letterS},Handler:function(e){this.executeShortcuts(!0,"SaveRecord",e)},ShowToUser:!1},SelectAll:{Keys:{ctrl:!0,shift:!0,keyCode:w.ui.KeyCodes.letterM},Handler:function(e){this.executeShortcuts(!0,"SelectAll",e)},Description:w.label("Form_SelectAll")},ViewEdit:{Keys:{keyCode:w.ui.KeyCodes.f2},Handler:function(e){this.executeShortcuts(!0,"ViewEdit",e)},Description:function(){return w.value(this.IsInViewMode)?w.label("Form_EditMode"):w.label("Form_ViewMode")}}});t.prototype.Shortcuts=w.extendPrototype(t.prototype.Shortcuts,n)}(w.controls||(w.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(a){Globalize.addCultureInfo("en",{messages:{Dialog_Close:"Close the dialog",Dialog_Copilot:"Copilot",Dialog_DefaultButton:"Invoke default button",Dialog_HelpToolTip:"Help",Dialog_HideToolTip:"Hide"}}),function(e){var r,t=(r=a.controls.Form,__extends(o,r),o.prototype.openCopilot=function(){a.shell.isCopilotSidePaneOpen()||a.shell.createForm({menuItem:"Display:SysCopilotChatPanel",elementCreated:a.serverForm.getForm,role:"Dialog"})},o.prototype.Open=function(){this.IsOpen(!0)},o.prototype.hide=function(){this._onHide&&this._onHide.apply(this,arguments)},o.prototype.onHide=function(e){null===e?(this._canHide(!1),this._onHide=null):e&&(this._canHide(!0),this._onHide=e)},o.prototype.ObserveFactBoxes=function(){},o.prototype._close=function(){this.willBeClosed=!0,this.IsActive(!1),this._zoomModeHeightObserver&&(this._zoomModeHeightObserver.dispose(),this._zoomModeHeightObserver=void 0),this.closeCallback&&a.getFunction(this.closeCallback)()},o.prototype.openHelp=function(){a.shell.openHelpPane()},o.prototype._back=function(){this.back.apply(this,arguments)},o);function o(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return i.dynLayoutHeight=void 0,i.canGoBack=a.observable(!1),i._canHide=a.observable(!1),i.shouldDisplayHelpIcon=a.observable(!0),i.shouldDisplayCopilotIcon=a.observable(!0),a.observe(i.IsActive,function(e){e&&!i.canActivate?a.shell.close({form:i}):e&&(i.willBeClosed=!1,i.IsOpen(!0))}),a.deferred.onTrue(function(){return a.value(i.IsActive)}).done(function(){i._zoomModeHeightObserver=a.observe(a.shell.zoomModeHeight,function(e){i.IsActive()&&(e&&a.value(i.LayoutHeight)===a.layout.Size.available?(i.dynLayoutHeight=a.value(i.LayoutHeight),a.setValue(i,"LayoutHeight",a.layout.Size.content)):e||void 0===i.dynLayoutHeight||(a.setValue(i,"LayoutHeight",i.dynLayoutHeight),i.dynLayoutHeight=void 0))})}),i.shouldCloseOnClick=function(e){i.IsActive()&&e.flyoutElement&&0<e.flyoutElement.length&&$.contains(e.flyoutElement[0],e.clickTarget)},i.isCopilotIconVisible=a.computed(function(){return a.value(i.shouldDisplayCopilotIcon)&&a.ui.getNavBar()&&a.ui.getNavBar().findSysCopilotChatPanelIndex&&-1!==a.ui.getNavBar().findSysCopilotChatPanelIndex()}),i}(e.Dialog=t).prototype.back=a.shell.dialogBack,t.prototype.TypeName="Dialog";var n={DefaultAction:{Keys:{keyCode:a.ui.KeyCodes.enter},Handler:function(e){this.executeDefaultActionOrDefaultButton(e)},ShowToUser:!1},DefaultActionAlternate:{Keys:{alt:!0,keyCode:a.ui.KeyCodes.enter},Handler:function(e){this.executeDefaultActionOrDefaultButton(e)},Description:function(){return a.value(this.DefaultActionEnabled)?a.label("Form_DefaultAction"):a.label("Dialog_DefaultButton")}},Escape:{Keys:{keyCode:a.ui.KeyCodes.esc},Handler:function(e){var t=e?a.context(e.target):void 0;t&&t.updateValue&&t.updateValue(!0),this.AllowSave(a.shell.initiateBack)},Description:a.label("Dialog_Close"),Category:a.ui.ShortcutCategory.Close}};t.prototype.Shortcuts=a.extendPrototype(t.prototype.Shortcuts,n)}(a.controls||(a.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(a){var e,s,t;function o(e,t,o,n){var i,r=e.ArrangeMethod||a.layout.ArrangeMethod.horizontalLeft;return i=s.call(this,e,t,o,n)||this,a.setValue(i,"ArrangeMethod",r),i}e=a.controls||(a.controls={}),s=a.controls.Dialog,__extends(o,s),t=o,(e.LightBox=t).prototype.IsLightBox=!0,t.prototype.Caption=a.label("LightBoxNotificationAria")}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){Globalize.addCultureInfo("en",{messages:{Copy_Button:"Copy",Copy_Failed:"Copy failed",Copy_Passed:"Copied!",Dialog_HideDiagnostic:"Hide diagnostic information",Dialog_ShowDiagnostic:"Show diagnostic information",MessageBox_BrowserActivityId:"Activity ID: ",MessageBox_BrowserInteractionTimestamp:"Search timestamp: ",MessageBox_BrowserSessionActivityId:"Session ID: ",MessageBox_Cancel:"Cancel",MessageBox_Close:"Close",MessageBox_LessText:"Fewer Details",MessageBox_MessageList:"Messages in list.",MessageBox_MoreText:"More Details",MessageBox_MultipleMessages:"You've received multiple errors.",MessageBox_No:"No",MessageBox_NoToAll:"No To All",MessageBox_Ok:"OK",MessageBox_Tenant:"Tenant ID: ",MessageBox_Yes:"Yes",MessageBox_YesToAll:"Yes To All"}});var e,a,t,o,n,i,s={callback:void 0,ImageName:void 0,ImageType:void 0,SecondaryText:"",showCancelButton:!1,showCloseButton:!1,showDiagnostic:!0,showNoButton:!1,showNoToAllButton:!1,showOkButton:!1,showTelemetryData:!1,showYesButton:!1,showYesToAllButton:!1,Text:"",Visible:!0};function l(e,t,o,n){var i=a.call(this,e,t,o,n)||this;return r.ui.applyDefaults(i,e,r.ui.defaults.MessageBox),(r.shell.activeMessageBox=i).callbacks=[],r.value(i.callback)&&(i.callbacks=i.callbacks.concat(r.value(i.callback))),i.HasMultipleMessages=r.computed(function(){return 1<r.value(i.Messages).length}),i.TitleText=r.computed(function(){if(i.HasMultipleMessages())return r.label("MessageBox_MultipleMessages");var e=r.value(i.Text);return e?1===e.length?e[0]:e:""}),i.BrowserSessionActivityId=r.computed(function(){return r.format("{0} {1}",r.label("MessageBox_BrowserSessionActivityId"),r.browserActivity.BrowserSessionActivity.Id)}),i.AOSRoleInstance=r.computed(function(){return r.browserActivity.AOSRoleInstance}),i.BrowserInteractionTimestamp=r.computed(function(){return r.format("{0} {1}",r.label("MessageBox_BrowserInteractionTimestamp"),r.browserActivity.BrowserInteractionActivity.UtcTimestamp)}),i.ShowSessionId=r.computed(function(){return!r.browserActivity.SearchTraceLog}),i.ShowSessionIdAnchor=r.computed(function(){return r.browserActivity.SearchTraceLog}),i.buildInformation=r.util.getBuildString(),i.showTelemetryData=r.observable(!1),i.groupFrameOption=r.observable(0),i.groupLabel=r.computed(function(){return r.value(i.groupFrameOption)?r.label("Dialog_HideDiagnostic"):r.label("Dialog_ShowDiagnostic")}),i.Messages=r.observableArray([]),$.isArray(r.value(i.Text))?i.addMessages(r.value(i.Text)):i.Messages.push({Value:0,Label:r.value(i.Text)}),i}r.ui.defaults.MessageBox=s,e=r.controls||(r.controls={}),a=r.ui.Container,__extends(l,a),l.prototype.addMessage=function(e,t){this.Messages.push({Value:r.length(this.Messages),Label:e}),t&&this.callbacks.push(t)},l.prototype.addMessages=function(e,t){if(e){$.isArray(e)||(e=[e]);for(var o=new Array,n=r.length(this.Messages),i=0;i<e.length;i++)e[i]&&o.push({Value:n+i,Label:e[i].text||e[i]});this.Messages(this.Messages().concat(o)),t&&(this.callbacks=this.callbacks.concat(t))}},l.prototype.buttonClicked=function(e){r.shell.activeMessageBox=void 0,r.shell.dialogBack();for(var t=0;t<this.callbacks.length;t++){var o=this.callbacks[t];r.getFunction(o)(e)}},i=l,e.MessageBox=i,t=i=e.MessageBox||(e.MessageBox={}),(o=t.Button||(t.Button={}))[o.Close=0]="Close",o[o.Yes=1]="Yes",o[o.YesToAll=2]="YesToAll",o[o.No=3]="No",o[o.NoToAll=4]="NoToAll",o[o.Ok=5]="Ok",o[o.Cancel=6]="Cancel",(n=t.ButtonName||(t.ButtonName={})).Close="Close",n.Yes="Yes",n.YesToAll="YesToAll",n.No="No",n.NoToAll="NoToAll",n.Ok="Ok",n.Cancel="Cancel"}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(a){var e,r,t;function o(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return a.ui.applyDefaults(i,e,a.ui.defaults.Popup),i.Root=a.context(a.shell.getActiveForm())||a.shell,i.RequestOpen=function(e){},i}a.ui.defaults.Popup={SelectActionCommandBindings:"{}",SelectionCompleted:null},e=a.controls||(a.controls={}),r=a.controls.Form,__extends(o,r),o.prototype.IgnoreBlockingDiv=function(e){return e===this.RequestCloseCommandName&&this.highlyResponsive},o.prototype.isActivePopup=function(){var e=a.shell.getActiveForm(),t=a.context(e);return e===this.element||a.shell.isFormRootOfNonFocusableActiveForm(this,t)||t&&this.Root&&t.Id===this.Root.Id},o.prototype.Open=function(){if(this.onPopupReceived&&this.onPopupReceived(this._createOnPopupReceivedEvent()),a.value(this.ReadyState)===a.ui.ReadyState.aborted||!this.isActivePopup()&&a.shell!==this.Root?(this.popupAborted=!0,a.applyFunction(this.Close,this)):(this.takeFocusOnOpen&&a.shell.activateElement(this.element,{forceActivation:!0}),this.IsOpen(!0)),this._takeFocus||this._focusModeToggler_FocusEventTarget||this._registerTakeFocusTransitioner(),a.shell.isPhone&&this.Children){var e=this.Children();3===e.length&&e[0]&&"List"===e[0].TypeName&&e[1]&&"FilterPane"===e[1].TypeName&&e[2]&&"FilterManager"===e[2].TypeName&&(a.setValue(e[0],"LayoutHeight",a.layout.Size.available),a.setValue(e[0],"VisibleRowCount",0))}},o.prototype.dispose=function(){this._focusModeToggler_FocusEventTarget&&(this._focusModeToggler_TargetMousedownEvent&&(this._focusModeToggler_FocusEventTarget.removeEventListener("mousedown",this._focusModeToggler_TargetMousedownEvent,!0),this._focusModeToggler_TargetMousedownEvent=null),this._focusModeToggler_TargetClickEvent&&(this._focusModeToggler_FocusEventTarget.removeEventListener("click",this._focusModeToggler_TargetClickEvent,!1),this._focusModeToggler_TargetClickEvent=null)),this.element&&this._focusModeToggler_FlyoutMouseDownEvent&&(this.element.removeEventListener("mousedown",this._focusModeToggler_FlyoutMouseDownEvent,!0),this._focusModeToggler_FlyoutMouseDownEvent=null),r.prototype.dispose.call(this)},o.prototype.shouldResetFocusOnClose=function(){var e=!0;return this.element&&!a.value(this.TakeFocus)&&(e=this.isElementContainedByPopup(document.activeElement)),e},o.prototype.callRequestClose=function(e,t){var o=this,n=a.value(this.ReadyState)===a.ui.ReadyState.aborted||this.highlyResponsive;if(this._isCloseRequested)a.log.popups&&a.log.popups("Popups: Skipping attempt to call RequestClose for popup %s; It is already in the process of being closed.",this.Name?this.Name:"<unknown>");else{this._isCloseRequested=!0,a.log.popups&&a.log.popups("Popups: Calling RequestClose for popup %s.",this.Name?this.Name:"<unknown>"),this.highlyResponsive&&(a.shell.deactivateElement(this.element),this.popupAborted||a.shell.tryActivateParentElement(this,{takeNavigationFocus:this.shouldResetFocusOnClose()}));var i=[n];if(!1===t&&i.push(!0),a.serverForm&&a.peek(a.serverForm.processingInteractions))var r=a.serverForm.processingInteractions.valueChanged.subscribe(function(){a.callFunction(o.RequestClose,o,i,e),a.serverForm.processingInteractions.valueChanged.unsubscribe(r)});else a.callFunction(this.RequestClose,this,i,e)}},o.prototype.ObserveFactBoxes=function(){},o.prototype._close=function(){this.element&&this.element.dynClose&&a.getFunction(this.element.dynClose)(),this.closeCallback&&a.getFunction(this.closeCallback)()},o.prototype._createOnPopupReceivedEvent=function(){var e=this;return{cancel:function(){a.value(e.ReadyState)!==a.ui.ReadyState.aborted&&a.applyFunction(e.Close,e)},popup:this}},o.prototype._registerTakeFocusTransitioner=function(){var e,t=this;this._focusModeToggler_FlyoutMouseDownEvent=function(e){t._takeFocus=!0,t.takeFocusToggled=!0},this.element.addEventListener("mousedown",this._focusModeToggler_FlyoutMouseDownEvent,!0),this.FindFocusTarget&&(e=this.FindFocusTarget()),e&&1===e.length&&(this._focusModeToggler_TargetMousedownEvent=function(e){t._takeFocus=!1},this._focusModeToggler_TargetClickEvent=function(e){t.takeFocusToggled=!1},this._focusModeToggler_FocusEventTarget=e[0],this._focusModeToggler_FocusEventTarget.addEventListener("mousedown",this._focusModeToggler_TargetMousedownEvent,!0),this._focusModeToggler_FocusEventTarget.addEventListener("click",this._focusModeToggler_TargetClickEvent,!1))},o.prototype.isElementContainedByPopup=function(e){return $.contains(this.element,e)},t=o,(e.Popup=t).prototype.takeFocusOnOpen=!0,t.prototype.highlyResponsive=!1,t.prototype.routeMessagesToParent=!1,t.prototype.popupAborted=!1,t.prototype.TypeName="Popup",t.prototype.IsTabbingContainer=!0,t.prototype._alwaysAllowClose=!0,a.adapter({id:"Preview",controlType:"Popup",template:"Preview"}),a.adapter({id:"LookupPopup",controlType:"Popup",template:"LookupPopup"})}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){Globalize.addCultureInfo("en",{messages:{DialogPopup_Close:"Close the popup"}}),function(e){var t,o=(t=r.controls.Popup,__extends(n,t),n);function n(){return null!==t&&t.apply(this,arguments)||this}e.DropDialogPopup=o;var i={DefaultAction:{Keys:{keyCode:r.ui.KeyCodes.enter},Handler:function(e){this.executeDefaultActionOrDefaultButton(e)},ShowToUser:!1},DefaultActionAlternate:{Keys:{alt:!0,keyCode:r.ui.KeyCodes.enter},Handler:function(e){this.executeDefaultActionOrDefaultButton(e)},Description:function(){return r.value(this.DefaultActionEnabled)?r.label("Form_DefaultAction"):r.label("Dialog_DefaultButton")}},Escape:{Keys:{keyCode:r.ui.KeyCodes.esc},Handler:function(e){var t=e?r.context(e.target):void 0;t&&t.updateValue&&t.updateValue(!0),this.AllowSave(r.shell.initiateBack)},Description:r.label("DialogPopup_Close"),Category:r.ui.ShortcutCategory.Close}};o.prototype.Shortcuts=r.extendPrototype(o.prototype.Shortcuts,i)}(r.controls||(r.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){var e,a,t;function o(e,o,t,n){var i=a.call(this,e,o,t,n)||this;return i.Root&&i.Root.serializeTransitState&&(i.onSerializeTransitStateSubscriptionId=i.Root.serializeTransitState.subscribe(i.onSerializeTransitState.bind(i))),i.Root&&i.Root.onClose&&(i.rootCloseSubscriptionId=i.Root.onClose.subscribe(i.onRootClose.bind(i))),i.canLoadPromise=r.deferred.onTrue(function(){return i.canLoadForm()}),$.when(i.canLoadPromise).done(function(){i.asyncload=r.async(function(){var e={name:function(){var e="";if("string"==typeof i.Resource)e=i.Resource;else{var t=r.value(i.Resource);t&&(e=t.menuItem)}return e}(),parameters:{Part:i},ShouldBlockOnExecution:!1,targetElement:$('[data-dyn-role="PartForm"]',o)[0]||$('[data-dyn-role="FactBoxForm"]',o)[0]};r.value(i.FormId)&&(e.id=r.value(i.FormId),e.formPart=!0,e.context=r.serverForm.getModel(r.value(i.FormId))),r.ui.layout(!0);var t=r.shell.createForm(e);i.ClientFormId=t.getAttribute("data-dyn-formid"),r.ui.layout(!1)},void 0,"Load form part")}),i}e=r.controls||(r.controls={}),a=r.ui.Container,__extends(o,a),o.prototype.onSerializeTransitState=function(){this.PartForm&&this.PartForm.serializeTransitState.raise()},o.prototype.readFormId=function(){var e=this,t=$('[data-dyn-role="PartForm"]',this.element)[0]||$('[data-dyn-role="FactBoxForm"]',this.element)[0];if(t){var o=t.getAttribute("data-dyn-formid");r.async(function(){r.setValue(e,"FormId",o)},void 0,"Set part form id.")}},o.prototype.getChildForms=function(){var e=[],t=$(this.element).find('[data-dyn-role="PartForm"]');return t&&0<t.length&&(e.push(r.context(t[0])),1<t.length&&r.logError("Part: More than one form found")),e},o.prototype.activate=function(){if(r.log.focus&&r.log.focus("Activate: Part Control(Form.Id: %s)->Activate",this.element.getAttribute("data-dyn-form-name")),this.Root&&this.Root.ActiveControl){var e=this.Root.ActiveControl(),t=this.Root.findControl(e);if(t&&r.context(t)&&r.context(t).Id!==this.Id){var o=r.value(this.Root.TakeFocus),n=this.Root.FindFocusTarget;r.setValue(this.Root,"TakeFocus",!1),this.Root.FindFocusTarget=void 0,this.Root.activateControl(this,!0),r.setValue(this.Root,"TakeFocus",o),this.Root.FindFocusTarget=n}}},o.prototype.setChildControlFocus=function(){var e=$(this.element).find("form")[0];if(e){var t=r.context(e);if(t){var o=this._getFocusableChildElement(t);if(o)return this.setFocus(o,t),o}}},o.prototype.dispose=function(){this.canLoadPromise&&this.canLoadPromise.reject&&this.canLoadPromise.reject(),this.asyncload&&this.asyncload.cancel&&this.asyncload.cancel(),void 0!==this.onSerializeTransitStateSubscriptionId&&(this.Root&&this.Root.serializeTransitState&&this.Root.serializeTransitState.unsubscribe&&this.Root.serializeTransitState.unsubscribe(this.onSerializeTransitStateSubscriptionId),this.onSerializeTransitStateSubscriptionId=void 0),void 0!==this.rootCloseSubscriptionId&&(this.Root&&this.Root.onClose&&this.Root.onClose.unsubscribe&&this.Root.onClose.unsubscribe(this.rootCloseSubscriptionId),this.rootCloseSubscriptionId=void 0),a.prototype.dispose.call(this)},o.prototype.canLoadForm=function(){return r.value(this.Visible)},o.prototype.onRootClose=function(){var e=this;this.PartForm&&this.Root&&!this.Root.detachedForPopout&&r.async(function(){r.callFunction(e.PartForm.RequestCloseCancel,e.PartForm)},void 0,"Call RequestCloseCancel on PartForm")},o.prototype._getFocusableChildElement=function(e){var t;if(e.ActiveControl()){var o=e.ActiveControl();t=e.findControl(o)}var n=t||r.util.findFirstFocusableControl(this.element);return $(n).addBack().closest("[data-dyn-controlname]")[0]},t=o,(e.Part=t).prototype.ObjectName="",t.prototype.Visible=!0,t.prototype.Caption="",t.prototype.FormId="",t.prototype.LoadInline=!1,t.prototype.IsFirstChild=!1,t.prototype.RefreshInterval=0,t.prototype.PartForm=null,r.ui.addObservablePropertiesToPrototype(t.prototype,{Expanded:!1})}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(a){Globalize.addCultureInfo("en",{messages:{FactBox_Collapse:"Collapse FactBox",FactBox_Open:"Open FactBox",FactBox_RegionTitle:"Related Information"}}),a.ax=a.ax?a.ax:{},function(e){var r,t=(r=a.controls.Part,__extends(o,r),o.prototype.isControlAvailableForExpando=function(){return!0},o.prototype.getChildForms=function(){var e=[],t=$(this.element).find('[data-dyn-role="FactBoxForm"]');return t&&0<t.length&&(e.push(a.context(t[0])),1<t.length&&a.logError("FactBox: More than one form found")),e},o.prototype.getExpandoPersonalizationFocusTarget=function(){return $(this.element).find(".section-page-header")},o.prototype.toggleFactBoxExpanded=function(){if(a.callFunction(this.PersistPersonalization,this,["expanded",!a.value(this.Expanded)]),this.Expanded(!a.value(this.Expanded)),this.Root)if(a.value(this.Expanded)){var e=a.util.findFirstFocusableControl(this.element);this.Root.InternalFocusIn(e,a.context(this.Root.element).ActiveElement(),!0)}else e=a.util.findFirstTabbableControl(this.element),this.Root.form_setFocus(e,!0);a.ax.personalizationUtil&&a.ax.personalizationUtil.forceUpdateFormPersonalizationData()},o.prototype.expand=function(){a.value(this.Expanded)||this.toggleFactBoxExpanded()},o.prototype.collapse=function(){a.value(this.Expanded)&&this.toggleFactBoxExpanded()},o.prototype.keydown=function(e){a.util.handleShortcuts(this,e)},o.prototype.canLoadForm=function(){var e=!!this.Root&&a.value(this.Root.FactBoxPaneCollapsed);return!0===a.value(this.IsFirstChild)?a.value(this.Visible)&&!e:a.value(this.Visible)&&a.value(this.Expanded)&&!e},o);function o(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return $(t).is(":first-child")&&(i.IsFirstChild=!0),i.IsFirstChild&&i.Root&&a.value(i.Root.FactBoxPaneInitiallyExpanded)&&a.value(i.Root.FactBoxPaneCollapsed)&&(i.IsFirstChild=!1,i.Root.ToggleFactBoxPane()),i}e.FactBox=t;var n={ToggleExpand:{Keys:{keyCode:[a.ui.KeyCodes.enter,a.ui.KeyCodes.spacebar]},Handler:function(e){this.toggleFactBoxExpanded()},Description:function(){return a.value(this.Expanded)?a.label("FactBox_Collapse"):a.label("FactBox_Open")}},Collapse:{Keys:{alt:!0,keyCode:a.ui.KeyCodes.Number0},Handler:function(e){this.collapse()},Description:a.label("FactBox_Collapse")}};t.prototype.Shortcuts=a.extendPrototype(t.prototype.Shortcuts,n)}(a.controls||(a.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(p){var e,i,t,o;function n(e,t,o,n){var d=i.call(this,e,t,o,n)||this;d.Width=p.layout.Size.available,d.Height=p.layout.Size.available;var c=e.Part;return d.Part=p.observable(c),d.hostForm=p.context($(t).parents(".active-form")[0]),c=c||{},p.callFunction(c.InitPartForm,c,t),d.readyStatePromise2=p.deferred.onTrue(function(){return!c.Root||c.Root&&p.value(c.Root.ReadyState)===p.ui.ReadyState.ready&&!p.clientBusy()||p.value(c.LoadInline)}),d.readyStatePromise2.done(function(){!1!==p.callFunction(c.ShouldCreatePartForm,c,{element:t,partForm:d})&&(!0===p.value(c.IsFirstChild)&&!p.value(c.Expanded)&&p.value(c.Expand)&&p.async(function(){p.callFunction(c.SystemExpand,c,[!0])},void 0,"Expand first factbox"),"Local"===p.value(c.RunMode)&&p.value(c.CreateForm)?p.callFunction(c.CreatePartForm,c,{mode:"Local",element:t,partForm:d}):p.observe(function(){var e=p.value(c.IsDataBound),t=p.value(c.RunMode),o="";if(c.Root){var n={HostViewKey:p.value(c.Root.CurrentViewKey),PersonalizationViewsSaveModel:p.value(c.Root.PersonalizationViewsSaveModel)};o=JSON.stringify(n)}if(e&&!d.inited){d.inited=!0;var i=c.Children(),r={menuItem:p.value(c.ObjectName),PartHostViewConfiguration:o};if("Local"!==t){var a={FormPartType:c.TypeName,LinkedId:c.Name,Ranges:[]};if(r.DataFilter=a,i)for(var s=0,l=i.length;s<l;s++){var u=i[s];a.Ranges.push({DataField:p.value(u.TargetFieldName),DataSource:p.value(u.TargetModelName),LinkedId:u.Name,Value:p.value(u.LinkedValue)})}}return r}},function(e){e&&(e.formPart="Local"!==p.value(c.RunMode),e.targetElement=t,e.callback=d.PartFormCreated.bind(d),e.ShouldBlockOnExecution=!1,p.log.form&&p.log.form("Form: loading form: %s with resource: %o",e.menuItem,e),p.callFunction(c.CreatePartForm,c,{mode:"Remote",resource:e}))}))}),d.isRootFormActive=p.computed(function(){return p.value(d.Part().Root.IsActive)}),d._close=function(){p.log.form&&p.log.form("Form: _close called on Part form %s",d.Name),d._clearRefreshInterval()},d}e=p.controls||(p.controls={}),i=p.controls.Form,__extends(n,i),Object.defineProperty(n.prototype,"TakeFocus",{get:function(){var e=!0,t=this.Part();return!1===this._takeFocus?e=!1:t&&t.Root&&t.Root!==this&&void 0!==t.Root.TakeFocus&&(e=t.Root.TakeFocus),e},set:function(e){this._takeFocus=p.peek(e)},enumerable:!1,configurable:!0}),n.prototype.Open=function(){p.util.setVisibility(this.element,!0,!1),this.IsOpen(!0)},n.prototype.FocusIn=function(e){if(p.log.focus&&p.log.focus("Focus: Part Form(Form.Id: %s)->FocusIn",this.element.getAttribute("data-dyn-form-name")),!p.shell.canFocus(this))return p.log.focus&&p.log.focus("Focus: Form(Form.Id: %s)->FocusIn invalid focus attempt",this.Id),e.stopImmediatePropagation(),void e.preventDefault();var t=this.ActiveElement(),o=e.target;o=$(o).addBack().closest("[data-dyn-controlname]")[0],p.context(o)&&p.context(o).Root&&this.Id!==p.context(o).Root.Id||(this.focusedControl=o,this.InternalFocusIn(o,t),this.Part().activate())},n.prototype.isFormActive=function(){var e=this.Part(),t=this.Part().Root;void 0===t&&(t=this);var o=p.value(t.ActiveControl);return!(e.Name!==o||!0!==t.isNavigationActiveForm()||!p.value(this.IsOpen))},n.prototype.PartFormCreated=function(){var e=p.value(this.Part);e.readFormId(),e.PartForm=this,e.Root&&e.Name!==p.value(e.Root.ActiveControl)||this.takeNavigationFocus(),this._initiateAutoRefresh();var t=e.Root;t&&t.RegisterFormPart(this),!0!==p.value(e.LoadInline)&&$(document.body).trigger(p.forms.Events.partCreated,[this])},n.prototype.ObserveFactBoxes=function(){},n.prototype.dispose=function(){this._clearRefreshInterval(),this.readyStatePromise2&&this.readyStatePromise2.reject&&this.readyStatePromise2.reject(),this.hostForm&&(this.hostForm=void 0),i.prototype.dispose.call(this)},n.prototype.keydown=function(e){p.util.handleShortcuts(this,e),e.isPropagationStopped()||this.Part().Root&&p.util.handleShortcuts(this.Part().Root,e)},n.prototype._initiateAutoRefresh=function(){var e=this,t=p.value(this.Part),o=p.value(t.RefreshInterval);if(0<o){var n=1e3*o;this._refreshIntervalId=window.setInterval(function(){$(e.element).is(":visible")&&e.executeShortcuts(!1,"Refresh")},n)}},n.prototype._clearRefreshInterval=function(){this._refreshIntervalId&&(clearInterval(this._refreshIntervalId),this._refreshIntervalId=void 0)},t=n,o={AdvancedFilterSort:{Keys:{ctrl:!((e.PartForm=t).prototype.IsTabbingContainer=!1),shift:!0,keyCode:p.ui.KeyCodes.f3},Handler:function(e){this.executeShortcuts(!0,"AdvancedFilterSort",e)},Description:p.label("Form_OpenAdvancedSort"),Category:p.ui.ShortcutCategory.Navigate},AltSave:{Keys:{alt:!0,keyCode:p.ui.KeyCodes.letterS},Handler:function(e){this.executeShortcuts(!0,"SaveRecord",e)},Description:p.label("Form_SaveRecord"),Category:p.ui.ShortcutCategory.ActOnData},Attach:{Keys:{ctrl:!0,shift:!0,keyCode:p.ui.KeyCodes.letterA},Handler:function(e){this.executeShortcuts(!0,"AttachRecord",e)},Description:p.label("Form_AttachDocument")},Delete:{Keys:{alt:!0,keyCode:p.ui.KeyCodes.deleteKey},Handler:function(e){this.executeShortcuts(!1,"DeleteRecord",e)},Description:p.label("Form_DeleteRecord"),Category:p.ui.ShortcutCategory.ActOnData},DeleteF9:{Keys:{alt:!0,keyCode:p.ui.KeyCodes.f9},Handler:function(e){this.executeShortcuts(!1,"DeleteRecord",e)},ShowToUser:!1},ExportToExcel:{Keys:{ctrl:!0,shift:!0,keyCode:p.ui.KeyCodes.letterE},Handler:function(e){this.executeShortcuts(!0,"ExportToExcel",e)},Description:p.label("Form_ExportExcel")},FirstRecord:{Keys:{ctrl:!0,keyCode:p.ui.KeyCodes.home},Handler:function(e){this.executeShortcuts(!0,"FirstRecord",e)},Description:p.label("Form_FirstRecord"),Category:p.ui.ShortcutCategory.Navigate},LastRecord:{Keys:{ctrl:!0,keyCode:p.ui.KeyCodes.end},Handler:function(e){this.executeShortcuts(!0,"LastRecord",e)},Description:p.label("Form_LastRecord"),Category:p.ui.ShortcutCategory.Navigate},NextRecord:{Keys:{ctrl:!0,keyCode:p.ui.KeyCodes.downArrow},Handler:function(e){this.executeShortcuts(!0,"NextRecord",e)},Description:p.label("Form_NextRecord"),Category:p.ui.ShortcutCategory.Navigate},PreviousRecord:{Keys:{ctrl:!0,keyCode:p.ui.KeyCodes.upArrow},Handler:function(e){this.executeShortcuts(!0,"PreviousRecord",e)},Description:p.label("Form_PrevRecord"),Category:p.ui.ShortcutCategory.Navigate},Save:{Keys:{ctrl:!0,keyCode:p.ui.KeyCodes.letterS},Handler:function(e){this.executeShortcuts(!0,"SaveRecord",e)},ShowToUser:!1}},t.prototype.Shortcuts=o}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){var e,a,t;function o(e,t,o,n){var i=a.call(this,e,t,o,n)||this;return i.Expanded=r.value(i.Part).Expanded,i}e=r.controls||(r.controls={}),a=r.controls.PartForm,__extends(o,a),t=o,e.FactBoxForm=t}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(p){var e,l,t;function o(e,t,o,n){var d=l.call(this,e,t,o,n)||this;p.setValue(d,"Visible",!1);var i=d.Root;if(i){var c=p.value(i.Part);if(c){var r=p.computed(function(){var e=[];if(d.IsDataBound())for(var t=d.Children(),o=c.Children(),n=0,i=t.length;n<i;n++)for(var r=t[n],a=0,s=o.length;a<s;a++){var l=o[a];if(l.Name===p.value(r.LinkedId)){r.Link=l;var u=p.value(l.LinkedValue);p.value(r.RangeValue)!==u&&e.push({range:r,value:u})}}return e}),a=function(e){!0===(e=p.value(e))&&!0===d.applyChangeScheduled&&(d.applyChangeScheduled=!1,s(r()))},s=function(e){0<(e=p.value(e)).length&&(i.Expanded&&!p.value(i.Expanded)?d.applyChangeScheduled=!0:d.applyChangeScheduled||(d.applyChangeScheduled=!0,p.async(function(){!function(e){for(var t=0,o=e.length;t<o;t++){var n=e[t];p.setValue(n.range,"RangeValue",n.value)}p.applyFunction(d.ApplyChanges,d),d.applyChangeScheduled=!1}(r())},void 0,"Defer setting of rangeValue changes so we can batch them all from the same event loop")))};r.valueChanged.subscribe(s),s(r()),i.Expanded&&(d.expandedSubscription=i.Expanded.valueChanged.subscribe(a),a(i.Expanded))}}return d}e=p.controls||(p.controls={}),l=p.ui.Container,__extends(o,l),o.prototype.dispose=function(){this.expandedSubscription&&this.Root&&this.Root.Expanded.valueChanged.unsubscribe(this.expandedSubscription),l.prototype.dispose.call(this)},t=o,e.DataFilter=t}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(e){var t,o,n;function i(){return null!==o&&o.apply(this,arguments)||this}t=e.controls||(e.controls={}),o=e.ui.Control,__extends(i,o),n=i,(t.DataFilterRange=n).prototype.LinkedId="",n.prototype.FormPartType="Part",n.prototype.RangeValue=""}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(e){var t,o,n;function i(){return null!==o&&o.apply(this,arguments)||this}t=e.controls||(e.controls={}),o=e.ui.Control,__extends(i,o),n=i,t.PartLink=n}($dyn=$dyn||{}),function(o){var e,t;function n(e){this.shortcuts=e,this.ElementActionsVisible=0<o.length(e[o.ui.ShortcutCategory.ElementAction]),this.NavigateVisible=0<o.length(e[o.ui.ShortcutCategory.Navigate]),this.ActOnDataVisible=0<o.length(e[o.ui.ShortcutCategory.ActOnData]),this.CloseVisible=0<o.length(e[o.ui.ShortcutCategory.Close]),this.OtherVisible=0<o.length(e[o.ui.ShortcutCategory.Other])}Globalize.addCultureInfo("en",{messages:{Framework_ActOnDataShortcuts:"Act on data",Framework_AvailableShortcuts:"Currently Available Shortcuts",Framework_CloseShortcuts:"Close",Framework_ElementActions:"Shortcuts for selected element",Framework_NavigateShortcuts:"Navigate",Framework_OtherShortcuts:"Other",Framework_ViewAllProductShortcuts:"View all product shortcuts",Framework_ViewShortcuts:"View shortcuts"}}),o.showAvailableShorcutsDialog=function(e){var t={context:new o.controls.AvailableShortcutsLightBox(e),role:"Dialog",templateId:"AvailableShortcutsLightBox"};o.shell.createForm(t),o.shell.dialog(t)},e=o.controls||(o.controls={}),n.prototype.closeClicked=function(){o.shell.dialogBack()},t=n,(e.AvailableShortcutsLightBox=t).prototype.headerText=o.label("Framework_AvailableShortcuts"),t.prototype.ElementActionsLabel=o.label("Framework_ElementActions"),t.prototype.NavigateLabel=o.label("Framework_NavigateShortcuts"),t.prototype.ActOnDataLabel=o.label("Framework_ActOnDataShortcuts"),t.prototype.CloseLabel=o.label("Framework_CloseShortcuts"),t.prototype.OtherLabel=o.label("Framework_OtherShortcuts")}($dyn=$dyn||{}),function(n){var e,t;function o(e){var t=this;if(this.continueButtonVisible=n.observable(!1),this.signoutButtonVisible=n.observable(!1),this.reconnectButtonVisible=n.observable(!1),this.timeRemaining=n.observable(),this.sessionExpiredWarning=-1,this.imageName="Info",this.altText=n.label("MessageBox_InfoIcon"),"Logout"===e.type){this.continueButtonVisible(!0),this.signoutButtonVisible(!0),this.title=n.label("TimeoutDialogWarning_Message"),this.message=n.label("TimeoutDialogWarning_Body");var o=e.timerCountDown;this.sessionExpiredWarning=window.setInterval(function(){o--;var e="0"+Math.floor(o/60)+":"+("0"+Math.floor(o%60)).slice(-2);t.timeRemaining(e),0===o&&window.clearInterval(t.sessionExpiredWarning)},1e3)}else this.title=n.label("TimeoutDialog_Message"),this.message=n.label("TimeoutDialog_Body"),this.reconnectButtonVisible(!0)}Globalize.addCultureInfo("en",{messages:{TimeoutDialog_Body:"There was no activity for a while so we closed the session.",TimeoutDialog_Message:"Session ended",TimeoutDialog_ReconnectButtonText:"Start new session",TimeoutDialogWarning_Body:"If not, we'll close this session shortly in: ",TimeoutDialogWarning_Continue:"I'm here",TimeoutDialogWarning_Message:"Are you still there?",TimeoutDialogWarning_Signout:"Sign out"}}),n.showTimeoutDialog=function(e){var t={context:new n.controls.TimeoutDialog(e),role:"Dialog",templateId:"TimeoutDialog"};n.shell.createForm(t),n.shell.dialog(t)},e=n.controls||(n.controls={}),o.prototype.reconnect=function(){window.location.reload()},o.prototype.continue=function(){n.serverForm&&n.serverForm.sessionTimeoutRemainWarningShown&&(n.serverForm.sessionTimeoutRemainWarningShown=!1,n.serverForm.resetSessionTimeout()),clearInterval(this.sessionExpiredWarning),n.shell.dialogBack()},o.prototype.logout=function(){n.shell.logOut()},t=o,e.TimeoutDialog=t}($dyn=$dyn||{}),function(n){function e(e){var t=this;this.dialogOptions=e,this.BrowserInteractionTimestamp=n.format("{0} {1}",n.label("MessageBox_BrowserInteractionTimestamp"),n.browserActivity.BrowserInteractionActivity.UtcTimestamp),this.BrowserSessionActivityId=n.format("{0} {1}",n.label("MessageBox_BrowserSessionActivityId"),n.browserActivity.BrowserSessionActivity.Id),this.buildInformation=n.util.getBuildString(),this.showTelemetryData=n.observable(!1),this.imageName=e.ImageName,this.altText=e.Tooltip,this.TitleText=e.Text,this.retryButtonText=e.RetryText,this.groupFrameOption=n.observable(0),this.groupLabel=n.computed(function(){return n.value(t.groupFrameOption)?n.label("Dialog_HideDiagnostic"):n.label("Dialog_ShowDiagnostic")}),this.ActiveControl="Retry";var o=this;this.retry=function(){n.clientInError(!1),n.shell.dialogBack(),o.dialogOptions&&"function"==typeof o.dialogOptions.Callback&&o.dialogOptions.Callback.apply(null,arguments)}}n.showConnectionErrorDialog=function(e){var t={context:new n.controls.ConnectionErrorDialog(e),role:"Dialog",templateId:"ConnectionErrorDialog"};n.shell.createForm(t),n.clientInError(!0),n.shell.dialog(t)},(n.controls||(n.controls={})).ConnectionErrorDialog=e}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(g){var n,i,e,t;function o(e,t,o,n){var v=i.call(this,e,t,o,n)||this;return v.applyFilters=function(){var t,e;if(g.value(v.ShowApply)&&g.isObservable(v.FilterExpression)&&v.FilterExpression.valueChanged.raise(void 0,!0),g.util.applyfilterToTelemetry(g.value(v.FieldExpressions),v.previousExpressions,v,g.telemetry.ActionEvents.filterDisplayFilter),g.value(g.ax.taskRecording.isRecording())){var o=[],n=g.value(v.FilterExpression);try{for(var i=__values(n),r=i.next();!r.done;r=i.next()){var a=r.value,s=g.value(a.DataSourceName),l=g.value(a.FieldName),u=g.value(a.SFKReplacementFieldBinding),d=v.getFieldCapability(s,l,u);if(d){var c=d.FieldLabel,p=g.value(d.DisplayDataType),h=a.Values,m=a.Operator;o.push({fieldLabel:c,operatorLabel:g.controls.FilterDisplay.GetOperatorLabel(g.value(m),p),values:g.value(h).join('","')})}}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}g.callFunction(v.ApplyFilters,v,["",JSON.stringify(o)])}else g.callFunction(v.ApplyFilters,v,[])},v.resetFilters=function(){for(var e=$(v.element).find(".filterDisplayContent").find(".input_container"),t=0;t<e.length;t++){var o=g.context(e[t]);o&&!1===g.value(o.IsValid)&&g.setValue(o,"formattedValue","",!0)}v.telemetryEventArgs=g.telemetry.addControlActionEvent(v,v.telemetryEventArgs,g.telemetry.ActionEvents.filterDisplayReset,{}),v.previousExpressions=[],g.callFunction(v.ResetFilters,v,[])},v.addFilterField=function(){g.value(v.ShowApply)&&g.isObservableArray(v.FilterExpression)&&v.FilterExpression.valueChanged.raise(void 0,!0),g.callFunction(v.AddAFilterField,v,[])},v.postRenderFields=function(){v.setFieldContainerSizing()},v.Capabilities=g.observableObject(v.CapabilityList),v.capabilitiesFlatList=g.computed(function(){var t,e,o,n,i=[],r=g.value(v.CapabilityList);try{for(var a=__values(r),s=a.next();!s.done;s=a.next()){var l=s.value,u=g.value(l.Fields);try{for(var d=(o=void 0,__values(u)),c=d.next();!c.done;c=d.next()){var p=c.value,h=g.value(p.FieldLabel)?g.value(p.FieldLabel):g.value(p.FieldName);i.push({DataSourceName:g.value(l.DataSourceName),DisplayDataType:g.value(p.DisplayDataType),DomainValues:g.value(p.DomainValues),FieldArrayIndex:g.util.getAxArrayFieldIndex(parseInt(g.value(p.FieldId),10)),FieldLabel:h,FieldName:g.value(p.FieldName),MasterFormDataSourceName:g.value(l.MasterFormDataSourceName),SFKReplacementFieldBinding:g.value(p.SFKReplacementFieldBinding),TableId:g.value(p.TableId)})}}catch(e){o={error:e}}finally{try{c&&!c.done&&(n=d.return)&&n.call(d)}finally{if(o)throw o.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}return i}),v.FieldExpressions=g.computed(function(){return 0===g.length(v.Capabilities)?[]:g.value(v.Expression)}),v.LayoutHeight=g.computed(function(){var e=g.value(v.Height);return e!==g.ui.autoValue&&e!==g.layout.Size.content||(e=g.layout.Size.available),e},function(e){g.setValue(v,"Height",e)}),g.value(v.ShowApply)?v.Expression=g.observableObject(v.FilterExpression):v.Expression=g.observableObject(v.FilterExpression,!0),v.previousExpressions=[],g.util.fieldExpressionAppend(v.Expression,v.previousExpressions),g.observe(v.FieldExpressions,function(){0===v.previousExpressions.length&&g.util.fieldExpressionAppend(v.Expression,v.previousExpressions)}),$(window).resize(v.setFieldContainerSizing),v.usingDisposable(g.observe(g.ui.layout,v.postRenderFields)),v}Globalize.addCultureInfo("en",{messages:{FilterDataType_Date:"Date",FilterDataType_DateTime:"DateTime",FilterDataType_Number:"Number",FilterDataType_Option:"Option",FilterDataType_String:"Text",FilterDataType_Time:"Time",FilterDisplayControl_AddField:"Add filter fields",FilterDisplayControl_Apply:"Apply",FilterDisplayControl_Clear:"Clear",FilterDisplayControl_DataSourceName:"Table",FilterDisplayControl_DataType:"Type",FilterDisplayControl_FieldName:"Field",FilterDisplayControl_RemoveField:"Remove filter on {0}",FilterDisplayControl_Reset:"Reset",FilterField_AddField:"Add",FilterOperators_BeginsWith:"begins with",FilterOperators_Between:"between",FilterOperators_Contains:"contains",FilterOperators_DoesNotContain:"does not contain",FilterOperators_GreaterThan:"after",FilterOperators_GreaterThan_Date:"after",FilterOperators_GreaterThanOrEqual:"greater than or equal",FilterOperators_Is:"is exactly",FilterOperators_Is_Date:"is exactly",FilterOperators_Is_Option:"is exactly",FilterOperators_IsEqualTo:"is equal to",FilterOperators_IsNot:"is not",FilterOperators_IsNot_Date:"is not",FilterOperators_IsNot_Option:"is not",FilterOperators_IsOneOf:"is one of",FilterOperators_IsOneOf_Option:"is one of",FilterOperators_LessThan:"before",FilterOperators_LessThan_Date:"before",FilterOperators_LessThanOrEqual:"less than or equal",FilterOperators_Matches:"matches",FilterOperators_Matches_Date:"matches",FilterOperators_Matches_Number:"matches",FilterOperators_Matches_Option:"matches",FilterOperators_NotEqualTo:"not equal to"}}),n=g.controls||(g.controls={}),i=g.ui.Container,__extends(o,i),o.prototype.removeFilterExpression=function(e){var t=g.value(this.Expression).indexOf(e);if(0<=t){this.Expression.splice(t,1);var o=this.getLastField();this.previousExpressions.push(g.util.fieldExpressionSimpleCopy(e)),o?g.microTask(function(){g.log.focus&&g.log.focus("Focus: Filter-> focus the last field after removing a filter"),$(o).focus()}):g.microTask(function(){g.log.focus&&g.log.focus("Focus: Filter-> no filter to focus, so focusing the add filter button"),$("[Name=SystemDefinedFilterPane_FilterDisplay_AddFilterField]").focus()})}},o.prototype.getFieldCapability=function(e,t,o){var n=g.value(this.CapabilityList),i=this.getCapability(n,e),r=i?i.Fields:null;return this.getField(g.value(r),t,o)},o.prototype.dispose=function(){$(window).off("resize",this.setFieldContainerSizing),i.prototype.dispose.call(this)},o.prototype.displayDataType=function(e,t){var o,n,i,r,a="",s=g.value(this.Capabilities);if(s)try{for(var l=__values(s),u=l.next();!u.done;u=l.next()){var d=u.value;if(d&&g.value(d.DataSourceName)===e)try{for(var c=(i=void 0,__values(g.value(d.Fields))),p=c.next();!p.done;p=c.next()){var h=p.value;g.value(h.FieldName===t)&&(a=g.value(h.DisplayDataType))}}catch(e){i={error:e}}finally{try{p&&!p.done&&(r=c.return)&&r.call(c)}finally{if(i)throw i.error}}}}catch(e){o={error:e}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(o)throw o.error}}return a},o.prototype.flyoutEscapeSubscriber=function(){g.util.flyout.defaultFlyoutEscapeSubscriber();var o=this.element.getElementsByClassName("filterDisplay-addFieldControl"),n=this.Root;o&&0<o.length&&g.async(function(){if(g.log.focus){var e=g.context($(o)[0]);g.log.focus("Focus: Filter-> esc add field flyout set add button focused "+e.Id)}var t=o[0].getAttribute("data-dyn-controlname");n.ActiveControl(t)})},o.prototype.setFieldContainerSizing=function(){var e,t=g.shell.getActiveForm();if(t&&(e=g.context(t)),e&&e.FilterPaneControl&&e.FilterPaneControl.element){var o=$(e.FilterPaneControl.element).find(".filterDisplayContent")[0];if(o){var n=$(e.FilterPaneControl.element).find(".filterPaneTitle")[0],i=n?$(n).outerHeight(!0):0;if(g.util.isInZoomHeightMode())$(o).css("max-height","");else{var r=$(e.FilterPaneControl.element).innerHeight()-$(o).siblings(".filterDisplayButtonContainer").outerHeight(!0)-i;r=0<r?r:0,$(o).css("max-height",r)}}}},o.prototype._generateFieldExpression=function(e){var t;if(e){var o=g.controls.FilterField.Operators.is;e.DisplayDataType===g.controls.FilterField.DataTypes.String?o=g.controls.FilterField.Operators.beginsWith:e.DisplayDataType!==g.controls.FilterField.DataTypes.Date&&e.DisplayDataType!==g.controls.FilterField.DataTypes.UtcDateTime&&e.DisplayDataType!==g.controls.FilterField.DataTypes.Time||(o=g.controls.FilterField.Operators.between),t={Capability:null,DataSourceName:g.value(e.DataSourceName),FieldArrayIndex:g.value(e.FieldArrayIndex),FieldName:g.value(e.FieldName),FormDataSourceName:"",IsEditable:"Yes",IsQueryFilter:"Yes",MasterFormDataSourceName:g.value(e.MasterFormDataSourceName),Operator:o,RecordingReferences:[],SFKReplacementFieldBinding:g.value(e.SFKReplacementFieldBinding),TableId:g.value(e.TableId),Values:[""]}}return t},o.prototype.getLastField=function(){var e,t=this.element.getElementsByClassName("filterField"),o=t.length;if(0<o){var n=t[o-1].getElementsByClassName("input_container");if(n&&0<n.length){var i=n[0].getElementsByClassName("field");i&&0<i.length&&(e=i[0])}}return e},o.prototype.getLastFileld=function(){return this.getLastField()},o.prototype.getCapability=function(e,t){var o,n;if(!Array.isArray(e))return null;try{for(var i=__values(e),r=i.next();!r.done;r=i.next()){var a=r.value;if(a.DataSourceName===t)return a}}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return null},o.prototype.getField=function(e,t,o){var n,i;if(!Array.isArray(e))return null;try{for(var r=__values(e),a=r.next();!a.done;a=r.next()){var s=a.value;if(s.FieldName===t&&s.SFKReplacementFieldBinding===o)return s}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}return null},t=o,(n.FilterDisplay=t).prototype.AddAFilterField=null,t.prototype.ApplyFilters=null,t.prototype.CapabilityList=[],t.prototype.FilterExpression=[],t.prototype.Height=g.layout.Size.available,t.prototype.HideFilters=null,t.prototype.ResetFilters=null,t.prototype.ShowAddFilter=!1,t.prototype.ShowApply=!1,t.prototype.ShowClear=!1,t.prototype.ShowFilters=null,(e=t=n.FilterDisplay||(n.FilterDisplay={})).GetDataTypeLabel=function(e){var t="";switch(e){case g.controls.FilterField.DataTypes.Date:t=g.label("FilterDataType_Date");break;case g.controls.FilterField.DataTypes.Time:t=g.label("FilterDataType_Time");break;case g.controls.FilterField.DataTypes.UtcDateTime:t=g.label("FilterDataType_DateTime");break;case g.controls.FilterField.DataTypes.Integer:case g.controls.FilterField.DataTypes.Int64:case g.controls.FilterField.DataTypes.Real:t=g.label("FilterDataType_Number");break;case g.controls.FilterField.DataTypes.Enum:t=g.label("FilterDataType_Option");break;default:t=g.label("FilterDataType_String")}return t},e.GetOperatorLabel=function(e,t){var o="";switch(e){case n.FilterField.Operators.matches:switch(t){case n.FilterField.DataTypes.Integer:case n.FilterField.DataTypes.Int64:case n.FilterField.DataTypes.Real:o=g.label("FilterOperators_Matches_Number");break;case n.FilterField.DataTypes.Date:case n.FilterField.DataTypes.UtcDateTime:case n.FilterField.DataTypes.Time:o=g.label("FilterOperators_Matches_Date");break;case n.FilterField.DataTypes.Enum:o=g.label("FilterOperators_Matches_Option");break;default:o=g.label("FilterOperators_Matches")}break;case n.FilterField.Operators.is:switch(t){case n.FilterField.DataTypes.Integer:case n.FilterField.DataTypes.Int64:case n.FilterField.DataTypes.Real:o=g.label("FilterOperators_IsEqualTo");break;case n.FilterField.DataTypes.Date:case n.FilterField.DataTypes.UtcDateTime:case n.FilterField.DataTypes.Time:o=g.label("FilterOperators_Is_Date");break;case n.FilterField.DataTypes.Enum:o=g.label("FilterOperators_Is_Option");break;default:o=g.label("FilterOperators_Is")}break;case n.FilterField.Operators.isNot:switch(t){case n.FilterField.DataTypes.Integer:case n.FilterField.DataTypes.Int64:case n.FilterField.DataTypes.Real:o=g.label("FilterOperators_NotEqualTo");break;case n.FilterField.DataTypes.Date:case n.FilterField.DataTypes.UtcDateTime:case n.FilterField.DataTypes.Time:o=g.label("FilterOperators_IsNot_Date");break;case n.FilterField.DataTypes.Enum:o=g.label("FilterOperators_IsNot_Option");break;default:o=g.label("FilterOperators_IsNot")}break;case n.FilterField.Operators.contains:o=g.label("FilterOperators_Contains");break;case n.FilterField.Operators.doesNotContain:o=g.label("FilterOperators_DoesNotContain");break;case n.FilterField.Operators.beginsWith:o=g.label("FilterOperators_BeginsWith");break;case n.FilterField.Operators.isOneOf:switch(t){case n.FilterField.DataTypes.Enum:o=g.label("FilterOperators_IsOneOf_Option");break;default:o=g.label("FilterOperators_IsOneOf")}break;case n.FilterField.Operators.greaterThan:switch(t){case n.FilterField.DataTypes.Date:case n.FilterField.DataTypes.UtcDateTime:case n.FilterField.DataTypes.Time:o=g.label("FilterOperators_GreaterThan_Date");break;default:o=g.label("FilterOperators_GreaterThan")}break;case n.FilterField.Operators.lessThan:switch(t){case n.FilterField.DataTypes.Date:case n.FilterField.DataTypes.UtcDateTime:case n.FilterField.DataTypes.Time:o=g.label("FilterOperators_LessThan_Date");break;default:o=g.label("FilterOperators_LessThan")}break;case n.FilterField.Operators.greaterThanOrEqual:o=g.label("FilterOperators_GreaterThanOrEqual");break;case n.FilterField.Operators.lessThanOrEqual:o=g.label("FilterOperators_LessThanOrEqual");break;case n.FilterField.Operators.between:o=g.label("FilterOperators_Between")}return o}}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(l){var e,u,t,o,n,i,r,a;function d(e,t,o,n){var i,a=this;(a=u.call(this,e,t,o,n)||this).OnPaste=function(e){if(l.value(a.Operator)===l.controls.FilterField.Operators.isOneOf){var t=window,o=e.clipboardData||t.clipboardData,n=void 0;if(o){var i=o.getData("text")||"";1<(n=(i=i.replace(/,/g,"\n")).split(/\r?\n|\t/)).length&&""===n[n.length-1]&&n.splice(n.length-1,1),l.value(a.ContainsMoreThanEmptyValue)&&(n=l.value(a.Values).map(function(e){return l.value(e)}).concat(n)),l.util.removeDuplicateOrEmptyStringArrayEntries(n),n&&(e.preventDefault(),e.stopPropagation(),a.Values.splice.apply(a.Values,[0,l.length(a.Values)].concat(n)))}}},a.postRenderValues=function(){for(;a.postRenderValuesSubscriptions.length;)a.postRenderValuesSubscriptions.pop()()},a.OnOperatorChange=function(){var e=l.value(a.Operator),t=l.value(a.Values).length;if(e===l.controls.FilterField.Operators.between)if(2<t)a.Values.splice(2,t-1);else for(var o=t;o<2;o++)a.Values.push("");else if(e===l.controls.FilterField.Operators.isOneOf)l.util.removeDuplicateOrEmptyStringArrayEntries(a.Values);else if(1<t)a.Values.splice(1,t-1);else for(var n=t;n<1;n++)a.Values.push("");a.selectedIndex=a.getOperatorIndex(e)},!a.Root&&o&&o.Root&&(a.Root=o.Root),l.isObservable(a.Visible)||(a.Visible=l.observable(a.Visible));var r,s=l.shell.getCurrentRootForm();return s&&(r=l.context(s)),a.OptimizedEnumFiltering=(null===(i=null==r?void 0:r.FilterPaneControl)||void 0===i?void 0:i.OptimizedEnumFiltering)||l.observable(!1),a.ShowFilterField=l.computed(function(){return!(!l.value(a.Visible)||!l.value(a.FieldCapability))}),a.FieldLabel=l.computed(function(){var e=l.value(a.FieldCapability);return null==e||null==e.FieldLabel?"":l.value(e.FieldLabel)}),a.ShowLookup=l.computed(function(){var e=l.value(a.FieldCapability);return null!=e&&null!=e.ShowLookup&&l.value(e.ShowLookup)}),a.TableId=l.computed(function(){var e=l.value(a.FieldCapability);return null==e?null:l.value(e.TableId)}),a.FieldId=l.computed(function(){var e=l.value(a.FieldCapability);return null==e?null:l.value(e.FieldId)}),a.fieldName=l.computed(function(){var e=l.value(a.FieldCapability);return null==e?null:l.value(e.FieldName)}),a.selectedIndex=0,l.observe(a.Operator,a.OnOperatorChange),l.isObservable(a.ShownIndex)||(a.ShownIndex=l.observable(a.ShownIndex)),l.isObservable(a.MenuDisplayed)||(a.MenuDisplayed=l.observable(a.MenuDisplayed)),a.OperatorLabel=l.computed(function(){return l.controls.FilterDisplay.GetOperatorLabel(l.value(a.Operator),l.value(a.DataType))}),a.FieldAriaLabel=l.computed(function(){return l.format(l.label("FilterManager_FieldFieldInputAriaLabel"),l.value(a.FieldLabel),l.value(a.OperatorLabel))}),a.DataType=l.computed(function(){var e=l.value(a.FieldCapability);return null==e||null==e.DisplayDataType?(l.setValue(a,"Visible",!1),d.DataTypes.None):(l.setValue(a,"Visible",!0),l.value(e.DisplayDataType))}),a.EnumItems=l.computed(function(){var e=[],t=l.value(a.FieldCapability);if(t&&l.value(a.DataType)===l.controls.FilterField.DataTypes.Enum){var o=l.value(t.DomainValues);0<(null==o?void 0:o.length)&&(e=o.map(function(e){return{Value:l.value(e.Name),Label:l.value(e.Label)}}))}return e}),a.InputRoleType=l.computed(function(){var e=l.value(a.Operator),t="Input";if(e===l.controls.FilterField.Operators.isOneOf)t="IsOneOf";else if(e!==l.controls.FilterField.Operators.matches)switch(l.value(a.DataType)){case l.controls.FilterField.DataTypes.Integer:t="Integer";break;case l.controls.FilterField.DataTypes.Int64:t="Int64";break;case l.controls.FilterField.DataTypes.Enum:t=l.value(a.OptimizedEnumFiltering)?"Enum":"Input";break;case l.controls.FilterField.DataTypes.Real:case l.controls.FilterField.DataTypes.Date:case l.controls.FilterField.DataTypes.UtcDateTime:case l.controls.FilterField.DataTypes.Time:default:t="Input"}return t}),a.ContainsMoreThanEmptyValue=l.computed(function(){var t,e,o=!1;try{for(var n=__values(l.value(a.Values)),i=n.next();!i.done;i=n.next()){var r=i.value;if(""!==l.value(r)){o=!0;break}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return o}),a.postRenderValuesSubscriptions=[],a}Globalize.addCultureInfo("en",{messages:{FilterManager_FieldFieldInputAriaLabel:"Filter field: {0}, operator: {1}"}}),e=l.controls||(l.controls={}),u=l.ui.Control,__extends(d,u),d.prototype.SelectOperator=function(e){if(l.value(this.Operator)!==e){for(var t=$(this.element).find(".input_container"),o=0;o<t.length;o++){var n=l.context(t[o]);!1===l.value(n.IsValid)&&l.setValue(n,"formattedValue","",!0)}l.setValue(this,"Operator",e)}},d.prototype.UpdateInitialShownIndex=function(){this.ShownIndex(this.selectedIndex),this.MenuDisplayed(!0)},d.prototype.getOperatorIndex=function(e){var t=d.SupportedOperators(l.value(this.DataType),l.value(this.fieldName));if(t)for(var o=0,n=t.length;o<n;o++)if(t[o]===e)return o;return-1},a=d,e.FilterField=a,t=a=e.FilterField||(e.FilterField={}),(n=o=t.Operators||(t.Operators={})).matches="Matches",n.is="Is",n.isNot="IsNot",n.contains="Contains",n.doesNotContain="DoesNotContain",n.beginsWith="BeginsWith",n.endsWith="EndsWith",n.isOneOf="IsOneOf",n.greaterThan="GreaterThan",n.lessThan="LessThan",n.greaterThanOrEqual="GreaterThanOrEqual",n.lessThanOrEqual="LessThanOrEqual",n.between="Between",(r=i=t.DataTypes||(t.DataTypes={})).String="String",r.Date="Date",r.UtcDateTime="UtcDateTime",r.Time="Time",r.Integer="Integer",r.Int64="Int64",r.Real="Real",r.Enum="Enum",r.Guid="Guid",r.None="",t.SupportedOperators=function(e,t){return t===l.util.dataAreaId?[o.is,o.isOneOf]:e===i.Date||e===i.UtcDateTime||e===i.Time?[o.is,o.isNot,o.greaterThan,o.lessThan,o.between,o.matches]:e===i.Integer||e===i.Int64||e===i.Real?[o.is,o.isNot,o.greaterThanOrEqual,o.lessThanOrEqual,o.between,o.matches]:e===i.Enum?[o.is,o.isNot,o.isOneOf,o.matches]:[o.is,o.isNot,o.contains,o.doesNotContain,o.beginsWith,o.isOneOf,o.greaterThan,o.lessThan,o.matches]},t.paste_Value=function(o,n){return function(e){if(2===e.length){var t=l.value(o.Values)[n];l.isObservable(t)&&t(e[1])}}},t.OnRequestPopup=function(s){return function(e){var t=s.Root?s.Root.FilterManager:void 0;if(t&&t.RequestLookupForm&&t.FilterToApply){var o=this.Name,n=e[0],i=this.displayedValue?this.displayedValue():"",r=!!this.isDisplayedValueDirty&&this.isDisplayedValueDirty(),a=l.util.unwrapFilterExpression(s.DataSource);t.FilterToApply(a),l.callFunction(t.RequestLookupForm,t,[o,n,i,r])}}},t.getSelectedItem=function(e,t){var o=l.value(l.value(e.Values)[t]),n=l.value(e.EnumItems);if(o&&0<(null==n?void 0:n.length)){var i=n.find(function(e){return e.Label===o});if(i)return i.Value}},t.SetSelectedItem=function(a,s){return function(e,t){var o,n=e[0],i=null===(o=l.value(a.EnumItems).find(function(e){return e.Value===n}))||void 0===o?void 0:o.Label,r=l.value(a.Values)[s];l.isObservable(r)&&r(i),l.setValue(this,"SelectedItem",n),null!=t&&t(!0)}},a.prototype.Operator=a.Operators.is,a.prototype.Values=[],a.prototype.FieldCapability=null,a.prototype.RecordingReferences=[],a.prototype.postRenderValuesSubscriptions=void 0}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(v){var e;(e=v.util||(v.util={})).fieldExpressionSimpleCopy=function(e){var t,o,n=v.value(e),i=v.observableArray([]);try{for(var r=__values(v.value(n.Values)),a=r.next();!a.done;a=r.next()){var s=a.value;i.push(v.value(s))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}return{DataSourceName:v.value(n.DataSourceName),FieldName:v.value(n.FieldName),Operator:v.value(n.Operator),TableId:v.value(n.TableId),Values:i}},e.isFieldExpressionValueEmpty=function(e){var t,o;try{for(var n=__values(v.value(e)),i=n.next();!i.done;i=n.next()){var r=i.value;return""!==v.value(r).trim()?!1:!0}}catch(e){t={error:e}}finally{try{i&&!i.done&&(o=n.return)&&o.call(n)}finally{if(t)throw t.error}}},e.filterOperator2Int=function(e){var t=-1;switch(e){case v.controls.FilterField.Operators.matches:t=0;break;case v.controls.FilterField.Operators.is:t=1;break;case v.controls.FilterField.Operators.isNot:t=2;break;case v.controls.FilterField.Operators.isOneOf:t=3;break;case v.controls.FilterField.Operators.contains:t=4;break;case v.controls.FilterField.Operators.doesNotContain:t=5;break;case v.controls.FilterField.Operators.beginsWith:t=6;break;case v.controls.FilterField.Operators.greaterThan:t=7;break;case v.controls.FilterField.Operators.greaterThanOrEqual:t=8;break;case v.controls.FilterField.Operators.lessThan:t=9;break;case v.controls.FilterField.Operators.lessThanOrEqual:t=10;break;case v.controls.FilterField.Operators.between:t=11;break;default:v.logError("The operator: %o is invalid.",e)}return t},e.fieldExpressionAppend=function(e,t){var o,n,i=v.value(e);try{for(var r=__values(i),a=r.next();!a.done;a=r.next()){var s=a.value;t.push(v.util.fieldExpressionSimpleCopy(s))}}catch(e){o={error:e}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}},e.simpleFieldExpressionValEqual=function(e,t){if(v.length(e)!==v.length(t))return!1;for(var o=0;o<v.length(e);o++){var n=v.value(v.value(e)[o]),i=v.value(v.value(t)[o]);return v.util.isNullOrUndefined(n)!==v.util.isNullOrUndefined(i)||n&&i&&n.trim()!==i.trim()?!1:!0}},e.getFilterApplyStatus=function(e,t){var o=v.util.isFieldExpressionValueEmpty(t.Values),n=v.util.isFieldExpressionValueEmpty(e.Values);return o&&n?-1:n?0:v.util.simpleFieldExpressionValEqual(e.Values,t.Values)&&v.value(e.Operator)===t.Operator?-1:1},e.recordFilterEvent=function(e,t,o,n){var i,r,a=v.util.filterOperator2Int(v.value(e.Operator));switch(v.util.getFilterApplyStatus(e,t)){case 0:i={userDefined1:0,userDefined2:a,extendedData:e.DataSourceName+";"+e.FieldName},r=v.telemetry.addControlActionEvent(o,r,n,i);break;case 1:i={userDefined1:1,userDefined2:a,extendedData:e.DataSourceName+";"+e.FieldName},r=v.telemetry.addControlActionEvent(o,r,n,i)}},e.applyfilterToTelemetry=function(e,t,o,n){var i=[];v.util.fieldExpressionAppend(e,i),i=i.sort(v.util.sortFieldExpression),t=t.sort(v.util.sortFieldExpression);for(var r=0,a=0;r<i.length;){var s=[];for(s.push(r++);r<i.length&&0===v.util.cmpFieldExpression(i[r],i[r-1]);)s.push(r),r++;for(var l=[];a<t.length&&v.util.cmpFieldExpression(t[a],i[s[0]])<=0;)0===v.util.cmpFieldExpression(t[a],i[s[0]])&&l.push(a),a++;for(;0<l.length&&0<s.length;){var u=[],d=[],c=0,p=0,h=0;for(p=0;p<s.length;p++)for(;c<l.length;){if(0===v.util.cmpFieldExpression(i[s[p]],t[l[c]])&&i[s[p]].Operator===t[l[c]].Operator){u.push(p),d.push(c),c++;break}c++}for(p=u.length-1;0<=p;p--)v.util.recordFilterEvent(i[s[u[p]]],t[l[d[p]]],o,n),l.splice(d[p],1),s.splice(u[p],1);for(p=s.length-1,h=l.length-1;0<=p&&0<=h;p--,h--)v.util.recordFilterEvent(i[s[p]],t[l[h]],o,n),l.splice(h,1),s.splice(p,1);if(0===l.length&&0<s.length)for(h=0;h<s.length;h++){var m={DataSourceName:v.value(i[s[h]].DataSourceName),FieldName:v.value(i[s[h]].FieldName),Operator:v.value(i[s[h]].Operator),TableId:v.value(i[s[h]].TableId),Values:v.observableArray([])};v.util.recordFilterEvent(i[s[h]],m,o,n)}}}},e.sortFieldExpression=function(e,t){return e.TableId>t.TableId||e.TableId===t.TableId&&e.FieldName>t.FieldName||e.TableId===t.TableId&&e.FieldName===t.FieldName&&e.Operator>t.Operator?1:0},e.cmpFieldExpression=function(e,t){return e.TableId>t.TableId?1:e.TableId<t.TableId?-1:v.value(e.FieldName).localeCompare(v.value(t.FieldName))},e.getFilterFieldDescriptionAria=function(e,t){var o=t?v.value(t.DisplayDataType):void 0;if(o&&e){for(var n=v.value(t.FieldLabel),i=n||v.value(t.FieldName),r=v.controls.FilterDisplay.GetOperatorLabel(v.value(e.Operator),o),a="",s=v.value(e.Values),l=0;l<s.length;l++){var u=v.value(s[l]);a+=u=u||v.label("FilterManager_BlankAria"),l!==s.length-1&&(a+=v.label("FilterManager_FilterValueSeparator"))}if(i&&r&&a)return v.format(v.label("FilterManager_FilterFieldDescriptionAria"),i,r,a)}return""},e.isMultiValueFilterOperator=function(e){return e===v.controls.FilterField.Operators.between||e===v.controls.FilterField.Operators.isOneOf},e.unwrapFilterExpressions=function(e){var t=[];return(e=v.value(e))&&e.forEach(function(e){t.push(v.util.unwrapFilterExpression(e))}),t},e.unwrapFilterExpression=function(e){return e=v.value(e),{Capability:function(e,t){var o=v.value(e),n={};o&&(n={DisplayDataType:v.value(o.DisplayDataType),FieldLabel:v.value(o.FieldLabel),OperatorLabel:v.controls.FilterDisplay.GetOperatorLabel(t,v.value(o.DisplayDataType))});return n}(v.value(e.Capability),v.value(e.Operator)),DataSourceName:v.value(e.DataSourceName),FieldArrayIndex:v.value(e.FieldArrayIndex),FieldName:v.value(e.FieldName),FormDataSourceName:v.value(e.FormDataSourceName),IsEditable:v.value(e.IsEditable),IsQueryFilter:v.value(e.IsQueryFilter),MasterFormDataSourceName:v.value(e.MasterFormDataSourceName),Operator:v.value(e.Operator),RecordingReferences:v.value(e.RecordingReferences),SFKReplacementFieldBinding:v.value(e.SFKReplacementFieldBinding),TableId:v.value(e.TableId),Values:function(e){var t;(e=v.value(e))&&(t=e.map(function(e){return v.value(e)}));return t}(e.Values)}},e.removeDuplicateOrEmptyStringArrayEntries=function(e,t){for(var o={},n=0;n<v.length(e);n++){var i=v.value(v.value(e)[n]),r=!1;null==i||""===i?r=!1!==t:(i=(i||"").toLowerCase())in o?r=!0:o[i]=void 0,r&&(e.splice(n,1),n--)}return e}}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){var e,a,t;function o(e,t,o,n){var i=a.call(this,e,t,o,n)||this;return i.ToggleCapping=function(){r.setValue(i,"ShouldCap",!r.value(i.ShouldCap))},i.OnPasteValue=function(e){2===e.length&&i.FilterField.Values.push(e[1])},i.ClearAllValues=function(){i.Values.splice(0),i.FocusInput()},i.Element=t,i.FilterField=o,i.Values=i.FilterField&&i.FilterField.Values||r.observableObject(r.observable([])),i.ShouldCap=r.observable(!0),i.CombinedValue=r.computed(function(){return""},function(e){var t=(r.value(e)||"").split(",");r.value(i.FilterField.ContainsMoreThanEmptyValue)&&(t=r.value(i.Values).map(function(e){return r.value(e)}).concat(t));var o=[0,r.length(i.Values)];o=o.concat(r.util.removeDuplicateOrEmptyStringArrayEntries(t)),i.Values.splice.apply(i.Values,o),i.InputContext&&i.InputContext.uncommittedValue&&(i.InputContext.uncommittedValue=void 0)}),i.CappedValues=r.computed(function(){var e=r.value(i.Values);return r.value(i.ShouldCap)&&(e=e.slice(0,r.controls.IsOneOfFilterFieldContent.MaxPillsToDisplay)),e}),i.ContainsMoreThanCanBeDisplayed=r.computed(function(){return r.length(i.Values)>r.controls.IsOneOfFilterFieldContent.MaxPillsToDisplay}),i.CappingToggleButtonText=r.computed(function(){return r.value(i.ShouldCap)?r.format(r.label("FilterField_ShowMoreValues"),r.length(i.Values)-r.controls.IsOneOfFilterFieldContent.MaxPillsToDisplay):r.label("FilterField_ShowLessValues")}),i.CappingToggleButtonHelpText=r.computed(function(){return r.value(i.ShouldCap)?r.value(i.Values).slice(r.controls.IsOneOfFilterFieldContent.MaxPillsToDisplay).map(function(e){return r.value(e)}).join(", "):""}),i.CappingToggleButtonSymbol=r.computed(function(){return r.value(i.ShouldCap)?"ChevronDown":"ChevronUp"}),i}Globalize.addCultureInfo("en",{messages:{FilterField_ClearAll:"Clear all",FilterField_ShowLessValues:"Show less",FilterField_ShowMoreValues:"Show {0} more"}}),e=r.controls||(r.controls={}),a=r.ui.Control,__extends(o,a),Object.defineProperty(o.prototype,"InputControl",{get:function(){return this._inputControl||(this._inputControl=this.Element.querySelector("input")),this._inputControl},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"InputContext",{get:function(){return this._inputContext||(this._inputContext=r.context(this.InputControl)),this._inputContext},enumerable:!1,configurable:!0}),o.prototype.FocusInput=function(){this.InputControl&&this.InputControl.focus()},t=o,e.IsOneOfFilterFieldContent=t,(t=e.IsOneOfFilterFieldContent||(e.IsOneOfFilterFieldContent={})).MaxPillsToDisplay=5}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(a){Globalize.addCultureInfo("en",{messages:{FilterField_PillAriaLabel:"Filter value of {0}",FilterField_PillContainerDeleteDescription:"Delete selected filter value",FilterField_PillContainerMoveDownDescription:"Select next displayed filter value",FilterField_PillContainerMoveFirstDescription:"Select first displayed filter value",FilterField_PillContainerMoveLastDescription:"Select last displayed filter value",FilterField_PillContainerMoveUpDescription:"Select previous displayed filter value"}}),function(e){var r,t=(r=a.ui.Control,__extends(o,r),o.prototype.DeletePillButtonClicked=function(e){this.DeleteSelectedPill(e),this.list.focus()},o.prototype.keyDown=function(e){a.util.handleShortcuts(this,e)},o.prototype.DeleteSelectedPill=function(e){this.Parent.Values.splice(e,1);var t=a.length(this.Values);if(0<t){var o=t-1;o<e&&(e=o),e!==a.value(this.SelectedIndex)&&a.setValue(this,"SelectedIndex",e)}else this.Parent.FocusInput()},o.prototype.KeyDown=function(e){this.keyDown(e)},o);function o(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return i.list=t.firstChild,i.Parent=o,i.SelectedIndex=a.observable(0),i.Values=i.Parent.CappedValues&&i.Parent.CappedValues||a.observableObject(a.observable([])),a.observe(i.Values,function(){a.setValue(i,"SelectedIndex",0)}),i}e.FilterFieldPillList=t;var n={Delete:{Keys:{keyCode:[a.ui.KeyCodes.backSpace,a.ui.KeyCodes.deleteKey]},Handler:function(){return this.DeleteSelectedPill(a.value(this.SelectedIndex)),!0},RecordTelemetry:!1,Description:a.label("FilterField_PillContainerDeleteDescription"),Category:a.ui.ShortcutCategory.ElementAction},MoveUp:{Keys:{keyCode:a.ui.KeyCodes.upArrow},Handler:function(){var e=a.value(this.SelectedIndex);return 0<e&&a.setValue(this,"SelectedIndex",e-1),!0},RecordTelemetry:!1,Description:a.label("FilterField_PillContainerMoveUpDescription"),Category:a.ui.ShortcutCategory.ElementAction},MoveDown:{Keys:{keyCode:a.ui.KeyCodes.downArrow},Handler:function(){var e=a.value(this.SelectedIndex);return e<a.length(this.Values)-1&&a.setValue(this,"SelectedIndex",e+1),!0},RecordTelemetry:!1,Description:a.label("FilterField_PillContainerMoveDownDescription"),Category:a.ui.ShortcutCategory.ElementAction},MoveFirst:{Keys:{keyCode:a.ui.KeyCodes.home},Handler:function(){return 0!==a.value(this.SelectedIndex)&&a.setValue(this,"SelectedIndex",0),!0},RecordTelemetry:!1,Description:a.label("FilterField_PillContainerMoveFirstDescription"),Category:a.ui.ShortcutCategory.ElementAction},MoveLast:{Keys:{keyCode:a.ui.KeyCodes.end},Handler:function(){var e=a.length(this.Values)-1;return-1!=e&&a.value(this.SelectedIndex)!==e&&a.setValue(this,"SelectedIndex",e),!0},RecordTelemetry:!1,Description:a.label("FilterField_PillContainerMoveLastDescription"),Category:a.ui.ShortcutCategory.ElementAction}};t.prototype.Shortcuts=a.extendPrototype(t.prototype.Shortcuts,n)}(a.controls||(a.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){Globalize.addCultureInfo("en",{messages:{FilterPane_Close:"Close the filter pane",FilterPane_FilterPaneClosedAria:"FilterPane closed.",FilterPane_FilterPaneOpenedAria:"FilterPane opened.",FilterPane_Filters:"Filters",FilterPane_HideFilters:"Hide filters",FilterPane_RegionTitle:"Filterpane Region",FilterPane_ShowFilters:"Show filters"}}),function(e){var o,t=(o=r.ui.Container,__extends(n,o),Object.defineProperty(n.prototype,"FilterManager",{get:function(){return!this._filterManager&&this.Root&&(this._filterManager=this.Root.FilterManager),this._filterManager},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ShowFiltersButton",{get:function(){if(!this._showFiltersButton&&this.Root&&this.Root.element){var e=$(this.Root.element).find("[data-dyn-controlname='SystemDefinedShowFiltersButton']");e&&e.length&&(this._showFiltersButton=r.context(e[0]))}return this._showFiltersButton},enumerable:!1,configurable:!0}),n.prototype.isOpen=function(){return r.value(this.Visible)},n.prototype.close=function(){var e=this;return!!this.isOpen()&&(r.async(function(){e.toggleVisibility()}),!0)},n.prototype.keyDown=function(e){r.util.handleShortcuts(this,e)},n.prototype.toggleVisibility=function(){var e=this.ShowFiltersButton;e&&e.Clicked&&r.value(e.Visible)&&r.value(e.Enabled)&&e.Clicked()},n.prototype.dispose=function(){this.tabbingHandlerDispose(),o.prototype.dispose.call(this)},n.prototype.init=function(e,t){var n=this;o.prototype.init.call(this,e,t),this.tabbingHandlerDispose=r.util.tabbingContainer(t,r.label("FilterPane_RegionTitle")),this.LayoutWidth=r.ui.autoProperty(r.layout.Size.available,this,"Width"),this.LayoutHeight=r.ui.autoProperty(r.layout.Size.available,this,"Height"),r.setValue(this,"Height",r.layout.Size.available),r.observe(this.Visible,function(e){var t,o=$(n.element);t=e?r.label("FilterPane_FilterPaneOpenedAria"):r.label("FilterPane_FilterPaneClosedAria"),o.attr("aria-busy","true"),o.attr("aria-label",t),o.attr("aria-busy","false")}),this.Root instanceof r.controls.Form&&(this.Root.FilterPaneControl=this)},n);function n(){return null!==o&&o.apply(this,arguments)||this}e.FilterPane=t;var i={Escape:{Keys:{keyCode:r.ui.KeyCodes.esc},Handler:function(){return this.toggleVisibility(),!0},RecordTelemetry:!1,Description:r.label("FilterPane_Close"),Category:r.ui.ShortcutCategory.Close},Enter:{Keys:{keyCode:r.ui.KeyCodes.enter},Handler:function(){return!0},RecordTelemetry:!1,ShowToUser:!1}};t.prototype.Shortcuts=r.extendPrototype(t.prototype.Shortcuts,i),t.prototype.OptimizedEnumFiltering=!1,t.prototype.ShowFilters=null,t.prototype.HideFilters=null,t.prototype.Height=r.layout.Size.available}(r.controls||(r.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(l){var e,o,t;function n(){return null!==o&&o.apply(this,arguments)||this}Globalize.addCultureInfo("en",{messages:{FilterManager_BlankAria:"Empty",FilterManager_ColumnFilterOpened:"Column filter opened.",FilterManager_FilterCountAria:"{0} filters:",FilterManager_FilterFieldDescriptionAria:" {0} {1} {2}.",FilterManager_FilterValueSeparator:"/",FilterManager_SortedAscendingAria:"Sorted ascending.",FilterManager_SortedDescendingAria:"Sorted descending.",FilterManager_UnsortedAria:"Unsorted."}}),e=l.controls||(l.controls={}),o=l.ui.Container,__extends(n,o),n.prototype.init=function(e,t){o.prototype.init.call(this,e,t),this.Root instanceof l.controls.Form&&(this.Root.FilterManager=this)},n.prototype.applyFieldFilters=function(e,t,n,o){var i,r=this,a=[];e.forEach(function(e){if(n){if(l.util.isFieldExpressionValueEmpty(e.Values))i={userDefined1:0,extendedData:e.DataSourceName+";"+e.FieldName};else{var t=l.util.filterOperator2Int(l.value(e.Operator));i={userDefined1:1,userDefined2:t,extendedData:e.DataSourceName+";"+e.FieldName}}r.telemetryEventArgs=l.telemetry.addControlActionEvent(r,r.telemetryEventArgs,n,i)}var o=[];l.value(e.Values).forEach(function(e){o.push(l.value(e))}),a.push({fieldLabel:l.value(l.value(e.Capability).FieldLabel),operatorLabel:l.value(l.value(e.Capability).OperatorLabel),values:l.value(o).join("/")})}),l.value(l.ax.taskRecording.isRecording())?l.callFunction(this.ApplyFilters,this,[e,t,"",a],o):l.callFunction(this.ApplyFilters,this,[e],o)},n.prototype.getFieldFilters=function(e,t,o,n){l.value(l.ax.taskRecording.isRecording())?l.callFunction(this.GetFilters,this,[e,t,o],n):l.callFunction(this.GetFilters,this,[e],n)},n.prototype.getTaskGuideParams=function(i){var e={"Command:ApplyFiltersForTaskRecorder":function(){var e=i.arguments[2],t=$('[data-dyn-form-name="'+e+'"].columnHeader-popup');i.target=t,i.my=l.layout.qTipPosition.rightCenter,i.at=l.layout.qTipPosition.leftCenter},"Command:GetFilters":function(){var e=i.arguments[1],t=l.shell.getActiveForm();if(t&&t.querySelector){var o=t.querySelector('[data-dyn-columnname="'+e+'"]');if(o&&o.querySelector){var n=o.querySelector(".columnHeaderWrapper");i.target=$(n)}}i.my=l.layout.qTipPosition.bottomCenter,i.at=l.layout.qTipPosition.topCenter},"Command:ResetFilterCollectionForTaskRecorder":function(){var e=i.arguments[2],t=$('[data-dyn-controlname="'+e+'_ResetFilters"]');i.target=t,i.my=l.layout.qTipPosition.topCenter,i.at=l.layout.qTipPosition.bottomCenter},"Command:SetSortsForTaskRecorder":function(){var e=i.arguments[4],t="1"===i.arguments[1]?$('[data-dyn-controlname="Ascending_'+e+'"]'):$('[data-dyn-controlname="Descending_'+e+'"]');i.target=t,i.my=l.layout.qTipPosition.rightCenter,i.at=l.layout.qTipPosition.leftCenter}}[i.action];return e?(e(),i):o.prototype.getTaskGuideParams.call(this,i)},n.prototype.resetFieldFilters=function(e,t,o,n){var i=this;o&&e.forEach(function(e){var t={userDefined1:2,extendedData:e.DataSourceName+";"+e.FieldName};i.telemetryEventArgs=l.telemetry.addControlActionEvent(i,i.telemetryEventArgs,o,t)}),l.value(l.ax.taskRecording.isRecording())?l.callFunction(this.ResetFilterCollection,this,[e,t],n):l.callFunction(this.ResetFilterCollection,this,[e],n)},n.prototype.removeFieldSorts=function(e,t){l.callFunction(this.RemoveSorts,this,e,t)},n.prototype.setFieldSorts=function(e,t,o){this.setFieldSortsInternal(e,t,o,!1)},n.prototype.setMultipleFieldSorts=function(e,t,o){this.setFieldSortsInternal(e,t,o,!0)},n.prototype.setFieldSortsInternal=function(e,t,o,n){if(t&&e){var i="",r=e[0];r&&r.forEach(function(e){i=e.DataSourceName+"."+e.FieldName+";"});var a=parseInt(e[2],10);isNaN(a)&&(a=-1);var s={userDefined1:a,extendedData:i};this.telemetryEventArgs=l.telemetry.addControlActionEvent(this,this.telemetryEventArgs,t,s)}n?l.callFunction(this.SetMultipleSorts,this,e,o):l.callFunction(this.SetSorts,this,e,o)},t=n,e.FilterManager=t}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){var e,a,t;function o(e,t,o,n){var i=a.call(this,e,t,o,n)||this;return i.callApplyFilter=function(){var e=i.selectedField(),t=r.value(i.InputValue);if(i.closeFieldPicker(),""!==r.value(i.Value)||""!==t){r.setValue(i,"Value",t),r.setValue(i,"Field",e);var o,n=r.value(i.Value).trim();if(!(n===i.previousValue&&r.value(i.selectedIndex)===i.preSelectedIndex||""===n&&""===i.previousValue))i.previousValue=n,i.preSelectedIndex=r.value(i.selectedIndex),o=""===n?{userDefined1:0,extendedData:e}:{userDefined1:1,extendedData:e},i.telemetryEventArgs=r.telemetry.addControlActionEvent(i,i.telemetryEventArgs,r.telemetry.ActionEvents.quickFilter,o);r.callFunction(i.ApplyFilter,i,void 0,function(){var e=r.value(i.TargetControlName);if(e&&i.Root&&i.Root.element){var t=r.ui.findControl(e,i.Root.element);if(t){var o=r.value(t.DataSource);o&&(0===o.length?r.shell.addAriaAlertMessage(r.label("List_NoResultsMessage")):r.shell.addAriaAlertMessage(r.label("List_ResultsMessage")))}}})}},i.keyDown=function(e){r.util.isShortcutKeyPressed(e,{keyCode:r.util.Lookup.KeysToSendToLookup})?(e.preventDefault(),e.stopPropagation(),r.log.stopPropagation&&r.log.stopPropagation("Prevent form level Enter shortcut.")):r.util.isShortcutKeyPressed(e,{keyCode:r.ui.KeyCodes.tab,isShiftKeyAgnostic:!0})&&i.closeFieldPicker()},i.keyUp=function(e){var t=r.value(i.ShowFieldPicker),o=!1;r.util.isShortcutKeyPressed(e,{keyCode:r.ui.KeyCodes.enter})?i.callApplyFilter():r.util.isShortcutKeyPressed(e,{keyCode:r.ui.KeyCodes.downArrow})?(o=!0,t&&i.nextItem()):r.util.isShortcutKeyPressed(e,{keyCode:r.ui.KeyCodes.upArrow})&&(o=!0,t&&i.previousItem()),o&&!t&&i.openFieldPicker()},i.TextChanged=function(){var e=r.value(i.ShowFieldPicker),t=i.$controlElement.find("input");if(1===t.length){var o=t.val();i.TypedValue(o),""===o?(i.$controlElement.removeClass("noPlaceHolder"),e&&i.closeFieldPicker()):(i.$controlElement.addClass("noPlaceHolder"),e||i.openFieldPicker())}},i.flyoutClickSubscriber=function(e){if("input"!==e.clickTarget.tagName.toLowerCase()||!$.contains(i.element,e.clickTarget))return r.util.flyout.defaultFlyoutClickSubscriber(e)},r.async(function(){var e=i.$controlElement.find("input").first();e&&(e.attr("role","combobox"),e.attr("aria-controls",r.value(i.Id)+"_listbox"),e.attr("aria-activedescendant",null),e.attr("aria-expanded","false"))}),i}Globalize.addCultureInfo("en",{messages:{QuickFilter_ApplyButtonTooltip:"Apply filter",QuickFilter_ClearButtonTooltip:"Clear",QuickFilter_Field:"Field",QuickFilter_PlaceHolderText:"Filter"}}),e=r.controls||(r.controls={}),a=r.ui.Control,__extends(o,a),o.prototype.init=function(e,t){var n=this;a.prototype.init.call(this,e,t),this.$controlElement=$(t),this.LayoutWidth=r.computed(function(){var e=r.value(n.Width);return e!==r.ui.autoValue&&e!==r.layout.Size.content||(e=r.layout.Size.large),e},function(e){r.setValue(n,"Width",e)}),this.InputValue=r.observable(""),this.TypedValue=r.observable(""),""===r.value(this.PlaceholderText)&&r.setValue(this,"PlaceholderText","QuickFilter_PlaceHolderText"),this.FieldPickerOpen=r.observable(!1),this.ShowFieldPicker=r.computed(function(){var e=r.value(n.FieldPickerOpen),t=r.value(n.FieldList),o=!0;return t&&0!==t.length&&(o=!1),e&&!o},function(e){n.FieldPickerOpen(e)}),this.selectedIndex=r.observable(-1),this.preSelectedIndex=-1,this.previousValue="",r.observe(this.Value,function(e){n.InputValue(e),n.TypedValue(e),e?(n.$controlElement.addClass("noPlaceHolder"),n.$controlElement.addClass("quickFilter-isApplied")):(n.$controlElement.removeClass("noPlaceHolder"),n.$controlElement.removeClass("quickFilter-isApplied"))}),r.observe(this.selectedIndex,this.updateAriaAttributes,this)},o.prototype.getFieldsForFlyout=function(){return 0<this.FieldLabels.length?this.FieldLabels:this.FieldList},o.prototype.openFieldPicker=function(){var t=this;this.callRefreshFilter().always(function(){t.ShowFieldPicker(!0),t.resetSelectedIndex(),t.updateAriaAttributes();var e=t.$controlElement.find("input").first();e&&e.attr("aria-expanded","true")})},o.prototype.callRefreshFilter=function(){var e=$.Deferred();return null===r.callFunction(this.Refresh,this,void 0,function(){e.resolve()},null,null,null,function(){e.reject()})&&e.reject(),e.promise()},o.prototype.closeFieldPicker=function(){this.ShowFieldPicker(!1);var e=this.$controlElement.find("input").first();e&&(e.attr("aria-activedescendant",""),e.attr("aria-expanded","false"))},o.prototype.updateAriaAttributes=function(){var e=r.value(this.selectedIndex),t=this.$controlElement.find("input").first();-1<e?t.attr("aria-activedescendant",r.value(this.Id)+"_listbox_item"+e):t.attr("aria-activedescendant",r.value(this.Id)+"_listbox_item0")},o.prototype.selectedField=function(){var e=r.value(this.Field),t=r.value(this.FieldList),o=r.value(this.selectedIndex);return r.value(this.ShowFieldPicker)&&t&&0<t.length&&0<=o&&(e=t[o]),e},o.prototype.resetSelectedIndex=function(){var e=r.value(this.Field),t=r.value(this.FieldList);if(r.value(this.ShowFieldPicker)&&e&&t)for(var o=0;o<t.length;o++)if(t[o]===e)return void this.selectedIndex(o);this.selectedIndex(-1)},o.prototype.getFilterOperator=function(e){var t=r.label("FilterOperators_Contains");if(void 0!==e){var o=r.value(this.FieldType)[e];if(o)switch(o){case r.controls.FilterField.DataTypes.Integer:case r.controls.FilterField.DataTypes.Int64:case r.controls.FilterField.DataTypes.Real:case r.controls.FilterField.DataTypes.Guid:case r.controls.FilterField.DataTypes.Date:case r.controls.FilterField.DataTypes.UtcDateTime:case r.controls.FilterField.DataTypes.Time:t=r.label("FilterOperators_Is");break;case r.controls.FilterField.DataTypes.Enum:var n=r.value(this.FieldName)[e];n&&n===r.util.dataAreaId&&(t=r.label("FilterOperators_Is")),t=r.label("FilterOperators_BeginsWith");break;default:t=r.label("FilterOperators_Contains")}}return t},o.prototype.callClearFilter=function(){this.InputValue(""),this.TypedValue(""),this.$controlElement.removeClass("noPlaceHolder"),this.$controlElement.removeClass("quickFilter-isApplied"),this.callApplyFilter()},o.prototype.nextItem=function(){var e=r.value(this.selectedIndex)+1,t=r.value(this.FieldList);t&&e<t.length&&this.selectedIndex(e)},o.prototype.previousItem=function(){var e=r.value(this.selectedIndex)-1;0<=e&&this.selectedIndex(e)},o.prototype.getActiveDescendant=function(){var e=r.value(this.selectedIndex);return e<=-1&&(e=0),r.value(this.Id)+"_list_item"+e},t=o,(e.QuickFilter=t).prototype.ApplyFilter=null,t.prototype.FieldList=[],t.prototype.FieldType=[],t.prototype.FieldLabels=[],t.prototype.PlaceholderText="",t.prototype.recordability=r.util.recordabilityDefault,r.ui.addObservablePropertiesToPrototype(t.prototype,{Field:"",Value:""})}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(c){!function(e){e.standardizeKeyboardInteractionFeature="CLIStandardizeKeyboardInteractionWithLookups",$(document).ready(function(){var t="data-dyn-key-pressed";$(document).on("keydown",function(e){e.keyCode===c.ui.KeyCodes.ctrl&&document.body.setAttribute(t,"meta")}),$(document).on("keyup",function(e){e.keyCode===c.ui.KeyCodes.ctrl&&document.body.removeAttribute(t)})});var r,t=(r=c.ui.Control,__extends(o,r),o.prototype.isInactiveCell=function(){return void 0===this._isInactiveCell&&this.element&&(this._isInactiveCell=this.element.classList.contains("isInactiveCell")),this._isInactiveCell},o.prototype.init=function(e,t){var o=this;switch(r.prototype.init.call(this,e,t),this.TypeName){case"InputSummary":case"MultilineInputSummary":case"RealSummary":case"IntegerSummary":case"Int64Summary":case"DateSummary":case"DateTimeSummary":case"TimeSummary":case"ComboBoxSummary":this.CanAcquireFocus=!1}this.$cachedElement=$(t),this.IsShowingMandatoryIndicator=c.computed(function(){return c.value(o.StatusIndicator)===c.ui.StatusIndicator.mandatory}),this.IsShowingWarningIndicator=c.computed(function(){return c.value(o.StatusIndicator)===c.ui.StatusIndicator.warning}),this.innerListIndexObserver=null,this.innerListDataChanged=null,this.isInactiveCell()||(c.observe(this.HasMessages,function(){o.UpdateStatusArea()},this,void 0,!0),c.observe(this.Required,function(){o.UpdateStatusArea()},this,void 0,!0),c.observe(this.Visible,function(){o.UpdateStatusArea()},this,void 0,!0),this.UpdateStatusArea())},o.prototype.dispose=function(){this.FlyoutObserver&&(this.FlyoutObserver.dispose(),this.FlyoutObserver=void 0),this.flyoutGridRowObserver&&(this.flyoutGridRowObserver.dispose(),this.flyoutGridRowObserver=void 0),c.util.clearLookupAriaValues(void 0,!1),r.prototype.dispose.call(this)},Object.defineProperty(o.prototype,"StatusArea",{get:function(){if(void 0===this._statusArea&&this.element&&!this.ReferenceGroup){var e=this.$cachedElement.find(".field-status").first();0===e.length&&(e=null),this._statusArea=e}return this._statusArea},enumerable:!1,configurable:!0}),o.prototype.UpdateStatusArea=function(){if(this.StatusArea&&!this.ReferenceGroup)if(this.isInactiveCell())this.StatusIndicator(c.ui.StatusIndicator.none);else{var e=this.allowUserChanges();!1===c.value(this.IsValid)?this.StatusIndicator(c.ui.StatusIndicator.warning):c.value(this.HasMessages)?c.value(this.Required)&&e&&this.isMandatoryMet&&!1===this.isMandatoryMet()?this.StatusIndicator(c.ui.StatusIndicator.mandatory):this.StatusIndicator(c.ui.StatusIndicator.warning):!c.value(this.Required)||!e||!this.isMandatoryMet||!1!==this.isMandatoryMet()||c.value(this.isFocused)&&c.value(this.AllowEdit)?this.StatusIndicator(c.ui.StatusIndicator.none):this.StatusIndicator(c.ui.StatusIndicator.mandatory)}else this.ReferenceGroup&&this.ReferenceGroup.UpdateStatusArea()},o.prototype.addMessage=function(e){this.ReferenceGroup?this.ReferenceGroup.addMessage(e):(this.messages||(this.messages=[]),this.messages.push(e),this.HasMessages(!0))},o.prototype.removeMessageFromControl=function(e){if(this.ReferenceGroup)this.ReferenceGroup.removeMessageFromControl(e);else if(0<c.length(this.messages))for(var t=0;t<this.messages.length;t++)if(e===this.messages[t]){this.messages.splice(t,1),0===c.length(this.messages)&&this.HasMessages(!1);break}},o.prototype.warn=function(e,t){return c.warn({Message:e,Label:t},this)},o.prototype.getTaskGuideParams=function(e){e=r.prototype.getTaskGuideParams.call(this,e);var t=$(this.element),o=e.action;if(o&&-1!==o.indexOf("RequestPopup")){this.ReferenceGroup&&(t=$(this.ReferenceGroup.element).children(".lookupDock"));var n=$(".lookup-popup.active-form");n&&1===n.length&&(t=n),c.ui.isPopupHost(this)&&!this._popupOpenObserver&&(this._popupOpenObserver=c.observe(this.Popup,function(){c.ax&&c.ax.taskGuide&&c.ax.taskGuide.repositionGuidedQtip&&!c.value(c.ax.taskGuide.repositionGuidedQtip)&&c.async(function(){c.ax.taskGuide.repositionGuidedQtip(!0)},0,"reset task guide qtip")}))}return e.target=t,e},o.prototype.pendingPopup=function(e){this._pendingPopup=e},o.prototype.getActiveIsLoadingAnimation=function(){return this._activeIsLoadingAnimation},o.prototype.setActiveIsLoadingAnimation=function(e){this._activeIsLoadingAnimation=e},o.prototype.focusOutCleanup=function(e){void 0===e&&(e=!1),c.shell.isPhone&&c.value(this.LookupButton)&&c.value(this.CanOpenLookupForm)||(this._pendingPopup?(c.log.popups&&c.log.popups("Popups: Focus removed from %s / %s; cancelling pending popup",this.Name?this.Name:"<unknown>",this._element&&this._element.id?this._element.id:"<unknown>"),this._pendingPopup.cancel()):this.ShowFlyout&&(c.log.popups&&c.log.popups("Popups: Focus removed from %s / %s; setting ShowFlyout to false",this.Name?this.Name:"<unknown>",this._element&&this._element.id?this._element.id:"<unknown>"),c.setValue(this,"ShowFlyout",!1)),this._activeIsLoadingAnimation&&this._activeIsLoadingAnimation.cancel(),this.autoPresentLookupTimer&&!this.enterLookupTimer&&(this.autoPresentLookupTimer.cancel(),this.autoPresentLookupTimer=void 0),e&&this.ReferenceGroup&&this.ReferenceGroup.focusOutCleanup())},o.prototype.getLookupInteractionTarget=function(){var e;if(c.ui.isPopupHost(this)){var t=void 0,o=c.context(this.popupHostElement);(t=o&&o.UseReactGrid()?$(this.popupHostElement).find("[data-dyn-role='ReactList']"):$(this.popupHostElement).find("[role='grid']"))[0]&&(e=t[0])}return e},o.prototype.clickedFieldStatus=function(){this.focusInput();var e=c.context(c.shell.getActiveForm());if(e&&e.CanSwitchViewMode()&&e.IsInViewMode()&&this.element.getAttribute("dyn-data-fieldoptions")){var t=$.Event("keydown");t.which=c.ui.KeyCodes.f2,e.executeShortcuts(!0,"ViewEdit",t),c.fieldOptions.fieldOptionsRemove(this.element)}},o.prototype.FindFocusTarget=function(){return this.$cachedElement},o.prototype.handleKeyDownForLookup=function(n){var i=this,e=!1;if(this.SendKeyToLookup&&c.value(this.ShowFlyout)&&n){c.log.popups&&c.log.popups("Popups: Forwarding keystroke to lookup for %s / %s",this.Name?this.Name:"<unknown>",this._element&&this._element.id?this._element.id:"<unknown>");var r=this.getLookupInteractionTarget();if(r){var t=function(){i.enterLookupTimer&&(i.enterLookupTimer=void 0);var e=c.context(r);if(e)if(e.Root&&e.Root.UseReactGrid()){if(e.ControlLibGridRef){var t=e.ControlLibGridRef.getDivRef();if(t){var o=new KeyboardEvent("keydown",{altKey:n.altKey,bubbles:!0,code:n.key,ctrlKey:n.ctrlKey,key:n.key,shiftKey:n.shiftKey});t.dispatchEvent(o)}}}else e.RowKeyDown(n)};if(this.autoPresentLookupTimer&&c.util.isShortcutKeyPressed(n,{keyCode:c.ui.KeyCodes.enter})){var o=c.ui.typeAheadTimer;void 0!==c.debug.typeAheadTimer&&(o=c.debug.typeAheadTimer),this.enterLookupTimer=c.async(t,o,"Sending enter to lookup grid",this)}else c.callFunction(t,this)}e=!0}return e},o.prototype.controlIsValid=function(){return c.value(this.IsValid)&&(!this.ReferenceGroup||c.value(this.ReferenceGroup.IsValid))},o.prototype.setComboBoxInitialAria=function(){var e,t;c.value(this.isComboboxBehavior)&&null!==(e=this.$inputElement)&&void 0!==e&&e[0]&&(this.$inputElement[0].setAttribute("aria-haspopup","grid"),this.$inputElement[0].setAttribute("aria-activedescendant",""),this.$inputElement[0].setAttribute("aria-controls",""),null!==(t=this.$inputElement[0].parentElement)&&void 0!==t&&t.setAttribute("aria-owns",""),this.$inputElement[0].setAttribute("role","combobox"),this.setFlyoutExpandedState(!1,!0))},o.prototype.clearComboBoxInitialAria=function(){"ComboBox"!==this.TypeName&&(c.util.clearLookupAriaValues(this.$inputElement?this.$inputElement[0]:void 0,!1),this.setFlyoutExpandedState(!1,!1))},o.prototype.setFlyoutExpandedState=function(e,t){var o,n,i;null!==(o=this.$inputElement)&&void 0!==o&&o[0]&&(n=!!t||void 0,i=this.$inputElement[0]),t&&n&&i?i.setAttribute("aria-expanded",e.toString()):void 0!==n&&t||!i||i.removeAttribute("aria-expanded")},o.prototype.ComboBoxFlyoutObserverAction=function(e){this.$inputElement&&(e&&"ComboBox"!==this.TypeName?c.util.setupLookupAriaValues(this.$inputElement[0],e):c.util.clearLookupAriaValues(this.$inputElement[0],!0),this.setFlyoutExpandedState(""!==e,!0))},o.prototype.attached=function(){r.prototype.attached.call(this),this.$cachedElement=$(this.element)},o.prototype.getDisplayedValueSource=function(e){return this},o.prototype.getMessageString=function(e){var t,o;if(void 0===e&&(e=6),this.ReferenceGroup)return this.ReferenceGroup.getMessageString(e);this.messages||(this.messages=[]);var n="",i=0;if(this.Root&&this.Root.MessageBar)try{for(var r=__values(this.messages),a=r.next();!a.done;a=r.next()){var s=a.value,l=this.Root.MessageBar.GetMessage(s);if(l&&(0<i&&(n+="\n"),n+=l.text,i++),e<=i)break}}catch(e){t={error:e}}finally{try{a&&!a.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}return n},o.prototype.removeMessages=function(){var t,e;if(this.ReferenceGroup)this.ReferenceGroup.removeMessages();else if(0<c.length(this.messages)){try{for(var o=__values(this.messages),n=o.next();!n.done;n=o.next()){var i=n.value;c.messageManager.remove(i,this.Root.Id)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this.messages=[],this.HasMessages(!1)}},o.prototype.queueFilterFlyout=function(n,i){var r=this;this.autoPresentLookupTimer=c.async(function(){if(r.autoPresentLookupTimer=void 0,c.ui.isPopupHost(r)){var e=c.context(r.popupHostElement);if(e&&c.value(e.IsFormReady)){var t=r.displayedValues(!1);"string"==typeof i?t["@activeFilter"]=i:i&&i.displayedValue&&(t["@activeFilter"]=i.displayedValue()),r.TelemetryOptions={inputType:c.telemetry.InputType.keyboard},c.callFunction(e.Filter,e,[t]);var o=r.ReferenceGroup?r.ReferenceGroup:r;c.util.activateLoadingAnimation(o.element)}else r.queueFilterFlyout(n,i)}else r.queueFilterFlyout(n,i)},n)},o.prototype.isFocusOutTargetFlyout=function(e){var t=$(),o=!1;return e&&e.relatedTarget?t=$(e.relatedTarget):document.activeElement&&(t=$(document.activeElement)),t.length&&(o=!c.util.flyout.isClosableFocusRegion(t[0])),!o&&c.ui.isPopupHost(this)&&this.popupHostElement&&t.length&&(o=$.contains(this.popupHostElement,t[0])||c.flyout.flyoutManager.isContainedByFlyoutHierarchy(this.popupHostElement,t[0])),o},o.prototype.isResizingInLookup=function(e){var t=!1,o=c.ui.isPopupHost(this)?this.Popup():null;if(e&&o&&o.length){var n=c.context(o[0]);if(n){var i=n.popupResizeEventTarget;(t=$.contains(this.element,e.target)&&(null===e.relatedTarget||e.relatedTarget===document.body)&&i&&$.contains(n.element,i))&&(n.popupResizeEventTarget=null)}}return t},o.prototype.openOrFocusLookup=function(){if(!this.openLookupIfNotOpen()&&c.ui.isPopupHost(this)){var e=c.context(this.popupHostElement);e&&c.value(e.IsFormReady)&&(e.TakeFocus=!0,e.takeFocusToggled=!0,e.takeNavigationFocus())}},o.prototype.openLookupIfNotOpen=function(){var e=!1;return c.value(this.ShowFlyout)||(c.setValue(this,"ShowFlyout",!0),e=!0),e},o.prototype.disableAutoPresentLookupForQuickEditGrids=function(){if(void 0===this.DisableAutoPresentLookup&&(this.DisableAutoPresentLookup=!1,this.isInGrid())){var e=this.$inputElement&&this.$inputElement.closest(".listRoot");if(e&&0<e.length){var t=c.context(e[0]);t&&(this.DisableAutoPresentLookup=c.value(t._fastEdit))}}},o.prototype.autoPresentLookup=function(a){var s=this,l=c.ui.typeAheadTimer;if(void 0!==c.debug.typeAheadTimer&&(l=c.debug.typeAheadTimer),!1===c.value(this.ReplaceOnLookup)){if(c.value(this.ShowFlyout)){var u=this.getDisplayedValueSource(a);if(u){var d=u.$inputElement[0];setTimeout(function(){var e=u.displayedValue(),t=c.ui.selectionStart(d),o=c.ui.selectionEnd(d),n=s._enhancedTypeAheadSelectionStart,i=s._enhancedTypeAheadSelectionStart+(e.length-s._enhancedTypeAheadValue.length);if(t<s._enhancedTypeAheadSelectionStart||i<o)c.setValue(s,"ShowFlyout",!1);else if(c.ui.isTextualKeyEvent(a)||a.keyCode===c.ui.KeyCodes.backSpace||a.keyCode===c.ui.KeyCodes.deleteKey){var r=e.slice(n,i);r!==s._previousFilterValue&&s.queueFilterFlyout(l,r)}})}}}else if(this.allowTypeAheadLookup(a)){this.cancelAutoPresentLookupTimer();var t=this.getDisplayedValueSource(a);c.value(this.ShowFlyout)?this.queueFilterFlyout(l,t):this.allowAutoPresentLookup(a)&&(this.autoPresentLookupTimer=c.async(function(){var e;s.autoPresentLookupTimer=void 0,t&&t.displayedValue&&(e=t.displayedValue()),(void 0===e||0<e.length)&&(s.TelemetryOptions={inputType:c.telemetry.InputType.notSpecified},c.setValue(s,"ShowFlyout",!0))},l))}},o.prototype.removeMessagesAsync=function(){var r=this;c.async(function(){var t,e;if(r.ReferenceGroup)r.ReferenceGroup.removeMessagesAsync();else if(0<c.length(r.messages)){try{for(var o=__values(r.messages),n=o.next();!n.done;n=o.next()){var i=n.value;i!==r._keepMessageID&&c.messageManager.remove(i,r.Root.Id)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}r.messages=[],null!==r._keepMessageID?(r.messages.push(r._keepMessageID),r.HasMessages(!0)):r.HasMessages(!1)}},void 0,"Remove messages asynchronously to avoid conflict with UI interactions")},o.prototype.focusInput=function(){this.ReferenceGroup?this.ReferenceGroup.focusFirstChild():this.$inputElement&&this.$inputElement.focus()},o.prototype.cancelAutoPresentLookupTimer=function(){this.autoPresentLookupTimer&&(this.autoPresentLookupTimer.cancel(),this.autoPresentLookupTimer=void 0)},o.prototype.allowTypeAheadLookup=function(e){var t=!1;return!this.ReferenceGroup&&e&&!e.isDefaultPrevented()&&c.value(this.LookupButton)&&this.allowUserChanges()&&c.ui.isTextualKeyEvent(e)&&(t=!0),t},o.prototype.allowAutoPresentLookup=function(e){return!(c.value(c.ax.taskRecording.isRecording)&&!c.value(c.ax.taskRecording.taskGuidePlaybackState))&&!c.shell.isPhone&&!this.DisableAutoPresentLookup&&this.allowTypeAheadLookup(e)},o);function o(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return i.flyoutGridRowObserver=null,i.isComboboxBehavior=c.computed(function(){return!(!c.value(i.AllowEdit)||!c.value(i.Enabled)||c.value(i.IsViewMode))&&(i.ReferenceGroup?c.value(i.ReferenceGroup.LookupButton):c.value(i.LookupButton)&&c.value(i.CanOpenLookupForm))}),c.observe(i.isComboboxBehavior,function(e){e?(i.FlyoutObserver&&i.FlyoutObserver.dispose(),i.FlyoutObserver=c.observe(i.FlyoutId,function(e){i.ComboBoxFlyoutObserverAction(e)},i,void 0,!0),"ComboBox"!==i.TypeName&&i.setComboBoxInitialAria()):"ComboBox"!==i.TypeName&&i.clearComboBoxInitialAria()}),i}(e.Edit=t).prototype.ReferenceGroup=null,t.prototype.IsFilterable=!1,t.prototype.IsFiltered=!1,t.prototype.IsSorted=!1,t.prototype.BackgroundColor="",t.prototype.ForegroundColor="",t.prototype.SupportsDefaultAction=!0,t.prototype.IsDefaultActionGridControl=!1,t.prototype.SendKeyToLookup=!0,t.prototype.HelpText="",t.prototype.ShowLabel=!0,t.prototype.CanOpenLookupForm=!0,t.prototype.Label="",t.prototype.highlyResponsivePopups=!0,t.prototype.LookupButton=!1,t.prototype.ReplaceOnLookup=!0,t.prototype.$inputElement=null,t.prototype._keepMessageID=null,c.ui.addObservablePropertiesToPrototype(t.prototype,{FlyoutId:"",HasMessages:!1,isFocused:!1,IsValid:!0,Required:!1,ShouldFlyoutTakeFocus:!1,ShowFlyout:!1,StatusIndicator:c.ui.StatusIndicator.none}),c.ui.addPropertiesToPrototype(t.prototype,{DataSourceName:{defaultValue:"",observable:!0},DefaultActionEnabled:{attribute:"supportsNavigation",attributeSetter:c.ui.toggleCssClass,defaultValue:!1,invokeHandlers:!1,observable:!0,serialize:!0},DisplayOptions:{converter:c.util.converters.toObject,defaultValue:{},invokeHandlers:!0,observable:!0},FieldName:{defaultValue:"",observable:!0}})}(c.controls||(c.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(h){!function(e){Globalize.addCultureInfo("en",{messages:{Input_CurrentValue:"Current value:",Input_Disabled:"Disabled",Input_ExecuteHyperlink:"Execute hyperlink",Input_FollowLink:"{0}\r\nClick to follow link",Input_InvalidValue:"'{0}' is not a valid value.",Input_LastValue:"Last valid value:",Input_LookupAriaLabel:"Open lookup",Input_LookupGuideHelpText:"After the lookup is open, you can use Alt+Down to move focus into the lookup.",Input_LookupHelpText:"(Alt+Down)",Input_LookupOnlyGuideHelpText:"Typing is disabled. Use the dropdown to select a value.",Input_LookupTooltip:"Open",Input_OpenContextMenu:"Open context menu",Input_OpenDropDown:"Open drop down",Input_OpenEnhancedPreview:"Open enhanced preview",Input_Readonly:"Readonly",Input_SelectValueFromLookup:"When using lookups in a recording intended for a task guide, ALWAYS open and select a value from the lookup (instead of typing in a value directly) for an optimal task guide experience.",Lookup_SelectedItemState:"selected",No_LabelFound:"Missing label"}});var t=(o.prototype.shouldExecute=function(e,t,o){var n=!1;if(!t&&h.util.isShortcutKeyPressed(e,{keyCode:h.ui.KeyCodes.enter})){var i=this.context;if(this.context.ReferenceGroup&&(i=this.context.ReferenceGroup),h.util.isFlightEnabled(h.controls.standardizeKeyboardInteractionFeature)&&h.value(i.LookupButton)&&!i.IsFilterField&&!o)return!1;var r=i;n=!(i.SendKeyToLookup&&h.value(i.ShowFlyout)&&h.context(r.popupHostElement)&&h.value(h.context(r.popupHostElement).IsFormReady))}return n},o.prototype.performCleanup=function(){this.context.focusOutCleanup&&this.context.focusOutCleanup()},o.prototype.getValue=function(){return this.context.formattedValue()},o.prototype.setValue=function(e,t){this.context.formattedValue(e,t)},o.prototype.notifyCommitted=function(){},o.prototype.preventForceChange=function(){return this.context&&h.value(this.context.LookupButton)&&h.value(this.context.isFocused)},o);function o(e){this.context=e}e.InputValueBinder=t;var r,n=(r=e.Edit,__extends(i,r),i.prototype.init=function(e,t){var i=this;r.prototype.init.call(this,e,t),this.$inputElement=this.$cachedElement.find("input"),this._roleLinkShown=!1,this.conditionalLimitTextLength=h.computed(function(){return h.value(i.LookupButton)?0:h.value(i.LimitText)}),this.formattedValue=h.computed(function(){return h.peek(i.LookupButton)&&h.peek(i.isFocused)&&void 0!==i.uncommittedValue?i.uncommittedValue:i.getFormattedValue()},function(e,t){i.updatingBlock(function(){!t&&h.peek(i.LookupButton)&&h.peek(i.isFocused)?i.uncommittedValue=e:(i.setFormattedValue(e,t),i.uncommittedValue=void 0),h.peek(i.Required)&&i.UpdateStatusArea()})}),this.Text=this.formattedValue,this.showLink=h.computed(function(){var e=h.value(i.IsHyperlink)&&h.value(i.Enabled)&&h.value(i.IsValid)&&!h.value(i.isValueEmpty)&&!h.value(i.LookupOnly);return e&&h.value(i.AllowEdit)&&i.Root&&i.Root.isActiveControl(i.Name)&&h.value(i.isFocused)&&(e=!1),i.ReferenceGroup&&(e=e&&h.value(i.ReferenceGroup.IsValid)),e}),this.readOnly=h.computed(function(){return!h.value(i.AllowEdit)}),this.isValueEmpty=h.computed(function(){return null==h.value(i.formattedValue)||""===h.value(i.formattedValue)}),this.toolTip=h.computed(function(){var e="";if(h.value(i.showToolTip)&&!h.value(i.PasswordMode)){var t=h.value(i.formattedValue);if(i.controlIsValid())h.value(i.HasMessages)||i.ReferenceGroup&&h.value(i.ReferenceGroup.HasMessages)?e=i.getMessageString():t&&(e=i.showLink()||i.DefaultActionEnabled?h.format(h.label("Input_FollowLink"),t):t);else{var o=i.lastValidFormattedValue(),n=h.format("{0} {1}\n{2} {3}",h.label("Input_LastValue"),o,h.label("Input_CurrentValue"),t);e=i.messages&&i.messages.length&&!h.value(i.IsValid)||i.ReferenceGroup&&i.ReferenceGroup.messages&&i.ReferenceGroup.messages.length&&!h.value(i.ReferenceGroup.IsValid)?i.getMessageString()+"\n\n"+n:n}}return e}),this.allowTyping=h.computed(function(){return h.value(i.AllowEdit)&&!h.value(i.LookupOnly)}),h.observe(h.options(function(){return{isEmptyPassword:i.IsEmptyPassword,passwordMode:i.PasswordMode}},this.Updating),function(){i.updatingBlock(function(){i.updateParsedValue(h.value(i.Value))})}),h.observe(this.IsViewMode,function(e){i.$inputElement&&i.$inputElement[0]&&(e&&h.value(i.showLink)?(void 0===i.$addedLinkElement&&(i.$addedLinkElement=$("<div class='viewModeTextControl-link field viewMarker' role='link' data-dyn-bind=\"attr: { name: $data.Name,'aria-describedby': $data.Id + '_helptext' },id: $data.Id + '_input', click: $data.onInputClick, secondaryNavigation: { keyboard: $data.OnKeyboardSecondaryNavigation, mouse: $data.OnMouseSecondaryNavigation },text: $data.Text, link: $dyn.ui.link($data), skip: $dyn.ui.skip($data), title: $data.toolTip,maxlength: $data.conditionalLimitTextLength, textAlign: $data.Alignment, keyDown: $data.keyDown, keyUp: $data.keyUp, click: $data.onInputClick,preview: $dyn.ui.preview($data), foregroundColor: $data.ForegroundColor, backgroundColor: $data.BackgroundColor, superTooltip: $dyn.ui.superTooltip($data)\">"),"MultilineInput"===i.TypeName?i.$addedLinkElement.addClass("multilineInput-textArea"):i.$addedLinkElement.addClass("textbox")),i.swapLinkElement(i.$addedLinkElement,i.$inputElement),i._roleLinkShown=!0):(h.value(i.showLink)||i._roleLinkShown)&&(i.swapLinkElement(i.$inputElement,i.$addedLinkElement),i._roleLinkShown=!1))}),h.observe(this.LayoutWidth,function(e){if(i.$inputElement&&i.$inputElement.length){var t=i.$inputElement[0].getAttribute("size");e===h.layout.Size.available?i.$inputElement[0].setAttribute("size","1"):t&&""!==t&&i.$inputElement[0].setAttribute("size","")}}),h.observe(this.Value,function(e){i.compareToParsedValue(e)||i.updatingBlock(function(){i.removeMessages(),i.updateParsedValue(e),void 0!==i.uncommittedValue&&(i.uncommittedValue=i.getFormattedValue()),i.formattedValue.valueChanged.raise(),(h.value(i.Required)||i.ReferenceGroup&&h.value(i.ReferenceGroup.Required))&&i.UpdateStatusArea()})}),this.isInactiveCell()||(h.observe(this.IsValid,function(e){i.updatingBlock(function(){i.Root&&i.Root.UpdateInvalidControlList&&i.Root.UpdateInvalidControlList(i),e&&(i.removeMessages(),i.compareToParsedValue(h.value(i.Value))||i.updateParsedValue(h.value(i.Value)),i.formattedValue.valueChanged.raise()),i.UpdateStatusArea()})}),h.observe(this.AllowEdit,function(e){if(h.value(i.IsValid)&&!e){var t=h.value(i.isFocused);i.updatingBlock(function(){h.value(i.ShowFlyout)&&(h.log.popups&&h.log.popups("Popups: AllowEdit set to false on %s / %s; setting ShowFlyout to false",i.Name?i.Name:"<unknown>",i._element&&i._element.id?i._element.id:"<unknown>"),h.setValue(i,"ShowFlyout",!1));var e=!1;i.compareToParsedValue(h.value(i.Value))||(i.updateParsedValue(h.value(i.Value)),e=!0),t&&(i.valueBinder.notifyCommitted(),e=!0),e&&i.formattedValue.valueChanged.raise()})}(h.value(i.Required)||i.ReferenceGroup&&h.value(i.ReferenceGroup.Required))&&i.UpdateStatusArea()}),h.observe(this.Enabled,function(e){if(h.value(i.IsValid)&&!e){var n=h.value(i.isFocused);i.updatingBlock(function(){h.value(i.ShowFlyout)&&(h.log.popups&&h.log.popups("Popups: Enabled set to false on %s / %s; setting ShowFlyout to false",i.Name?i.Name:"<unknown>",i._element&&i._element.id?i._element.id:"<unknown>"),h.setValue(i,"ShowFlyout",!1));var e=!1;if(i.compareToParsedValue(h.value(i.Value))||(i.updateParsedValue(h.value(i.Value)),e=!0),n&&(i.valueBinder.notifyCommitted(),e=!0,i.Root&&i.Root.element)){var t=$(i.Root.element).find(":tabbable"),o=t.index(i.$inputElement[0]);-1<o&&(o%=t.length,t.eq(o+1).focus(),t.eq(o+1).select())}e&&i.formattedValue.valueChanged.raise()})}(h.value(i.Required)||i.ReferenceGroup&&h.value(i.ReferenceGroup.Required))&&i.UpdateStatusArea()})),this.CustomPopup?this.showPopup=this.CustomPopup:h.ui.popupHost.apply(this);var o=h.value(this.ClientState);if(o&&"string"==typeof o&&this.applyClientState){var n=JSON.parse(o);h.async(function(){i.applyClientState(n)},void 0,"Apply client state")}this.EnhancedTypeAhead=h.computed(function(){return!1===h.value(i.ReplaceOnLookup)&&!0===h.value(i.ShowFlyout)}),h.observe(this.ReplaceOnLookup,function(e){e?$(i.element).find(".lookupButton").removeClass("replaceOnLookupNo"):$(i.element).find(".lookupButton").addClass("replaceOnLookupNo")}),h.observe(this.EnhancedTypeAhead,function(e){if(e){var t=i.getDisplayedValueSource();t&&(i._enhancedTypeAheadValue=t.displayedValue(),t.$inputElement&&t.$inputElement[0]&&(i._enhancedTypeAheadSelectionStart=h.ui.selectionStart(t.$inputElement[0]),i._enhancedTypeAheadSelectionEnd=h.ui.selectionEnd(t.$inputElement[0]))),i.queueFilterFlyout(0,"")}else delete i._previousFilterValue})},Object.defineProperty(i.prototype,"valueBinder",{get:function(){return this._valueBinder||(this._valueBinder=new t(this)),this._valueBinder},enumerable:!1,configurable:!0}),i.prototype.getLabelledByData=function(){return this.ReferenceGroup?{byElementId:this.ReferenceGroup.Id+"_label",isInGrid:this.ReferenceGroup.isInGrid(),label:h.value(this.ReferenceGroup.Label),showLabel:h.value(this.ReferenceGroup.ShowLabel)}:{byElementId:this.Id+"_label",isInGrid:this.isInGrid(),label:h.value(this.Label),showLabel:h.value(this.ShowLabel)}},i.prototype.isDisplayedValueDirty=function(){var e=this._formatAsDisplayValue(h.value(this.Value));return this.displayedValue()!==e},i.prototype.syncValues=function(){var e=this;this.updatingBlock(function(){e.updateParsedValue(h.value(e.Value)),e.uncommittedValue=void 0,e.formattedValue.valueChanged.raise()})},i.prototype.updateFormattedValue=function(e){var t=this;this.updatingBlock(function(){t.updateLastUserValue(e),t.uncommittedValue=void 0,t.updateParsedValue(e),t.formattedValue.valueChanged.raise()}),this.valueBinder.notifyCommitted()},i.prototype.isMandatoryMet=function(){var e=!0;return null!=h.value(this.formattedValue)&&""!==h.value(this.formattedValue)||(e=!1),e},i.prototype.FindFocusTarget=function(){return this.$inputElement},i.prototype.onInputClick=function(){if(this.allowUserChanges()&&h.value(this.LookupOnly)){var e=this.$cachedElement.find(".lookupButton");1===e.length&&e.click()}},i.prototype.keyDown=function(e){h.util.handleShortcuts(this,e),this.disableAutoPresentLookupForQuickEditGrids(),this.autoPresentLookup(e)},i.prototype.keyUp=function(e){var t;t=this.ReferenceGroup&&this.ReferenceGroup.getLookupInteractionTarget?this.ReferenceGroup.getLookupInteractionTarget():this.getLookupInteractionTarget();var o=h.context(t);o&&o.Root&&o.Root.UseReactGrid()&&o.keyUp(e)},i.prototype.updateValue=function(e,t,o){void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===o&&(o=!1);var n=!1;if(this.allowUserChanges()&&(n=this.isDisplayedValueDirty(),!o)){var i=this.displayedValue();this.ReferenceGroup&&this.ReferenceGroup.isFocused()?(this.formattedValue(i,t),e&&this.ReferenceGroup.resolveChanges()):h.value(this.LookupButton)&&this.isFocused()?(this.setFormattedValue(i,t),this.uncommittedValue=void 0):this.formattedValue(i,t),this.valueBinder.notifyCommitted()}return n},i.prototype.cellRenderer=function(e){return{value:this.Value&&this.Value.virtualizer?this.Value.virtualizer(e):h.value(this.Value)}},i.prototype.setValue=function(e,t,o){var n=this;void 0===t&&(t=!1),void 0===o&&(o=!1);var i=$.Deferred(),r=this.allowUserChanges();if(!o&&!r||!t&&h.value(this.IsValid)&&e===h.value(this.Value)){var a=!r;i.resolve(a)}else if(this.SetValue){var s=function(e){e&&(n.compareToParsedValue(h.value(n.Value))||n.syncValues()),i.resolve()},l=function(){s(!0)};if(h.value(this.LookupButton)&&"Date"!==this.TypeName&&h.value(h.ax.taskRecording.isRecording)&&!h.value(h.ax.taskRecording.taskGuidePlaybackState)&&h.info({Message:h.label("Input_SelectValueFromLookup"),Label:"Input_SelectValueFromLookup"}),h.serverForm&&h.peek(h.serverForm.processingInteractions))var u=h.serverForm.processingInteractions.valueChanged.subscribe(function(){h.callFunction(n.SetValue,n,[e],s,null,null,null,l),h.serverForm.processingInteractions.valueChanged.unsubscribe(u)});else h.callFunction(this.SetValue,this,[e],s,null,null,null,l)}else h.setValue(this,"Value",e,t),this.IsValid(!0),i.resolve();return i},i.prototype.GetState=function(){var e=this.getFormattedValue();return{formattedValue:null!=e?e:""}},i.prototype.ApplyState=function(e){var t=this;if(e.messages&&0<e.messages.length&&(this.messages=e.messages),void 0!==e.formattedValue&&e.formattedValue!==this.getFormattedValue()){var o=this.setFormattedValue(e.formattedValue,!0,!0);this.UpdateStatusArea();var n=$.Deferred();return o.done(function(e){h.value(t.IsValid)?n.resolve(e):n.reject()}),n}},i.prototype.onSerializeTransitState=function(){var e=JSON.stringify({formattedValue:this.getFormattedValue()});h.setValue(this,"ClientState",e)},i.prototype.GetInitialState=function(){return{formattedValue:""}},i.prototype.OnKeyboardSecondaryNavigation=function(){this.TelemetryOptions={inputType:h.telemetry.InputType.keyboard}},i.prototype.OnMouseSecondaryNavigation=function(){this.TelemetryOptions={inputType:h.telemetry.InputType.mouse}},i.prototype.dispose=function(){this.$addedLinkElement&&this.$addedLinkElement[0]&&h.unbind(this.$addedLinkElement[0]),this.$inputElement&&this.$inputElement[0]&&h.unbind(this.$inputElement[0]),r.prototype.dispose.call(this)},i.prototype.attached=function(){r.prototype.attached.call(this),this._roleLinkShown?this.$addedLinkElement=this.$cachedElement.find(".viewModeTextControl-link"):this.$inputElement=this.$cachedElement.find("input"),this._&&(this._.input=$("input",this.element)[0],this._.link=$(".viewModeTextControl-link",this.element)[0])},Object.defineProperty(i.prototype,"currentValue",{get:function(){var e,t;return this._roleLinkShown?null===(e=this._.link)||void 0===e?void 0:e.textContent:null===(t=this._.input)||void 0===t?void 0:t.value},set:function(e){this._roleLinkShown?this._.link&&(this._.link.textContent=e):this._.input&&(this._.input.value=e)},enumerable:!1,configurable:!0}),i.prototype.shouldControlLogMessage=function(e){var t=!1,o=!1;this._lastUserValue===e&&(t=!0);var n=!1;return t&&!1===this._lastValidationResult&&this.messages&&0===this.messages.length&&(n=!0),t&&!n||(o=!0),o},i.prototype.displayedValues=function(e){var t={};return e&&!this.isDisplayedValueDirty()||(t[this.Name]=this.displayedValue()),t},i.prototype.focusInCallBack=function(e){h.value(this.Enabled)?(this.isFocused(!0),h.log.focus&&h.log.focus("Focus: input->focusInCallBack input name: %s",this.Name),h.value(this.AllowEdit)&&this.StatusIndicator(h.ui.StatusIndicator.none)):e&&(e.stopPropagation(),h.log.stopPropagation&&h.log.stopPropagation("focusIn on disabled input, control name: %s",this.Name))},i.prototype.focusOutCallBack=function(t){var o=this;this.updatingBlock(function(){if(!o.isFocusOutTargetFlyout(t)&&!o.isResizingInLookup(t)){if(o.isFocused(!1),h.log.focus&&h.log.focus("Focus: input->focusOutCallBack input name: %s",o.Name),void 0!==o.uncommittedValue){var e=o.ChangeMode===h.ui.ChangeMode.dirty;h.setValue(o,"formattedValue",o.uncommittedValue,e)}o.ReferenceGroup||o.UpdateStatusArea(),h.async(function(){o.focusOutCleanup()})}})},i.prototype.onEnterAction=function(e){var t=!this.allowUserChanges()&&h.util.isFlightEnabled(h.controls.standardizeKeyboardInteractionFeature)&&h.value(this.IsHyperlink)&&h.value(this.IsValid)&&!h.value(this.isValueEmpty)&&!this.isInGrid()&&!this.IsFilterField,o=!1;return h.value(this.LookupButton)&&this.allowUserChanges()?o=!h.util.isFlightEnabled(h.controls.standardizeKeyboardInteractionFeature)||h.value(this.ShowFlyout)||this.IsFilterField||this.isDisplayedValueDirty()?this.handleKeyDownForLookup(e):this.openLookup(e):t&&(h.applyFunction(this.ExecuteHyperlink,this),o=!0),o},i.prototype.openLookup=function(e){return!(!h.value(this.LookupButton)||!this.allowUserChanges()||(this.TelemetryOptions={inputType:h.telemetry.InputType.keyboard},h.log.popups&&h.log.popups("Popups: Enter or Alt+Down shortcut used to open/focus lookup for %s / %s; setting ShowFlyout to true; ShowFlyout currently equals %s",this.Name?this.Name:"<unknown>",this._element&&this._element.id?this._element.id:"<unknown>",h.peek(this.ShowFlyout)),e&&e.which===h.ui.KeyCodes.enter?this.openLookupIfNotOpen():this.openOrFocusLookup(),0))},i.prototype.applyClientState=function(e){void 0!==e.formattedValue&&e.formattedValue!==this.getFormattedValue()&&this.formattedValue(e.formattedValue)},i.prototype.callTextChanged=function(){(h.value(this.TextChanged)||this.textChangedInternal)&&h.value(this.AllowEdit)&&(h.callFunction(this.TextChanged,this,[this.displayedValue()]),h.applyFunction(this.textChangedInternal,this))},i.prototype.swapLinkElement=function(e,t){var o,n,i;this.isInactiveCell()?null!==(o=this.$cachedElement)&&void 0!==o&&o.prepend(e):null!==(n=this.StatusArea)&&void 0!==n&&n.after(e),t&&t.detach();var r=null===(i=this._role)||void 0===i?void 0:i.context;r.current||(r.current=this);var a=h.role(e[0]);r&&!a._getIsDataBound()&&h.dataBind(e[0],r)},i);function i(){var e=null!==r&&r.apply(this,arguments)||this;return e.onInput=function(){e.callTextChanged()},e}(e.BaseInput=n).prototype.PlaceHolder="",n.prototype.IsHyperlink=!1,n.prototype.LimitText=null,n.prototype.Alignment="Left",n.prototype.PasswordMode=!1,n.prototype.IsEmptyPassword=!0,n.prototype.showToolTip=!0,n.prototype.LookupOnly=!1,n.prototype.ClientState="",n.prototype.ChangeMode=h.ui.ChangeMode.dirty,n.prototype.ExecuteHyperlink=null,n.prototype.SetValue=null,n.prototype.CustomPopup=null,n.prototype.RequestPopup=null,n.prototype.bindUpdate=!0,n.prototype.recordability=h.util.recordabilityDefault,h.ui.addObservablePropertiesToPrototype(n.prototype,{ShowFlyout:!1,Value:""});var a={Escape:{Keys:{keyCode:h.ui.KeyCodes.esc},Handler:function(e){return e&&e.preventDefault(),!1},RecordTelemetry:!1,ShowToUser:!1},OpenLookupForEnter:{Keys:{keyCode:h.ui.KeyCodes.enter},Handler:function(e){return this.onEnterAction(e)},RecordTelemetry:!1,ShowToUser:function(){return h.value(this.LookupButton)&&this.allowUserChanges()},Description:h.label("Input_OpenDropDown")},KeyForLookup:{Keys:{keyCode:h.util.Lookup.KeysToSendToLookup},Handler:h.controls.Edit.prototype.handleKeyDownForLookup,RecordTelemetry:!1,ShowToUser:!1},HomeEnd:{Keys:{keyCode:[h.ui.KeyCodes.home,h.ui.KeyCodes.end]},Handler:function(e){return h.value(this.AllowEdit)&&this.isInGrid()&&e&&e.stopPropagation(),!1},RecordTelemetry:!1,ShowToUser:!1},SelectText:{Keys:{ctrl:!0,keyCode:h.ui.KeyCodes.letterA},Handler:function(e){return!(!e||!e.target)&&($(e.target).select(),!0)},RecordTelemetry:!1,ShowToUser:!1},Backspace:{Keys:{keyCode:h.ui.KeyCodes.backSpace},Handler:function(){return!h.value(this.AllowEdit)},RecordTelemetry:!1,ShowToUser:!1},CtrlEnter:{Keys:{ctrl:!0,keyCode:h.ui.KeyCodes.enter},Handler:function(){return!1},RecordTelemetry:!1,ShowToUser:function(){return h.value(this.showLink)},Description:h.label("Input_ExecuteHyperlink")},OpenLookup:{Keys:{alt:!0,keyCode:h.ui.KeyCodes.downArrow},Handler:function(e){return this.openLookup(e)},RecordTelemetry:!1,ShowToUser:function(){return h.value(this.LookupButton)&&this.allowUserChanges()},Description:h.label("Input_OpenDropDown")},ContextMenu:{Keys:{ctrl:!0,keyCode:h.ui.KeyCodes.f10},Handler:function(e){return e&&(e.preventDefault(),e.target=this.element,h.contextMenu.openContextMenuHandler(e,!0)),!1},RecordTelemetry:!1,Description:h.label("Input_OpenContextMenu")},EnhancedPreview:{Keys:{alt:!0,keyCode:h.ui.KeyCodes.upArrow},Handler:function(e){return h.shell.previewManager.enhancedPreviewShortcutHandler(this,e)},RecordTelemetry:!1,ShowToUser:function(){return!(!h.value(this.CanHavePreview)||!this.RequestEnhancedPreview)},Description:h.label("Input_OpenEnhancedPreview")}};n.prototype.Shortcuts=h.extendPrototype(n.prototype.Shortcuts,a);var s,l=(__extends(u,s=n),u.prototype.getFormattedValue=function(){return h.peek(this.IsValid)||void 0===this._lastUserValue?this._parsedValue:this._lastUserValue},u.prototype.setFormattedValue=function(e,t,o){var n;return void 0===t&&(t=!1),void 0===o&&(o=!1),this._lastUserValue=e,!t&&e===this._parsedValue||(this.removeMessages(),this.ValueChanged&&h.callFunction(this.ValueChanged,this,e),this._parsedValue=e,this.ReferenceGroup&&h.peek(this.ReferenceGroup.isFocused)?this.ReferenceGroup.isChildDataDirty=!0:(t=t||h.value(this.PasswordMode)&&!h.value(this.IsEmptyPassword)&&!e,n=this.setValue(e,t,o))),n||(n=$.Deferred()).resolve(),n},u.prototype.displayedValue=function(){return this.$inputElement&&this.$inputElement[0]?this.$inputElement[0].value:h.value(this.Value)},u.prototype.compareToParsedValue=function(e){return this._parsedValue===e},u.prototype.updateParsedValue=function(e){h.value(this.PasswordMode)?h.value(this.IsEmptyPassword)||this.isInactiveCell()?this._parsedValue="":this._parsedValue=h.ui.PasswordString:this._parsedValue=e},u.prototype.parsedValueToString=function(){return this._parsedValue?this._parsedValue:""},u.prototype._formatAsDisplayValue=function(e){return e=e&&e.replace(/(\r\n|\n|\r)/gm,"")},u.prototype.updateLastUserValue=function(e){this._lastUserValue=e},u.prototype.lastValidFormattedValue=function(){return h.value(this.Value)},u);function u(){return null!==s&&s.apply(this,arguments)||this}e.Input=l,h.adapter({id:"Guid",controlType:"Input",template:"Input"}),h.adapter({id:"InputSummary",controlType:"Input",template:"SummaryField"}),h.adapter({id:"InputLabel",controlType:"Input",template:"Label"}),h.adapter({id:"InputCardCell",controlType:"Input",template:"CardCell"}),h.adapter({id:"InputSimpleReadOnly",controlType:"Input",template:"SimpleReadOnly"});var d,c=(__extends(p,d=l),p.prototype.updateValue=function(){return this._onChange()},p.prototype.addMessage=function(e){this.messages||(this.messages=[]),this.messages.push(e)},p.prototype._onChange=function(){var e=!1;return this._committedValue!==this.currentValue&&(e=!0,this._committedValue=this.currentValue,this.RaiseEvent(h.ui.ChangeEvent,{bubbles:!0})),e},p.prototype._setValue=function(){this._committedValue=void 0},p.prototype.GetState=function(){return{formattedValue:this.currentValue,messages:this.messages}},p.prototype.ApplyState=function(e){var t=$.Deferred(),o=e&&e.formattedValue;return void 0!==o&&(this.currentValue=o),t.resolve(),t},p.prototype.attached=function(){this._={},d.prototype.attached.call(this),this._committedValue=this.currentValue,this.Value=h.observable(this._committedValue)},p);function p(e,t,o,n){var i=d.call(this,e,t,o,n)||this;return i.AllowEdit=h.observable(!0),i}e.InputCell=c,h.ui.addPropertiesToPrototype(c.prototype,{validating:{defaultValue:!1,attribute:"data-dyn-validating"}}),h.cellAdapter({id:"Input"}),h.cellAdapter({id:"Input",controlType:"InputCell",type:h.cellTypes.editor})}(h.controls||(h.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(l){!function(e){e.multilineLookupFeatureName="CLIMultiLineLookupFeature";var i,t=(i=l.controls.Input,__extends(o,i),o.prototype.init=function(e,t){var o=this;i.prototype.init.call(this,e,t),this.$inputElement=this.$cachedElement.find("textarea"),this.DisableAutoPresentLookup=!0,0===l.value(this.DisplayHeight)&&(!0===this.isInGrid()?l.setValue(this,"DisplayHeight",2):l.setValue(this,"DisplayHeight",5)),this.ShowLookupButton=l.computed(function(){return l.value(o.LookupButton)&&l.util.isFlightEnabled(l.controls.multilineLookupFeatureName)})},o.prototype.dispose=function(){var t,e;if(this.ShowLookupButton&&this.ShowLookupButton.valueChanged&&this.ShowLookupButton.valueChanged.clearAllDependencies(),this.flyoutDisposables){try{for(var o=__values(this.flyoutDisposables),n=o.next();!n.done;n=o.next())n.value.dispose()}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this.flyoutDisposables=null}i.prototype.dispose.call(this)},o.prototype.attached=function(){i.prototype.attached.call(this),this.$inputElement=this.$cachedElement.find("textarea"),this._&&(this._.input=$("textarea",this.element)[0])},o.prototype._formatAsDisplayValue=function(e){return e},o);function o(){return null!==i&&i.apply(this,arguments)||this}(e.MultilineInput=t).prototype.DisplayHeight=0;var n={Enter:{Keys:{keyCode:l.ui.KeyCodes.enter},Handler:function(e){return e&&(e.stopPropagation(),l.log.stopPropagation&&l.log.stopPropagation("Prevent form level Enter shortcut.")),!1},RecordTelemetry:!1,ShowToUser:!1}};t.prototype.Shortcuts=l.extendPrototype(e.Input.prototype.Shortcuts,n),l.adapter({id:"MultilineInputSummary",controlType:"Input",template:"SummaryField"}),l.adapter({id:"MultilineInputLabel",controlType:"Input",template:"Label"}),l.adapter({id:"MultilineInputCardCell",controlType:"Input",template:"CardCell"});var r,a=(__extends(s,r=t),s.prototype.updateValue=function(){return this._onChange()},s.prototype.addMessage=function(e){this.messages||(this.messages=[]),this.messages.push(e)},s.prototype._onChange=function(){var e=!1;return this._committedValue!==this.currentValue&&(e=!0,this._committedValue=this.currentValue,this.RaiseEvent(l.ui.ChangeEvent,{bubbles:!0})),e},s.prototype._setValue=function(){this._committedValue=void 0},s.prototype.GetState=function(){return{formattedValue:this.currentValue,messages:this.messages}},s.prototype.ApplyState=function(e){var t=$.Deferred(),o=e&&e.formattedValue;return void 0!==o&&(this.currentValue=o),t.resolve(),t},s.prototype.attached=function(){this._={},r.prototype.attached.call(this),this._committedValue=this.currentValue,this.Value=l.observable(this._committedValue)},s);function s(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return i.AllowEdit=l.observable(!0),i}e.MultilineInputCell=a,l.ui.addPropertiesToPrototype(a.prototype,{validating:{defaultValue:!1,attribute:"data-dyn-validating"}}),l.cellAdapter({id:"MultilineInput"}),l.cellAdapter({id:"MultilineInput",controlType:"MultilineInputCell",type:l.cellTypes.editor})}(l.controls||(l.controls={}))}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(_){!function(e){$.datepicker._gotoToday=function(e){var t=$(e),o=this._getInst(t[0]);if(this._get(o,"gotoCurrent")&&o.currentDay)o.selectedDay=o.currentDay,o.drawMonth=o.selectedMonth=o.currentMonth,o.drawYear=o.selectedYear=o.currentYear;else{var n=o.settings.localToday||new Date;o.selectedDay=n.getDate(),o.drawMonth=o.selectedMonth=n.getMonth(),o.drawYear=o.selectedYear=n.getFullYear()}this._notifyChange(o),this._adjustDate(t)};moment.parseTwoDigitYear=function(e){var t=parseInt(e,10);return t+(68<t?1900:2e3)},moment.tz.add("User|UST|0|0|");var t,o=Globalize.culture();function w(e){var t=0;if("number"==typeof e.calendar.firstDay)t=e.calendar.firstDay;else{var o=parseInt(e.calendar.firstDay,10);isNaN(o)||(t=o)}return t}moment.updateLocale(moment.locale(),{months:o.calendar.months.names,monthsShort:o.calendar.months.namesAbbr,weekdays:o.calendar.days.names,weekdaysMin:o.calendar.days.namesShort,weekdaysShort:o.calendar.days.namesAbbr}),e.getFirstDayNumber=w,(t=e.time||(e.time={})).minDate=new Date(Date.UTC(1900,0,1,0,0,0,0)),t.maxDate=new Date(Date.UTC(2154,11,31,23,59,59,0)),e.dateValue=function(e){return Globalize.format(e,"yyyy-MM-dd")},e.dateTimeValue=function(e){return Globalize.format(e,"yyyy-MM-ddTHH:mm:ss")},e.timeValue=function(e){return 3600*e.getHours()+60*e.getMinutes()+e.getSeconds()},e.combineDateAndTime=function(e,t){return moment.isMoment(e)&&e.isValid()&&moment.isMoment(t)&&t.isValid()&&(e.hours(t.hours()),e.minutes(t.minutes()),e.seconds(t.seconds())),e},e.getDateFormat=function(h){function l(e,t){if(void 0===t&&(t=!1),e.weekAs||e.quarterAs){if(t)return"";var o=e.weekAs||e.quarterAs;return e.yearAs&&(o+=" ".concat(e.yearAs)),o}for(var n=e.dayAs,i=e.monthAs,r=e.yearAs,a=e.dateFormat,s=new Array(5),l=new Array(5),u=0;u<3;u++){var d=2*u;switch(a.substr(u,1).toLowerCase()){case"d":s[d]=n,l[d]=n.toLowerCase();break;case"m":s[d]=i,l[d]=i.length<=2?i.toLowerCase():i.substr(0,i.length-2);break;case"y":s[d]=r,l[d]=r.substr(0,r.length/2).toLowerCase()}}var c=s[0]&&(s[2]||s[4])?e.dateSeparators[0]:"",p=s[2]&&s[4]?e.dateSeparators[1]:"";return s[1]=c,s[3]=p,l[1]=c,l[3]=p,t||(h.datePickerFormatPattern=l.join(""),h.momentDatePickerOpenFormatPattern=s.join("")),s.join("")}var e,t=function(){var e,t,o,n,i=Globalize.culture(),r=i.calendar.patterns.d.split(i.calendar["/"]);if(r){for(var a=new Array(3),s=0;s<r.length;s++){var l=r[s],u=l.substr(0,1).toLowerCase();switch(u){case"d":e=(e=l).substr(0,2).toUpperCase(),a[s]=u;break;case"m":t=l,a[s]=u;break;case"y":o=l.toUpperCase(),a[s]=u}}n=a.join("")}return{dateFormat:n,dateSeparators:[i.calendar["/"],i.calendar["/"]],dayAs:e,monthAs:t,yearAs:o}}();!function(e){if(_.value(h.DateDay))switch(_.value(h.DateDay).toLowerCase()){case"none":e.dayAs="";break;case"digits1or2":e.dayAs="D";break;case"digits2":e.dayAs="DD"}}(t),function(e){if(_.value(h.DateMonth))switch(_.value(h.DateMonth).toLowerCase()){case"none":e.monthAs="";break;case"digits1or2":e.monthAs="M";break;case"digits2":e.monthAs="MM";break;case"short":e.monthAs="MMM";break;case"long":e.monthAs="MMMM"}}(t),function(e){if(_.value(h.DateYear))switch(_.value(h.DateYear).toLowerCase()){case"none":e.yearAs="";break;case"digits2":e.yearAs="YY";break;case"digits4":e.yearAs="YYYY"}}(t),function(e){if(_.value(h.DateSeparator)&&"auto"!==_.value(h.DateSeparator).toLowerCase()){var t=void 0,o=void 0,n=void 0;_.value(h.DateSeparator)&&(n=_.value(h.DateSeparator).replace(/\(space\)/gi," ").replace(/\(none\)/gi,"n")),"n"===(t=n.substr(0,1))&&(t=""),"n"===(o=n.substr(1,1))&&(o=""),e.dateSeparators=[t,o]}}(t),function(e){if(_.value(h.DateFormat)){var t=_.value(h.DateFormat).toLowerCase();"auto"!==t&&(e.dateFormat=t)}}(t),function(e){if(_.value(h.DateWeek))switch(_.value(h.DateWeek).toLowerCase()){case"none":e.weekAs="";break;case"digits1or2":e.weekAs="W";break;case"digits2":e.weekAs="WW"}}(t),e=t,_.value(h.DateQuarter)&&(e.quarterAs="Q");var o=l(t);return{display:o,parse:function(e,t){var o=[];if(e.weekAs||e.quarterAs)return o;if(""!==e.yearAs){var n=e.yearAs,i=""!==e.monthAs,r=""!==e.dayAs;if(e.yearAs="YY",o.push(l(e,!0)),e.dateSeparators){if(e.dateSeparators[0]&&(i||r)){var a=e.dateSeparators[0];e.dateSeparators[0]="",o.push(l(e,!0)),e.dateSeparators[0]=a}if(e.dateSeparators[1]&&i&&r){var s=e.dateSeparators[1];e.dateSeparators[1]="",o.push(l(e,!0)),e.dateSeparators[1]=s}}if(e.yearAs="YYYY",o.push(l(e,!0)),e.dateSeparators){if(e.dateSeparators[0]&&(i||r)){a=e.dateSeparators[0];e.dateSeparators[0]="",o.push(l(e,!0)),e.dateSeparators[0]=a}if(e.dateSeparators[1]&&i&&r){s=e.dateSeparators[1];e.dateSeparators[1]="",o.push(l(e,!0)),e.dateSeparators[1]=s}}(i||r)&&(e.yearAs="",o.push(l(e,!0))),e.yearAs=n}else o.push(t);return o}(t,o),condensedParse:function(e){var t=[];if(e.weekAs||e.quarterAs)return t;for(var o="",n=0;n<3;n++){switch(e.dateFormat.substr(n,1).toLowerCase()){case"d":o+=e.dayAs?"DD":"";break;case"m":o+=e.monthAs?"MM":"";break;case"y":o+=e.yearAs?"YY":""}}return o&&(t.push(o),o.match(/YY/)&&t.push(o.replace(/YY/,"YYYY"))),t}(t)}},e.getTimeSeparator=function(e){var t="";return _.value(e.TimeSeparator)&&(t=_.util.timeSeparators[_.value(e.TimeSeparator).toLocaleLowerCase()].toString()),t},e.getTimeFormat=function(e){function t(e){var t=e.Is24HourTime?"HH":"hh";t=e.TimeHours?t+e.TimeSeparator:"";var o=e.TimeMinutes?"mm"+e.TimeSeparator:"",n=e.TimeSeconds?"ss":"",i=e.Is24HourTime||!t?"":" A";return n||(o=o.endsWith(e.TimeSeparator)?o.substr(0,o.length-e.TimeSeparator.length):o),o||(t=t.endsWith(e.TimeSeparator)?t.substr(0,t.length-e.TimeSeparator.length):t),t+o+n+i}var o=-1!==Globalize.culture().calendar.patterns.t.indexOf("H"),n={Is24HourTime:!_.value(e.TimeFormat)||"auto"===_.value(e.TimeFormat).toLowerCase()?o:"hour24"===_.value(e.TimeFormat).toLowerCase(),TimeHours:_.value(e.TimeHours),TimeMinutes:_.value(e.TimeMinute),TimeSeconds:_.value(e.TimeSeconds),TimeSeparator:_.util.getTimeSeparator(e)},i=t(n),r=[i];return n.TimeHours&&(n.Is24HourTime=!n.Is24HourTime,r.push(t(n))),{display:i,parse:r}},e.showDatePicker=function(u,c){function i(e,t){void 0===t&&(t=!1);var o=e||u.datepicker("getDate");if(o){var n=c.getMoment();n&&n.isValid()||(n=c.getSessionDateMoment().startOf("day")),n.year(o.getFullYear()),n.month(o.getMonth()),n.date(o.getDate()),c.pickerOpen(!1),u.val(n.format(c.displayFormat())),c.updateValue(!1,t)}}function d(){r=!1,u.datepicker("hide"),u.focus()}function p(e){var t,o=_.telemetry.ActionEvents.buttonClicked,n={inputType:_.telemetry.InputType.mouse,extendedData:e};t=_.telemetry.addControlActionEvent(c,t,o,n)}var h,m,r=!0;function a(){y.find(".ui-datepicker-calendar td a").each(function(e,t){var o=[],n=$(t).parent(),i=n.parent().children().index(n),r=v.calendar.days.names[i];o.push(r);var a=$(t).text(),s=parseInt(n.attr("data-month"),10),l=v.calendar.months.names[s];o.push(a),o.push(l);var u=n.attr("data-year");o.push(u);var d=c.getTodayButtonLabel();$(t)[0].parentElement.title===d&&o.push(d),$(t).attr("aria-label",o.join(", ")),$(t).attr("role","button"),$(t).attr("href","#!"),$(t).attr("id","idDay-"+$(t)[0].text)});var e=y.find(".ui-datepicker-month");$(e).attr("aria-label",_.label("Input_DatePickerMonthLabel"));var t=y.find(".ui-datepicker-year");$(t).attr("aria-label",_.label("Input_DatePickerYearLabel"))}c.displayFormat();var e=_.util.time.minDate.getFullYear()+":"+_.util.time.maxDate.getFullYear(),v=Globalize.culture(),t=c.datePickerFormatPattern.toLowerCase().indexOf("m")>c.datePickerFormatPattern.toLowerCase().indexOf("y"),o=w(v),n=c.getSessionDateMoment(),s=moment({day:n.date(),month:n.month(),year:n.year()}),l=s.toDate(),g={buttonImageOnly:!0,changeMonth:!0,changeYear:!0,dateFormat:c.datePickerFormatPattern,dayNames:v.calendar.days.names,dayNamesMin:v.calendar.days.namesShort,dayNamesShort:v.calendar.days.namesAbbr,defaultDate:l,firstDay:o,maxDate:_.util.time.maxDate,minDate:_.util.time.minDate,monthNames:v.calendar.months.names,monthNamesShort:v.calendar.months.namesAbbr,nextText:_.label("Input_DatePickerNextMonth"),prevText:_.label("Input_DatePickerPreviousMonth"),shortYearCutoff:68,showAnim:"",showMonthAfterYear:t,showOn:"button",yearRange:e,beforeShow:function(e,t){var o,n=u.scrollParent();for(u.scrollParents=[];0<n.length&&n[0]!==document;)u.scrollParents.push(n),n.on("scroll.datePicker",d),n=n.scrollParent();setTimeout(function(){$(".ui-datepicker-next").attr("role","button"),$(".ui-datepicker-prev").attr("role","button"),$(".ui-datepicker-calendar [data-handler='selectDay']").attr("role","presentation")},10);var i=u.datepicker("widget");return u.on("keydown.ariaAlert",function(e){(_.util.isShortcutKeyPressed(e,{ctrl:!0,keyCode:[_.ui.KeyCodes.leftArrow,_.ui.KeyCodes.rightArrow,_.ui.KeyCodes.upArrow,_.ui.KeyCodes.downArrow]})||_.util.isShortcutKeyPressed(e,{keyCode:[_.ui.KeyCodes.pageUp,_.ui.KeyCodes.pageDown]}))&&(o&&clearTimeout(o),o=window.setTimeout(function(){a();var e=i.find(".ui-datepicker-calendar td a.ui-state-hover");if(0<e.length){var t=e.attr("aria-label");_.shell.addAriaAlertMessage(t)}o=null},500))}),null},beforeShowDay:function(e){return s.isSame(e,"day")?[!0,"ui-datepicker-usersessiondate",c.getTodayButtonLabel()]:[!0,"",""]},onChangeMonthYear:function(){setTimeout(a,10),C();var e=document.activeElement;e&&e.classList&&(e.classList.contains("ui-datepicker-month")||e.classList.contains("ui-datepicker-year"))&&setTimeout(function(){e.classList.contains("ui-datepicker-month")?y.find(".ui-datepicker-month").focus():e.classList.contains("ui-datepicker-year")&&y.find(".ui-datepicker-year").focus()},10)},onClose:function(){var t,e;u.off("keyup.datePickerButtonPanel keydown.datePickerButtonPanel"),u.off("keydown.ariaAlert"),y&&y.off("keydown"),r&&u.datepicker("getDate")&&i(),m&&(m(),m=void 0);try{u.datepicker("destroy"),$(document.body).trigger("datePickerDestroy")}catch(e){_.telemetry.addControlErrorEvent(c,"Error_DestoryingDatePicker",e.stack)}if($(document.body).off("datePickerDestroy",h),h=null,c.updatingBlock(function(){c.pickerOpen(!1),c.formattedValue.valueChanged.raise()}),u.scrollParents){try{for(var o=__values(u.scrollParents),n=o.next();!n.done;n=o.next()){n.value.off("scroll.datePicker")}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}u.scrollParents=[]}},onSelect:function(e,t){var o=new Date(t.selectedYear,t.selectedMonth,t.selectedDay);i(o,!0),d()}};g.localToday=l,u.datepicker(g),u.off("keypress",$.datepicker._doKeyPress),u.on("keyup.datePickerButtonPanel keydown.datePickerButtonPanel",C);var y=u.datepicker("widget");if(y.addClass("datepicker-popup"),y.attr("role","dialog"),y.addClass("binding-focusRegion"),y.attr("tabindex","0"),y.on("keydown",function(e){if(_.util.isShortcutKeyPressed(e,{keyCode:_.ui.KeyCodes.esc}))e.stopPropagation(),d();else if(_.util.isShortcutKeyPressed(e,{keyCode:[_.ui.KeyCodes.enter,_.ui.KeyCodes.spacebar]})){e.stopPropagation();var t=void 0,o=void 0;if(e.target&&e.target.parentElement&&(o=(t=e.target).parentElement),t&&o&&"selectDay"===o.getAttribute("data-handler")){var n=new Date(parseInt(o.getAttribute("data-year"),10),parseInt(o.getAttribute("data-month"),10),parseInt(t.innerText,10));i(n,!0),d()}}}),y.on("keyup",function(e){_.util.isShortcutKeyPressed(e,{keyCode:_.ui.KeyCodes.tab,isShiftKeyAgnostic:!0})&&e.target.classList.contains("ui-state-default")&&u.attr("aria-activedescendant",e.target.id)}),_.value(c.IsValid)){var f=c.getMoment();if(f&&f.isValid()){u.datepicker("setDate",new Date(f.year(),f.month(),f.date())),c.valueBinder.notifyCommitted(),(c.IgnoreTime&&f.isSame(_.util.time.maxDate,"day")||!c.IgnoreTime&&f.isSame(_.util.time.maxDate))&&window.setTimeout(function(){$.datepicker._gotoToday(u)})}else{var b=c.getSessionDateMoment();u.datepicker("setDate",new Date(b.year(),b.month(),b.date())),c.valueBinder.notifyCommitted()}}function C(){_.async(function(){var t,e=$("<div class='ui-datepicker-buttonpane ui-widget-content' />"),o=u.datepicker("widget");o.find(".ui-datepicker-buttonpane").remove(),o.append(e),o.find(".ui-datepicker-calendar").addClass("ui-datepicker-hasButtonPane"),u.on("keydown.picker",function(e){_.util.isShortcutKeyPressed(e,{keyCode:_.ui.KeyCodes.letterT})?(e.preventDefault(),l&&(c.isSessionDateToday()?l.click():(c.updatingBlock(function(){var e=c.getTodayMoment();c.setDate(e.toDate()),c.pickerOpen(!1);var t=c.getFormattedValue(!0);c._lastUserValue=t,u.val(t)}),e.stopImmediatePropagation(),d()))):_.util.isShortcutKeyPressed(e,{keyCode:_.ui.KeyCodes.letterD})?(e.preventDefault(),l&&l.click()):_.util.isShortcutKeyPressed(e,{keyCode:_.ui.KeyCodes.letterN})?(e.preventDefault(),t&&t.click()):_.util.isShortcutKeyPressed(e,{keyCode:_.ui.KeyCodes.letterC})&&(e.preventDefault(),i&&i.click())});var n=_.value(c.MaxDateLabel);n&&((t=$("<button/>")).addClass("ui-datepicker-maxdatelabel ui-state-default ui-priority-secondary ui-corner-all"),t.attr("type","button"),t.text(n),e.append(t),t.click(function(){p(n),c.updatingBlock(function(){c.setDate(_.util.time.maxDate),c.pickerOpen(!1);var e=c.getFormattedValue(!0);c._lastUserValue=e,u.val(e)}),d()})),e.find(".ui-datepicker-close").detach();var i=$("<button/>");i.addClass("ui-datepicker-clearlabel ui-state-default ui-priority-secondary ui-corner-all"),i.attr("type","button"),i.text(_.label("Input_DatePickerClear")),e.append(i),i.click(function(){p(_.label("Input_DatePickerClear")),c.pickerOpen(!1),c.formattedValue("",!0),d()}),e.find(".ui-datepicker-current").detach();var r,a,s,l=$("<button/>");l.addClass("ui-datepicker-todaylabel ui-state-default ui-priority-secondary ui-corner-all"),l.attr("type","button"),l.text(c.getTodayButtonLabel()),e.append(l),l.click(function(){p(c.getTodayButtonLabel()),c.updatingBlock(function(){var e=c.getSessionDateMoment();c.setDate(e.toDate()),c.pickerOpen(!1);var t=c.getFormattedValue(!0);c._lastUserValue=t,u.val(t)}),d()}),h&&($(document.body).off("datePickerDestroy",h),h=null),r=t,a=i,s=l,h=function(){u.off("keydown.picker"),r&&r.off("click"),a&&a.off("click"),s&&s.off("click")},m&&(m(),m=void 0),m=_.util.tabbingContainer(o[0],_.label("datePicker"),!1,!0),$(document.body).on("datePickerDestroy",h)},void 0,"Build date picker button panel")}u.datepicker("show"),c.pickerOpen(!0),C()}}(_.util||(_.util={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(l){!function(t){Globalize.addCultureInfo("en",{messages:{Calendar_ButtonAriaLabel:"Calendar",Input_DateDay:"Day",Input_DatePickerClear:"Clear",Input_DatePickerMonthLabel:"Month",Input_DatePickerNextMonth:"Next month",Input_DatePickerPreviousMonth:"Previous month",Input_DatePickerSessionDate:"Session Date",Input_DatePickerToday:"Today",Input_DatePickerYearLabel:"Year",Input_DateQuarter:"Quarter",Input_DateWeek:"Week",Input_InvalidDateAfterMax:"'{0}' is after the maximum allowable date of {1}.",Input_InvalidDateBeforeMin:"'{0}' is before the minimum allowable date of {1}.",Input_InvalidDateValue:"'{0}' is not a valid Date. Please enter date in {1} format."}});var r,e=(r=t.Input,__extends(o,r),o.prototype.init=function(e,t){this.formatPatterns=this._createFormatPatterns(),r.prototype.init.call(this,e,t)},o.prototype.getTaskGuideParams=function(e){var t;return this._pickerOpenObserver||(this._pickerOpenObserver=l.observe(this.pickerOpen,function(){l.ax&&l.ax.taskGuide&&l.ax.taskGuide.repositionGuidedQtip&&!l.value(l.ax.taskGuide.repositionGuidedQtip)&&l.async(function(){l.ax.taskGuide.repositionGuidedQtip(!0)},0,"reset task guide qtip")})),e=r.prototype.getTaskGuideParams.call(this,e),t=this.pickerOpen()?$(".ui-datepicker"):$(this.element),e.target=t,e.avoidRailsModeBlocks=!0,e},o.prototype.displayFormat=function(){var e="";return l.value(this.formatPatterns)&&l.value(this.formatPatterns).display&&(e=l.value(this.formatPatterns).display),e},o.prototype.getMoment=function(e){(e=e||this._parsedValue)&&-1!==e.indexOf("T")?e+="Z":e+="T00:00:00Z";var t=new window.Date(e),o=moment(t);return o=this._applyTimeZonePreference(o)},o.prototype.getFormattedValue=function(e){void 0===e&&(e=!1);var t=!!e||l.peek(this.IsValid),o=this._parsedValue,n=t?"":this._lastUserValue;return o&&(t||void 0===n)&&(n=this._formatDateValueForDisplay(o)),n},o.prototype.setFormattedValue=function(e,t,o){var n;void 0===t&&(t=!1),void 0===o&&(o=!1),e=e.trim();var i=this.shouldControlLogMessage(e);if(this._lastUserValue=e,!this.pickerOpen())if(i&&this.removeMessages(),e){var r=this.parseMoment(e);if(r&&r.isValid())if(r.isAfter(l.util.time.maxDate)){var a=this._applyTimeZonePreference(moment(l.util.time.maxDate)).format(this.displayFormat());i&&l.warn({Message:l.format(l.label("Input_InvalidDateAfterMax"),e,a),Label:"Input_InvalidDateAfterMax"},this),this._lastValidationResult=!1,this.IsValid(!1)}else if(r.isBefore(l.util.time.minDate)){var s=this._applyTimeZonePreference(moment(l.util.time.minDate)).format(this.displayFormat());i&&l.warn({Message:l.format(l.label("Input_InvalidDateBeforeMin"),e,s),Label:"Input_InvalidDateBeforeMin"},this),this._lastValidationResult=!1,this.IsValid(!1)}else n=this.setDate(r,t,o);else i&&this.warn(l.format(l.label(this.errorMessageLabel),e,this.displayFormat()),this.errorMessageLabel),this._lastValidationResult=!1,this.IsValid(!1)}else n=this.setDate(null);return n||(n=$.Deferred()).resolve(),n},o.prototype.getTodayMoment=function(){var e=moment().tz("User"),t=moment().utc();return t.year(e.year()),t.month(e.month()),t.date(e.date()),t},o.prototype.setDate=function(e,t,o){void 0===t&&(t=!1),void 0===o&&(o=!1);var n,i="";return e&&(i=moment(e).utc().format(this.valueFormatPattern)),!t&&i===this._parsedValue&&l.peek(this.IsValid)||(this._parsedValue=i,this.ReferenceGroup&&l.peek(this.ReferenceGroup.isFocused)?this.ReferenceGroup.isChildDataDirty=!0:n=this.setValue(i,t,o)),n},o.prototype.getDate=function(){var e,t=moment.utc(this._parsedValue,this.valueFormatPattern);return t&&t.isValid()&&(e=t.toDate()),e},o.prototype.getSessionDateMoment=function(){if(l.user().UserSessionDate()){var e=moment.tz(l.user().UserSessionDate(),"User"),t=moment().utc();return t.year(e.year()),t.month(e.month()),t.date(e.date()),t}return this.getTodayMoment()},o.prototype.isSessionDateToday=function(){var e=this;if(void 0===this._isSessionDateToday){var t=this.getTodayMoment(),o=this.getSessionDateMoment();this._isSessionDateToday=o.isSame(t,"day"),this.sessionDateObserver=l.observe(l.user().UserSessionDate,function(){e._isSessionDateToday=void 0},this,void 0,!0)}return this._isSessionDateToday},o.prototype.getTodayButtonLabel=function(){return this.isSessionDateToday()?l.label("Input_DatePickerToday"):l.label("Input_DatePickerSessionDate")},o.prototype.showPicker=function(){var e=this;return!this.pickerWasOpenOnMouseDown&&!this.pickerOpen()&&(l.async(function(){l.util.showDatePicker(e.$inputElement,e)},0,"Show date picker"),!0)},o.prototype.checkPickerState=function(){this.pickerOpen()?this.pickerWasOpenOnMouseDown=!0:this.pickerWasOpenOnMouseDown=!1},o.prototype.keyDown=function(e){this.pickerOpen()?(l.util.isShortcutKeyPressed(e,{alt:!0,keyCode:[l.ui.KeyCodes.rightArrow,l.ui.KeyCodes.leftArrow]})?(e.stopImmediatePropagation(),this.$inputElement.datepicker("hide")):(l.util.isShortcutKeyPressed(e,{alt:!0,keyCode:l.ui.KeyCodes.downArrow})&&this.$inputElement.datepicker("widget").find("a.ui-state-active").focus(),e.stopPropagation()),l.log.stopPropagation&&l.log.stopPropagation("DatePicker is open and handling keystrokes on input.")):l.util.handleShortcuts(this,e)},o.prototype.dispose=function(){this.sessionDateObserver&&this.sessionDateObserver.dispose(),r.prototype.dispose.call(this)},o.prototype.updateParsedValue=function(e){this._parsedValue=e},o.prototype.attached=function(){r.prototype.attached.call(this),this.pickerOpen=l.observable(!1)},o.prototype.openLookup=function(e){return l.value(this.LookupButton)&&this.allowUserChanges()&&!l.value(this.CanOpenLookupForm)?(this.pickerOpen()||this.showPicker(),!0):r.prototype.openLookup.call(this,e)},o.prototype._formatAsDisplayValue=function(e){return this._formatDateValueForDisplay(e,"")},o.prototype.lastValidFormattedValue=function(){return this._formatDateValueForDisplay(l.value(this.Value))},o.prototype._createFormatPatterns=function(){var e=this;return l.computed(function(){return l.util.getDateFormat(e)})},o.prototype._applyTimeZonePreference=function(e){return l.value(this.TimeZonePreference)===l.util.TimeZonePreference.none?e.utc():e.tz("User"),e},o.prototype.parseFormat=function(){var e="";return l.value(this.formatPatterns)&&l.value(this.formatPatterns).parse&&(e=l.value(this.formatPatterns).parse),e},o.prototype._formatDateValueForDisplay=function(e,t){var o=t;if(null!=e&&""!==e){var n=moment(l.util.time.maxDate).utc().format(this.valueFormatPattern);if(!this.pickerOpen()&&l.value(this.MaxDateLabel)&&e===n)o=l.value(this.MaxDateLabel);else{var i=this.getMoment(e);o=this.pickerOpen()?i.format(this.momentDatePickerOpenFormatPattern):i.format(this.displayFormat())}}return o},o.prototype.parseMoment=function(e){return"T"===e.toLocaleUpperCase()?this.getTodayMoment():"D"===e.toLocaleUpperCase()?this.getSessionDateMoment():l.value(this.MaxDateLabel)&&e.toLocaleUpperCase()===l.value(this.MaxDateLabel).toLocaleUpperCase()?moment(l.util.time.maxDate):this._isCondensedDate(e)?this._parseMomentInPreferedTimeZone(e,this._findMatchingCondensedFormat(e)):this._parseMomentInPreferedTimeZone(e,this.parseFormat())},o.prototype._isCondensedDate=function(e){for(var t=e.length,o=!0,n=0;n<t;n++)if(e[n]<"0"||"9"<e[n]){o=!1;break}return o&&!!this._findMatchingCondensedFormat(e)},o.prototype._findMatchingCondensedFormat=function(e){var t;if(l.value(this.formatPatterns)&&l.value(this.formatPatterns).condensedParse&&(t=l.value(this.formatPatterns).condensedParse),t&&t.length)for(var o=t.length,n=0;n<o;n++)if(t[n].length===e.length)return t[n]},o.prototype._parseMomentInPreferedTimeZone=function(e,t){var o;if((o=l.value(this.TimeZonePreference)===l.util.TimeZonePreference.none?moment.utc(e,t):moment.tz(e,t,"User")).isValid())if(1===o.month()&&29===o.date()&&2020===o.year()&&o._f&&-1===o._f.indexOf("YYYY")){var n=e.match(/20(\d\d)/);if(n&&0<n.length&&"2020"!==n[0]&&t&&Array.isArray(t)){var i=t.filter(function(e){return-1!==e.indexOf("YYYY")});0<i.length&&(o=this._parseMomentInPreferedTimeZone(e,i))}}else if(!l.value(this.hasDatePortion)&&this._parsedValue){var r=this.getMoment();o.year(r.year()),o.month(r.month()),o.date(r.date())}return o},o);function o(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return i.hasDatePortion=l.computed(function(){return"none"!==l.value(i.DateDay).toLocaleLowerCase()||"none"!==l.value(i.DateMonth).toLocaleLowerCase()||"none"!==l.value(i.DateYear).toLocaleLowerCase()}),l.observe(i.hasDatePortion,function(e){var t=i.$cachedElement.find(".lookupButton");t&&t.length&&(e&&t.hasClass("hideLookupButton")?t.removeClass("hideLookupButton"):!e&&l.value(i.LookupButton)&&!l.value(i.CanOpenLookupForm)&&i.allowUserChanges()&&t.addClass("hideLookupButton"))}),l.value(i.LookupButton)&&!l.value(i.CanOpenLookupForm)&&(i.isPickerComboboxBehavior=l.computed(function(){return l.value(i.AllowEdit)&&l.value(i.Enabled)&&!l.value(i.IsViewMode)}),l.observe(i.isPickerComboboxBehavior,function(e){var t;null!==(t=i.$inputElement)&&void 0!==t&&t[0]&&(e?(i.$inputElement[0].setAttribute("role","combobox"),i.$inputElement[0].setAttribute("aria-haspopup","dialog"),i.$inputElement[0].setAttribute("aria-controls","ui-datepicker-div"),l.observe(i.pickerOpen,function(e){i.$inputElement[0].setAttribute("aria-expanded",e.toString())})):i.clearComboBoxInitialAria())})),i}(t.Date=e).prototype.IgnoreTime=!0,e.prototype.valueFormatPattern="YYYY-MM-DD",e.prototype.errorMessageLabel="Input_InvalidDateValue",e.prototype.DateDay=l.ui.autoValue,e.prototype.DateFormat=l.ui.autoValue,e.prototype.DateMonth=l.ui.autoValue,e.prototype.DateQuarter=!1,e.prototype.DateSeparator=l.ui.autoValue,e.prototype.DateWeek="",e.prototype.DateYear=l.ui.autoValue,e.prototype.CanOpenLookupForm=!1,e.prototype.LookupButton=!0,e.prototype.MaxDateLabel="",e.prototype.TimeZoneName="",e.prototype.TimeZonePreference=l.util.TimeZonePreference.none,e.prototype.ShowTimeZoneIndicator=!1,l.ui.addObservablePropertiesToPrototype(t.Input.prototype,{pickerOpen:!1});var n={OpenLookup:{Keys:{alt:!0,keyCode:l.ui.KeyCodes.downArrow},Handler:function(){var e=!1;return l.value(this.LookupButton)&&this.allowUserChanges()&&(e=l.value(this.CanOpenLookupForm)?l.applyFunction(t.Input.prototype.Shortcuts.OpenLookup.Handler,this):this.showPicker()),e},RecordTelemetry:!1,ShowToUser:function(){return l.value(this.LookupButton)&&this.allowUserChanges()},Description:l.label("Input_OpenDropDown")}};e.prototype.Shortcuts=l.extendPrototype(t.Input.prototype.Shortcuts,n),l.adapter({id:"Date",controlType:"Date",template:"DateTime"}),l.adapter({id:"DateSummary",controlType:"Date",template:"SummaryField"}),l.adapter({id:"DateLabel",controlType:"Date",template:"Label"}),l.adapter({id:"DateCardCell",controlType:"Date",template:"CardCell"}),l.adapter({id:"DateSimpleReadOnly",controlType:"Date",template:"SimpleReadOnly"});var a,i=(__extends(s,a=e),s.prototype.updateValue=function(){return this._onChange()},s.prototype.addMessage=function(e){this.messages||(this.messages=[]),this.messages.push(e)},s.prototype._onChange=function(){var e=!1;return this._committedValue!==this.currentValue&&(e=!0,this._committedValue=this.currentValue,this.RaiseEvent(l.ui.ChangeEvent,{bubbles:!0})),e},s.prototype._setValue=function(){this._committedValue=void 0},s.prototype.GetState=function(){return{formattedValue:this.currentValue,messages:this.messages}},s.prototype.ApplyState=function(e){var t=$.Deferred(),o=e&&e.formattedValue;return void 0!==o&&(this.currentValue=o),t.resolve(),t},s.prototype.attached=function(){this._={},a.prototype.attached.call(this),this._committedValue=this.currentValue,this.Value=l.observable(this._committedValue)},s);function s(e,t,o,n){var i=a.call(this,e,t,o,n)||this;return i.AllowEdit=l.observable(!0),i}t.DateCell=i,l.ui.addPropertiesToPrototype(i.prototype,{validating:{defaultValue:!1,attribute:"data-dyn-validating"}}),l.cellAdapter({id:"Date",template:"InputCell"}),l.cellAdapter({id:"Date",controlType:"DateCell",template:"InputCellEditor",type:l.cellTypes.editor})}(l.controls||(l.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(g){!function(m){Globalize.addCultureInfo("en",{messages:{Input_InvalidDateTimeValue:"'{0}' is not a valid UTC Date Time.  Please enter date and time in {1} format."}});var e,t=(e=m.Date,__extends(v,e),v.getFormattedValueForControl=function(e,t){var o="";if(!g.util.isNullOrUndefined(e)){var n="DateTime"===t.TypeName&&"Date"!==g.value(t.DisplayOption),i=n?v.prototype.valueFormatPattern:m.Date.prototype.valueFormatPattern,r=moment(g.util.time.maxDate).utc().format(i);if(g.value(t.MaxDateLabel)&&e===r)o=g.value(t.MaxDateLabel);else{-1!==e.indexOf("T")?e+="Z":e+="T00:00:00Z";var a=new window.Date(e),s=moment(a);t.TimeZonePreference&&g.value(t.TimeZonePreference)!==g.util.TimeZonePreference.none?s.tz("User"):s.utc();var l=g.util.getDateFormat(t);if(t.DateWeek&&"None"!==t.DateWeek||t.DateQuarter){var u=t.DateQuarter?g.label("Input_DateQuarter"):g.label("Input_DateWeek");o="".concat(u," ").concat(s.format(l.display))}else{var d=l;if(n){var c=g.util.getTimeFormat(t);if(""!==c.display){var p=l.parse.slice(),h=(d.display?" ":"")+c.display;d.display+=h,d.parse.forEach(function(e,t,o){o[t]=e+h}),Array.prototype.push.apply(d.parse,p)}}o=s.format(d.display)}}}return o},v.prototype.getTodayMoment=function(){var e=moment();e=this._applyTimeZonePreference(e);var t=this.getMoment();return moment.isMoment(t)&&t.isValid()&&(e=moment(g.util.combineDateAndTime(e,t))),e},v.prototype.getSessionDateMoment=function(){if(g.user().UserSessionDate()){var e=moment.tz(g.user().UserSessionDate(),"User"),t=this.getMoment();return moment.isMoment(t)&&t.isValid()&&(e=moment(g.util.combineDateAndTime(e,t))),e}return this.getTodayMoment()},v.prototype._createFormatPatterns=function(){var r=this;return g.computed(function(){var e=g.util.getDateFormat(r),t=g.util.getTimeFormat(r),o=e;if("Date"!==g.value(r.DisplayOption)&&""!==t.display){var n=e.parse.slice(),i=(o.display?" ":"")+t.display;o.display+=i,o.parse.forEach(function(e,t,o){o[t]=e+i}),Array.prototype.push.apply(o.parse,n)}return o})},v);function v(){return null!==e&&e.apply(this,arguments)||this}(m.DateTime=t).prototype.IgnoreTime=!1,t.prototype.valueFormatPattern="YYYY-MM-DDTHH:mm:ss",t.prototype.errorMessageLabel="Input_InvalidDateTimeValue",t.prototype.DisplayOption=g.ui.autoValue,t.prototype.TimeZonePreference=g.util.TimeZonePreference.auto,t.prototype.TimeFormat=g.ui.autoValue,t.prototype.TimeHours=!0,t.prototype.TimeMinute=!0,t.prototype.TimeSeconds=!0,t.prototype.TimeSeparator=g.ui.autoValue,g.adapter({id:"DateTimeSummary",controlType:"DateTime",template:"SummaryField"}),g.adapter({id:"DateTimeLabel",controlType:"DateTime",template:"Label"}),g.adapter({id:"DateTimeCardCell",controlType:"DateTime",template:"CardCell"}),g.adapter({id:"DateTimeSimpleReadOnly",controlType:"DateTime",template:"SimpleReadOnly"});var r,o=(__extends(n,r=t),n.prototype.updateValue=function(){return this._onChange()},n.prototype.addMessage=function(e){this.messages||(this.messages=[]),this.messages.push(e)},n.prototype._onChange=function(){var e=!1;return this._committedValue!==this.currentValue&&(e=!0,this._committedValue=this.currentValue,this.RaiseEvent(g.ui.ChangeEvent,{bubbles:!0})),e},n.prototype._setValue=function(){this._committedValue=void 0},n.prototype.GetState=function(){return{formattedValue:this.currentValue,messages:this.messages}},n.prototype.ApplyState=function(e){var t=$.Deferred(),o=e&&e.formattedValue;return void 0!==o&&(this.currentValue=o),t.resolve(),t},n.prototype.attached=function(){this._={},r.prototype.attached.call(this),this._committedValue=this.currentValue,this.Value=g.observable(this._committedValue)},n);function n(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return i.AllowEdit=g.observable(!0),i}m.DateTimeCell=o,g.ui.addPropertiesToPrototype(o.prototype,{validating:{defaultValue:!1,attribute:"data-dyn-validating"}}),g.cellAdapter({id:"DateTime",template:"InputCell"}),g.cellAdapter({id:"DateTime",controlType:"DateTimeCell",template:"InputCellEditor",type:g.cellTypes.editor})}(g.controls||(g.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(d){!function(e){Globalize.addCultureInfo("en",{messages:{Input_InvalidTimeValue:"'{0}' is not a valid Time. Please enter time in {1} format.",Input_TimeAriaLabel:"Time Input",Input_TimeHour:"Hour",Input_TimeMinute:"Minute",Input_TimeSecond:"Second"}});var n,t=(n=e.BaseInput,__extends(o,n),o.getFormattedValueForControl=function(e,t){var o="";if(null!=e&&""!==e){var n=void 0,i=void 0,r=void 0,a="number"==typeof e?e:parseInt(e,10);if(0<=a&&a<86400){n=Math.floor(a/3600),i=Math.floor((a-3600*n)/60),r=Math.floor(a-3600*n-60*i);var s=moment.utc({hour:n,minute:i,second:r}),l=d.util.getTimeFormat(t);l&&l.display&&(o=s.format(l.display))}else if(86400===a&&d.value(t.TimeHours)){var u=d.util.getTimeSeparator(t);o="24",d.value(t.TimeMinute)&&(o+=u+"00"),d.value(t.TimeSeconds)&&(o+=u+"00")}}return o},Object.defineProperty(o.prototype,"MidnightString",{get:function(){if(!this._midnightString){var e=moment.utc({hour:0,minute:0,second:0}),t=d.value(this.timeFormatPattern);t&&t.display&&(this._midnightString=e.format(t.display))}return this._midnightString},enumerable:!1,configurable:!0}),o.prototype.init=function(e,t){var o=this;this.timeFormatPattern=d.computed(function(){return d.util.getTimeFormat(o)}),n.prototype.init.call(this,e,t),d.observe(this.timeFormatPattern,function(){o._midnightString=void 0})},o.prototype.getFormattedValue=function(){var e=d.peek(this.IsValid),t=this._parsedValue,o=e?"":this._lastUserValue;return!e&&void 0!==o||(o=this._formatTimeValueForDisplay(t,o)),o},o.prototype.setFormattedValue=function(e,t,o){void 0===t&&(t=!1),void 0===o&&(o=!1);var n=this.shouldControlLogMessage(e);this._lastUserValue=e;var i,r=this.parseTime(e);return t||r!==this._parsedValue||!d.peek(this.IsValid)?(void 0!==r?(this._parsedValue=r,this.ReferenceGroup&&d.peek(this.ReferenceGroup.isFocused)?this.ReferenceGroup.isChildDataDirty=!0:i=this.setValue(r.toString(),t,o)):((i=$.Deferred()).reject(),n&&(this._keepMessageID=this.warn(d.format(d.label("Input_InvalidTimeValue"),e,this.timeFormatPattern().display),"Input_InvalidTimeValue")),this._lastValidationResult=!1,this.IsValid(!1)),n&&this.removeMessagesAsync()):(i=$.Deferred()).reject(),i},o.prototype.isMandatoryMet=function(){var e=!0;return null!=d.value(this.formattedValue)&&""!==d.value(this.formattedValue)&&d.value(this.formattedValue)!==this.MidnightString&&"0"!==d.value(this.formattedValue)||(e=!1),e},o.prototype.displayedValue=function(){var e;if(this.$inputElement&&this.$inputElement[0])e=this.$inputElement[0].value;else{var t=d.value(this.Value);e="number"==typeof t?t.toString():t}return e},o.prototype.compareToParsedValue=function(e){var t="number"==typeof e?e:parseInt(e,10);return this._parsedValue===t},o.prototype.updateParsedValue=function(e){var t=parseInt(e,10);isNaN(t)||(this._parsedValue=t)},o.prototype.parsedValueToString=function(){if(void 0!==this._parsedValue)return this._parsedValue.toString()},o.prototype._formatAsDisplayValue=function(e){return this._formatTimeValueForDisplay(e,"")},o.prototype.lastValidFormattedValue=function(){return this._formatTimeValueForDisplay(d.value(this.Value))},o.prototype.updateLastUserValue=function(e){this._lastUserValue="number"==typeof e?e.toString():e},o.prototype.parseTime=function(e){var t;if(null!=e)if(e=e.trim(),d.value(this.TimeHours)&&"24"===e.substr(0,2))t=86400;else if(d.value(this.TimeHours)&&"12"===e)t=43200;else{var o=void 0;(o="T"===e.trim().toLocaleUpperCase()?moment().tz("User"):moment.utc(e,d.value(this.timeFormatPattern).parse))&&o.isValid()&&(t=3600*o.hour()+60*o.minute()+o.second())}return t},o.prototype._formatTimeValueForDisplay=function(e,t){if(null!=e&&""!==e){var o=void 0,n=void 0,i=void 0,r="number"==typeof e?e:parseInt(e,10);if(0<=r&&r<86400){o=Math.floor(r/3600),n=Math.floor((r-3600*o)/60),i=Math.floor(r-3600*o-60*n);var a=moment.utc({hour:o,minute:n,second:i}),s=d.value(this.timeFormatPattern);s&&s.display&&(t=a.format(s.display))}else if(86400===r&&d.value(this.TimeHours)){var l=d.util.getTimeSeparator(this);t="24",d.value(this.TimeMinute)&&(t+=l+"00"),d.value(this.TimeSeconds)&&(t+=l+"00")}}return t},o);function o(){return null!==n&&n.apply(this,arguments)||this}(e.Time=t).prototype.TimeFormat=d.ui.autoValue,t.prototype.TimeHours=!0,t.prototype.TimeMinute=!0,t.prototype.TimeSeconds=!0,t.prototype.TimeSeparator=d.ui.autoValue,d.adapter({id:"TimeSummary",controlType:"Time",template:"SummaryField"}),d.adapter({id:"TimeLabel",controlType:"Time",template:"Label"}),d.adapter({id:"TimeCardCell",controlType:"Time",template:"CardCell"}),d.adapter({id:"TimeSimpleReadOnly",controlType:"Time",template:"SimpleReadOnly"});var r,i=(__extends(a,r=t),a.prototype.updateValue=function(){return this._onChange()},a.prototype.addMessage=function(e){this.messages||(this.messages=[]),this.messages.push(e)},a.prototype._onChange=function(){var e=!1;return this._committedValue!==this.currentValue&&(e=!0,this._committedValue=this.currentValue,this.RaiseEvent(d.ui.ChangeEvent,{bubbles:!0})),e},a.prototype._setValue=function(){this._committedValue=void 0},a.prototype.GetState=function(){return{formattedValue:this.currentValue,messages:this.messages}},a.prototype.ApplyState=function(e){var t=$.Deferred(),o=e&&e.formattedValue;return void 0!==o&&(this.currentValue=o),t.resolve(),t},a.prototype.attached=function(){this._={},r.prototype.attached.call(this),this._committedValue=this.currentValue,this.Value=d.observable(this._committedValue)},a);function a(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return i.AllowEdit=d.observable(!0),i}e.TimeCell=i,d.ui.addPropertiesToPrototype(i.prototype,{validating:{defaultValue:!1,attribute:"data-dyn-validating"}}),d.cellAdapter({id:"Time",template:"InputCell"}),d.cellAdapter({id:"Time",controlType:"TimeCell",template:"InputCellEditor",type:d.cellTypes.editor})}(d.controls||(d.controls={}))}($dyn=$dyn||{}),function(e){var t;(function(e){var u=function(){this.negative=!1,this.value=""};e.SignInfo=u;var a=function(){this.value="",this.carry=""};e.AddResult=a;var v=function(e){this.integer="",this.decimal="",this.negative=!1,this.isZero=!1,this.isNaN=!1,this.isBlank=!1,this.showPositive=!1,this.signMultiplier=1,e&&(this.integer=e)};e.InternalNumber=v;var t=(o.prototype.SetNumberFormat=function(e){this._numberFormat=e},o.prototype.GetNumberFormat=function(){return this._numberFormat},o.prototype.SetValue=function(e){this.numberStructInternal=this._parseNumber(e+"",this._numberFormat)},o.prototype.GetValue=function(){return this.formatNumber(this.numberStructInternal,this._numberFormat)},o.prototype.GetNumber=function(){return this.IsNaN()?NaN:Number(this.GetNumberString())},o.prototype.GetNumberString=function(){var e="";if(!this.IsNaN()){this.numberStructInternal.negative&&(e+="-");var t={};this._ignoreDecimal||(t=this._fixDecimal(this.numberStructInternal.decimal,this._numberFormat)),t.roundUp?e+=this._addPositiveIntegers(this.numberStructInternal.integer,"1"):e+=this.numberStructInternal.integer,this._ignoreDecimal||(e+=t.decimalString)}return e},o.prototype.IsNaN=function(){return this.numberStructInternal.isNaN},o.prototype.IsNegative=function(){return this.numberStructInternal.negative},o.prototype.IsZero=function(){return this.numberStructInternal.isZero},o.prototype.IsBlank=function(){return this.numberStructInternal.isBlank},o.prototype.SignMultiplier=function(e){this.numberStructInternal.signMultiplier=e},o.prototype.ShowPositive=function(e){this.numberStructInternal.showPositive=e},o.prototype.CompareToStr=function(e){var t=-1;if(e||""===e){e=e.toString();var o=this._parseNumber(e,this._numberFormat);t=this._compareNumbers(this.numberStructInternal,o,this._ignoreDecimal)}return t},o.prototype.CompareToDynNumber=function(e){return this._compareNumbers(this.numberStructInternal,e.numberStructInternal,this._ignoreDecimal)},o.prototype._startsWith=function(e,t){return 0===e.indexOf(t)},o.prototype._endsWith=function(e,t){return e.substr(e.length-t.length)===t},o.prototype._padZeros=function(e,t,o){var n;if(o)for(n=e.length;n<t;n++)e="0"+e;else for(n=e.length;n<t;n++)e+="0";return e},o.prototype._trimLeadingZeros=function(e){var t=e,o=this.nonZeroDigit.exec(e);return(!o||o.index&&0===(t=e.substr(o.index)).length)&&(t="0"),t},o.prototype._parseSignAndValue=function(e,t){var o=t["-"],n=t["+"]||"+",i=t[","],r=e.trim();t.IsWire||i&&0!==i.length||(i=Globalize.culture().numberFormat[","]),-1<r.indexOf(i)&&(r=r.split(i).join(""));var a=new u;if(a.negative=!1,a.value=r,this._startsWith(r,o))a.negative=!0,a.value=r.substr(o.length);else if(this._endsWith(r,o))a.negative=!0,a.value=r.substr(0,r.length-o.length);else{var s=this._startsWith(r,"("),l=this._endsWith(r,")");s||l?(a.negative=!0,a.value=s&&l?r.substr(1,r.length-2):Number.NaN.toString()):this._startsWith(r,n)?a.value=r.substr(n.length):this._endsWith(r,n)&&(a.value=r.substr(0,r.length-n.length))}return a.value=a.value.trim(),a},o.prototype._addDigits=function(e,t,o){var n=new a,i=parseInt(e,10)+parseInt(t,10)+parseInt(o,10);if(isNaN(i))throw new Error("NotANumber");var r=Math.pow(10,e.length);return n.value=this._padZeros(i%r+"",e.length,!0),n.carry=Math.floor(i/r)+"",n},o.prototype._addPositiveIntegers=function(e,t){for(var o,n,i="",r=e.length,a=t.length,s=Math.min(9,r,a),l=null,u=0<r&&0<a;!0===u;)if(r-s<0?s=r:a-s<0&&(s=a),r-=s,a-=s,o=e.substr(r,s),n=t.substr(a,s),i=(l=this._addDigits(o,n,l?l.carry:"0")).value+i,!1==(u=0<r&&0<a)){if(0<r){for(;0<parseInt(l.carry,10)&&0<r;)o=e.substr(--r,1),i=(l=this._addDigits(o,l.carry,"0")).value+i;0<r&&(i=e.substr(0,r)+i)}else if(0<a){for(;0<parseInt(l.carry,10)&&0<a;)n=t.substr(--a,1),i=(l=this._addDigits(n,l.carry,"0")).value+i;0<a&&(i=t.substr(0,a)+i)}0<parseInt(l.carry,10)&&(i=l.carry+i)}return i},o.prototype._compareDigits=function(e,t){var o=parseInt(e,10),n=parseInt(t,10),i=-1;return o<n?i=-1:n<o?i=1:o===n&&(i=0),i},o.prototype._compareNumbers=function(e,t,o){var n=0;if(!0===e.negative&&!1===t.negative)n=-1;else if(!1===e.negative&&!0===t.negative)n=1;else{var i=e.integer,r=t.integer;if(e.isNaN||t.isNaN)return-1;if(i.length===r.length){for(var a=0,s=Math.min(9,i.length),l=void 0,u=void 0,d=a<i.length;!0===d;)l=i.substr(a,s),u=r.substr(a,s),n=this._compareDigits(l,u),(a+=s)+s>=i.length&&(s=i.length-a),d=a<i.length&&0===n;if(!1===o&&0===n){var c=e.decimal,p=t.decimal;if(c.length>p.length?p=this._padZeros(p,c.length,!1):p.length>c.length&&(c=this._padZeros(c,p.length,!1)),c!==p){var h=new v(c),m=new v(p);n=this._compareNumbers(h,m,!0)}}}else n=i.length<r.length?-1:1;!0===e.negative&&(n*=-1)}return n},o.prototype._parseNumber=function(e,t){var o=/[\D]+/,n=this._parseSignAndValue(e,t),i=n.value,r=!1,a=new v;a.negative=n.negative,a.isBlank=""===e;var s=t["."],l=i.indexOf(s);return l<0?(a.integer=i,r=!0,a.decimal="0"):(a.integer=i.substr(0,l),a.decimal=i.substr(l+s.length),!1===this.nonZeroDigit.test(a.decimal)&&(r=!0,a.decimal="0")),o.test(a.integer)||o.test(a.decimal)?a.isNaN=!0:a.isNaN=!1,!1===a.isNaN&&(a.integer=this._trimLeadingZeros(a.integer),!1!==this.nonZeroDigit.test(a.integer)||!0!==r&&!1!==this.nonZeroDigit.test(a.decimal)||(a.negative=!1,a.isZero=!0)),a},o.prototype._formatInteger=function(e,t){return this._fixGroups(e.integer,t)},o.prototype._formatReal=function(e,t){var o=e.integer,n=e.decimal,i=this._fixDecimal(n,t);return n=i.decimalString,i.roundUp&&(o=this._addPositiveIntegers(o,"1")),o=this._fixGroups(o,t)+n},o.prototype._fixDecimal=function(e,t){var o=t.decimals,n=!1,i=o;if(0<=t.minDecimals&&t.minDecimals<o&&(i=t.minDecimals),o<e.length){var r=parseFloat("0."+e),a=Math.pow(10,o),s=Math.round(r*a)/a;if(1<=s&&(n=!0),0<o){var l=(s-Math.floor(s)).toFixed(o),u=l.indexOf(".");e=l.substr(u+1).replace(/0+$/,""),0<(e=(e=this._padZeros(e,i,!1)).substr(0,o)).length&&(e=t["."]+e)}else e=""}else 0<e.length&&(e=e.replace(/0+$/,"")),(0<i||0<e.length)&&(e=t["."]+this._padZeros(e,i,!1));return{decimalString:e,roundUp:n}},o.prototype._fixGroups=function(e,t){var o=t.groupSizes,n=o[0],i=1,r=t[","],a=e.length-1,s="";if(a<0)return s;for(;0<=a;){if(0===n||a<n)return e.slice(0,a+1)+(s.length?r+s:"");s=e.slice(a-n+1,a+1)+(s.length?r+s:""),a-=n,i<o.length&&(n=o[i++])}return e.slice(0,a+1)+r+s},o.prototype.formatNumber=function(e,t){var o="",n=e.signMultiplier*(e.negative?-1:1)<0;if(!1===e.isNaN){if(o=this._ignoreDecimal?this._formatInteger(e,t):this._formatReal(e,t),n&&!e.isZero){var i=t["-"];switch(t.pattern[0]){case"n -":o+=" ";case"n-":o+=i;break;case"- n":i+=" ";case"-n":o=i+o;break;case"(n)":o="("+o+")"}}if(!n&&!e.isZero&&e.showPositive){var r=t["+"]||"+";switch(t.pattern[0]){case"n -":o+=" ";case"n-":o+=r;break;case"- n":r+=" ";case"-n":o=r+o}}}else o=Number.NaN.toString();return o},o);function o(e,t){this._ignoreDecimal=e,this._numberFormat=void 0===t?Globalize.culture().numberFormat:t,this.numberStructInternal=new v}(e.DynNumber=t).prototype.nonZeroDigit=/[^0]/})((t=e.util||(e.util={})).Numbers||(t.Numbers={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(d){!function(e){Globalize.addCultureInfo("en",{messages:{Input_InvalidNumberValue:"'{0}' is not an accepted value for Field '{1}'. This field accepts numbers only.",Input_NumberAriaLabel:"Number Input",Input_PositiveOnly:"Field '{0}'(= {1}) can only contain positive numbers.",Input_ValueOutOfRange:"The value is not within the range.\r\nAcceptable values are in the range {0} - {1}."}});var n,t=(n=e.BaseInput,__extends(o,n),Object.defineProperty(o.prototype,"MaxValue",{get:function(){return this._maxValue||(this._maxValue=this.convertDynNumber(this.MaxValueNumber,this.WireFormat)),this._maxValue},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"MinValue",{get:function(){return this._minValue||(this.allowNegativeValue()?this._minValue=this.convertDynNumber(this.MinValueNumber,this.WireFormat):this._minValue=this.convertDynNumber("0",this.WireFormat)),this._minValue},enumerable:!1,configurable:!0}),o.prototype.init=function(e,t){var o=this;n.prototype.init.call(this,e,t),this.signDisplayBackup=new Array,this.rotateSignBackup=new Array,this.CurrentSignDisplay=d.observable(this.SignDisplayForEdit),d.observe(this.CurrentSignDisplay,this._updateSignDisplay,this),d.user()&&d.user().RegionalSettings&&(this._regionalSettingsObserver=d.observe(d.user().RegionalSettings,this._regionalSettingsChanged,this)),d.observe(this.RotateSign,function(e){o.SignMultiplier("Yes"===e?-1:1)}),d.observe(this.SignDisplay,function(e){o.CurrentSignDisplay(e)}),d.observe(this.AllowNegative,function(){o._minValue=void 0}),this.$inputElement.on("focus",d.controls.Number.prototype.gotFocus),this.$inputElement.on("blur",d.controls.Number.prototype.lostFocus)},o.prototype.getFormattedValue=function(){return d.peek(this.IsValid)||void 0===this._lastUserValue?this.formatValue(this._parsedValue):this._lastUserValue},o.prototype.setFormattedValue=function(e,t,o){var n;void 0===t&&(t=!1),void 0===o&&(o=!1);var i=this.shouldControlLogMessage(e),r=this._lastUserValue!==e;this._lastUserValue=e;var a=this.convertDynNumber(e,this.UserFormat),s=!1;if(!t&&a&&0===a.CompareToDynNumber(this._parsedValue)&&(s=!0,a.IsZero()?d.value(this.AllowBlankValue)?a.IsBlank()!==(""===d.value(this.Value))&&(t=!(s=!1)):this.showZeroValue()===a.IsBlank()&&this.ChangeMode===d.ui.ChangeMode.dirty&&(t=!(s=!1)):r&&this.ChangeMode===d.ui.ChangeMode.dirty&&(t=!0)),t||!s||!d.peek(this.IsValid)){var l=this.validateDynNumber(e,a,i);if(this._keepMessageID=l.messageID,this._lastValidationResult=l.isValid,i&&this.removeMessagesAsync(),l.isValid)if(a.SignMultiplier(d.value(this.SignMultiplier)),a.SetNumberFormat(this.WireFormat),this._parsedValue=a,this.ReferenceGroup&&d.peek(this.ReferenceGroup.isFocused))this.ReferenceGroup.isChildDataDirty=!0;else{var u=void 0;u=a.IsBlank()&&d.value(this.AllowBlankValue)?"":a.GetNumberString(),n=this.setValue(u,t,o)}else this.IsValid(!1)}return n||(n=$.Deferred()).resolve(),n},o.prototype.gotFocus=function(e){var s=d.context(e.currentTarget);s&&d.value(s.AllowEdit)&&s.updatingBlock(function(){var e=!1,t=!1,o=s.CurrentSignDisplay();s.signDisplayBackup.push(o),o!==d.ui.SignDisplayType.Auto&&o!==s.SignDisplayForEdit&&(s.CurrentSignDisplay(s.SignDisplayForEdit),e=!0);var n=s.RotateSign();if(s.rotateSignBackup.push(n),"Yes"===n&&(s.RotateSign("No"),t=!(e=!1)),e&&s.formattedValue.valueChanged.raise(),e||t){var i=s.$inputElement.get(0),r=i.selectionStart;if(i.createTextRange){var a=i.createTextRange();a.moveStart("character",r),a.moveEnd("character",r-i.value.length),a.select()}}})},o.prototype.lostFocus=function(e){var n=d.context(e.currentTarget);n&&d.value(n.AllowEdit)&&n.updatingBlock(function(){for(var e=!1,t=n.CurrentSignDisplay();0<n.signDisplayBackup.length;)t=n.signDisplayBackup.pop();n.CurrentSignDisplay()!==t&&(n.CurrentSignDisplay(t),e=!0);for(var o=n.RotateSign();0<n.rotateSignBackup.length;)o=n.rotateSignBackup.pop();n.RotateSign()!==o&&(n.RotateSign(o),e=!1),e&&n.formattedValue.valueChanged.raise()})},o.prototype.displayedValue=function(){var e;if(this.$inputElement&&this.$inputElement[0])e=this.$inputElement[0].value;else{var t=d.value(this.Value);e="number"==typeof t?t.toString():t}return e},o.prototype.isMandatoryMet=function(){var e=!0;if(null!==d.value(this.formattedValue)&&void 0!==d.value(this.formattedValue)&&""!==d.value(this.formattedValue)||(e=!1),e){var t=this._formatAsDisplayValue(0);d.value(this.formattedValue)===t&&(e=!1)}return e},o.prototype.dispose=function(){this.$inputElement.off("focus",d.controls.Number.prototype.gotFocus),this.$inputElement.off("blur",d.controls.Number.prototype.lostFocus),this._regionalSettingsObserver&&this._regionalSettingsObserver.dispose(),n.prototype.dispose.call(this)},o.prototype.compareToParsedValue=function(e){var t=!1;if(this._parsedValue){var o=this.convertDynNumber(e,this.WireFormat);0===this._parsedValue.CompareToDynNumber(o)&&(t=!0,o.IsBlank()!==this._parsedValue.IsBlank()&&(t=!1))}return t},o.prototype.updateParsedValue=function(e){this._parsedValue?this._parsedValue.SetValue(e):this._parsedValue=this.convertDynNumber(e,this.WireFormat)},o.prototype.parsedValueToString=function(){var e="";return void 0!==this._parsedValue&&(e=this._parsedValue.GetNumberString()),e},o.prototype.applyParameters=function(e){n.prototype.applyParameters.call(this,e);var t={};$.extend(!0,t,Globalize.culture().numberFormat),this.UserFormat=t,this.WireFormat={"+":"",",":"","-":"-",".":".",decimals:2,groupSizes:[3],IsWire:!0,pattern:["-n"]}},o.prototype.lastValidFormattedValue=function(){var e=this.convertDynNumber(d.value(this.Value),this.WireFormat);return this.formatValue(e)},o.prototype._formatAsDisplayValue=function(e){var t=this.convertDynNumber(e,this.WireFormat);return this.formatValue(t)},o.prototype.updateLastUserValue=function(e){this._lastUserValue="number"==typeof e?e.toString():e},o.prototype._regionalSettingsChanged=function(){this._updateSignDisplay(d.value(this.CurrentSignDisplay))},o.prototype.showZeroValue=function(){var e=d.value(this.ShowZero),t=e===d.ui.autoValue;return t=t||d.util.stringToBoolean(e)},o.prototype.allowNegativeValue=function(){var e=d.value(this.AllowNegative),t=e===d.ui.autoValue;return t=t||d.util.stringToBoolean(e)},o.prototype.convertDynNumber=function(e,t){var o;if(null==e)e="";else{var n=e.toString();if(0<n.length&&"="===n.charAt(0)){var i=ControlLibrary.evalMathExpression(n,t[","],t["."]);i!==n&&(t=this.WireFormat,e=i)}}return(o=t?new d.util.Numbers.DynNumber(this.IgnoreDecimal,t):new d.util.Numbers.DynNumber(this.IgnoreDecimal)).SetValue(e),o},o.prototype.validateDynNumber=function(e,t,o){void 0===o&&(o=!1);var n=!1,i=null;return t&&(t.IsNaN()?o&&(i=0<e.length&&"="===e.charAt(0)?this.warn(d.label("ControlLib_Number_InvalidExpression"),"ControlLib_Number_InvalidExpression"):this.warn(d.format(d.label("Input_InvalidNumberValue"),e,this.Label?this.Label:this.Name),"Input_InvalidNumberValue")):!this.allowNegativeValue()&&t.IsNegative()?o&&(i=this.warn(d.format(d.label("Input_PositiveOnly"),this.Label?this.Label:this.Name,e),"Input_PositiveOnly")):this.checkRange(t)?n=!0:o&&(i=this.warn(d.format(d.label("Input_ValueOutOfRange"),this.formatValue(this.MinValue),this.formatValue(this.MaxValue)),"Input_ValueOutOfRange"))),{isValid:n,value:t,messageID:i}},o.prototype.formatValue=function(e){var t="";if(e){if((!this.showZeroValue()||d.value(this.AllowBlankValue))&&e.IsBlank())return t;if(!e.IsNaN()&&(!e.IsZero()||this.showZeroValue())){var o=e.GetNumberFormat(),n=d.value(this.IsCorrection),i=d.value(this.SignMultiplier);e.SignMultiplier(i),e.ShowPositive(n),this.UserFormat&&e.SetNumberFormat(this.UserFormat);var r=d.value(this.DisplaceNegative)!==d.ui.autoValue&&!0===this.isInGrid(),a=r&&n;d.value(this.SupportsCorrection)&&r&&(e.ShowPositive(!1),a?e.IsNegative()||e.SignMultiplier(-1*i):e.IsNegative()&&e.SignMultiplier(-1*i)),t=e.GetValue(),e.SetNumberFormat(o);var s="";r&&e.IsNegative()!==!a&&(s=parseInt(d.value(this.DisplaceNegative),10)+"ex"),this.$inputElement.css("padding-right",s)}}return t},o.prototype.checkRange=function(e){var t=!0,o=e.CompareToDynNumber(this.MaxValue);return(0<o||(o=e.CompareToDynNumber(this.MinValue))<0)&&(t=!1),t},o.prototype._updateSignDisplay=function(e){var t;switch(d.value(this.SupportsCorrection)&&d.value(this.DisplaceNegative)!==d.ui.autoValue&&(e=d.ui.SignDisplayType.Auto),e){case d.ui.SignDisplayType.None:t="n";break;case d.ui.SignDisplayType.Prefixed:t="-n";break;case d.ui.SignDisplayType.Suffixed:t="n-";break;case d.ui.SignDisplayType.Parentheses:t="(n)";break;case d.ui.SignDisplayType.Auto:default:t=Globalize.culture().numberFormat.pattern[0]}this.UserFormat.pattern=[t]},o);function o(){return null!==n&&n.apply(this,arguments)||this}(e.Number=t).prototype.IsNumber=!0,t.prototype.DisplaceNegative=d.ui.autoValue,t.prototype.SignDisplay=d.ui.SignDisplayType.Auto,t.prototype.AllowBlankValue=!1,t.prototype.Alignment=d.ui.autoValue,t.prototype.SupportsCorrection=!1,t.prototype.MaxValueNumber="1",t.prototype.MinValueNumber="1",t.prototype.UserFriendlyTypeName="",t.prototype.IgnoreDecimal=!0,t.prototype.SignDisplayForEdit=d.ui.SignDisplayType.Prefixed,d.ui.addObservablePropertiesToPrototype(t.prototype,{AllowNegative:d.ui.autoValue,RotateSign:d.ui.autoValue,ShowZero:d.ui.autoValue,SignMultiplier:1}),d.ui.addPropertiesToPrototype(t.prototype,{IsCorrection:{defaultValue:!1,observable:!0}})}(d.controls||(d.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(h){!function(e){var o,t=(o=e.Number,__extends(n,o),n.prototype.init=function(e,t){o.prototype.init.call(this,e,t),this.UserFormat[","]=""},n);function n(){return null!==o&&o.apply(this,arguments)||this}(e.Integer=t).prototype.MaxValueNumber="2147483647",t.prototype.MinValueNumber="-2147483648";var r,i=(__extends(a,r=t),a);function a(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return i.UserFriendlyTypeName=h.label("Input_TypeName_Int64"),i}(e.Int64=i).prototype.MaxValueNumber="9223372036854775807",i.prototype.MinValueNumber="-9223372036854775808",h.adapter({id:"Integer",controlType:"Integer",template:"Number"}),h.adapter({id:"Int64",controlType:"Int64",template:"Number"}),h.adapter({id:"IntegerSummary",controlType:"Number",template:"SummaryField"}),h.adapter({id:"Int64Summary",controlType:"Number",template:"SummaryField"}),h.adapter({id:"IntegerLabel",controlType:"Number",template:"Label"}),h.adapter({id:"Int64Label",controlType:"Number",template:"Label"}),h.adapter({id:"IntegerCardCell",controlType:"Number",template:"CardCell"}),h.adapter({id:"Int64CardCell",controlType:"Number",template:"CardCell"}),h.adapter({id:"IntegerSimpleReadOnly",controlType:"Number",template:"SimpleReadOnly"}),h.adapter({id:"Int64SimpleReadOnly",controlType:"Number",template:"SimpleReadOnly"});var s,l=(__extends(u,s=t),u.prototype.updateValue=function(){return this._onChange()},u.prototype.addMessage=function(e){this.messages||(this.messages=[]),this.messages.push(e)},u.prototype._onChange=function(){var e=!1;return this._committedValue!==this.currentValue&&(e=!0,this._committedValue=this.currentValue,this.RaiseEvent(h.ui.ChangeEvent,{bubbles:!0})),e},u.prototype._setValue=function(){this._committedValue=void 0},u.prototype.GetState=function(){return{formattedValue:this.currentValue,messages:this.messages}},u.prototype.ApplyState=function(e){var t=$.Deferred(),o=e&&e.formattedValue;return void 0!==o&&(this.currentValue=o),t.resolve(),t},u.prototype.attached=function(){this._={},s.prototype.attached.call(this),this._committedValue=this.currentValue,this.Value=h.observable(this._committedValue)},u);function u(e,t,o,n){var i=s.call(this,e,t,o,n)||this;return i.AllowEdit=h.observable(!0),i}e.IntegerCell=l,h.ui.addPropertiesToPrototype(l.prototype,{validating:{defaultValue:!1,attribute:"data-dyn-validating"}});var d,c=(__extends(p,d=i),p.prototype.updateValue=function(){return this._onChange()},p.prototype.addMessage=function(e){this.messages||(this.messages=[]),this.messages.push(e)},p.prototype._onChange=function(){var e=!1;return this._committedValue!==this.currentValue&&(e=!0,this._committedValue=this.currentValue,this.RaiseEvent(h.ui.ChangeEvent,{bubbles:!0})),e},p.prototype._setValue=function(){this._committedValue=void 0},p.prototype.GetState=function(){return{formattedValue:this.currentValue,messages:this.messages}},p.prototype.ApplyState=function(e){var t=$.Deferred(),o=e&&e.formattedValue;return void 0!==o&&(this.currentValue=o),t.resolve(),t},p.prototype.attached=function(){this._={},d.prototype.attached.call(this),this._committedValue=this.currentValue,this.Value=h.observable(this._committedValue)},p);function p(e,t,o,n){var i=d.call(this,e,t,o,n)||this;return i.AllowEdit=h.observable(!0),i}e.Int64Cell=c,h.ui.addPropertiesToPrototype(c.prototype,{validating:{defaultValue:!1,attribute:"data-dyn-validating"}}),h.cellAdapter({id:"Integer",template:"NumberCell"}),h.cellAdapter({id:"Int64",template:"NumberCell"}),h.cellAdapter({id:"Integer",controlType:"IntegerCell",template:"NumberCellEditor",type:h.cellTypes.editor}),h.cellAdapter({id:"Int64",controlType:"Int64Cell",template:"NumberCellEditor",type:h.cellTypes.editor})}(h.controls||(h.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(l){!function(e){var s,t=(s=e.Number,__extends(o,s),o.prototype.init=function(e,t){s.prototype.init.call(this,e,t),this.$inputElement.addClass("real_input_edit"),l.observe(this.ThousandSeparator,this._updateThousandSeparator,this),l.observe(this.CurrentSignDisplay,this._updateCurrentSignDisplay,this),l.observe(this.DecimalSeparator,this._updateDecimalSeparator,this),l.observe(this.NoOfDecimals,this._updateNoOfDecimals,this),l.observe(this.MinNoOfDecimals,this._updateMinNoOfDecimals,this)},o.prototype.keyUp=function(e){if(e&&e.which===l.ui.KeyCodes.decimal&&this.allowUserChanges()&&"."!==this.UserFormat["."]){var t=e.target,o=t.value;if(o){var n=o.lastIndexOf(".");if(-1<n){var i=o.substr(0,n)+this.UserFormat["."]+o.substr(n+1),r=l.ui.selectionStart(t),a=l.ui.selectionEnd(t);t.value=i,l.ui.selectionStart(t,r),l.ui.selectionEnd(t,a)}}}s.prototype.keyUp.call(this,e)},o.prototype._regionalSettingsChanged=function(){s.prototype._regionalSettingsChanged.call(this),this._updateThousandSeparator(l.value(this.ThousandSeparator)),this._updateCurrentSignDisplay(l.value(this.CurrentSignDisplay)),this._updateDecimalSeparator(l.value(this.DecimalSeparator)),this._updateNoOfDecimals(l.value(this.NoOfDecimals)),this._updateMinNoOfDecimals(l.value(this.MinNoOfDecimals))},o.prototype._updateThousandSeparator=function(e){var t;switch(e){case l.ui.ThousandSeparator.none:t="";break;case l.ui.ThousandSeparator.comma:t=",";break;case l.ui.ThousandSeparator.space:t=" ";break;case l.ui.ThousandSeparator.apostrophe:t="'";break;case l.ui.ThousandSeparator.dot:t=".";break;case l.ui.ThousandSeparator.auto:default:(t=Globalize.culture().numberFormat[","])===String.fromCharCode(160)&&(t=" ")}this.UserFormat[","]=t,this.UserFormat.currency[","]=t},o.prototype._updateCurrentSignDisplay=function(e){var t;switch(e){case l.ui.SignDisplayType.None:t="$n";break;case l.ui.SignDisplayType.Prefixed:t="-$n";break;case l.ui.SignDisplayType.Suffixed:t="$n-";break;case l.ui.SignDisplayType.Parentheses:t="($n)";break;case l.ui.SignDisplayType.Auto:default:t=Globalize.culture().numberFormat.currency.pattern[0]}this.UserFormat.currency.pattern=[t]},o.prototype._updateDecimalSeparator=function(e){var t;switch(e){case l.ui.DecimalSeparator.comma:t=",";break;case l.ui.DecimalSeparator.dot:t=".";break;case l.ui.DecimalSeparator.auto:default:t=Globalize.culture().numberFormat["."]}this.UserFormat["."]=t,this.UserFormat.currency["."]=t},o.prototype._updateNoOfDecimals=function(e){var t;switch(e){case l.ui.autoValue:t=Globalize.culture().numberFormat.decimals;break;default:t=parseInt(e,10)}this.WireFormat.decimals=t,this.UserFormat.decimals=t,this.UserFormat.currency.decimals=t},o.prototype._updateMinNoOfDecimals=function(e){e!==l.ui.autoValue&&(this.UserFormat.minDecimals=parseInt(e,10))},o);function o(){return null!==s&&s.apply(this,arguments)||this}(e.Real=t).prototype.MaxValueNumber="999999999999999.99",t.prototype.MinValueNumber="-999999999999999.99",t.prototype.ThousandSeparator=l.ui.ThousandSeparator.auto,t.prototype.DecimalSeparator=l.ui.DecimalSeparator.auto,t.prototype.NoOfDecimals=l.ui.autoValue,t.prototype.AutoInsSeparator=l.ui.autoValue,t.prototype.MinNoOfDecimals=l.ui.autoValue,t.prototype.FormatMST=l.ui.autoValue,t.prototype.IgnoreDecimal=!1,l.adapter({id:"Real",controlType:"Real",template:"Number"}),l.adapter({id:"RealSummary",controlType:"Real",template:"SummaryField"}),l.adapter({id:"RealLabel",controlType:"Real",template:"Label"}),l.adapter({id:"RealCardCell",controlType:"Real",template:"CardCell"}),l.adapter({id:"RealSimpleReadOnly",controlType:"Real",template:"SimpleReadOnly"});var r,n=(__extends(i,r=t),i.prototype.updateValue=function(){return this._onChange()},i.prototype.addMessage=function(e){this.messages||(this.messages=[]),this.messages.push(e)},i.prototype._onChange=function(){var e=!1;return this._committedValue!==this.currentValue&&(e=!0,this._committedValue=this.currentValue,this.RaiseEvent(l.ui.ChangeEvent,{bubbles:!0})),e},i.prototype._setValue=function(){this._committedValue=void 0},i.prototype.GetState=function(){return{formattedValue:this.currentValue,messages:this.messages}},i.prototype.ApplyState=function(e){var t=$.Deferred(),o=e&&e.formattedValue;return void 0!==o&&(this.currentValue=o),t.resolve(),t},i.prototype.attached=function(){this._={},r.prototype.attached.call(this),this._committedValue=this.currentValue,this.Value=l.observable(this._committedValue)},i);function i(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return i.AllowEdit=l.observable(!0),i}e.RealCell=n,l.ui.addPropertiesToPrototype(n.prototype,{validating:{defaultValue:!1,attribute:"data-dyn-validating"}}),l.cellAdapter({id:"Real",template:"NumberCell"}),l.cellAdapter({id:"Real",controlType:"RealCell",template:"NumberCellEditor",type:l.cellTypes.editor})}(l.controls||(l.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(l){!function(e){Globalize.addCultureInfo("en",{messages:{CheckBox_ToggleFalseText:"No",CheckBox_ToggleTrueText:"Yes",Checkbox_ToggleValue:"Toggle value"}});var i,t=(i=l.ui.Control,__extends(o,i),Object.defineProperty(o.prototype,"YesNoText",{get:function(){var e=l.value(this.formattedValue),t=e&&l.util.stringToBoolean(e)?"CheckBox_ToggleTrueText":"CheckBox_ToggleFalseText";return l.label(t)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"IsStandard",{get:function(){return l.value(this.Style)===l.ui.CheckBoxStyle.checkbox},enumerable:!1,configurable:!0}),o.prototype.focusInCallBack=function(){this.isFocused(!0),l.log.focus&&l.log.focus("Focus: Checkbox->focusInCallBack input name: %s",this.Name)},o.prototype.focusOutCallBack=function(){this.isFocused(!1),l.log.focus&&l.log.focus("Focus: Checkbox->focusOutCallBack input name: %s",this.Name)},Object.defineProperty(o.prototype,"CheckedSymbol",{get:function(){var e=l.value(this.formattedValue);return!l.value(this.AllowEdit)&&this.isInGrid()?e&&l.util.stringToBoolean(e)?"":"":e&&l.util.stringToBoolean(e)?"":""},enumerable:!1,configurable:!0}),o.prototype.init=function(e,t){var o=this;i.prototype.init.call(this,e,t),this.formattedValue(l.value(this.Value)),l.observe(this.Value,function(e){e!==l.value(o.formattedValue)&&o.formattedValue(e)}),l.observe(this.Style,function(e){e===l.ui.CheckBoxStyle.auto&&o.isInGrid()||e===l.ui.CheckBoxStyle.checkbox?($(o.element).attr("data-dyn-focus",".checkBox"),o.labelForId("_check")):($(o.element).attr("data-dyn-focus",".toggle-box"),o.labelForId("_toggle"))})},o.prototype.toggleValue=function(e){if(this.allowUserChanges()){var t=l.value(this.formattedValue);this.formattedValue(this.computeToggleValue(t)),this.setValue(l.value(this.formattedValue))}},o.prototype.keyDown=function(e){l.util.handleShortcuts(this,e)},o.prototype.clickHandler=function(e){e&&e.which===l.ui.MouseButtonCodes.rightButton||this.toggleValue(e)},o.prototype.setValue=function(e,t,o){var n=this;void 0===t&&(t=!1),void 0===o&&(o=!1);var i=$.Deferred();return o||this.allowUserChanges()?this.SetValue?l.callFunction(this.SetValue,this,[e],function(){n.updatingBlock(function(){n.formattedValue(l.util.stringToBoolean(l.value(n.Value)))}),i.resolve()},null,null,null,function(){i.resolve(!0)}):(i.resolve(),l.setValue(this,"Value",e,t)):i.resolve(!0),i},o.prototype.getFormattedValue=function(){return"0"===l.value(this.formattedValue)||!1===l.value(this.formattedValue)||"false"===l.value(this.formattedValue)?"False":"True"},o.prototype.GetInitialState=function(){return{formattedValue:!1}},o.prototype.GetState=function(){return{formattedValue:l.util.stringToBoolean(l.value(this.formattedValue))}},o.prototype.ApplyState=function(e,t){if(void 0===t&&(t=!1),void 0!==e.formattedValue&&e.formattedValue!==l.util.stringToBoolean(l.value(this.formattedValue))&&(this.formattedValue(e.formattedValue),!t))return this.setValue(e.formattedValue,!0,!0)},o.prototype.getTaskGuideParams=function(e){e=i.prototype.getTaskGuideParams.call(this,e);var t=$(this.element);e.target=t;var o=$(this.element).find(".checkBox");if(o[0]&&o[0].offsetWidth)e.target=o;else{var n=$(this.element).find(".toggle-box");n[0]&&(e.target=n)}return e},o.prototype.computeToggleValue=function(e){var t=l.value(e);return"0"===t||0===t||!1===t||"false"===t},o);function o(){return null!==i&&i.apply(this,arguments)||this}(e.CheckBox=t).prototype.SetValue=null,t.prototype.IsSorted=!1,t.prototype.bindUpdate=!0,t.prototype.SupportsDefaultAction=!1,t.prototype.HelpText="",t.prototype.ShowLabel=!0,t.prototype.IsFilterable=!1,t.prototype.IsFiltered=!1,t.prototype.recordability=l.util.recordabilityDefault,l.ui.addObservablePropertiesToPrototype(t.prototype,{formattedValue:!1,isFocused:!1,labelForId:"_toggle",Style:l.ui.CheckBoxStyle.auto,Value:!1}),l.ui.addPropertiesToPrototype(t.prototype,{DataSourceName:{defaultValue:"",observable:!0},FieldName:{defaultValue:"",observable:!0},Label:{defaultValue:"",observable:!0}});var n={ToggleValue:{Keys:{keyCode:l.ui.KeyCodes.spacebar},Handler:function(e){this.toggleValue(e)},ShowToUser:function(){return this.allowUserChanges()},RecordTelemetry:!1,Description:l.label("Checkbox_ToggleValue")}};t.prototype.Shortcuts=l.extendPrototype(t.prototype.Shortcuts,n);var r,a=(__extends(s,r=t),Object.defineProperty(s.prototype,"checked",{get:function(){var e=this.element.getElementsByClassName("checkBox")[0];return!!e&&l.util.stringToBoolean(e.getAttribute("aria-checked"))},set:function(e){var t=this.element.getElementsByClassName("checkBox")[0];t&&t.setAttribute("aria-checked",e.toString())},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"validating",{get:function(){return l.util.stringToBoolean(this.element.getAttribute("data-dyn-validating"))},set:function(e){this.element.setAttribute("data-dyn-validating",e.toString())},enumerable:!1,configurable:!0}),s.prototype.toggleValueForCell=function(){this.checked=!this.checked,this.validating=!0,this.RaiseEvent(l.ui.ChangeEvent,{bubbles:!0})},s.prototype.ApplyState=function(e){var t=$.Deferred();if(void 0!==e.formattedValue){var o=this.checked;e.formattedValue!==o&&(this.checked=e.formattedValue)}return t.resolve(),t},s.prototype.GetState=function(){return{formattedValue:this.checked}},s);function s(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return i.AllowEdit=!0,i}(e.CheckBoxCell=a).prototype.Shortcuts={ToggleValue:{Keys:{keyCode:l.ui.KeyCodes.spacebar},Handler:function(){this.toggleValueForCell()},Description:l.label("Checkbox_ToggleValue")}},l.cellAdapter({id:"CheckBox"}),l.cellAdapter({id:"CheckBox",controlType:"CheckBoxCell",template:"CheckBoxCell",type:l.cellTypes.editor})}(l.controls||(l.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(u){!function(e){var i,t=(i=e.Edit,__extends(o,i),Object.defineProperty(o.prototype,"StatusArea",{get:function(){if(void 0===this._statusArea&&this._lastChild&&this._lastChild.element){var e=$(this._lastChild.element).find(".field-status");0===e.length&&(e=null),this._statusArea=e}return this._statusArea},enumerable:!1,configurable:!0}),o.prototype.init=function(e,t){var a=this;i.prototype.init.call(this,e,t),this.isFocused=u.observable(!1),this.IsHyperlink=u.observable(!1),u.isObservable(this.Enabled)||(this.Enabled=u.observable(this.Enabled)),this._allowEdit=u.observable(!0),this.AllowEdit=u.computed(function(){var t,e;if(!a._allowEdit())return!1;var o=u.value(a.Children);if(o)try{for(var n=__values(o),i=n.next();!i.done;i=n.next()){var r=i.value;if(!u.value(r.AllowEdit))return!1}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return!0},function(e){a._allowEdit(e)}),this._isViewMode=u.observable(!0),this.IsViewMode=u.computed(function(){var t,e;if(!a._isViewMode())return!1;var o=u.value(a.Children);if(o)try{for(var n=__values(o),i=n.next();!i.done;i=n.next()){var r=i.value;if(!u.value(r.IsViewMode))return!1}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return!0},function(e){a._isViewMode(e)}),u.observe(this.Children,function(e){a._childrenCollection=[],a._lastChild=void 0,a._statusArea=void 0;var n=u.value(e);n&&(u.setValue(a,"IsHyperlink",!1),n.forEach(function(t,e){var o=t;a._childrenCollection.push(o),o.updatingBlock(function(){void 0!==o.StatusIndicator&&(e===n.length-1?(a._lastChild=o,a._lastChild.StatusIndicator(u.value(a.StatusIndicator))):o.StatusIndicator(u.ui.StatusIndicator.none)),u.setValue(o,"Required",u.value(a.Required)),o.ReferenceGroup=a,!u.value(a.IsHyperlink)&&u.value(o.IsHyperlink)&&u.setValue(a,"IsHyperlink",!0),t.LayoutWidth&&u.observe(t.LayoutWidth,function(e){e!==u.layout.Size.available&&u.setValue(t,"LayoutWidth",u.layout.Size.available)}),u.value(a.LookupButton)&&u.value(a.CanOpenLookupForm)&&o.isComboboxBehavior&&o.isComboboxBehavior.valueChanged.raise()})}),a.UpdateStatusArea())}),this.isInactiveCell()||(u.observe(this.StatusIndicator,function(e){a._lastChild&&a._lastChild.StatusIndicator&&a._lastChild.StatusIndicator(e)}),u.observe(this.IsValid,function(e){if(a.Root&&a.Root.UpdateInvalidControlList&&a.Root.UpdateInvalidControlList(a),e){a.removeMessages();var t=u.value(a.Children);t&&t.forEach(function(e){var t=e,o=e;t.IsValid&&!u.value(t.IsValid)?t.IsValid(!0):o.compareToParsedValue&&!o.compareToParsedValue(u.value(o.Value))&&o.updatingBlock(function(){o.updateParsedValue&&o.formattedValue&&(o.updateParsedValue(u.value(o.Value)),o.formattedValue.valueChanged.raise())})})}a.UpdateStatusArea()}),u.observe(this.Required,function(t){var e=u.value(a.Children);e&&e.forEach(function(e){e&&e.Required(t)})}),this.flyoutClickSubscriber=function(e){var t=u.context(e.clickTarget);return(!t||t.ReferenceGroup!==a)&&u.util.flyout.defaultFlyoutClickSubscriber(e)}),this.CustomPopup?this.showPopup=this.CustomPopup:u.ui.popupHost.apply(this);var o=u.value(this.ClientState);if(o&&"string"==typeof o&&this.applyClientState){var n=JSON.parse(o);u.async(function(){a.applyClientState(n)})}},o.prototype.focusOutCallBack=function(e){this.isFocusOutTargetFlyout(e)||this.isResizingInLookup(e)||(this.isFocused(!1),u.log.focus&&u.log.focus("Focus: RefrenceGroup->focusOutCallBack input name: %s",this.Name),this.resolveChanges(),this.UpdateStatusArea(),this.focusOutCleanup())},o.prototype.focusInCallBack=function(){u.log.focus&&u.log.focus("Focus: RefrenceGroup->focusInCallBack input name: %s",this.Name),this.isFocused(!0),u.value(this.AllowEdit)&&this.StatusIndicator(u.ui.StatusIndicator.none)},o.prototype.FindFocusTarget=function(){var e;if(document.activeElement){var t=u.context(document.activeElement);t&&t.ReferenceGroup===this&&(e=$(document.activeElement))}if(!e){var o=u.value(this.Children);e=o&&o.length?$(o[0].$inputElement):$()}return e},o.prototype.syncValues=function(){var e=u.value(this.Children);e&&e.forEach(function(e){e.syncValues&&e.syncValues()})},o.prototype.setChildValue=function(e,t){e.updateFormattedValue&&(e.updateFormattedValue(t),this.isChildDataDirty=!1)},o.prototype.resolveChanges=function(){var o,n=this;if(this.isChildDataDirty&&this.allowUserChanges()){var e=u.value(this.Children);if(e){var i=!1;if(e.forEach(function(e){var t=e,o=e;u.value(t.IsValid)?(!u.value(n.IsValid)||o.compareToParsedValue&&!o.compareToParsedValue(u.value(o.Value)))&&o.setValue&&o.parsedValueToString&&o.setValue(o.parsedValueToString(),!0):i=!0}),i)return void(this.isChildDataDirty=!1)}this.isChildDataDirty=!1,this.removeMessages(),o=$.Deferred(),u.value(u.ax.taskRecording.isRecording)&&!u.value(u.ax.taskRecording.taskGuidePlaybackState)&&u.info({Message:u.label("Input_SelectValueFromLookup"),Label:"Input_SelectValueFromLookup"}),u.callFunction(this.ResolveChanges,this,void 0,function(e){if(e){var t=u.value(n.Children);t&&t.forEach(function(e){var t=e;t.updateParsedValue&&t.formattedValue&&t.compareToParsedValue&&!t.compareToParsedValue(u.value(t.Value))&&e.updatingBlock(function(){t.updateParsedValue(u.value(t.Value)),t.formattedValue.valueChanged.raise()})})}o.resolve()})}return o||(o=$.Deferred()).resolve(),o},o.prototype.isMandatoryMet=function(){var t,e,o=!1;if(this._childrenCollection&&0<this._childrenCollection.length)try{for(var n=__values(this._childrenCollection),i=n.next();!i.done;i=n.next()){var r=i.value;if(r.isMandatoryMet&&r.isMandatoryMet()){o=!0;break}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return o},o.prototype.keyDown=function(e){u.util.handleShortcuts(this,e),this.disableAutoPresentLookupForQuickEditGrids(),this.autoPresentLookup(e)},o.prototype.focusFirstChild=function(){if(this._childrenCollection&&0<this._childrenCollection.length){var e=this._childrenCollection[0].$inputElement;e&&e.focus()}},o.prototype.cellRenderer=function(e){return this._childrenCollection[0].cellRenderer(e)},o.prototype.GetState=function(){var t={children:{}},e=u.value(this.Children);return e&&e.forEach(function(e){e.Name&&e.GetState&&(t.children[e.Name]=e.GetState())}),t},o.prototype.ApplyState=function(o){if(o&&o.children){var e=u.value(this.Children);e&&e.forEach(function(e){if(e.Name&&e.ApplyState){var t=o.children[e.Name];e.ApplyState(t)}})}return this.resolveChanges()},o.prototype.onSerializeTransitState=function(){var n={},e=u.value(this.Children);e&&e.forEach(function(e,t){var o=e.getFormattedValue?e.getFormattedValue():"";n["formattedValue"+t.toString()]=o}),n=JSON.stringify(n),u.setValue(this,"ClientState",n)},o.prototype.displayedValue=function(){var e,t=u.value(this.Children);if(t){var o=[];t.forEach(function(e){e.displayedValue&&o.push(e.displayedValue())}),e=o.join(" ")}return e},o.prototype.setComboBoxInitialAria=function(){var t,e,o;if(u.value(this.isComboboxBehavior)){var n=u.value(this.Children);if(n&&0<n.length)try{for(var i=__values(n),r=i.next();!r.done;r=i.next()){var a=r.value,s=u.context(a.element);null!==(o=null==s?void 0:s.$inputElement)&&void 0!==o&&o[0]&&(s.setFlyoutExpandedState(!1,!0),s.$inputElement[0].setAttribute("role","combobox"))}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}}},o.prototype.clearComboBoxInitialAria=function(){var t,e,o,n=u.value(this.Children);if(n&&0<n.length)try{for(var i=__values(n),r=i.next();!r.done;r=i.next()){var a=r.value,s=u.context(a.element);null!==(o=null==s?void 0:s.$inputElement)&&void 0!==o&&o[0]&&(u.util.clearLookupAriaValues(s.$inputElement[0],!1),s.setFlyoutExpandedState(!1,!1))}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},o.prototype.ComboBoxFlyoutObserverAction=function(e){var t,o,n,i=u.value(this.Children);if(i&&0<i.length)try{for(var r=__values(i),a=r.next();!a.done;a=r.next()){var s=a.value,l=u.context(s.element);null!==(n=null==l?void 0:l.$inputElement)&&void 0!==n&&n[0]&&(e&&"ComboBox"!==l.TypeName?u.util.setupLookupAriaValues(l.$inputElement[0],e):u.util.clearLookupAriaValues(l.$inputElement[0],!0),l.setFlyoutExpandedState(""!==e,!0))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}},o.prototype.displayedValues=function(o){var n={},e=u.value(this.Children);return e&&e.forEach(function(e){var t=e;t.displayedValue&&(!o||t.isDisplayedValueDirty&&t.isDisplayedValueDirty())&&(n[e.Name]=t.displayedValue())}),n},o.prototype.getDisplayedValueSource=function(e){var t=this;if(e.target){var o=u.context(e.target);o&&(t=o)}return t},o.prototype.openLookup=function(e){return!!this.allowUserChanges()&&(u.log.popups&&u.log.popups("Popups: Alt+Down shortcut used to open/focus lookup for %s / %s; setting ShowFlyout to true; ShowFlyout currently equals %s",this.Name?this.Name:"<unknown>",this._element&&this._element.id?this._element.id:"<unknown>",u.peek(this.ShowFlyout)),this.TelemetryOptions={inputType:u.telemetry.InputType.keyboard},e.which===u.ui.KeyCodes.enter?this.openLookupIfNotOpen():this.openOrFocusLookup(),!0)},o.prototype.applyClientState=function(n){var e=u.value(this.Children);e&&e.forEach(function(e,t){var o=n["formattedValue"+t.toString()];e.formattedValue&&void 0!==o&&e.formattedValue(o)})},o);function o(){return null!==i&&i.apply(this,arguments)||this}(e.ReferenceGroup=t).prototype.RequestPopup=null,t.prototype.ResolveChanges=null,t.prototype.Width=u.layout.Size.large,t.prototype.CustomPopup=null,t.prototype.isChildDataDirty=!1,t.prototype.LookupButton=!0,u.ui.addObservablePropertiesToPrototype(t.prototype,{ShowFlyout:!1});var n={OpenLookup:{Keys:{alt:!0,keyCode:u.ui.KeyCodes.downArrow},Handler:function(e){return this.openLookup(e)},RecordTelemetry:!1,ShowToUser:function(){return this.allowUserChanges()},Description:u.label("Input_OpenDropDown")},OpenLookupForEnter:{Keys:{keyCode:u.ui.KeyCodes.enter},Handler:function(e){return!!this.allowUserChanges()&&(u.util.isFlightEnabled(u.controls.standardizeKeyboardInteractionFeature)&&!u.peek(this.ShowFlyout)?this.openLookup(e):this.handleKeyDownForLookup(e))},RecordTelemetry:!1,ShowToUser:function(){return this.allowUserChanges()},Description:u.label("Input_OpenDropDown")},KeyForLookup:{Keys:{keyCode:u.util.Lookup.KeysToSendToLookup},Handler:e.Edit.prototype.handleKeyDownForLookup,RecordTelemetry:!1,ShowToUser:!1}};t.prototype.Shortcuts=u.extendPrototype(t.prototype.Shortcuts,n);var r,a=(__extends(s,r=t),s);function s(){return null!==r&&r.apply(this,arguments)||this}e.ReferenceGroupCell=a,u.cellAdapter({id:"ReferenceGroup"})}(u.controls||(u.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(a){var e,r,t;function o(){return null!==r&&r.apply(this,arguments)||this}e=a.controls||(a.controls={}),r=e.Edit,__extends(o,r),o.prototype.init=function(e,t){var o=this;r.prototype.init.call(this,e,t),this.Items||(this.Items=a.observableArray([])),a.isObservable(this.SelectedItem)||(this.SelectedItem=a.observable(this.SelectedItem)),this.shownItem=a.observable(a.value(this.SelectedItem)),this.selectedIndex=a.computed(this.getSelectedIndex,function(e){o.setSelectedIndex(e)},this),this.shownIndex=a.computed(function(){var e=a.value(o.shownItem);return o.getItemIndex(e)},function(e){if(o.allowUserChanges()){var t=a.value(o.Items);t.length>e&&t[e]&&o.shownItem(t[e].Value)}}),this.isValueEmpty=a.computed(function(){return""===o.selectedLabel()}),this.Value=this.formattedValue=a.computed(function(){return o.selectedLabel()}),a.observe(this.SelectedItem,function(e){e!==a.value(o.shownItem)&&(o.removeMessages(),o.shownItem(e),a.value(o.Required)&&o.UpdateStatusArea())}),this.skipCollapsedSelection=a.computed(function(){return o.isInGrid()}),this.skipOverflowCheckForItemTooltip="sysUserSetup_theme"===this.ExtendedStyle||"sysUserSetup_density"===this.ExtendedStyle,this.isInactiveCell()||a.observe(this.IsValid,function(e){o.Root&&o.Root.UpdateInvalidControlList&&o.Root.UpdateInvalidControlList(o),e&&a.value(o.shownItem)!==a.value(o.SelectedItem)&&(o.removeMessages(),o.shownItem(a.value(o.SelectedItem))),o.UpdateStatusArea()});var n=a.value(this.ClientState);if(n&&"string"==typeof n&&this.applyClientState){var i=JSON.parse(n);a.async(function(){o.applyClientState(i)})}},o.prototype.setSelectedIndex=function(e,t,o){var n;if(void 0===t&&(t=!1),void 0===o&&(o=!1),o||this.allowUserChanges()){var i=a.value(this.Items);i.length>e&&0<=e&&(this.removeMessages(),this.ValueChanged&&a.callFunction(this.ValueChanged,this,e),this.shownItem(i[e].Value),n=this.setValue(a.value(this.shownItem),t,o),a.value(this.Required)&&this.UpdateStatusArea())}return n||(n=$.Deferred()).resolve(),n},o.prototype.getSelectedIndex=function(){var e=a.value(this.SelectedItem);return this.getItemIndex(e)},o.prototype.isMandatoryMet=function(){var e=!0,t=this.selectedLabel();return 0!==a.value(this.shownItem)&&"0"!==a.value(this.shownItem)||void 0!==t&&""!==t||(e=!1),e},o.prototype.selectedLabel=function(){var e=a.value(this.Items);if(e){var t=a.value(this.shownItem),o=e[this.getItemIndex(t)];return o?o.Label:""}},o.prototype.setValue=function(e,t,o){var n=this;void 0===t&&(t=!1),void 0===o&&(o=!1);var i=$.Deferred();if(!o&&!this.allowUserChanges()||!t&&e==a.value(this.SelectedItem)&&a.value(this.IsValid))i.resolve();else if(this.SetSelectedItem){var r=function(e){(e||a.value(n.IsValid))&&a.value(n.shownItem)!==a.value(n.SelectedItem)&&n.shownItem(a.value(n.SelectedItem)),i.resolve()};a.callFunction(this.SetSelectedItem,this,[e],r,null,null,null,function(){r(!0)})}else!t&&e===a.value(this.SelectedItem)||(a.setValue(this,"SelectedItem",e,t),this.IsValid(!0),i.resolve());return i},o.prototype.ApplyState=function(e){var t,o=this;if(e.messages&&0<e.messages.length&&(this.messages=e.messages),void 0!==e.shownItem&&e.shownItem!==a.value(this.shownItem())){var n=this.getItemIndex(e.shownItem),i=this.setSelectedIndex(n,!0,!0);return t=$.Deferred(),i.done(function(){a.value(o.IsValid)?t.resolve():t.reject()}),i}},o.prototype.GetState=function(){return{shownItem:a.value(this.shownItem)}},o.prototype.onSerializeTransitState=function(){var e=JSON.stringify({shownIndex:this.shownIndex()});a.setValue(this,"ClientState",e)},o.prototype.displayedValue=function(){return this.selectedLabel()},o.prototype.displayedValues=function(e){var t={};return e||(t[this.Name]=this.displayedValue()),t},o.prototype.attached=function(){var t=this;r.prototype.attached.call(this),this.shownItem=a.observable(a.value(this.SelectedItem)),this.selectedIndex=a.computed(this.getSelectedIndex,function(e){t.setSelectedIndex(e)},this)},o.prototype.getItemLabelByIndex=function(e){var t=a.value(this.Items);if(t){var o=t[this.getItemIndex(e)];if(o)return o.Label}},o.prototype.getItemIndex=function(e){var t=a.value(this.Items);if(t)for(var o=0,n=t.length;o<n;o++)if(t[o].Value==e)return o;return-1},o.prototype.applyClientState=function(e){void 0!==e.shownIndex&&e.shownIndex!==this.shownIndex()&&this.shownIndex(e.shownIndex)},t=o,(e.EnumControl=t).prototype.ComboType=a.ui.autoValue,t.prototype.SelectedItem=0,t.prototype.Items=null,t.prototype.SetSelectedItem=null,t.prototype.SupportsDefaultAction=!1,t.prototype.recordability=a.util.recordabilityDefault,a.adapter({id:"ListBox",controlType:"EnumControl",template:"ListBox"})}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(n){var e,i,t;function o(){return null!==i&&i.apply(this,arguments)||this}(n.layout||(n.layout={})).radioButtonBinding=function(e){return n.options(function(){return{arrangeMethod:n.layout.ArrangeMethod.vertical,children:e.Items,columns:e.Columns}},e.Updating)},e=n.controls||(n.controls={}),i=e.EnumControl,__extends(o,i),o.prototype.init=function(e,t){var o=this;i.prototype.init.call(this,e,t),n.observe(this.Items,function(e){if(e&&e.length)for(var t=e.length,o=0;o<t;o++)e[o].Visible=!0}),n.observe(this.shownIndex,function(e){n.value(o.isFocused)&&o.$cachedElement.find(".radioButton").eq(e).find("input").focus()})},o.prototype.focusInCallBack=function(){this.isFocused(!0),n.log.focus&&n.log.focus("Focus: RadioButton->focusInCallBack input name: %s",this.Name)},o.prototype.focusOutCallBack=function(){this.isFocused(!1),n.log.focus&&n.log.focus("Focus: RadioButton->focusOutCallBack input name: %s",this.Name)},o.prototype.preRenderCallBack=function(){n.value(this.isFocused)&&(this.wasFocused=!0)},o.prototype.postRenderCallBack=function(){this.wasFocused&&(this.$cachedElement.find("[aria-checked=true]").focus(),this.wasFocused=!1)},o.prototype.getTaskGuideParams=function(e){return(e=i.prototype.getTaskGuideParams.call(this,e)).target=$(this.element),e},t=o,(e.RadioButton=t).prototype.Columns="1"}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(l){!function(e){var i,t=(i=e.EnumControl,__extends(o,i),o.prototype.init=function(e,t){var n=this;i.prototype.init.call(this,e,t),this.$inputElement=this.$cachedElement.find("input"),this.$lookupButton=this.$cachedElement.find(".lookupButton"),this.isFocused=l.observable(!1),this.isExpanded=l.observable(!1),this.IsActive=l.observable(!1);var o=l.value(this.Items);Array.isArray(o)&&(this.filteredItems=l.observableArray(o),l.observe(this.Items,function(e){n.filteredItems(e)})),this.previousIndex=-1,this.listShownIndex=l.observable(l.value(this.shownIndex)),this.isInactiveCell()||(l.observe(this.isExpanded,function(e){e?(n.previousIndex=l.value(n.selectedIndex),n.listShownIndex(n.previousIndex),n.IsActive(!1),l.observe(n.IsActive,function(e){return!e||(window.setTimeout(function(){n.selectedItemScrollIntoView(n.previousIndex)}),!1)},n,void 0,!0),n.$inputElement&&n.$inputElement.length&&(n.$inputElement.attr("aria-activedescendant",n.Id+"_list_item"+l.value(n.selectedIndex)),n.$inputElement.focus())):(n.previousIndex=-1,n.Root&&n.Root.isActiveControl&&n.Root.isActiveControl(n.Name)&&l.microTask(function(){n.$inputElement.focus()}),n.$inputElement&&n.$inputElement.length&&n.$inputElement.removeAttr("aria-activedescendant"))},this,void 0,!0),l.observe(this.listShownIndex,function(e){l.value(n.isExpanded)&&l.value(n.IsActive)&&(n.selectedItemScrollIntoView(e),n.$inputElement.attr("aria-activedescendant",n.Id+"_list_item"+e))}),this.flyoutClickSubscriber=function(e){return!(e.isRightClick||n.$inputElement.is(e.clickTarget)||$(e.clickTarget).parents(".comboBox-list").length)},this.flyoutEscapeSubscriber=function(){l.value(n.isExpanded)&&n.SelectItem(l.value(n.listShownIndex))},l.observe(this.isFocused,function(e){l.value(n.AllowEdit)&&(e?n.StatusIndicator(l.ui.StatusIndicator.none):n.UpdateStatusArea())}),l.observe(this.AllowEdit,function(e){if(l.value(n.IsValid)&&!e){var t=l.value(n.isFocused);n.updatingBlock(function(){l.value(n.isExpanded)&&n.isExpanded(!1),l.value(n.shownItem)!==l.value(n.SelectedItem)&&n.shownItem(l.value(n.SelectedItem)),t&&n.$inputElement.select()})}var o=n.$inputElement.is("[readonly]");o&&e?n.$inputElement.prop("readonly",!1):o||e||n.$inputElement.prop("readonly",!0),l.value(n.Required)&&n.UpdateStatusArea()}),l.observe(this.Enabled,function(e){if(l.value(n.IsValid)&&!e){var o=l.value(n.isFocused);n.updatingBlock(function(){if(l.value(n.isExpanded)&&n.isExpanded(!1),l.value(n.shownItem)!==l.value(n.SelectedItem)&&n.shownItem(l.value(n.SelectedItem)),o&&n.Root&&n.Root.element){var e=$(n.Root.element).find(":tabbable"),t=e.index(n.$inputElement[0]);-1<t&&(t%=e.length,e.eq(t+1).focus(),e.eq(t+1).select())}})}l.value(n.Required)&&n.UpdateStatusArea()}))},o.prototype.getTaskGuideParams=function(e){this._isExpandedObserver||(this._isExpandedObserver=l.observe(this.isExpanded,function(){l.ax&&l.ax.taskGuide&&l.ax.taskGuide.repositionGuidedQtip&&!l.value(l.ax.taskGuide.repositionGuidedQtip)&&l.async(function(){l.ax.taskGuide.repositionGuidedQtip(!0)},0,"reset task guide qtip")})),e=i.prototype.getTaskGuideParams.call(this,e);var t=$(this.element);if(l.value(this.isExpanded)){var o=$('.comboBox-list[data-dyn-lastvisible="true"]');o&&1===o.length&&(t=o)}return e.target=t,e},o.prototype.dispose=function(){this._isExpandedObserver&&(this._isExpandedObserver.dispose(),this._isExpandedObserver=null),i.prototype.dispose.call(this)},o.prototype.hasEmptyItems=function(){var e=l.value(this.Items);return!!e&&e.some(function(e){return""===e.Label.trim()})},o.prototype.clickedItem=function(e){this.TelemetryOptions={inputType:l.telemetry.InputType.mouse},this.SelectItem(e)},o.prototype.onInputClick=function(){this.allowUserChanges()&&this.$lookupButton.click()},o.prototype.focusInCallBack=function(){this.isFocused(!0)},o.prototype.focusOutCallBack=function(t){var o=this;this.updatingBlock(function(){if(o.isFocused(!1),o.isExpanded()){var e=l.flyout.flyoutManager.getTopFlyout();e&&e.flyout&&l.value(e.flyout)&&0<l.value(e.flyout).length&&t.relatedTarget!==l.value(e.flyout)[0]&&o.SelectItem(l.value(o.listShownIndex))}})},o.prototype.onKeyDown=function(e){l.util.handleShortcuts(this,e)},o.prototype.cellRenderer=function(e){return{value:this.SelectedItem&&this.SelectedItem.virtualizer?this.getItemLabelByIndex(this.SelectedItem.virtualizer(e)):this.selectedLabel()}},o.prototype.attached=function(){i.prototype.attached.call(this),this.$inputElement=this.$cachedElement.find("input"),this.$lookupButton=this.$cachedElement.find(".lookupButton"),this.isFocused=l.observable(!1),this.isExpanded=l.observable(!1),this.IsActive=l.observable(!1)},o.prototype.openDropDown=function(e){return!l.value(this.isExpanded)&&this.allowUserChanges()&&(this.TelemetryOptions={inputType:l.telemetry.InputType.keyboard},this.isExpanded(!0),e.preventDefault(),e.stopImmediatePropagation()),!1},o.prototype.HandleTabOut=function(){l.value(this.isExpanded)&&(this.TelemetryOptions={inputType:l.telemetry.InputType.keyboard},this.SelectItem(l.value(this.listShownIndex)))},o.prototype.SelectItem=function(e){var t,o;if(this.filteredItems){var n=l.value(this.filteredItems),i=l.value(this.Items);if(0===n.length||i.length===n.length)this.shownIndex(e);else{var r=null!==(o=null===(t=n[e])||void 0===t?void 0:t.RealIndex)&&void 0!==o?o:e;this.shownIndex(r),this.filteredItems(l.value(this.Items))}}l.value(this.isExpanded)&&this.isExpanded(!1),this.selectedIndex(l.value(this.shownIndex)),this.listShownIndex(l.value(this.shownIndex)),this.$inputElement.val(this.selectedLabel())},o.prototype.selectedItemScrollIntoView=function(e){var t=$(document.body).find('.comboBox-list[data-dyn-lastvisible="true"]'),o=l.value(this.Items);if(0<t.length&&o.length>e&&0<=e){var n="listbox"===t[0].getAttribute("role")?"option":"listitem",i=t.find('li[role="'+n+'"]').eq(e);0<i.length&&i[0].scrollIntoViewIfNeeded(!1)}},o);function o(){return null!==i&&i.apply(this,arguments)||this}(e.ComboBox=t).prototype.LookupButton=!0,t.prototype.CanOpenLookupForm=!1,t.prototype.$lookupButton=null;var n={Enter:{Keys:{keyCode:l.ui.KeyCodes.enter},Handler:function(e){var t=!1;if(l.value(this.isExpanded))this.TelemetryOptions={inputType:l.telemetry.InputType.keyboard},this.SelectItem(l.value(this.listShownIndex)),t=!0;else if(l.util.isFlightEnabled(l.controls.standardizeKeyboardInteractionFeature))return this.openDropDown(e);return t},RecordTelemetry:!1,ShowToUser:!1},AltDownToOpen:{Keys:{alt:!0,keyCode:l.ui.KeyCodes.downArrow},Handler:function(e){return this.openDropDown(e)},RecordTelemetry:!1,ShowToUser:function(){return this.allowUserChanges()},Description:l.label("Input_OpenDropDown")},TabOut:{Keys:{keyCode:l.ui.KeyCodes.tab,isShiftKeyAgnostic:!0},Handler:function(){return this.HandleTabOut(),!1},RecordTelemetry:!1,ShowToUser:!1}};t.prototype.Shortcuts=l.extendPrototype(t.prototype.Shortcuts,n),l.adapter({id:"ComboBoxSummary",controlType:"ComboBox",template:"SummaryField"}),l.adapter({id:"ComboBoxCardCell",controlType:"ComboBox",template:"CardCell"});var r,a=(__extends(s,r=t),Object.defineProperty(s.prototype,"valueNow",{get:function(){return parseInt(this.element.getAttribute("data-dyn-value"),10)},set:function(e){this.element.setAttribute("data-dyn-value",null!=e?e.toString():""),this.shownItem(this.valueNow),this.$inputElement.val(this.selectedLabel())},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"validating",{get:function(){return l.util.stringToBoolean(this.element.getAttribute("data-dyn-validating"))},set:function(e){this.element.setAttribute("data-dyn-validating",null!=e?e.toString():"")},enumerable:!1,configurable:!0}),s.prototype.clickedItem=function(e){this.valueNow=e,this.isExpanded(!1),this.RaiseEvent(l.ui.ChangeEvent,{bubbles:!0})},s.prototype.setSelectedIndex=function(e){if(this.allowUserChanges()){var t=l.value(this.Items);if(t.length>e&&0<=e){var o=t[e].Value;this.shownItem(o),this.valueNow="number"==typeof o?o:parseInt(o,10),this.RaiseEvent(l.ui.ChangeEvent,{bubbles:!0})}}var n=$.Deferred();return n.resolve(),n},s.prototype._requestPopup=function(e){return this._flyout||(this._flyout=l.getTemplateInstance("ComboBoxPopup","ul"),l.dataBind(this._flyout[0],this)),e(this._flyout),this._flyout},s.prototype.focusOutCleanup=function(){this.isExpanded(!1)},s.prototype.ApplyState=function(e){if(e&&null!==e.shownItem&&void 0!==e.shownItem){var t=this.valueNow;e.shownItem!=t&&(this.valueNow=e.shownItem)}var o=$.Deferred();return o.resolve(),o},s.prototype.GetState=function(){return{messages:this.messages,shownItem:this.valueNow}},s.prototype.attached=function(){this._flyout=void 0,r.prototype.attached.call(this),this.shownItem(this.valueNow)},s);function s(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return i.AllowEdit=!0,i}e.ComboBoxCell=a,l.cellAdapter({id:"ComboBox",template:"ComboBoxCell"}),l.cellAdapter({id:"ComboBox",controlType:"ComboBoxCell",template:"ComboBoxCellEditor",type:l.cellTypes.editor})}(l.controls||(l.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(l){!function(e){Globalize.addCultureInfo("en",{messages:{Image_Click:"Click image"}});var o,t=(o=l.ui.Control,__extends(n,o),n.prototype.init=function(e,t){var r=this;o.prototype.init.call(this,e,t),l.observe(this.Value,function(e){var t="",o="",n="",i=[];(r._value=e)&&e.Items&&(e.Items instanceof Array?i=e.Items:e.Items.$values instanceof Array&&(i=e.Items.$values),4===i.length&&2==i[0]?(t=i[1],o=i[2],n=i[3],r._tooltipSetByValue=!0):3===i.length&&1==i[0]?(t=i[1],o=i[2]):1===i.length&&(t=l.ui.ImageType.base64,o=i[0])),r.ImageType(t),r.ImageName(o),r._tooltipSetByValue&&r.Tooltip(n)})},n.prototype.clicked=function(e){l.applyFunction(this.Click,this)},n.prototype.keyDown=function(e){l.util.handleShortcuts(this,e)},n.prototype.imageSizing=function(){return this.isInGrid()?{height:this.LayoutHeight,width:this.LayoutWidth}:{height:l.value(this.Height)===l.layout.Size.available?l.layout.Size.available:l.layout.Size.content,width:l.value(this.Width)===l.layout.Size.available?l.layout.Size.available:l.layout.Size.content}},n.prototype.ApplyState=function(e,t){void 0===t&&(t=!1),e.clicked&&!t&&this.clicked()},n);function n(){return null!==o&&o.apply(this,arguments)||this}(e.Image=t).prototype.IsImage=!0,t.prototype.ShowLabel=!0,t.prototype.Label="",t.prototype.Click=null;var i={EnhancedPreview:{Keys:{alt:!(t.prototype.SupportsDefaultAction=!1),keyCode:l.ui.KeyCodes.upArrow},Handler:function(e){return l.shell.previewManager.enhancedPreviewShortcutHandler(this,e)},RecordTelemetry:!1,ShowToUser:function(){return!(!l.value(this.CanHavePreview)||!l.value(this.RequestEnhancedPreview))},Description:l.label("Input_OpenEnhancedPreview")},KeyboardClick:{Keys:{keyCode:[l.ui.KeyCodes.spacebar,l.ui.KeyCodes.enter]},Handler:function(){l.applyFunction(this.Click,this)},Description:l.label("Image_Click")}};t.prototype.Shortcuts=l.extendPrototype(t.prototype.Shortcuts,i),l.ui.addObservablePropertiesToPrototype(t.prototype,{ImageType:"",ImageName:"",Tooltip:"",Value:null});var r,a=(__extends(s,r=t),s.prototype.queueClickCell=function(){this.cellClicked=!0,this.validating=!0,this.RaiseEvent(l.ui.ReadOnlyEvent,{bubbles:!0})},s.prototype.ResetState=function(){this.cellClicked=!1},s.prototype.GetState=function(){return{clicked:this.cellClicked}},s);function s(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return i.cellClicked=!1,i}e.ImageCell=a,l.cellAdapter({id:"Image"})}(l.controls||(l.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(e){var t,r,o;function n(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return"Value"in i&&(i.Text=i.Value),i}t=e.controls||(e.controls={}),r=e.ui.Control,__extends(n,r),o=n,(t.Label=o).prototype.Text="",o.prototype.Skip=!0,o.prototype.HelpText="",o.prototype.hideTooltipBody=!0}($dyn=$dyn||{}),function(w){var e;(e=w.util||(w.util={})).setupLookupAriaValues=function(n,e){var t,o,i,r,a=document.getElementById(e),s=!0;if(n){if(a){var l=a.getAttribute("data-dyn-form-name"),u=a.getAttribute("data-dyn-clientid"),d=w.context(a),c=!1;if(l){(c=l.endsWith("_SysTL")||l.endsWith("_SysTCL")||l.endsWith("_SysTTL")||"SysQueryFieldLookUp"===l)||w.log("Set lookup aria values for lookup form '(%s)'",l);var p=l+"_"+u+"_"+("SysQueryFieldLookUp"===l?"MainGrid":"Grid"),h=document.getElementById(p);if(!h){var m=null!==(t=w.context(n))&&void 0!==t?t:w.ui.getLiveControl(n);m&&(!(h=w.controls.Edit.prototype.getLookupInteractionTarget.call(m))&&m.ReferenceGroup&&(h=w.controls.Edit.prototype.getLookupInteractionTarget.call(m.ReferenceGroup)),p=null!==(o=null==h?void 0:h.id)&&void 0!==o?o:p)}if(h)if(s=!1,n.setAttribute("aria-haspopup","grid"),d&&d.UseReactGrid()){var v=h.querySelector(".dyn-grid");if(v&&v){var g=v.id+"_grid";null!==(i=n.parentElement)&&void 0!==i&&i.setAttribute("aria-owns",g),n.setAttribute("aria-controls",g);var y=w.context(h);if(y&&y.InternalSelectedRowTrackingId){var f=w.ui.getLiveControl(n);f&&(f.flyoutGridRowObserver=w.observe(y.InternalSelectedRowTrackingId,function(e){window.setTimeout(function(){if(y&&y.getActiveRowIndex){var e=y.getActiveRowAriaNumber().toString();if(e){var t=$(h).find("[aria-rowindex='".concat(e,"']"));if(t&&1===t.length){var o=t.find("[role=gridcell] input");o&&o.length&&n.setAttribute("aria-activedescendant",o[0].id)}}}})}))}}}else{n.setAttribute("aria-controls",p),null!==(r=n.parentElement)&&void 0!==r&&r.setAttribute("aria-owns",p);var b=w.context(n),C=w.context(h);b&&C&&(b.flyoutGridRowObserver=w.observe(C.activeRowDefaultCellId,function(e){n.setAttribute("aria-activedescendant",e)}))}}s=s&&!c}s&&(n.setAttribute("aria-haspopup","dialog"),e&&n.setAttribute("aria-controls",e))}},e.clearLookupAriaValues=function(e,t){var o,n;if(e){if(t){e.setAttribute("aria-expanded","false"),e.setAttribute("aria-activedescendant","");var i=e.getAttribute("aria-haspopup");"grid"===i?(e.removeAttribute("aria-controls"),null!==(o=e.parentElement)&&void 0!==o&&o.removeAttribute("aria-owns")):"dialog"===i&&e.removeAttribute("aria-controls")}else e.removeAttribute("aria-haspopup"),e.removeAttribute("aria-controls"),e.setAttribute("aria-expanded","false"),e.removeAttribute("aria-activedescendant"),e.setAttribute("role","textbox"),null!==(n=e.parentElement)&&void 0!==n&&n.removeAttribute("aria-owns");var r=w.ui.getLiveControl(e);null!=r&&r.flyoutGridRowObserver&&(r.flyoutGridRowObserver.dispose(),r.flyoutGridRowObserver=void 0)}}}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(i){!function(e){Globalize.addCultureInfo("en",{messages:{NavBar_Actions:"Actions",NavBar_Pages:"Pages",NavBar_Search:"Search"}});var t,o=(t=i.ui.Control,__extends(n,t),n.prototype.FocusIn=function(){var t=this;if(this.HasFocus(!0),!this.SelectorObserver){var e=this.SearchSelector();e&&(this.SelectorObserver=i.observe(e.isExpanded,function(e){e&&t.HasFocus(!0)}))}},n.prototype.FocusOut=function(){this.HasFocus(!1)},n.prototype.SearchSelector=function(){if(!this._searchSelector){var e=$(this.element).find(".combinedSearch-selector")[0];e&&(this._searchSelector=i.context(e))}return this._searchSelector},n);function n(){return null!==t&&t.apply(this,arguments)||this}(e.CombinedSearch=o).prototype.SearchOptions=[{Label:i.label("NavBar_Pages"),Value:1},{Label:i.label("NavBar_Actions"),Value:2}],i.ui.addObservablePropertiesToPrototype(o.prototype,{CombinedSearchEnabled:i.debug.combinedSearch,HasFocus:!1,SelectedSearchType:1})}(i.controls||(i.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){!function(e){Globalize.addCultureInfo("en",{messages:{Search_Close:"Close search results",Search_SelectNext:"Select next search result",Search_SelectPrev:"Select previous search result"}});var o,t=(o=r.ui.Control,__extends(n,o),n.prototype.init=function(e,t){o.prototype.init.call(this,e,t),this.ResultList=r.observableArray([])},n.prototype.Placeholder=function(){return""},n.prototype.keyDown=function(e){r.util.handleShortcuts(this,e)},n.prototype.focusOut=function(e){this.SearchField().Value(""),$(this.element).removeClass("combinedSearch-field-no-placeHolder")},n.prototype.nextItem=function(){var e=r.value(this.SelectedIndex)+1,t=r.value(this.ResultList);t&&e>=t.length&&(e=0),this.SelectedIndex(e),this.scrollSelectedResultIntoView(e)},n.prototype.previousItem=function(){var e=r.value(this.SelectedIndex)-1,t=r.value(this.ResultList);e<0&&t&&(e=t.length-1),this.SelectedIndex(e),this.scrollSelectedResultIntoView(e)},n.prototype.openResultPicker=function(){this.SelectedIndex(0),this.ShowResultPicker(!0)},n.prototype.closeResultPicker=function(e){if(this.ProcessResults=!1,this.ShowResultPicker(!1),!e||e.which!==r.ui.KeyCodes.esc){var t=r.shell.getCurrentRootForm(),o=r.context(t);if(o){var n=o.ActiveElementInMainFormContainer();n&&o.form_setFocus(n,o.ActiveElement())}}},n.prototype.scrollSelectedResultIntoView=function(e){var t=$(document).find(".searchResultsFlyout");if(t.length){var o=t.find(".flyout-menuItem").eq(e);o.length&&o[0].scrollIntoView(!1)}},n.prototype.SearchField=function(){return this._searchField||(this._searchField=r.context(this.SearchFieldElement())),this._searchField},n.prototype.SearchFieldElement=function(){return this._searchFieldElement||(this._searchFieldElement=$(this.element).find(".combinedSearch-searchField")[0]),this._searchFieldElement},n);function n(){return null!==o&&o.apply(this,arguments)||this}(e.CombinedSearchField=t).prototype.CanAcquireFocus=!1,t.prototype.ProcessResults=!0,r.ui.addObservablePropertiesToPrototype(t.prototype,{SelectedIndex:0,ShowResultPicker:!1,Visible:!0});var i={DownArrow:{Keys:{keyCode:r.ui.KeyCodes.downArrow},Handler:function(){if(!r.value(this.ShowResultPicker))return!1;this.ProcessResults=!1,this.nextItem()},RecordTelemetry:!1,ShowToUser:function(){return r.value(this.ShowResultPicker)},Description:r.label("Search_SelectNext")},UpArrow:{Keys:{keyCode:r.ui.KeyCodes.upArrow},Handler:function(){if(!r.value(this.ShowResultPicker))return!1;this.ProcessResults=!1,this.previousItem()},RecordTelemetry:!1,ShowToUser:function(){return r.value(this.ShowResultPicker)},Description:r.label("Search_SelectPrev")},Esc:{Keys:{keyCode:r.ui.KeyCodes.esc},Handler:function(e){return!!r.value(this.ShowResultPicker)&&(this.closeResultPicker(e),!0)},RecordTelemetry:!1,ShowToUser:function(){return r.value(this.ShowResultPicker)},Description:r.label("Search_Close")}};t.prototype.Shortcuts=r.extendPrototype(t.prototype.Shortcuts,i)}(r.controls||(r.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(h){!function(e){Globalize.addCultureInfo("en",{messages:{GlobalSearchPlaceholder_Navigation:"Search for a page",Search_SelectPage:"Go to the selected page"}});var t,o=(t=e.CombinedSearchField,__extends(n,t),n.prototype.Placeholder=function(){return h.label("GlobalSearchPlaceholder_Navigation")},n.prototype.TextChanged=function(e){""!==e[0]&&$(this.element.parentNode).addClass("combinedSearch-field-no-placeHolder");var t=this.SearchField;t.textChangedTimerId&&(window.clearTimeout(t.textChangedTimerId),t.textChangedTimerId=void 0),t.textChangedTimerId=window.setTimeout(function(){t.DoNavigationSearch(e[0]),t.textChangedTimerId=void 0},200)},n.prototype.clickItem=function(e){var t=h.value(this.ResultList);e<t.length&&this.NavigateToResult(t[e])},n.prototype.NavigateToResult=function(e){this.navigationToResultEvent(e),this.closeResultPicker();var t=this.createNavigationContext(e);h.DynReact.ModuleStore.startNavigation(t)},n.prototype.DoNavigationSearch=function(d){var c=this;d=d.trim();var e=h.util.stringHasDoubleByte(d);if(!e&&d.length<3||e&&d.length<2)return this.ResultList([]),void(this.lastQuery=d);if(!this.lastQuery||this.lastQuery!==d){var p=performance.now();this.sendQueryRequest(d,function(e){var t,o;c.currentSearchTelemetryInfo={ResponseTime:performance.now()-p,Query:d};var n=[];try{for(var i=__values(e),r=i.next();!r.done;r=i.next()){var a=r.value,s=a.Path;if(0<s.length){var l=s.pop();a.Source.toUpperCase()===c._mainMenu.toUpperCase()?s.shift():a.Source.toUpperCase()===c._workspaceMenu.toUpperCase()&&(s[0]=h.label("NavigationPane_Workspaces"));var u=h.shell.joinArrayWithChevron(s);n.push({Label:l,Path:u,Tag:a.ItemDescription,AOTPath:a.AOTPath})}}}catch(e){t={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}c.lastQuery=d,c.ResultList(n),c.openResultPicker()})}},n.prototype.sendQueryRequest=function(e,t){var o="/navigationsearch/dosearch?query=".concat(encodeURIComponent(e))+"&numberOfResults=".concat(this._numberOfResults.toString())+"&rootMenu=".concat(this._mainMenu)+"&rootMenu=".concat(this._workspaceMenu);$.ajax({url:h.util.resolveVirtualPath(o),type:"GET",cache:!1,beforeSend:function(e){h.serverForm.setCsrfToken(e);var t=h.util.newGuid();e.setRequestHeader(h.serverForm.RequestHeaderKeys.clientSessionKey,h.browserActivity.BrowserSessionActivity.Id),e.setRequestHeader(h.serverForm.RequestHeaderKeys.activityKey,t),h.browserActivity&&h.browserActivity.newInteraction(t),h.ui.PerformanceTimer&&h.ui.PerformanceTimer._addAction("CombinedNavigationSearch"),h.ui.PerformanceTimer&&h.ui.PerformanceTimer._startAjax(t)}}).done(function(e){t(e)}).always(function(){h.ui.PerformanceTimer&&h.ui.PerformanceTimer._stopAjax()})},n.prototype.createNavigationContext=function(e){var t=e.Tag.split(":");return{Label:e.Name,MenuItemName:t[1],MenuItemType:t[0],navigationFeatureName:"searchbox",NavigationPath:e.AOTPath}},n.prototype.navigationToResultEvent=function(e){if(this.currentSearchTelemetryInfo){var t=h.value(this.ResultList).indexOf(e);h.telemetry.addNavigationSearchEvent(this.currentSearchTelemetryInfo.ResponseTime,this.currentSearchTelemetryInfo.Query,t,e.Tag),this.currentSearchTelemetryInfo=void 0}},n);function n(){return null!==t&&t.apply(this,arguments)||this}(e.CombinedNavigationSearch=o).prototype._numberOfResults=10,o.prototype._mainMenu="MainMenu",o.prototype._workspaceMenu="NavPaneMenu";var i={Enter:{Keys:{keyCode:h.ui.KeyCodes.enter},Handler:function(){if(h.value(this.ShowResultPicker)){var e=h.value(this.SelectedIndex);this.clickItem(e)}},RecordTelemetry:!1,ShowToUser:function(){return h.value(this.ShowResultPicker)},Description:h.label("Search_SelectPage")}};o.prototype.Shortcuts=h.extendPrototype(o.prototype.Shortcuts,i),h.adapter({id:"CombinedNavigationSearch",template:"CombinedSearchField"})}(h.controls||(h.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){!function(e){Globalize.addCultureInfo("en",{messages:{GlobalSearchPlaceholder_Action:"Search for an action",Search_PerformAction:"Perform the selected action",Search_ViewResults:"View search results"}});var t,o=(t=e.CombinedSearchField,__extends(n,t),n.prototype.Placeholder=function(){return r.label("GlobalSearchPlaceholder_Action")},n.prototype.TextChanged=function(e){""!==e[0]&&$(this.element.parentNode).addClass("combinedSearch-field-no-placeHolder");var o=this.SearchField;if(o.ProcessResults=!0,this.$inputElement[0].value){var t=r.shell.getCurrentRootForm(),n=r.context(t);n&&r.callFunction(n.ExecuteActionSearch,this,[this.$inputElement[0].value],function(e){if(o.ProcessResults){if(e){var t=JSON.parse(e);t.length&&o.ResultList(t)}else o.ResultList([]);o.openResultPicker()}})}},n.prototype.clickItem=function(e){this.SelectedIndex(e);var t=r.shell.getCurrentRootForm(),o=r.context(t);if(o){var n=r.context(o.ActiveElementInMainFormContainer());n&&r.callFunction(o.UpdateLastSelectedControl,o,[n.Name]);var i=this.ResultList()[e];r.callFunction(o.ExecuteActionSearchClick,o,i.Name),this.closeResultPicker()}},n);function n(){return null!==t&&t.apply(this,arguments)||this}e.CombinedActionSearch=o;var i={Enter:{Keys:{keyCode:r.ui.KeyCodes.enter},Handler:function(){if(0<r.length(this.ResultList))if(r.value(this.ShowResultPicker)){this.ProcessResults=!1;var e=r.value(this.SelectedIndex),t=this.ResultList()[e],o=r.shell.getCurrentRootForm(),n=r.context(o);n&&r.callFunction(n.ExecuteActionSearchClick,this,t.Name),this.closeResultPicker()}else this.openResultPicker()},RecordTelemetry:!1,ShowToUser:function(){return 0<r.length(this.ResultList)},Description:function(){return r.value(this.ShowResultPicker)?r.label("Search_PerformAction"):r.label("Search_ViewResults")}}};o.prototype.Shortcuts=r.extendPrototype(o.prototype.Shortcuts,i),r.adapter({id:"CombinedActionSearch",template:"CombinedSearchField"})}(r.controls||(r.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(m){!function(e){Globalize.addCultureInfo("en",{messages:{GlobalSearch_NavigationHelpText:"(Ctrl+/)",GlobalSearch_NavigationTooltip:"Search for a page",Search_NoResultsMessage:"There are no results for your query"}});var n,t=(n=m.ui.Control,__extends(o,n),Object.defineProperty(o.prototype,"inputBoxElement",{get:function(){var e;return this._inputBoxElement||(this._inputBoxElement=this.element.querySelector("input"),null!==(e=this._inputBoxElement)&&void 0!==e&&e.removeAttribute("aria-describedby")),this._inputBoxElement},set:function(e){this._inputBoxElement=e},enumerable:!1,configurable:!0}),o.prototype.init=function(e,t){var i=this;n.prototype.init.call(this,e,t),this.HasFocus=m.observable(!1),this.mainMenu="MainMenu",this.numberOfResults=10,this.prevCompany=null,this.ResultList=m.observableArray([]),this.ResultPickerOpen=m.observable(!1),this.selectedIndex=m.observable(0),this.workspaceMenu="NavPaneMenu",this.delayBeforeSearch=500,this.flyoutClickSubscriber=function(e){return("input"!==e.clickTarget.tagName.toLowerCase()||!$.contains(i.element,e.clickTarget))&&m.util.flyout.defaultFlyoutClickSubscriber(e)},this.focusin=function(){m.flyout.flyoutManager.removeAllFlyoutsAsync().done(function(){setTimeout(function(){i.inputBoxElement.select(),setTimeout(function(){i.openResultPicker()},50)},50)}),i.HasFocus(!0)},this.focusInput=function(){i.inputBoxElement.focus()},this.focusout=function(){i.HasFocus(!1)},this.keyDown=function(e){var t=e.which;if(t===m.ui.KeyCodes.downArrow||t===m.ui.KeyCodes.upArrow)e.preventDefault();else if(t===m.ui.KeyCodes.tab&&i.ShowResultPicker())i.closeResultPicker();else if(t===m.ui.KeyCodes.enter)e.stopPropagation(),m.log.stopPropagation&&m.log.stopPropagation("Prevent form level Enter shortcut.");else if(t===m.ui.KeyCodes.esc||t===m.ui.KeyCodes.tab){var o=m.context($("#NavigationSearch")[0]),n=m.ui.getNavBar();($(n.element).hasClass("navBarSmall")||$(n.element).hasClass("navBarXSmall")||$(n.element).hasClass("navBarMedium"))&&m.value(o.SearchFieldVisible())&&(o.SearchFieldVisible(!1),document.getElementById("NavigationSearchExpandableControl").focus()),e.stopPropagation(),m.log.stopPropagation&&m.log.stopPropagation("Prevent form level Esc shortcut.")}},this.keyUp=function(e){var t=e.which,o=m.value(i.ShowResultPicker),n=o;t===m.ui.KeyCodes.enter?i.doNavigationSearchAsync(i.inputBoxElement.value).done(function(){i.navigateToResultIndex(m.value(i.selectedIndex))}):m.ui.isPrintableKeyCode(t)?(n=!0,i.ignoredSearchEvent()):t===m.ui.KeyCodes.downArrow?(n=!0,o&&i.nextItem()):t===m.ui.KeyCodes.upArrow&&(n=!0,o&&i.previousItem()),n&&!o&&i.openResultPicker()};var o=this;this.TextChanged=function(e){1===e.length&&(""===e[0]?$(o.element).removeClass("noPlaceHolder"):$(o.element).addClass("noPlaceHolder")),o.textChangedTimerId&&(window.clearTimeout(o.textChangedTimerId),o.textChangedTimerId=void 0),o.textChangedTimerId=window.setTimeout(function(){o.doNavigationSearchAsync(e[0]).done(function(){o.textChangedTimerId=void 0})},o.delayBeforeSearch)},this.ShowResultPicker=m.computed(function(){var e=m.value(i.ResultPickerOpen),t=m.value(i.ResultList),o=t&&0<t.length;return e&&(o||!!i.lastQuery)},function(e){i.ResultPickerOpen(e)}),this.ShowResultPicker.valueChanged.subscribe(function(){if(!m.value(i.ShowResultPicker)&&i.inputBoxElement&&(i.inputBoxElement.removeAttribute("aria-controls"),i.inputBoxElement.removeAttribute("aria-activedescendant")),m.value(i.ShowResultPicker)&&i.inputBoxElement&&(i.inputBoxElement.setAttribute("aria-controls",m.value(i.Id)+"_listbox"),i.inputBoxElement.setAttribute("aria-activedescendant",m.value(i.Id)+"_listbox_item"+m.value(i.selectedIndex))),m.value(m.user)&&m.value(m.user).Company){var e=m.user().Company();if(i.prevCompany!==e&&(i.prevCompany=e,i.prevCompany&&i.lastQuery)){var t=i.lastQuery;i.lastQuery=null,i.doNavigationSearchAsync(t)}}}),m.observe(m.options(function(){return{resultData:i.ResultList,selectedIndex:i.selectedIndex}},this.Updating),function(e){var t,o;0===m.value(e.resultData).length&&m.value(i.ResultPickerOpen)?null!==(t=i.inputBoxElement)&&void 0!==t&&t.setAttribute("aria-description",m.label("Search_NoResultsMessage")):null!==(o=i.inputBoxElement)&&void 0!==o&&o.setAttribute("aria-description","")})},o.prototype.closeResultPicker=function(){this.ShowResultPicker(!1)},o.prototype.NavigateToResult=function(e){this.navigationToResultEvent(e),this.closeResultPicker();var t=this.createNavigationContext(e);m.DynReact.ModuleStore.startNavigation(t)},o.prototype.createNavigationContext=function(e){var t=e.Tag.split(":");return{Label:e.Name,MenuItemName:t[1],MenuItemType:t[0],navigationFeatureName:"searchbox",NavigationPath:e.AOTPath}},o.prototype.doNavigationSearchAsync=function(d){var c=this,p=$.Deferred();d=d.trim();var e=m.util.stringHasDoubleByte(d);if(!e&&d.length<3||e&&d.length<2)return this.lastQuery=void 0,this.ResultList([]),p.resolve(),p;if(this.lastQuery&&this.lastQuery===d)return p.resolve(),p;var h=performance.now();return this.sendQueryRequestAsync(d).done(function(e){var t,o;if(c.HasFocus()){c.currentSearchTelemetryInfo={ResponseTime:performance.now()-h,Query:d};var n=[];try{for(var i=__values(e),r=i.next();!r.done;r=i.next()){var a=r.value,s=a.Path;if(0<s.length){var l=s.pop();a.Source.toUpperCase()===c.mainMenu.toUpperCase()?s.shift():a.Source.toUpperCase()===c.workspaceMenu.toUpperCase()&&(s[0]=m.label("NavigationPane_Workspaces"));var u=m.shell.joinArrayWithChevron(s);n.push({Name:l,Path:u,Tag:a.ItemDescription,AOTPath:a.AOTPath})}}}catch(e){t={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}c.lastQuery=d,c.ResultList(n)}else c.closeResultPicker();p.resolve()}).fail(function(){p.reject()}),p},o.prototype.ignoredSearchEvent=function(){this.currentSearchTelemetryInfo&&(m.telemetry.addNavigationSearchEvent(this.currentSearchTelemetryInfo.ResponseTime,this.currentSearchTelemetryInfo.Query,-1,""),this.currentSearchTelemetryInfo=void 0)},o.prototype.navigateToResultIndex=function(e){var t=m.value(this.ResultList);e<t.length&&this.NavigateToResult(t[e])},o.prototype.navigationToResultEvent=function(e){if(this.currentSearchTelemetryInfo){var t=m.value(this.ResultList).indexOf(e)+1;m.telemetry.addNavigationSearchEvent(this.currentSearchTelemetryInfo.ResponseTime,this.currentSearchTelemetryInfo.Query,t,this.getResultDescription(e)),this.currentSearchTelemetryInfo=void 0}},o.prototype.getResultDescription=function(e){return e.Path+" ("+e.Tag+")"},o.prototype.nextItem=function(){var e=m.value(this.selectedIndex)+1,t=m.value(this.ResultList);t&&e<t.length&&(this.selectedIndex(e),this.inputBoxElement.setAttribute("aria-activedescendant",m.value(this.Id)+"_listbox_item"+e))},o.prototype.openResultPicker=function(){this.HasFocus()&&(this.ShowResultPicker(!0),this.resetSelectedIndex())},o.prototype.previousItem=function(){var e=m.value(this.selectedIndex)-1;0<=e&&(this.selectedIndex(e),this.inputBoxElement.setAttribute("aria-activedescendant",m.value(this.Id)+"_listbox_item"+e))},o.prototype.resetSelectedIndex=function(){var e=m.value(this.Result),t=m.value(this.ResultList);if(m.value(this.ShowResultPicker)&&e&&t)for(var o=0;o<t.length;o++)if(t[o]===e)return void this.selectedIndex(o);this.selectedIndex(0)},o.prototype.sendQueryRequestAsync=function(e){var o=this,t=$.Deferred(),n=m.user().Company(),i=m.value(m.user().Language),r="/navigationsearch/dosearch?query="+encodeURIComponent(e)+"&numberOfResults="+this.numberOfResults.toString()+"&cmp="+n+"&lng="+i+"&rootMenu="+this.mainMenu+"&rootMenu="+this.workspaceMenu;return $.ajax({beforeSend:function(e){m.util.activateLoadingAnimation(o.element),m.serverForm.setCsrfToken(e);var t=m.util.newGuid();e.setRequestHeader(m.serverForm.RequestHeaderKeys.clientSessionKey,m.browserActivity.BrowserSessionActivity.Id),e.setRequestHeader(m.serverForm.RequestHeaderKeys.activityKey,t),m.browserActivity&&m.browserActivity.newInteraction(t),m.ui.PerformanceTimer&&m.ui.PerformanceTimer._addAction("NavigationSearch"),m.ui.PerformanceTimer&&m.ui.PerformanceTimer._startAjax(t)},cache:!1,type:"GET",url:m.util.resolveVirtualPath(r)}).done(function(e){t.resolve(e)}).fail(function(){t.reject()}).always(function(){m.util.removeLoadingAnimation(o.element),m.ui.PerformanceTimer&&m.ui.PerformanceTimer._stopAjax()}),t},o);function o(){return null!==n&&n.apply(this,arguments)||this}(e.SearchBox=t).prototype.ShowOnNavBar=m.observable(!0)}(m.controls||(m.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(a){var e,t;function o(){this.hideHtml="<div class='group-frameOptionButton group-frameOptionButtonHide' role='button' data-dyn-bind=\"ariaExpanded: $data.Expanded, id: $data.Id + '_hide', attr: { 'aria-describedby': $data.Id + '_text' }, title: $dyn.label('Group_ExpandOrCollapse'), enabled: $data.Enabled, skip: $dyn.ui.skip($data), keyDown: $data.keyDown\"></div>",this.radioHtml="<input type='radio' class='group-frameOptionButton group-frameOptionButtonRadio' data-dyn-bind=\"attr: { 'name': ($data._parent && $data._parent.Name) || '', 'aria-labelledby': $data.Id + '_text', 'aria-setsize': ($data.Root && $data.Root.Children && $data.Root.Children()[0] && $data.Root.Children()[0].Children) ? $data.Root.Children()[0].Children().length : 1,'aria-posinset': ($data.Root && $data.Root.Children && $data.Root.Children()[0] && $data.Root.Children()[0].Children && $data.Root.Children()[0].Children().indexOf($data) > -1) ? ($data.Root.Children()[0].Children().indexOf($data) + 1) : 1 },checked: $dyn.value($data.FrameOptionValue), id: $data.Id + '_radio', enabled: $dyn.value($data.EnabledButton),skip: $dyn.ui.skip($data), title: $data.Label\" >",this.checkHtml="<div data-dyn-role=\"CheckBox\" class='group-frameOptionButton group-frameOptionButtonCheck' data-dyn-bind=\"Value: $data.FrameOptionValue, toggleValue: $data.handleCheckBoxToggleValue, Style: 'Checkbox', Enabled: $data.EnabledButton, Name: $data.Name + '_FrameOptionCheckBox',Label: $data.Label, ShowLabel: false\"></div>"}!function(e){Globalize.addCultureInfo("en",{messages:{Group_Collapse:"Collapse group",Group_Expand:"Expand group",Group_ExpandOrCollapse:"Expand or collapse",Group_Select:"Select group",Group_Unselect:"Unselect group"}});var o,t=(o=a.ui.Container,__extends(n,o),Object.defineProperty(n.prototype,"Expanded",{get:function(){var e=a.value(this.FrameOptionValue);return a.value(this.FrameOptionButton)!==a.ui.FrameOptionButton.Hide||1===e||"1"===e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"IsBreakable",{get:function(){return!(!a.value(this.Breakable)||a.value(this.FrameOptionButton)!==a.ui.FrameOptionButton.None||a.value(this.LayoutArrangeMethod)!==a.layout.ArrangeMethod.vertical||"1"!==a.value(this.LayoutColumns)&&a.value(this.LayoutColumns)!==a.layout.Columns.balanced)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"FrameOptionCSS",{get:function(){var e=!1;return a.value(this.FrameOptionButton)!==a.ui.FrameOptionButton.None&&(e=!0),e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hasNoCaptionCSS",{get:function(){var e=!1;if(a.value(this.FrameOptionButton)===a.ui.FrameOptionButton.None)if("None"===a.value(this.FrameType))e=!0;else{var t=a.value(this.Label);e=!(t&&0<t.length)}return e},enumerable:!1,configurable:!0}),n.prototype.init=function(e,t){var r=this;o.prototype.init.call(this,e,t),this.HasFocus=a.observable(!1),this.LayoutColumns=a.ui.columnsProperty(a.layout.Columns.balanced,this),this.TabularControlLabelId=a.observable(""),this.IsTabularControl=a.observable(!1),this._IsTabularRow=a.observable(!1),t&&(this._IsTabularRow("tabularFields_row"===this.ExtendedStyle),this.IsTabularControl("tabularFields"===this.ExtendedStyle||"tabularFields_title"===this.ExtendedStyle||a.value(this._IsTabularRow))),this.EnabledButton=a.computed(function(){return a.value(r.Enabled)&&!a.value(r.IsViewMode)}),this.LayoutWidth=a.computed(function(){var e=a.value(r.Width),t=a.value(r.LayoutColumns);return e===a.ui.autoValue&&(e=a.layout.Size.content),e===a.layout.Size.content&&t===a.layout.Columns.balanced&&(e=a.layout.Size.available),e},function(e){a.setValue(r,"Width",e)}),this.focusin=function(){r.HasFocus(!0)},this.focusout=function(){r.HasFocus(!1)},a.observe(this.IsTabularControl,function(e){if(r.element&&e){if($(r.element).hasClass("tabularFields_title")){var t=a.value(r._IsTabularRow)?".tabularFields_rowLabel":".tabularFields_titleText",o=$(r.element).find(t)[0];if(o&&o.id)a.value(r._IsTabularRow)?r.TabularControlLabelId(o.id):r._parent.TabularControlLabelId(o.id);else if(o){var n=r._parent.Id;a.value(r._IsTabularRow)?r.TabularControlLabelId(n.replace(r._parent.Name,o.getAttribute("data-dyn-controlname"))):r._parent.TabularControlLabelId(n.replace(r._parent.Name,o.getAttribute("data-dyn-controlname")))}}if(a.value(r._IsTabularRow)){$(r.element).find(".tabularFields_secondaryColLabel")[0]&&r.element.classList.add("tabularFields_secondaryHeader");var i=$(r.element).prevAll(".tabularFields_secondaryHeader")[0];(i=i||$(r.element).prevAll(".tabularFields_rowHeader")[0])&&i.id&&(r.$tabularHeaderElement=$(i))}}}),a.observe(this.FrameOptionButton,function(e){if(r.element){var t=void 0;switch(e){case a.ui.FrameOptionButton.Hide:case a.ui.FrameOptionButton.Radio:t=".group-frameOptionButton";break;case a.ui.FrameOptionButton.Check:t=".checkBox",(n=r).handleCheckBoxToggleValue=function(e){if(this.allowUserChanges()){var t=a.value(this.formattedValue);this.formattedValue(this.computeToggleValue(t));var o=a.value(this.formattedValue);"boolean"==typeof o&&(o=o?1:0),n.ChangeFrameOptionValue(o),e.stopPropagation()}};break;case a.ui.FrameOptionButton.None:a.util.isEnhancedTabSequenceEnabled()&&a.value(r.Label)&&(t=".group_title")}t?r.element.setAttribute("data-dyn-focus",t):r.element.hasAttribute("data-dyn-focus")&&r.element.removeAttribute("data-dyn-focus")}var n}),this._processZoomWidthChanges(a.value(a.shell.zoomModeWidth))},n.prototype.ChangeFrameOptionValue=function(e){a.setValue(this,"FrameOptionValue",e),a.applyFunction(this.FrameOptionValueChanged,this),a.ax.personalizationUtil&&a.ax.personalizationUtil.forceUpdateFormPersonalizationData()},n.prototype.getHeader=function(){var e=$(this.element);if(e.length)return e.find(".group_header")[0]},n.prototype.getFrameOptionButton=function(){var e=$(this.element);if(e.length)return e.find(".group-frameOptionButton")[0]},n.prototype.isControlAvailableForExpando=function(){return!(!this.FrameOptionButton||a.value(this.FrameOptionButton)!==a.ui.FrameOptionButton.Hide)},n.prototype.getExpandoPersonalizationFocusTarget=function(){var e;return this.isControlAvailableForExpando()&&(e=$(this.getFrameOptionButton())),e},n.prototype.getTaskGuideParams=function(e){return e=o.prototype.getTaskGuideParams.call(this,e),a.value(this.FrameOptionButton)!==a.ui.FrameOptionButton.None&&(e.target=$(this.getHeader())),e},n.prototype.keyDown=function(e){a.util.handleShortcuts(this,e)},n.prototype.HeaderClicked=function(){var e=a.value(this.FrameOptionButton);e===a.ui.FrameOptionButton.Radio&&a.value(this.FrameOptionValue)||!a.value(this.Enabled)||a.value(this.IsViewMode)&&e!==a.ui.FrameOptionButton.Hide||(a.value(this.FrameOptionValue)?this.ChangeFrameOptionValue(0):this.ChangeFrameOptionValue(1))},n.prototype.getLabelForId=function(){var e="";switch(a.value(this.FrameOptionButton)){case a.ui.FrameOptionButton.Hide:e="_hide";break;case a.ui.FrameOptionButton.Radio:e="_radio";break;case a.ui.FrameOptionButton.Check:e="_FrameOptionCheckBox_check"}return e},n);function n(){return null!==o&&o.apply(this,arguments)||this}(e.Group=t).prototype.bindUpdate=!0,t.prototype.FrameOptionValueChanged=null,a.ui.addPropertiesToPrototype(t.prototype,{ArrangeMethod:{defaultValue:a.ui.autoValue,observable:!0},Breakable:{defaultValue:!0,observable:!0},Columns:{defaultValue:"1",observable:!0},FrameType:{defaultValue:a.ui.autoValue,observable:!0},Label:{defaultValue:"",observable:!0},Style:{defaultValue:a.ui.autoValue,observable:!0}}),a.ui.addObservablePropertiesToPrototype(t.prototype,{FrameOptionButton:a.ui.FrameOptionButton.None,FrameOptionValue:1});var i={ToggleExpansion:{Keys:{keyCode:[a.ui.KeyCodes.enter,a.ui.KeyCodes.spacebar]},Handler:function(e){if(e.target!==this.getFrameOptionButton())return!1;this.HeaderClicked()},RecordTelemetry:!1,ShowToUser:function(e){var t=!1;if(a.value(this.Enabled)&&e===this.getFrameOptionButton()){var o=a.value(this.FrameOptionButton);o===a.ui.FrameOptionButton.None||a.value(this.IsViewMode)||(t=o!==a.ui.FrameOptionButton.Radio||!this.Expanded)}return t},Description:function(){var e="",t=a.value(this.FrameOptionButton);return this.Expanded?t===a.ui.FrameOptionButton.Hide?e=a.label("Group_Collapse"):t===a.ui.FrameOptionButton.Check&&(e=a.label("Group_Unselect")):t===a.ui.FrameOptionButton.Hide?e=a.label("Group_Expand"):t!==a.ui.FrameOptionButton.Check&&t!==a.ui.FrameOptionButton.Radio||(e=a.label("Group_Select")),e}}};t.prototype.Shortcuts=a.extendPrototype(t.prototype.Shortcuts,i),a.adapter({id:"ButtonGroup",controlType:"Group",template:"Group"}),a.adapter({id:"ActionGroup",controlType:"Group",template:"ActionGroup"})}(a.controls||(a.controls={})),e=a.bindingHandlers||(a.bindingHandlers={}),o.prototype.invoke=function(e,t){var o,n;switch(t){case a.ui.FrameOptionButton.Hide:o=$(a.bindingHandlers.groupButton.hideHtml),n="group-frameOptionButtonHide";break;case a.ui.FrameOptionButton.Radio:o=$(a.bindingHandlers.groupButton.radioHtml),n="group-frameOptionButtonRadio";break;case a.ui.FrameOptionButton.Check:o=$(a.bindingHandlers.groupButton.checkHtml),n="group-frameOptionButtonCheck";break;default:a.logWarning("Incorrect value: "+t+" may have been provided to groupButton binding handler")}var i=$(e).children(".group-frameOptionButton."+n);if(o&&0===i.length){0<$(e).children(".group-frameOptionButton").length&&$(e).children(".group-frameOptionButton").detach(),$(e).prepend(o);var r=a.context(e);a.dataBind(o[0],r)}},t=o,e.groupButton=new t}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(a){var e,n,t;function o(){return null!==n&&n.apply(this,arguments)||this}e=a.controls||(a.controls={}),n=a.ui.Container,__extends(o,n),o.prototype.init=function(e,o){var t=this;n.prototype.init.call(this,e,o),this._hasActions=a.observable(!1),this._hasNotes=a.observable(!1),this._hasImage=a.observable(!1),this._hasSymbol=a.observable(!1),this._hasCaption=a.observable(!1),this._hasFooter=a.observable(!1),this._hasHeading=a.observable(!1),this.image=a.observable(!1),this.childrenChanged=!0,$(o).find(".image")[0]&&$(o).addClass("cardOptionalImage"),$(o).find(".businessCard_notes")[0]&&$(o).addClass("cardOptionalNotes"),a.observe(this.Children,function(){t.childrenChanged=!0}),this.HasImage=a.computed(function(){return t.EvaluateChildren(),t._hasImage()}),this.HasHeading=a.computed(function(){return t.EvaluateChildren(),t._hasHeading()}),this.HasCaption=a.computed(function(){return t.EvaluateChildren(),t._hasCaption()}),this.HasSymbol=a.computed(function(){return t.EvaluateChildren(),t._hasSymbol()}),a.observe(this._hasImage,function(e){var t=$($(o).parents(".listItem")[0]);t&&(e?($(o).hasClass("ThumbnailCard")?(t.addClass("listItemThumbnailCard"),t.removeClass("listItemImageCard")):(t.addClass("listItemImageCard"),t.removeClass("listItemThumbnailCard")),t.removeClass("listItemCard")):(t.addClass("listItemCard"),t.removeClass("listItemImageCard"),t.removeClass("listItemThumbnailCard")))}),this.HasFooter=a.computed(function(){return t.EvaluateChildren(),t._hasFooter()}),this.HasActions=a.computed(function(){return t.EvaluateChildren(),t._hasActions()}),this.HasNotes=a.computed(function(){return t.EvaluateChildren(),t._hasNotes()})},o.prototype.EvaluateChildren=function(){var t,e;if(this.childrenChanged){this.childrenChanged=!1,this._hasImage(!1),this._hasSymbol(!1),this._hasCaption(!1),this._hasFooter(!1),this._hasActions(!1),this._hasNotes(!1),this._hasHeading(!1);var o=a.value(this.Children);if(o)try{for(var n=__values(o),i=n.next();!i.done;i=n.next()){var r=i.value;"Image"!==r.TypeName&&"ImageCell"!==r.TypeName||(a.isObservable(r.Skip)?r.Skip(!0):r.Skip=!0),a.util.isEnhancedTabSequenceEnabled()&&(a.isObservable(r.Skip)?r.Skip(!1):r.Skip=!1),"Image"!==r.TypeName&&"ImageCell"!==r.TypeName||(this._hasImage(!0),0===$(r.element).find(".imageBinder-image").length&&this._hasSymbol(!0)),$(r.element).hasClass("ImageCaption")&&this._hasCaption(!0),$(r.element).hasClass("Heading")&&this._hasHeading(!0),($(r.element).hasClass("Footer1")||$(r.element).hasClass("Footer2"))&&this._hasFooter(!0),$(r.element).hasClass("toolbar")&&this._hasActions(!0),$(r.element).hasClass("businessCard_notes")&&this._hasNotes(!0)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}}},t=o,e.Card=t}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(l){!function(e){Globalize.addCultureInfo("en",{messages:{Pivot_nthTab:"Move to the nth tab"}});var o,t=(o=l.ui.Container,__extends(n,o),n.prototype.init=function(e,t){var r=this;o.prototype.init.call(this,e,t),this.LayoutWidth=l.ui.tabWidth(this),this.LayoutHeight=l.ui.tabHeight(this),this.LayoutMinHeight={minSizeFunction:l.layout.gridLayoutMinHeight,cssClassArgument:"pivot-container"},this.activeItemName=l.computed(function(){var e=l.value(r.ActiveItemName);if(!e){var t=l.value(r.Children);t&&0<t.length&&(e=t[0].Name)}return e},function(e){l.setValue(r,"ActiveItemName",e)}),l.isObservable(this.ActiveItemName)&&(this.ActiveItemName.__skipFirstTimeFire=!0),!l.value(this.IsPageView)||!t||t.getAttribute("data-dyn-excludeFromHistory")||e.Root instanceof l.controls.Popup||e.Root instanceof l.controls.Dialog||(l.observe(this.ActiveItemName,function(){l.shell.browserHistory.changePivot(r)}),l.shell.browserHistory.addPivot(this)),l.value(this.Style)===l.ui.TabStyle.vertical&&l.value(this.Width)===l.layout.Size.content&&(this._partCreatedHandler=function(e,t){if(r.Root.IsActive()){var o=$(t.element),n=o.closest(".pivot-container");if($(r.element).is(n)){var i=o.parents(".pivot-content");l.context(i[0]).animateWidthResize(r)}}},$(document.body).on(l.forms.Events.partCreated,this._partCreatedHandler))},n.prototype.dispose=function(){this._partCreatedHandler&&$(document.body).off(l.forms.Events.partCreated,this._partCreatedHandler),o.prototype.dispose.call(this)},n.prototype.keyDown=function(e){l.util.handleShortcuts(this,e)},n.prototype.FocusedItem=function(){var t,e,o,n=l.value(this.Children);if(n)try{for(var i=__values(n),r=i.next();!r.done;r=i.next()){var a=r.value,s=a.getHeader();if(document.activeElement===s){o=a;break}}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return o},n.prototype.NavigateTab=function(e){if(l.value(this.ShowHeaders)){var t=l.value(this.Children);if(t){var o=this.activeItemName(),n=this._getTargetTabIndexFromTabName(o,e);if(void 0!==n)return t[n].Activate(),!0}}return!1},n.prototype.ChangeTabHeaderFocus=function(e){if(l.value(this.ShowHeaders)&&e){var t=this.FocusedItem();if(t){var o=t.Name,n=this._getTargetTabIndexFromTabName(o,e);if(void 0!==n){var i=l.value(this.Children);if(i)return i[n].FocusHeader(),!0}}}return!1},n.prototype.Navigate_nth_TabPage=function(e){if(l.value(this.ShowHeaders)){var t=l.value(this.Children),o=t.length;if(0<=e&&e<o)for(var n=0,i=0;i<o;i++)if(l.value(t[i].Visible)){if(n===e)return t[i].Activate(),!0;n++}}return!1},n.prototype._getNextOrPreviousTabIndex=function(e,t){var o,n=l.value(this.Children);if(n){var i=n.length;o=((e+t)%i+i)%i}return o},n.prototype._getCurrentTabIndexFromTabName=function(e){var t,o=l.value(this.Children);if(o)for(var n=0;n<o.length;n++)if(o[n].Name===e){t=n;break}return t},n.prototype._getTargetTabIndexFromTabName=function(e,t){var o,n=l.value(this.Children);if(n){var i=this._getCurrentTabIndexFromTabName(e);if(void 0!==i&&void 0!==(o=this._getNextOrPreviousTabIndex(i,t)))for(;!l.value(n[o].Visible);)o=this._getNextOrPreviousTabIndex(o,t)}return o},n);function n(){return null!==o&&o.apply(this,arguments)||this}(e.PivotBase=t).prototype.ShowHeaders=!0,t.prototype.ActiveItemName="",t.prototype.IsPageView=!1,t.prototype.Width=l.layout.Size.available,t.prototype.Height=l.layout.Size.available;var i={nthTab:{Keys:{alt:!0,shift:!0,keyCode:l.ui.KeyCodes.numbers},Handler:function(e){var t=e.which-l.ui.KeyCodes.Number1;return this.Navigate_nth_TabPage(t)},ShowToUser:function(){return l.value(this.ShowHeaders)},Description:l.label("Pivot_nthTab"),Category:l.ui.ShortcutCategory.Navigate}};t.prototype.Shortcuts=l.extendPrototype(t.prototype.Shortcuts,i)}(l.controls||(l.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(h){!function(e){Globalize.addCultureInfo("en",{messages:{Pivot_NextButton:"Next",Pivot_NextTab:"Move to the next tab",Pivot_PreviousButton:"Previous",Pivot_PrevTab:"Move to the previous tab"}});var p,t=(p=e.PivotBase,__extends(o,p),o.prototype.init=function(e,t){var r=this;p.prototype.init.call(this,e,t);var i,a,s,o,n,l=$(t),u=!1,d=!1,c=!1;this._defineVariables=function(){r.element&&(i=i||r.element.querySelector(".pivot-list"),s=h.util.isRTLMode()&&!u?(u=u||!(s=a=void 0),a=a||r.element.querySelector(".pivot-listOverflowPrevious"),s||r.element.querySelector(".pivot-listOverflowNext")):(a=a||r.element.querySelector(".pivot-listOverflowNext"),s||r.element.querySelector(".pivot-listOverflowPrevious")))},this._updateOverflow=function(){if(r._defineVariables(),null!=i){var e=i.scrollWidth,t=i.offsetWidth,o=i.scrollLeft;0!==e&&(t<e?(l.addClass("pivot-list-hasOverflow"),0===o?(s.setAttribute("disabled","true"),a.removeAttribute("disabled")):(e-t-1<=o?a.setAttribute("disabled","true"):a.removeAttribute("disabled"),s.removeAttribute("disabled"))):(l.removeClass("pivot-list-hasOverflow"),$(i).animate({scrollLeft:0},167)))}},this._scrollTablistRight=function(){r._defineVariables();var e=i.scrollWidth,t=i.offsetWidth,o=e-t-100,n=i.scrollLeft;n<o?(n+=100,$(i).animate({scrollLeft:n},167),s.removeAttribute("disabled")):o<=n&&(n=e-t,$(i).animate({scrollLeft:n},167),c||(a.setAttribute("disabled","true"),s.removeAttribute("disabled")))},this._scrollTablistLeft=function(){r._defineVariables();var e=i.scrollLeft;100<e?(e-=100,$(i).animate({scrollLeft:e},167),a.removeAttribute("disabled")):(c||(s.setAttribute("disabled","true"),a.removeAttribute("disabled")),$(i).animate({scrollLeft:0},167))},this._updateScrollLoc=function(){r._defineVariables();var e=i.scrollWidth,t=i.offsetWidth;if(d){var o=$(i).scrollLeft();o+t<e?(s.removeAttribute("disabled"),a.removeAttribute("disabled"),o<=25&&s.setAttribute("disabled","true")):a.setAttribute("disabled","true")}},this._mouseWheelScroll=function(e){r._defineVariables(),e=window.event||e;var t=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail)),o=i.scrollLeft,n=i.scrollWidth-i.offsetWidth-1;o+=100*t,$(i).animate({scrollLeft:o},167),o<=0?(s.setAttribute("disabled","true"),a.removeAttribute("disabled")):o<n?(s.removeAttribute("disabled"),a.removeAttribute("disabled")):a.setAttribute("disabled","true"),event.preventDefault()},this._manualScrollOn=function(){d=!0},this._manualScrollOff=function(){d=!1},this._mouseDownRight=function(){c=!0,o=window.setInterval(function(){r._scrollTablistRight()},200)},this._mouseDownLeft=function(){c=!0,o=window.setInterval(function(){r._scrollTablistLeft()},200)},this._mouseUp=function(){c=!1,clearInterval(o)},this.usingDisposable(h.layout.registerEndReflowHandler(this.element,function(){n&&n.cancel(),n=h.async(function(){r._updateOverflow(),n=void 0})})),$(window).on("resize",this._updateOverflow),null!=i&&(i.addEventListener("touchstart",this._manualScrollOn),i.addEventListener("touchend",this._manualScrollOff),i.addEventListener("mousewheel",this._mouseWheelScroll),$(i).on("scroll",this._updateScrollLoc)),this.headerKeyDown=function(e){var t=h.util.isRTLMode()?h.ui.KeyCodes.leftArrow:h.ui.KeyCodes.rightArrow,o=h.util.isRTLMode()?h.ui.KeyCodes.rightArrow:h.ui.KeyCodes.leftArrow,n=!1;if(h.util.isShortcutKeyPressed(e,{keyCode:t}))r.ChangeTabHeaderFocus(1),n=!0;else if(h.util.isShortcutKeyPressed(e,{keyCode:o}))r.ChangeTabHeaderFocus(-1),n=!0;else if(h.util.isShortcutKeyPressed(e,{keyCode:[h.ui.KeyCodes.enter,h.ui.KeyCodes.spacebar]})){var i=r.FocusedItem();i&&(i.Activate(),n=!0)}else r.keyDown(e);n&&e&&e.stopPropagation&&e.stopPropagation()}},o.prototype.dispose=function(){if($(window).off("resize",this._updateOverflow),this.element){var e=this.element.querySelector(".pivot-list");e&&(e.removeEventListener("touchstart",this._manualScrollOn),e.removeEventListener("touchend",this._manualScrollOff),e.removeEventListener("mousewheel",this._mouseWheelScroll),$(e).off("scroll",this._updateScrollLoc))}p.prototype.dispose.call(this)},o.prototype.MoveRight=function(){h.util.isRTLMode()?this._scrollTablistLeft():this._scrollTablistRight()},o.prototype.MoveLeft=function(){h.util.isRTLMode()?this._scrollTablistRight():this._scrollTablistLeft()},o.prototype.MoveRightContinue=function(){h.util.isRTLMode()?this._mouseDownLeft():this._mouseDownRight()},o.prototype.MoveLeftContinue=function(){h.util.isRTLMode()?this._mouseDownRight():this._mouseDownLeft()},o.prototype.MouseUp=function(){this._mouseUp()},o);function o(){return null!==p&&p.apply(this,arguments)||this}e.Pivot=t;var n={RightTab:{Keys:{alt:!0,shift:!0,keyCode:h.ui.KeyCodes.rightArrow},Handler:function(){var e=h.util.isRTLMode()?-1:1;return this.NavigateTab(e)},ShowToUser:function(){return h.value(this.ShowHeaders)},Description:function(){return h.util.isRTLMode()?h.label("Pivot_PrevTab"):h.label("Pivot_NextTab")},Category:h.ui.ShortcutCategory.Navigate},LeftTab:{Keys:{alt:!0,shift:!0,keyCode:h.ui.KeyCodes.leftArrow},Handler:function(){var e=h.util.isRTLMode()?1:-1;return this.NavigateTab(e)},ShowToUser:function(){return h.value(this.ShowHeaders)},Description:function(){return h.util.isRTLMode()?h.label("Pivot_NextTab"):h.label("Pivot_PrevTab")},Category:h.ui.ShortcutCategory.Navigate}};t.prototype.Shortcuts=h.extendPrototype(t.prototype.Shortcuts,n)}(h.controls||(h.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(u){!function(e){var o,t=(o=e.PivotBase,__extends(n,o),n.prototype.init=function(e,t){var n=this;o.prototype.init.call(this,e,t),this.DropListVisual=u.observable(!1),this._activeTabIndex=0,u.isObservable(this.MenuDisplayed)||(this.MenuDisplayed=u.observable(this.MenuDisplayed)),u.isObservable(this.ShownIndex)||(this.ShownIndex=u.observable(this.ShownIndex)),this.ActiveItemLabel=u.computed(function(){var e=n.ActiveItem();return e?u.value(e.Label):void 0}),this.headerKeyDown=function(e){var t=!1;if(u.util.isShortcutKeyPressed(e,{keyCode:u.ui.KeyCodes.downArrow}))n.ChangeTabHeaderFocus(1),t=!0;else if(u.util.isShortcutKeyPressed(e,{keyCode:u.ui.KeyCodes.upArrow}))n.ChangeTabHeaderFocus(-1),t=!0;else if(u.util.isShortcutKeyPressed(e,{keyCode:u.ui.KeyCodes.enter})){var o=n.FocusedItem();o&&o.Activate()}else n.keyDown(e);t&&e&&e.stopPropagation&&e.stopPropagation()},this._zoomModeWidthObserver=u.observe(u.shell.zoomModeWidth,function(e){e?n.DropListVisual(!0):n.DropListVisual(!1)})},n.prototype.dispose=function(){this._zoomModeWidthObserver&&this._zoomModeWidthObserver.dispose(),o.prototype.dispose.call(this)},n.prototype.UpdateInitialShownIndex=function(){this.ShownIndex(this._activeTabIndex),this.MenuDisplayed(!0)},n.prototype.ActiveItem=function(){var t,e,o,n=this.activeItemName(),i=u.value(this.Children),r=0;try{for(var a=__values(i),s=a.next();!s.done;s=a.next()){var l=s.value;l.Name===n&&(o=l,this._activeTabIndex=r),r++}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}return o},n);function n(){return null!==o&&o.apply(this,arguments)||this}e.VerticalTabs=t;var i={NextTab:{Keys:{alt:!0,shift:!0,keyCode:u.ui.KeyCodes.downArrow},Handler:function(){return this.NavigateTab(1)},ShowToUser:function(){return u.value(this.ShowHeaders)},Description:u.label("Pivot_NextTab"),Category:u.ui.ShortcutCategory.Navigate},PreviousTab:{Keys:{alt:!0,shift:!0,keyCode:u.ui.KeyCodes.upArrow},Handler:function(){return this.NavigateTab(-1)},ShowToUser:function(){return u.value(this.ShowHeaders)},Description:u.label("Pivot_PrevTab"),Category:u.ui.ShortcutCategory.Navigate}};t.prototype.Shortcuts=u.extendPrototype(t.prototype.Shortcuts,i)}(u.controls||(u.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(l){var e,n,t;function o(){return null!==n&&n.apply(this,arguments)||this}e=l.controls||(l.controls={}),n=e.PivotBase,__extends(o,n),o.prototype.init=function(e,t){var o=this;n.prototype.init.call(this,e,t),this.ActiveItemLabel=l.computed(function(){var e=o.ActiveItem();return e?l.value(e.Label):void 0})},o.prototype.ActiveItem=function(){var t,e,o,n=this.activeItemName(),i=l.value(this.Children);try{for(var r=__values(i),a=r.next();!a.done;a=r.next()){var s=a.value;s.Name===n&&(o=s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return o},t=o,e.DropList=t}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(l){var e,r,t;function o(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return l.isObservable(i.PanelStyle)||(i.PanelStyle=l.observable(i.PanelStyle)),i}e=l.controls||(l.controls={}),r=l.ui.Container,__extends(o,r),o.prototype.init=function(e,t){var o=this;r.prototype.init.call(this,e,t),this.isActive=l.computed(function(){return o._parent.activeItemName()===o.Name}),this.LayoutColumns=l.ui.columnsProperty(l.layout.Columns.balanced,this),this.LayoutWidth=l.ui.tabWidth(this),this.LayoutHeight=l.ui.tabHeight(this),l.observe(this.LayoutColumns,function(e){1<e&&o.IsInNewWizard&&l.setValue(o,"LayoutColumns",1)}),!this.Root||l.value(this.Root.Style)!==l.forms.Styles.DetailsFormMaster&&l.value(this.Root.Style)!==l.forms.Styles.DetailsFormTransaction||l.observe(this.isActive,function(e){e&&o.Root.changeDetailsViewElement(o._parent,o.Name)}),this._processZoomWidthChanges(l.value(l.shell.zoomModeWidth))},o.prototype.getHeader=function(){var e,t=$(this.element);if(t){var o=t.siblings(".pivot-header");o.length&&(e=o.children().find('[data-dyn-mappedTab="'+l.value(this.Name)+'"]')[0]);var n=t.siblings(".pivot-dropListMenu");n.length&&(e=n.children(".dynamicsButton")[0])}return e},o.prototype.getPersonalizableTarget=function(){return this.getHeader()},o.prototype.getExpandoPersonalizationFocusTarget=function(){return $(this.getHeader())},o.prototype.isControlAvailableForExpando=function(){return!0},o.prototype.getParent=function(){return this._parent},o.prototype.getTaskGuideParams=function(e){var t=this.getHeader();return $.extend(e,{adjustMethod:"flip",at:l.layout.qTipPosition.bottomCenter,my:l.layout.qTipPosition.topCenter,target:t?$(t):$(this.element)}),e},o.prototype.getPersonalizationElements=function(){var e=[this.element],t=this.getHeader();return t&&e.unshift(t),e},o.prototype.animateWidthResize=function(a){var s=this;l.observe(l.clientBusy,function(e){if(e)return!0;var t=s.Children();if(1===t.length&&"Part"===t[0].TypeName){var o=$(a.element),n=parseInt(l.ui.theme.get().margin,10),i=$(s.element).outerWidth(),r=o.hasClass("verticalTab")?$(s.getHeader()).outerWidth()+n:0;o.animate({width:r+i+"px"},l.ui.motionTiming.basic,function(){o.css("width","")})}return!1})},o.prototype.Activate=function(e){e&&e.target&&$(e.target).parents(".NewWizard").length||(l.value(this.isActive)||(this.ActivateTabInternal(),this.scrollIntoView(),l.callFunction(this.ActivateTab,this,[])),l.ax.personalizationUtil&&l.ax.personalizationUtil.forceUpdateFormPersonalizationData())},o.prototype.FocusHeader=function(){var e=this.getHeader();e&&e.focus()},o.prototype.focusCallback=function(){var e=this.getHeader?this.getHeader():void 0;e&&l.util.focusElement(e)},o.prototype.scrollIntoView=function(){var e=this.getHeader?this.getHeader():void 0,t=!!$(this.element.parentElement).hasClass("pivot-list-hasOverflow");if(void 0!==e&&t){var o=e.offsetLeft,n=e.offsetWidth,i=e.parentElement,r=i.offsetWidth,a=i.scrollWidth-r-1,s=i.scrollLeft,l=i.parentElement.querySelector(".pivot-listOverflowNext"),u=i.parentElement.querySelector(".pivot-listOverflowPrevious"),d=2*$(l).outerWidth();if(o<s+d){var c=o-d;$(i).scrollLeft(c),o-d==0?u.setAttribute("disabled","true"):u.removeAttribute("disabled")}else if(r+s<o+n){var p=s-(r+s-(o+n))+d;$(i).scrollLeft(p),a-d<=p?l.setAttribute("disabled","true"):l.removeAttribute("disabled")}}},o.prototype.ActivateTabInternal=function(){var e=l.context($(this.element).closest(".pivot-container")[0]);if(l.value(e.Style)===l.ui.TabStyle.vertical&&l.value(e.Width)===l.layout.Size.content){var t=$(e.element);t.css("width",t.css("width")),e.activeItemName(this.Name),this.animateWidthResize(e)}else e.activeItemName(this.Name)},Object.defineProperty(o.prototype,"IsInNewWizard",{get:function(){return void 0===this.isInNewWizard&&(this.isInNewWizard=0<$(this.element).parents(".NewWizard").length),this.isInNewWizard},enumerable:!1,configurable:!0}),t=o,(e.PivotItem=t).prototype.PanelStyle=l.ui.autoValue,t.prototype.ActivateTab=null,t.prototype.Label="",t.prototype.Width=l.layout.Size.available,t.prototype.Height=l.layout.Size.available}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(n){var e,i,t;function o(){return null!==i&&i.apply(this,arguments)||this}e=n.controls||(n.controls={}),i=n.ui.Container,__extends(o,i),o.prototype.init=function(e,t){var o=this;i.prototype.init.call(this,e,t),this._setHorizontal(),this.LayoutAlignment=n.ui.autoProperty(n.layout.Alignment.top,this,"Alignment"),this.LayoutWidth=n.ui.tabWidth(this),this.LayoutMinHeight={minSizeFunction:n.layout.gridLayoutMinHeight,cssClassArgument:"panoramaContainer"},this._zoomModeWidthObserver=n.observe(n.shell.zoomModeWidth,function(e){e&&n.value(o.LayoutHeight)!==n.layout.Size.content?o._setVertical():e||n.value(o.LayoutHeight)===n.layout.Size.available||o._setHorizontal()})},o.prototype.dispose=function(){this._zoomModeWidthObserver&&(this._zoomModeWidthObserver.dispose(),this._zoomModeWidthObserver=void 0),i.prototype.dispose.call(this)},o.prototype._setHorizontal=function(){n.value(this.Height)!==n.layout.Size.content&&void 0!==n.value(this.Height)||n.setValue(this,"LayoutHeight",n.layout.Size.available),n.setValue(this,"LayoutArrangeMethod",n.layout.ArrangeMethod.horizontalLeft)},o.prototype._setVertical=function(){n.value(this.Height)!==n.layout.Size.available&&void 0!==n.value(this.Height)||n.setValue(this,"LayoutHeight",n.layout.Size.content),n.setValue(this,"LayoutArrangeMethod",n.layout.ArrangeMethod.vertical)},t=o,(e.Panorama=t).prototype.ShowHeaders=!0,t.prototype.Width=n.layout.Size.available,t.prototype.Height=n.layout.Size.available,t.prototype.Alignment=n.layout.Alignment.top}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(n){var e,i,t;function o(){return null!==i&&i.apply(this,arguments)||this}e=n.controls||(n.controls={}),i=n.ui.Container,__extends(o,i),o.prototype.init=function(e,t){var o=this;i.prototype.init.call(this,e,t),this._setHorizontal(),this._zoomModeWidthObserver=n.observe(n.shell.zoomModeWidth,function(e){e&&n.value(o.LayoutHeight)!==n.layout.Size.content?o._setVertical():e||n.value(o.LayoutHeight)===n.layout.Size.available||o._setHorizontal()})},o.prototype.dispose=function(){this._zoomModeWidthObserver&&(this._zoomModeWidthObserver.dispose(),this._zoomModeWidthObserver=void 0),i.prototype.dispose.call(this)},o.prototype.getHeader=function(){var e=$(this.element);if(e.length)return e.find(".panoramaItem-title")[0]},o.prototype.HeaderClicked=function(e){n.applyFunction(this.LabelAction,this)},o.prototype.keyDown=function(e){e.which===n.ui.KeyCodes.enter&&(this.HeaderClicked(),e.stopPropagation(),n.log.stopPropagation&&n.log.stopPropagation("Prevent form level Enter shortcut."))},o.prototype._setHorizontal=function(){n.setValue(this,"LayoutHeight",n.layout.Size.available),n.setValue(this,"LayoutWidth",n.layout.Size.content),this.LayoutArrangeMethod=n.ui.autoProperty(n.layout.ArrangeMethod.horizontalWrap,this,"ArrangeMethod"),this.LayoutColumns=n.ui.columnsProperty(n.layout.Columns.fill,this)},o.prototype._setVertical=function(){n.setValue(this,"LayoutHeight",n.layout.Size.content),n.setValue(this,"LayoutWidth",n.layout.Size.available),this.LayoutArrangeMethod=n.ui.autoProperty(n.layout.ArrangeMethod.vertical,this,"ArrangeMethod"),this.LayoutColumns=n.ui.columnsProperty(n.layout.Columns.balanced,this),n.setValue(this,"LayoutColumns",1)},t=o,(e.PanoramaItem=t).prototype.Label="",t.prototype.LabelAction=null,t.prototype.Width=n.layout.Size.content,t.prototype.Height=n.layout.Size.available}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(u){!function(e){Globalize.addCultureInfo("en",{messages:{Section_NextTab:"Move to next FastTab",Section_nthTab:"Move to nth FastTab",Section_PrevTab:"Move to previous FastTab",SummaryField_Empty:"(blank)"}});var n,t=(n=u.ui.Container,__extends(o,n),o.prototype.init=function(e,t){var o=this;n.prototype.init.call(this,e,t),this.LayoutWidth=u.ui.tabWidth(this),this.LayoutHeight=u.ui.tabHeight(this),this.LayoutMinHeight={minSizeFunction:u.layout.gridLayoutMinHeight,cssClassArgument:"section"},this.pages=[],this.CanCollapseAll=u.observable(!0),this.CollapseAll=function(){o.setAllExpandedState(!1)},this.CanExpandAll=u.observable(!0),this.ExpandAll=function(){o.setAllExpandedState(!0)}},o.prototype.dispose=function(){this.alwaysExpandedArrangeAsync&&(this.alwaysExpandedArrangeAsync.cancel(),this.alwaysExpandedArrangeAsync=null),this.reflowEndWatcher&&(this.reflowEndWatcher.dispose(),this.reflowEndWatcher=null),this.pages=[],n.prototype.dispose.call(this)},o.prototype.RegisterSectionPage=function(e){u.value(e.FastTabExpanded)===u.controls.SectionPage.FastTabExpandedState.Always&&!0!==this.hasAlwaysExpandedPage&&(this.hasAlwaysExpandedPage=!0,this.pages.forEach(function(e){u.layout.provider.removeScopeMarker(e.element)})),this.hasAlwaysExpandedPage&&u.layout.provider.removeScopeMarker(e.element),this.pages.push(e)},o.prototype.pageHeightChanged=function(e){var t=this;this.hasAlwaysExpandedPage&&u.value(e.FastTabExpanded)!==u.controls.SectionPage.FastTabExpandedState.Always&&(this.alwaysExpandedArrangeAsync&&(this.alwaysExpandedArrangeAsync.cancel(),this.alwaysExpandedArrangeAsync=null),this.alwaysExpandedArrangeAsync=u.async(function(){t.alwaysExpandedArrangeAsync=null,u.ui.layoutBlock(function(){t.pages.forEach(function(e){u.value(e.FastTabExpanded)===u.controls.SectionPage.FastTabExpandedState.Always&&u.layout.queueArrange(e.element)})})},0,"Arrange size to available section pages"))},o.prototype.pageExpandedChanged=function(e){var t,o=this;null!=e&&e.element&&null!==(t=this._parent)&&void 0!==t&&t.element&&(u.value(this._parent.Height)===u.layout.Size.content||u.value(this.Height)===u.layout.Size.content)&&(this.reflowEndWatcher&&this.reflowEndWatcher.dispose(),this.reflowEndWatcher=u.layout.registerEndReflowHandler(e.element,function(){o.reflowEndWatcher.dispose(),o.reflowEndWatcher=null,u.async(function(){u.ui.layoutBlock(function(){u.layout.queueArrange(o._parent.element)})})}))},o.prototype.keyDown=function(e){u.util.handleShortcuts(this,e)},o.prototype.NavigateTab=function(t,e){for(var o=u.value(this.pages),n=o.length,i=function(e){return((e+t)%n+n)%n},r=-1,a=0;a<n;a++)if(o[a].Name===e){for(r=i(a);!u.value(o[r].Visible);)r=i(r);break}0<=r&&o[r].Activate()},o.prototype.Activate_nth_TabPage=function(e){var t,o,n=u.value(this.pages),i=n.length;if(0<=e&&e<i){var r=0;try{for(var a=__values(n),s=a.next();!s.done;s=a.next()){var l=s.value;if(u.value(l.Visible)){if(r===e)return l.Activate(),!0;r++}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(t)throw t.error}}}return!1},o.prototype.setAllExpandedState=function(e){var t,o;try{for(var n=__values(this.pages),i=n.next();!i.done;i=n.next()){var r=i.value,a=!!u.value(r.Expanded);u.value(r.FastTabExpanded)!==u.controls.SectionPage.FastTabExpandedState.Always&&a!==e&&(u.callFunction(r.PersistPersonalization,r,["expanded",!u.value(r.Expanded)]),u.applyFunction(r.ExpandedChanged,r))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(o=n.return)&&o.call(n)}finally{if(t)throw t.error}}},o);function o(){return null!==n&&n.apply(this,arguments)||this}(e.Section=t).prototype.Width=u.layout.Size.available,t.prototype.Height=u.layout.Size.available;var i={PreviousTab:{Keys:{alt:!0,shift:!0,keyCode:u.ui.KeyCodes.upArrow},Handler:function(e){var t=u.context($(e.target).closest(".section-page")[0]).Name;return this.NavigateTab(-1,t)},Description:u.label("Section_PrevTab"),Category:u.ui.ShortcutCategory.Navigate},NextTab:{Keys:{alt:!0,shift:!0,keyCode:u.ui.KeyCodes.downArrow},Handler:function(e){var t=u.context($(e.target).closest(".section-page")[0]).Name;return this.NavigateTab(1,t)},Description:u.label("Section_NextTab"),Category:u.ui.ShortcutCategory.Navigate},nthTab:{Keys:{alt:!0,keyCode:u.ui.KeyCodes.numbers},Handler:function(e){var t=e.which-u.ui.KeyCodes.Number1;return this.Activate_nth_TabPage(t)},Description:u.label("Section_nthTab"),Category:u.ui.ShortcutCategory.Navigate}};t.prototype.Shortcuts=u.extendPrototype(t.prototype.Shortcuts,i)}(u.controls||(u.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(s){!function(e){Globalize.addCultureInfo("en",{messages:{ContextMenu_FastTabCollapse:"Collapse",ContextMenu_FastTabCollapseAll:"Collapse all",ContextMenu_FastTabExpand:"Expand",ContextMenu_FastTabExpandAll:"Expand all",SectionPage_Collapse:"Collapse FastTab",SectionPage_Expand:"Expand FastTab"}});var n,t,o,i=(n=s.ui.Container,__extends(r,n),r.prototype.init=function(e,t){var o=this;n.prototype.init.call(this,e,t),this._parent||(this._parent=this.getParent()),this._parent&&this._parent.RegisterSectionPage&&this._parent.RegisterSectionPage(this),this.recordTelemetry=function(e){},this.Clicked=function(e){s.value(o.FastTabExpanded)!==r.FastTabExpandedState.Always&&(s.callFunction(o.PersistPersonalization,o,["expanded",!s.value(o.Expanded)]),s.applyFunction(o.ExpandedChanged,o,[!s.value(o.Expanded)]),o.recordTelemetry(e),o._parent.pageExpandedChanged(o)),s.ax.personalizationUtil&&s.ax.personalizationUtil.forceUpdateFormPersonalizationData()},this.LayoutColumns=s.ui.columnsProperty(s.layout.Columns.balanced,this),this.Width=s.layout.Size.available,this.Height="Always"===s.value(this.FastTabExpanded)?s.layout.Size.available:s.layout.Size.content,this._processZoomWidthChanges(s.value(s.shell.zoomModeWidth)),this.ExpandButtonLabel=s.computed(function(){return s.value(o.Expanded)?s.label("SectionPage_Collapse"):s.label("SectionPage_Expand")}),this.ExpandButtonImage=s.computed(function(){return s.value(o.Expanded)?"ChevronUp":"ChevronDown"}),"workspace_tileLayout"===this.ExtendedStyle&&s.setValue(this,"LayoutAlignment",s.layout.Alignment.top)},r.prototype.getTaskGuideParams=function(e){e=n.prototype.getTaskGuideParams.call(this,e);var t=this.getHeader();return e.target=t?$(t):$(this.element),e},r.prototype.getContextMenuOptions=function(e){var t=[];if($(e).hasClass("section-page-header")||e.parentElement&&$(e.parentElement).hasClass("section-page-header")){var o=this._parent;t=[{Label:s.label("ContextMenu_FastTabCollapseAll"),Command:o.CollapseAll,Enabled:o.CanCollapseAll()},{Label:s.label("ContextMenu_FastTabExpandAll"),Command:o.ExpandAll,Enabled:o.CanExpandAll()},{Label:s.label("ContextMenu_FastTabCollapse"),Command:this.Clicked,Enabled:s.value(this.Expanded)},{Label:s.label("ContextMenu_FastTabExpand"),Command:this.Clicked,Enabled:!s.value(this.Expanded)}]}return t=t.concat(n.prototype.getContextMenuOptions.call(this,e))},r.prototype.getHeader=function(){if(!this._sectionPageHeader){var e=$(this.element);e.length&&(this._sectionPageHeader=e.find(".section-page-header")[0])}return this._sectionPageHeader},r.prototype.getCaptionButton=function(){if(!this._sectionPageCaptionButton){var e=$(this.element);e.length&&(this._sectionPageCaptionButton=e.find(".section-page-caption")[0])}return this._sectionPageCaptionButton},r.prototype.isControlAvailableForExpando=function(){return!0},r.prototype.getExpandoPersonalizationFocusTarget=function(){return $(this.getHeader())},r.prototype.getParent=function(){return s.context(this.element.parentElement)},r.prototype.keyDown=function(e){s.util.handleShortcuts(this,e)},r.prototype.Activate=function(){if(s.value(this.Expanded)){var e=s.util.findFirstFocusableControl(this.element);if($(e).hasClass("section-page-caption")){var t=$(this.element).find("[data-dyn-role=SectionPageHeader]");e=0<t.length?t[0]:e}this.Root.InternalFocusIn(e,this.Root.ActiveElement(),!0)}else s.applyFunction(this.ExpandedChanged,this),this._parent.pageExpandedChanged(this)},r.prototype.focusCallback=function(){var e=this.getCaptionButton?this.getCaptionButton():void 0;e&&s.util.focusElement(e)},r);function r(){var e=null!==n&&n.apply(this,arguments)||this;return e.heightChanged=function(){e._parent&&e._parent.pageHeightChanged(e)},e}e.SectionPage=i,t=i=e.SectionPage||(e.SectionPage={}),(o=t.FastTabExpandedState||(t.FastTabExpandedState={})).No="No",o.Yes="Yes",o.Auto="Auto",o.Always="Always",i.prototype.Label="",i.prototype.FastTabExpanded=i.FastTabExpandedState.Auto,i.prototype.ExpandedChanged=function(){s.setValue(this,"Expanded",!s.value(this.Expanded))},s.ui.addObservablePropertiesToPrototype(i.prototype,{Expanded:!0});var a={ToggleExpansion:{Keys:{keyCode:[s.ui.KeyCodes.enter,s.ui.KeyCodes.spacebar]},Handler:function(e){if(e.target!==this.getCaptionButton())return!1;this.Clicked(e)},RecordTelemetry:!1,ShowToUser:function(e){return e===this.getCaptionButton()&&s.value(this.FastTabExpanded)!==i.FastTabExpandedState.Always},Description:function(){return s.value(this.Expanded)?s.label("SectionPage_Collapse"):s.label("SectionPage_Expand")}},CollapseTab:{Keys:{alt:!0,keyCode:s.ui.KeyCodes.Number0},Handler:function(){s.value(this.FastTabExpanded)!==i.FastTabExpandedState.Always&&s.value(this.Expanded)&&(s.callFunction(this.PersistPersonalization,this,["expanded",!s.value(this.Expanded)]),s.applyFunction(this.ExpandedChanged,this,[!s.value(this.Expanded)]),s.util.focusElement(this.getCaptionButton()),this._parent.pageExpandedChanged(this))},ShowToUser:function(){return s.value(this.FastTabExpanded)!==i.FastTabExpandedState.Always&&s.value(this.Expanded)},Description:s.label("SectionPage_Collapse")}};i.prototype.Shortcuts=s.extendPrototype(i.prototype.Shortcuts,a)}(s.controls||(s.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(t){var e,o,n;function i(){return null!==o&&o.apply(this,arguments)||this}e=t.controls||(t.controls={}),o=t.ui.Container,__extends(i,o),i.prototype.setChildControlFocus=function(){var e=this.GetSectionPage().getCaptionButton();return e&&t.util.focusElement(e),e},i.prototype.GetSectionPage=function(){return t.context(this.element.parentElement)},n=i,e.SectionPageHeader=n}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(s){!function(e){Globalize.addCultureInfo("en",{messages:{Button_AttachmentsOptionalLabel:"Attachments",Button_ClickMenuItem:"Click selected menu item",Button_NextMenuItem:"Select next menu item",Button_OpenMenu:"Open menu",Button_PrevMenuItem:"Select previous menu item"}});var o,t=(o=s.ui.Control,__extends(n,o),n.prototype.init=function(e,t){var a=this;o.prototype.init.call(this,e,t),this.IsLabelBubble=s.observable(!1),this.isSystemDefinedAttachButton=e&&"SystemDefinedAttachButton"===e.Name,this.shouldDisplayCount=function(){return a.isSystemDefinedAttachButton&&(s.value(a.ButtonDisplay)===s.ui.ButtonDisplay.textWithImageLeft||s.value(a.ButtonDisplay)===s.ui.autoValue)},this._buttonDisplay=s.computed(function(){var e=s.value(a.Label),t=s.value(a.ImageName),o=s.value(a.ButtonDisplay);return o===s.ui.autoValue&&t&&(o=s.ui.ButtonDisplay.textWithImageLeft),!e&&t&&o!==s.ui.ButtonDisplay.backgroundImage&&o!==s.ui.ButtonDisplay.textOnly&&(o=s.ui.ButtonDisplay.imageOnly),!a.shouldDisplayCount()&&"SymbolButton"!==a.TypeName||(o=s.ui.ButtonDisplay.imageOnly),o}),s.observe(this._buttonDisplay,function(){if(a.shouldDisplayCount()){a.IsLabelBubble(!0),a.ShowLabel=!0;var e="".concat(s.label("Button_AttachmentsOptionalLabel")," (").concat(a.Label,")");a.element.setAttribute("dyn-data-optional-label",e),a.element.setAttribute("aria-label",e)}}),this._buttonDisplay()!==s.ui.ButtonDisplay.imageOnly||this.IsLabelBubble()||(this.ShowLabel=!1),e&&"Popout"===e.Command&&(this._popoutEnabledObserver=s.observe(s.options({formStack:s.shell.stack,recording:s.ax.taskRecording.started}),function(){a.changePopoutEnabledState()})),this.toolTip=s.computed(function(){var e=s.value(a.HelpText),t=s.value(a.Label),o=s.value(a.Title);if(!o)if(e)if("("===e.charAt(0)){var n=e.indexOf("\n");if(-1!==n){var i=e.substr(n),r=e.substring(0,n).trim();o=s.format("{0} {1}{2}",t,r,i)}else o=s.format("{0} {1}",t,e)}else o=s.format("{0}\n{1}",t,e);else o=t;return o}),s.observe(this.ButtonDisplay,function(e){a.element&&"MenuButton"!==a.TypeName&&e===s.ui.ButtonDisplay.imageOnly&&(a.element.setAttribute("aria-label",s.value(a.Label)),a.element.setAttribute("dyn-data-optional-label",s.value(a.Label)))})},n.prototype.Clicked=function(e){var t=this;if(s.value(this.Enabled)){var o=function(){t.Command&&t.Command!==s.shell.CalledCommandButtonFunction.New&&!t._triggerEvent(e)||(s.value(t.SaveRecord)&&t.Root&&t.Root.MessageBar&&t.Root.MessageBar._clearWarningMessagesNotAttachedToInputControls(),t.Root&&t.Root.updateLastClientSelectedControl&&s.value(t.RequiresSelectedControl)&&t.Root.updateLastClientSelectedControl(),s.callFunction(t.Click,t,e))};if(s.value(this.SaveRecord)){if(this.Command&&this.Command===s.shell.CalledCommandButtonFunction.New&&!this._triggerEvent(e))return;this.Root.HasInvalidUnboundControls()?this.Root&&this.Root.AllowSave&&this.Root.AllowSave(o):o()}else o()}else e&&e.preventDefault()},n.prototype.dispose=function(){this._popoutEnabledObserver&&(this._popoutEnabledObserver.dispose(),this._popoutEnabledObserver=null),o.prototype.dispose.call(this)},n.prototype.getTaskGuideParams=function(e){return(e=o.prototype.getTaskGuideParams.call(this,e)).my=s.layout.qTipPosition.topCenter,e.at=s.layout.qTipPosition.bottomCenter,e},n.prototype.overflowMenuUpdate=function(e){this.shouldDisplayCount()&&(e?(this.ShowLabel=!0,this.IsLabelBubble(!1),this._originalLabel=this.Label,this.Label=this.element.getAttribute("aria-label")):(this.ShowLabel=!0,this.IsLabelBubble(!0),this.Label=this._originalLabel))},n.prototype.keyDown=function(e){s.util.isShortcutKeyPressed(e,{keyCode:s.ui.KeyCodes.enter})?(e.stopPropagation(),s.log.stopPropagation&&s.log.stopPropagation("Prevent form level Enter shortcut.")):s.util.handleShortcuts(this,e)},n.prototype.couldCreateRecord=function(){return this.Command&&this.Command===s.shell.CalledCommandButtonFunction.New},n.prototype._triggerEvent=function(e){var t=!0,o=$.Event(this.Command);return $(e.target).trigger(o),o.isDefaultPrevented()&&(t=!1),t},n.prototype.changePopoutEnabledState=function(){1===s.length(s.shell.stack())?s.setValue(this,"Enabled",!1):s.setValue(this,"Enabled",!s.value(s.ax.taskRecording.started))},n);function n(){return null!==o&&o.apply(this,arguments)||this}(e.Button=t).prototype.bindUpdate=!0,t.prototype.Click=null,s.ui.addPropertiesToPrototype(t.prototype,{buttonStyle:{defaultValue:s.ui.ButtonStyle.none,invokeHandlers:!1,observable:!0,options:s.ui.ButtonStyle,serialize:!0},Command:{defaultValue:"",invokeHandlers:!1,serialize:!0},ButtonDisplay:{defaultValue:s.ui.autoValue,observable:!0},DefaultButton:{defaultValue:!1,observable:!0},ImageName:{defaultValue:"",observable:!0},ImageType:{defaultValue:s.ui.ImageType.symbol,observable:!0},IsBig:{defaultValue:!1,observable:!0},SaveRecord:{defaultValue:!1,observable:!0},Text:{defaultValue:"",observable:!1},Toggled:{defaultValue:null,observable:!0},HelpText:{defaultValue:"",observable:!0},buttonDisplay:{backingField:"_buttonDisplay",defaultValue:s.ui.autoValue,observable:!0,options:s.ui.ButtonDisplay,serialize:!1},Label:{attribute:"title",converter:s.util.converters.notNullString,defaultValue:"",observable:!0},ShowLabel:{defaultValue:!0,observable:!0}})}(s.controls||(s.controls={})),s.adapter({id:"MenuItemButton",controlType:"Button",template:"Button"}),s.adapter({id:"CommandButton",controlType:"Button",template:"Button"}),s.adapter({id:"SymbolButton",controlType:"Button",template:"SymbolButton"})}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){!function(e){var t,o=(t=r.controls.Button,__extends(n,t),n.prototype.keyDown=function(e){r.util.handleShortcuts(this,e)},n);function n(){return null!==t&&t.apply(this,arguments)||this}e.AnchorButton=o;var i={DefaultAction:{Keys:{keyCode:r.ui.KeyCodes.enter},Handler:function(e){this.Clicked(e)}}};o.prototype.Shortcuts=r.extendPrototype(o.prototype.Shortcuts,i)}(r.controls||(r.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(n){var e,t,o;function i(){return null!==t&&t.apply(this,arguments)||this}e=n.controls||(n.controls={}),t=n.controls.Button,__extends(i,t),i.prototype.Clicked=function(e){var t=this;if(n.value(this.Enabled)){var o=function(){t.Root&&t.Root.updateLastClientSelectedControl&&n.value(t.RequiresSelectedControl)&&t.Root.updateLastClientSelectedControl(),t.Toggled=!t.Toggled,n.callFunction(t.SetToggled,t,[t.Toggled]),n.callFunction(t.Click,t,e)};n.value(this.SaveRecord)&&this.Root&&this.Root.AllowSave?this.Root.AllowSave(o):o()}else e&&e.preventDefault()},o=i,(e.ToggleButton=o).prototype.template="Button",o.prototype.SetToggled=null,n.ui.addPropertiesToPrototype(o.prototype,{Toggled:{defaultValue:!1,observable:!0},Command:{defaultValue:"",observable:!0},Data:{defaultValue:"",observable:!0}})}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){var e,a,t;function o(e,t,o,n){var i=a.call(this,e,t,o,n)||this;return r.ui.popupHost.apply(i,[i.popupOptions]),i}e=r.controls||(r.controls={}),a=r.controls.Button,__extends(o,a),t=o,(e.DropDialogButton=t).prototype.popupOptions={role:"DropDialogPopup"},r.ui.addPropertiesToPrototype(t.prototype,{FormName:{defaultValue:"",observable:!0}})}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(c){!function(e){var i,t=(i=c.controls.Button,__extends(o,i),o.prototype.init=function(e,t){var o=this;i.prototype.init.call(this,e,t),this.element&&(this.$flyoutButton=$(this.element).find(".flyoutButton-Button")),c.isObservable(this.ShownIndex)||(this.ShownIndex=c.observable(this.ShownIndex));var n=!1;this.ShowFlyout=c.computed(function(){var e=c.value(o.HasBeenOpened);return e?n:e},function(e){e?(o.Clicked(),o.$flyoutButton&&o.$flyoutButton[0]&&o.$flyoutButton[0].dynFocusedTimer&&(window.clearTimeout(o.$flyoutButton[0].dynFocusedTimer),o.$flyoutButton[0].dynFocusedTimer=void 0),c.value(c.async.pending)?o.pendingObserver=c.observe(c.async.pending,function(e){return!!e||(o.initializeMenuItems(!0),o.pendingObserver=void 0,!1)}):o.initializeMenuItems(!1)):(c.superTooltip&&c.superTooltip._superToolTipControl&&o.$menuElement&&c.superTooltip._superToolTipControl.parentElement===o.$menuElement[0]&&c.superTooltip.destroySuperTooltip(),o.ShownIndex(-1),o.$menuElement&&(o.$menuElement.removeAttr("aria-activedescendant"),o.$menuElement.off("keydown.appBar",o.keyDown))),n=e}),c.observe(this.ButtonDisplay,function(e){o.$flyoutButton&&e===c.ui.ButtonDisplay.imageOnly&&o.$flyoutButton.attr("dyn-data-optional-label",c.value(o.Label))}),this.isControlAvailableForExpando=function(){return!1},this.getExpandoPersonalizationFocusTarget=function(){return $(o.element).find("button")},this.getCurrentAnchor=function(){return o.currentAnchor},this.optOutFocusTimer=function(){return c.value(o.ShowFlyout)}},o.prototype.keyDown=function(e){var t=c.context(e.currentTarget);t.$menuElement&&0===t.$menuElement.length&&(t.$menuElement=$(document).find('.flyoutButton-flyOut[data-dyn-lastvisible="true"]'),t.menuItemCount=t.$menuElement.find('[data-dyn-role="MenuItem"]:not([aria-hidden])').length),c.util.handleShortcuts(t,e)},o.prototype.dispose=function(){this.pendingObserver&&this.pendingObserver.dispose(),i.prototype.dispose.call(this)},o.prototype.getNextMenuItem=function(){for(var e=c.value(this.ShownIndex),t=e,o=1;o<this.menuItemCount;o++){var n=(e+o)%this.menuItemCount,i=this.$menuElement.find('[data-dyn-role="MenuItem"]:visible').eq(n);if(i&&0<i.length){t=n;var r=i.attr("id");r&&this.$menuElement.attr("aria-activedescendant",r),i[0].scrollIntoViewIfNeeded();break}}return t!==e&&c.setValue(this,"ShownIndex",t),!0},o.prototype.getPrevMenuItem=function(){for(var e=c.value(this.ShownIndex),t=e,o=1;o<this.menuItemCount;o++){var n=e-o;n<0&&(n+=this.menuItemCount);var i=this.$menuElement.find('[data-dyn-role="MenuItem"]:visible').eq(n);if(i&&0<i.length){t=n;var r=i.attr("id");r&&this.$menuElement.attr("aria-activedescendant",r),i[0].scrollIntoViewIfNeeded();break}}return t!==e&&c.setValue(this,"ShownIndex",t),!0},o.prototype.clickMenuItem=function(){var e=c.value(this.ShownIndex);return-1===e&&this.$flyoutButton&&0<this.$flyoutButton.length?this.$flyoutButton.click():this.$menuElement.find('[data-dyn-role="MenuItem"]:visible').eq(e).click(),!0},o.prototype.initializeMenuItems=function(e){this.$menuElement=e?$(document).find('.flyoutButton-flyOut[data-dyn-lastvisible="true"]'):$(this.element).find(".flyoutButton-flyOut"),this.$menuElement.on("keydown.appBar",this.keyDown);var t=this.$menuElement;if(setTimeout(function(){t.focus()}),0<this.$menuElement.length){var o=this.$menuElement.find('[data-dyn-role="MenuItem"]:not([aria-hidden]), [data-dyn-role="MenuItemSeparator"]:not([aria-hidden])'),n=o.length;if(0<n){for(var i=0,r="",a=c.value(this.ShownIndex),s=0;s<n;++s){var l=o[s],u=c.context(l);u&&("MenuItem"===u.TypeName?(-1===a&&(a=i,c.setValue(this,"ShownIndex",a)),a===i&&(l.id&&this.$menuElement.attr("aria-activedescendant",l.id),l.scrollIntoViewIfNeeded()),l.setAttribute("aria-posinset",(i+1).toString()),r?l.setAttribute("aria-label","".concat(r," ").concat(u.Label)):l.setAttribute("aria-label",u.Label),i++):"MenuItemSeparator"===u.TypeName&&u.Label&&(r=u.Label))}0<i&&(this.menuItemCount=i,this.$menuElement.find('[data-dyn-role="MenuItem"]:not([aria-hidden])').attr("aria-setsize",this.menuItemCount.toString()))}}},o);function o(){return null!==i&&i.apply(this,arguments)||this}(e.MenuButton=t).prototype.Click=function(e){c.setValue(this,"HasBeenOpened",!0)},t.prototype.ShownIndex=-1,t.prototype.$menuElement=null,t.prototype.menuItemCount=0;var n={nextMenuItem:{Keys:{keyCode:c.ui.KeyCodes.downArrow},Handler:function(){return!!(c.value(this.ShowFlyout)&&0<this.menuItemCount)&&this.getNextMenuItem()},RecordTelemetry:!1,ShowToUser:function(){return c.value(this.ShowFlyout)},Description:c.label("Button_NextMenuItem")},prevMenuItem:{Keys:{keyCode:c.ui.KeyCodes.upArrow},Handler:function(){return!!(c.value(this.ShowFlyout)&&0<this.menuItemCount)&&this.getPrevMenuItem()},RecordTelemetry:!1,ShowToUser:function(){return c.value(this.ShowFlyout)},Description:c.label("Button_PrevMenuItem")},enterMenuItem:{Keys:{keyCode:[c.ui.KeyCodes.enter,c.ui.KeyCodes.spacebar]},Handler:function(){if(c.value(this.ShowFlyout)&&0<this.menuItemCount)return this.clickMenuItem();this.ShowFlyout(!0)},Description:function(){return c.value(this.ShowFlyout)?c.label("Button_ClickMenuItem"):c.label("Button_OpenMenu")}},tabMenuItem:{Keys:{keyCode:c.ui.KeyCodes.tab,isShiftKeyAgnostic:!0},Handler:function(){return this.ShowFlyout(!1),!1},RecordTelemetry:!1,ShowToUser:!1}};t.prototype.Shortcuts=c.extendPrototype(t.prototype.Shortcuts,n),c.ui.addObservablePropertiesToPrototype(t.prototype,{HasBeenOpened:!1});var r,a=(r=c.controls.Button,__extends(s,r),s.prototype.init=function(e,t){var n=this;r.prototype.init.call(this,e,t),c.isObservable(this.Selected)||(this.SelectedComputed=c.computed(function(){if(n.element&&n.element.parentElement){var e=n.getParentContext();if(e&&e.ShownIndex){var t=c.value(e.ShownIndex),o=$(n.element.parentElement).find('[data-dyn-role="MenuItem"]:not([aria-hidden])');if(t<o.length)return n.element===o[t]}}return!1}),c.observe(this.SelectedComputed,function(e){n.Selected=e,c.util.isTooltipOnFocusEnabled()&&n.Selected&&!n.dynFocusedTimer?n.dynFocusedTimer=window.setTimeout(function(){n.element.hasAttribute("dyn-data-supertooltip")&&c.superTooltip.tryOpenSuperTooltip(n.element),window.clearTimeout(n.dynFocusedTimer),n.dynFocusedTimer=void 0},c.onFocusEvent._focusEventTimeout):n.Selected||(n.dynFocusedTimer&&(window.clearTimeout(n.dynFocusedTimer),n.dynFocusedTimer=void 0),c.superTooltip&&c.superTooltip._superToolTipControl&&n.element&&c.superTooltip._superToolTipControl===n.element&&c.superTooltip.destroySuperTooltip())}))},s.prototype.couldCreateRecord=function(){var e=r.prototype.couldCreateRecord.call(this);if(!e){var t=this.getParentContext();t&&"ctrlAdd"===t.Name&&(e=!0)}return e},s.prototype.getParentContext=function(){var e=c.context($(this.element).closest(".flyoutButton-flyOut")[0]);return e=e||c.context(this.element.parentElement)},s);function s(){return null!==r&&r.apply(this,arguments)||this}(e.MenuItem=a).prototype.template="MenuItem",c.ui.addPropertiesToPrototype(a.prototype,{Selected:{defaultValue:!1}});var l,u=(l=c.ui.Control,__extends(d,l),d);function d(){return null!==l&&l.apply(this,arguments)||this}e.MenuItemSeparator=u,c.ui.addPropertiesToPrototype(u.prototype,{Label:{defaultValue:"",observable:!0},ShowLabel:{defaultValue:!0,observable:!0}})}(c.controls||(c.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(l){!function(e){var o,t=(o=l.ui.Control,__extends(n,o),n.prototype.init=function(e,t){var s=this;o.prototype.init.call(this,e,t),this.isInGrid()&&!this.isInSelectedGridRow()&&(this.Skip=!0),this.target=l.computed(function(){return l.value(s.OpenInNewWindow)?"_blank":""}),this.href=l.computed(function(){var e=l.value(s.BaseUrl),t="",o="?";new RegExp("[?]","ig").test(e)&&(o="&");for(var n=s,i=1;i<=6;i++){var r=l.value(n["QueryParam"+i+"Name"]),a=l.value(n["QueryParam"+i+"Value"]);r&&(t+=o+encodeURIComponent(r)+"="+encodeURIComponent(a),o="&")}return e+t})},n.prototype.clicked=function(e){l.value(this.Enabled)&&l.value(this.href)||e.preventDefault(),e.stopPropagation()},n.prototype.keyDown=function(e){l.util.handleShortcuts(this,e)},n);function n(){return null!==o&&o.apply(this,arguments)||this}(e.HyperLink=t).prototype.OpenInNewWindow=!1,t.prototype.BaseUrl="",t.prototype.QueryParam1Name="",t.prototype.QueryParam1Value="",t.prototype.QueryParam2Name="",t.prototype.QueryParam2Value="",t.prototype.QueryParam3Name="",t.prototype.QueryParam3Value="",t.prototype.QueryParam4Name="",t.prototype.QueryParam4Value="",t.prototype.QueryParam5Name="",t.prototype.QueryParam5Value="",t.prototype.QueryParam6Name="",t.prototype.QueryParam6Value="",l.ui.addObservablePropertiesToPrototype(t.prototype,{Text:""});var i={DefaultAction:{Keys:{keyCode:[l.ui.KeyCodes.enter,l.ui.KeyCodes.spacebar]},Handler:function(){this.element&&this.element.click()},ShowToUser:!1}};t.prototype.Shortcuts=l.extendPrototype(t.prototype.Shortcuts,i)}(l.controls||(l.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(a){!function(e){Globalize.addCultureInfo("en",{messages:{Framework_Tile_ButtonRole:"Button",Framework_Tile_MoreInfo:"More info"}});var r,t=(r=a.controls.Button,__extends(o,r),o.prototype.getTaskGuideParams=function(e){return e=r.prototype.getTaskGuideParams.call(this,e)},o.prototype.focusIn=function(){var e=$(this.element).closest(".dashboardTiles_wide")[0];e&&e.classList.add("focusTile")},o.prototype.focusOut=function(){var e=$(this.element).closest(".dashboardTiles_wide")[0];e&&e.classList.remove("focusTile")},o.prototype.keyDown=function(e){a.util.handleShortcuts(this,e)},o.prototype.Clicked=function(e){a.value(this.Url).length?(e.stopPropagation(),a.log.stopPropagation&&a.log.stopPropagation("Stop propagation in tile.Clicked, tile had a URL.")):(a.value(this.TileType)!==a.ui.TileType.kpi||a.value(this.KpiValid))&&a.value(this.Click)&&(a.getFunction(this.Click)(),a.shell.isCurrentFormDefaultForm()&&(a.shell.browserHistory.updateQuery=!0,a.shell.browserHistory.queryMI=a.value(this.MenuItemType)+":"+a.value(this.MenuItemName)))},o);function o(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return i.TileTitle=a.observable(a.value(i.Label)),i.tileHasIcon=a.computed(function(){var e=i.buttonDisplay,t=a.value(i.ImageName),o=a.value(i.ImageType);if(t&&o&&e!==a.ui.ButtonDisplay.backgroundImage)return!0}),i}(e.Tile=t).prototype.bindUpdate=!1,t.prototype.Click=null,a.ui.addPropertiesToPrototype(t.prototype,{FormName:{defaultValue:"",observable:!0},MenuItemName:{defaultValue:"",observable:!0},MenuItemType:{defaultValue:void 0,observable:!0},Size:{defaultValue:"Medium",observable:!0},TileType:{defaultValue:"",observable:!0},Url:{defaultValue:"",observable:!0}});var n={TileNavigate:{Keys:{keyCode:[a.ui.KeyCodes.enter,a.ui.KeyCodes.spacebar]},Handler:function(e){return this.Clicked(e),!1},RecordTelemetry:!1,Description:a.label("Tile_Click")}};t.prototype.Shortcuts=a.extendPrototype(t.prototype.Shortcuts,n),a.adapter({id:"LinkTile",controlType:"Tile",template:"LinkTile"})}(a.controls||(a.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(a){!function(e){Globalize.addCultureInfo("en",{messages:{CountTile_Count:"Count",CountTile_HelpText:"Alt-down to refresh count data",Tile_Click:"Click tile",Tile_OpenRefresh:"Open refresh dialog",Tile_RefreshNow:"Begin update now",Tile_TimeSinceRefreshPrefix:"Last updated: {0} ago",Tile_TimeUntilRefreshPrefix:"Next update:"}});var i,t=(i=a.controls.Tile,__extends(o,i),o.prototype.keyDown=function(e){a.util.handleShortcuts(this,e)},o.prototype.focusOut=function(){i.prototype.focusOut.call(this),a.value(this.TileType)===a.ui.TileType.count&&this.isRefreshDialogOpen()&&!this.isManualRefreshEnabled()&&this.isRefreshDialogOpen(!1)},o.prototype.requestTileData=function(){var e=this;this.nextUpdateTimerId&&(window.clearTimeout(this.nextUpdateTimerId),this.nextUpdateTimerId=void 0),this.getData?a.async(function(){a.callFunction(e.getData,e,[],e.dataCacheCallback)},void 0,"Tiles: Count tile requestTileData calling getData"):a.logWarning("Tiles: Data cache disabled, unable to retrieve tile count.")},o.prototype.initTile=function(){this.cacheLastUpdateMomentUTC=moment.utc(),this.lastDataReceivedMomentUTC=moment.utc(),this.currentRefreshFrequencyMilliseconds=a.ui.TileFastestRetryFrequencyMilliseconds,this.isManualRefreshEnabled=a.observable(!1),this.TileTitle=a.observable(""),this.requestTileData(),null!=a.value(this.Refreshing)?a.observe(this.Refreshing,this.tileRefresh):this.Root&&this.Root.Refreshing&&a.observe(this.Root.Refreshing,this.tileRefresh)},o.prototype.updateTimeSinceRefresh=function(e,t){var o=a.label("Tile_TimeSinceRefreshPrefix"),n=t.isSame("1900-01-01","day")?"--":a.format(o,a.util.elapsedTimeDisplayText(e,t));this.timeSinceTileRefreshText(n)},o.prototype.updateTimeUntilRefresh=function(e,t,o){var n=t.clone().add(o,"ms"),i=a.label("Tile_TimeUntilRefreshPrefix"),r=a.util.elapsedTimeDisplayText(e,n);this.timeUntilTileRefreshText(i+" "+r)},o);function o(e,t,o,n){var r=i.call(this,e,t,o,n)||this;return r.refreshNow=function(){a.async(function(){a.callFunction(r.ForceRefresh,r,[],e),r.isRefreshDialogOpen(!1)},void 0,"Tiles: refreshNow calling ForceRefresh");var e=function(e){r.processCountTileData(e)}},r.dataCacheCallback=function(e){r.processCountTileData(e),r.setNextDataRequest()},r.processCountTileData=function(e){var t;(t=e&&!$.isPlainObject(e)?JSON.parse(e):e)?(r.Count(t.strTileData),r.TileTitle(a.format("{0}\n{1}: {2}",a.value(r.Label),a.label("CountTile_Count"),a.value(r.Count))),r.cacheLastUpdateMomentUTC=moment.utc(t.strLastUpdate,"M/D/YYYY HH:mm:ss",!0),r.plannedRefreshFrequencyMilliseconds="0"!==t.strRefreshFrequencySeconds?1e3*parseInt(t.strRefreshFrequencySeconds,10):a.ui.TileStandardRetryFrequencyMilliseconds,r.isManualRefreshEnabled(t.isManualRefreshEnabled)):(a.logError("Unexpected data structure provided to processCountTileData"),r.cacheLastUpdateMomentUTC=moment.utc(),r.plannedRefreshFrequencyMilliseconds=a.ui.TileStandardRetryFrequencyMilliseconds,r.isManualRefreshEnabled(!1)),r.lastDataReceivedMomentUTC=moment.utc()},r.scheduledDataRequest=function(){r.Root?a.value(r.Root.isRootFormActive)?(a.log("Tiles: Count Tile is calling getData after timeout"),r.requestTileData()):$.when(a.deferred.onTrue(function(){return a.value(r.Root.isRootFormActive)}).done(function(){a.log("Tiles: Count Tile is calling getData after root form is reactivated"),r.scheduledFirstRetry=!1,r.requestTileData()})):(r.nextUpdateTimerId=void 0,a.logWarning("Tiles: Did not refresh count tile data for %s, self.Root was not found.",r.Name))},r.setNextDataRequest=function(){r.nextUpdateTimerId=window.setTimeout(r.scheduledDataRequest,r.currentRefreshFrequencyMilliseconds),"--"===a.value(r.Count)&&r.currentRefreshFrequencyMilliseconds<r.plannedRefreshFrequencyMilliseconds/2?r.currentRefreshFrequencyMilliseconds*=2:r.currentRefreshFrequencyMilliseconds=r.plannedRefreshFrequencyMilliseconds},r.tileRefresh=function(e){e&&(a.log("Tiles: tileRefresh"),r.requestTileData())},r.isRefreshDialogOpen=a.observable(!1),r.timeSinceTileRefreshText=a.observable(""),r.timeUntilTileRefreshText=a.observable(""),r.refreshFlyoutOptions={at:"right center",flyout:$(r.element).find(".tile-refreshFlyout"),my:"left top",show:r.isRefreshDialogOpen},r.refreshNowLabel=a.label("Tile_RefreshNow"),a.observe(r.isRefreshDialogOpen,function(e){if(e){var t=moment.utc(),o=r.cacheLastUpdateMomentUTC,n=r.lastDataReceivedMomentUTC,i=r.currentRefreshFrequencyMilliseconds;r.updateTimeSinceRefresh(t,o),r.updateTimeUntilRefresh(t,n,i)}}),r.hasCountAndImage=a.computed(function(){var e=r.buttonDisplay,t=a.value(r.ImageName),o=a.value(r.ImageType);if(e!==a.ui.ButtonDisplay.textOnly&&(e!==a.ui.ButtonDisplay.backgroundImage||e===a.ui.ButtonDisplay.backgroundImage&&"Symbol"===o)&&t)return!0}),r.initTile(),r}e.CountTile=t,a.ui.addObservablePropertiesToPrototype(t.prototype,{Count:"--",Refreshing:null});var n={OpenRefreshDialog:{Keys:{alt:!0,keyCode:a.ui.KeyCodes.downArrow},Handler:function(){return this.isRefreshDialogOpen(!0),!0},Description:a.label("Tile_OpenRefresh"),Category:a.ui.ShortcutCategory.Navigate}};t.prototype.Shortcuts=a.extendPrototype(t.prototype.Shortcuts,n)}(a.controls||(a.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(p){!function(e){Globalize.addCultureInfo("en",{messages:{KpiTile_Status:"Status",KpiTile_Trend:"Trend",KpiTile_Value:"Value"}});var i,t=(i=p.controls.Tile,__extends(o,i),o.prototype.requestTileData=function(){p.applyFunction(this.GetTileData,this)},o.prototype.kpiValueFormat=function(){var e="";switch(p.value(this.KpiValueType)){case"Currency":e="c";break;case"Percentage":e="p";break;case"Integer":e="n0";break;case"Real":default:e="n"}return e},o.prototype.formatKpiValue=function(e){var t,o=parseFloat(e);isNaN(o)&&(o=0);for(var n=Math.round(100*o)/100,i=this.determineWholeNumberDigits(n),r=i,a=0,s=this.determineNextCultureGroupSize(a);s<r;)a++,r-=s,s=this.determineNextCultureGroupSize(a);if(s<i){for(var l=i-(r+1),u=0;u<l;u++)n/=10;if(n=Math.round(100*n)/100,n/=10,this.determineWholeNumberDigits(n)>s){a++;for(var d=0;d<s;d++)n/=10;n*=10,n=Math.round(n),n/=10}t=Globalize.format("Percentage"===p.value(this.KpiValueType)?n/100:n,this.kpiValueFormat()+2,Globalize.culture().language)}else o*=100,o=Math.round(o),o/=100,t=Globalize.format("Percentage"===p.value(this.KpiValueType)?o/100:o,this.kpiValueFormat(),Globalize.culture().language);var c=this.getMagnitudeIndicator(a);return"Percentage"===p.value(this.KpiValueType)&&(t=t.toString()),{valueText:t,magnitudeIndicator:c}},o.prototype.determineWholeNumberDigits=function(e){for(var t=Math.floor(Math.abs(e)),o=0;0<t;)t=Math.floor(t/10),o++;return o},o.prototype.determineNextCultureGroupSize=function(e){var t=Globalize.culture().numberFormat.groupSizes,o=t.length;return o<=e?t[o-1]:t[e]},o.prototype.getMagnitudeIndicator=function(e){var t;switch(e){case 0:t=" ";break;case 1:t="K";break;case 2:t="M";break;case 3:t="B";break;case 4:t="T";break;case 5:t="Q";break;default:t="ER"}return t},o.prototype.initTile=function(){var o=this;this.KpiStatus=p.observable(""),this.KpiTrend=p.observable(""),this.KpiValue=p.observable("--"),this.kpiValue=p.observable("--"),this.KpiValid=p.observable(!1),this.KpiValueType=p.observable(""),this.KpiMagnitude=p.observable(""),this.HasKpiTrendInfo=p.observable(),this.ShowStatus=p.observable(""),this.ShowTrend=p.observable(""),this.ShowGoal=p.observable(""),this.PercentageChange=p.observable(""),this.ThresholdType=p.observable(""),this.ThresholdDisplayName=p.observable(""),this.ThresholdSign=p.observable(""),this._originalHelpText=this.HelpText,p.observe(this.KpiValue,function(e){var t=o.formatKpiValue(e);o.kpiValue(t.valueText),o.KpiMagnitude(t.magnitudeIndicator)}),this.KpiName&&this.requestTileData(),null!==p.value(this.Refreshing)?p.observe(this.Refreshing,this.tileRefresh):this.Root&&this.Root.Refreshing&&p.observe(this.Root.Refreshing,this.tileRefresh),this.KpiValid(!1),this.HasKpiTrendInfo(!1),this.KpiValue("--")},o);function o(e,t,o,n){var a=i.call(this,e,t,o,n)||this;return a.updateKpiFromJson=function(e){var t;if(e){if(t=$.isPlainObject(e)?e:JSON.parse(e),a.KpiValid(1===t.IsValid),1===t.IsValid){if(a.KpiStatus(t.Status),a.KpiTrend(t.Trend),a.KpiValueType(t.ValueType),a.KpiValue(t.Value),a.HasKpiTrendInfo(1===t.HasTrendInfo),a.ShowStatus(t.ShowStatus),a.ShowTrend(t.ShowTrend),a.ShowGoal(t.ShowGoal),a.ThresholdType(t.ThresholdType),a.ThresholdDisplayName(t.ThresholdDisplayName),a.ThresholdSign(t.ThresholdSign),a.PercentageChange(t.PercentageChange),"Percentage"===p.value(a.ThresholdType))a.PercentageChange(p.value(a.ThresholdSign)+p.value(a.PercentageChange)+"%");else{var o=a.formatKpiValue(p.value(a.PercentageChange));a.PercentageChange(p.value(a.ThresholdSign)+o.valueText+o.magnitudeIndicator)}var n="",i=parseFloat(a.KpiValue());n=isNaN(i)?a.KpiValue():Globalize.format("Percentage"===p.value(a.KpiValueType)?i/100:i,a.kpiValueFormat(),Globalize.culture().language);var r=p.format("{0}: {1}\n{2}: {3}",p.label("KpiTile_Value"),n,p.label("KpiTile_Status"),a.KpiStatus());a.HasKpiTrendInfo()&&(r=p.format("{0}\n{1}: {2}",r,p.label("KpiTile_Trend"),a.KpiTrend)),a.HelpText=p.format("{0}\n{1}",r,a._originalHelpText)}}else p.logWarning("kpiValues cannot be null or undefined.")},a.KpiNameChanged=function(){a.requestTileData()},a.tileRefresh=function(e){e&&(p.log("Tiles: tileRefresh"),a.requestTileData())},a.hasCountAndImage=p.computed(function(){var e=a.buttonDisplay,t=p.value(a.ImageName),o=p.value(a.ImageType);if(e!==p.ui.ButtonDisplay.textOnly&&(e!==p.ui.ButtonDisplay.backgroundImage||e===p.ui.ButtonDisplay.backgroundImage&&"Symbol"===o)&&t)return!0}),a.initTile(),a}e.KPITile=t,p.ui.addPropertiesToPrototype(t.prototype,{KpiName:{defaultValue:void 0,observable:!1}}),p.ui.addObservablePropertiesToPrototype(e.CountTile.prototype,{Count:"--",Refreshing:null})}(p.controls||(p.controls={}))}($dyn=$dyn||{}),function(o){var e,t;e=o.util||(o.util={}),(t=e.ActionPaneHelpers||(e.ActionPaneHelpers={})).ApplyBarOverflow=function(e,t){e.isInOverflow=t,e.ButtonDisplay===o.ui.ButtonDisplay.imageOnly&&(e.ShowLabel=t)},t._removeAllOverflow=function(e){var t;if("AppBarSection"===this.TypeName)for(t=0;t<=e.length-1;)this._removeItemFromOverflow(e[t]),t++;else for(t=e.length-1;0<=t;)this._removeItemFromOverflow(e[t]),t--}}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(o){var e,n,t;function i(){return null!==n&&n.apply(this,arguments)||this}e=o.controls||(o.controls={}),n=e.Group,__extends(i,n),i.prototype.init=function(e,t){n.prototype.init.call(this,e,t),o.setValue(this,"LayoutArrangeMethod",o.layout.ArrangeMethod.vertical),this.LayoutColumns=o.layout.Columns.limitHeight},t=i,e.AppBarGroup=t}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(e){var t,o,n;function i(){return null!==o&&o.apply(this,arguments)||this}t=e.controls||(e.controls={}),o=t.Group,__extends(i,o),n=i,t.ToolbarGroup=n,e.ui.addPropertiesToPrototype(n.prototype,{AlwaysInOverflow:{defaultValue:!1,observable:!0}})}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(i){!function(e){Globalize.addCultureInfo("en",{messages:{AppBar_OverflowToolTip:"More"}});var t,o=(t=i.ui.Control,__extends(n,t),n);function n(){return null!==t&&t.apply(this,arguments)||this}e.OverflowButton=o}(i.controls||(i.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(m){var e,o,t;function n(){return null!==o&&o.apply(this,arguments)||this}e=m.controls||(m.controls={}),o=m.ui.Container,__extends(n,o),Object.defineProperty(n.prototype,"$overflowArea",{get:function(){return this._overflowArea&&this._overflowArea.length||(this._overflowArea=$(".overflow-menu",this.$toolbar)),this._overflowArea},enumerable:!1,configurable:!0}),n.prototype.init=function(e,t){var h=this;function a(){var o=0;return h.$toolbar.children().each(function(e,t){o+=t.dynWidth,"ActionGroup"===t.getAttribute("data-dyn-role")&&$(t).children().each(function(e,t){o+=t.dynWidth})}),o}o.prototype.init.call(this,e,t),this.OverflowMenuOpen=m.observable(!1),this.ShowOverflowButton=m.observable(!1),this.$toolbar=$(".appBar-toolbar",t),this.externalHostedButton=!1,this.hostedFilterButton=void 0,this.hostedSimpleListButton=void 0,this.hostedRelatedInfoButton=void 0,this.setPinnedTabOnPinning=!0,this._removeAllOverflow=function(){var e=$(".appBar-overflow-item",h.$overflowArea),t=h._reverseJqueryList(e);m.callFunction(m.util.ActionPaneHelpers._removeAllOverflow,h,t)},this._updateOverflowThrottled=function(){h._updateOverflowTimeout&&h._updateOverflowTimeout.cancel(),h._updateOverflowTimeout=m.async(h._updateOverflow,void 0,"AppBarSection overflow"),m.value(m.shell.isSmallViewPort)&&m.value(h.IsPinnedOpen)&&h._removePinnedTab()},this._checkCloseButtonExistance=function(){if(1===m.length(m.shell.stack)){var e=$(h.element).find('[data-dyn-controlname="SystemDefinedCloseButton"]')[0];e&&m.util.setVisibility(e,!1)}},this._updateOverflow=function(){if(m.value(h.Visible)){!function(){h.$toolbar.children().each(function(e,t){"ActionGroup"===t.getAttribute("data-dyn-role")?(t.dynWidth=parseInt(window.getComputedStyle(t).marginLeft,10),$(t).children().each(function(e,t){t.dynWidth=t.offsetWidth})):t.dynWidth=t.offsetWidth+parseInt(window.getComputedStyle(t).marginLeft,10)});var e=h.$toolbar.children(".actionGroup-right")[0],t=h.$toolbar.children(".actionGroup.actionGroup-right")[0],o=$(e).parent().children(".appBar-overflow")[0];0<(null==t?void 0:t.childElementCount)&&h.ShowOverflowButton()?o.classList.remove("hasRightGroup"):0===(null==t?void 0:t.childElementCount)&&o.classList.add("hasRightGroup"),!h.ShowOverflowButton()&&e&&o&&(e.dynWidth+=parseInt(window.getComputedStyle(o).width,10))}();var e=h.$toolbar.width(),t=e||$(window).width();if(t<=a())for(var o=void 0,n=(o=m.value(m.shell.zoomModeWidth)?h.$toolbar.children(":not([data-dyn-controlname=SysCloseGroup]):not(.actionGroup-right):not(.actionSearch):not(.appBar-overflow)").add(h.$toolbar.children('[data-dyn-role="ActionGroup"]').children()):h.$toolbar.children(":not([data-dyn-controlname=SysCloseGroup]):not(.actionGroup-right):not(.actionSearch):not(.appBar-overflow)").add(h.$toolbar.children('[data-dyn-role="ActionGroup"]:not(.actionGroup-right)').children())).length-1;t<=a()&&0<=n;)h._moveItemToOverflow(o[n]),n--;else{var i=$(".appBar-overflow-item",h.$overflowArea);if(t>a()){var r=h._reverseJqueryList(i);if(r&&r.length)for(n=0;n<=r.length-1&&t>a()+r[n].dynWidth;)h._removeItemFromOverflow(r[n]),n++}}h._checkOverflowAreaHasChildren()?h.ShowOverflowButton(!0):(h.ShowOverflowButton(!1),h.OverflowMenuOpen()&&h.OverflowMenuOpen(!1))}},this._appBarWatchedContent=m.computed(function(){var t,e,o,n,i=m.value(h.Children);if(i)try{for(var r=__values(i),a=r.next();!a.done;a=r.next()){var s=a.value;if("AppBarTab"===s.TypeName)m.value(s.Visible),m.value(s.Label);else if("ActionGroup"===s.TypeName){m.value(s.Visible);var l=m.value(s.Children);try{for(var u=(o=void 0,__values(l)),d=u.next();!d.done;d=u.next()){var c=d.value;m.value(c.Visible),m.value(c.Label)}}catch(e){o={error:e}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(o)throw o.error}}s.element.classList.contains("actionGroup-right")&&h.externalHostedButton&&(void 0===h.hostedFilterButton&&(h.hostedFilterButton=m.context(s.element.getElementsByClassName("button_showFilters")[0])),void 0!==h.hostedFilterButton&&(m.value(h.hostedFilterButton.Visible),m.value(h.hostedFilterButton.Label)),void 0===h.hostedSimpleListButton&&(h.hostedSimpleListButton=m.context(s.element.getElementsByClassName("button_showList")[0])),void 0!==h.hostedSimpleListButton&&(m.value(h.hostedSimpleListButton.Visible),m.value(h.hostedSimpleListButton.Label)),void 0===h.hostedRelatedInfoButton&&(h.hostedRelatedInfoButton=m.context(s.element.getElementsByClassName("factBoxPane-toggleButton")[0])),void 0!==h.hostedRelatedInfoButton&&(m.value(h.hostedRelatedInfoButton.Visible),m.value(h.hostedRelatedInfoButton.Label)),void 0===h.hostedFilterButton&&void 0===h.hostedSimpleListButton&&void 0===h.hostedRelatedInfoButton&&(h.externalHostedButton=!1))}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}var p=m.context($(h.element).find('[data-dyn-role="AppBarSearchField"]')[0]);p&&m.value(p.SearchFieldShown)}),this._zoomModeWidthObserver=m.observe(m.shell.zoomModeWidth,function(e){h._removeAllOverflow()}),m.observe(this.Children,function(e){h._pinnedTab&&-1===e.indexOf(h._pinnedTab)&&h._removePinnedTab()}),m.observe(this.IsPinnedOpen,function(e){e?m.value(h.LastActiveTabName)&&h.setPinnedTabOnPinning&&h._pinTabByTabName(m.value(h.LastActiveTabName)):h._removePinnedTab(),h.Root&&h.Root.reflow()}),m.observe(this.LastActiveTabName,function(e){m.value(h.IsPinnedOpen)&&h._pinTabByTabName(e)}),this._isAsidePaneOpenOverflowSubscription=m.shell.isAsidePaneOpen.valueChanged.subscribe(this._updateOverflowThrottled,this),$(window).on("resize",this._updateOverflowThrottled),$(document.body).on("resetShellOnNavigation",this._updateOverflowThrottled),m.isEmbedded&&$(document.body).on("resetShellOnNavigation",this._checkCloseButtonExistance),this._watchedContentOverflowSubscription=m.observe(this._appBarWatchedContent,this._updateOverflowThrottled),this.$toolbar.on("contentHandlersReplaceStarted",this._removeAllOverflow),this.$toolbar.on("contentHandlersReplaceFinished",this._updateOverflowThrottled)},n.prototype.addHostedButton=function(e){var t=$(this.element).find('[data-dyn-controlname="SystemDefinedCloseButton"]')[0];e&&t&&(this.externalHostedButton=!0,t.parentNode.append(e))},n.prototype.overflowClickSubscriber=function(e){var t=$(e.clickTarget);return!(e.isRightClick||e.flyoutElement&&t.closest(e.flyoutElement).length&&(t.is(e.flyoutElement)||t.closest(".dropDialogButton, .flyoutButton-Button, [disabled]").length))},n.prototype.dispose=function(){this._updateOverflowTimeout&&(this._updateOverflowTimeout.cancel(),this._updateOverflowTimeout=void 0),this.$toolbar.off("contentHandlersReplaceStarted",this._removeAllOverflow),this.$toolbar.off("contentHandlersReplaceFinished",this._updateOverflowThrottled),$(document.body).off("resetShellOnNavigation",this._updateOverflowThrottled),$(document.body).off("resetShellOnNavigation",this._checkCloseButtonExistance),$(window).off("resize",this._updateOverflowThrottled),m.shell.isAsidePaneOpen.valueChanged.unsubscribe(this._isAsidePaneOpenOverflowSubscription),this._watchedContentOverflowSubscription&&(this._watchedContentOverflowSubscription.dispose(),this._watchedContentOverflowSubscription=null),this._zoomModeWidthObserver&&(this._zoomModeWidthObserver.dispose(),this._zoomModeWidthObserver=void 0),o.prototype.dispose.call(this)},n.prototype._removeItemFromOverflow=function(e){var t=!1;$(e).hasClass("appBar-overflow-item-right")&&(t=!0),$(e).parent().hasClass("listitem")&&$(e).parent().detach(),$(e).detach(),e.classList.remove("appBar-overflow-item","appBar-overflow-item-right");var o=e.getAttribute("data-dyn-role");"ActionGroup"===o||"AppBarTab"===o||e.classList.contains("actionPane-replace")?$(".actionSearch",this.$toolbar).before(e):t?0<this.$toolbar.children(".actionGroup-right.actionGroup").children().length?this.$toolbar.children(".actionGroup-right.actionGroup").children().last().after(e):this.$toolbar.children(".actionGroup-right.actionGroup").append(e):this.$toolbar.children('[data-dyn-role="ActionGroup"]:not(.actionGroup-right)').last().append(e);var n=m.context(e);n&&(m.util.ActionPaneHelpers.ApplyBarOverflow(n,!1),n.overflowMenuUpdate&&n.overflowMenuUpdate(!1))},n.prototype._setPinnedTab=function(e,t,o){if(void 0===o&&(o=!1),this._removePinnedTab(),this.IsPinnedOpen()){this._pinnedTab=e;var n=$(t);n.detach().appendTo(this.element),n.css("position",""),n.css("left",""),n.css("top",""),n.css("min-width",""),n.css("max-width",""),n.css("max-height",""),m.util.setVisibility(t,!0,!0),e.Expanded(!0),e.element.querySelector(".appBarTab-header").setAttribute("aria-expanded","true"),o&&m.util.flyout.focusFirstControlInFlyout(t)}},n.prototype._removePinnedTab=function(e){void 0===e&&(e=!1),this._pinnedTab&&(this._pinnedTab.Expanded(!1),this._pinnedTab.element.querySelector(".appBarTab-header").setAttribute("aria-expanded","false"),m.util.setVisibility(this._pinnedTab._tabFlyoutElement,!1,!0),$(this._pinnedTab._tabFlyoutElement).detach().appendTo(this._pinnedTab.element),e&&this._pinnedTab.Root&&this._pinnedTab.Root.setControlFocus&&this._pinnedTab.Root.setControlFocus(this._pinnedTab.element),this._pinnedTab=void 0)},n.prototype._moveItemToOverflow=function(e){function t(){for(var e=o.$overflowArea.children().length-1,t=[];0<=e;)t.push(o.$overflowArea.children()[e]),e--;$(t).appendTo(o.$overflowArea)}var o=this;m.ui.removeFocus($(e))&&m.async(function(){$(".appBar-overflow",o.$toolbar).focus()},void 0,"Move focus to overflow button"),$(e.parentElement).hasClass("actionGroup-right")&&e.classList.add("appBar-overflow-item-right"),$(e).detach(),e.classList.add("appBar-overflow-item");var n=e.getAttribute("data-dyn-role");if(t(),"AppBarTab"===n||e.classList.contains("actionGroup-overflow")||e.classList.contains("actionPane-replace")){var i=$(e).wrap("<div role='listitem' class='listitem'></div>");this.$overflowArea.append(i.parent()[0])}else this.$overflowArea.children().find(".actionGroup-overflow").last().prepend(e);t();var r=m.context(e);r&&(m.util.ActionPaneHelpers.ApplyBarOverflow(r,!0),r.overflowMenuUpdate&&r.overflowMenuUpdate(!0))},n.prototype._checkOverflowAreaHasChildren=function(){return!(!this.$overflowArea.children()||!this.$overflowArea.children().length||2===this.$overflowArea.children().length&&$(this.$overflowArea.children()[0]).hasClass("firstFocusable")&&$(this.$overflowArea.children()[1]).hasClass("lastFocusable"))},n.prototype._reverseJqueryList=function(n){for(var i=[],r=0;r<=n.length-1;)$(n[r]).find(".appBar-overflow-item").each(function(e,t){i.push(t);for(var o=r+1;o<=n.length-1;){if(n[o]===t){n[o]=void 0;break}o++}}),void 0!==n[r]&&i.push(n[r]),r++;return i},n.prototype._pinTabByTabName=function(n){var t,e,o=m.value(this.Children);if(o){var i=function(e){if(e&&e._tabFlyoutElement&&"AppBarTab"===e.TypeName&&e.Name===n){var t=e,o=t.element===r.Root.GetFocusedControl();return!m.value(t.Expanded)&&t.TabShown&&m.async(function(){m.applyFunction(t.TabShown,t)},void 0,"async call triggered for tab shown when last active tab name observable changed from server"),r._setPinnedTab(t,t._tabFlyoutElement,o),"break"}},r=this;try{for(var a=__values(o),s=a.next();!s.done&&"break"!==i(s.value);s=a.next());}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}}},t=n,e.AppBarSection=t,m.ui.addObservablePropertiesToPrototype(t.prototype,{IsPinnedOpen:!1,LastActiveTabName:""})}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){!function(e){Globalize.addCultureInfo("en",{messages:{AppBar_CollapseToolTip:"Collapse the action pane",AppBar_PinToolTip:"Pin action pane open"}});var i,t=(i=r.ui.Container,__extends(o,i),o.prototype.init=function(e,o){var n=this;i.prototype.init.call(this,e,o),this._tabFlyoutElement=o?o.querySelector(".appBar-flyout"):void 0;var t=!1;this.Expanded=r.computed(function(){var e=r.value(n.HasBeenOpened);return e?t:e},function(e){t=e}),this.FlyoutExpanded=r.computed(function(){return n.Expanded()&&!n.IsAppBarPinnedOpen()},function(e){n.Expanded(e)}),this.IsAppBarPinnedOpen=r.computed(function(){var e=n._getClosestAppBar(),t=!1;return e&&(t=r.value(e.IsPinnedOpen)),t}),this.pinButtonLabel=r.computed(function(){return n.IsAppBarPinnedOpen()?r.label("AppBar_CollapseToolTip"):r.label("AppBar_PinToolTip")}),this.flyoutExitAnimation=r.computed(function(){return n.IsAppBarPinnedOpen()?void 0:"appBar-shrinkHeight"}),r.observe(this.HasBeenOpened,function(e){if(e&&n._tabFlyoutElement){var t=r.role(o);t&&o&&r.async(function(){t.dataBindChild(n._tabFlyoutElement,o.dynContext),n._tabFlyoutElement.dynHasArranged?r.layout.queueArrange(n._tabFlyoutElement):r.layout.arrange(n._tabFlyoutElement,!0)},void 0,"Data bind newly opened AppBarTab")}}),r.observe(r.options(function(){return{expanded:n.Expanded}},r.ui.updating),function(e){e.expanded&&r.layout.queueArrange(n._tabFlyoutElement)}),r.setValue(this,"ArrangeMethod",r.layout.ArrangeMethod.none),r.observe(this.IsInitiallyOpened,function(e){r.value(e)&&!r.value(r.shell.isSmallViewPort)&&r.async(function(){var e=n._getClosestAppBar();e&&e._setPinnedTab(n,n._tabFlyoutElement)},void 0,"Pin open initial AppBarTab")}),r.observe(this.Visible,function(e){!e&&n.Expanded()&&n.IsAppBarPinnedOpen()&&n._togglePinnedState()}),this.OriginalPinnedState=this.IsAppBarPinnedOpen()},o.prototype.getHeader=function(){return $(this.element).find(".appBarTab-header")},o.prototype.isControlAvailableForExpando=function(){return!0},o.prototype.getExpandoPersonalizationFocusTarget=function(){return this.getHeader()},o.prototype.keyDown=function(e){e.which===r.ui.KeyCodes.enter&&(e.stopPropagation(),r.log.stopPropagation&&r.log.stopPropagation("Prevent form level Enter shortcut.")),r.util.isShortcutKeyPressed(e,{alt:!0,keyCode:r.ui.KeyCodes.downArrow})&&(e.stopPropagation(),e.preventDefault(),this._headerClicked())},o.prototype.contentKeyDown=function(e){this.IsAppBarPinnedOpen()&&r.util.isShortcutKeyPressed(e,{keyCode:r.ui.KeyCodes.esc})&&(e.stopPropagation(),e.preventDefault(),this.togglePinnedState(!0))},o.prototype.flyoutClickSubscriber=function(e){var t=$(e.clickTarget),o=r.context(e.clickTarget);return!(e.isRightClick||t.is(".appBar-overflow")||e.flyoutElement&&t.closest(e.flyoutElement).length&&(t.closest(".dropDialogButton, .flyoutButton-Button, [disabled]").length||t.is(".appBarTab-content, .group, .group_content, .group_title, .appBar-flyout, .appBar-pin"))||o&&o.Command===r.forms.Events.personalize)},o.prototype.getTaskGuideParams=function(e){return(e=i.prototype.getTaskGuideParams.call(this,e)).my=r.layout.qTipPosition.topCenter,e.at=r.layout.qTipPosition.bottomCenter,e},o.prototype.pinKeyDown=function(e){r.util.isShortcutKeyPressed(e,{keyCode:r.ui.KeyCodes.enter})&&(e.preventDefault(),e.stopPropagation(),this.togglePinnedState(!0))},o.prototype._togglePinnedState=function(e){var t=!!e;this.togglePinnedState(t)},o.prototype._headerClicked=function(e){var t=this;if(r.value(this.Enabled)){var o=this._getClosestAppBar();if(this._personalizeFormOpenHandler=this.personalizeFormOpenHandler.bind(this),$(window).on(r.forms.Events.personalize,this._personalizeFormOpenHandler),r.ax&&r.ax.personalizationUtil&&r.ax.personalizationUtil.isPersonalizationModeTurnedOn()&&(o&&o.IsPinnedOpen(!0),this.Expanded(!1)),this.Expanded()||(r.applyFunction(this.TabShown,this),this._updateFlyoutWidth()),this.IsAppBarPinnedOpen())if(this.Expanded())r.util.flyout.focusFirstControlInFlyout(this._tabFlyoutElement);else{var n=!!e;o&&o._setPinnedTab(this,this._tabFlyoutElement,n)}else r.flags.disableAnimations||this.Expanded()||$(".appBar-shrinkHeight").length<=0?this.Expanded(!this.Expanded()):r.async(function(){t.Expanded(!t.Expanded())},r.ui.motionTiming.basic,"Wait for any other tab to finish closing animation first");r.ax&&r.ax.personalizationUtil&&r.ax.personalizationUtil.forceUpdateFormPersonalizationData(),void 0===this._asidePaneWidthSubscription&&(this._asidePaneWidthSubscription=r.shell.asidePaneWidth.valueChanged.subscribe(this._updateFlyoutWidth,this)),this._personalizeFormCloseHandler=this.personalizeFormCloseHandler.bind(this),$(window).on("personalizationToolbarClosed",this._personalizeFormCloseHandler)}},o.prototype.dispose=function(){r.value(this.HasBeenOpened)&&r.unbind(this._tabFlyoutElement),this._personalizeFormOpenHandler&&$(window).off(r.forms.Events.personalize,this._personalizeFormOpenHandler),this._personalizeFormCloseHandler&&$(window).off("personalizationToolbarClosed",this._personalizeFormCloseHandler),r.shell.asidePaneWidth.valueChanged.unsubscribe(this._asidePaneWidthSubscription),i.prototype.dispose.call(this)},o.prototype._getClosestAppBar=function(){if(!this._appBar){var e=this.isInOverflow?$(r.context(this.element.parentElement).element).closest(".appBar-toolbar"):$(this.element).closest(".appBar-toolbar");e&&e.length&&(this._appBar=r.context(e[0]))}return this._appBar},o.prototype.personalizeFormOpenHandler=function(){var e=this._getClosestAppBar();e&&!e.IsPinnedOpen()&&this._tabFlyoutElement&&this.togglePinnedState(!0,!1)},o.prototype.personalizeFormCloseHandler=function(){var e=this._getClosestAppBar();e&&this.OriginalPinnedState!==e.IsPinnedOpen()&&this.togglePinnedState(!0,!1)},o.prototype.togglePinnedState=function(e,t){var o=this;void 0===t&&(t=!0);var n=this.IsAppBarPinnedOpen(),i=this._getClosestAppBar();t&&(this.OriginalPinnedState=!n),i&&(n&&i._removePinnedTab(e),n=!n,!r.value(r.shell.isSmallViewPort)&&n&&(i.setPinnedTabOnPinning=!1),i.IsPinnedOpen(n),r.value(r.shell.isSmallViewPort)||(t&&r.callFunction(i.PersistPersonalization,i,["IsActionPanePinnedOpen",n]),n&&r.async(function(){i._setPinnedTab(o,o._tabFlyoutElement,e),i.setPinnedTabOnPinning=!0},void 0,"Pin tab after flyout closes")))},o.prototype._updateFlyoutWidth=function(){!0===r.value(this.Visible)?r.shell.isAsidePaneOpen()&&(this._tabFlyoutElement.style.right=r.value(r.shell.asidePaneWidth)+"px"):this._tabFlyoutElement.style.right="0"},o);function o(){var t=null!==i&&i.apply(this,arguments)||this;return t.getFlyoutAnchor=function(){var e;return $(null===(e=t._getClosestAppBar())||void 0===e?void 0:e.element)},t}(e.AppBarTab=t).prototype.Label="",t.prototype.ImageType="",t.prototype.ImageName="",t.prototype.OriginalPinnedState=!1,t.prototype.TabShown=function(){r.setValue(this,"HasBeenOpened",!0)},r.ui.addObservablePropertiesToPrototype(t.prototype,{HasBeenOpened:!1,IsInitiallyOpened:!1})}(r.controls||(r.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(u){var e,r,t;function o(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return i._toolBarElementOverFlowMap={},u.setValue(i,"ArrangeMethod",u.layout.ArrangeMethod.none),i}e=u.controls||(u.controls={}),r=u.ui.Container,__extends(o,r),Object.defineProperty(o.prototype,"$overflowArea",{get:function(){return this._overflowArea&&this._overflowArea.length||(this._overflowArea=$(this.element.querySelector(".overflow-menu"))),this._overflowArea},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"$toolbar",{get:function(){return this._toolbar&&this._toolbar.length||(this._toolbar=$(this.element)),this._toolbar},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"$overflowButton",{get:function(){return this._overflowButton&&this._overflowButton.length||(this._overflowButton=$(this.element.querySelector(".toolbar-overflow"))),this._overflowButton},enumerable:!1,configurable:!0}),o.prototype.init=function(e,t){var s=this;function l(){var o=0;return s.$toolbar.children().each(function(e,t){if(s.$overflowButton&&t===s.$overflowButton[0]&&s._checkOverflowAreaHasChildren())return o+=parseInt(window.getComputedStyle(s.$overflowButton[0]).width,10),!1;t.classList.contains("toolbarGroup-alwaysInOverflow")||(o+=isNaN(t.dynWidth)?0:t.dynWidth,$(t).children().each(function(e,t){o+=isNaN(t.dynWidth)?0:t.dynWidth,"ToolbarGroup"===t.getAttribute("data-dyn-role")&&$(t).children().each(function(e,t){o+=t.dynWidth})}))}),o}r.prototype.init.call(this,e,t),this.OverflowMenuOpen=u.observable(!1),this._updateOverflow=function(){var e=s.$toolbar.is(":visible");if(u.value(s.Visible)&&e){s.$toolbar.children('[data-dyn-role="ToolbarGroup"]').each(function(e,t){u.context(t).AlwaysInOverflow&&(t.classList.add("toolbar-alwaysInOverflow-item"),$(t).children().each(function(e,t){t.classList.contains("toolbarGroup-overflow")&&t.classList.add("toolbarGroup-alwaysInOverflow"),t.classList.add("toolbar-alwaysInOverflow-item")}))}),s.$toolbar.children().each(function(e,t){"ToolbarGroup"===t.getAttribute("data-dyn-role")?(t.dynWidth=parseInt(window.getComputedStyle(t).marginLeft,10),$(t).children().each(function(e,t){"ToolbarGroup"===t.getAttribute("data-dyn-role")?(t.dynWidth=parseInt(window.getComputedStyle(t).marginLeft,10),$(t).children().each(function(e,t){t.dynWidth=t.offsetWidth})):t.dynWidth=t.offsetWidth})):t.dynWidth=t.offsetWidth+parseInt(window.getComputedStyle(t).marginLeft,10)});var t=s.$toolbar.width(),o=$.data(s.$toolbar[0],"lastKnownWidth"),n=s.$toolbar.children('[data-dyn-role="ToolbarGroup"]').length;if(o&&o===t)s.$toolbar.removeClass("reflowContent");else{$.data(s.$toolbar[0],"lastKnownWidth",t);var i,r=void 0!==t?t:$(window).width();if((s.$overflowButton&&t===s.$overflowButton.outerWidth()+n||t===n)&&s.$toolbar.next()[0]&&(r=s.$toolbar.next().width()),s._moveAlwaysInOverflowItems(),r<l())for(var a=(i=s.$toolbar.children(":not(.toolbar-overflow)").add(s.$toolbar.children('[data-dyn-role="ToolbarGroup"]').children()).add(s.$toolbar.children('[data-dyn-role="ToolbarGroup"]').children('[data-dyn-role="ToolbarGroup"]').children())).length-1;r<l()&&0<=a;)s._moveItemToOverflow(i[a]),a--;else for(a=(i=$(".toolbar-overflow-item",s.$overflowArea)).length-1;0<=a&&r>l()+i[a].dynWidth;)s._removeItemFromOverflow(i[a]),a--;s.$overflowButton[0]&&s._checkOverflowAreaHasChildren()?s.$overflowButton[0].style.display="":(s.$overflowButton[0]&&(s.$overflowButton[0].style.display="none"),s.OverflowMenuOpen()&&s.OverflowMenuOpen(!1)),s.$toolbar.removeClass("reflowContent")}}e||s.$toolbar.removeClass("reflowContent")},this._updateOverflowThrottled=function(){s._updateOverflowTimeout&&s._updateOverflowTimeout.cancel(),s._updateOverflowTimeout=u.async(s._updateOverflow,void 0,"Toolbar overflow")},this._cancelPendingOverflow=function(){s._updateOverflowTimeout&&s._updateOverflowTimeout.cancel(),s.$overflowButton[0].style.display="none",s.$toolbar.removeClass("reflowContent")},this._toolbarWatchedContent=u.computed(function(){var t,e;function l(e,t){var o,n;u.value(t.Visible);var i=u.value(t.Children);if(i)try{for(var r=__values(i),a=r.next();!a.done;a=r.next()){var s=a.value;e._toolBarElementOverFlowMap[s.Id]={ParentContainer:s._parent,OriginalRole:s.element.getAttribute("role")},"ToolbarGroup"===s.TypeName?(u.value(s.Visible),l(e,s)):(u.value(s.Visible),u.value(s.Label))}}catch(e){o={error:e}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}}var o=u.value(s.Children);if(o)try{for(var n=__values(o),i=n.next();!i.done;i=n.next()){var r=i.value;"ToolbarGroup"===r.TypeName&&(s._toolBarElementOverFlowMap[r.Id]={ParentContainer:r._parent,OriginalRole:r.element.getAttribute("role")},l(s,r))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}}),this._layoutReflowStartHandler=u.layout.registerStartReflowHandler(this.$toolbar[0].parentElement,function(){s.$toolbar.addClass("reflowContent")}),this._layoutReflowEndHandler=u.layout.registerEndReflowHandler(this.$toolbar[0].parentElement,this._updateOverflowThrottled),this._watchedContentOverflowSubscription=u.observe(this._toolbarWatchedContent,function(){$.removeData(s.$toolbar[0],"lastKnownWidth"),s._updateOverflowThrottled()}),this._removeAllOverflow=function(){var e=$(".toolbar-overflow-item",s.$overflowArea);u.callFunction(u.util.ActionPaneHelpers._removeAllOverflow,s,e),$.removeData(s.element,"lastKnownWidth")},this.$toolbar.on("contentHandlersReplaceStarted",this._removeAllOverflow),this._initiateOverflow=function(){s.$toolbar.addClass("reflowContent"),s._updateOverflowThrottled()},this.$toolbar.on("contentHandlersReplaceFinished",this._initiateOverflow),this._partCreatedHandler=function(e,t){s.Root&&t&&s.Root.Id===t.Id&&(s._initiateOverflow(),$(document.body).off(u.forms.Events.partCreated,s._partCreatedHandler))},$(document.body).on(u.forms.Events.partCreated,this._partCreatedHandler),this.isInGrid()&&(this._gridLayoutCompleteHandler=function(e){$.contains(e.target,s.element)&&s._initiateOverflow()},$(document.body).on(u.forms.Events.gridLayoutCompleted,this._gridLayoutCompleteHandler))},o.prototype.overflowClickSubscriber=function(e){var t=$(e.clickTarget);return!(e.isRightClick||e.flyoutElement&&t.closest(e.flyoutElement).length&&(t.is(e.flyoutElement)||t.closest(".dropDialogButton, .flyoutButton-Button, [disabled]").length))},o.prototype.dispose=function(){this._updateOverflowTimeout&&(this._updateOverflowTimeout.cancel(),this._updateOverflowTimeout=void 0),this.$toolbar.off("contentHandlersReplaceStarted",this._removeAllOverflow),this.$toolbar.off("contentHandlersReplaceFinished",this._initiateOverflow),$(document.body).off("resetShellOnNavigation",this._updateOverflowThrottled),this._watchedContentOverflowSubscription&&(this._watchedContentOverflowSubscription.dispose(),this._watchedContentOverflowSubscription=null),this._layoutReflowEndHandler&&(this._layoutReflowEndHandler.dispose(),this._layoutReflowEndHandler=null),this._layoutReflowStartHandler&&(this._layoutReflowStartHandler.dispose(),this._layoutReflowStartHandler=null),$.removeData(this.$toolbar[0],"lastKnownWidth"),$(document.body).off(u.forms.Events.partCreated,this._partCreatedHandler),this._gridLayoutCompleteHandler&&$(document.body).off(u.forms.Events.gridLayoutCompleted,this._gridLayoutCompleteHandler),this._toolbarWatchedContent&&(this._toolbarWatchedContent.valueChanged&&this._toolbarWatchedContent.valueChanged.clearAllDependencies&&this._toolbarWatchedContent.valueChanged.clearAllDependencies(),this._toolbarWatchedContent=null),r.prototype.dispose.call(this)},o.prototype._removeItemFromOverflow=function(e){$(e).parent().hasClass("listitem")&&$(e).parent().detach(),$(e).detach(),e.classList.remove("toolbar-overflow-item");var t=u.context(e),o=e.id;!o&&t&&(o=t.Id);var n=e.getAttribute("data-dyn-role"),i=this._toolBarElementOverFlowMap[o]?this._toolBarElementOverFlowMap[o].OriginalRole:null;this._toolBarElementOverFlowMap[o]&&this._toolBarElementOverFlowMap[o].ParentContainer.element?$(this._toolBarElementOverFlowMap[o].ParentContainer.element).append(e):"ToolbarGroup"===n||e.classList.contains("toolbar-replace")?$(".toolbar-overflow",this.$toolbar).before(e):this.$toolbar.children('[data-dyn-role="ToolbarGroup"]').last().append(e),i?$(e).attr("role",i):$(e).removeAttr("role"),t&&u.util.ActionPaneHelpers.ApplyBarOverflow(t,!1)},o.prototype._checkOverflowAreaHasChildren=function(){return!(!this.$overflowArea.children()||!this.$overflowArea.children().length||2===this.$overflowArea.children().length&&$(this.$overflowArea.children()[0]).hasClass("firstFocusable")&&$(this.$overflowArea.children()[1]).hasClass("lastFocusable"))},o.prototype._moveItemToOverflow=function(e){var t=this;u.ui.removeFocus($(e))&&u.async(function(){t.$overflowButton.focus()},void 0,"Move focus to overflow button"),$(e).detach(),e.classList.contains("toolbar-alwaysInOverflow-item")||e.classList.add("toolbar-overflow-item");var o=$(e).wrap("<div role='listitem' class='listitem'></div>");e.classList.contains("toolbarGroup-overflow")||e.classList.contains("toolbar-replace")?this.$overflowArea.append(e):e.classList.contains("toolbar-alwaysInOverflow-item")?this.$overflowArea.children(".toolbarGroup-alwaysInOverflow").last().append(o.parent()[0]):this.$overflowArea.children(".toolbarGroup-overflow:not(.toolbarGroup-alwaysInOverflow)").last().append(o.parent()[0]);var n=u.context(e);n&&u.util.ActionPaneHelpers.ApplyBarOverflow(n,!0),e.classList.contains("toolbarGroup-overflow")&&$(e).attr("role","presentation")},o.prototype._moveAlwaysInOverflowItems=function(){for(var e=this.$toolbar.children(".toolbar-alwaysInOverflow-item").add(this.$toolbar.children(".toolbar-alwaysInOverflow-item").children()),t=e.length-1;0<=t;)this._moveItemToOverflow(e[t]),t--},t=o,(e.Toolbar=t).prototype.Width=u.layout.Size.available}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){!function(e){Globalize.addCultureInfo("en",{messages:{AppBarSearch_Collapse:"Collapse action search",AppBarSearch_HelpText:"(Ctrl+')",AppBarSearch_Label:"Search for an action"}});var i,t=(i=e.CombinedSearchField,__extends(o,i),o.prototype.init=function(e,t){var o=this;i.prototype.init.call(this,e,t);var n=this.SearchFieldElement();r.observe(r.options(function(){return{resultData:o.ResultList,selectedIndex:o.SelectedIndex}},this.Updating),function(e){0===r.value(e.resultData).length&&n.setAttribute("aria-label",r.label("Search_NoResultsMessage"))}),this.ShowResultPicker.valueChanged.subscribe(function(){n&&r.value(o.ShowResultPicker)?(o.SearchField().$inputElement.attr("aria-controls",r.value(o.Id)+"_listbox"),o.SearchField().$inputElement.attr("aria-activedescendant",r.value(o.Id)+"_listbox_item"+r.value(o.SelectedIndex))):n&&o.cleanUpPicker()})},o.prototype.postDataBindChildren=function(){var e=this.SearchFieldElement().getElementsByClassName("field")[0];e.setAttribute("aria-label",r.label("AppBarSearch_Label")),e.setAttribute("aria-controls",r.value(this.Id)+"_listbox"),e.setAttribute("aria-activedescendant",null)},o.prototype.showField=function(){this._getSearchIcon().tabIndex=-1,this.SearchFieldShown(!0),this.focusElementHandled=!1,this.Root.setControlFocus(this.element,this.Root.ActiveElement())},o.prototype.searchIconClicked=function(){r.value(this.SearchFieldShown)?this.hideField():this.showField()},o.prototype.clickItem=function(e){var t=r.value(this.ResultList);if(!(e>t.length)&&t[e].Enabled){this.ProcessResults=!1,this.SelectedIndex(e);var o,n=t[e];if(r.telemetry.addActionSearchEvent(this.Root,this.lastSearchedQuery,e,n.Name,n.Path+" > "+n.Label),this.recordTelemetryOnClose=!1,n.Command&&(o=$.Event(n.Command),$(this.element).trigger(o)),!o||!o.isDefaultPrevented()){var i=r.context(this.Root.ActiveElementInMainFormContainer());i&&r.callFunction(this.Root.UpdateLastSelectedControl,this.Root,[i.Name]),r.callFunction(this.Root.ExecuteActionSearchClick,this.Root,n.Name)}this.closeResultPicker(null,!0),this.hideField()}},o.prototype.focusout=function(e){this.focusElementHandled||e.target!==this.SearchFieldElement().getElementsByClassName("field")[0]||$(e.relatedTarget).parents(".actionSearch-results").length||(this.hideField(),this._getSearchIcon().focus())},o.prototype.cleanUpPicker=function(){r.value(this.SearchFieldShown)&&(this.focusElementHandled=!0,this.closeResultPicker(null,!0))},o.prototype.getActiveIsLoadingAnimation=function(){return this._activeIsLoadingAnimation},o.prototype.setActiveIsLoadingAnimation=function(e){this._activeIsLoadingAnimation=e},o.prototype.TextChanged=function(e){var t=this;""!==e[0]&&this.element.parentElement.classList.add("actionSearch-hidePlaceholder");var n=this.SearchField;n.ProcessResults=!0,this.$inputElement[0].value?(n.recordTelemetryOnClose=!0,n.lastSearchedQuery=this.$inputElement[0].value,r.callFunction(this.Root.ExecuteActionSearch,this,[this.$inputElement[0].value],function(e){r.util.removeLoadingAnimation(n.element);var t=n.SearchField().$inputElement[0].value;if(n.ProcessResults&&t){if(e){var o=JSON.parse(e);o.length?n.ResultList(o):n.ResultList([])}else n.ResultList([]);n.openResultPicker()}},void 0,function(){r.util.activateLoadingAnimation(n.element,t,void 0,void 0,r.flags.disableAnimations?0:500)},void 0,function(){var e=n.getActiveIsLoadingAnimation();e?e.cancel(!0):r.util.removeLoadingAnimation(t.element)})):(n.ShowResultPicker(!1),n.ResultList([]),n.element.classList.remove("actionSearch-hidePlaceholder"))},o.prototype.closeResultPicker=function(e,t){void 0===t&&(t=!1),this.ProcessResults=!1,this.ShowResultPicker(!1),t&&this.ResultList([]);var o=this.SearchFieldElement().getElementsByClassName("field")[0];o.setAttribute("aria-label",r.label("AppBarSearch_Label")),o.removeAttribute("aria-controls"),o.removeAttribute("aria-activedescendant"),this.focusElementHandled||this.returnFocus()},o.prototype.nextItem=function(){var e=r.value(this.SelectedIndex),t=r.value(this.ResultList);e++,t&&e>=t.length&&(e=0),this.SelectedIndex(e),this.scrollSelectedResultIntoView(e),this.SearchField().$inputElement.attr("aria-activedescendant",r.value(this.Id)+"_listbox_item"+e)},o.prototype.previousItem=function(){var e=r.value(this.SelectedIndex),t=r.value(this.ResultList);--e<0&&t&&(e=t.length-1),this.SelectedIndex(e),this.scrollSelectedResultIntoView(e),this.SearchField().$inputElement.attr("aria-activedescendant",r.value(this.Id)+"_listbox_item"+e)},o.prototype.SearchFieldElement=function(){return this._searchFieldElement||(this._searchFieldElement=this.element.getElementsByClassName("actionSearch-field")[0]),this._searchFieldElement},o.prototype.hideField=function(){this._getSearchIcon().tabIndex=0,this.SearchFieldShown(!1),this.SearchField().$inputElement.val(""),this.SearchField().$inputElement.removeAttr("aria-controls"),this.SearchField().$inputElement.removeAttr("aria-activedescendant"),this.SearchFieldElement().parentElement.classList.remove("actionSearch-hidePlaceholder"),this.recordTelemetryOnClose&&(this.recordTelemetryOnClose=!1,r.telemetry.addActionSearchEvent(this.Root,this.lastSearchedQuery,-1))},o.prototype._getSearchIcon=function(){return this._searchIconElement||(this._searchIconElement=this.element.getElementsByClassName("actionSearch-icon")[0]),this._searchIconElement},o.prototype.returnFocus=function(){if(this.Root){var e=r.context(this.Root.ActiveElementInMainFormContainer());e&&(this.focusElementHandled=!0,this.hideField(),r.setValue(this.Root,"ActiveControl",e.Name))}},o);function o(){return null!==i&&i.apply(this,arguments)||this}(e.AppBarSearchField=t).prototype.recordTelemetryOnClose=!1,r.ui.addObservablePropertiesToPrototype(t.prototype,{SearchFieldShown:!1});var n={Enter:{Keys:{keyCode:r.ui.KeyCodes.enter},Handler:function(){if(0<r.length(this.ResultList))if(r.value(this.ShowResultPicker)){var e=r.value(this.SelectedIndex);r.value(this.ResultList)[e].Enabled&&(this.clickItem(e),this.hideField())}else this.openResultPicker();else this.showField()},RecordTelemetry:!1,Description:function(){var e="";return r.value(this.SearchFieldShown)?0<r.length(this.ResultList)&&(e=r.value(this.ShowResultPicker)?r.label("Search_PerformAction"):r.label("Search_ViewResults")):e=r.label("GlobalSearchPlaceholder_Action"),e}},Esc:{Keys:{keyCode:r.ui.KeyCodes.esc},Handler:function(e){return!!r.value(this.SearchFieldShown)&&(r.value(this.ShowResultPicker())?this.cleanUpPicker():(this.hideField(),this._getSearchIcon().focus()),!0)},RecordTelemetry:!1,ShowToUser:function(){return r.value(this.ShowResultPicker)||r.value(this.SearchFieldShown)},Description:function(){var e="";return r.value(this.ShowResultPicker)?e=r.label("Search_Close"):r.value(this.SearchFieldShown)&&(e=r.label("AppBarSearch_Collapse")),e}},Tab:{Keys:{keyCode:r.ui.KeyCodes.tab,isShiftKeyAgnostic:!0},Handler:function(){return r.value(this.SearchFieldShown)?(r.value(this.ShowResultPicker())&&this.cleanUpPicker(),this.hideField(),this._getSearchIcon().focus(),!0):!!r.value(this.ShowResultPicker)&&(this.cleanUpPicker(),!0)},ShowToUser:!1,RecordTelemetry:!1}};t.prototype.Shortcuts=r.extendPrototype(t.prototype.Shortcuts,n)}(r.controls||(r.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(p){var e;(e=p.ui||(p.ui={})).LegacyNavBarFeatureName="LegacyNavBar",e.legacyNavBarChanged=function(e){if(!e){var t=p.ui.getNavBar();t&&(t.OfficeNavBarVisible?t.OfficeNavBarVisible(!0):p.restrictedNavigation&&t.element.classList.add("officeNavBar"))}},e.allowFullPageTabbingFeatureChanged=function(e){var t=p.ui.getNavBar();t&&t.resetTabbingContainer&&t.resetTabbingContainer(!1===e)},e._cachedNavBar=null,e.getNavBar=function(){return p.ui._cachedNavBar||(p.ui._cachedNavBar=p.context(document.body.querySelector(".navigationBar"))),p.ui._cachedNavBar},e._cachedMessageCenter=null,e.getMessageCenter=function(){return p.ui._cachedNavBar||(p.ui._cachedMessageCenter=p.context(document.body.querySelector(".navigationBar-messageControl"))),p.ui._cachedMessageCenter},function(e){Globalize.addCultureInfo("en",{messages:{DefaultCaption:"Form",MessageCenter_MessageCount:"{0} total",MessageCenter_MessageCountMore:"99+",NavBar_About:"About",NavBar_ChangePreferences:"Options",NavBar_Close:"Close",NavBar_D365PortalUrl:"https://home.dynamics.com",NavBar_Feedback:"Feedback",NavBar_GoToD365Fallback:"Go to the Dynamics 365 portal",NavBar_GoToDashboard:"Go to dashboard (Alt+Shift+Home)",NavBar_Help:"Help",NavBar_HelpHelpText:"(Ctrl+?)",NavBar_HelpLegal:"Legal",NavBar_HelpMenu:"Help & support",NavBar_HelpPrivacy:"Privacy and cookies",NavBar_Landmark:"Navigation bar",NavBar_LegalUrl:"https://go.microsoft.com/fwlink/?LinkID=290927",NavBar_MessageReceived:"{0} ago",NavBar_OfficePortalUrl:"https://www.office.com",NavBar_OfficeWaffle:"Office 365",NavBar_OfficeWaffleHelpText:"Go to the Office 365 site",NavBar_OfficeWaffleHelpTextFallback:"Go to the Office 365 portal",NavBar_Overflow:"More",NavBar_PrivacyUrl:"https://go.microsoft.com/fwlink/?LinkID=271135",NavBar_PrivacyUrl_CN:"https://www.21vbluecloud.com/dynamics365/d365-privacy/",NavBar_RegionTitle:"Navigation Bar Region",NavBar_Settings:"Settings",NavBar_ShowNotifications:"Show messages",NavBar_ShowNotificationsHelpText:"(Ctrl+Shift+F7)",NavBar_Support:"Support",NavBar_SupportHelpText:"Contact support",NoCaptionProvidedError:"No caption found for form, using default caption."}});var r,t=(r=p.ui.Control,__extends(o,r),o.controlName=function(e,t){var o=e||"NavBar";if(t){var n=t.MenuItem||t.Name;if(n)return o+"_"+n;if(t.Label)return o+"_"+t.Label.replace(/[^0-9a-z_-]/gi,"")}return p.controls.NavigationBar.controlIndex++,o+"_"+p.controls.NavigationBar.controlIndex},o.prototype.resetTabbingContainer=function(e){this.tabbingContainerDispose&&(this.tabbingContainerDispose(),this.tabbingContainerDispose=null),e&&(this.tabbingContainerDispose=p.util.tabbingContainer(this.element,p.label("NavBar_RegionTitle")))},o.prototype.focusIn=function(){this.hasFocus=!0},o.prototype.focusOut=function(){this.hasFocus=!1},o.prototype.isFocused=function(){return this.hasFocus},o.prototype.clearCrumb=function(){0<p.length(this.Crumbs)&&this.Crumbs.clear()},o.prototype.navigateToDashboard=function(){p.shell.closeAllFormsBeforeNavigating(p.shell.goHome)},o.prototype.findSysCopilotChatPanelIndex=function(){return p.value(this.settingsMenu).findIndex(function(e){return"SysCopilotChatPanel"===e.MenuItem})},o.prototype.loadNavMenus=function(){var n=this;this._getNavMenu("SysMenuSettings",this.settingsMenu,function(){if(0<p.length(n.settingsMenu)){var e=n.findSysCopilotChatPanelIndex();if(-1<e){var t=p.value(n.settingsMenu),o=Object.assign({},t[e],{ButtonDisplay:p.ui.ButtonDisplay.imageOnly,ImageName:p.shell.rootPath.concat("resources/images/CopilotIcon.svg"),ImageType:p.ui.ImageType.url,Style:"copilotButton",Visible:!0});n.actions.unshift(o)}}})},o.prototype._getNavMenu=function(e,u,d){var c=this;p.async(function(){p.DynReact.ModuleStore._requestMenuStructure("RetrieveSitemapMenu",function(e){var t,o,n;if(e&&(n=$.isPlainObject(e)?e:JSON.parse(e))&&n.GetDataContract){var i=!1,r=function(e){if(e.getMenuItemType&&!e.getTileName){var t=c._navMenuItemVisible(e.getMenuItemName);u.push({Click:function(){c._navBarMenuNavigate(e.getMenuItemName,e.getMenuItemType)},HelpText:e.getHelpTextStr,Label:e.getTitleStr,MenuItem:e.getMenuItemName,MenuItemType:e.getMenuItemType,Name:e.getFormName,Visible:t}),!i&&p.peek(t)&&(i=!0)}};try{for(var a=__values(n.GetDataContract),s=a.next();!s.done;s=a.next())r(s.value)}catch(e){t={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(t)throw t.error}}if(!i){var l="SysMenuSettings"===n.getName?"navigationBar-settingsButton":"navigationBar-helpButton";document.getElementsByClassName(l)[0].style.display="none"}}null!=d&&d()},{menuItem:e})})},o.prototype.dispose=function(){this.tabbingContainerDispose&&(this.tabbingContainerDispose(),this.tabbingContainerDispose=null),this.viewportBindingHandler&&this.viewportBindingHandler.dispose&&this.viewportBindingHandler.dispose(),p.ui._cachedNavBar=null,this.navigationBarElement=null,this.overFlowButton=null,this.menuPaneOpenerElement=null,r.prototype.dispose.call(this)},o.prototype.setNavBarVisual=function(e){var t,o=p.ui.getNavBar();if(o){var n="officeNavBar";if(e){if(o.element.classList.add(n),o.helpMenu.push({ButtonDisplay:p.ui.ButtonDisplay.imageOnly,Click:function(){p.ui.feedBack()},HelpText:p.label("NavBar_FeedbackHelpText"),ImageName:"Smiley",ImageType:"Symbol",Label:p.label("NavBar_Feedback"),Name:"navBarFeedback"}),0<p.length(this.overflowMenu)){var i=this.overflowMenu().findIndex(function(e){return"navBarFeedback"===e.Name});-1<i&&this.overflowMenu.splice(i,1)}0<(r=$("#NavigationSearch")).length&&(p.context(r[0]).SearchFieldVisible(!0),r.insertBefore("#navigationMainActionGroup"))}else{o.element.classList.remove(n);var r,a=o.helpMenu().findIndex(function(e){return"navBarFeedback"===e.Name});-1<a&&o.helpMenu.splice(a,1),0<(r=$("#NavigationSearch")).length&&(p.context(r[0]).SearchFieldVisible(!1),r.insertAfter("#Company")),null!==(t=p.company())&&void 0!==t&&t.ShowCompanyName(!1)}}},o.prototype._moveButtonsToOverflow=function(){var n=this,t=[],e=Array.from(this.element.querySelector("#coreNavActions").children);if(0===p.length(this.overflowMenu)){e.forEach(function(e){e&&0<e.offsetHeight&&!e.classList.contains("navigationBar-pinnedElement")&&(n._validButtonForOverflow(e)?t.push(e):e.classList.contains("navigationBar-list")?Array.from(e.children).forEach(function(e){e.children[0]&&0<e.children[0].offsetHeight&&n._validButtonForOverflow(e.children[0])&&t.push(e.children[0])}):e.children[0]&&n._validButtonForOverflow(e.children[0])&&t.push(e.children[0]))});var o=document.body.querySelector(".navigationBar-officeWaffle");o&&t.push(o),t.forEach(function(e){e.style.display="none";var t,o=p.context(e);o?(t=o instanceof p.controls.MenuButton?(o.currentAnchor=n.overFlowButton,function(){window.setTimeout(function(){o.ShowFlyout(!0)})}):o.Click,n.overflowMenu.unshift({Click:t,HelpText:o.HelpText,hiddenElement:e,Label:o.Label||e.title||p.value(o.Title),Name:o.Name})):p.logError("NavigationBar button overflow - failed to find button context.")})}},o.prototype._removeButtonsFromOverflow=function(){for(var e;0<p.length(this.overflowMenu);){(e=this.overflowMenu.pop().hiddenElement).style.display="";var t=p.context(e);t instanceof p.controls.MenuButton&&(t.currentAnchor=null)}},o.prototype._viewportChangeHandler=function(e,t){var o,n,i;null==this.navigationBarElement&&(this.navigationBarElement=document.body.querySelector(".navigationBar"));var r=p.value(p.shell.isAsidePaneOpen)?p.shell.CurrentViewportSizes.viewportWidth:0;if(null!=t&&null!=this.navigationBarElement){if(t<=p.shell.NavBarSizes.largeNavBarSize+r?this._moveButtonsToOverflow():this._removeButtonsFromOverflow(),$(this.navigationBarElement).removeClass("navBarXSmall navBarSmall navBarMedium navBarLarge"),i=n=!1,t<=p.shell.NavBarSizes.xsmallNavBarSize+r?$(this.navigationBarElement).addClass("navBarXSmall"):t<=p.shell.NavBarSizes.smallNavBarSize+r?$(this.navigationBarElement).addClass("navBarSmall"):t<=p.shell.NavBarSizes.mediumNavBarSize+r?$(this.navigationBarElement).addClass("navBarMedium"):(n=!0,t<=p.shell.NavBarSizes.largeNavBarSize+r?$(this.navigationBarElement).addClass("navBarLarge"):t>=p.shell.NavBarSizes.xlargeNavBarSize+r&&(i=!0)),!p.restrictedNavigation&&this.OfficeNavBarVisible()){var a=p.context($("#NavigationSearch")[0]);a&&(n?(a.SearchFieldVisible(!0),a.SearchFieldAlwaysOpen(!0)):(a.SearchFieldVisible(!1),a.SearchFieldAlwaysOpen(!1)))}p.value(this.OfficeNavBarVisible)&&null!==(o=p.company())&&void 0!==o&&o.ShowCompanyName(i),this._checkMenuPaneOpener(t,r)}},o.prototype._checkMenuPaneOpener=function(e,t){if(!p.restrictedNavigation&&!p.shell._noNavigationPane)if(void 0!==this.menuPaneOpenerElement&&null!==this.menuPaneOpenerElement||(this.menuPaneOpenerElement=document.createElement("Button"),this.menuPaneOpenerElement.setAttribute("data-dyn-role","SymbolButton"),this.menuPaneOpenerElement.id="NavBarMenuPaneOpener",this.menuPaneOpenerElement.dynOptions={ariaExpanded:!1,attr:{"data-dyn-expanded":!1},ButtonDisplay:"BackgroundImage",Click:function(){p.shell.setNavigationPaneIsOpen(!0)},css:{"navBar-separator":!p.value(this.OfficeNavBarVisible())},HelpText:p.label("NavBar_ShowNavigationPaneHelpText"),ImageName:"NavigationPane",ImageType:"Symbol",Label:p.label("NavigationPane_ExpandToolTip"),Name:"NavBarMenuPaneOpener"},this.menuPaneOpenerElement.classList.add("navigationBar-button"),this.menuPaneOpenerElement.classList.add("navigationBar-modulesPaneOpener"),this.menuPaneOpenerElement.classList.add("button"),this.menuPaneOpenerElement.classList.add("dynamicsButton")),e<=p.shell.NavBarSizes.smallNavBarSize+t){if(!this.menuPaneOpenerInNavBar){var o=$(this.navigationBarElement).find(".navigationBar-launch")[0];o&&(o.insertBefore(this.menuPaneOpenerElement,null),p.dataBind(this.menuPaneOpenerElement),p.shell._renderNavigationPane(),this.menuPaneOpenerInNavBar=!0)}}else if(this.menuPaneOpenerInNavBar){var n=$(this.navigationBarElement).find(".navigationBar-modulesPaneOpener")[0];n&&(n.parentNode.removeChild(n),p.shell._renderNavigationPane(),this.menuPaneOpenerInNavBar=!1)}},o.prototype._validButtonForOverflow=function(e){var t=e.getAttribute("data-dyn-role"),o=!1;return p.restrictedNavigation||"UserBtn"!==e.id||"UserButton"!==t&&"UserMenuButton"!==t&&"BUTTON"!==e.tagName?"Button"!==t&&"MenuButton"!==t&&"BUTTON"!==e.tagName||(o=!0):o=!1,o},o.prototype._navMenuItemVisible=function(e){switch(e){case"SysTracingPane":return p.computed(function(){return!p.ax._tracing.paneIsOpen()});case"SysPersonalize":return this.IsFormPersonalizable;case"SysHelpPane":case"OpenSupportForm":case"OpenIdeasLink":return p.computed(function(){return!p.shell.hasRestrictedInternet()});case"SysCopilotChatPanel":return!1;default:return!0}},o.prototype._navBarMenuNavigate=function(e,t){switch(e){case"SysHelpPane":p.shell.openHelpPane();break;case"SysTaskRecorderPane":p.ax.taskRecording.open();break;case"SysAppDesignerPane":p.ax.appDesigner.open();break;case"SysTracingPane":p.ax._tracing.open();break;case"SysPersonalize":p.context(p.shell.getActiveForm()).personalize();break;case"SysCopilotChatPanel":p.shell.isCopilotSidePaneOpen()||p.shell.createForm({menuItem:t+":"+e,elementCreated:p.serverForm.getForm,role:"Dialog"});break;default:p.shell.createForm({menuItem:t+":"+e,elementCreated:p.serverForm.getForm})}},o.ActionCenterFormName="SystemNotification",o.controlIndex=0,o);function o(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return i.navigationBarElement=null,i.menuPaneOpenerInNavBar=!1,i.hasFocus=!1,i.UserSettingsVisible=p.observable(!1),i.Crumbs=p.observableArray([]),i.OfficeNavBarVisible=p.observable(!1),i.IsFormPersonalizable=p.observable(!1),i.tabbingContainerDispose=p.util.tabbingContainer(t,p.label("NavBar_RegionTitle")),i.recordUserSettingsTelemetry=function(){},i.recordTelemetry=function(){},p.observe(i.OfficeNavBarVisible,function(e){i.setNavBarVisual(e)},i,void 0,!0),p.observe(i.UserSettingsVisible,function(e){e?($(document.body).on("resetShellOnNavigation.dynNavigationBarSettings",function(){i.UserSettingsVisible(!1)}),i.recordUserSettingsTelemetry()):$(document.body).off("resetShellOnNavigation.dynNavigationBarSettings")},i,void 0,!0),i.NavigateToNotificationsForm=function(){i._navBarMenuNavigate(p.controls.NavigationBar.ActionCenterFormName,"Display")},p.controls.NavigationBar.actions||(p.controls.NavigationBar.actions=[]),i.actions=p.observableArray(p.controls.NavigationBar.actions),p.controls.NavigationBar.settingsMenu||(p.controls.NavigationBar.settingsMenu=[]),i.settingsMenu=p.observableArray(p.controls.NavigationBar.settingsMenu),i.helpMenu=p.observableArray(p.controls.NavigationBar.helpMenu),i.ShowOverflowButton=p.computed(function(){return 0<p.length(i.overflowMenu)}),i.overflowMenu=p.observableArray([]),i.overFlowButton=t?$(t.getElementsByClassName("navigationBar-overflowButton")[0]):void 0,i._viewportChangeHandler(null,p.shell.CurrentShellViewPortWidthSize),i.viewportBindingHandler=p.bindingHandlers.ShellViewportWidthSize(),i.viewportBindingHandler.apply(i._viewportChangeHandler,i),i}e.NavigationBar=t}(p.controls||(p.controls={}))}($dyn=$dyn||{}),function(n){(n.ui||(n.ui={})).feedBack=function(){if(!$(".feedbackpane")[0]){var e=new n.controls.FeedbackPane,t=n.context(n.shell.getActiveForm());t&&(e.FormName(n.value(t.FormName)),e.FormUniqueId(t.Id));var o={context:e,role:"Dialog",templateId:"FeedbackPane"};n.shell.createForm(o),n.shell.dialog(o)}},function(e){Globalize.addCultureInfo("en",{messages:{FeedbackPane_BrowserSessionHeader:"Session information",FeedbackPane_CancelButton:"Cancel",FeedbackPane_Caption:"Feedback",FeedbackPane_Dislike:"Dislike",FeedbackPane_IntroText:"Share your thoughts about Microsoft Dynamics 365 {0}.",FeedbackPane_Like:"Like",FeedbackPane_Privacy:"Thank you for taking the time to send us feedback. Your privacy is important to us. To protect your privacy, please don't include any personal information.",FeedbackPane_PrivacyLinkText:"Microsoft Privacy Statement",FeedbackPane_PrivacyLinkText_CN:"21Vianet Privacy and Cookies",FeedbackPane_SubmitButton:"Submit"}});var t=(o.prototype.ToggleFeedbackType=function(e){n.value(this.Type)===e?this.Type(n.telemetry.FeedbackType.notSpecified):this.Type(e)},o.prototype.Submit=function(){n.telemetry.addUserFeedbackEvent(this.FormName(),this.FormUniqueId(),this.Type(),this.Text()),n.telemetry.flushTelemetryEvents(),this.Close()},o.prototype.Cancel=function(){this.Close()},o.prototype.Close=function(){var e=this,t=$(".feedbackpane").closest("[data-dyn-role='Dialog']"),o=n.context(t[0]);n.applyFunction(o.Close,o,[{closeCallback:function(){return e.close()}}])},o.prototype.close=function(){this.ActivityId(""),this.ShowActivityId(!1)},o);function o(){var e=this;this.Text=n.observable(""),this.FormName=n.observable(""),this.FormUniqueId=n.observable(""),this.ShowActivityId=n.observable(!1),this.ActivityId=n.observable(""),this.BrowserSessionActivityId=n.computed(function(){return n.browserActivity.BrowserSessionActivity.Id}),this.AOSRoleInstance=n.computed(function(){return n.browserActivity.AOSRoleInstance}),this.AOSId=n.computed(function(){return n.browserActivity.aosId}),this.BrowserInteractionTimestamp=n.computed(function(){return n.browserActivity.BrowserInteractionActivity.UtcTimestamp}),this.ShowSessionId=n.computed(function(){return!n.browserActivity.SearchTraceLog}),this.ShowSessionIdAnchor=n.computed(function(){return n.browserActivity.SearchTraceLog}),this.SearchTraceLogUrl=n.computed(function(){return n.browserActivity.SearchTraceLogUrl}),this.Type=n.observable(n.telemetry.FeedbackType.notSpecified),this.Liked=n.computed(function(){return n.value(e.Type)===n.telemetry.FeedbackType.positive}),this.Disliked=n.computed(function(){return n.value(e.Type)===n.telemetry.FeedbackType.negative})}e.FeedbackPane=t}(n.controls||(n.controls={}))}($dyn=$dyn||{}),function(r){var e,t,o,n,i,a,s;e=r.messaging||(r.messaging={}),Globalize.addCultureInfo("en",{messages:{MessageBox_ErrorIcon:"Error icon",MessageBox_InfoIcon:"Information icon",MessageBox_WarningIcon:"Warning icon",MessageCenter_StatusActive:"Active",MessageCenter_StatusCompleted:"Completed",MessageCenter_StatusExpired:"Expired",MessageCenter_StatusHeader:"Status",Shell_PrefixMessagePane_MaxMessages:"This result has too many messages to show.",Shell_PrefixMessagePane_MaxMessagesPlease:"Please try again with fewer selections.",Shell_PrefixMessagePane_Title:"Message details",Shell_PrefixRootMessage_DetailLinkText:"Message details"}}),(t=e.MessageAction||(e.MessageAction={}))[t.AddMessage=0]="AddMessage",t[t.RemoveMessage=1]="RemoveMessage",t[t.ClearMessages=2]="ClearMessages",(o=e.MessageType||(e.MessageType={}))[o.information=0]="information",o[o.warning=1]="warning",o[o.error=3]="error",o[o.controlValidation=19]="controlValidation",o[o.fieldValidation=20]="fieldValidation",o[o.systemMaintenance=21]="systemMaintenance",o[o.itemNotOpened=91]="itemNotOpened",o[o.itemDoesNotExist=92]="itemDoesNotExist",(n=e.OriginType||(e.OriginType={}))[n.InfoLog=0]="InfoLog",n[n.Alert=1]="Alert",n[n.WatchDog=2]="WatchDog",n[n.Persistent=3]="Persistent",(i=e.Severity||(e.Severity={}))[i.information=0]="information",i[i.warning=1]="warning",i[i.error=2]="error",(a=e.State||(e.State={})).active="Active",a.completed="Completed",a.expired="Expired",(s=e.NotificationActionType||(e.NotificationActionType={}))[s.displayMenuFunction=0]="displayMenuFunction",s[s.actionMenuFunction=1]="actionMenuFunction",e.addMessage=function(e){r.messageManager.add(e)},e.getMessageBarAriaLabel=function(e){return e===r.messaging.MessageType.information?r.label("MessageInfoBarNotificationAria"):e===r.messaging.MessageType.warning?r.label("MessageWarningBarNotificationAria"):e===r.messaging.MessageType.error?r.label("MessageErrorBarNotificationAria"):void 0},e.getMessageIconType=function(e){for(var t=[],o=0;o<e.length;o++)e[o].getMessageIconType&&t.push(e[o].getMessageIconType());if(0<t.length){if(0<=t.indexOf("Error"))return"Error";if(0<=t.indexOf("Warning"))return"Warning";if(0<=t.indexOf("Info"))return"Info"}return"Error"},e.getMessageIconAltText=function(e){for(var t=[],o=0;o<e.length;o++)e[o].getMessageIconType&&t.push(e[o].getMessageIconType());if(0<t.length){if(0<=t.indexOf("Error"))return r.label("MessageBox_ErrorIcon");if(0<=t.indexOf("Warning"))return r.label("MessageBox_WarningIcon");if(0<=t.indexOf("Info"))return r.label("MessageBox_InfoIcon")}return r.label("MessageBox_ErrorIcon")},e.getFirstFocusButton=function(e){return e.showYesButton?r.controls.MessageBox.ButtonName.Yes:e.showYesToAllButton?r.controls.MessageBox.ButtonName.YesToAll:e.showOkButton?r.controls.MessageBox.ButtonName.Ok:e.showNoButton?r.controls.MessageBox.ButtonName.No:e.showNoToAllButton?r.controls.MessageBox.ButtonName.NoToAll:e.showCloseButton?r.controls.MessageBox.ButtonName.Close:e.showCancelButton?r.controls.MessageBox.ButtonName.Cancel:void 0},e.FindTargetForm=function(e){if(e){var t=void 0,o=r.context(r.shell.activeFormElement);if(o&&o.Id===e&&(t=o),(t=t||r.flyout.flyoutManager.getFlyoutContextByFormId(e))||o&&r.shell.activeFormElement.querySelector('[data-dyn-formid="'+e+'"]')&&(t=o),!(t=t||r.shell.findFormById(r.shell.stack,e)))for(var n=r.length(r.shell.stack)-1;0<=n;n--){var i=r.context(r.shell.stack()[n]);i&&i.dialogStack()&&(t=r.shell.findFormById(i.dialogStack,e))}return t&&t.routeMessagesToParent&&t.Root&&(t=t.Root),t}},e.isNotification=function(e){return!(!e||void 0===e.notificationId)},e.isMessage=function(e){return!(!e||void 0===e.messageId)},e.controlCanHaveMessages=function(e){return!!(e&&"addMessage"in e)}}($dyn=$dyn||{}),function(o){var e,t;function n(){var t=this;this.ExecuteHyperlink=function(){var e;t.isStaticAction?e=o.context(o.shell.getActiveForm()):t.targetForm&&(e=t.targetForm),e&&e.ExecuteMessageAction&&(void 0!==t.ActionURL?o.shell.openWindow({url:t.ActionURL,target:"_blank"}):o.callFunction(e.ExecuteMessageAction,e,[t.messageId]))},this.ActionMessageText="",this.isStaticAction=!1,this.ActionURL=void 0,this.text="",this.originType=e.OriginType.InfoLog,this.isMessage=!0,this.isAlert=!1,this.isWatchDog=!1,this.ShowExtraMessageText=o.observable(!1),this.Enabled=!0,this.statusIcon=o.computed(function(){return o.util.enumName(t.type,o.messaging.MessageType)}),this.ShowActionMessageLink=o.computed(function(){return t.messageId&&""!==t.ActionMessageText}),this.ShowStaticActionMessageLink=o.computed(function(){return t.ShowActionMessageLink()&&t.isStaticAction}),this.showLink=o.computed(function(){return t.ShowActionMessageLink()})}e=o.messaging||(o.messaging={}),Object.defineProperty(n.prototype,"Name",{get:function(){return"pfm"+this.messageId},enumerable:!1,configurable:!0}),n.prototype.focusCallback=function(e){o.util.focusElement(e[0])},n.prototype.getMessageIconType=function(){return this.type===e.MessageType.information?"Info":this.type===e.MessageType.warning||this.type===e.MessageType.controlValidation||this.type===e.MessageType.fieldValidation||this.type===e.MessageType.systemMaintenance?"Warning":"Error"},n.prototype.FindRelatedControl=function(){var e=this.relatedControl?this.relatedControl:null;if(null===e){var t=$("[data-dyn-formid='"+this.formUniqueId+"']");0<t.length&&(e=o.ui.findControl(this.targetName,t[0]))}return e},t=n,e.Message=t}($dyn=$dyn||{}),function(t){function e(){var e=this;this.text="",this.state=t.messaging.State.active,this.severity=t.messaging.Severity.information,this.originType=t.messaging.OriginType.Alert,this.createdDateTime=moment.tz("User"),this.notificationActions=[],this.statusIcon=t.computed(function(){return e.severity===t.messaging.Severity.information?"information":e.severity===t.messaging.Severity.warning?"warning":"error"}),this.stateMessage=t.computed(function(){switch(e.state){case t.messaging.State.completed:return t.label("MessageCenter_StatusCompleted");case t.messaging.State.expired:return t.label("MessageCenter_StatusExpired");case t.messaging.State.active:default:return t.label("MessageCenter_StatusActive")}}),this.isAlert=t.computed(function(){return e.originType===t.messaging.OriginType.Alert}),this.isWatchDog=t.computed(function(){return e.originType===t.messaging.OriginType.WatchDog}),this.showLink=t.computed(function(){return 0<e.notificationActions.length}),this.formattedCreatedTimeStamp=t.computed(function(){return e.createdDateTime?moment.tz(e.createdDateTime,"User").fromNow():e.timeStampMomentUtc?e.timeStampMomentUtc.fromNow():null})}(t.messaging||(t.messaging={})).Notification=e}($dyn=$dyn||{}),function(s){var e,t;function o(){var o=this;this.Shortcuts={Enter:{Keys:{keyCode:s.ui.KeyCodes.enter},Handler:function(e){this.ExecuteHyperlink()},ShowToUser:!1},Spacebar:{Keys:{keyCode:s.ui.KeyCodes.spacebar},Handler:function(e){this.ExecuteHyperlink()},ShowToUser:!1}},this.text="",this.prefixMessageCnt=0,this.type=s.messaging.MessageType.information,this.originType=s.messaging.OriginType.InfoLog,this.isMessage=!0,this.isAlert=!1,this.isWatchDog=!1,this.prefixMessages=[],this.prefixItemList=[],this.prefixSection={id:void 0,messages:[],prefixItemList:[],prefixItemType:1,sectionExpanded:s.observable(!0),sections:[],sectionTitle:""},this.showLink=s.observable(!0),this.messageCount=s.observable(0),this.Value=s.observable(),this.ActionMessageText="",this.readOnly=!0,this.maxMessageCount=s.computed(function(){return 500<=s.value(o.messageCount)}),this.statusIcon=s.computed(function(){return s.util.enumName(o.type,s.messaging.MessageType)}),this.ShowPrefixLink=s.computed(function(){return 1<s.value(o.messageCount)}),this.ShowActionMessageLink=s.computed(function(){return o.ShowPrefixLink()}),this.ShowExtraMessageText=s.computed(function(){return o.ShowPrefixMessageText()}),this.ShowPrefixMessageText=s.computed(function(){return 1===s.value(o.messageCount)}),this.messageText=s.computed(function(){var e="";if(o.firstMessage)for(var t=1;t<=o.firstMessage.prefixCount;t++)e=e+o.firstMessage.prefixParts[t]+" ";return e}),this.ExecuteHyperlink=function(){s.messaging.MessageCenterManager.messageCenterVisible(!1);var e={context:o,role:"Dialog",templateId:"PrefixMessageSection"};s.shell.createForm(e);var t=s.context(e.targetElement);t.DisplayTarget=s.forms.DisplayTarget.AsidePane,s.shell.open({form:t})}}e=s.messaging||(s.messaging={}),o.prototype.keyDown=function(e){s.util.handleShortcuts(this,e)},o.prototype.addPrefixMessage=function(e){if(e.rootPrefix&&e.rootPrefix===this.rootPrefix){for(var t=this.prefixSection,o=1;o<e.prefixCount;o++){for(var n=!1,i=0;i<s.length(t.sections);i++){var r=t.sections[i];r.sectionTitle===e.prefixParts[o]&&(t=r,n=!0)}if(!n){this.prefixMessageCnt++;var a={Enabled:!0,focusCallback:function(e){s.util.focusElement(e[0])},id:o,messages:[],Name:"ps-"+this.prefixMessageCnt,prefixItemList:[],prefixItemType:1,sectionExpanded:s.observable(!0),sections:[],sectionTitle:e.prefixParts[o]};t.sections.push(a),a.prefixItemType=1,t.prefixItemList.push(a),t=a}}null==this.firstMessage&&(this.firstMessage=e),t.messages.push(e),e.prefixItemType=2,t.prefixItemList.push(e),this.messageCount(this.messageCount()+1),e.type>this.type&&(this.type=e.type),this.activityId=e.activityId}},t=o,e.PrefixRootMessage=t}($dyn=$dyn||{}),function(c){var p,h;function t(e){o(e,!1)}function o(i,e){var t,o=c.value(h.messages),n=c.util.isFlightEnabled(c.messaging.SystemNotificationLoadLatestFeatureName);if(0<c.length(i)){for(var r=0;r<c.length(i);r++){var a=i[r];if(c.value(a.isAlert)&&p.isNotification(a)){var s=a;h.notifications[s.notificationId]&&g(s.notificationId,!0),h.notifications[s.notificationId]=s}}var l=n?100:500;if((t=(t=e&&n?i:i.reverse()).concat(o)).length>l){var u=t.length-l;t=n?(t.slice(l-1,t.length),t.slice(0,l-1)):(t.slice(0,u-1),t.slice(u,t.length));for(var d=0;d<c.length(i);d++){a=i[d];if(c.value(a.isAlert)&&p.isNotification(a)){s=a;h.notifications[s.notificationId]?delete h.notifications[s.notificationId]:c.logError("Messaging: Tried deleting a message from notifications, but that notification does not exist. Id=%s",s.notificationId)}}}h.messages(t),h.unreadMessageCount(c.value(h.unreadMessageCount)+c.length(i)),0===h.unreadMessageCount()||h._toastActiveFormObserver||(h._toastActiveFormObserver=c.observe(c.activeForm,function(e){var t=c.context(e);if(t)if("Dialog"!==t.TypeName){h.unreadMessageCountChanged(!0),h.notificationPopupVisible(!0);var o=$("#dynNotificationBackgroundAudio")[0];if(o&&o.play)try{0===o.readyState&&o.load(),o.play()}catch(e){}if(1<c.length(i))h.notificationPopupMessage(c.label("Shell_MultipleNotifications"));else{var n=i[0];h.notificationPopupMessage(n.text),p.isMessage(n)&&m(n)}h.currentTimer||(h.currentTimer=window.setTimeout(function(){v()},7500))}else h.unreadMessageCountChanged()&&v()}))}}function m(e){void 0===e&&(e=null);var t=c.ui.getNavBar();if(t){var o=t.element,n=o.getElementsByClassName("notificationPopup-link")[0];n&&(c.unbind(n),e?c.dataBind(n,new c.DataContext(e,o.dynContext)):n.setAttribute("tabindex","-1"))}}function e(){h.currentTimer&&(window.clearTimeout(h.currentTimer),h.currentTimer=void 0)}function v(){h.unreadMessageCountChanged(!1),h.notificationPopupVisible(!1),m(),e(),l(-1),h._toastActiveFormObserver&&(h._toastActiveFormObserver.dispose(),h._toastActiveFormObserver=null),h._toastTabbingContainerDispose&&(h._toastTabbingContainerDispose(),h._toastTabbingContainerDispose=void 0)}function n(){h.messages.clear(),h.notifications={},h.unreadMessageCount(0),h.unreadMessageCountChanged(!1)}function i(e){if(e)for(var t=0;t<c.length(h.messages);t++){var o=c.value(h.messages)[t];if(p.isMessage(o)&&o.messageId===e){h.messages.splice(t,1);break}}}function g(e,t){if(e){for(var o=0;o<c.length(h.messages);o++){var n=c.value(h.messages)[o];if(p.isNotification(n)&&n.notificationId===e){h.messages.splice(o,1);break}}if(!1!==t)for(var i in h.notifications)if(h.notifications[i].notificationId===e){c.user().dismissNotification(Number(i));break}}}function r(){if(!h._cachedPopupContainer){var e=c.ui.getNavBar();if(e&&e.element){var t=e.element;h._cachedPopupContainer=t.getElementsByClassName("notificationPopup")[0]}}return h._cachedPopupContainer}function a(){if(!h._cachedPopupLink){var e=c.ui.getNavBar();if(e&&e.element){var t=e.element;h._cachedPopupLink=t.getElementsByClassName("notificationPopup-link")[0]}}return h._cachedPopupLink}function s(){if(!h._cachedPopupMessage){var e=c.ui.getNavBar();if(e&&e.element){var t=e.element;h._cachedPopupMessage=t.getElementsByClassName("notificationPopup-message")[0]}}return h._cachedPopupMessage}function l(e){var t=a(),o=s();t&&t.setAttribute("tabindex",e.toString()),o&&o.setAttribute("tabindex",e.toString())}(p=c.messaging||(c.messaging={})).SystemNotificationLoadLatestFeatureName="CLISystemNotificationLoadLatest",(h=p.MessageCenterManager||(p.MessageCenterManager={}))._cachedPopupLink=null,h._cachedPopupMessage=null,h._cachedPopupContainer=null,h._cachedNavBarMessagesButton=null,h.messages=c.observableArray([]),h.notificationPopupMessage=c.observable(""),h.notificationPopupVisible=c.observable(!1),h.notifications={},h.unreadMessageCount=c.observable(0),h.unreadMessageCountChanged=c.observable(!1),h.recordMessageCenterTelemetry=function(){},h.messagesEmpty=c.computed(function(){return 0===c.value(h.messages).length}),h.messageCount=c.computed(function(){return c.util.isFlightEnabled(c.messaging.SystemNotificationLoadLatestFeatureName)&&99<c.value(h.messages).length?c.label("MessageCenter_MessageCountMore"):c.format(c.label("MessageCenter_MessageCount"),c.value(h.messages).length)}),h.seeAllMessagesLinkEnabled=c.computed(function(){var e=!0,t=c.shell.getCurrentRootForm();if(t){var o=c.context(t);e=!o||o.FormName!==c.controls.NavigationBar.ActionCenterFormName}return e}),h.messagesNotEmpty=c.computed(function(){return 0<c.value(h.messages).length}),h.messageCenterVisible=c.observable(!1),h.ClearMessage=function(e){c.value(e.isAlert)&&c.messaging.isNotification(e)?c.messaging.MessageCenterManager.RemoveAndDismissMessage(e.notificationId,!0):c.messaging.isMessage(e)&&c.messaging.MessageCenterManager.RemoveMessage(e.messageId)},h.ExpandMessage=function(e){var t=$(e).parents(".messageCenter-item"),o=t.find(".messageCenter-itemMessage"),n=t.find(".messageCenter-extraItems");(o.length||n.length)&&(o.hasClass("messageCenter-truncateText")?(o.removeClass("messageCenter-truncateText"),n.css("display","flex"),e.classList.add("ChevronUp-symbol"),e.classList.remove("ChevronDown-symbol")):(o.addClass("messageCenter-truncateText"),e.classList.add("ChevronDown-symbol"),e.classList.remove("ChevronUp-symbol"),n.css("display","none")))},h.AddMessage=function(e){t([e])},h.AddMessages=t,h.AddNotifications=function(e){o(e,!0)},h.SetPopupDataBind=m,h.ClearTimeout=e,h.ClearToastVariables=v,h.ClearMessages=n,h.ClearAndDismissMessages=function(){var e=Object.keys(h.notifications),t=e.length;if(0<t){e.sort();var o=e[t-1];c.user().dismissLatestNotifications(Number(o),t)}n()},h.RemoveMessages=function(e){for(var t=0,o=c.length(e);t<o;t++){i(e[t].messageId)}},h.RemoveMessage=i,h.RemoveAndDismissMessage=g,h.GetMessage=function(e){for(var t=c.value(h.messages),o=0;o<t.length;o++){var n=c.value(h.messages)[o];if(p.isMessage(n)&&n.messageId===e)return n}return null},h.GetNotificationPopupContainer=r,h.GetNotificationPopupLink=a,h.GetNotificationPopupMessage=s,h.FocusNavBarMessagesButton=function(){var e;if(!h._cachedNavBarMessagesButton){var t=c.ui.getNavBar();if(t&&t.element){var o=t.element;h._cachedNavBarMessagesButton=o.querySelectorAll('[data-dyn-controlname="navBarMessageCenter"]')[0]}}null!==(e=h._cachedNavBarMessagesButton)&&void 0!==e&&e.focus()},h.SetPopupElementTabIndex=l,h.FocusOnNotificationPopup=function(){c.messaging.MessageCenterManager.SetPopupElementTabIndex(0);var e=c.messaging.MessageCenterManager.GetNotificationPopupMessage();e&&e.focus()},c.observe(h.notificationPopupVisible,function(e){if(e){var t=r();t&&(h._toastTabbingContainerDispose&&(h._toastTabbingContainerDispose(),h._toastTabbingContainerDispose=void 0),h._toastTabbingContainerDispose=c.util.tabbingContainer(t,c.label("FormPersonalization_RegionTitle")))}}),c.observe(h.messageCenterVisible,function(e){if(e){$(document.body).on("resetShellOnNavigation.dynMessageBarExpanded",function(){h.messageCenterVisible(!1)}),h.recordMessageCenterTelemetry(),c.messaging.MessageCenterManager.unreadMessageCount(0),c.messaging.MessageCenterManager.unreadMessageCountChanged(!1);for(var t=moment.utc(),o=0;o<c.length(c.messaging.MessageCenterManager.messages);o++){var n=c.value(c.messaging.MessageCenterManager.messages)[o];n.timeStampMomentUtc&&n.elapsedTimeSinceArrival(c.format(c.label("NavBar_MessageReceived"),c.util.elapsedTimeDisplayText(n.timeStampMomentUtc,t)))}var i=$(".messageCenter")[0];i&&c.microTask(function(){var e=c.util.findFirstFocusableControl(i);e&&(c.log.focus&&c.log.focus("Focus: NavBar-> Open message center, executing MicroTask to set focus"),$(e).focus())})}else $(document.body).off("resetShellOnNavigation.dynMessageBarExpanded")})}($dyn=$dyn||{}),function(m){var e,t,o;e=m.messaging||(m.messaging={}),t=e.messageHandlers||(e.messageHandlers={}),(o=t.clientMessageHandler||(t.clientMessageHandler={})).internalMessageHandlerName="clientMessageHandler",o.messageCenter=m.messaging.MessageCenterManager,o.hasTargetForm=function(e){var t=!1;if(e.formUniqueId){var o=m.messaging.FindTargetForm(e.formUniqueId);o&&o.MessageBar&&(t=!0,e.targetForm=o)}if(!t&&0===m.value(m.async.pending)){var n=m.messaging.FindTargetForm(e.parentFormId);n&&n.MessageBar&&(t=!0,e.targetForm=n)}return t},o.isMessageBoxMessage=function(e){return e.type!==m.messaging.MessageType.information&&e.type!==m.messaging.MessageType.warning&&e.type!==m.messaging.MessageType.error&&e.type!==m.messaging.MessageType.fieldValidation&&e.type!==m.messaging.MessageType.controlValidation},o.AddMessageHandlerMessage=function(e,t){return this.isMessageBoxMessage(e)?m.errorMessageBox({Text:e.text},!0):this.hasTargetForm(e)?e.targetForm.MessageBar.AddMessage(e):this.messageCenter.AddMessage(e),!0},o.AddMessages=function(e,t){for(var o={},n=[],i=[],r=[],a=[],s=0,l="",u="",d=0;d<e.length;d++){var c=e[d];this.isMessageBoxMessage(c)?i.push(e[d]):c.deleteMessage?a.push(c):this.hasTargetForm(c)?(s++,o[c.formUniqueId]||(o[c.formUniqueId]=[]),o[c.formUniqueId].push(e[d]),l=m.messaging.getMessageBarAriaLabel(e[d].type)+" "+e[d].text):(c.formUniqueId||c.parentFormId)&&0<m.value(m.async.pending)?r.push(e[d]):n.push(e[d])}if(o)for(var p in u=1===s?l:m.label("MessageAlert"),o){o[p][0].targetForm.MessageBar.AddMessages(o[p])}if(n&&0<n.length&&(this.messageCenter.AddMessages(n),u=u+" "+m.label("MessageCenterNotificationAria")+" "+n.length),i&&0<i.length){if(1===i.length&&(i[0].type===m.messaging.MessageType.itemDoesNotExist||i[0].type===m.messaging.MessageType.itemNotOpened))for(var h in n)i.push(n[h]);m.errorMessageBox(i,!0)}return 0<a.length&&($(document.body).trigger("removeMessages",[a]),m.messaging.MessageCenterManager.RemoveMessages(a)),0<r.length&&$.when(m.deferred.onTrue(function(){return 0===m.value(m.async.pending)})).done(function(){m.messaging.messageHandlers.clientMessageHandler.AddMessages(r,t)}),m.shell.addAriaAlertMessage(u),!0},o.RemoveMessageHandlerMessage=function(e,t){var o=m.messaging.FindTargetForm(t.currentFormId);o&&o.MessageBar?o.MessageBar.RemoveMessage(e):this.messageCenter.RemoveMessage(e)},o.ClearMessages=function(e){return $(document.body).trigger("clearMessageBarMessages"),this.messageCenter.ClearMessages(),!0}}($dyn=$dyn||{}),function(u){function e(){var l=this;this.registerMessageHandler=function(e){if(!e)throw new Error("Argument null or undefined: messageHandler");void 0===l.messageHandlers[e.internalMessageHandlerName]&&(l.messageHandlers[e.internalMessageHandlerName]=e)},this.unregisterMessageHandler=function(e){if(!e)throw new Error("Argument null or undefined: messageHandler");delete l.messageHandlers[e.internalMessageHandlerName]},this.initialize=function(){l.registerMessageHandler(u.messaging.messageHandlers.clientMessageHandler)},this.isFrameworkMessage=function(e){return e<0},this.add=function(e){return(e=l.stripMessagePrefix(e)).messageId||(l.nextId++,e.messageId=-l.nextId),l.currentMessage=e,l.calculateMessageRouting(e,u.messaging.MessageAction.AddMessage),e.messageId},this.addMessages=function(e){for(var t=u.value(e),o=[],n={},i=0;i<t.length;i++)if(t[i].messageId||(l.nextId++,t[i].messageId=-l.nextId),l.IsSetPrefixMessage(t[i])){var r=t[i];if(l.processPrefixMessage(r),r.rootPrefix)if(void 0===n[r.rootPrefix]){var a=new u.messaging.PrefixRootMessage;a.messageId=r.messageId,a.formName=r.formName,a.formUniqueId=r.formUniqueId,a.rootPrefix=r.rootPrefix,a.text=a.rootPrefix,a.detailText=u.label("Shell_PrefixRootMessage_DetailLinkText"),a.ActionMessageText=a.detailText,a.Value=u.observable(a.rootPrefix),a.prefixSection.sectionTitle=a.rootPrefix,a.addPrefixMessage(r),n[r.rootPrefix]=a,o.push(a)}else n[r.rootPrefix].addPrefixMessage(r);else(s=l.stripMessagePrefix(t[i]))&&o.push(s)}else{var s;(s=l.stripMessagePrefix(t[i]))&&o.push(s)}0<o.length&&l.calculateMessageRouting(o,u.messaging.MessageAction.AddMessage)},this.remove=function(e,t){l.currentMessageId=e,l.currentFormId=t,l.calculateMessageRouting(e,u.messaging.MessageAction.RemoveMessage)},this.clear=function(){l.calculateMessageRouting(null,u.messaging.MessageAction.ClearMessages)},this.getPersistentMessageVisibleState=function(e){var t=!1;switch(e){case u.messaging.MessageType.information:t=l.infoMessagesHasPersistent;break;case u.messaging.MessageType.warning:t=l.warningMessagesHasPersistent;break;case u.messaging.MessageType.error:t=l.errorMessagesHasPersistent}return t},this.setPersistentMessageVisibleState=function(e,t){switch(e){case u.messaging.MessageType.information:l.infoMessagesHasPersistent=t;break;case u.messaging.MessageType.warning:l.warningMessagesHasPersistent=t;break;case u.messaging.MessageType.error:l.errorMessagesHasPersistent=t}},this.IsSetPrefixMessage=function(e){var t=!1;return e&&e.text&&(t=-1!==e.text.indexOf("\t"))&&20<(e.text.match(/\t/g)||[]).length&&(e.text=e.text.replace(new RegExp("\t","g")," "),t=!1),t},this.calculateMessageRouting=function(o,n){if(n!==u.messaging.MessageAction.ClearMessages&&!o)throw new Error("Argument null or undefined: message");if(!l.messageHandlers)throw new Error("No MessageHandlers have been registered with the MessageManager");$.each(l.messageHandlers,function(e,t){switch(n){case u.messaging.MessageAction.AddMessage:return Array.isArray(o)?t.AddMessages(o,l):t.AddMessages([o],l);case u.messaging.MessageAction.RemoveMessage:return t.RemoveMessageHandlerMessage(l.currentMessageId,l);case u.messaging.MessageAction.ClearMessages:return t.ClearMessages(l)}})},this.stripMessagePrefix=function(e){if(e&&e.text){var t=e.text.split("\t");e.text=t[t.length-1]}return e},this.processPrefixMessage=function(e){e&&e.text&&(e.prefixParts=e.text.split("\t"),e.prefixCount=e.prefixParts.length-1,e.rootPrefix=e.prefixParts[0],e.text=e.prefixParts[e.prefixParts.length-1])},this.nextId=1,this.messageHandlers={},this.initialize(),this.infoMessagesHasPersistent=void 0,this.warningMessagesHasPersistent=void 0,this.errorMessagesHasPersistent=void 0}(u.messaging||(u.messaging={})).MessageManager=e,u.messageManager=new u.messaging.MessageManager}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){var e,a,t;function o(){var t=null!==a&&a.apply(this,arguments)||this;return t.onToggleKeyDown=function(e){t.Toggle&&r.util.isShortcutKeyPressed(e,{keyCode:r.ui.KeyCodes.enter})&&(t.Toggle(),e.preventDefault(),e.stopPropagation())},t.onCloseKeyDown=function(e){r.util.isShortcutKeyPressed(e,{keyCode:r.ui.KeyCodes.enter})&&(t.ClearSectionMessages(),e.preventDefault(),e.stopPropagation())},t}e=r.controls||(r.controls={}),a=r.ui.Control,__extends(o,a),o.prototype.init=function(e,t){var o=this;if(a.prototype.init.call(this,e,t),this.EntranceAnimation="messageBar-grow",this.ExitAnimation="messageBar-shrink",this.ContentAnimation="fadeIn",this._marginApplied=!1,r.flags.disableAnimations){this.element.classList.add("allowScrolling");var n=r.value(this.IsVisible);r.observe(this.IsVisible,function(e){e!==n&&(o.Root&&o.Root.reflow(),n=e)},this,void 0,!0)}else{var i=this.element.querySelector(".messageBar-messageRegion");this.entranceAnimationEnd=function(e){e.target===o.element&&e.animationName===o.EntranceAnimation&&(i.classList.remove(o.ContentAnimation),o.element.removeEventListener("animationend",o.entranceAnimationEnd,!1),o.element.removeEventListener("webkitAnimationEnd",o.entranceAnimationEnd,!1),o.Root&&o.Root.reflow(),o._marginApplied||o.PostRenderSection())},this.transitionEnd=function(e){e.target===o.element&&"max-height"===e.propertyName&&(r.value(o.Expanded)?o.element.classList.add("allowScrolling"):o.element.classList.remove("allowScrolling"))},this.element.classList.add(this.EntranceAnimation),i.classList.add(this.ContentAnimation),this.element.addEventListener("transitionend",this.transitionEnd,!1),this.element.addEventListener("animationend",this.entranceAnimationEnd,!1),this.element.addEventListener("webkitAnimationEnd",this.entranceAnimationEnd,!1)}},o.prototype.ClearMessages=function(){},o.prototype.PreRenderSection=function(){this._marginApplied=!1},o.prototype.PostRenderSection=function(){if(r.value(this.IsToggleVisible)){var e=this.element.querySelector(".messageBar-messageEntry");e&&this._getCollapseRegionWidth()&&(r.util.isRTLMode()?e.style.marginLeft=this._getCollapseRegionWidth()+"px":e.style.marginRight=this._getCollapseRegionWidth()+"px",this._marginApplied=!0)}},o.prototype.ClearSectionMessages=function(){var t=this;r.flags.disableAnimations?this.ClearMessages():(this.exitAnimationEnd=function(e){e.target===t.element&&e.animationName===t.ExitAnimation&&(t.ClearMessages(),t.element.classList.remove(t.ExitAnimation),t.element.removeEventListener("animationend",t.exitAnimationEnd,!1),t.element.removeEventListener("webkitAnimationEnd",t.exitAnimationEnd,!1),t.element.classList.add(t.EntranceAnimation),t.element.addEventListener("animationend",t.entranceAnimationEnd,!1),t.element.addEventListener("webkitAnimationEnd",t.entranceAnimationEnd,!1),t.Root&&t.Root.reflow())},this.element.classList.remove(this.EntranceAnimation),this.element.classList.add(this.ExitAnimation),this.element.addEventListener("animationend",this.exitAnimationEnd,!1),this.element.addEventListener("webkitAnimationEnd",this.exitAnimationEnd,!1)),this.Root.RestoreFocusToMainFormContainer()},o.prototype.dispose=function(){this.entranceAnimationEnd&&(this.element&&(this.element.removeEventListener("animationend",this.entranceAnimationEnd,!1),this.element.removeEventListener("webkitAnimationEnd",this.entranceAnimationEnd,!1)),this.entranceAnimationEnd=null),this.transitionEnd&&(this.element&&this.element.removeEventListener("transitionend",this.transitionEnd,!1),this.transitionEnd=null),this.exitAnimationEnd&&(this.element&&(this.element.removeEventListener("animationend",this.exitAnimationEnd,!1),this.element.removeEventListener("webkitAnimationEnd",this.exitAnimationEnd,!1)),this.exitAnimationEnd=null),a.prototype.dispose.call(this)},o.prototype._getCollapseRegionWidth=function(){if(!this._cachedCollapseRegionWidth){var e=this.element.querySelector(".messageBar-collapseMessageRegion");e&&(this._cachedCollapseRegionWidth=e.offsetWidth)}return this._cachedCollapseRegionWidth},t=o,e.MessageBarSection=t}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(l){!function(e){Globalize.addCultureInfo("en",{messages:{LightBoxNotificationAria:"Critical message press TAB to read content ",MessageAlert:"You have received multiple new messages, Ctrl-F7 to read list",MessageBar_CollapseMessages:"",MessageBar_ExpandMessages:"{0}",MessageCenter_ClearMessages:"Clear all",MessageCenter_Header:"Action Center",MessageCenter_NoMessages:"There are no messages.",MessageCenter_SeeAllLink:"See all",MessageCenterNotificationAria:"New messages are in the Action Center. The total number of new messages is: ",MessageErrorBarNotificationAria:"Error Message bar text is ",MessageInfoBarNotificationAria:"Information Message bar text is ",MessageWarningBarNotificationAria:"Warning Message bar text is "}});var n,t=(n=l.ui.Control,__extends(o,n),o.prototype.init=function(e,t){var r=this;n.prototype.init.call(this,e,t),this.infoMessages||(this.infoMessages=l.observableArray([])),this.warningMessages||(this.warningMessages=l.observableArray([])),this.errorMessages||(this.errorMessages=l.observableArray([])),this.Messages=l.computed(function(){var e=l.value(r.infoMessages).slice();return e=(e=e.concat(l.value(r.warningMessages).slice())).concat(l.value(r.errorMessages).slice())}),this.AllMessages=l.computed(function(){var e=l.value(r.infoMessages).slice();return e=(e=e.concat(l.value(r.warningMessages).slice())).concat(l.value(r.errorMessages).slice())}),this.RemoveMessages=function(e,t){for(var o=0,n=l.length(t);o<n;o++){var i=t[o];r.RemoveMessage(i.messageId)}},this.ClearMessages=function(){r.ClearSystemInfoMessages(),r.ClearSystemWarningMessages(),r.ClearSystemErrorMessages()},$(document.body).on("clearMessageBarMessages",this.ClearMessages),$(document.body).on("removeMessages",this.RemoveMessages)},o.prototype.shortcutFocus=function(){var e=$(this.element).find(".messageBar:visible").first();if(e[0]){var t=$(e[0]).find(".messageBar-collapseButton[data-dyn-lastvisible='true']");if(0<t.length)$(t[0]).focus();else{var o=$(e[0]).find(".messageBar-closeIcon");0<o.length&&$(o[0]).focus()}}},o.prototype._clearWarningMessagesNotAttachedToInputControls=function(){var e=l.value(this.warningMessages).slice();if(e)for(var t=void 0,o=void 0,n=0;n<e.length;n++)(t=e[n])&&"FindRelatedControl"in t&&(o=t.FindRelatedControl()),o&&"List"!==o.TypeName&&"Form"!==o.TypeName||this.RemoveMessage(t.messageId)},o.prototype.ClearSystemInfoMessages=function(){if(this.infoMessages){var e=this.MessagesToKeep(this.infoMessages);this.infoMessages.clear(),this.AddMessagesToList(this.infoMessages,e)}this.InfoExpanded(!1)},o.prototype.ClearSystemWarningMessages=function(){if(this.warningMessages){var e=this.MessagesToKeep(this.warningMessages);this.warningMessages.clear(),this.AddMessagesToList(this.warningMessages,e)}this.WarningExpanded(!1)},o.prototype.ClearSystemErrorMessages=function(){if(this.errorMessages){var e=this.MessagesToKeep(this.errorMessages),t=this.PersistentMessagesToKeep(this.errorMessages);this.errorMessages.clear(),this.AddMessagesToList(this.errorMessages,e),this.AddMessagesToList(this.errorMessages,t)}this.ErrorExpanded(!1)},o.prototype.ClearMessagesFromControl=function(e){var t,o,n;if(e)for(var i=void 0,r=void 0,a=0;a<e.length;a++)(i=e[a])&&"FindRelatedControl"in i&&(r=i.FindRelatedControl()),r&&l.messaging.controlCanHaveMessages(r)&&i.messageId&&(null===(t=r.isInGrid)||void 0===t||!t.call(r)||null!==(o=r.isInTable)&&void 0!==o&&o.call(r)||null===(n=r.Root)||void 0===n||!n.UseReactGrid())&&r.removeMessageFromControl&&r.removeMessageFromControl(i.messageId)},o.prototype._updateControl=function(e){if("FindRelatedControl"in e){var t=e.FindRelatedControl();t&&l.messaging.controlCanHaveMessages(t)&&l.messageManager.isFrameworkMessage(e.messageId)&&(t.isInGrid&&t.isInGrid()&&t.Root&&t.Root.UseReactGrid()?t.addMessage(e.messageId,e.text):t.addMessage(e.messageId))}},o.prototype.GetMessage=function(e){for(var t=[this.infoMessages,this.warningMessages,this.errorMessages],o=0,n=l.length(t);o<n;o++)for(var i=l.value(t[o]),r=0;r<i.length;r++)if(i[r].messageId===e)return i[r];return null},o.prototype.AddMessage=function(e){this.AddMessages([e])},o.prototype.AddMessages=function(e){for(var t=[],o=[],n=[],i=0,r=l.length(e);i<r;i++)switch(e[i].type){case l.messaging.MessageType.information:t.push(e[i]);break;case l.messaging.MessageType.warning:case l.messaging.MessageType.fieldValidation:case l.messaging.MessageType.controlValidation:o.push(e[i]);break;default:n.push(e[i])}this.ProcessMessageList(this.infoMessages,t,!1),this.ProcessMessageList(this.warningMessages,o,!0),this.ProcessMessageList(this.errorMessages,n,!1)},o.prototype.RemoveMessage=function(e){for(var t=[this.infoMessages,this.warningMessages,this.errorMessages],o=0,n=l.length(t);o<n;o++){var i=t[o];if(e&&i){for(var r=l.value(i).slice(),a=0,s=l.length(r);a<s;a++)if(r[a].messageId===e){r.splice(a,1);break}i(r)}}},o.prototype.dispose=function(){$(document.body).off("clearMessageBarMessages",this.ClearMessages),$(document.body).off("removeMessages",this.RemoveMessages),n.prototype.dispose.call(this)},o.prototype.TrimMessageList=function(e,t){if(0<t&&0<l.length(e))if(l.length(e)>t){var o=l.length(e)-t;e(e().splice(0,o))}else e([])},o.prototype.ProcessMessageList=function(e,t,o){if(0<l.length(t)&&e){if(500<l.length(t)+l.length(e)){var n=l.length(t)+l.length(e)-500;this.TrimMessageList(e,n)}var i=t.reverse();if(0<l.length(e)){var r=l.value(e).slice();i=i.concat(r)}if(o)for(var a=0,s=l.length(t);a<s;a++)this._updateControl(i[a]);e(i)}},o.prototype.AddMessagesToList=function(e,t){for(var o=0,n=l.length(t);o<n;o++){var i=t[o];e.push(i)}},o.prototype.MessagesToKeep=function(e){for(var t=[],o=0,n=l.length(e);o<n;o++){var i=e()[o];0<i.messageId&&t.push(i)}return t},o.prototype.PersistentMessagesToKeep=function(e){for(var t=[],o=0,n=l.length(e);o<n;o++){var i=e()[o];i.originType===l.messaging.OriginType.Persistent&&t.push(i)}return t},o);function o(){var o=null!==n&&n.apply(this,arguments)||this;return o.IsInfoToggleVisible=l.computed(function(){return 1<l.length(o.infoMessages)}),o.IsWarningToggleVisible=l.computed(function(){return 1<l.length(o.warningMessages)}),o.IsErrorToggleVisible=l.computed(function(){return 1<l.length(o.errorMessages)}),o.IsInfoCloseVisible=l.observable(!0),o.IsWarningCloseVisible=l.observable(!0),o.IsErrorCloseVisible=l.computed(function(){return 1<l.length(o.errorMessages)||!(1===l.length(o.errorMessages)&&o.errorMessages()[0].originType===l.messaging.OriginType.Persistent)}),o.IsVisible=l.computed(function(){return o.IsViewModeVisible()||o.IsInfoVisible()||o.IsWarningVisible()||o.IsErrorVisible()}),o.IsInfoVisible=l.computed(function(){return 0<l.length(o.infoMessages)}),o.IsWarningVisible=l.computed(function(){return 0<l.length(o.warningMessages)}),o.IsErrorVisible=l.computed(function(){return 0<l.length(o.errorMessages)}),o.InfoCountText=l.computed(function(){return l.format(l.label("MessageBar_ExpandMessages"),l.length(o.infoMessages))}),o.WarningCountText=l.computed(function(){return l.format(l.label("MessageBar_ExpandMessages"),l.length(o.warningMessages))}),o.ErrorCountText=l.computed(function(){return l.format(l.label("MessageBar_ExpandMessages"),l.length(o.errorMessages))}),o.InfoToggle=function(){o.InfoExpanded(!l.value(o.InfoExpanded)),l.value(o.InfoExpanded)&&(o.WarningExpanded(!1),o.ErrorExpanded(!1))},o.ClearInfoMessages=function(){o.infoMessages&&(o.infoMessages.clear(),l.messageManager.setPersistentMessageVisibleState(l.messaging.MessageType.information,!1)),o.InfoExpanded(!1)},o.WarningToggle=function(){o.WarningExpanded(!l.value(o.WarningExpanded)),l.value(o.WarningExpanded)&&(o.InfoExpanded(!1),o.ErrorExpanded(!1))},o.ClearWarningMessages=function(){if(o.warningMessages){var e=l.value(o.warningMessages);o.ClearMessagesFromControl(e),o.warningMessages.clear(),l.messageManager.setPersistentMessageVisibleState(l.messaging.MessageType.warning,!1)}o.WarningExpanded(!1)},o.ErrorToggle=function(){o.ErrorExpanded(!l.value(o.ErrorExpanded)),l.value(o.ErrorExpanded)&&(o.InfoExpanded(!1),o.WarningExpanded(!1))},o.ClearErrorMessages=function(){if(o.errorMessages){var e=o.PersistentMessagesToKeep(o.errorMessages);o.errorMessages.clear(),o.AddMessagesToList(o.errorMessages,e)}o.ErrorExpanded(!1)},o.ClearViewModeMessage=function(){o.IsViewModeVisible(!1)},o.getPersistentMessageId=function(e){var t;switch(e){case l.messaging.MessageType.information:t=o.infoMessagesPersistentId;break;case l.messaging.MessageType.warning:t=o.warningMessagesPersistentId;break;case l.messaging.MessageType.error:t=o.errorMessagesPersistentId}return t},o.setPersistentMessageId=function(e,t){switch(e){case l.messaging.MessageType.information:o.infoMessagesPersistentId=t;break;case l.messaging.MessageType.warning:o.warningMessagesPersistentId=t;break;case l.messaging.MessageType.error:o.errorMessagesPersistentId=t}},o}e.MessageBar=t,l.ui.addObservablePropertiesToPrototype(t.prototype,{ErrorExpanded:!1,InfoExpanded:!1,IsViewModeVisible:!1,WarningExpanded:!1})}(l.controls||(l.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(p){!function(e){Globalize.addCultureInfo("en",{messages:{Product_IsPreview:"Preview",Product_IsPreviewDescription:"You're currently running a preview version of the service.",User_CompanyFormat:"({0}) {1}",User_SignOut:"Sign out"}});var t={Alias:"",AppVersion:"",BrandingLicense:"",ClientConnectivityEnabled:null,ClientFlightInformation:"",ClientId:null,Company:"",CompanyName:"",DefaultNavPaneView:null,Density:p.densityThemeManager._getDefaultDensity(),DismissLatestNotifications:null,DismissNotification:null,EnhancedTabSequence:!1,ExecuteNotificationAction:null,HasUserLicense:!0,ImageName:"Person",ImageType:"Symbol",Locale:"",MaxWaitTimeToFailInMinutes:null,NpsEnabled:!1,NpsEndpoint:"",OperatedBy:"",Partition:"",PlatformVersion:"",ProductIsPreview:null,RedirectToDashboard:!1,RegionalSettings:"",RequestCompanyChange:"",RequestedSessionNotFound:!1,SessionExpireAutoLogoff:null,SetCompany:null,ShowOnNavBar:null,Startpage:"",Theme:p.densityThemeManager._getDefaultTheme(),TimeZoneRules:"",TooltipOnFocus:!1,UserGuid:null,UserName:"",UserSessionDate:"",WebClientStatefulSessionTimeoutInSeconds:null};p.ui.defaults.User=t;var i,o=(i=p.ui.Control,__extends(n,i),n.prototype.updateCompany=function(e){var t=this;e&&(p.value(this.Company).toLowerCase()!==e.toLowerCase()?p.async(function(){p.callFunction(t.SetCompany,void 0,e)},void 0,"Update company"):p.util.parseQueryString(window.location.search)[p.shell.QueryStringKeys.companyKey.toLowerCase()]!==e.toLowerCase()&&p.shell.updateURLFromUserSettings({company:e}))},n.prototype.pack=function(){return{ClientFlightInformation:p.value(this.ClientFlightInformation),RegionalSettings:p.value(this.RegionalSettings),TimeZoneRules:p.value(this.TimeZoneRules)}},n.prototype.unpack=function(e){e&&(this.TimeZoneRules(e.TimeZoneRules),this.RegionalSettings(e.RegionalSettings),this.ClientFlightInformation(e.ClientFlightInformation))},n.prototype.executeNotificationAction=function(e){var t=$.Deferred();return p.callFunction(this.ExecuteNotificationAction,void 0,[e],t.resolve),t.promise()},n.prototype.dismissLatestNotifications=function(e,t){p.callFunction(this.DismissLatestNotifications,void 0,[e,t])},n.prototype.dismissNotification=function(e){p.callFunction(this.DismissNotification,void 0,e)},n.prototype.setUserAvatar=function(){var r=this;!function(){var e=p.value(p.user().UserName);if(e){var t="",o=e.split(" "),n=o[0],i=o[1];n&&i?t=n[0]+i[0]:n?t=n.substring(0,2):i&&(t=i.substring(0,2)),r.UserInitials(t.toUpperCase()),r.UseAvatarImage(!1),r.UseAvatarInitials(!0)}r.UserAvatarComplete(!0)}()},n.prototype.keyDown=function(e){p.util.handleShortcuts(this,e)},n.prototype.addFlightChangeListener=function(e,t){this.flightChangedCallbacks[e]?this.flightChangedCallbacks[e].push(t):this.flightChangedCallbacks[e]=[t]},n.prototype.removeFlightChangeListener=function(e,t){this.flightChangedCallbacks[e]&&(t?(this.flightChangedCallbacks[e]=this.flightChangedCallbacks[e].filter(function(e){return e!==t}),0===this.flightChangedCallbacks[e].length&&delete this.flightChangedCallbacks[e]):delete this.flightChangedCallbacks[e])},n);function n(e,t,o,n){var c=i.call(this,e,t,o,n)||this;return c.Click=function(){c.UserFlyoutVisible(!0)},c.UserVisible=function(){c.UserFlyoutVisible()?$(document.body).on("resetShellOnNavigation.dynNavigationBarUser",function(){c.UserFlyoutVisible(!1)}):$(document.body).off("resetShellOnNavigation.dynNavigationBarUser")},c.updateTimeZoneRules=function(e){p.value(e)&&moment.tz.add(p.value(e))},c.updateRegionalSettings=function(e){var t=p.value(e);if(t){var o=JSON.parse(t);Globalize.addCultureInfo(function(){var e=Globalize.culture(),t=Globalize.culture().name;for(var o in Globalize.cultures)if(Globalize.cultures.hasOwnProperty(o)&&Globalize.cultures[o]===e){t=o;break}return t}(),{calendar:{"/":o.dateSeparator,":":o.timeSeparator,firstDay:o.firstDayOfWeek,patterns:{d:o.shortDate,t:o.shortTime,T:o.shortTime}},numberFormat:{"+":o.positiveSign,",":o.thousandsSeparator,"-":o.negativeSign,".":o.decimalSeparator,decimals:o.decimals,pattern:[o.pattern]}}),p.util.timeSeparators.auto=o.timeSeparator?o.timeSeparator:" ";var n={longDateFormat:{LT:-1!==o.shortTime.indexOf("H")?"HH"+o.timeSeparator+"mm":"hh"+o.timeSeparator+"mm A"},week:{dow:o.firstDayOfWeek}};moment.updateLocale(moment.locale(),n)}},c.updateClientFlight=function(e){var t,o,n,i=p.value(c.FlightingFlags),r=p.value(e);if(r&&(n=JSON.parse(r),c.FlightingFlags(n)),c.flightChangedCallbacks)for(var a in c.flightChangedCallbacks)if(c.flightChangedCallbacks[a]){var s=null==n?void 0:n[a],l=null==i?void 0:i[a];if(s!==l)try{for(var u=(t=void 0,__values(c.flightChangedCallbacks[a])),d=u.next();!d.done;d=u.next()){(0,d.value)(s,l)}}catch(e){t={error:e}}finally{try{d&&!d.done&&(o=u.return)&&o.call(u)}finally{if(t)throw t.error}}}p.serverForm.compilation.StaticLoader.staticLoaderOn=!(!p.debug.staticLoaderOn&&!p.flags.useDesignTimeView)||p.util.isFlightEnabled("StaticLoaderOn")},c.updateOperatedByName=function(e){p.shell.OperatedByName(p.value(e))},c.updateBrandingNameItems=function(e){var t=p.value(e),o={D365_Finance:"#054C13",D365_Retail:"#7F4209",D365_SCM:"#1F416E"},n=JSON.parse(t),i=n.ProductShortName,r=n.ProductBrandingName,a=n.ProductSKU;i&&!p.shell.ProductShortName()&&p.shell.updateProductNameItems(i),r&&!p.shell.ProductName()&&p.shell.ProductName(r),a&&(p.appConfig?(p.appConfig["msapplication-tooltip"]&&r&&p.htmlDocument.setMetaValue("msapplication-tooltip","Launch "+r,""),p.shell.FavIconUrl||(p.appConfig.images.favIconUrl&&p.appConfig.images.favIconName?(p.shell.FavIconUrl=p.appConfig.images.favIconUrl+"/"+a+"/"+p.appConfig.images.favIconName,p.htmlDocument.setFavicon(p.shell.FavIconUrl)):p.log("Failed to set FavIconUrl - either name or url was missing")),p.appConfig.images&&p.appConfig.images.tileImagesUrl?(p.appConfig.images["msapplication-TileImage"]&&(p.htmlDocument.setMetaValue("msapplication-TileImage",p.appConfig.images["msapplication-TileImage"],p.appConfig.images.favIconUrl+"/"+a+"/"),o[a]&&(p.htmlDocument.setMetaValue("msapplication-TileColor",o[a],""),p.htmlDocument.setMetaValue("msapplication-navbutton-color",o[a],""))),p.appConfig.images["apple-touch-icon"]&&p.htmlDocument.setLinkIconValue("apple-touch-icon",p.appConfig.images["apple-touch-icon"],p.appConfig.images.favIconUrl+"/"+a+"/")):p.log("Failed to set tileImages - url was missing")):p.log("Undefined or null appConfig"))},c.NavigateToDashboard=function(){p.value(c.RedirectToDashboard)&&p.async(function(){c.RedirectToDashboard._current=!1,p.shell.closeAllFormsBeforeNavigating(p.shell.goHome)},void 0,"doRedirectToDashboard")},c.RestoreServerSession=function(){p.value(c.RequestedSessionNotFound)&&p.async(function(){if(p.serverForm){var e=p.serverForm.defaultChannel();e&&e.channel&&e.channel.serverSessionId&&p.serverForm.endSession(e.channel.serverSessionId),p.shell.cleanWindowFormsBeforeNavigating(p.serverForm.restoreCurrentSession)}},void 0,"Cleaning client side form objects before requesting a server session restore.")},c.CloseFormsThenChangeCompany=function(){p.value(c.RequestCompanyChange)&&p.async(function(){var e=p.value(c.RequestCompanyChange);c.RequestCompanyChange._current="";var t=p.serverForm.initialForm();t.targetElement=void 0,t.context=void 0,t.updateQuery=!0,p.shell.closeAllFormsBeforeNavigating(function(){p.shell.createForm(t)},{closeDashboard:!0,destinationCompany:e,retainCrumb:!0})},void 0,"doCloseFormsThenChangeCompany")},p.ui.applyDefaults(c,e,p.ui.defaults.User),c.FlightingFlags=p.observable(),c.UseAvatarImage=p.observable(!1),c.UseAvatarInitials=p.observable(!0),c.UserAvatar=p.observable(""),c.UserAvatarComplete=p.observable(!1),c.UserInitials=p.observable(""),c._language=p.observable(""),c.Language=p.computed(function(){return p.value(c._language)},function(e){p.value(c._language)?p.logWarning('Language already set: current="%s", requested: "%s"',c._language,e):c._language(e)}),e&&(e.Language=c.Language),c.ShowOnNavBar(!0),c.DefaultNavPaneView(2),c.UserFlyoutVisible=p.observable(!1),c.UserFlyoutVisible.valueChanged.subscribe(c.UserVisible),c.TimeZoneRules.valueChanged.subscribe(c.updateTimeZoneRules),p.deferred.onTrue(function(){return!!p.value(p.value(c.ProductIsPreview))}).done(function(){window.setTimeout(function(){p.util.isPreviewBuild()&&(p.shell.ProductShortNameHelpText(p.shell.ProductShortNameHelpText()+" "+p.label("Product_IsPreviewDescription")),p.shell.setProductName())},1e3)}),c.ClientFlightInformation.valueChanged.subscribe(c.updateClientFlight),c.RegionalSettings.valueChanged.subscribe(c.updateRegionalSettings),c.BrandingLicense.valueChanged.subscribe(c.updateBrandingNameItems),c.OperatedBy.valueChanged.subscribe(c.updateOperatedByName),c.recordTelemetry=function(){},c.flightChangedCallbacks={},c.Company.valueChanged.subscribe(p.DynReact.ModuleStore.reset,p.DynReact.ModuleStore),c.RedirectToDashboard.valueChanged.subscribe(c.NavigateToDashboard),c.RequestCompanyChange.valueChanged.subscribe(c.CloseFormsThenChangeCompany),c.RequestedSessionNotFound.valueChanged.subscribe(c.RestoreServerSession),c.Theme.valueChanged.subscribe(p.densityThemeManager._updateThemeAndDensity),c.Density.valueChanged.subscribe(p.densityThemeManager._updateThemeAndDensity),c.Startpage.valueChanged.subscribe(p.shell.setStartPage),c.NavigationCompanyName=p.computed(function(){var e=null,t=p.shell.getCurrentRootForm();t&&(e=p.context(t));return e&&p.value(e.FormSetDefaultCompany)?e.FormCompanyName():c.CompanyName()}),c.NavigationCompany=p.computed(function(){var e=null,t=p.shell.getCurrentRootForm();t&&(e=p.context(t));return e&&p.value(e.FormSetDefaultCompany)?e.FormCompany():c.Company()}),c.UserFlyoutVisible.valueChanged.subscribe(function(){if(c.UserFlyoutVisible()){var t=$(c.element).find(".navigationBar-userFlyOut");p.microTask(function(){var e=p.util.findFirstFocusableControl(t);e&&(p.log.focus&&p.log.focus("Focus: NavBar-> Open user flyout, executing MicroTask to set focus"),$(e).focus())}),c.recordTelemetry()}}),c}e.User=o;var r={DefaultAction:{Keys:{keyCode:[p.ui.KeyCodes.enter,p.ui.KeyCodes.spacebar]},Handler:function(){this.Click()},ShowToUser:!1}};o.prototype.Shortcuts=p.extendPrototype(o.prototype.Shortcuts,r),p.adapter({id:"UserButton",controlType:"User",template:"UserButton"}),p.adapter({id:"PopoutUserButton",controlType:"User",template:"PopoutUserButton"})}(p.controls||(p.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(i){!function(e){Globalize.addCultureInfo("en",{messages:{DefaultControl_Text:"[{0}] {1}",DefaultControl_UnsupportedControlMessage:"Control type '{0}' is no longer supported."}});var t,o=(t=i.ui.Control,__extends(n,t),n);function n(){return null!==t&&t.apply(this,arguments)||this}e.Hidden=o}(i.controls||(i.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(a){!function(e){Globalize.addCultureInfo("en",{messages:{NavBar_CompanyPickerHelpText:"(Ctrl+Shift+O)\r\nChoose a Legal Entity",NavBar_CurrentCompanyText:"Current company is {0} activate to choose a company",NavBar_Lookup:"Lookup"}});var o,t=(o=a.ui.Control,__extends(n,o),n.prototype.init=function(e,t){var r=this;o.prototype.init.call(this,e,t),this.recordTelemetry=function(){},$.when(a.deferred.onHasValue(a.user)).done(function(e){a.observe(e.NavigationCompanyName,function(){r.CompanyName(e.CompanyName())}),a.observe(e.NavigationCompany,function(){r.Company(e.Company())})}),this.CompanyLookupVisible=a.observable(!1),this.CompanyLookupVisible.valueChanged.subscribe(function(){if(r.CompanyLookupVisible()){var e=r.element.parentElement.clientWidth;r.element.style.width=e+"px",r.recordTelemetry(),$(document.body).on("resetShellOnNavigation.dynNavigationBarCompany",function(){r.closeLookup()}),$(document.body).on("click.dynNavigationBarCompany",function(e){var t,o;if(!$.contains(r.element,e.target)){for(var n=!1,i=null===(t=a.ui.getLiveControl(e.target))||void 0===t?void 0:t.Root;i;){if((null==i?void 0:i.element)===(null===(o=r.lookupControl)||void 0===o?void 0:o.popupHostElement)){n=!0;break}i=null==i?void 0:i.Root}n||r.closeLookup()}}),a.setValue(r.lookupControl,"Visible",!0),r.companyChooserFormElement&&r.companyChooserForm?(r.companyChooserForm.takeNavigationFocus(),r.companyChooserForm.Refresh(),a.async(function(){r.lookupControl.element&&!a.layout.provider.isFillWidth(r.lookupControl.element)&&a.layout.provider.setFillWidth(r.lookupControl.element);var e=r.lookupControl.$inputElement[0];e&&(a.ui.selectionStart(e,0),a.ui.selectionEnd(e,e.value.length))},void 0,"Select the company text")):r.findCompanyLookupForm()}else r.element.style.width="auto",a.setValue(r.lookupControl,"Visible",!1),$(document.body).off(".dynNavigationBarCompany")}),this.LongCompanyName=a.computed(function(){var e,t,o=a.value(r.CompanyName);return a.value(r.ShowCompanyName)&&(o=a.util.isRTLMode()?"".concat(a.value(r.CompanyName)," | ").concat(null===(e=a.value(r.Company))||void 0===e?void 0:e.toLocaleUpperCase()):"".concat(null===(t=a.value(r.Company))||void 0===t?void 0:t.toLocaleUpperCase()," | ").concat(a.value(r.CompanyName))),o}),this.CompanyButtonText=a.computed(function(){var e;return a.value(r.ShowCompanyName)?a.value(r.LongCompanyName):null===(e=a.value(r.Company))||void 0===e?void 0:e.toLocaleUpperCase()})},n.prototype.findCompanyLookupForm=function(){var e=this;if(a.async.IsClientProcessing())var t=a.clientBusy.valueChanged.subscribe(function(){e.isLookupFormLoaded()?e.processLookupForm():e.findCompanyLookupForm(),a.clientBusy.valueChanged.unsubscribe(t)});else window.setTimeout(function(){e.isLookupFormLoaded()?e.processLookupForm():e.findCompanyLookupForm()})},n.prototype.isLookupFormLoaded=function(){return this.companyChooserFormElement||(this.companyChooserFormElement=this.element.getElementsByClassName("rootContent")[0]),!!(this.companyChooserFormElement&&this.companyChooserFormElement.parentElement&&$(this.companyChooserFormElement.parentElement).attr("data-dyn-rootserverid"))},n.prototype.processLookupForm=function(){var t=this;this.companyChooserForm=a.context(this.companyChooserFormElement),a.shell.activateElement(this.companyChooserFormElement),this.companyChooserForm.takeNavigationFocus();var o=this.companyChooserForm.findControl("DataArea_id");if(o&&(this.lookupControl=a.context(o),this.lookupControl)){this.lookupControl.SendKeyToLookup=!0,this.lookupControl.ShouldFlyoutTakeFocus(!1);var e={Escape:{Keys:{keyCode:a.ui.KeyCodes.esc},Handler:function(){var e;return!!t.CompanyLookupVisible()&&(t.CompanyLookupVisible(!1),null!==(e=document.getElementById("CompanyButton_button"))&&void 0!==e&&e.focus(),!0)},RecordTelemetry:!1},Tab:{Keys:{keyCode:a.ui.KeyCodes.tab,isShiftKeyAgnostic:!0},Handler:function(){var e;return!!t.CompanyLookupVisible()&&(t.CompanyLookupVisible(!1),null!==(e=document.getElementById("CompanyButton_button"))&&void 0!==e&&e.focus(),!0)},RecordTelemetry:!1}};a.util.objectAssign(this.lookupControl.Shortcuts,e),a.async(function(){a.layout.provider.setFillWidth(o);var e=t.lookupControl.$inputElement[0];e&&(a.ui.selectionStart(e,0),a.ui.selectionEnd(e,e.value.length))},void 0,"Select the company text in process lookup")}},n.prototype.closeLookup=function(){this.CompanyLookupVisible(!1),this.lookupControl&&this.lookupControl.popupHostElement&&$(this.lookupControl.popupHostElement).css("display","none")},n.prototype.toggleCompanyLookupVisible=function(){this.CompanyLookupVisible()?this.CompanyLookupVisible(!1):this.CompanyLookupVisible(!0)},n);function n(){var e=null!==o&&o.apply(this,arguments)||this;return e.getCurrentCompanyText=function(){return a.format(a.label("NavBar_CurrentCompanyText"),a.value(e.Company))},e.click=function(){e.toggleCompanyLookupVisible()},e.keyDown=function(e){a.util.isShortcutKeyPressed(e,{keyCode:a.ui.KeyCodes.enter})&&(e.stopPropagation(),a.log.stopPropagation&&a.log.stopPropagation("Prevent form level Enter shortcut in Commpany control."))},e}e.Company=t,a.ui.addObservablePropertiesToPrototype(t.prototype,{Company:"",CompanyName:"",ShowCompanyName:!1,ShowOnNavBar:!0}),a.adapter({id:"CompanyButton",controlType:"Company",template:"CompanyButton"})}(a.controls||(a.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){var e,a,t;function o(e,t,o,n){var i=a.call(this,e,t,o,n)||this;return $.when(r.deferred.onHasValue(r.user)).done(function(e){r.observe(e.Company,function(){i.PartForm&&r.applyFunction(i.PartForm.Refresh,i.PartForm)})}),i}e=r.controls||(r.controls={}),a=r.controls.Part,__extends(o,a),t=o,(e.CompanyChooser=t).prototype.template="Part"}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(l){var e,o,t;function n(){return null!==o&&o.apply(this,arguments)||this}e=l.controls||(l.controls={}),o=l.ui.Control,__extends(n,o),n.prototype.init=function(e,t){var s=this;o.prototype.init.call(this,e,t),this.activeFormObserver=l.observe(l.activeForm,function(){var e,t,o,n=l.context(l.value(l.activeForm));if(n){var i=n.FormCompanyName(),r=null===(e=n.FormCompany())||void 0===e?void 0:e.toLocaleUpperCase();if(null!==(o=null===(t=s._parent)||void 0===t?void 0:t.element)&&void 0!==o&&o.classList.contains("officeNavBar")){var a=l.util.isRTLMode()?"".concat(i," | ").concat(r):"".concat(r," | ").concat(i);s.LongCompanyName(a),s.CompanyButtonText(a)}else s.LongCompanyName(i),s.CompanyButtonText(r)}}),this._viewportChangeHandler(null,l.shell.CurrentShellViewPortWidthSize),this.viewportBindingHandler=l.bindingHandlers.ShellViewportWidthSize(),this.viewportBindingHandler.apply(this._viewportChangeHandler,this)},n.prototype.dispose=function(){var e,t;this.activeFormObserver&&this.activeFormObserver.dispose(),null!==(t=null===(e=this.viewportBindingHandler)||void 0===e?void 0:e.dispose)&&void 0!==t&&t.call(e),o.prototype.dispose.call(this)},n.prototype._viewportChangeHandler=function(e,t){var o,n,i;if(null!==(n=null===(o=this._parent)||void 0===o?void 0:o.element)&&void 0!==n&&n.classList.contains("officeNavBar"))if(t<=l.shell.NavBarSizes.smallNavBarSize){var r=l.context(l.value(l.activeForm));if(r){var a=null===(i=r.FormCompany())||void 0===i?void 0:i.toLocaleUpperCase();this.CompanyButtonText(a)}}else this.CompanyButtonText()!==this.LongCompanyName()&&this.CompanyButtonText(this.LongCompanyName())},t=n,e.PopoutCompany=t,l.ui.addObservablePropertiesToPrototype(t.prototype,{CompanyButtonText:"",LongCompanyName:""}),l.adapter({id:"PopoutCompanyButton",controlType:"PopoutCompany",template:"PopoutCompanyButton"})}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(n){var e,i,t;function o(){var t=null!==i&&i.apply(this,arguments)||this;return t.click=function(){t.SearchFieldVisible()||(t.SearchFieldVisible(!0),t.recordTelemetry(),t.boundEventHandlers||($(document.body).on("resetShellOnNavigation.dynNavigationBarSearch",function(){t.SearchFieldVisible(!1),t.closeResults(),t.boundEventHandlers&&($(document.body).off(".dynNavigationBarSearch"),t.boundEventHandlers=!1)}),$(document.body).on("click.dynNavigationBarSearch",function(e){$.contains(t.element,e.target)||(t.SearchFieldVisible(!1),t.closeResults(),t.boundEventHandlers&&($(document.body).off(".dynNavigationBarSearch"),t.boundEventHandlers=!1))}),t.boundEventHandlers=!0)),document.activeElement!==t.element.querySelector("input")?(t.inputBoxElement=t.inputBoxElement||t.element.querySelector("input"),setTimeout(function(){t.inputBoxElement.focus(),0<t.inputBoxElement.value.length&&(n.ui.selectionStart(t.inputBoxElement,0),n.ui.selectionEnd(t.inputBoxElement,t.inputBoxElement.value.length))},0)):(t.closeResults(),t.SearchFieldAlwaysOpen()||t.SearchFieldVisible(!1))},t}e=n.controls||(n.controls={}),i=n.ui.Control,__extends(o,i),o.prototype.init=function(e,t){var o=this;i.prototype.init.call(this,e,t),this.recordTelemetry=function(){},this.SearchFieldVisible=n.observable(!1),this.SearchFieldNotVisible=n.computed(function(){return!n.value(o.SearchFieldVisible)}),this.SearchFieldAlwaysOpen=n.observable(!1)},o.prototype.dispose=function(){this.boundEventHandlers&&$(document.body).off(".dynNavigationBarSearch"),i.prototype.dispose.call(this)},o.prototype.closeResults=function(){this.searchBox=this.searchBox||n.context(this.element.querySelector("[data-dyn-controlname='NavigationSearchBox']")),this.searchBox&&this.searchBox.ShowResultPicker(!1)},t=o,e.NavigationSearchControl=t,n.ui.addObservablePropertiesToPrototype(t.prototype,{CombinedSearchEnabled:n.debug.combinedSearch}),n.adapter({id:"NavigationSearchButton",controlType:"NavigationSearchControl",template:"NavigationSearchButton"})}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(u){var e;function s(i,e){void 0===e&&(e=!1);var r=u.whatsNew._tipClass[i];r&&r.qtip&&(r.qtip("reposition"),!e&&i.indexOf&&0!==i.indexOf("whatsNew-")&&u.observe(u.clientBusy,function(e){if(!e){var t=u.whatsNew._escapedId(i),o=u.util.isBehindOtherElement(r[0],$("[id=qtip-"+t+"] > .qtip-tip canvas")[0]),n=$("[id=qtip-"+t+"]");return o&&n.is(":visible")?n.hide():!o&&n.is(":hidden")&&n.show(),!1}}))}Globalize.addCultureInfo("en",{messages:{WhatsNew_DefaultTitle:"Whats new",WhatsNew_GotItButton:"Got it!",WhatsNew_LinkButton:"Learn more",WhatsNew_ShortCutDescription:"Move to the next feature callout"}}),(e=u.whatsNew||(u.whatsNew={}))._whatsNewNotification=[],e._tipClass={},e._currentFocusTip=0,e.keyIds={keyProperty:"gotit",keyStartPhrase:"whatsNewTip-",mainId:"WhatsNew_FeatureIntroduction",navigationKey:"NavPaneFirstUse"},e.processWhatsNewMessage=function(e,t){var o,n;if(u.whatsNew._whatsNewNotification)try{for(var i=__values(u.whatsNew._whatsNewNotification),r=i.next();!r.done;r=i.next()){if(r.value.RuleId===e.RuleId)return void u.logWarning("Duplicate whatsnew messages detected skipping")}}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}u.whatsNew._whatsNewNotification.push(e),u.whatsNew._whatsNewOptions=t,u.observe(u.clientBusy,function(e){var t,o;if(!u.value(e)){var l="";if(void 0===u.ax.taskRecording||!u.value(u.ax.taskRecording.isRecording)&&!u.value(u.ax.taskRecording.taskGuidePlaybackState)&&!u.value(u.ax.personalizationUtil.isPersonalizationModeTurnedOn())){if(u.whatsNew._whatsNewNotification){var n=function(e){l="";var t=void 0,o=[];if(e.AdditionalData&&e.AdditionalDataType&&"WhatsNewFeatureContract"===e.AdditionalDataType&&(o=JSON.parse(e.AdditionalData)),e.TargetControl&&(t="string"==typeof e.TargetControl?$(u.shell.activeFormElement).find("[data-dyn-controlname="+e.TargetControl+"]")[0]:e.TargetControl),!t&&(""===e.TargetControl||null===e.TargetControl)||t){t||(t=u.isEmbedded?$("[data-dyn-controlname=EmbeddedBar]")[0]:u.restrictedNavigation?$("[data-dyn-controlname=PopoutNavigationBar]")[0]:$("[data-dyn-controlname=NavigationBar]")[0],u.whatsNew._whatsNewOptions={my:"top center",at:"bottom center"}),"string"!=typeof t&&u.context(t)&&u.context(t).Root&&u.context(t).Root.FormName&&(l=u.context(t).Root.FormName+"-");var n=null;n=u.whatsNew._whatsNewOptions?u.whatsNew._whatsNewOptions:u.util.isRTLMode()?{my:"right center",at:"left center"}:{my:"left center",at:"right center"};var i=e.RuleId,r=l+u.whatsNew.keyIds.keyStartPhrase+i,a=u.ui.createControl("Label",{Text:e.Message},null,"span"),s=u.ui.createControl("Group",{Name:"WhatsNewButtonGroup"});if(void 0!==o[0]&&""!==o[0])u.ui.createChildControl("HyperLink",{BaseUrl:o[0],OpenInNewWindow:!0,Text:u.label("WhatsNew_LinkButton")},s,{tagName:"a"}).classList.add("whatsNew-LinkControl");u.ui.createChildControl("Button",{Click:function(){u.whatsNew._whatsNewGotIt(r,i)},Label:u.label("WhatsNew_GotItButton")},s,{tagName:"button"}).classList.add("whatsNew-GotItButton"),u.whatsNew.isItShown(r)?u.whatsNew.reposition(r,!0):u.whatsNew.openWhatsNew(t,r,e.Title,$(a).add($(s)),n)}};try{for(var i=__values(u.whatsNew._whatsNewNotification),r=i.next();!r.done;r=i.next()){n(r.value)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}}u.whatsNew._whatsNewNotification=[]}return!1}})},e._whatsNewGotIt=function(e,t){t===u.whatsNew.keyIds.navigationKey?u.DynReact.ModuleStore.whatsNewClose():u.async(function(){u.callFunction(u.user().SetCustomObjectPersonalization,void 0,[u.whatsNew.keyIds.mainId,t,u.whatsNew.keyIds.keyProperty,!0])},void 0,"Update whatsnew gotit"),u.whatsNew.closeWhatsNew(e)},e._escapedId=function(e){return e?e.replace(/(:|\.|\{|\}|,|=|@|\\)/g,"\\$1"):e},e.areWhatsNewShown=function(){return 0<Object.keys(u.whatsNew._tipClass).length},e.isItShown=function(e){if(u.whatsNew._tipClass){var t=u.whatsNew._tipClass[e];if(t&&t.qtip)return!0;var o=u.whatsNew._escapedId(e);$("[id=qtip-"+o+"]")[0]&&($("[id=qtip-"+o+"]")[0].remove(),t&&delete u.whatsNew._tipClass[e])}return!1},e.moveNextWhatsNewFocus=function(){var e=Object.keys(u.whatsNew._tipClass);if(e){u.whatsNew._currentFocusTip=e.length>u.whatsNew._currentFocusTip?u.whatsNew._currentFocusTip:0;var t=u.whatsNew._escapedId(e[u.whatsNew._currentFocusTip]);if(t){var o=$("[id=qtip-"+t+"] .whatsNew-GotItButton")[0];o?(o.focus(),u.whatsNew._currentFocusTip++):delete u.whatsNew._tipClass[e[u.whatsNew._currentFocusTip]]}else u.whatsNew._currentFocusTip=0}},e.closeTipsForForm=function(e){var t;if(u.whatsNew._tipClass)for(var o in u.whatsNew._tipClass)u.whatsNew._tipClass.hasOwnProperty(o)&&0===o.indexOf(e+"-")&&(t=u.whatsNew._tipClass[o])&&(t.qtip("destroy",!0),delete u.whatsNew._tipClass[o])},e.closeWhatsNew=function(e){if(0<Object.keys(u.whatsNew._tipClass).length){e===u.whatsNew.keyIds.navigationKey&&(e=u.whatsNew.keyIds.keyStartPhrase+e);var t=u.whatsNew._tipClass[e];t&&t.qtip&&(delete u.whatsNew._tipClass[e],t.qtip("destroy",!0));var o=u.context(u.shell.getActiveForm());o&&(u.log.focus&&u.log.focus("Focus: closeWhatsNew Form(Form.Id: %s) setting focus back to the active form",e),o.takeNavigationFocus())}},e.reposition=s,e.hideIfScrolledOffView=function(e){if(u.whatsNew._tipClass[e]&&!u.util.isElementInView(u.whatsNew._tipClass[e][0])){var t=u.whatsNew._escapedId(e);$("[id=qtip-"+t+"]").hide()}},e.openWhatsNew=function(e,t,o,n,i){var r="whatsNew qtip-light baseDirection",a=u.ui.getNavBar();a&&!u.restrictedNavigation&&u.value(a.OfficeNavBarVisible())&&(r+=" officeNavBarInUse");try{$(e).qtip({id:t,content:{text:n,title:o||u.label("WhatsNew_DefaultTitle")},show:{delay:u.flags.disableAnimations?0:500,ready:!0,effect:!u.flags.disableAnimations&&void 0},position:{my:i&&void 0!==i.my?i.my:"right center",at:i&&void 0!==i.at?i.at:"left center",adjust:{y:i&&void 0!==i.adjust_y?i.adjust_y:0,x:i&&void 0!==i.adjust_x?i.adjust_x:0,method:"shift shift"},viewport:$(window),effect:!u.flags.disableAnimations&&void 0},style:{classes:r,tip:{corner:!0,height:7,width:15}},hide:{event:e!==$("[data-dyn-controlname=NavigationBar]")[0]&&"click",effect:!u.flags.disableAnimations&&void 0},events:{render:function(e,t){u.whatsNew.scrollingHandlerDispose=u.util.scrollingContainer(t.elements.target[0],"".concat(t.id),u.whatsNew.reposition),u.whatsNew.tabbingHandlerDispose=u.util.tabbingContainer(t.tooltip[0],u.label("whatsNew")),u.whatsNew.layoutReflowEndHandler=u.layout.registerEndReflowHandler(t.elements.target[0],function(){"NavBar"===t.target[0].id||"PopoutNavBar"===t.target[0].id?s(t.id,!0):s(t.id,!1)}),$(document.body).on("resetShellOnNavigation.whatsNew",function(){var e=u.context(u.shell.getCurrentRootForm());e&&u.whatsNew.closeTipsForForm(e._formName)}),$(document.body).on("keydown.whatsNewEsc",function(e){if(e.keyCode===u.ui.KeyCodes.esc&&$(e.target).closest(".whatsNew")[0]){var t=$(e.target).closest(".whatsNew")[0].id;t=t.startsWith("qtip-")?t.substr(5):t,e.stopPropagation(),u.log.stopPropagation&&u.log.stopPropagation("Escape handler for qtip"),e.preventDefault(),u.whatsNew.closeWhatsNew(t)}}),u.whatsNew._tipClass[t.id]=t.elements.target,setTimeout(function(){u.whatsNew.hideIfScrolledOffView(t.id)})},focus:function(e,t){e.preventDefault()},hide:function(e,t){u.whatsNew.scrollingHandlerDispose(),u.whatsNew.tabbingHandlerDispose(),$(document.body).off("keydown.whatsNewEsc"),u.whatsNew.layoutReflowEndHandler&&(u.whatsNew.layoutReflowEndHandler.dispose(),u.whatsNew.layoutReflowEndHandler=null),$(document.body).off("resetShellOnNavigation.whatsNew"),u.whatsNew.closeWhatsNew(t.id)}}}).qtip("api")}catch(e){u.async.pending.decrement("Done with WhatsNewTips load"),u.telemetry.addErrorEvent({errorLabel:u.label("WhatsNewTip"),callStack:e.stack,type:3})}}}($dyn=$dyn||{}),function(l){var u;(u=l.superTooltip||(l.superTooltip={}))._closeSuperTooltipInterval=-1,u._superToolTipStorage="data-dyn-qtip-title",u._superToolTipStorageDescribedBy="data-dyn-qtip-describedby",u._superToolTipStorageHasTitleAttribute="data-dyn-qtip-hasTitleAttr",u._superToolTipControl=null,u.destroySuperTooltip=function(){if(l.superTooltip.superToolTip){var e=void 0;l.superTooltip.superToolTip.elements&&l.superTooltip.superToolTip.elements.target[0]&&(e=l.superTooltip.superToolTip.elements.target[0]),l.superTooltip.clearPreviewCloseInterval(),l.superTooltip.superToolTip.destroy(!0),l.superTooltip.superToolTip=null,l.superTooltip._superToolTipControl=null,$(document.body).off("keydown.superToolTipEsc"),e&&l.superTooltip.restoreElementAttributes(e)}},u.restoreElementAttributes=function(o){if(o){var e=l.flags.disableAnimations?0:250;setTimeout(function(){if(o.getAttribute(l.superTooltip._superToolTipStorage)){if(o.getAttribute(l.superTooltip._superToolTipStorageHasTitleAttribute)){var e=o.getAttribute(l.superTooltip._superToolTipStorage);o.getAttribute("title")||o.setAttribute("title",e)}o.removeAttribute(l.superTooltip._superToolTipStorage)}if(o.getAttribute(l.superTooltip._superToolTipStorageDescribedBy)){var t=o.getAttribute(l.superTooltip._superToolTipStorageDescribedBy);"null"!==t?o.setAttribute("aria-describedby",t):o.removeAttribute("aria-describedby"),o.removeAttribute(l.superTooltip._superToolTipStorageDescribedBy)}},e)}},u.getTitle=function(e){var t,o,n,i,r=l.ui.getLiveControl(e);return r&&null!==(t=r.isInGrid)&&void 0!==t&&t.call(r)&&!r.isInTable()&&null!==(o=r.Root)&&void 0!==o&&o.UseReactGrid()?n=l.value(r.Label):(e&&(e.title?n=e.title:(i=e.getAttribute("data-dyn-title"))?n=i:r&&(l.value(r.Label)?n=e.getAttribute("dyn-data-optional-label")?e.getAttribute("dyn-data-optional-label"):l.value(r.ShowLabel)?l.value(r.Label):void 0:l.value(r.Title)?n=l.value(r.Title):e.textContent&&""!==e.textContent.trim()&&(n=e.textContent))),n)},u.getBody=function(e){var t,o;if(e)if(o=e.getAttribute("data-dyn-helptext"))t=o;else{var n=l.ui.getLiveControl(e);n&&l.value(n.HelpText)&&!n.hideTooltipBody&&(t=l.value(n.HelpText)?l.value(n.HelpText):null)}return t},u.isElementInGrid=function(e){if(void 0!==e.isInGrid)return e.isInGrid();var t=l.ui.getLiveControl(e);return void 0!==t&&!(!t.isInGrid||!t.isInGrid()||"ColumnHeader"===t.TypeName||$(e.parentElement).hasClass("dyn-headerCell")||$(e).hasClass("dyn-headerCell"))},u.tryOpenSuperTooltip=function(t,e,o,n){var i="baseDirection fieldToolTipBase";if(!l.superTooltip.isElementInGrid(t)&&!$(t).data("qtip")){var r=void 0===e?l.superTooltip.getTitle(t):e,a=void 0===o?l.superTooltip.getBody(t):o;if(t.removeAttribute(u._superToolTipStorageHasTitleAttribute),a||(i+=" bodyTextHide",!t.textContent||r!==t.innerText.trim()||n||l.util.hasHorizontalOverflow(t))){if(r){l.superTooltip.superToolTip&&l.superTooltip.destroySuperTooltip(),(l.superTooltip._superToolTipControl=t).getAttribute("title")&&(t.setAttribute(u._superToolTipStorage,r),t.setAttribute(u._superToolTipStorageHasTitleAttribute,"true"),t.removeAttribute("title")),t.getAttribute("aria-describedby")&&(t.setAttribute(u._superToolTipStorageDescribedBy,t.getAttribute("aria-describedby")),t.removeAttribute("aria-describedby"));var s=$("<div>").text(r);("input"===t.tagName.toLowerCase()&&t.value===r||t.innerText&&r===t.innerText.trim())&&(s=$("<div aria-hidden='true'>").text(r));try{l.superTooltip.superToolTip=$(t).qtip({id:"superToolTip",overwrite:!1,suppress:!1,content:{text:$("<div>").text(a),title:s},style:{classes:i,tip:!1},position:{my:"bottom center",at:"top center",viewport:$(window),adjust:{y:-5},effect:!l.flags.disableAnimations&&void 0},show:{delay:l.flags.disableAnimations?0:500,ready:!0,effect:!l.flags.disableAnimations&&void 0},hide:{fixed:!0,event:"click mouseleave blur",effect:!l.flags.disableAnimations&&void 0},events:{render:function(e,t){var o=$("[id=qtip-superToolTip]")[0];$(o).attr("role","tooltip"),$(o).find(".qtip-content").removeAttr("aria-atomic"),$(o).find(".qtip-title").removeAttr("aria-atomic"),$(o).find(".qtip-titlebar").removeAttr("aria-atomic"),$(document.body).on("keydown.superToolTipEsc",function(e){e.keyCode===l.ui.KeyCodes.esc&&(e.stopPropagation(),l.log.stopPropagation&&l.log.stopPropagation("Escape handler for superToolTipEsc"),e.preventDefault(),t.hide())})},focus:function(e,t){e.preventDefault()},hide:function(e,t){l.superTooltip.destroySuperTooltip()}}}).qtip("api"),u._closeSuperTooltipInterval=window.setInterval(l.superTooltip.checkSuperTooltipClose,500)}catch(e){l.telemetry.addErrorEvent({errorLabel:"Supertooltip",callStack:e.stack,type:3}),t&&l.superTooltip.restoreElementAttributes(t)}}}else null!==t.getAttribute("title")&&t.removeAttribute("title")}},u.checkSuperTooltipClose=function(){var e=l.superTooltip._superToolTipControl;$.contains(document.body,e)||(l.superTooltip.clearPreviewCloseInterval(),l.superTooltip.destroySuperTooltip())},u.clearPreviewCloseInterval=function(){-1!==u._closeSuperTooltipInterval&&(window.clearInterval(u._closeSuperTooltipInterval),u._closeSuperTooltipInterval=-1)}}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(v){!function(e){var o,t;(t=o=e.TopLevelNavNodes||(e.TopLevelNavNodes={}))[t.favorites=0]="favorites",t[t.recents=1]="recents",t[t.workspaces=2]="workspaces",t[t.modules=3]="modules";var n=(i.prototype.reset=function(){var e=this;this._modules={},this._itemsById={},this._favoritesLoaded=!1,this._recentsLoaded=!1,this._recents=[],this._modulesLoaded=!1,this._workspacesLoaded=!1,this._activeModuleMenuItem=null,v.deferred.onTrue(function(){return v.value(v.shell.clientInitialFormRequested)}).done(function(){e._loadModules(),e._loadWorkspaces(),e.getRecents(),e._modulesLoaded=!0,e._workspacesLoaded=!0})},i.prototype._requestMenuStructure=function(e,t,o){v.logWarning("_requestMenuStructure must be implemented.")},i.prototype.requestMenuForPath=function(e,t){e[0]===this.mainMenuName?this._loadLinks(e[1],t):this._loadWorkspaces(t)},i.prototype.whatsNewClose=function(){this.hideWhatsNew=!0,v.whatsNew.closeWhatsNew(v.whatsNew.keyIds.navigationKey)},i.prototype.addSubscription=function(e){this._subscriptions.push(e)},i.prototype.removeSubscription=function(e){var t=this._subscriptions.indexOf(e);0<=t&&this._subscriptions.splice(t,1)},i.prototype.menuExpandCollapseAll=function(e,t){this._updateNavigationStateAll(e,t),this._raise()},i.prototype.changeActiveModule=function(e,t){e!==this._activeModuleMenuItem&&(null==e&&(this._lastActiveModuleMenuItem=this._activeModuleMenuItem),e&&!this._modules[e]&&(e=null),e&&!this._modules[e].children?(this._activeModuleMenuItem=null,this._modules[e].children=[],this._loadLinks(e,t)):(this._activeModuleMenuItem=e,v.applyFunction(t),this._raise()))},i.prototype.getActiveLinks=function(){return this._activeModuleMenuItem?this._modules[this._activeModuleMenuItem].children:[]},i.prototype.getActiveModuleLabel=function(){for(var e in this._modules)if(this._modules[e].menuItem===this._activeModuleMenuItem)return this._modules[e].label;return""},i.prototype.isActiveModule=function(e){var t=!1;return e===this._activeModuleMenuItem?t=!0:e===this._lastActiveModuleMenuItem&&(t=!(this._lastActiveModuleMenuItem=null)),t},i.prototype.getModules=function(){return this._modulesLoaded||(this._loadModules(),this._modulesLoaded=!0),this._modules},i.prototype.getItemById=function(e){return this._itemsById[e]||{}},i.prototype.getLoadingState=function(){return this._loading},i.prototype.getNodeLoadingState=function(e){var t;switch(e){case o.favorites:t=this._favoritesLoading;break;case o.recents:t=this._recentsLoading;break;case o.workspaces:t=this._workspacesLoading;break;case o.modules:t=this._modulesLoading;break;default:t=!0}return t},i.prototype.getRecents=function(){return this._recentsLoaded||(this._loadUserMenuItems("RetrieveRecentlyUsedMenuItems",{recent:!0}),this._recentsLoaded=!0),this._recents.slice(0,this.maxRecents)},i.prototype.getFavorites=function(){this._favoritesLoaded||(this._loadUserMenuItems("RetrieveFavoriteMenuItems",{favorite:!0}),this._favoritesLoaded=!0);var e=[];for(var t in this._itemsById)this._itemsById[t].favorite&&e.push(this._itemsById[t]);return e.sort(this.compareLabel),this.hasFavorites=0<e.length,e},i.prototype.getWorkspaces=function(e){this._workspacesLoaded||(this._loadWorkspaces(),this._workspacesLoaded=!0);var t=[];for(var o in this._itemsById)this._itemsById[o].workspace&&t.push(this._itemsById[o]);return e||t.sort(this.compareLabel),t},i.prototype.setExpanded=function(e,t){this._itemsById[e].expanded=t,this._sendPersonalizationState(this._itemsById[e].aotPath,"expanded",t),this._raise()},i.prototype.setFavorite=function(e,t){var o=this._itemsById[e];o.favorite=t;var n=this.getNavigationPath(o.id),i=t?"AddFavoriteMenuItem":"RemoveFavoriteMenuItem";this._requestMenuStructure(i,function(){},{menuItem:"".concat(o.id,"#").concat(n)}),this._raise()},i.prototype.addRecentlyUsedItem=function(e){this._itemsById[e].recent?(this._recents.splice(this._recents.indexOf(this._itemsById[e]),1),this._recents.unshift(this._itemsById[e])):(this._itemsById[e].recent=!0,-1===this._recents.indexOf(this._itemsById[e])&&(this._recents.unshift(this._itemsById[e]),this.removeExcessModuleRecents(this._itemsById[e].module))),this._raise()},i.prototype.updateFormCrumbs=function(e){if(!v.restrictedNavigation&&this._recents[0]){if(e===this._recents[0].formName){var t=this.getNavigationPath(this._recents[0].id);v.ui.getNavBar()&&v.ui.getNavBar().Crumbs(t)}this._pendingFormCrumb=null}else this._pendingFormCrumb=e},i.prototype.getNavigationPath=function(e){var t,o,n=this.getItemById(e);if(n.crumb){var i=JSON.stringify(n.crumb);return t=JSON.parse(i)}for(t=[n.label],o=n.parent;o;)t.unshift(o.label),o=o.parent;return t},i.prototype.startNavigation=function(e){v.ui.getNavBar().clearCrumb(),e.MenuItemType&&e.MenuItemName?e.menuItem="".concat(e.MenuItemType,":").concat(e.MenuItemName):e.menuItem=e.MenuItemName,e.navigationItemId||(e.NavigationPath[0]=e.NavigationPath[0].toLowerCase(),e.NavigationPath[0]===this.navPaneMenuName&&e.NavigationPath.splice(1,1),e.navigationItemId="".concat(e.MenuItemName,"#").concat(e.MenuItemType,'#["').concat(e.NavigationPath.join('","'),'"]')),e.elementCreated=v.serverForm.getForm,e.updateQuery=!0,v.telemetry.addNavigationEvent(e.navigationFeatureName,e.menuItem,e.NavigationPath),this.navigate(e)},i.prototype.saveMenuPaneSettings=function(e){this._requestMenuStructure("StoreMenuPaneSettings",function(){},{state:"pinState#".concat(e)})},i.prototype.getMenuPaneSettings=function(t){var e=this;v.async(function(){e._requestMenuStructure("GetMenuPaneSettings",function(e){t(e)})})},i.prototype._raise=function(){var t,e;try{for(var o=__values(this._subscriptions),n=o.next();!n.done;n=o.next())(0,n.value)()}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},i.prototype._raiseDeferred=function(){var e=this;this._pendingRaise||(this._pendingRaise=!0,v.async(function(){e._pendingRaise=!1,e._raise()}))},i.prototype._getModuleFromPath=function(e){var t="";if(e){var o=JSON.parse(e);t=o.slice(0,1)===this.mainMenuName?o.slice(1,2)[0]:"workspace"}return t},i.prototype._loadModules=function(){var u=this;v.async(function(){u._modulesLoading=!0,u._requestMenuStructure("RetrieveNavigationPaneTopLevelSitemapMenu",function(e){var t,o,n,i={};if(e&&(n=$.isPlainObject(e)?e:JSON.parse(e))){var r=n.GetDataContract;try{for(var a=__values(r),s=a.next();!s.done;s=a.next()){var l=s.value;i[l.getMenuItemName]={label:l.getTitleStr,menuItem:l.getMenuItemName,id:l.getName||l.getMenuItemName}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(t)throw t.error}}}u._modules=i,u._modulesLoading=!1,u._raiseDeferred()})})},i.prototype._loadUserMenuItems=function(e,d){var c=this;v.async(function(){d.recent&&(c._recentsLoading=!0),d.favorite&&(c._favoritesLoading=!0),c._requestMenuStructure(e,function(e){var t,o,n;if(e&&(n=$.isPlainObject(e)?e:JSON.parse(e))&&n.GetDataContract){try{for(var i=__values(n.GetDataContract),r=i.next();!r.done;r=i.next()){var a=r.value,s="".concat(a.getMenuItemName,"#").concat(a.getMenuItemType,"#").concat(a.getNavigationPath),l=null;a.getCrumbPath&&(l=a.getCrumbPath.split(","));var u=c._getModuleFromPath(a.getNavigationPath);c._itemsById[s]||(c._itemsById[s]={label:a.getTitleStr,menuItem:a.getMenuItemName,menuItemType:a.getMenuItemType,formName:a.getFormName,crumb:l,id:s,module:u}),c._assign(c._itemsById[s],d),d.recent&&c._recents.push(c._itemsById[s])}}catch(e){t={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}d.recent&&c._recents&&c._pendingFormCrumb&&c.updateFormCrumbs(c._pendingFormCrumb),d.recent&&(c._recentsLoading=!1),d.favorite&&(c._favoritesLoading=!1),c._raiseDeferred()}})})},i.prototype._loadWorkspaces=function(h){var m=this;v.async(function(){m._workspacesLoading=!0,m._requestMenuStructure("RetrieveNavigationPaneMenu",function(e){var t,o,n,i,r;if(e)if((r=$.isPlainObject(e)?e:JSON.parse(e))&&r.GetDataContract){try{for(var a=__values(r.GetDataContract),s=a.next();!s.done;s=a.next()){var l=s.value;try{for(var u=(n=void 0,__values(l.GetDataContract)),d=u.next();!d.done;d=u.next()){var c=d.value,p="".concat(c.getMenuItemName,"#").concat(c.getMenuItemType,'#["').concat(m.navPaneMenuName,'","').concat(c.getMenuItemName,'"]');m._itemsById[p]={formName:c.getFormName,id:p,image:c.getImageStr,imageType:c.getImageLocationStr,label:c.getTitleStr,menuItem:c.getMenuItemName,menuItemType:c.getMenuItemType,workspace:!0}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(t)throw t.error}}m._workspacesLoading=!1,v.applyFunction(h),m._raiseDeferred()}else m._workspacesLoading=!1})})},i.prototype._loadLinks=function(o,n){var f=this;o in this._modules&&(this._loading=!0,v.async(function(){f._requestMenuStructure("RetrieveSitemapMenu",function(e){var t;if(e){if(!(t=$.isPlainObject(e)?e:JSON.parse(e)))return;var y=function(e,t,o,n,i){var r,a,s=[];try{for(var l=__values(e),u=l.next();!u.done;u=l.next()){var d=u.value,c=d.getMenuItemName||d.getName,p=i.slice(),h=n.slice();h.push(c),p.push(c);var m=JSON.stringify(h),v="".concat(d.getMenuItemName,"#").concat(d.getMenuItemType,"#").concat(m),g=f._itemsById[v]||{};g.id=v,g.aotPath=p.toString().replace(/,/g,"\\"),g.label=d.getTitleStr,g.tile=d.getTileName,g.image=d.getImageStr,g.imageType=d.getImageLocationStr,g.menuItem=d.getMenuItemName,g.menuItemType=d.getMenuItemType,g.formName=d.getFormName,g.parent=t,g.expanded=!!d.getExpandState,g.module=f._getModuleFromPath(m),!d.getHasAnyNavPanePersonalizationsBoolean&&0!=d.getHasAnyNavPanePersonalizationsBoolean||(f.hasAnyPersonalizations=d.getHasAnyNavPanePersonalizationsBoolean),d.GetDataContract&&(g.children=y(d.GetDataContract,g,o+1,h,p),f.hasAnyPersonalizations?"TRUE"===d.getExpandState.toUpperCase()?g.expanded=!0:"FALSE"===d.getExpandState.toUpperCase()&&(g.expanded=!1):0===o&&"Workspaces"===d.getName&&(g.expanded=!0)),f._itemsById[g.id]=g,s.push(g)}}catch(e){r={error:e}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(r)throw r.error}}return s};f._modules&&f._modules[o]&&(f._modules[o].children=y(t.GetDataContract,f._modules[o],0,[f.mainMenuName,o],[o]),f._activeModuleMenuItem=o),f._loading=!1,v.applyFunction(n),f._raise()}},{menuItem:o})}))},i.prototype._assign=function(e,t){for(var o in t)e[o]=t[o]},i.prototype._updateNavigationStateAll=function(e,t){var o,n;try{for(var i=__values(e),r=i.next();!r.done;r=i.next()){var a=r.value;a.menuItemType||(a.expanded=t,this._sendPersonalizationState(a.aotPath,"expanded",a.expanded)),a.children&&a.children.length&&this._updateNavigationStateAll(a.children,t)}}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}},i.prototype._sendPersonalizationState=function(e,t,o){var n=this;v.async(function(){v.callFunction(v.user().SetCustomObjectPersonalization,void 0,[n.navPanePersonalizationName,e,t,o])},void 0,"Update Menu Expand State")},i.prototype.removeExcessModuleRecents=function(t){var e=this,o=0,n="",i=this._recents.filter(function(e){return e.module===t});if(i.length>this.maxRecents){for(i=i.slice(this.maxRecents);o<i.length;)n=i[o].id,this._itemsById[n].recent=!1,o+=1;window.setTimeout(function(){for(o=0;o<i.length;)n=i[o].id,e._requestMenuStructure("RemoveRecentMenuItem",function(){},{menuItem:n}),o+=1})}},i.prototype.compareLabel=function(e,t){return e.label.localeCompare(t.label,Globalize.culture().name)},i.prototype.navigate=function(e){v.shell.navigateToForm(e)},i);function i(){this._collapsedMenus=[],this.maxRecents=10,this.hasAnyPersonalizations=!1,this._activeModuleMenuItem=null,this.hideWhatsNew=!1,this._lastActiveModuleMenuItem=null,this.mainMenuName="mainmenu",this.AOTMainMenuName="\\Menus",this.navPaneMenuName="navpanemenu",this.navPanePersonalizationName="navpane",this._subscriptions=[],this._modules={},this._itemsById={},this._favoritesLoaded=!1,this._favoritesLoading=!0,this.hasFavorites=null,this._recentsLoaded=!1,this._recentsLoading=!0,this._recents=[],this._modulesLoaded=!1,this._workspacesLoaded=!1,this._workspacesLoading=!0,this._loading=!1,this._pendingRaise=!1,this._pendingFormCrumb=null,this._modulesLoading=!0}e.ModuleStore=new n}(v.DynReact||(v.DynReact={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(o){var e,n,t;function i(){var t=null!==n&&n.apply(this,arguments)||this;return t.Shortcuts=o.extendPrototype(o.ui.Control.prototype.Shortcuts,{CollapseHeading:{Description:o.label("Group_Collapse"),Handler:function(e){t.props.Expanded&&t.onClick&&t.onClick(e)},Keys:{keyCode:o.ui.KeyCodes.leftArrow},ShowToUser:function(){return t.props.Expanded}},ExpandHeading:{Description:o.label("Group_Expand"),Handler:function(e){t.props.Expanded||t.onClick&&t.onClick(e)},Keys:{keyCode:o.ui.KeyCodes.rightArrow},ShowToUser:function(){return!t.props.Expanded}},ToggleHeading:{Description:function(){return t.props.Expanded?o.label("Group_Collapse"):o.label("Group_Expand")},Handler:function(e){t.onClick&&t.onClick(e)},Keys:{keyCode:o.ui.KeyCodes.enter}}}),t.keyHandler=function(e){o.util.handleShortcuts(t,e.nativeEvent)},t}e=o.DynReact||(o.DynReact={}),n=React.PureComponent,__extends(i,n),i.prototype.onmouseenter=function(e){o.superTooltip.tryOpenSuperTooltip(e.target)},t=i,e.GroupHeading=t}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(o){var n,e,t;function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.Shortcuts=o.extendPrototype(o.ui.Control.prototype.Shortcuts,{Activate:{Category:o.ui.ShortcutCategory.Navigate,Description:o.label("NavigationPane_NavigateItem"),Handler:function(){t.navigate()},Keys:{keyCode:[o.ui.KeyCodes.enter,o.ui.KeyCodes.spacebar]}},ToggleFavorite:{Description:function(){return t.props.Favorite?o.label("NavigationPane_RemoveFromFavorites"):o.label("NavigationPane_AddToFavorites")},Handler:function(){n.ModuleStore.setFavorite(t.props.Id,!t.props.Favorite)},Keys:{shift:!0,keyCode:o.ui.KeyCodes.letterF}}}),t.handleClick=function(){t.navigate()},t.clickFavorite=function(e){e.stopPropagation(),o.log.stopPropagation&&o.log.stopPropagation("NavigationPane: stopPropagation when clicking the favorites icon."),n.ModuleStore.setFavorite(t.props.Id,!t.props.Favorite)},t.keyHandler=function(e){o.util.handleShortcuts(t,e.nativeEvent)},t}n=o.DynReact||(o.DynReact={}),e=React.PureComponent,__extends(i,e),i.prototype.navigate=function(e){if(o.applyFunction(this.props.BeforeNavigate),e&&e.navigationOverride)o.applyFunction(e.navigationOverride);else{var t={MenuItemName:this.props.MenuItemName,MenuItemType:this.props.MenuItemType,name:this.props.FormName,navigationFeatureName:this.props.FeatureName,navigationItemId:this.props.Id,NavigationPath:JSON.parse(this.props.Id.split("#")[2])};n.ModuleStore.startNavigation(t)}},i.prototype.favoriteText=function(){return this.props.Favorite?o.label("NavigationPane_RemoveFromFavorites"):o.label("NavigationPane_AddToFavorites")},i.prototype.getCrumbElement=function(e){var t,o,n=this.getCrumbLabels(),i=[],r="modulesFlyout-crumb";e&&n.shift();try{for(var a=__values(n),s=a.next();!s.done;s=a.next()){var l=s.value;i.push(React.createElement("span",{className:r},l)),r+=" modulesFlyout-crumbDivider"}}catch(e){t={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(t)throw t.error}}return React.createElement("div",null,i)},i.prototype.getCrumbText=function(){var e=this.getCrumbLabels();return o.shell.joinArrayWithChevron(e)},i.prototype.onmouseenter=function(e){o.superTooltip.tryOpenSuperTooltip(e.target)},i.prototype.getCrumbLabels=function(){var e=n.ModuleStore.getNavigationPath(this.props.Id);return 1<e.length?e.pop():e[0]=o.label("NavigationPane_Workspaces"),e},t=i,n.Navigation=t}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(o){var e,n,i,t;function r(){var t=null!==i&&i.apply(this,arguments)||this;return t.linkKeyDown=function(e){o.util.isShortcutKeyPressed(e.nativeEvent,{keyCode:[o.ui.KeyCodes.enter,o.ui.KeyCodes.spacebar]})?t._setSelectedGutterItem(e.nativeEvent):t.keyHandler(e)},t.onClick=function(e){e&&e.target&&"click"===e.type&&t._setSelectedGutterItem(e.nativeEvent)},t}e=o.DynReact||(o.DynReact={}),n=e.UI||(e.UI={}),i=e.Navigation,__extends(r,i),r.prototype.componentDidMount=function(){this.element.dynContext={current:this}},r.prototype.componentDidUpdate=function(){this.element.dynContext={current:this}},r.prototype.render=function(){var t=this,e=n.GutterUtil.buildImageLink({Image:this.props.Image,ImageType:this.props.ImageType,Label:this.props.Label});return React.createElement("div",{"aria-label":this.props.Label,"aria-level":1,"aria-posinset":this.props.Posinset,"aria-setsize":this.props.Setsize,className:"gutterPane-link","data-dyn-selected":this.props.Selected,"data-dyn-title":this.props.Label,id:this.props.Id,onClick:this.onClick,onKeyDown:this.linkKeyDown,onMouseEnter:this.onmouseenter,ref:function(e){return t.element=e},role:"treeitem",tabIndex:0},React.createElement("span",{className:"gutterPane-linkSelected"}),e,React.createElement("a",{className:"gutterPane-linkText","data-dyn-title":this.props.Label,onMouseEnter:this.onmouseenter},this.props.Label))},r.prototype._setSelectedGutterItem=function(e){var t=e.target;"gutterPane-link"===t.className?this.props.SetSelectedPaneItem(Array.prototype.indexOf.call(t.parentElement.children,e.target)+1):this.props.SetSelectedPaneItem(Array.prototype.indexOf.call(t.parentElement.parentElement.children,t.parentElement)+1),this.navigate({navigationOverride:this.props.TargetMethod})},t=r,n.GutterPaneLink=t}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(e){var t,o,n,i;function r(){return null!==n&&n.apply(this,arguments)||this}t=e.DynReact||(e.DynReact={}),o=t.UI||(t.UI={}),n=t.Navigation,__extends(r,n),r.prototype.render=function(){var e,t="modulesFlyout-link";return t+=this.props.Last&&!this.props.isSummary?" modulesFlyout-last":"",t+=1<this.props.Level&&!this.props.isSummary?" modulesFlyout-indent":"",t+=this.props.Favorite?" modulesFlyout-isFavorite":"",t+=this.props.isSummary?" modulesFlyout-linkDivider":"",this.props.isSummary&&(e=this.getCrumbElement(!0)),React.createElement("div",{"aria-label":this.props.Label,className:t,"data-dyn-selected":this.props.Selected,onClick:this.handleClick,onKeyDownCapture:this.keyHandler,role:"link",tabIndex:0},React.createElement("a",{className:"modulesFlyout-linkText","data-dyn-title":this.props.Label,"aria-hidden":!0,onMouseEnter:this.onmouseenter},this.props.Label),React.createElement("a",{className:"modulesFlyout-favoriteIcon","aria-hidden":!0,"data-dyn-title":this.favoriteText(),onMouseEnter:this.onmouseenter,onClick:this.clickFavorite}),e)},i=r,o.ModuleLink=i}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(e){var o,t,n,i;function r(){var t=null!==n&&n.apply(this,arguments)||this;return t.onClick=function(e){o.ModuleStore.setExpanded(t.props.Id,!t.props.Expanded),e&&e.target&&"click"===e.type&&t.props.SetSelectedFlyoutItem(Array.prototype.indexOf.call(e.target.parentElement.children,e.target))},t}o=e.DynReact||(e.DynReact={}),t=o.UI||(o.UI={}),n=e.DynReact.GroupHeading,__extends(r,n),r.prototype.render=function(){var e="modulesFlyout-LinkGroup"+(0<this.props.Level?" modulesFlyout-indent":"");return e=this.props.Last?e+" modulesFlyout-last":e,e=this.props.Expanded?e+" modulesFlyout-isExpanded ChevronDown-symbol":e+" ChevronRight-symbol",React.createElement("a",{"aria-expanded":this.props.Expanded,"aria-label":this.props.Label,"aria-level":this.props.Level+1,className:e,"data-dyn-expanded":this.props.Expanded,"data-dyn-selected":this.props.Selected,"data-dyn-title":this.props.Label,id:this.props.Id,onClick:this.onClick,onKeyDown:this.keyHandler,onMouseEnter:this.onmouseenter,role:"treeitem",tabIndex:0},this.props.Label)},i=r,t.ModuleLinkGroup=i}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(e){var t,o,n,i;function r(){return null!==n&&n.apply(this,arguments)||this}t=e.DynReact||(e.DynReact={}),o=t.UI||(t.UI={}),n=t.Navigation,__extends(r,n),r.prototype.componentDidMount=function(){this.element.dynContext={current:this}},r.prototype.componentDidUpdate=function(){this.element.dynContext={current:this}},r.prototype.render=function(){var t=this,e="modulesPane-link";return this.props.Favorite&&(e+=" modulesFlyout-isFavorite"),React.createElement("div",{"aria-posinset":this.props.Posinset,"aria-setsize":this.props.Setsize,"aria-level":2,className:e,"data-dyn-selected":this.props.Selected,onClick:this.handleClick,onKeyDown:this.keyHandler,ref:function(e){return t.element=e},role:"treeitem",tabIndex:0},React.createElement("a",{className:"modulesPane-linkText","data-dyn-title":this.props.Label,onMouseEnter:this.onmouseenter,role:"link"},this.props.Label),React.createElement("a",{"aria-hidden":!0,className:"modulesFlyout-favoriteIcon","data-dyn-title":this.favoriteText(),onClick:this.clickFavorite,onMouseEnter:this.onmouseenter}))},i=r,o.ModulePaneLink=i}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(t){var n,e,i,o;function r(){var o=null!==i&&i.apply(this,arguments)||this;return o.Shortcuts=t.extendPrototype(t.ui.Control.prototype.Shortcuts,{Activate:{Handler:function(){o.onClick()},Keys:{keyCode:[t.ui.KeyCodes.enter,t.ui.KeyCodes.spacebar]},ShowToUser:!1}}),o.onClick=function(e){if(e&&e.target&&"click"===e.type){var t=Array.prototype.indexOf.call(e.target.parentElement.children,e.target);o.props.SetSelectedPaneItem(t)}o.props.isActive&&o.props.PaneIsExpanded?o.props.isActive&&o.props.PaneIsExpanded?o.props.ExpandPane():n.ModuleStore.changeActiveModule(null):(n.ModuleStore.changeActiveModule(o.props.MenuItemName),o.props.ExpandPane())},o.keyHandler=function(e){t.util.handleShortcuts(o,e.nativeEvent)},o}n=t.DynReact||(t.DynReact={}),e=n.UI||(n.UI={}),i=React.Component,__extends(r,i),r.prototype.componentDidMount=function(){this.element.dynContext={current:this},this.props.isPhoneDevice||this.props.isSingleColumnMode||!this.props.isActive||(n.ModuleStore.changeActiveModule(this.props.MenuItemName),this.props.ExpandPane())},r.prototype.componentDidUpdate=function(){this.element.dynContext={current:this}},r.prototype.render=function(){var t=this,e="modulesPane-module";return e=this.props.isActive?e+=" modulesPane-isActive":e,React.createElement("a",{"aria-posinset":this.props.Posinset,"aria-selected":this.props.Selected,"aria-setsize":this.props.Setsize,"aria-level":2,className:e,"data-dyn-selected":this.props.Selected,"data-dyn-title":this.props.Label,onClick:this.onClick,onKeyDown:this.keyHandler,onMouseEnter:this.onmouseenter,ref:function(e){return t.element=e},role:"treeitem",tabIndex:0},this.props.Label)},r.prototype.onmouseenter=function(e){t.superTooltip.tryOpenSuperTooltip(e.target)},o=r,e.ModulePaneModule=o}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(y){var f;(function(g){Globalize.addCultureInfo("en",{messages:{NavBar_HideNavigationPane:"Hide navigation pane",NavBar_ShowNavigationPane:"Show navigation pane",NavBar_ShowNavigationPaneHelpText:"(Alt+F1)",NavigationPane_AddToFavorites:"Add to Favorites",NavigationPane_AppLinks:"App links",NavigationPane_Back:"Back",NavigationPane_CloseModule:"Close module pane",NavigationPane_CollapseAllToolTip:"Collapse all",NavigationPane_CollapseToolTip:"Collapse the navigation pane",NavigationPane_Company:"Company",NavigationPane_Dashboard:"Dashboard",NavigationPane_EmptyFavorites:"Favorites created using the navigation pane will show up here.",NavigationPane_EmptyRecents:"A list of recently visited pages will display here after you have visited a few pages.",NavigationPane_ExpandAllToolTip:"Expand all",NavigationPane_ExpandToolTip:"Expand the navigation pane",NavigationPane_Favorites:"Favorites",NavigationPane_Gotit:"Got It!",NavigationPane_Home:"Home",NavigationPane_Landmark:"Navigation Menu",NavigationPane_Loading:"Loading content",NavigationPane_Modules:"Modules",NavigationPane_MoveFirst:"Move to the first item",NavigationPane_MoveLast:"Move to the last item",NavigationPane_MoveNext:"Move to the next item",NavigationPane_MovePrev:"Move to the previous item",NavigationPane_NavigateItem:"Navigate to the selected item",NavigationPane_NoItemsFound:"No items found.",NavigationPane_NoSummaryData:"After visiting some pages, more links will appear here.",NavigationPane_OpenForms:"Open forms",NavigationPane_PinToolTip:"Pin navigation pane open",NavigationPane_Recent:"Recent",NavigationPane_RemoveFromFavorites:"Remove from Favorites",NavigationPane_ShowAll:"Show all",NavigationPane_ShowSummary:"Show summary",NavigationPane_Sitemap:"Sitemap",NavigationPane_WhatsNew:"You can expand only the menus you need, and do not worry, your menus will remain just as you left them. To see all of your menu options, click Expand all. ",NavigationPane_WhatsNewToolTip:"Check out our menus!",NavigationPane_Workspaces:"Workspaces"}}),(g.GutterUtil||(g.GutterUtil={})).buildImageLink=function(e){var t;switch(e.ImageType){case y.ui.ImageType.symbol:var o=e.Image+"-symbol";o.match(/\s+/g)&&(o="imageBinder-emptyImage");var n="workspace-image "+o;t=React.createElement("span",{className:n,"data-dyn-title":e.Label,"data-dyn-image-type":"Symbol"});break;case y.ui.ImageType.url:case y.ui.ImageType._axResource:t=React.createElement("span",{className:"workspace-image","data-dyn-title":e.Label,"data-dyn-image-type":"Image"},React.createElement("img",{className:"imageBinder-image",src:e.Image}));break;case y.ui.ImageType.base64:var i="data:image/png;base64,"+e.Image;t=React.createElement("span",{className:"workspace-image","data-dyn-title":e.Label,"data-dyn-image-type":"Image"},React.createElement("img",{className:"imageBinder-image",src:i}))}return t};var s,e=(s=React.Component,__extends(t,s),t.prototype.componentDidMount=function(){f.ModuleStore.addSubscription(this.storeChanged),this._navigationCompleteEventSubscriberID=y.shell.subscribeToNavigationCompleteEvent(this.onNavigating),this.element.dynContext={current:this}},t.prototype.componentDidUpdate=function(e){var t=this;this._hostElement||(this._hostElement=document.body.querySelector(".modulesPane")),this.element.dynContext={current:this},window.setTimeout(function(){t.props.paneIsExpanded?f.ModuleStore.getActiveModuleLabel()?(t._selectedElement=t._hostElement.querySelector(".modulesFlyout [data-dyn-selected=true]"),t._selectedElement&&t._selectedElement.focus(),y.log.focus&&y.log.focus("Focus: NavigationPane focused a flyout element.")):(t._selectedElement=t._hostElement.querySelector(".modulesList [data-dyn-selected=true]"),t._selectedElement&&t._selectedElement.focus(),y.log.focus&&y.log.focus("Focus: NavigationPane focused a module pane element.")):e.paneIsExpanded&&(y.log.focus&&y.log.focus("Focus: Focus NavPane opener after going from open to closed."),t.paneOpener&&t.paneOpener.focus(),f.ModuleStore.whatsNewClose())})},t.prototype.componentWillUnmount=function(){f.ModuleStore.removeSubscription(this.storeChanged),y.shell.unsubscribeToNavigationCompleteEvent(this._navigationCompleteEventSubscriberID)},t.prototype.render=function(){var e,t,o,n,i,r,a,s=this;this.currentItem=0,this.props.paneIsExpanded&&!this._listenersAreRegistered&&this.registerListeners(),!this.props.paneIsExpanded&&this._listenersAreRegistered&&this.removeListeners();var l=this.props.PaneIsPinned?y.label("NavigationPane_CollapseToolTip"):y.label("NavigationPane_ExpandToolTip"),u=y.shell.CurrentShellViewPortWidthSize<=y.shell.NavBarSizes.smallNavBarSize?null:React.createElement("div",{"aria-expanded":this.props.paneIsExpanded,"aria-label":l,className:"modulesPane-opener","data-dyn-expanded":this.props.paneIsExpanded,"data-dyn-helptext":y.label("NavBar_ShowNavigationPaneHelpText"),"data-dyn-title":l,id:"modulesPaneOpener",onClick:this.togglePane,onKeyDown:this.paneOpenerKeyDown,onMouseEnter:this.onmouseenter,ref:function(e){return s.paneOpener=e},role:"button",tabIndex:0});if(this.props.navigationModeIsWorkspace){var d="gutterList";this.props.paneIsExpanded&&(d+=" showFullGutter"),o=React.createElement("div",{className:d,role:"navigation","aria-label":y.label("NavigationPane_Landmark"),tabIndex:-1},u,React.createElement("div",{className:"gutterWorkspaces",role:"tree",tabIndex:-1,"aria-label":y.label("NavigationPane_Workspaces")},this.renderGutterItems(null===(e=this.state.workspaces)||void 0===e?void 0:e.filter(function(e){return"Action"!==e.menuItemType}),"Workspaces"),this.renderGutterItems(null===(t=this.state.workspaces)||void 0===t?void 0:t.filter(function(e){return"Action"===e.menuItemType}),"ActionWorkspaces")),";")}else{var c="",p="",h=void 0,m=void 0,v="modulesList";(this.props.paneIsExpanded||this.props.PaneIsPinned)&&(c="modulesPane-pin "+(this.props.PaneIsPinned?"Unpin-symbol":"Pin-symbol"),p=this.props.PaneIsPinned?y.label("NavigationPane_CollapseToolTip"):y.label("NavigationPane_PinToolTip"),h=React.createElement("button",{className:"modulesList-closeButton Cancel-symbol",type:"button",onClick:this.collapsePane,title:y.label("NavBar_Close")}),a="modulesPane-flyout slideInL",v+=" modulesExpanded",m=React.createElement("button",{"aria-label":p,className:c,type:"button",onClick:this.props.ToggleIsPinned,onMouseEnter:this.onmouseenter,title:p})),this.isSingleColumnMode()&&(a+=" modulesPane-isSingleColumn"),r=React.createElement("div",{className:v,role:"tree",tabIndex:-1,onKeyDown:this.keyHandler},React.createElement(g.GutterPaneLink,{Id:"home",Image:"Home",ImageType:y.ui.ImageType.symbol,key:"home",Label:y.label("NavigationPane_Home"),Selected:this.currentItem===this.state.selectedPaneItem,SetSelectedPaneItem:this.setSelectedPaneItem,TargetMethod:y.ui.getNavBar().navigateToDashboard}),this.renderItems([],!1,!0,"",""),React.createElement(g.ModulesPaneGroup,{Expanded:this.state.favoritesAreExpanded,ExpandedGutter:this.props.paneIsExpanded||this.props.PaneIsPinned,Id:"navPaneFavoritesID",Image:"StarEmpty",ImageType:y.ui.ImageType.symbol,Label:y.label("NavigationPane_Favorites"),OnHeaderClick:this.onFavoritesClicked,Selected:this.currentItem===this.state.selectedPaneItem,SetSelectedPaneItem:this.setSelectedPaneItem}),this.renderItems(this.state.favorites,this.state.favoritesAreExpanded,f.ModuleStore.getNodeLoadingState(y.DynReact.TopLevelNavNodes.favorites),"NavigationPane_EmptyFavorites","favorites"),React.createElement(g.ModulesPaneGroup,{Expanded:this.state.recentsAreExpanded,ExpandedGutter:this.props.paneIsExpanded||this.props.PaneIsPinned,Id:"navPaneRecentsID",Image:"Recent",ImageType:y.ui.ImageType.symbol,Label:y.label("NavigationPane_Recent"),OnHeaderClick:this.onRecentsClicked,Selected:this.currentItem===this.state.selectedPaneItem,SetSelectedPaneItem:this.setSelectedPaneItem}),this.renderItems(this.state.recents,this.state.recentsAreExpanded,f.ModuleStore.getNodeLoadingState(y.DynReact.TopLevelNavNodes.recents),"NavigationPane_EmptyRecents","recent"),React.createElement(g.ModulesPaneGroup,{Expanded:this.state.workspacesAreExpanded,ExpandedGutter:this.props.paneIsExpanded||this.props.PaneIsPinned,Id:"navPaneWorkSpaceGroupID",Image:"GenericApp",ImageType:y.ui.ImageType.symbol,Label:y.label("NavigationPane_Workspaces"),OnHeaderClick:this.onWorkspacesClicked,Selected:this.currentItem===this.state.selectedPaneItem,SetSelectedPaneItem:this.setSelectedPaneItem}),this.renderItems(this.state.workspaces,this.state.workspacesAreExpanded,f.ModuleStore.getNodeLoadingState(y.DynReact.TopLevelNavNodes.workspaces),"NavigationPane_NoItemsFound","allworkspaces"),React.createElement(g.ModulesPaneGroup,{Expanded:this.state.modulesAreExpanded,ExpandedGutter:this.props.paneIsExpanded||this.props.PaneIsPinned,Id:"navPaneModuleID",Image:"GroupedList",ImageType:y.ui.ImageType.symbol,Label:y.label("NavigationPane_Modules"),OnHeaderClick:this.onModulesClicked,Selected:this.currentItem===this.state.selectedPaneItem,SetSelectedPaneItem:this.setSelectedPaneItem}),this.renderItems(this.state.modules,this.state.modulesAreExpanded,f.ModuleStore.getNodeLoadingState(y.DynReact.TopLevelNavNodes.modules),"NavigationPane_NoItemsFound")),d="gutterList",this.props.paneIsExpanded&&(d+=" showFullGutter"),o=React.createElement("div",{className:d,role:"navigation","aria-label":y.label("NavigationPane_Landmark")},u,r,this.props.ViewportSize===y.shell.ViewportSize.Small?h:m)}return n=this.props.navigationModeIsWorkspace?React.createElement("div",{className:"modulesPane-gutter"},u):o,this.props.paneIsExpanded&&(i=React.createElement("div",{className:a},React.createElement(g.ModulesFlyout,{BeforeNavigate:this.collapsePane,CloseFlyout:this.closeFlyout,IsPaneSingleColumn:this.isSingleColumnMode(),ReportFlyoutItemCount:this.setFlyoutItemCount,SelectedFlyoutItem:this.state.selectedFlyoutItem,SetSelectedFlyoutItem:this.setSelectedFlyoutItem}))),(this.props.paneIsExpanded||this.props.PaneIsPinned||this.props.navigationModeIsWorkspace)&&(this.lastItem=this.currentItem-1),this.props.navigationModeIsWorkspace?React.createElement("div",{ref:function(e){return s.element=e}},o):this.props.paneIsExpanded&&this.isSingleColumnMode()&&f.ModuleStore.getActiveModuleLabel()?React.createElement("div",{ref:function(e){return s.element=e}},i):React.createElement("div",{ref:function(e){return s.element=e}},n,i)},t.prototype.renderGutterItems=function(e,t){var o,n,i,r=[],a=null!==(i=null==e?void 0:e.length)&&void 0!==i?i:0;if("Workspaces"===t?(this.currentItem++,a++,r.push(React.createElement(g.GutterPaneLink,{BeforeNavigate:this.collapsePane,Id:"home",Image:"Home",ImageType:y.ui.ImageType.symbol,key:"home",Label:y.label("NavigationPane_Home"),Posinset:this.currentItem,Selected:this.currentItem===this.state.selectedPaneItem,SetSelectedPaneItem:this.setSelectedPaneItem,Setsize:a,TargetMethod:y.ui.getNavBar().navigateToDashboard}))):"ActionWorkspaces"===t&&0<a&&r.push(React.createElement("gutterPane-horizontalLine")),e)try{for(var s=__values(e),l=s.next();!l.done;l=s.next()){var u=l.value;this.currentItem++,u.menuItemType&&r.push(React.createElement(g.GutterPaneLink,{BeforeNavigate:this.collapsePane,Favorite:u.favorite,FeatureName:t,FormName:u.formName,Id:u.id,Image:u.image,ImageType:u.imageType,key:u.id,Label:u.label,MenuItemName:u.menuItem,MenuItemType:u.menuItemType,Posinset:this.currentItem,Selected:this.currentItem===this.state.selectedPaneItem,SetSelectedPaneItem:this.setSelectedPaneItem,Setsize:a}))}}catch(e){o={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(o)throw o.error}}return r},t.prototype.renderItems=function(e,t,o,n,i){if(!this.props.navigationModeIsWorkspace&&!this.props.paneIsExpanded&&!this.props.PaneIsPinned)return null;var r=[];if(t&&e)if(o)r.push(React.createElement("div",{key:"loadingModulesDiv",className:"modulesFlyout-isLoading is-loading"},y.label("NavigationPane_Loading")));else if(0===e.length&&t)r.push(React.createElement("div",{key:"emptyModulesDiv",className:"modulesFlyout-isEmpty"},y.label(n)));else for(var a=0;a<e.length;a++){this.currentItem++;var s=e[a];s.menuItemType?r.push(React.createElement(g.ModulePaneLink,{BeforeNavigate:this.collapsePane,Favorite:s.favorite,FeatureName:i,FormName:s.formName,Id:s.id,key:s.id,Label:s.label,MenuItemName:s.menuItem,MenuItemType:s.menuItemType,Posinset:a+1,Selected:this.currentItem===this.state.selectedPaneItem,Setsize:e.length})):r.push(React.createElement(g.ModulePaneModule,{ExpandPane:this.expandPane,isActive:f.ModuleStore.isActiveModule(s.menuItem),isPhoneDevice:this.props.isPhoneDevice,isSingleColumnMode:this.isSingleColumnMode(),key:s.id,Label:s.label,MenuItemName:s.menuItem,PaneIsExpanded:t,Posinset:a+1,Selected:this.currentItem===this.state.selectedPaneItem,SetSelectedPaneItem:this.setSelectedPaneItem,Setsize:e.length}))}else r=null;return this.currentItem++,r},t.prototype.getModuleStoreState=function(e,t,o){var n=[];if(!o){var i=f.ModuleStore.getModules();for(var r in i)n.push(i[r]);n.sort(function(e,t){return e.label.localeCompare(t.label,Globalize.culture().name)})}var a={favorites:f.ModuleStore.getFavorites(),modules:n};if(e&&!o){var s=f.ModuleStore.getRecents();a.recents=s.slice(0,f.ModuleStore.maxRecents)}return(t||o)&&(a.workspaces=f.ModuleStore.getWorkspaces(o)),a},t.prototype.onNavigating=function(t){function e(){if(0<Object.getOwnPropertyNames(f.ModuleStore.getItemById(t.navigationItemId)).length){f.ModuleStore.addRecentlyUsedItem(t.navigationItemId);var e=f.ModuleStore.getNavigationPath(t.navigationItemId);y.ui.getNavBar()&&y.ui.getNavBar().Crumbs(e),window.setTimeout(function(){f.ModuleStore._requestMenuStructure("ReportMenuItemUsage",function(){},{menuItem:t.navigationItemId+"#"+e})})}}0===Object.getOwnPropertyNames(f.ModuleStore.getItemById(t.navigationItemId)).length?f.ModuleStore.requestMenuForPath(t.NavigationPath,e):e()},t.prototype.registerListeners=function(){document.body.addEventListener("click",this.clickHandler,!0),document.body.addEventListener("keydown",this.keyHandler,!0),this._listenersAreRegistered=!0},t.prototype.removeListeners=function(){document.body.removeEventListener("click",this.clickHandler,!0),document.body.removeEventListener("keydown",this.keyHandler,!0),this._listenersAreRegistered=!1},t.prototype.onmouseenter=function(e){y.superTooltip.tryOpenSuperTooltip(e.target)},t.prototype.isSingleColumnMode=function(){return this.props.ViewportSize===y.shell.ViewportSize.Small||this.props.ViewportSize===y.shell.ViewportSize.Medium},t);function t(e){var n=s.call(this,e)||this;n.Shortcuts={CollapseAll:{Handler:function(){f.ModuleStore.menuExpandCollapseAll(f.ModuleStore.getActiveLinks(),!1)},Keys:{shift:!0,keyCode:y.ui.KeyCodes.upArrow}},Escape:{Description:function(){return f.ModuleStore.getActiveModuleLabel()?y.label("NavigationPane_CloseModule"):y.label("NavigationPane_CollapseToolTip")},Handler:function(e){if(!y.shell.eventIsInNavigationPane(e))return!1;f.ModuleStore.getActiveModuleLabel()?n.closeFlyout():(y.value(y.shell.isNavigationPanePinned)&&n.props.ToggleIsPinned(),n.collapsePane())},Keys:{keyCode:y.ui.KeyCodes.esc},ShowToUser:function(e){return y.shell.eventIsInNavigationPane({target:e})}},ExpandAll:{Handler:function(){f.ModuleStore.menuExpandCollapseAll(f.ModuleStore.getActiveLinks(),!0)},Keys:{shift:!0,keyCode:y.ui.KeyCodes.downArrow}},PinNavigationPane:{Description:function(){return y.value(y.shell.isNavigationPanePinned)?y.label("Shell_CloseNavPane"):y.label("NavigationPane_PinToolTip")},Handler:function(){n.props.ToggleIsPinned()},Keys:{alt:!0,keyCode:y.ui.KeyCodes.f1}},SelectFirst:{Description:y.label("NavigationPane_MoveFirst"),Handler:function(e){if(!y.shell.eventIsInNavigationPane(e))return!1;f.ModuleStore.getActiveModuleLabel()?f.ModuleStore.getActiveModuleLabel()&&n.setState({selectedFlyoutItem:0}):n.setState({selectedPaneItem:0})},Keys:{keyCode:y.ui.KeyCodes.home},ShowToUser:function(e){return y.shell.eventIsInNavigationPane({target:e})}},SelectLast:{Description:y.label("NavigationPane_MoveLast"),Handler:function(e){if(!y.shell.eventIsInNavigationPane(e))return!1;f.ModuleStore.getActiveModuleLabel()?f.ModuleStore.getActiveModuleLabel()&&n.setState({selectedFlyoutItem:n.lastFlyoutItem}):n.setState({selectedPaneItem:n.lastItem})},Keys:{keyCode:y.ui.KeyCodes.end},ShowToUser:function(e){return y.shell.eventIsInNavigationPane({target:e})}},SelectNext:{Description:y.label("NavigationPane_MoveNext"),Handler:function(e){if(!y.shell.eventIsInNavigationPane(e))return!1;!f.ModuleStore.getActiveModuleLabel()&&n.state.selectedPaneItem<n.lastItem?n.setState(function(e){return{selectedPaneItem:e.selectedPaneItem+1}}):f.ModuleStore.getActiveModuleLabel()&&n.state.selectedFlyoutItem<n.lastFlyoutItem&&(n.setState(function(e){return{selectedFlyoutItem:e.selectedFlyoutItem+1}}),f.ModuleStore.whatsNewClose())},Keys:{keyCode:y.ui.KeyCodes.downArrow},ShowToUser:function(e){return y.shell.eventIsInNavigationPane({target:e})}},SelectPrevious:{Description:y.label("NavigationPane_MovePrev"),Handler:function(e){if(!y.shell.eventIsInNavigationPane(e))return!1;!f.ModuleStore.getActiveModuleLabel()&&0<n.state.selectedPaneItem?n.setState(function(e){return{selectedPaneItem:e.selectedPaneItem-1}}):f.ModuleStore.getActiveModuleLabel()&&0<n.state.selectedFlyoutItem&&(n.setState(function(e){return{selectedFlyoutItem:e.selectedFlyoutItem-1}}),f.ModuleStore.whatsNewClose())},Keys:{keyCode:y.ui.KeyCodes.upArrow},ShowToUser:function(e){return y.shell.eventIsInNavigationPane({target:e})}}},n.storeChanged=function(){n.setState(n.getModuleStoreState(n.state.recentsLoaded,n.state.workspacesLoaded,n.props.navigationModeIsWorkspace))},n.togglePane=function(){n.props.navigationModeIsWorkspace?n.props.ToggleIsPinned():n.props.PaneIsPinned?n.props.setIsExpanded(!0):n.props.setIsExpanded(!n.props.paneIsExpanded)},n.paneOpenerKeyDown=function(e){y.util.isShortcutKeyPressed(e.nativeEvent,{keyCode:[y.ui.KeyCodes.enter,y.ui.KeyCodes.spacebar]})&&(n.props.navigationModeIsWorkspace?n.props.ToggleIsPinned():n.props.setIsExpanded(!0))},n.collapsePane=function(){n.props.setIsExpanded(!1)},n.keyHandler=function(e){"nativeEvent"in e&&(e=e.nativeEvent),y.util.handleShortcuts(n,e)},n.setSelectedPaneItem=function(e){n.setState({selectedPaneItem:e})},n.onFavoritesClicked=function(){var e=n.state.favoritesAreExpanded;n.collapseAllGroups(),n.closeFlyout(),n.props.paneIsExpanded||n.props.PaneIsPinned?n.setState({favoritesAreExpanded:!e,selectedPaneItem:1}):(n.expandPane(),n.setState({favoritesAreExpanded:!0,selectedPaneItem:1}))},n.onRecentsClicked=function(){var e=n.state.recentsAreExpanded;n.collapseAllGroups(),n.closeFlyout(),n.state.recentsLoaded||n.loadRecents(),n.props.paneIsExpanded||n.props.PaneIsPinned?n.setState({recentsAreExpanded:!e,selectedPaneItem:2}):(n.expandPane(),n.setState({recentsAreExpanded:!0,selectedPaneItem:2}))},n.onWorkspacesClicked=function(){var e=n.state.workspacesAreExpanded;n.collapseAllGroups(),n.closeFlyout(),n.state.workspacesLoaded||n.loadWorkspaces(),n.props.paneIsExpanded||n.props.PaneIsPinned?n.setState({workspacesAreExpanded:!e,selectedPaneItem:3}):(n.expandPane(),n.setState({workspacesAreExpanded:!0,selectedPaneItem:3}))},n.onModulesClicked=function(){var e=n.state.modulesAreExpanded;n.collapseAllGroups();var t=4;if(null===f.ModuleStore._activeModuleMenuItem&&f.ModuleStore._lastActiveModuleMenuItem&&(f.ModuleStore._activeModuleMenuItem=f.ModuleStore._lastActiveModuleMenuItem),f.ModuleStore._activeModuleMenuItem)for(var o=0;o<n.state.modules.length;o++)if(f.ModuleStore.isActiveModule(n.state.modules[o].menuItem)){t+=o+1;break}n.props.paneIsExpanded||n.props.PaneIsPinned?(n.closeFlyout(),n.setState({modulesAreExpanded:!e,selectedPaneItem:t})):(n.expandPane(),n.setState({modulesAreExpanded:!0,selectedPaneItem:t}))},n.setSelectedFlyoutItem=function(e){n.setState({selectedFlyoutItem:e})},n.closeFlyout=function(){f.ModuleStore.changeActiveModule(null),y.whatsNew.closeWhatsNew(y.whatsNew.keyIds.navigationKey)},n.setFlyoutItemCount=function(e){n.lastFlyoutItem=e},n.expandPane=function(){n.props.navigationModeIsWorkspace?n.props.ToggleIsPinned():n.props.setIsExpanded(!0)},n.clickHandler=function(e){!e||!e.target||$(e.target).parents().hasClass("modulesPane")||y.flyout.flyoutManager.areAnyFlyoutsOpen()&&!y.util.flyout.IsClickInFlyout(e.target,y.value(y.flyout.flyoutManager.getTopFlyout().flyout),e.pageX,e.pageY)||y.util.flyout.wasLightboxClicked(e.target)||$(e.target).parents().hasClass("asidePane")||$(e.target).parents().hasClass("qtip")||(n.collapsePane(),e.stopPropagation(),y.log.stopPropagation&&y.log.stopPropagation("Closing Navigation Pane and stopPropagation on the keydown."))},n.collapseAllGroups=function(){n.setState({favoritesAreExpanded:!1,modulesAreExpanded:!1,recentsAreExpanded:!1,workspacesAreExpanded:!1})},n.loadRecents=function(){n.setState({recentsLoaded:!0,recents:f.ModuleStore.getRecents()})},n.loadWorkspaces=function(){n.setState({workspacesLoaded:!0,workspaces:f.ModuleStore.getWorkspaces()})};var t=n.getModuleStoreState(!0,!1,n.props.navigationModeIsWorkspace),o=t.modules,i=t.favorites,r=t.recents,a=t.workspaces;return n.state={closedModule:"",favorites:i,favoritesAreExpanded:!0,modules:o,modulesAreExpanded:!1,navigating:!1,recents:r,recentsAreExpanded:!1,recentsLoaded:!1,selectedFlyoutItem:0,selectedPaneItem:0,workspaces:a,workspacesAreExpanded:!1,workspacesLoaded:!1},n}g.ModulesPane=e})((f=y.DynReact||(y.DynReact={})).UI||(f.UI={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(e){var t,r,n,o;function i(){var o=null!==n&&n.apply(this,arguments)||this;return o.onClick=function(e){var t=e.target;t.parentElement&&t.parentElement.children&&o.props.SetSelectedPaneItem(Array.prototype.indexOf.call(t.parentElement.children,e.target)),o.props.OnHeaderClick()},o}t=e.DynReact||(e.DynReact={}),r=t.UI||(t.UI={}),n=e.DynReact.GroupHeading,__extends(i,n),i.prototype.componentDidMount=function(){this.element.dynContext={current:this}},i.prototype.componentDidUpdate=function(){this.element.dynContext={current:this}},i.prototype.render=function(){var t=this,e=!1,o=!1,n="modulesPane-groupHeading";this.props.ExpandedGutter&&(this.props.Expanded?n+=" modulesPane-isExpanded ChevronUp-symbol":n+=" ChevronDown-symbol",o=!0,e=this.props.Expanded);var i=r.GutterUtil.buildImageLink({Image:this.props.Image,ImageType:this.props.ImageType,Label:this.props.Label});return React.createElement("div",{"aria-expanded":e,"aria-label":this.props.Label,"aria-level":1,className:n,"data-dyn-expanded":this.props.paneIsExpanded,"data-dyn-selected":this.props.Selected,"data-dyn-title":this.props.Label,id:this.props.Id,onClick:this.onClick,onKeyDown:this.keyHandler,onMouseEnter:this.onmouseenter,ref:function(e){return t.element=e},role:"treeitem",tabIndex:0},React.createElement("span",{className:"modulesPaneGroup-linkSelected"}),i,o?this.props.Label:"")},o=i,r.ModulesPaneGroup=o}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){var e,t,o,n;function i(){return null!==o&&o.apply(this,arguments)||this}e=r.DynReact||(r.DynReact={}),t=e.UI||(e.UI={}),o=e.Navigation,__extends(i,o),i.prototype.render=function(){var e,t="tile modulesFlyout-tile";switch(t+=this.props.Favorite?" modulesFlyout-isFavorite":"",this.props.ImageType){case r.ui.ImageType.symbol:var o=this.props.Image+"-symbol";o.match(/\s+/g)&&(o="imageBinder-emptyImage");var n="tile-image "+o;e=React.createElement("span",{className:n,"data-dyn-image-type":"Symbol"});break;case r.ui.ImageType.url:case r.ui.ImageType._axResource:e=React.createElement("span",{className:"tile-image","data-dyn-image-type":"Image"},React.createElement("img",{className:"imageBinder-image",src:this.props.Image}));break;case r.ui.ImageType.base64:var i="data:image/png;base64,"+this.props.Image;e=React.createElement("span",{className:"tile-image","data-dyn-image-type":"Image"},React.createElement("img",{className:"imageBinder-image",src:i}))}return React.createElement("div",{"aria-label":this.props.Label,className:t,"data-dyn-button-display":r.ui.ButtonDisplay.backgroundImage,"data-dyn-selected":this.props.Selected,"data-dyn-tile-size":"Wide","data-dyn-title":this.props.Label,onClick:this.handleClick,onKeyDown:this.keyHandler,role:"link",tabIndex:0},e,React.createElement("span",{className:"tile-text",onMouseEnter:this.onmouseenter,"aria-hidden":!0},this.props.Label),React.createElement("div",{className:"modulesFlyout-favoriteIcon","data-dyn-title":this.favoriteText(),"aria-hidden":!0,onMouseEnter:this.onmouseenter,onClick:this.clickFavorite}))},n=i,t.Tile=n}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(r){var a,s,o,e;function t(e){var t=o.call(this,e)||this;return t.modulesChanged=function(){t.state.activeModule!==a.ModuleStore.getActiveModuleLabel()&&t.props.SetSelectedFlyoutItem(0),t.setState({activeLinks:a.ModuleStore.getActiveLinks(),activeModule:a.ModuleStore.getActiveModuleLabel(),loading:a.ModuleStore.getLoadingState()})},t.menuExpandView=function(){a.ModuleStore.menuExpandCollapseAll(t.state.activeLinks,!0)},t.menuCollapseView=function(){a.ModuleStore.menuExpandCollapseAll(t.state.activeLinks,!1)},t.state={activeLinks:a.ModuleStore.getActiveLinks(),activeModule:a.ModuleStore.getActiveModuleLabel(),loading:a.ModuleStore.getLoadingState()},t}a=r.DynReact||(r.DynReact={}),s=a.UI||(a.UI={}),o=React.Component,__extends(t,o),t.prototype.componentWillMount=function(){!this.state.activeModule&&a.ModuleStore.getActiveModuleLabel()&&this.modulesChanged()},t.prototype.componentDidMount=function(){a.ModuleStore.addSubscription(this.modulesChanged),this.state.activeModule&&this.recalculateFlyoutWidth()},t.prototype.componentWillUnmount=function(){a.ModuleStore.removeSubscription(this.modulesChanged)},t.prototype.componentDidUpdate=function(e,t){if(this._lastLinkCount===this._currentLinkCount&&t.activeModule===this.state.activeModule||this.recalculateFlyoutWidth(),a.ModuleStore.getActiveModuleLabel()&&t.activeModule!==this.state.activeModule&&!a.ModuleStore.hasAnyPersonalizations&&!a.ModuleStore.hideWhatsNew){var o=void 0,n=void 0;n=this.props.IsPaneSingleColumn?(o=document.getElementsByClassName("modulesFlyout-singleColumnContainer")[0],{my:"top center",at:"top center",adjust_y:100}):(o=document.getElementsByClassName("modulesFlyout-container")[0],{my:"left center",at:"right top",adjust_y:100,adjust_x:-50});var i={AdditionalData:JSON.stringify([""]),AdditionalDataType:"WhatsNewFeatureContract",Message:r.label("NavigationPane_WhatsNew"),RuleId:r.whatsNew.keyIds.navigationKey,TargetControl:o,Title:r.label("NavigationPane_WhatsNewToolTip")};r.whatsNew.processWhatsNewMessage(i,n)}},t.prototype.render=function(){if(!this.state.activeModule||!this.state.activeLinks||0===this.state.activeLinks.length)return null;var e="modulesFlyout dashboardTiles_wide",t="modulesFlyout-container",o=React.createElement("button",{className:"modulesFlyout-backButton ChevronLeft-symbol",type:"button",onClick:this.props.CloseFlyout,title:r.label("NavigationPane_Back")}),n=React.createElement("button",{className:"modulesFlyout-closeButton Cancel-symbol",type:"button",onClick:this.props.BeforeNavigate,title:r.label("NavBar_Close")});this.props.ExpandView&&(e+=" modulesFlyout-isExpand"),this.state.loading&&(e+=" modulesFlyout-isLoading"),this.props.IsPaneSingleColumn&&(t="modulesFlyout-singleColumnContainer",e+=" singleColumnFlyout");var i=React.createElement("div",{className:"modulesFlyout-toolStrip"},React.createElement("button",{className:"modulesFlyout-ExpandAll",type:"button",onClick:this.menuExpandView,tabIndex:-1,title:r.label("NavigationPane_ExpandAllToolTip")},r.label("NavigationPane_ExpandAllToolTip")+" "),React.createElement("button",{className:"modulesFlyout-CollapseAll",type:"button",onClick:this.menuCollapseView,tabIndex:-1,title:r.label("NavigationPane_CollapseAllToolTip")},r.label("NavigationPane_CollapseAllToolTip")+" "));return React.createElement("div",{className:e,role:"group"},this.props.IsPaneSingleColumn?null:i,React.createElement("div",{ref:"subc",role:"tree",className:t,tabIndex:0},this.props.IsPaneSingleColumn?React.createElement("div",{className:"modulesFlyout-header",tabIndex:0},o,React.createElement("span",{className:"modulesFlyout-activeModule"},a.ModuleStore.getActiveModuleLabel()),n):null,this.props.IsPaneSingleColumn?i:null,this.renderItems()))},t.prototype.recalculateFlyoutWidth=function(){if(!this.props.IsPaneSingleColumn){if(!this.state.activeLinks||0===this.state.activeLinks.length||!this.refs.subc)return;var e=$(this.refs.subc);if(this.state.activeLinks&&0<this.state.activeLinks.length){e.parent().css("width","0px");var t=e[0].scrollWidth+20;e.parent().css("width",t+"px")}}},t.prototype.renderItems=function(){var t,e,o=[];a.ModuleStore._collapsedMenus=[];try{for(var n=__values(this.state.activeLinks),i=n.next();!i.done;i=n.next()){var r=i.value;r.expanded||a.ModuleStore._collapsedMenus.push(r.id),this.renderItem(o,r,0,!1)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return this._lastLinkCount=this._currentLinkCount,this._currentLinkCount=o.length,this.props.ReportFlyoutItemCount(o.length-1),o},t.prototype.renderItem=function(e,t,o,n){t.children?this.renderGroup(e,t,o,0===o||n):t.tile?e.push(React.createElement(s.Tile,{BeforeNavigate:this.props.BeforeNavigate,Favorite:t.favorite,FeatureName:"sitemap",FormName:t.formName,Id:t.id,Image:t.image,ImageType:t.imageType,key:t.id,Label:t.label,MenuItemName:t.menuItem,MenuItemType:t.menuItemType,Selected:e.length===this.props.SelectedFlyoutItem})):e.push(React.createElement(s.ModuleLink,{BeforeNavigate:this.props.BeforeNavigate,Favorite:t.favorite,FeatureName:"sitemap",FormName:t.formName,Id:t.id,key:t.id,Label:t.label,Last:n,Level:o,MenuItemName:t.menuItem,MenuItemType:t.menuItemType,Selected:e.length===this.props.SelectedFlyoutItem}))},t.prototype.renderGroup=function(e,t,o,n){if(e.push(React.createElement(s.ModuleLinkGroup,{Expanded:t.expanded,Id:t.id,key:t.id,Label:t.label,Last:!t.expanded&&n,Level:o,Selected:e.length===this.props.SelectedFlyoutItem,SetSelectedFlyoutItem:this.props.SetSelectedFlyoutItem})),t.expanded)for(var i=0;i<t.children.length;i++){var r=t.children[i];t.expanded||a.ModuleStore._collapsedMenus.push(t.id),this.renderItem(e,r,o+1,n&&i===t.children.length-1)}else 0<t.children.length&&a.ModuleStore._collapsedMenus.push(t.id)},e=t,s.ModulesFlyout=e}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(d){var e,t,o,n,i,r,a,s,l;!function(e){Globalize.addCultureInfo("en",{messages:{Tree_CheckedText:"Checked, ",Tree_ChildrenText:"Node Has {0} Children, ",Tree_CollapsedText:"Collapsed, ",Tree_ExpandedText:"Expanded, ",Tree_NodeLabel:"TreeNode {0} is ",Tree_PartialCheckedText:"Partially Checked, ",Tree_Posinset:"This Node is {0} out of {1} Children of its Parent Node, ",Tree_RangeSelectionText:"Multiple nodes are selected from node {0} to node {1}, ",Tree_SelectCheckBoxName:"Tree Node Selection",Tree_SingleSelectionText:"Selected, ",Tree_ToggleSelectionText:"Unselected, ",Tree_UncheckedText:"Unchecked, "}});var a,t=(a=d.ui.Control,__extends(o,a),o.prototype.init=function(e,t){var u=this;this.currentHowSelected=0,a.prototype.init.call(this,e,t),this.selectedNodes=[],this.idMap={},this.isFocused=!1,this.setFocusTimeoutId=-1,this.mouseUpAdded=!1,this.RecordRemoveTelemetry=function(){},this.RecordAddTelemetry=function(){},this.RecordEditTelemetry=function(){},this.Nodes=[],this.direction=d.ui.Tree.NavigationDirection.Down,d.observe(this.Border,function(e){"Auto"===e||"None"===e?$(u.element).removeClass("treeView-border"):$(u.element).addClass("treeView-border")}),this.CheckBoxCascade=d.computed(function(){return 1==d.value(u.CheckBox)&&1==d.util.stringToBoolean(d.value(u.CascadeSelect))}),this.Root&&this.Root.serializeTransitState&&(this.TransitStateSubscriptionId=this.Root.serializeTransitState.subscribe(this.onSerializeTransitState.bind(this))),t&&(this.prevWidth=t.clientWidth,this._didUpdate=function(){var e,t,o=u.element.clientWidth;o!==u.prevWidth&&(u.prevWidth=o,null!==(e=u._parent)&&void 0!==e&&e.element&&d.layout.reflow(null===(t=u._parent)||void 0===t?void 0:t.element,!1))}),this.__updateScrollOnNavigation=function(){var e=u.SelectedNode();u.currentHowSelected=0,u.updateScrollIntoView(e)},$(document.body).on("resetShellOnNavigation",this.__updateScrollOnNavigation);var o=d.length(this.TreeNodes);void 0!==o&&0!==o||this.renderTree(),d.observe(this.TreeNodes,function(e){var t,o;if(0<d.length(e)){var n=!1;try{for(var i=__values(e),r=i.next();!r.done;r=i.next()){var a=r.value,s=u.convertNode(a);if(s.CommandRequest==d.ui.TreeCommands.Edit)u.updateNode(s);else if(s.CommandRequest==d.ui.TreeCommands.Delete){var l=u.deleteNode(s);n=n||!l}else l=u.addNode(s),n=n||!l}}catch(e){t={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}u.TreeNodes([]),n&&u.renderTree()}})},o.prototype.getTaskGuideParams=function(e){var t=(e=a.prototype.getTaskGuideParams.call(this,e)).arguments&&0<e.arguments.length?e.arguments[0].split("\\"):"";if(""!==t){var o=-1<t[0].indexOf('"')?"[title='{0}']":'[title="{0}"]',n=$(this.element).find(d.format(o,t[0]));if(n&&$(n)){for(var i=$(n).closest(".treeView-treeItem-header"),r=1;r<t.length;r++)o=-1<t[r].indexOf('"')?"[title='{0}']":'[title="{0}"]',(n=$(i).parent().find(d.format(o,t[r])))&&$(n)&&(i=$(n).closest(".treeView-treeItem-header"));i&&(e.target=$(i))}}return e.target&&e.target.length||(e.target=$(this.element)),e},o.prototype.NodeData=function(e){return this.idMap[e]},o.prototype.SetNodeData=function(e,t){t?this.idMap[e]=t:(this.idMap[e]&&this.idMap[e].ReactNode&&delete this.idMap[e].ReactNode,delete this.idMap[e])},o.prototype.onSerializeTransitState=function(){d.applyFunction(this.Reserialize,this)},o.prototype.CheckBoxClick=function(e,t){if(this.allowUserChanges()){var o=e.CheckedState();o=o===d.ui.CheckedState.Checked?d.ui.CheckedState.Unchecked:d.ui.CheckedState.Checked,e.CheckedState(o),this.SetNodeCheckBox(e.NodeData(),o,!0)}t&&t.stopPropagation()},o.prototype.ClickNode=function(e,t){var o=d.ui.Tree.SelectionAction.Single;d.value(this.SingleSelect)||(t.shiftKey?o=d.ui.Tree.SelectionAction.Range:t.ctrlKey&&(o=d.ui.Tree.SelectionAction.Append)),this.SelectNode(e,d.ui.Tree.HowSelected.ByMouse,o),this.formActiveRowChangedNotify()},o.prototype.ButtonClick=function(e,t){this.TelemetryOptions={inputType:d.telemetry.InputType.mouse},this.ExpandCollapse(e,!e.Expanded()),t&&t.stopPropagation()},o.prototype.ApplyRename=function(e,t,o,n){if(this.Editing=!1,e&&o!==t){var i=[o=t];d.getFunction(this.NodeNameChanged)(i),this.RecordEditTelemetry(n)}},o.prototype.AddSelection=function(e){var t=e.NodeId();0!==this.selectedNodes.length&&!1!==this.selectedNodes.some(function(e){return e.NodeId()==t})||(this.selectedNodes.push(e),this.updateScrollIntoView(e))},o.prototype.RemoveSelection=function(e){this.RemoveNodeFromArray(this.selectedNodes,e.NodeId(),this.nodeIdComparer)},o.prototype.mouseDown=function(e){if(e&&e.target&&!this.isFocused&&0<d.length(this.Nodes)){e.target.classList.add("selecting"),this.element.setAttribute("data-dyn-focus",".selecting");var t=d.util.isEventListenerOptionsSupported();this.mouseUpAdded=!0,document.body.addEventListener("mouseup",this.mouseUp,!t||{capture:!0,once:!0,passive:!0})}},o.prototype.keyDown=function(e){e.which===d.ui.KeyCodes.upArrow?(this.SelectNextVisible(e,!1),e.preventDefault()):e.which===d.ui.KeyCodes.downArrow?(this.SelectNextVisible(e,!0),e.preventDefault()):e.which!==d.ui.KeyCodes.home||this.Editing?e.which!==d.ui.KeyCodes.end||this.Editing?e.which!==d.ui.KeyCodes.leftArrow||this.Editing?e.which!==d.ui.KeyCodes.rightArrow||this.Editing?e.which!==d.ui.KeyCodes.spacebar&&e.which!==d.ui.KeyCodes.enter||this.Editing?e.which===d.ui.KeyCodes.letterR&&e.altKey?(this.RenameNode(),e.preventDefault()):e.which===d.ui.KeyCodes.enter&&this.Editing?this.handleRenameActions(e,!1):e.which===d.ui.KeyCodes.esc&&this.Editing&&this.handleRenameActions(e,!0):(this.ToggleSelectedNodeCheck(e),this.formActiveRowChangedNotify(),e.preventDefault()):(this.ExpandSelectedNode(),e.preventDefault()):(this.CollapseSelectedNode(),e.preventDefault()):(this.SelectLastVisibleRoot(),e.preventDefault()):(this.SelectRoot(),e.preventDefault())},o.prototype.focusInCallBack=function(){this.setFocused(!0)},o.prototype.focusOutCallBack=function(){this.setFocused(!1)},o.prototype.dispose=function(){ReactDOM.unmountComponentAtNode(this.element),$(document.body).off("resetShellOnNavigation",this.__updateScrollOnNavigation),a.prototype.dispose.call(this),-1!==this.setFocusTimeoutId&&(window.clearTimeout(this.setFocusTimeoutId),this.setFocusTimeoutId=-1),this.mouseUpAdded&&(document.body.removeEventListener("mouseup",this.mouseUp,!0),this.mouseUpAdded=!1)},o.prototype.ExpandCollapse=function(e,t){if(d.value(this.Enabled)){e.Expanded(t);var o=[e.NodeId(),t?d.ui.Tree.ExpandAction.Expand:d.ui.Tree.ExpandAction.Collapse];d.getFunction(this.Expanding)(o)}},o.prototype.SelectNode=function(e,t,o){if(this.currentHowSelected=t,d.value(this.Enabled))switch(o){case d.ui.Tree.SelectionAction.Append:this.toggleSelectedNode(e,t);break;case d.ui.Tree.SelectionAction.Range:var n=this.FirstSelectedNode();this.selectNodeRange(n,e,t);break;default:this.selectSingleNode(e,t)}},o.prototype.setFocused=function(e){var t=this;-1!==this.setFocusTimeoutId&&(window.clearTimeout(this.setFocusTimeoutId),this.setFocusTimeoutId=-1),this.setFocusTimeoutId=window.setTimeout(function(){t.isFocused!==e&&((t.isFocused=e)?t.element.classList.add("focused"):t.element.classList.remove("focused")),t.setFocusTimeoutId=-1})},o.prototype.idComparer=function(e,t){return e.Id==t},o.prototype.nodeIdComparer=function(e,t){return e.NodeId()==t},o.prototype.RemoveNodeFromArray=function(e,n,i){if(0<e.length){var r=-1;e.some(function(e,t){var o=!1;return i(e,n)&&(r=t,o=!0),o}),-1<r&&(e.splice(r,1),this.RecordRemoveTelemetry(n))}},o.prototype.convertNode=function(e){return e.Id=parseInt(e.Id),e.ParentId=parseInt(e.ParentId),e.InsertAfterId=parseInt(e.InsertAfterId),e.Expanded=d.util.stringToBoolean(e.Expanded),e.Selected=d.util.stringToBoolean(e.Selected),e.HasChildren=d.util.stringToBoolean(e.HasChildren),e.Bold=d.util.stringToBoolean(e.Bold),e.CheckedState=parseInt(e.CheckedState),e},o.prototype.updateParentChain=function(e){for(;e&&!e.renderPending;){if(e.renderPending=!0,0==e.ParentId)return;e=this.NodeData(e.ParentId)}},o.prototype.compareNodeValue=function(e,t,o){e&&t&&(e[o]||t[o])&&e[o]!=t[o]&&(e.ReactNode?(d.callFunction(e.ReactNode[o],e.ReactNode,t[o]),"CheckedState"===o&&this.SetWaitChecked(e,t.CheckedState)):(e[o]=t[o],this.updateParentChain(e),"CheckedState"===o?this.SetWaitChecked(e,t.CheckedState):"Expanded"===o&&e.isDirty&&e.Expanded&&(e.Nodes=e.AllNodes,e.Nodes.forEach(function(e){e&&(e.renderPending=!0)}),e.isDirty=!1)))},o.prototype.addNode=function(e){var t=0==e.ParentId,o=t?this.Nodes:this.NodeData(e.ParentId).AllNodes,n=!1,i=e.InsertAfterId;if(this.SetNodeData(e.Id,e),e.Nodes=[],e.AllNodes=[],e.Expanded&&(e.Nodes=e.AllNodes),e.isDirty=!0,e.renderPending=!0,e.Tree=this,0!=i?o.splice(o.indexOf(this.NodeData(i))+1,0,e):(0<o.length&&(o[0].InsertAfterId=e.Id),o.unshift(e)),!t){var r=this.NodeData(e.ParentId);r&&(r.HasChildren=!0,r.Expanded?this.updateParentChain(r):(r.isDirty=!0,n=!(e.renderPending=!1)))}return this.RecordAddTelemetry(e.Id),n},o.prototype.deleteNode=function(e,t){var o=this;t=void 0===t||t;var n=!1;if(e.HasChildren){var i=this.NodeData(e.Id);i&&i.AllNodes&&this.cloneArray(i.AllNodes).forEach(function(e){e&&o.NodeData(e.Id)&&o.deleteNode(e,!1)})}var r=0==e.ParentId,a=r?this.Nodes:this.NodeData(e.ParentId).AllNodes;if(this.RemoveNodeFromArray(a,e.Id,this.idComparer),this.RemoveNodeFromArray(this.selectedNodes,e.Id,this.nodeIdComparer),!r&&t){var s=this.NodeData(e.ParentId);s&&(s.Expanded?this.updateParentChain(s):(s.isDirty=!0,n=!(e.renderPending=!1)))}return this.SetNodeData(e.Id,void 0),n},o.prototype.updateNode=function(t){var o=this;if(t){var n=this.NodeData(t.Id);n&&["name","Expanded","Selected","HasChildren","CheckedState","Bold","ImageName","ImageType","AltText"].forEach(function(e){o.compareNodeValue(n,t,e)})}},o.prototype.renderTree=function(){if(this.element)if(0===d.length(this.Nodes)){this.element.setAttribute("data-dyn-focus",".list-No-Rows-Indicator > span");var e=React.createElement(d.DynReact.UI._EmptyTreeIndicator,{EmptyTreeText:d.label("List_NoResultsMessage")});ReactDOM.render(e,this.element)}else{this.element.setAttribute("data-dyn-focus",".selected");var t=React.createElement(d.DynReact.UI._TreeNodeContainer,{Nodes:this.Nodes,didUpdate:this._didUpdate});ReactDOM.render(t,this.element)}},o.prototype.deleteAll=function(){var t=this;this.cloneArray(this.Nodes).forEach(function(e){t.deleteNode(e)}),this.renderTree()},o.prototype.RenameNode=function(){if(this.allowUserChanges()&&d.value(this.EditLabels)){var e=this.SelectedNode();e&&(this.Editing=!0,e.startRename())}},o.prototype.cloneArray=function(e){var t=[];return e.forEach(function(e){t.push(e)}),t},o.prototype.forEachChild=function(e,t){for(var o,n,i=this.cloneArray(e.AllNodes);0<i.length;)0<(o=(n=i.shift()).AllNodes).length&&(i=i.concat(this.cloneArray(o))),t(n)},o.prototype.forEachParent=function(e,t){for(var o=this.NodeData(e.ParentId);o;)t(o),o=this.NodeData(o.ParentId)},o.prototype.SetWaitChecked=function(t,o){var n=this;d.value(this.CheckBoxCascade)?this.SetNodeCheckBox(t,o):this.checkBoxCascadeObserverCreated||(d.observe(this.CheckBoxCascade,function(e){if(e)return n.SetNodeCheckBox(t,o),!1}),this.checkBoxCascadeObserverCreated=!0)},o.prototype.SetNodeCheckBox=function(e,t,o){var i=this;if(!this.SetNodeCheckBoxExecuting){if(this.SetNodeCheckBoxExecuting=!0,d.value(this.CheckBoxCascade)&&(t!==d.ui.CheckedState.Partial&&this.forEachChild(e,function(e){e.ReactNode?e.ReactNode.CheckedState(t):d.setValue(e,"CheckedState",t)}),this.forEachParent(e,function(e){var t=d.ui.CheckedState.Unchecked,o=0,n=0;i.forEachChild(e,function(e){switch(e.ReactNode?e.ReactNode.CheckedState():e.CheckedState){case d.ui.CheckedState.Checked:n++;break;default:o++}}),0===o?t=d.ui.CheckedState.Checked:0<n&&(t=d.ui.CheckedState.Partial),e.ReactNode?e.ReactNode.CheckedState(t):d.setValue(e,"CheckedState",t)})),o){var n=[e.Id,t];d.getFunction(this.NodeChecked)(n)}this.SetNodeCheckBoxExecuting=!1}},o.prototype.selectSingleNode=function(e,t){if(1!==this.selectedNodes.length||!e.Selected()){this.ClearSelection(),e.Selected(!0);var o=[e.NodeId(),t,!1];d.getFunction(this.SelectionChanged)(o)}},o.prototype.toggleSelectedNode=function(e,t){var o=e.Selected();e.Selected(!o);var n=[e.NodeId(),t];d.getFunction(this.ToggleSelection)(n)},o.prototype.selectNodeRange=function(e,t,o){this.ClearSelection();for(var n=this.GetRoot(),i=e.NodeId(),r=t.NodeId();null!=n&&n.NodeId()!=i&&n.NodeId()!=r;)n=this.GetNextVisible(n);if(null!=n)for(var a=n.NodeId()==r?i:r;null!=n&&(n.Selected(!0),n.NodeId()!=a);)n=this.GetNextVisible(n);var s=[e.NodeId(),t.NodeId()];d.getFunction(this.SelectRange)(s)},o.prototype.FirstSelectedNode=function(){var e=null;return 0<this.selectedNodes.length&&(e=this.selectedNodes[0]),e},o.prototype.SelectedNode=function(){var e=null;return 0<this.selectedNodes.length&&(e=this.selectedNodes[this.selectedNodes.length-1]),e},o.prototype.updateScrollIntoView=function(e){e&&1!==this.currentHowSelected&&e.InputElement().scrollIntoViewIfNeeded(!1),this.currentHowSelected=0},o.prototype.ClearSelection=function(){this.selectedNodes.forEach(function(e){e.Selected(!1,!0)}),this.selectedNodes=[]},o.prototype.GetRoot=function(){var e=null;return 0<this.Nodes.length&&(e=this.Nodes[0].ReactNode),e},o.prototype.GetParentNode=function(e){var t=null;if(e){var o=this.NodeData(e.ParentId());o&&(t=o.ReactNode)}return t},o.prototype.ExpandSelectedNode=function(){var e=this.SelectedNode();if(e&&1==e.HasChildren())return e.TelemetryOptions={inputType:d.telemetry.InputType.keyboard},this.ExpandCollapse(e,!0),!1},o.prototype.CollapseSelectedNode=function(){var e=this.SelectedNode();if(e&&1==e.HasChildren()&&1==e.Expanded())e.TelemetryOptions={inputType:d.telemetry.InputType.keyboard},this.ExpandCollapse(e,!1);else{var t=this.GetParentNode(e);t&&(this.SelectNode(t,d.ui.Tree.HowSelected.ByKeyboard),t.TelemetryOptions={inputType:d.telemetry.InputType.keyboard},this.ExpandCollapse(t,!1))}},o.prototype.ToggleSelectedNodeCheck=function(e){var t=this.SelectedNode();t&&(t.TelemetryOptions={inputType:d.telemetry.InputType.keyboard},this.CheckBoxClick(t,e))},o.prototype.GetNextVisible=function(e){var t=null;if(e&&e.Expanded()&&e.ChildCount())t=e.GetChild(0);else for(t=this.GetSiblingNode(e,!0);!t&&e;)e=this.GetParentNode(e),t=this.GetSiblingNode(e,!0);return t},o.prototype.GetPrevVisible=function(e){var t=this.GetSiblingNode(e,!1);if(null===t)t=this.GetParentNode(e);else if(t.Expanded()&&t.ChildCount()){for(var o=t;o&&o.Expanded()&&o.ChildCount();)o=(t=o).GetChild(o.ChildCount()-1);return o||t}return t},o.prototype.GetSiblingNode=function(e,t){var o=null;if(e){var n=this.Nodes,i=this.NodeData(e.NodeId()),r=this.GetParentNode(e);r&&(n=r.GetChildren());var a=n.indexOf(i);if(0<=a){var s=null;(s=!0===t?n[a+1]:n[a-1])&&(o=s.ReactNode)}}return o},o.prototype.GetSiblingData=function(e,t){var o=null;if(e){var n=this.Nodes,i=this.NodeData(e.ParentId);i&&(n=i.AllNodes);var r=n.indexOf(e);0<=r&&(o=!0===t?n[r+1]:n[r-1])}return o},o.prototype.SelectRoot=function(){var e=this.GetRoot();this.SelectNode(e,d.ui.Tree.HowSelected.ByKeyboard,d.ui.Tree.SelectionAction.Single)},o.prototype.SelectLastVisibleRoot=function(){for(var e=this.SelectedNode(),t=e;null!=e;)null!=(e=this.GetNextVisible(e))&&(t=e);this.SelectNode(t,d.ui.Tree.HowSelected.ByKeyboard,d.ui.Tree.SelectionAction.Single)},o.prototype.SelectNextVisible=function(e,t){var o=this.SelectedNode(),n=t?this.GetNextVisible(o):this.GetPrevVisible(o);if(null!==o&&null!==n){if(d.value(this.SingleSelect)||!e.shiftKey&&!e.ctrlKey)this.SelectNode(n,d.ui.Tree.HowSelected.ByKeyboard,d.ui.Tree.SelectionAction.Single),this.direction=t?d.ui.Tree.NavigationDirection.Down:d.ui.Tree.NavigationDirection.Up;else{var i=void 0;1===this.selectedNodes.length?(i=n,this.direction=t?d.ui.Tree.NavigationDirection.Down:d.ui.Tree.NavigationDirection.Up):i=t&&this.direction===d.ui.Tree.NavigationDirection.Down||!t&&this.direction===d.ui.Tree.NavigationDirection.Up?n:o,this.toggleSelectedNode(i,d.ui.Tree.HowSelected.ByKeyboard)}return!1}},o.prototype.handleRenameActions=function(e,t){var o=this.SelectedNode();t?o.rollbackChange(e):o.commitChange(e)},o.prototype.formActiveRowChangedNotify=function(){if(d.util.isInZoomWidthMode()&&this.isElementInSidePanel()){var e=this.Root.SidePanel;e&&e.SidePanelElement&&d.context(e.SidePanelElement).Visible&&e.toggleVisibility()}},o.prototype.isElementInSidePanel=function(){return void 0===this.elementInSidePanel&&(this.elementInSidePanel=!1,this.element.parentElement&&this.element.parentElement.parentElement&&this.element.parentElement.parentElement.classList.contains("SidePanel")&&(this.elementInSidePanel=!0)),this.elementInSidePanel},o);function o(){var o=null!==a&&a.apply(this,arguments)||this;return o.mouseUp=function(e){if(o.element){var t=o.element.querySelector(".selecting");t&&t.classList.remove("selecting"),o.element.setAttribute("data-dyn-focus",".selected")}o.mouseUpAdded=!1,d.util.isEventListenerOptionsSupported()||document.body.removeEventListener("mouseup",o.mouseUp,!0)},o}(e.Tree=t).prototype.CascadeSelect=!0,t.prototype.Border="Auto",t.prototype.RootNodeId=null,t.prototype.SetSelection=null,t.prototype.ExpandTree=null,t.prototype.CheckBox=!1,t.prototype.EditLabels=!1,t.prototype.Editing=!1,t.prototype.HasButtons=!1,t.prototype.TreeNodes=null,t.prototype.Expanding=null,t.prototype.SelectionChanged=null,t.prototype.SingleSelect=!1,t.prototype.NodeNameChanged=null,t.prototype.NodeChecked=null,t.prototype.TransitStateSubscriptionId=null,t.prototype.Nodes=null,d.ui.addObservablePropertiesToPrototype(t.prototype,{TreeNodes:null})}(d.controls||(d.controls={})),e=d.ui||(d.ui={}),(t=e.TreeCommands||(e.TreeCommands={}))[t.Delete=0]="Delete",t[t.Add=1]="Add",t[t.Edit=2]="Edit",(o=e.CheckedState||(e.CheckedState={}))[o.Unchecked=0]="Unchecked",o[o.Checked=1]="Checked",o[o.Partial=2]="Partial",n=e.Tree||(e.Tree={}),(i=n.ExpandAction||(n.ExpandAction={}))[i.Collapse=1]="Collapse",i[i.Expand=2]="Expand",(r=n.HowSelected||(n.HowSelected={}))[r.Unknown=0]="Unknown",r[r.ByMouse=1]="ByMouse",r[r.ByKeyboard=2]="ByKeyboard",(a=n.SelectionAction||(n.SelectionAction={}))[a.Single=0]="Single",a[a.Append=1]="Append",a[a.Range=2]="Range",(s=n.NavigationDirection||(n.NavigationDirection={}))[s.Up=1]="Up",s[s.Down=2]="Down",(l=n.AccessibilityAction||(n.AccessibilityAction={}))[l.SelectionChanged=1]="SelectionChanged",l[l.ExpandedChanged=2]="ExpandedChanged",l[l.CheckedStateChanged=3]="CheckedStateChanged"}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(e){var t,o,n,i;function r(){return null!==n&&n.apply(this,arguments)||this}t=e.DynReact||(e.DynReact={}),o=t.UI||(t.UI={}),n=React.Component,__extends(r,n),r.prototype.render=function(){return React.createElement("div",{className:"list-No-Rows-Indicator"},React.createElement("span",{tabIndex:0},this.props.EmptyTreeText))},i=r,o._EmptyTreeIndicator=i}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};!function(i){var e;(function(e){Globalize.addCultureInfo("en",{messages:{Input_TreeItemMixedState:"{0} mixed"}});var t,o=(t=React.Component,__extends(n,t),n.prototype.shouldComponentUpdate=function(e,t){return!!e.node.renderPending},n.prototype.componentDidUpdate=function(e,t){e.node.renderPending=!1},n.prototype.componentWillMount=function(){if(this.props.node.Tree){var e=this.props.node.Tree.NodeData(this.NodeId());e||(e=this.props.node,this.props.node.Tree.SetNodeData(this.NodeId(),e)),e&&(e.ReactNode=this)}},n.prototype.componentDidMount=function(){this.fixExpandedAttribute(this.HasChildren(),this.Expanded()),!0===this.Selected()&&this.props.node.Tree&&this.props.node.Tree.AddSelection(this)},n.prototype.render=function(){var e,t,o=this.assignClass();return React.createElement("li",__assign({className:o.nodeClasses,ref:"nodeElement","aria-expanded":this.state.isExpanded,"data-expanded":this.state.isExpanded,"data-selected":this.state.isSelected,"aria-selected":this.state.isSelected},this.props.node.hasCheckBox&&{"aria-checked":1===this.CheckedState()?"true":"false"},{role:"treeitem","data-dyn-id":this.NodeId(),"data-dyn-parentid":this.ParentId(),"data-dyn-index":this.props.node.index,"aria-setsize":this.props.node.siblingSize,"aria-posinset":this.GetPosition(),"aria-label":this._getAriaLabelForTreeNode(),tabIndex:this.state.isSelected?0:-1,"aria-level":this.props.node.ariaLevel}),React.createElement("div",{className:"treeView-treeItem-header",onClick:this.itemClick},React.createElement("button",{type:"button",className:"treeView-treeExpandCollapse",title:i.label("Group_ExpandOrCollapse"),role:"button",onClick:this.buttonClick,tabIndex:-1,"aria-hidden":!this.state.hasChildren||null}),React.createElement("span",{role:"checkbox",className:o.checkBoxClasses,title:i.label("Tree_SelectCheckBoxName"),onClick:this.checkBoxClick,tabIndex:-1,"data-checked":this.CheckedString(),"aria-checked":1===this.CheckedState()?"true":2===this.CheckedState()&&"mixed"}),this.state.isReadOnly?React.createElement("span",{className:o.labelClasses,ref:"inputItem",title:this.state.nodeName,tabIndex:-1},this.state.nodeName):React.createElement("input",{className:o.labelClasses,ref:"inputItem",onChange:this.handleNameChange,onBlur:this.commitChange,value:this.state.nodeName,size:25,tabIndex:-1})),0<(null===(t=null===(e=this.props.node)||void 0===e?void 0:e.Nodes)||void 0===t?void 0:t.length)?React.createElement(i.DynReact.UI._TreeNodeContainer,{Nodes:this.props.node.Nodes,didUpdate:this.props.didUpdate}):null)},n.prototype.NodeId=function(){return this.props.node.Id},n.prototype.Expanded=function(e){return void 0!==e&&this.props.node.Expanded!==e&&(this.props.node.Expanded=e,this.props.node.renderPending=!0,e&&this.props.node.isDirty&&(this.props.node.Nodes=this.props.node.AllNodes,this.props.node.Nodes.forEach(function(e){e.renderPending=!0}),this.props.node.isDirty=!1),this.fixExpandedAttribute(this.HasChildren(),e)),this.props.node.Expanded},n.prototype.CheckedState=function(e){return void 0!==e&&this.props.node.CheckedState!==e&&(this.props.node.renderPending=!0,this.props.node.CheckedState=e,this.setState({checkedState:e})),this.props.node.CheckedState},n.prototype.NodeData=function(){return this.props.node},n.prototype.Selected=function(e,t){if(void 0!==e&&this.props.node.Selected!==e){if(this.props.node.Selected=e,this.props.node.renderPending=!0,this.props.node.Tree&&(t||(e?this.props.node.Tree.AddSelection(this):this.props.node.Tree.RemoveSelection(this)),e&&(!this.props.node.Tree.Root||this.props.node.Tree.Root.ActiveControl()===this.props.node.Tree.Name))){var o=this.NodeElement();o&&o.focus();var n=this.InputElement();n&&n.scrollIntoViewIfNeeded()}this.setState({isSelected:e})}return this.props.node.Selected},n.prototype.InputElement=function(){return this.refs.inputItem},n.prototype.ParentId=function(){return this.props.node.ParentId},n.prototype.HasChildren=function(e){return void 0!==e&&this.props.node.HasChildren!==e&&(this.props.node.renderPending=!0,this.props.node.HasChildren=e,this.fixExpandedAttribute(e,this.Expanded()),this.setState({hasChildren:e})),this.props.node.HasChildren},n.prototype.ChildCount=function(){return this.props.node.AllNodes.length},n.prototype.GetChild=function(e){var t;return 0<=e&&e<this.ChildCount()&&(t=this.props.node.AllNodes[e].ReactNode),t},n.prototype.GetChildren=function(){return this.props.node.AllNodes},n.prototype.startRename=function(){this.Readonly(!1);var e=this.InputElement();this.originalValue=e&&e.value?e.value.trim():"",e.focus()},n.prototype.CheckedString=function(){var e=this.CheckedState();return 2===e?"mixed":1===e?"true":"false"},n.prototype._getAriaLabelForTreeNode=function(){var e=this.state.nodeName;return 2===this.CheckedState()&&(e=i.format(i.label("Input_TreeItemMixedState"),e)),e},n.prototype.name=function(e){return void 0!==e&&this.props.node.name!==e&&(this.props.node.renderPending=!0,this.props.node.name=e,this.setState({nodeName:e})),this.props.node.name},n.prototype.fixExpandedAttribute=function(e,t){this.NodeElement(),e&&"false"!=e?this.setState({isExpanded:t}):this.setState({isExpanded:void 0})},n.prototype.Bold=function(e){return void 0!==e&&this.props.node.Bold!==e&&(this.props.node.renderPending=!0,this.props.node.Bold=e,this.setState({isBold:e})),this.props.node.Bold},n.prototype.ImageName=function(e){return void 0!==e&&this.props.node.ImageName!==e&&(this.props.node.ImageName=e),this.props.node.ImageName},n.prototype.ImageType=function(e){return void 0!==e&&this.props.node.ImageType!==e&&(this.props.node.ImageType=e),this.props.node.ImageType},n.prototype.AltText=function(e){return void 0!==e&&this.props.node.AltText!==e&&(this.props.node.AltText=e),this.props.node.AltText},n.prototype.Readonly=function(e){return void 0!==e&&(this.props.node.renderPending=!0,e?this.setState({isReadOnly:e}):this.setState({isReadOnly:void 0})),this.state.isReadOnly},n.prototype.InsertAfterId=function(){return this.props.node.InsertAfterId},n.prototype.GetPosition=function(){return this.props.node.index+1},n.prototype.GetSiblingSize=function(){return this.props.node.siblingSize},n.prototype.NodeElement=function(){return this.refs.nodeElement},n.prototype.unbindHandlers=function(e){var t=$(this.InputElement());t.length&&t.off("focusout",this.rollbackChange),this.Readonly(!0),e.preventDefault(),e.stopPropagation()},n.prototype.assignClass=function(){return{checkBoxClasses:["treeView-checkbox"].join(" "),labelClasses:["treeView-treeItemLabel",this.state.isBold?"treeView-treeItemLabel-Bold":null].join(" "),nodeClasses:["treeView-treeItem",this.state.isSelected?"selected":null].join(" ")}},n);function n(e){var o=t.call(this,e)||this;return o.commitChange=function(e){o.unbindHandlers(e);var t=o.state.nodeName;o.name(t),o.props.node.Tree&&(o.props.node.Tree.ApplyRename(!0,t,o.originalValue,o.NodeId()),o.originalValue=t)},o.rollbackChange=function(e){o.setState({nodeName:o.originalValue}),o.unbindHandlers(e),o.props.node.Tree&&o.props.node.Tree.ApplyRename()},o.itemClick=function(e){o.props.node.Tree&&o.props.node.Tree.ClickNode(o,e)},o.buttonClick=function(e){if(o.props.node.Tree&&o.HasChildren()){o.props.node.Tree.ButtonClick(o,e);var t=o.NodeElement();t&&t.focus()}},o.checkBoxClick=function(e){if(o.props.node.Tree){o.props.node.Tree.CheckBoxClick(o,e);var t=o.NodeElement();t&&t.focus()}},o.handleNameChange=function(e){o.props.node.renderPending=!0,o.setState({nodeName:e.target.value})},o.state={checkedState:o.props.node.CheckedState,hasChildren:o.props.node.HasChildren,isBold:o.props.node.Bold,isExpanded:o.props.node.Expanded,isReadOnly:!0,isSelected:o.props.node.Selected,nodeName:o.props.node.name},o}e.TreeNode=o})((e=i.DynReact||(i.DynReact={})).UI||(e.UI={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(i){var e,t,o,n;function r(){return null!==o&&o.apply(this,arguments)||this}e=i.DynReact||(i.DynReact={}),t=e.UI||(e.UI={}),o=React.Component,__extends(r,o),r.prototype.componentDidUpdate=function(){var e,t;null!==(t=(e=this.props).didUpdate)&&void 0!==t&&t.call(e)},r.prototype.componentDidMount=function(){var e,t;null!==(t=(e=this.props).didUpdate)&&void 0!==t&&t.call(e)},r.prototype.render=function(){return React.createElement("ul",{className:"treeView-treeItem-children",style:{listStyleType:"none"},tabIndex:-1,role:"tree","aria-multiselectable":"true"},this.renderTreeNodes(this.props.Nodes))},r.prototype.renderTreeNodes=function(e){for(var t,o=[],n=0;n<e.length;n++)e[n].index===n&&e[n].siblingSize===e.length||(e[n].index=n,e[n].siblingSize=e.length,e[n].hasCheckBox=!(!e[n].Tree||!e[n].Tree.CheckBox)&&i.value(e[n].Tree.CheckBox),e[n].renderPending=!0,e[n].ParentId&&e[n].Tree&&e[n].Tree.idMap&&(t=e[n].Tree.idMap[e[n].ParentId]),t&&t.ariaLevel?e[n].ariaLevel=t.ariaLevel+1:e[n].ariaLevel=1),o.push(React.createElement(i.DynReact.UI.TreeNode,{key:e[n].Id,node:e[n],didUpdate:this.props.didUpdate},this.renderTreeNodes(e[n].Nodes)));return o},n=r,t._TreeNodeContainer=n}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(a){!function(e){Globalize.addCultureInfo("en",{messages:{ProgressBarValue:"Current value {0} out of {1}"}});var r,t=(r=a.ui.Control,__extends(o,r),o);function o(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return i.Percent=a.computed(function(){var e=a.value(i.Value),t=a.value(i.MinimumValue),o=a.value(i.MaximumValue);return t<o?(i._percentageComplete=Math.round((e-t)/(o-t)*100),100<i._percentageComplete?i._percentageComplete=100:i._percentageComplete<0&&(i._percentageComplete=0)):i._percentageComplete=0,i._percentageComplete}),a.observe(i.Value,function(e){var t=a.value(i.MinimumValue),o=a.value(i.MaximumValue);o-t<0&&a.error({Message:a.label("Maximum value less than Minimum value"),Label:"Maximum value less than Minimum value"},i),e-t<0&&a.error({Message:a.label("Value is less than Minimum value"),Label:"Value is less than Minimum value"},i),0<e-o&&a.error({Message:a.label("Value is greater than Maximum value"),Label:"Value is greater than Maximum value"},i),i.element.setAttribute("aria-busy","true"),i.element.setAttribute("aria-label",a.format(a.label("ProgressBarValue"),e,o)),i.element.setAttribute("aria-busy","false"),e?i.element.setAttribute("aria-live","assertive"):i.element.removeAttribute("aria-live")}),i}(e.ProgressBar=t).prototype.IsIndeterminate=!1,t.prototype.MaximumValue=100,t.prototype.MinimumValue=0,t.prototype.StepValue=1,t.prototype.Value=0}(a.controls||(a.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(a){!function(e){Globalize.addCultureInfo("en",{messages:{StateMachine_StageStatus:"{0} ({1})"}});var r,t=(r=a.ui.Control,__extends(o,r),o);function o(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return i.Select=function(e){i.SelectedStageIndex(e)},i.IsSelected=function(e){return i.SelectedStageIndex()===e},i.StageText=function(){var e=i.SelectedStage();if(e)return a.format(a.label("StateMachine_StageStatus"),e.State,e.StageState.TransitionDate)},a.async(function(){a.applyFunction(i.LoadData,i)},void 0,"StateMachine load data"),i.SelectedStageIndex=a.observable(0),i.SelectedStage=a.computed(function(){var e=i.SelectedStageIndex(),t=a.value(i.Stages);if(t)return t[e]}),i}(e.StateMachineStage=t).prototype.DataSourceRecId=0,t.prototype.Label="",t.prototype.LoadData=null,t.prototype.Stages=null,t.prototype.StateMachineName=""}(a.controls||(a.controls={}))}($dyn=$dyn||{}),function(){Globalize.addCultureInfo("en",{messages:{List_DefaultCheckBoxText:"Select Rows ",List_DefaultHeaderCheckBoxText:"Mark all rows",List_NoResultsMessage:"We didn't find anything to show here.",List_LoadingMoreData:"Loading more data...",List_IncSortNumber:"Sort smallest to largest",List_DecSortNumber:"Sort largest to smallest",List_IncSortTime:"Sort oldest to newest",List_DecSortTime:"Sort newest to oldest",List_IncSortString:"Sort A to Z",List_DecSortString:"Sort Z to A",List_IncSortEnum:"Sort first to last",List_DecSortEnum:"Sort last to first",List_ColumnNotFilterable:"Column is not filterable.",List_ResultsMessage:"Results found",Grid_Next:"Next",Grid_Previous:"Previous",Grid_MoveToFirstMarkedRowShortCut:"Move to the first selected row",Grid_MoveToLastMarkedRowShortCut:"Move to the last selected row",Grid_MoveToNextMarkedRowShortCut:"Move to the next selected row",Grid_MoveToPreviousMarkedRowShortCut:"Move to the previous selected row",Grid_NextRowShortcut:"Move to the next row.",Grid_NextRowNewLineShortcut:"Create a new row at the bottom of the grid.",Grid_NextRowToSelectedSetShortcut:"Add the next row to the selected set",Grid_NextRowButNotSelectShortcut:"Move to the next row without selecting",Grid_PreviousRowShortcut:"Move to the previous row.",Grid_PreviousRowToSelectedSetShortcut:"Add the previous row to the selected set",Grid_PreviousRowButNotSelectShortcut:"Move to the previous row without selecting",Grid_PreviousPageShortcut:"Go to the previous page of data",Grid_NextPageShortcut:"Go to the next page of data",Grid_CurrentRowSelectionShortcut:"Select the current row",Grid_CurrentRowClearShortcut:"Clear the current row",Grid_SelectAllRowsShortcut:"Select all rows",Grid_ClearAllRowsShortcut:"Clear all rows",Grid_OpenGridFilterShortCut:"Open grid filtering for the current column",Grid_FocusColumnHeaderShortCut:"Move to the header of the current column",Grid_FocusActiveRowShortcut:"Move focus to the active row",Grid_GrowColumn:"Make column wider",Grid_ShrinkColumn:"Make column narrower",ListHeader_RegionTitle:"Header Region",Framework_CheckedStatus:"Checked",Framework_UncheckedStatus:"Unchecked"}}),$dyn.util.headerSkip=function(e,t){return $dyn.computed(function(){return $dyn.value(e.Skip)||!$dyn.value(t.AllowHeaderFocus)})},$dyn.util.markAllSkip=function(e){return $dyn.ui.controlOptions(function(){return{skip:!$dyn.util.isEnhancedTabSequenceEnabled()||!e.AllowHeaderFocus()}},e)},$dyn.ui.ListMode={tabular:"Tabular",list:"List"},$dyn.util.SyncEngineState={inactive:$dyn.debug.general?"inactive":0,active:$dyn.debug.general?"active":1},$dyn.util.InfiniteScrollMode={slow:$dyn.debug.general?"slow":0,fast:$dyn.debug.general?"fast":1},function(){if($dyn.debug.general){var e=document.createElement("style");document.head.appendChild(e),e.type="text/css";var t=document.createTextNode('.listCell[data-dyn-validating="true"] { background-color: #eaeaea; }');e.appendChild(t)}}();var s=$dyn.ui.selector;$dyn.ui.KeyCodes,$dyn.ui.InputType;$dyn.controls.List=function(e,u,t){var y,f=this,d=$(u);f.ForEachRenderCount=$dyn.observable(0),f.isContainer=!0,f._isCardList=void 0,f.PageSize=25,f.elementInSidePanel=void 0,f.activeRowDefaultCellId=$dyn.observable(""),f._processServerChanges=$dyn.observable(!0),f._fastEdit=$dyn.observable(!1),f._allResourcesLoaded=$dyn.observable(!0),$dyn.ui.Control.apply(this,arguments),f.usingDisposable($dyn.observe(f.FastEdit,function(e){$dyn.ax&&$dyn.ax.taskRecording?f._fastEdit(($dyn.debug.gridFastEdit||e)&&!$dyn.peek($dyn.ax.taskRecording.taskGuidePlaybackState)):f._fastEdit($dyn.debug.gridFastEdit||e)})),$dyn.ax&&$dyn.ax.taskRecording&&f.usingDisposable($dyn.observe($dyn.ax.taskRecording.taskGuidePlaybackState,function(e){e&&f._fastEdit()&&f._fastEdit(!1),e||f._fastEdit($dyn.debug.gridFastEdit||$dyn.peek(f.FastEdit))})),f.LayoutMinWidth={minSizeFunction:$dyn.layout.gridLayoutMinWidth,cssClassArgument:"listRoot"},f.LayoutMinHeight={minSizeFunction:$dyn.layout.gridLayoutMinHeight,cssClassArgument:"listRoot"},$dyn.isObservable(f.SelectedIndex)||(f.SelectedIndex=$dyn.observable(f.SelectedIndex)),$dyn.isObservable(f.GridLines)||(f.GridLines=$dyn.observable(f.GridLines)),$dyn.isObservable(f.MarkedIndexes)||(f.MarkedIndexes=$dyn.observable(f.MarkedIndexes||[])),$dyn.isObservable(f.MarkAllRecords)||(f.MarkAllRecords=$dyn.observable(f.MarkAllRecords)),f.ChildHierarchy=this._rowElementGenerator(u),f._listBodyElement=$(".listBody",this.element)[0],f._dataProvider=new $dyn.controls.List.DataProvider({PropertyBag:this,GetDataId:f.GetDataId,GetDataVersion:f.GetDataVersion}),f._syncManager=new $dyn.controls.List.SyncManager(f,f._dataProvider),f._renderer=new $dyn.controls.List.Renderer(f,{dataProvider:f._dataProvider,syncEngineState:f._syncManager._syncEngineState,rowSyncState:f._syncManager.rowSyncState,invalidRow:f._syncManager.invalidRow,rowHasPendingEdit:f._syncManager.rowHasPendingEdit.bind(f._syncManager),listBody:f._listBodyElement,markAllRecords:f.MarkAllRecords}),f._dataProvider.rowIdByPageIndexGetter=f._renderer.getRowIdByActivePageIndex.bind(f._renderer),f._rowOperationsManager=new $dyn.controls.List.RowOperationsManager(f,f._dataProvider,f._renderer,f._syncManager),f._renderer.setActiveCell(f._rowOperationsManager.getActiveCell()),f._editManager=new $dyn.controls.List.EditManager({element:this._listBodyElement,syncManager:this._syncManager,renderer:this._renderer,getSelectedRow:function(){return f._selectedRow},allowEdit:this.AllowEdit}),f.fastEditingAllowed=$dyn.computed(f._fastEditingAllowed,void 0,f),f._surroundingBlockingDivShown=!1,f._syncQueueEmptySubscription=null,f._tabbingContainerDispose=null,f.usingDisposable($dyn.observe(f.fastEditingAllowed,function(e){e&&!f._syncQueueEmptySubscription&&(f._syncQueueEmptySubscription=$dyn.observe(f._syncManager.isQueueEmpty,function(e){e||f._surroundingBlockingDivShown||(f.SurroundingBlockingDiv.show(f.allowedElements),f._tabbingContainerDispose=$dyn.util.tabbingContainer(f.element),f._surroundingBlockingDivShown=!0),e&&f._surroundingBlockingDivShown&&(f.SurroundingBlockingDiv.hide(),f.SurroundingBlockingDiv.removeClass("fastEditRailsMode"),f._tabbingContainerDispose(),f._surroundingBlockingDivShown=!1)})),!e&&f._syncQueueEmptySubscription&&(f._surroundingBlockingDivShown&&(f.SurroundingBlockingDiv.hide(),f.SurroundingBlockingDiv.removeClass("fastEditRailsMode"),f._tabbingContainerDispose(),f._surroundingBlockingDivShown=!1),f._syncQueueEmptySubscription.dispose(),f._syncQueueEmptySubscription=null)})),f._isLoading=$dyn.computed(f._getIsLoading,null,this),f.ChildHierarchy.valueChanged.subscribe(function(e){$dyn.log.list&&$dyn.log.list("List: Inactive row schema changed"),f._resetCachedInactiveItemElement($dyn.value(e)[0]),f._rerenderOptions($dyn.peek(f._rerenderOptions)+1)}),f._headerRowElement=this.element&&this.element.querySelector(".listAsTable-HeaderRow"),f._noRowsIndicator=this.element&&this.element.querySelector(".list-No-Rows-Indicator"),f._inactiveItem=$dyn.observable(),f.dataSourceName=$dyn.observable("");var o,n,i,b={};f.ColumnHeaderMetadata=$dyn.computed(function(){var h=$dyn.value(u.dynChildren),m=[],v={},g={},e=null;return h.length&&(e=$dyn.value(h[0].dynChildren)),e&&e.length&&$.each(e,function(e,t){var o,n,i,r,a,s=$dyn.ui.getObservableProperty,l=$dyn.role(h[0]).getChildRole(t),u=$dyn.context(t);if(!l.isDataBound()&&u&&$dyn.log("Role %o at index %i for control %s not databound yet",l,e,t.getAttribute("data-dyn-controlname")),u){if(o=u.Name,r=y&&y[o],i=b[o],a=r&&r.Version,o&&(g[o]=u),u===i)n=r;else{var d=s(u,"Enabled");$dyn.value(d);var c=s(u,"Width");$dyn.value(c),n={FormDataSourceName:s(u,"DataSourceName"),IsImage:u.IsImage,IsNumber:u.IsNumber,Name:o,Visible:s(u,"Visible"),Enabled:d,Alignment:s(u,"Alignment"),IsFiltered:s(u,"IsFiltered"),IsSorted:s(u,"SortDirection"),IsPrimarySort:s(u,"IsPrimarySort"),Label:f.getColumnLabel(s(u,"Label"),u.Name,s(u,"ShowLabel")),Width:c,IsFilterable:f.getFilterability(s(u,"IsFilterable"),s(u,"FieldName"),f.DataSource),FieldName:s(u,"FieldName"),IsSortable:s(u,"IsFilterable"),ControlType:s(u,"TypeName"),IsLookupField:s(u,"LookupButton"),IsBound:!0,HelpText:s(u,"HelpText"),Skip:s(u,"Skip"),Version:void 0!==a?a+1:1,ExecutePersonalizationCommand:s(u,"ExecutePersonalizationCommand"),PersistPersonalization:s(u,"PersistPersonalization"),Required:s(u,"Required")}}if(n.FilteringFields=[],"ReferenceGroup"==u.TypeName)n.IsLookupField=!0,$dyn.value(u.Children).forEach(function(e){var t={IsFilterable:f.getFilterability(s(e,"IsFilterable"),s(e,"FieldName"),f.DataSource),FormDataSourceName:s(e,"DataSourceName"),FieldName:s(e,"FieldName"),ControlType:e.TypeName,Visible:s(e,"Visible"),Label:f.getColumnLabel(s(e,"Label"),e.Name,s(e,"ShowLabel")),Name:e.Name};n.FilteringFields.push(t)});else if("SegmentedEntry"==u.TypeName){var p={IsFilterable:f.getFilterability(s(u,"IsFilterable"),s(u,"FieldName"),f.DataSource),FormDataSourceName:u.ReferenceValueDataSourceName,FieldName:u.ReferenceValueDataSourceFieldName,ControlType:u.TypeName,Visible:s(u,"Visible"),Label:f.getColumnLabel(s(u,"Label"),u.Name,s(u,"ShowLabel")),Name:u.Name};n.FilteringFields.push(p)}else{p={IsFilterable:f.getFilterability(s(u,"IsFilterable"),s(u,"FieldName"),f.DataSource),FormDataSourceName:s(u,"DataSourceName"),FieldName:s(u,"FieldName"),ControlType:u.TypeName,Visible:s(u,"Visible"),Label:f.getColumnLabel(s(u,"Label"),u.Name,s(u,"ShowLabel")),Name:u.Name};n.FilteringFields.push(p)}}else o=t.getAttribute("data-dyn-controlname"),a=(r=y&&y[o])&&r.Version,n=r&&!1===r.IsBound?r:{FormDataSourceName:f.DataSourceName,IsImage:!1,IsNumber:!1,Name:o,IsFiltered:$dyn.observable(!1),IsSorted:$dyn.observable(-1),IsPrimarySort:$dyn.observable(!1),Visible:!0,Enabled:void 0,Alignment:void 0,Label:void 0,Width:void 0,IsFilterable:$dyn.observable(!1),FieldName:"",ControlType:"",IsLookupField:!1,IsBound:!1,Skip:void 0,Version:void 0!==a?a+1:1},o&&(g[o]=void 0);$dyn.value(n.Visible)&&m.push(n),o&&(v[o]&&$dyn.logError("List: Duplicate control, name=%s",o),v[o]=n)}),y=v,b=g,m}),f.RenderedHeaderMetadata=$dyn.observable(),f.ListBoxIdentifier="lb-"+f.Name+(f.Root?"_"+f.Root.Id:""),f._rerenderOptions=$dyn.observable(0),f.rerender=function(){f._rerenderOptions($dyn.peek(f._rerenderOptions)+1)},f._dataChangedVersion=$dyn.observable(0),f.dataChanged=function(){f._dataChangedVersion($dyn.peek(f._dataChangedVersion)+1)},$dyn.observe(function(){var e=u?$dyn.value(u.dynChildren):null,t=[],o=null;if(e&&e.length&&0<e.length){var n=e[0],i=$dyn.role(n),r=$dyn.context(n);i&&!i.isDataBound()&&r&&$dyn.log.list&&$dyn.log.list("Role %o not databound yet",i),o=$dyn.value(e[0].dynChildren)}if(o&&o.length)for(var a=0;a<o.length;a++){var s=$dyn.role(e[0]),l=o[a];i=s.getChildRole(l),r=$dyn.context(l);!i.isDataBound()&&r&&$dyn.log.list&&$dyn.log.list("Role %o at index %i for control %s not databound yet",i,a,l.getAttribute("data-dyn-controlname")),r&&t.push($dyn.value(r.Visible))}return t},function(e){e&&0<e.length&&f.rerender()}),f._densityChangeHandler=function(e,t){d.addClass("layoutPending"),f.RowHeightInPixels=t,f.ScrollbarSizeInPixels=2*t/3},$(document).on("densitychanged",f._densityChangeHandler),f.IsNoResultsMessageDisplayed=$dyn.computed(function(){return 0===$dyn.length(f.DataSource)}),f.getNoRowIndicator=function(){return f._noRowsIndicator&&f._noRowsIndicator.getElementsByClassName("list-No-Rows-IndicatorImage")},f.focusNoRowIndicator=function(){if(f._noRowsIndicator){var e=f._noRowsIndicator.getElementsByClassName("list-No-Rows-IndicatorImage")[0];e&&e.focus()}},f.HasRecords=$dyn.computed(function(){return 0<$dyn.length(f.DataSource)}),f.AllowHeaderFocus=$dyn.observable(!1),f.NoResultImage=$dyn.shell.rootPath.concat("resources/images/emptyGrid.svg"),f.ShowHeader=$dyn.computed(function(){return $dyn.value(f.Mode)===$dyn.ui.ListMode.tabular&&$dyn.value(f.IsHeaderVisible)}),f.ArePagingButtonsVisible=$dyn.computed(function(){var e=!0;return!$dyn.value(f.InfiniteScroll)&&$dyn.value(f.IsPagingSupported)&&!f.HasSinglePage()||(e=!1),e}),f.SyncHorizontalScrollFromHeader=function(){if(o=o||u.getElementsByClassName("scrollRegion")[0],n=n||u.getElementsByClassName("listHeader")[0],o&&n){var e=n.scrollLeft;i!==e&&(o.scrollLeft=e),i=e}},f.SyncHorizontalScrollOffset=function(){if(o=o||u.getElementsByClassName("scrollRegion")[0],n=n||u.getElementsByClassName("listHeader")[0],o&&n){var e=o.scrollLeft;if(i!==e){n.scrollLeft=e,$dyn.log.list&&$dyn.log.list("List: Sync offset from %s to %s",i,e);var t=d.find(".columnHeaderWrapper[aria-expanded='true']");if(t[0])$dyn.context(t[0])&&t[0].click()}i=e}},f.CalculateRowHeight=function(){return d.find(".listView .listItem").first().outerHeight()},f.GetSelectedRow=function(){return d.find(".listItem[data-dyn-row-active=true]")},f.headerLayoutTimer=null,f.incrementRenderCountOnHeaderLayout=!1,f.performHeaderLayout=function(e){$dyn.value(f.ShowHeader)&&!$dyn.value(f._dataLoadedRenderPending)&&(d.find(".table_header").layoutFloatingTableHeader(d.find(".TabularView")),f.incrementRenderCountOnHeaderLayout=!1)},f.postRenderInternal=function(e){if(f.element.setAttribute("aria-rowcount",$dyn.length(f.DataSource)),f.element&&f.ArePagingButtonsVisible()){var t=$(f.element).find(".pagingButtons");t&&t.css("width",f.GetScrollRegionWidth()+"px")}0<d.closest("[data-dyn-lastvisible='false']").length?e||d.addClass("layoutPending"):e&&!d.hasClass("layoutPending")||(d.removeClass("layoutPending"),f.ApplyAutoSizing(),$dyn.value(f.Mode)!==$dyn.ui.ListMode.tabular?f.ForEachRenderCount($dyn.value(f.ForEachRenderCount)+1):f.performHeaderLayout(!0),$dyn.applyFunction(f.PostRender,f))},f.getDataColumnContextsByIndex=function(i,r){var a=[],e=$dyn.value(u.dynChildren);return e.length&&jQuery.each(e,function(e,t){var o=$dyn.value(t.dynChildren);if(o){r&&(o=o.filter(function(e){var t=$dyn.context(e);return t&&$dyn.value(t.Visible)}));var n=o[i]}n&&a.push($dyn.context(n))}),a},f.findControlElementsInAllRows=function(e){return $('[data-dyn-controlname="'+e+'"]',d)},f.IsStaticRowHeightValid=function(){return 0===d.find(".listItem").last().find(".customCellHeight").length},f.OnScroll=function(e){f.SyncHorizontalScrollOffset(),f._scrollHandler?f._scrollHandler(e):f.UpdateScrollTop(),f._onScrollHandled&&f._onScrollHandled()},f.RowClicked=function(e){f._renderer.setUserActionBusy(),f._rowOperationsManager.RowClicked(e)},f.RowKeyDown=function(e){$dyn.log.list&&$dyn.log.list("List: Row Key Down"),f._renderer.setUserActionBusy(),$dyn.util.handleShortcuts(this,e),f._surroundingBlockingDivShown&&e.originalEvent&&!1!==e.originalEvent.IgnoreShortcuts&&(e.originalEvent.IgnoreShortcuts=!0)},f.RowKeyUp=function(e){$dyn.util.isShortcutKeyPressed(e,{alt:!1,keyCode:$dyn.ui.KeyCodes.downArrow})&&(f.downArrowKeyUpTriggered=!0)},f.BlockingDivAllowedKeyDown=function(e){$dyn.log.list&&$dyn.log.list("List: Entered BlockingDivAllowedKeyDown handler"),f.RowKeyDown(e),$dyn.log.list&&$dyn.log.list("List: Leaving BlockingDivAllowedKeyDown handler")},f.HeightOverride=$dyn.observable(!1),f.CachedScrollRegionHeight,f.CachedScrollRegionTop,f.scrollRegion,f.WindowResizeHandler=function(){f.UpdateScrollRegionWidth(),f.UpdateScrollRegionHeight(),f._reevaluateSurroundingBlockingDiv(),f._resizeHandler&&f._resizeHandler()},f.ApplyAutoSizing=function(){var u=f.GetScrollRegion();u&&$dyn.observe($dyn.options(function(){return{layoutHeight:f.LayoutHeight,visibleRows:f.VisibleRowCount,rowHeight:f.RowHeightInPixels,scrollbarSize:f.ScrollbarSizeInPixels,override:f.HeightOverride}},$dyn.ui.updating),function(e){var t=e.layoutHeight.toLowerCase(),o=e.override;u.__layoutHeight&&u.__layoutHeight!==t||u.__layoutHeightOverride&&u.__layoutHeightOverride!==o?u.style.height=null:(u.__layoutHeight=t,u.__layoutHeightOverride=o);var n="auto"==t||"sizetocontent"==t||o?e.visibleRows:0,i=$dyn.densityThemeManager._defaultDensity;if($dyn.user){var r=$dyn.user();r&&r.Density&&(i=$dyn.value(r.Density))}var a=(e.rowHeight||i)+3,s=e.scrollbarSize||2*i/3;if(!f.IsStaticRowHeightValid()||$dyn.value(f.Mode)===$dyn.ui.ListMode.list){var l=d.find(".listItem").last();0<l.length&&(a=l[0].offsetHeight)}0<n&&0!=a&&f.SetScrollRegionHeight(a*n+s)})},f.GetFirstMarkedRow=function(){var e=f.MarkedIndexes();if(e)for(var t=0;t<e.length;++t)if(e[t])return t},f.GetLastMarkedRow=function(){var e=f.MarkedIndexes();if(e)for(var t=e.length-1;0<=t;--t)if(e[t])return t},f.GetPreviousMarkedRow=function(){var e=f.MarkedIndexes();if(e)for(var t=f.getActiveRowClientIndex(),o=t-1;o!=t;){if(e[o])return o;--o<0&&(o=e.length-1)}},f.GetNextMarkedRow=function(){var e=f.MarkedIndexes();if(e)for(var t=f.getActiveRowClientIndex(),o=t+1;o!=t;){if(e[o])return o;++o>=e.length&&(o=0)}}},$dyn.controls.List.prototype=$dyn.ui.extendPrototype($dyn.ui.Control.prototype,{IsSelectionIndicatorVisible:!0,IsHeaderVisible:!0,DataSource:null,FastEdit:!1,NavigationEnabled:!1,ForcePrimaryNavigation:!1,NavigationAction:null,AllowCreateOnKeyDown:void 0,ShowHeader:!0,ShowSelection:!0,SelectedIndex:void 0,FetchedDataStartPosition:0,CacheSize:0,DataAbove:!1,DataBelow:!1,Virtualized:!1,LoadPreviousPage:null,LoadNextPage:null,ExportAllowed:!0,ExportLabel:"",ExportToExcel:null,MarkAllRecords:!1,MarkedIndexes:null,IsMarkingEnabled:!0,RowHeightInPixels:null,ScrollbarSizeInPixels:null,VisibleRowCount:0,VisibleColumnCount:0,Mode:$dyn.ui.ListMode.tabular,IsPagingSupported:!0,doNotScrollIntoView:!1,InfiniteScroll:!1,ForceInvisibleRender:!1,GroupBy:"",PreRender:null,PostRender:null,GetDataVersion:null,GetDataId:null,AsyncRender:!0,ShowRowLabels:!1,GridLines:$dyn.ui.GridLines.Auto,OriginatingType:"",_selectedRow:void 0,_rangePivot:null,_initialDataStartPosition:null,_rangeSelection:!1,_markingAction:null,_densityChangeHandler:null,clientCacheStart:void 0,clientLastStartPosition:void 0,clientLastEndPosition:void 0,prevScrollDirection:$dyn.ui.ScrollDirection.none,arrowKeyDownTriggered:void 0,downArrowKeyUpTriggered:void 0,mergeAbove:void 0,mergeBelow:void 0,_RowCountThresholdFraction:8,_skipOffsetParentCheck:!1,_renderTriggeredWhileHidden:!1,_defaultActionControl:void 0,InputMode:null,properties:{HideSelection:{defaultValue:!1,serialize:!0,invokeHandlers:!1}},_tabFocusing:!1,_tabFocused:!1,_reevaluateElements:!1,UpdateActiveItemBindings:!1,OverrideNoResultsMessage:void 0,getNoResultsMessage:function(){return void 0!==this.OverrideNoResultsMessage&&null!==this.OverrideNoResultsMessage?$dyn.value(this.OverrideNoResultsMessage):$dyn.label("List_NoResultsMessage")},getCommonGridContextMenuOptions:function(){var e=[];if(this.ExportToExcel&&$dyn.value(this.ExportAllowed)){var t={Label:$dyn.label("ContextMenu_ExportAllRows"),Command:this.ExecuteExportToExcel.bind(this,!1)};e.push(t),$dyn.callFunction(this.hasMarkedRows,this)&&(t={Label:$dyn.label("ContextMenu_ExportMarkedRows"),Command:this.ExecuteExportToExcel.bind(this,!0)},e.push(t))}return e},getContextMenuOptions:function(){var e=this.getCommonGridContextMenuOptions();return Array.prototype.push.apply(e,$dyn.ui.Control.prototype.getContextMenuOptions.apply(this)),e},Shortcuts:$dyn.extendPrototype($dyn.ui.Control.prototype.Shortcuts,{DownArrow:{Keys:{keyCode:$dyn.ui.KeyCodes.downArrow},Handler:function(e){if(!$dyn.value(this.Enabled)||$dyn.value(this.AllowHeaderFocus))return!1;var t=this.InputMode=$dyn.ui.InputType.keyboard,o=this._calculateMarkMode(e);return this.FocusRowRelativeToActiveRow(1,o,t,e,!0),!0},ShowToUser:function(){return $dyn.value(this.Enabled)&&!$dyn.value(this.AllowHeaderFocus)},Description:function(){return this._getListRowChangeShortCutDescription(this,$dyn.controls.List.prototype.Shortcuts.DownArrow.Keys)}},ShiftDownArrow:{Keys:{shift:!0,keyCode:$dyn.ui.KeyCodes.downArrow},Handler:function(e){if(!$dyn.value(this.Enabled)||$dyn.value(this.AllowHeaderFocus))return!1;var t=this.InputMode=$dyn.ui.InputType.keyboard,o=this._calculateMarkMode(e);return this.FocusRowRelativeToActiveRow(1,o,t,e,!0),!0},ShowToUser:function(){return $dyn.value(this.Enabled)&&!(this._isLastRow&&this._isLastRow())&&!$dyn.value(this.AllowHeaderFocus)},Description:function(){return this._getListRowChangeShortCutDescription(this,$dyn.controls.List.prototype.Shortcuts.ShiftDownArrow.Keys)}},CtrlDownArrow:{Keys:{ctrl:!0,keyCode:$dyn.ui.KeyCodes.downArrow},Handler:function(e){if(!$dyn.value(this.Enabled)||$dyn.value(this.AllowHeaderFocus))return!1;var t=this.InputMode=$dyn.ui.InputType.keyboard,o=this._calculateMarkMode(e);return this.FocusRowRelativeToActiveRow(1,o,t,e,!0),!0},ShowToUser:function(){return $dyn.value(this.Enabled)&&!(this._isLastRow&&this._isLastRow())&&!$dyn.value(this.AllowHeaderFocus)},Description:function(){return this._getListRowChangeShortCutDescription(this,$dyn.controls.List.prototype.Shortcuts.CtrlDownArrow.Keys)}},CtrlShiftDownArrow:{Keys:{ctrl:!0,shift:!0,keyCode:$dyn.ui.KeyCodes.downArrow},Handler:function(e){if(!$dyn.value(this.Enabled)||$dyn.value(this.AllowHeaderFocus))return!1;var t=this.InputMode=$dyn.ui.InputType.keyboard,o=this._calculateMarkMode(e);return this.FocusRowRelativeToActiveRow(1,o,t,e,!0),!0},ShowToUser:!1},UpArrow:{Keys:{keyCode:$dyn.ui.KeyCodes.upArrow},Handler:function(e){if(!$dyn.value(this.Enabled)||$dyn.value(this.AllowHeaderFocus))return!1;var t=this.InputMode=$dyn.ui.InputType.keyboard,o=this._calculateMarkMode(e);return this.FocusRowRelativeToActiveRow(-1,o,t,e,!0),!0},ShowToUser:function(){return $dyn.value(this.Enabled)&&!(this._isFirstRow&&this._isFirstRow())&&!$dyn.value(this.AllowHeaderFocus)},Description:function(){return this._getListRowChangeShortCutDescription(this,$dyn.controls.List.prototype.Shortcuts.UpArrow.Keys)}},ShiftUpArrow:{Keys:{shift:!0,keyCode:$dyn.ui.KeyCodes.upArrow},Handler:function(e){if(!$dyn.value(this.Enabled)||$dyn.value(this.AllowHeaderFocus))return!1;var t=this.InputMode=$dyn.ui.InputType.keyboard,o=this._calculateMarkMode(e);return this.FocusRowRelativeToActiveRow(-1,o,t,e,!0),!0},ShowToUser:function(){return $dyn.value(this.Enabled)&&!(this._isFirstRow&&this._isFirstRow())&&!$dyn.value(this.AllowHeaderFocus)},Description:function(){return this._getListRowChangeShortCutDescription(this,$dyn.controls.List.prototype.Shortcuts.ShiftUpArrow.Keys)}},CtrlUpArrow:{Keys:{ctrl:!0,keyCode:$dyn.ui.KeyCodes.upArrow},Handler:function(e){if(!$dyn.value(this.Enabled)||$dyn.value(this.AllowHeaderFocus))return!1;var t=this.InputMode=$dyn.ui.InputType.keyboard,o=this._calculateMarkMode(e);return this.FocusRowRelativeToActiveRow(-1,o,t,e,!0),!0},ShowToUser:function(){return $dyn.value(this.Enabled)&&!(this._isFirstRow&&this._isFirstRow())&&!$dyn.value(this.AllowHeaderFocus)},Description:function(){return this._getListRowChangeShortCutDescription(this,$dyn.controls.List.prototype.Shortcuts.CtrlUpArrow.Keys)}},CtrlShiftUpArrow:{Keys:{ctrl:!0,shift:!0,keyCode:$dyn.ui.KeyCodes.upArrow},Handler:function(e){if(!$dyn.value(this.Enabled)||$dyn.value(this.AllowHeaderFocus))return!1;var t=this.InputMode=$dyn.ui.InputType.keyboard,o=this._calculateMarkMode(e);return this.FocusRowRelativeToActiveRow(-1,o,t,e,!0),!0},ShowToUser:!1},AltShiftMF:{ChordKeys:{alt:!0,shift:!0,keyCode:$dyn.ui.KeyCodes.letterM},Keys:{keyCode:$dyn.ui.KeyCodes.letterF},Handler:function(e){if($dyn.value(this.AllowHeaderFocus))return!1;var t=this.InputMode=$dyn.ui.InputType.keyboard,o=$dyn.controls.List.MarkMode.none,n=this.GetFirstMarkedRow();return void 0!==n&&this.FocusRow(n,o,t,e,!0),!0},Description:$dyn.label("Grid_MoveToFirstMarkedRowShortCut"),Category:$dyn.ui.ShortcutCategory.Navigate},AltShiftML:{ChordKeys:{alt:!0,shift:!0,keyCode:$dyn.ui.KeyCodes.letterM},Keys:{keyCode:$dyn.ui.KeyCodes.letterL},Handler:function(e){if($dyn.value(this.AllowHeaderFocus))return!1;var t=this.InputMode=$dyn.ui.InputType.keyboard,o=$dyn.controls.List.MarkMode.none,n=this.GetLastMarkedRow();return void 0!==n&&this.FocusRow(n,o,t,e,!0),!0},Description:$dyn.label("Grid_MoveToLastMarkedRowShortCut"),Category:$dyn.ui.ShortcutCategory.Navigate},AltShiftMN:{ChordKeys:{alt:!0,shift:!0,keyCode:$dyn.ui.KeyCodes.letterM},Keys:{keyCode:$dyn.ui.KeyCodes.letterN},Handler:function(e){if($dyn.value(this.AllowHeaderFocus))return!1;var t=this.InputMode=$dyn.ui.InputType.keyboard,o=$dyn.controls.List.MarkMode.none,n=this.GetNextMarkedRow();return void 0!==n&&this.FocusRow(n,o,t,e,!0),!0},Description:$dyn.label("Grid_MoveToNextMarkedRowShortCut"),Category:$dyn.ui.ShortcutCategory.Navigate},AltShiftMP:{ChordKeys:{alt:!0,shift:!0,keyCode:$dyn.ui.KeyCodes.letterM},Keys:{keyCode:$dyn.ui.KeyCodes.letterP},Handler:function(e){if($dyn.value(this.AllowHeaderFocus))return!1;var t=this.InputMode=$dyn.ui.InputType.keyboard,o=$dyn.controls.List.MarkMode.none,n=this.GetPreviousMarkedRow();return void 0!==n&&this.FocusRow(n,o,t,e,!0),!0},Description:$dyn.label("Grid_MoveToPreviousMarkedRowShortCut"),Category:$dyn.ui.ShortcutCategory.Navigate},PageDown:{Keys:{keyCode:$dyn.ui.KeyCodes.pageDown},Handler:function(e){if(!$dyn.value(this.Enabled)||$dyn.value(this.AllowHeaderFocus))return!1;var t=this.InputMode=$dyn.ui.InputType.keyboard,o=this._calculateMarkMode(e);return this.FocusRowRelativeToActiveRow(this.CalculateNumberOfVisibleRows(),o,t,e),!0},ShowToUser:function(){return $dyn.value(this.Enabled)&&!(this._isLastRow&&this._isLastRow())&&!$dyn.value(this.AllowHeaderFocus)},Description:$dyn.label("Grid_NextPageShortcut")},PageUp:{Keys:{keyCode:$dyn.ui.KeyCodes.pageUp},Handler:function(e){if(!$dyn.value(this.Enabled)||$dyn.value(this.AllowHeaderFocus))return!1;var t=this.InputMode=$dyn.ui.InputType.keyboard,o=this._calculateMarkMode(e);return this.FocusRowRelativeToActiveRow(-this.CalculateNumberOfVisibleRows(),o,t,e),!0},ShowToUser:function(){return $dyn.value(this.Enabled)&&!(this._isFirstRow&&this._isFirstRow())&&!$dyn.value(this.AllowHeaderFocus)},Description:$dyn.label("Grid_PreviousPageShortcut")},ControlSpace:{Keys:{ctrl:!0,keyCode:$dyn.ui.KeyCodes.spacebar},Handler:function(e){return!(!$dyn.value(this.Enabled)||$dyn.value(this.AllowHeaderFocus))&&(this._executeRowMarkUpdate(),!0)},RecordTelemetry:!0,ShowToUser:function(){return $dyn.value(this.Enabled)&&!$dyn.value(this.AllowHeaderFocus)},Description:function(){return this._getListControlSpaceShortCutDescription(this)}},ControlShiftM:{Keys:{ctrl:!0,shift:!0,keyCode:$dyn.ui.KeyCodes.letterM},Handler:function(e){return!(!$dyn.value(this.Enabled)||$dyn.value(this.AllowEdit))&&(this.ToggleMarkAllRecordsMode(),!0)},ShowToUser:function(){return $dyn.value(this.Enabled)&&!$dyn.value(this.AllowEdit)},Description:function(){return this._getListMarkAllShortCutDescription(this)}},Enter:{Keys:{keyCode:$dyn.ui.KeyCodes.enter},Handler:function(e){return this._performNonEditModeNavigationAction(e)},ShowToUser:!1},ControlG:{Keys:{ctrl:!0,keyCode:$dyn.ui.KeyCodes.letterG},Handler:function(e){var t=this.FindActiveElement();if(t){var o=$dyn.context(t[0]);if(o){var n=o.Name;o.ReferenceGroup&&(n=o.ReferenceGroup.Name);var i=$(s().attr("data-dyn-columnname",n).find(this.element)).find(".columnHeaderWrapper");if(i)return i.click(),$dyn.log.list&&$dyn.log.list("Event propagation stopped for ctrl+g inside grid"),!0}}return!1},ShowToUser:!0,Description:$dyn.label("Grid_OpenGridFilterShortCut"),Category:$dyn.ui.ShortcutCategory.Navigate},AltN:{Keys:{alt:!0,keyCode:$dyn.ui.KeyCodes.letterN},Handler:function(e){var t=$(e.target).closest(".rowTemplate")[0];return this._newRecord(t)},ShowToUser:!1},Tab:{Keys:{keyCode:$dyn.ui.KeyCodes.tab},Handler:function(e){return this._onTabKey(e),!1},RecordTelemetry:!1,ShowToUser:!1},ShiftTab:{Keys:{shift:!0,keyCode:$dyn.ui.KeyCodes.tab},Handler:function(e){return this._onTabKey(e),!1},RecordTelemetry:!1,ShowToUser:!1},AltF9:{Keys:{alt:!0,keyCode:$dyn.ui.KeyCodes.f9},Handler:function(e){var t=$(e.target).closest(".listItem")[0];return this._deleteRecord(t,e)},ShowToUser:!1},AltShiftH:{Keys:{alt:!0,shift:!0,keyCode:$dyn.ui.KeyCodes.letterH},Handler:function(e){if($(e.target).parents().is(".listHeader"))this.AllowHeaderFocus(!1),$dyn.value(this.IsNoResultsMessageDisplayed)?this.focusNoRowIndicator():this._renderer.focusCellInActiveRow();else{var t,o=this._getParentControlName(e.target);o!==this.Name&&(t=$.find("[data-dyn-columnname='"+o+"'] > .columnHeaderWrapper",this._headerRowElement)),(!t||t.length<=0)&&(t=$.find(".columnHeaderWrapper:not(.markingColumnHeader)",this._headerRowElement)),t&&t.length&&(this.AllowHeaderFocus(!0),this._headerTabbingContainerDispose=$dyn.util.tabbingContainer(this._headerRowElement,$dyn.label("ListHeader_RegionTitle")),$dyn.log.focus&&$dyn.log.focus("Focusing header: "+o),t[0].focus())}},ShowToUser:!0,Description:function(){return $dyn.value(this.AllowHeaderFocus)?$dyn.label("Grid_FocusActiveRowShortcut"):$dyn.label("Grid_FocusColumnHeaderShortCut")},Category:$dyn.ui.ShortcutCategory.Navigate}}),get allowedElements(){if(this._reevaluateElements||!this._allowedElements||!this._allowedElements.length){if(this._allowedElements=[this.element],this.Root&&this.Root.MessageBar){this.Root.MessageBar.IsVisible()&&this._allowedElements.push(this.Root.MessageBar.element);var t=this;if($dyn.flags.disableAnimations)this._msgBarComputed||(this._msgBarComputed=$dyn.computed(function(){t.Root.MessageBar.IsVisible(),t.Root.MessageBar.InfoExpanded(),t.Root.MessageBar.WarningExpanded(),t.Root.MessageBar.ErrorExpanded()}),this._msgBarObserver=$dyn.observe(this._msgBarComputed,function(){t._reevaluateTimeout&&t._reevaluateTimeout.cancel(),t._reevaluateTimeout=$dyn.async(function(){t._reevaluateSurroundingBlockingDiv()})}));else{var o=function(e){"color"!=e.propertyName&&(t.Root.MessageBar.element.removeEventListener("transitionend",o,!1),t.Root.MessageBar.element.removeEventListener("animationend",o,!1),t.Root.MessageBar.element.removeEventListener("webkitAnimationEnd",o,!1),t._reevaluateSurroundingBlockingDiv())};this.Root.MessageBar.element.addEventListener("transitionend",o,!1),this.Root.MessageBar.element.addEventListener("animationend",o,!1),this.Root.MessageBar.element.addEventListener("webkitAnimationEnd",o,!1)}}if(this.Root&&this.Root.element){var e=$(this.Root.element).find('[data-dyn-role="CommandButton"]');if(e&&e.length)for(var n=0;n<e.length;n++){var i=$dyn.context(e[n]);!i||"DeleteRecord"!==i.Command&&"New"!==i.Command||$dyn.value(i.ServiceBoundary)!==$dyn.value(this.ServiceBoundary)||this._allowedElements.push(e[n])}}this._reevaluateElements=!1}return this._allowedElements},get SurroundingBlockingDiv(){if(!this._surroundingBlockingDiv){var e=this;this._surroundingBlockingDiv=new $dyn.shell.multiElementSurroundingBlockingDiv(function(){e.SurroundingBlockingDiv.addClass("fadeInQuick"),e.SurroundingBlockingDiv.addClass("fastEditRailsMode")})}return this._surroundingBlockingDiv},get IsRendering(){return this._renderer&&this._renderer._isRendering},addColumns:function(){this.AllowHeaderFocus(!0),$dyn.callFunction(this.ExecutePersonalizationCommand,this,["SelectForAdd"])},recalculateRowIndex:function(e){var t=$dyn.value(this.FetchedDataStartPosition);if(this._initialDataStartPosition==t)return e;var o=e+this._initialDataStartPosition-t;return $dyn.log.list&&$dyn.log.list("List: recalculateRowIndex: Updating ChangeSelectedIndex row from %s to %s",e,o),o},forceRenderCardListIE:function(){if($dyn.layout.provider.name===$dyn.layout.Providers.css3grid&&1!==$dyn.value(this.VisibleColumnCount)&&this.element.classList.contains("cardList")){var e=this._listBodyElement.style.display;this._listBodyElement.style.display="none",this._listBodyElement.style.display=e}},isRowItemFullyVisible:function(e){var t=!0,o=0;if(e&&e.offsetParent){var n=e.offsetTop+e.offsetParent.offsetTop;if(n<this.GetScrollRegionTop())t=!1,o=n;else{var i=n+e.offsetHeight,r=this.GetScrollRegionTop()+this.GetScrollRegionHeight();r<i&&(t=!1,o=this.GetScrollRegionTop()+(i-r))}}return{visible:t,scrollTop:o}},scrollItemIntoView:function(e){if(e){var t=this.isRowItemFullyVisible(e);t.visible||this.SetScrollRegionTop(t.scrollTop)}},applyServerCacheCoordinateShift:function(e){this._rangePivot+=e,this.clientCacheStart+=e,this._serverCacheCoordinateShiftHandler&&this._serverCacheCoordinateShiftHandler(e)},CalculateNumberOfVisibleRows:function(){var e=0,t=this.CalculateRowHeight();return 0<t&&(e=Math.floor(this.GetScrollRegionHeight()/t)),e},FindActiveElement:function(){return document.activeElement?this.GetSelectedRow().find(document.activeElement):null},CurrentPageIndex:function(){var e=-1,t=$dyn.value(this.DataSource);return 0<t.length&&t[0]&&t[0].parent&&(e=$dyn.value(t[0].parent.pageIndex)),e},HasNextPage:function(){var e=!1,t=$dyn.value(this.DataSource);return 0<t.length&&t[0]&&t[0].parent&&(e=$dyn.value(t[0].parent.hasNextPage)),e},HasSinglePage:function(){var e=-1,t=-1,o=$dyn.value(this.DataSource),n=$dyn.length(this.DataSource);o&&0<o.length&&o[0]&&o[0].parent&&(e=$dyn.value(o[0].parent.pageIndex),t=$dyn.value(o[0].parent.clientPageSize));var i=t&&-1!==t?t:this.PageSize;return 0===n||n<i&&0===e||t<=0},GetActiveCell:function(){return this._rowOperationsManager&&this._rowOperationsManager.getActiveCell()},IsNavigationAction:function(e){return $dyn.value(this.NavigationEnabled)&&(this.IsCardList()||this.TargetSupportsNavigation(e))},IsCardList:function(){return void 0===this._isCardList&&(this._isCardList=$(this.element).hasClass("cardList")),this._isCardList},IsInsidePreviewForm:function(){return!(!this.Root||!this.Root.IsPreviewForm)},TargetSupportsNavigation:function(e){var t=$(e.target).closest(".listCell");return t&&t.hasClass("supportsNavigation")},IsValidSecondaryNavigation:function(e){var t=$(e.target).closest(".listItem");return 1===t.length||t.hasClass("marked")},FocusRow:function(e,t,o,n){var i=$dyn.peek(this._fastEdit);if(e!==$dyn.peek(this.SelectedIndex)||i)if(i){var r=this._renderer.getUserSelectedElement(),a=this._renderer._rowIds[e];if(r){var s=this._renderer.getInternalRowIdByElement(r),l=this._renderer.getActivePageRelatedIndex(s);a==s&&void 0!==l||(this._markingAction=t,void 0===l&&((l=0)==e&&(e=1),e*=-1),o===$dyn.ui.InputType.mouse?this.FocusRowRelativeToActiveRow(null,t,o,n):this.FocusRowRelativeToActiveRow(e-l,t,o,n))}}else this._markingAction=t,this.FocusRowRelativeToActiveRow(e-$dyn.value(this.SelectedIndex),t,o,n);return e},FocusRowRelativeToActiveRow:function(e,t,o,n,i){return this._rowOperationsManager.FocusRowRelativeToActiveRow(e,t,o,n,i)},RenderedRowsCount:function(){return this._renderer.getRenderedRowCount()},_calculateMarkMode:function(e){return this._rowOperationsManager.calculateMarkMode(e)},_executeRowMarkUpdate:function(){return this._rowOperationsManager.ExecuteRowMarkUpdate()},_performNonEditModeNavigationAction:function(e){return this._rowOperationsManager.PerformNonEditModeNavigationAction(e)},_newRecord:function(e){return this._renderer.newRecord(e)},_deleteRecord:function(e,t){return this._renderer.deleteRecord(e,t)},_isLastRow:function(){var e=this._renderer.getUserSelectedElement(),t=this._renderer.getInternalRowIdByElement(e);return this._dataProvider.isBackendLastRow(t)},_isFirstRow:function(){return 0===this.SelectedIndex()},_getListRowChangeShortCutDescription:function(e,t){var o="",n=t.keyCode;return n==$dyn.ui.KeyCodes.downArrow?(o=$dyn.label("Grid_NextRowShortcut"),e._isLastRow&&e._isLastRow()&&e.CreateNewRecordOnKeyDown?o=$dyn.label("Grid_NextRowNewLineShortcut"):t.shift&&!t.ctrl?o=$dyn.label("Grid_NextRowToSelectedSetShortcut"):!t.shift&&t.ctrl&&(o=$dyn.label("Grid_NextRowButNotSelectShortcut"))):n==$dyn.ui.KeyCodes.upArrow&&(o=$dyn.label("Grid_PreviousRowShortcut"),t.shift&&!t.ctrl?o=$dyn.label("Grid_PreviousRowToSelectedSetShortcut"):!t.shift&&t.ctrl&&(o=$dyn.label("Grid_PreviousRowButNotSelectShortcut"))),o},_getListControlSpaceShortCutDescription:function(e){var t=$dyn.label("Grid_CurrentRowSelectionShortcut");return e.IsMarked($dyn.value(e.SelectedIndex))&&(t=$dyn.label("Grid_CurrentRowClearShortcut")),t},_getListMarkAllShortCutDescription:function(e){var t=$dyn.label("Grid_SelectAllRowsShortcut");return e.hasMarkedRows()&&(t=$dyn.label("Grid_ClearAllRowsShortcut")),t},isControlInActiveRow:function(e){var t,o=!1,n=e;if(n)for(;t=n.getAttribute("data-dyn-rowid"),n=n.parentElement,null==t&&n;);return t&&this._syncManager&&this._syncManager.isActiveRow&&this._syncManager.isActiveRow(parseInt(t))&&(o=!0),o},headerScroll:function(e){this.SyncHorizontalScrollFromHeader()},headerFocusOut:function(e){var t=document.activeElement;e&&e.relatedTarget&&(t=e.relatedTarget),$(t).closest(".listAsTable-HeaderRow, .columnHeader-popup").length<=0&&(this.AllowHeaderFocus(!1),this._headerTabbingContainerDispose&&(this._headerTabbingContainerDispose(),this._headerTabbingContainerDispose=null))},ToggleMark:function(){var e=$dyn.value(this.MarkedIndexes),t=$dyn.value(this.SelectedIndex),o=e[t];e[t]=!o,$dyn.isObservable(this.MarkedIndexes)&&this.MarkedIndexes.valueChanged.raise()},hasMarkedRows:function(){return this._dataProvider.hasMarkedRows()},_getIsLoading:function(){return $dyn.value(this._syncManager._syncEngineState)===$dyn.util.SyncEngineState.active},_onTabKey:function(e){this._tabFocusing=!0,$dyn.log.list&&$dyn.log.list("List: [fast] Detecting user focus");var t=this._renderer.getUserSelectedElement();if(t){this._renderer.getInternalRowIdByElement(t);this._rowOperationsManager.updateActiveElement(t,!0)}setTimeout(this._tabCallback.bind(this))},_tabCallback:function(){if(this._tabFocused)$dyn.log.list&&$dyn.log.list("List: [fast] Detecting user focus success");else{if($dyn.debug.general)$(document.activeElement).closest(".listRoot")[0]!==this.element?$dyn.log.list&&$dyn.log.list("List: [fast] Detecting user focus outside of grid"):$dyn.log.list&&$dyn.log.list("List: [fast] Detecting user focus failed");this._rowOperationsManager._activeCell("")}this._tabFocusing=!1,this._tabFocused=!1},_focusIn:function(e){this._tabFocusing&&(this._tabFocused=!0);var t=this._getParentControlName(e.target);this._rowOperationsManager._activeCell(t);var o=$(e.target).closest(".listItem")[0];this._renderer.getInternalRowIdByElement(o)!==$dyn.peek(this._dataProvider.DataSelectedRowId)&&e.stopImmediatePropagation()},tryFocus:function(e,t){return!e&&$dyn.value(this.IsNoResultsMessageDisplayed)?($(this.getNoRowIndicator()).focus(),$dyn.log.focus&&$dyn.log.focus("Focus: List(List.Id: %s)->tryFocus Set focus to grid noRowIndicator",this.Id),!0):this._renderer.tryFocus(e,t)},getFocusCallback:function(e){return function(){e&&e()}},_getVirtualControl:function(o){var r=this,e=$(o).closest("[data-dyn-controlname]").addBack()[0],t=e&&e.dynContext;if(e&&!t){var n=s().attr("data-dyn-controlname",e.getAttribute("data-dyn-controlname")).find(this._inactiveItemElement)[0],i=$dyn.context(n);if(n&&i){var a=Object.create(i);return Object.defineProperties(a,{index:{get:function(){var e=r._renderer;if(!this.__listRowId){var t=$(o).closest(".listItem")[0];this.__listRowId=e.getInternalRowIdByElement(t)}return r._renderer.getActivePageRelatedIndex(this.__listRowId)},enumerable:!1},serverIndex:{get:function(){return r.ConvertPageIndexToServerCacheIndex(this.index)+1},enumerable:!1},_Children:{value:void 0,writable:!0},Children:{get:function(){if(!this._Children){for(var e=[],t=$("[data-dyn-content]",this.element).children(),o=0;o<t.length;o++){var n=t[o],i=r._getVirtualControl(n);i&&i.current&&e.push(i.current)}this._Children=$dyn.observable(e)}return this._Children}}}),e.dynContext=a.dynContext=new $dyn.DataContext(a,n.dynContext),a.element=e,a.attached&&a.attached(),a.dynContext}}return t},_supportsMarking:function(){var e=!1,t=$dyn.value(this.IsMarkingEnabled),o=$dyn.value(this.IsSelectionIndicatorVisible);return t&&o?e=!0:t&&!o?e=this._markingAction!==$dyn.controls.List.MarkMode.select:!t&&o&&(e=this._markingAction==$dyn.controls.List.MarkMode.select),e},SetMarkAllRecordsMode:function(e){for(var t=$dyn.length(this.DataSource),o=this._dataProvider.MarkedIndexes(),n=0;n<t;n++)o[n]=e;this._dataProvider.MarkedIndexes.valueChanged.raise();for(var i=this._getAllRowElements(),r=(n=0,i.length);n<r;n++){var a=i[n];this._renderer.setRowMarking(a,$dyn.value(e))}$dyn.setValue(this,"MarkAllRecords",e)},ToggleMarkAllRecordsMode:function(){this._supportsMarking()&&(this._renderer.allRecordsMarkTriggered=!0,$dyn.callFunction(this.SetMarkAllRecordsMode,this,!$dyn.value(this.MarkAllRecords)))},FindRowAtIndex:function(e){var t=this.ConvertPageIndexToClientCacheIndex(parseInt(e));return this._renderer._getRenderedRowElementByIndex(t)},_getAllRowElements:function(){return $(this.element).find(".listBody .listItem")},UpdateClientCacheStart:function(e,t){var o=0;0<this.clientCacheStart&&(this.clientLastStartPosition=this.clientCacheStart),void 0!==this.clientCacheStart&&null!==this.clientCacheStart&&null!=e&&(o=this.clientCacheStart-e),this.clientCacheStart=0<t?e+t:e,this._clientCacheStartUpdated&&this._clientCacheStartUpdated(o)},ConvertPageIndexToServerCacheIndex:function(e){return e+$dyn.peek(this.FetchedDataStartPosition)},ConvertPageIndexToClientCacheIndex:function(e){return this.ConvertPageIndexToServerCacheIndex(e)-this.clientCacheStart},ConvertClientCacheIndexToServerCacheIndex:function(e){return e+this.clientCacheStart},ConvertClientCacheIndexToPageIndex:function(e){return this.ConvertClientCacheIndexToServerCacheIndex(e)-$dyn.peek(this.FetchedDataStartPosition)},ConvertServerCacheIndexToClientCacheIndex:function(e){return e-this.clientCacheStart},ConvertServerCacheIndexToPageIndex:function(e){return e-$dyn.peek(this.FetchedDataStartPosition)},ChangeSelectedIndex:function(u){var d=this;$dyn.ui.updateBlock(null,function(){if(Array.isArray(u)){var e=u[0],t=u[1],o=u[2],n=u[4],i=d.DataSource?$dyn.value(d.DataSource).length:0,r=d.MarkedIndexes();switch(t){case $dyn.controls.List.MarkMode.select:for(var a=0;a<i;a++)r[a]&&(r[a]=!1);r[e]=!0;break;case $dyn.controls.List.MarkMode.toggle:r[e]=!r[e];break;case $dyn.controls.List.MarkMode.rangeSelect:var s,l;l=e<o?(s=e,o):(s=o,e);for(a=0;a<i;a++)r[a]&&(r[a]=!1);for(a=s;a<=l;a++)r[a]=!0;break;case $dyn.controls.List.MarkMode.clearMark:for(a=0;a<i;a++)r[a]&&(r[a]=!1)}d.MarkedIndexes.valueChanged.raise(),d.SelectedIndex(e),$dyn.async(function(){n&&n.call(d,!0)})}},this)},setChildControlFocus:function(e){var t=e||this.element,o=$dyn.util.findFirstFocusableControl(t);if(o)return this.setFocus(o,this.Root),o},findFieldByNameInHeader:function(e){return $.find("[data-dyn-columnname='"+e+"'] > .columnHeaderWrapper",this._headerRowElement)},findFieldByName:function(e){if(this.AllowHeaderFocus())return this.findFieldByNameInHeader(e);var t=this._renderer.getUserSelectedElement();return t?$(t).attr("data-dyn-controlname")===e?$(t):$.find("[data-dyn-controlname='"+e+"']",t):void 0},findFieldByNameInServerSelectedRow:function(e){if(this.AllowHeaderFocus())return this.findFieldByNameInHeader(e);var t=this._renderer.getServerSelectedElement();return t?$.find("[data-dyn-controlname='"+e+"']",t):void 0},getActiveRowClientIndex:function(){var e=this._renderer.getUserSelectedRenderedRow();if(e)return e.order},AreElementsCrossBoundary:function(e,t){function o(e){var t=$dyn.context(e);if(!t){var o=i._getParentControlName(e);if(o){var n=$(i._selectedRow).find('[data-dyn-controlname="'+o+'"]')[0];n&&(t=$dyn.context(n))}}return t}var i=this,n=o(e),r=o(t);if(n&&r)return $dyn.peek(n.ServiceBoundary)!==$dyn.peek(r.ServiceBoundary)},_layoutCompleted:function(){this.postRenderInternal(!0),this.forceRenderCardListIE(),$(this.element).trigger($dyn.forms.Events.gridLayoutCompleted)},_getHeaderId:function(e){return e&&$dyn.value(e.Name)},_getHeaderVersion:function(e){return e&&e.Version},_headerPrefixTemplate:"ListMarkAllHeader",_getHeaderPrefix:function(){return this._headerPrefix||(this._headerPrefix=$dyn._getTemplate(this._headerPrefixTemplate).cloneNode(!0),this._headerPrefix.removeAttribute("id"),$dyn.dataBind(this._headerPrefix,this.element.dynContext)),this._headerPrefix},_headerScrollDivTemplate:"HeaderScrollDivPad",_getHeaderScrollSuffix:function(){return this._headerScrollSuffix||(this._headerScrollSuffix=$dyn._getTemplate(this._headerScrollDivTemplate).cloneNode(!0),this._headerScrollSuffix.removeAttribute("id"),$dyn.dataBind(this._headerScrollSuffix,this.element.dynContext)),this._headerScrollSuffix},_renderHeader:function(){this.RenderedHeaderMetadata(this.ColumnHeaderMetadata())},_headerPreRender:function(){var e=this._getHeaderPrefix(),t=e&&e.parentNode;t&&t.removeChild(e)},_headerPostRender:function(){var e=this._headerRowElement;if(e){var t=this._getHeaderPrefix();if(t&&e.insertBefore(t,e.firstChild),$dyn.shell.isEdge){var i=this;this._noResultsHeaderObserver||(this._noResultsHeaderObserver=this.usingDisposable($dyn.observe(this.IsNoResultsMessageDisplayed,function(e){var t=i._getHeaderScrollSuffix();if(t)if(e)t.style.width="0px";else{var o=i.GetScrollRegion();if(o){var n=o.offsetWidth-o.clientWidth;t.style.width=n+"px"}}})));var o=this._getHeaderScrollSuffix();o&&e.appendChild(o,e.lastChild)}}var n=$dyn.length(this.RenderedHeaderMetadata);$dyn.value(this.IsMarkingEnabled)&&n++,this.element.setAttribute("aria-colcount",n)},_headerIterationCallback:function(e,t){var o=$dyn.context(e.querySelector(".columnHeaderWrapper"));o&&o.Index&&o.Index(t+1)},_resizeControlColumn:function(e,t,o){var n=this.getDataColumnContextsByIndex(e,!0);if(n.length){for(var i=!1,r=0;r<n.length;r++)if(n[r]){var a,s,l=this.findControlElementsInAllRows(n[r].Name);for(a=0,s=l.length;a<s;a++){var u=$dyn.context(l[a]);!i&&u&&u.LayoutWidth&&(this.isControlInActiveRow(l[a])||0==this._dataProvider.Collection().length)?(u.LayoutWidth(t),i=!0):$dyn.bindingHandlers.sizing.widthChanged(l[a],t)}}o&&1===n.length&&$dyn.callFunction(n[0].PersistPersonalization,n[0],["width",t])}},_processColumnHeaderResize:function(e,t,o){var n=$(e.target),i=n.closest(".columnHeader");if(1===i.length){var r=n.closest(".columnHeaderWrapper"),a=i.parent().children(".columnHeader").index(i);r.outerWidth(o);var s=$(r).width();this._resizeControlColumn(a,s,t)}},_isInvalidMarkTarget:function(e){var t=!1;if(e){var o=e.target?$dyn.context(e.target):null,n=!!o&&$dyn.value(o.IsHyperlink),i=this.IsNavigationAction(e);(n||i)&&(t=$dyn.util.clickedText(e.target))}return t},getTaskGuideParams:function(e){var t,o=(e=$dyn.ui.Control.prototype.getTaskGuideParams.apply(this,[e])).action;e.arguments;if(-1!==o.indexOf("LoadNextPage")){if(t=$(this.element).children(".pagingButtons")){var n=t.children('[title="'+$dyn.label("Grid_Next")+'"]');e.target=n,e.my="top center",e.at="bottom center"}}else if(-1!==o.indexOf("LoadPreviousPage")){if(t=$(this.element).children(".pagingButtons")){n=t.children('[title="'+$dyn.label("Grid_Previous")+'"]');e.target=n,e.my="top center",e.at="bottom center"}}else o.match("MarkActiveRow|UnmarkActiveRow|ChangeSelectedIndex|ChangeSelectedIndexInCache|NavigationAction")&&(e.target=$(this.element));return e},SelectCell:function(e){var t=e[1];e[0];this.Root&&this.Root.ActiveControl&&($dyn.isObservable(this.Root.ActiveControl)?this.Root.ActiveControl(t):this.Root.ActiveControl=t)},TransferInputFocus:function(e){this._renderer.TransferInputFocus(e)},_getParentControlName:function(e){for(var t=e;t&&"function"==typeof t.getAttribute;){var o=t.getAttribute("data-dyn-controlname");if(!o&&$(t).hasClass("checkMarkTarget")&&"checkbox"===t.getAttribute("role"))return"checkMarkTarget";var n=t.getAttribute("data-dyn-role");if(!o&&t.classList.contains("columnHeader")&&(o=t.getAttribute("data-dyn-columnname")))return o;if(o&&n&&"RowTemplate"!==n)return o;t=t.parentNode}},Create:function(){},Delete:function(){},getColumnLabel:function(e,t,o){return null==o||$dyn.value(o)?e:""},getFilterability:function(e,t,o){return $dyn.value(e)||$dyn.value(t)==$dyn.util.dataAreaId&&o&&$dyn.peek(o)[0]&&$dyn.peek(o)[0].parent.IsCrossCompany},columnMutator:function(e,t){e.setAttribute("role","gridcell"),e.setAttribute("data-colindex",t+1),e.classList.add("listCell"),0===t&&e.classList.add("listCell-firstCell")},IsMarked:function(e){return this.MarkedIndexes()[e]},rangePivotWithinPage:function(){return this._rangePivot-$dyn.value(this.FetchedDataStartPosition)},_rowElementGenerator:function(e){var t=this;return $dyn.computed(function(){var c=$dyn.value(t._fastEdit)&&$dyn.value(t.AllowEdit)?"cellEditor":"cellRoleName",p=function(e){var t=document.createElement(e.nodeName),o=e.getAttribute("data-dyn-controlname");o&&t.setAttribute("data-dyn-controlname",o);var n=e.getAttribute("data-dyn-role");if(n){var i=$dyn.controls[n]&&$dyn.controls[n].prototype;n=i&&(i[c]||i.cellRoleName)||n,t.setAttribute("data-dyn-role",n)}var r=e.getAttribute("data-dyn-options");r&&t.setAttribute("data-dyn-bind",r.slice(1,-1));var a=$dyn.value(e.dynChildren);if(a)for(var s=0,l=a.length;s<l;s++){var u=a[s],d=p(u);t.appendChild(d)}return t};return p(e).children})},_cachedInactiveItemElement:void 0,get _inactiveItemElement(){var e=this._cachedInactiveItemElement;return e||($dyn.log.list&&$dyn.log.list("List: Generating inactive row element"),e=this._cachedInactiveItemElement=this.ChildHierarchy()[0]),e&&!$dyn.context(e)&&(this._itemDataContext||(this._listBodyRole=$dyn.role(this._listBodyElement),this._itemDataContext=new $dyn.DataContext(this._inactiveItem,this._listBodyElement.dynContext)),$dyn.log.list&&$dyn.log.list("List: Databinding inactive row element"),this._listBodyRole.dataBindItem(e,this._itemDataContext),$dyn.layout.arrange(e)),e},_resetCachedInactiveItemElement:function(e){this._cachedInactiveItemElement&&($dyn.log.list&&$dyn.log.list("List: Unbind inactive row"),$dyn.unbind(this._cachedInactiveItemElement)),this._cachedInactiveItemElement=e||null},updateSchema:function(e){$dyn.log.list&&$dyn.log.list("List: Inactive row schema changed (updateSchema)"),this._resetCachedInactiveItemElement(),this._rerenderOptions($dyn.peek(this._rerenderOptions)+1)},rowClick:function(e){$dyn.context($(e.currentTarget).closest(".listRoot")[0]).RowClicked(e)},_getValues:function(){var e=$(".listBody",this.element).find(".listItem"),n=[];return e.each(function(e,t){var o=$(t),i=new Array;o.find(".listCell:not(.repeater-template)").each(function(e,t){var o="";if($(t).is(".checkBox-container"))o="true"===$(t).find(".checkBox").attr("aria-checked");else{var n=$(t).find("input");if(0<n.length)o=n[0].value}i.push(o)}),n.push(i)}),n},_hasTextSelection:function(e){if(e.ctrlKey||e.metaKey||e.shiftKey)return!1;var t=window.getSelection().toString();return t?($dyn.log.list&&$dyn.log.list("List: row click canceled due to selection: %s",t),!0):!(!document.activeElement||$dyn.ui.selectionStart(document.activeElement)===$dyn.ui.selectionEnd(document.activeElement))&&($dyn.log.list&&$dyn.log.list('List: row click canceled due to selection: start="%s", end="%s"',$dyn.ui.selectionStart(document.activeElement),$dyn.ui.selectionEnd(document.activeElement)),!0)},ExecuteExportToExcel:function(e){$dyn.callFunction(this.ExportToExcel,this,e)},GetHeightForHandler:function(){this._skipOffsetParentCheck=!0;var e=this.GetScrollRegionHeight();return this._skipOffsetParentCheck=!1,e},GetScrollRegion:function(){return this._scrollRegion||(this._scrollRegion=this.element.getElementsByClassName("scrollRegion")[0],this.WindowResizeHandler&&$(window).on("resize",this.WindowResizeHandler)),this._scrollRegion},GetScrollRegionHeight:function(){return this.GetScrollRegion()&&(this._skipOffsetParentCheck||null!==this._scrollRegion.offsetParent)?(this.CachedScrollRegionHeight||this.UpdateScrollRegionHeight(),this.CachedScrollRegionHeight):0},SetScrollRegionHeight:function(e){this.GetScrollRegion().style.height=e+"px",this.UpdateScrollRegionHeight()},UpdateScrollRegionHeight:function(){this.CachedScrollRegionHeight=this.GetScrollRegion().clientHeight},GetScrollRegionWidth:function(){return this.CachedScrollRegionWidth||this.UpdateScrollRegionWidth(),this.CachedScrollRegionWidth},UpdateScrollRegionWidth:function(){this.CachedScrollRegionWidth=this.GetScrollRegion().offsetWidth},GetScrollRegionTop:function(){return void 0!==this.CachedScrollRegionTop&&null!==this.CachedScrollRegionTop||(this.CachedScrollRegionTop=this.GetScrollRegion().scrollTop),this.CachedScrollRegionTop},UpdateScrollTop:function(e){e<0&&(e=0);var t=this.CachedScrollRegionTop;return this.CachedScrollRegionTop=null!=e?e:this.GetScrollRegion().scrollTop,t!==this.CachedScrollRegionTop},SetScrollRegionTop:function(e){$dyn.microTask(function(){this.GetScrollRegion().scrollTop=e},this),this.UpdateScrollTop(e)},_updateDefaultActionEnabled:function(){var e=$dyn.value(this.NavigationEnabled);this._updateRowDefaultAction(this._cachedInactiveItemElement,e,"_lastInactiveDefaultControl"),this._updateRowDefaultAction(this._selectedRow,e,"_lastActiveDefaultControl")},_updateRowDefaultAction:function(e,t,o){var n=this[o];if(t&&e){var i=this._getDefaultControl(e);i&&(i.DefaultActionEnabled=!0),this[o]=i}!n||t&&n===i||(n.DefaultActionEnabled=!1)},_getDefaultControl:function(e){var t,o=$dyn.children(e);if(o)for(var n=0,i=o.length;n<i;n++){var r=o[n],a=$dyn.context(r);if(a&&a.SupportsDefaultAction&&(t=t||a,$dyn.value(a.IsDefaultActionGridControl))){t=a;break}}return t},_fastEditingAllowed:function(){return $dyn.value(this.AllowEdit)&&$dyn.value(this._fastEdit)},hasPendingEdits:function(){return this._syncManager.hasPendingEdits()},_reevaluateSurroundingBlockingDiv:function(){$dyn.peek(this.fastEditingAllowed)&&!$dyn.peek(this._syncManager.isQueueEmpty)&&this._surroundingBlockingDivShown&&(this._reevaluateElements=!0,this.SurroundingBlockingDiv.removeClass("fadeInQuick"),this.SurroundingBlockingDiv.show(this.allowedElements))},dispose:function(){$dyn.ui.Control.prototype.dispose.call(this),$(document).off("densitychanged",this._densityChangeHandler),this.WindowResizeHandler&&$(window).off("resize",this.WindowResizeHandler),this._cachedInactiveItemElement&&($dyn.unbind(this._cachedInactiveItemElement),this._cachedInactiveItemElement=null),this._dataProvider&&this._dataProvider.dispose&&this._dataProvider.dispose(),this._renderer&&this._renderer.dispose&&this._renderer.dispose(),this._syncManager&&this._syncManager.dispose&&this._syncManager.dispose(),this._editManager&&this._editManager.dispose&&this._editManager.dispose(),this._rowOperationsManager&&this._rowOperationsManager.dispose&&this._rowOperationsManager.dispose(),this._syncQueueEmptySubscription&&this._syncQueueEmptySubscription.dispose&&this._syncQueueEmptySubscription.dispose(),this._msgBarObserver&&this._msgBarObserver.dispose&&this._msgBarObserver.dispose(),this._surroundingBlockingDiv&&this._surroundingBlockingDiv.destroy(),this._tabbingContainerDispose&&this._tabbingContainerDispose(),this._headerTabbingContainerDispose&&this._headerTabbingContainerDispose(),this._reevaluateTimeout&&this._reevaluateTimeout.cancel(),this._reevaluateTimeout=void 0,this._syncQueueEmptySubscription=null,this._msgBarObserver=null,this._lastInactiveDefaultControl=null,this._lastActiveDefaultControl=null,this._scrollRegion=null}}),$dyn.controls.RowTemplate=function(e,t,o){$dyn.ui.Control.apply(this,arguments),this.ParentGrid=o,this.ServerFocusableControl=o},$dyn.controls.RowTemplate.prototype=$dyn.extendPrototype($dyn.ui.Control.prototype,{ParentGrid:void 0,AllowPersonalization:!1,focusCallback:function(e){var t=e[0]?e[0]:this.element;if(t){var o=this.ParentGrid?this.ParentGrid.element:$(t).parents('[data-dyn-role="List"]')[0];o&&$dyn.util.focusElement(o),$dyn.log.focus&&$dyn.log.focus("Focus: Grid->focusCallback set to: %s",this.Name)}}}),$dyn.util.listEmpty=function(e,t){var o;if(void 0===t&&(t=!0),e)for(;o!==e.lastChild;)(o=e.lastChild)&&e.removeChild(o)},$dyn.bindingHandlers.list=function(u,d){$dyn.bindingHandlers.foreach.itemTask;var e=$(u);d=d||$dyn.role(u);var m=$dyn.context(u),c=!1,v=u.dynSelectedRow;if(!v){var t=e.children().not(".repeater-template");t.attr($dyn.const.stopBindingAttribute,!0),$dyn.util.listEmpty(u),v=m._selectedRow=u.dynSelectedRow=t[0].children[0]}$(m.element).find(".scrollRegion").first();var o=u.parentNode,g=$(".listRoot-loadingAbove",o)[0];g||(g=$("<div class='listRoot-loading listRoot-loadingAbove' style='display: none;'><span>"+$dyn.label("List_LoadingMoreData")+"</span></div>")[0],o.insertBefore(g,u));var y=$(".listRoot-loadingBelow",o)[0];y||(y=$("<div class='listRoot-loading listRoot-loadingBelow' style='display: none;'><span>"+$dyn.label("List_LoadingMoreData")+"</span></div>")[0],o.insertBefore(y,u.nextSibling));var n,f,r,b,C,i=$(o).find(".listRoot-loading span");function a(){var e=m.GetScrollRegionWidth();e!==n&&0!==e&&(n=e,i.css("max-width",e))}var w,_=0,S=0;function s(e,t,o){S=_=0,e=e||0;var n=$dyn.value(o.CacheSize)||0,i=$dyn.value(o.FetchedDataStartPosition)||0,r=$dyn.value(o.DataAbove),a=$dyn.value(o.DataBelow),s=void 0!==m.clientCacheStart&&(r||0<m.clientCacheStart),l=void 0!==m.clientCacheStart&&(a||m.clientCacheStart+t<n);m._renderer.restrictedRenderingMode()&&(s=b,l=C),b!==s&&(b=s),C!==l&&(C=l),!_&&s&&(_=$(g).outerHeight()),!S&&l&&(S=$(y).outerHeight());var u=0,d=0;s&&(u=_),l&&(d=S);var c=m.GetScrollRegionHeight(),p=u+.5*c,h=m._renderer.getRenderedRowCount()*m._renderer.getRowHeight()+u-1.5*c;!function(){if(m._renderer.restrictedRenderingMode())return;if(0!==I){if(f){var e=I*f.rowHeight;m.SetScrollRegionTop(m.GetScrollRegionTop()+e)}I=0}}(),f=m._scrollParameters={cacheSize:n,fetchedDataStartPosition:i,dataAbove:r,dataBelow:a,dataTriggerMax:h,dataTriggerMin:p,rowHeight:e,renderedRowCount:t,bufferAboveHeight:u,bufferBelowHeight:d},w=0!==c}var I=0;var l;function p(){f&&(D||(G()?V():D=!0))}function h(){$dyn.value(m.InfiniteScroll)&&s(m._renderer.getRowHeight(u),m._renderer.getRenderedRowCount(),m)}function T(e,t){if(!f||void 0===m.clientCacheStart||m.Root&&m.Root.IsCloseRequested&&m.Root.IsCloseRequested())return!1;if(t<=0||e>=m.clientCacheStart&&0<t&&e+t<=m.clientCacheStart+f.renderedRowCount)return $dyn.log.list&&$dyn.log.list("List: Loading Data - not needed. Requested start: %s, requested size: %s",e,t),!1;if(e+t<=0&&!f.dataAbove)return $dyn.log.list&&$dyn.log.list("List: Loading Data - not needed. Requested start: %s, requested size: %s",e,t),!1;if(e>=f.cacheSize&&!f.dataBelow)return $dyn.log.list&&$dyn.log.list("List: Loading Data - not needed. Requested start: %s, requested size: %s",e,t),!1;var o=!1;return e<m.clientCacheStart&&(f.dataAbove||0<m.clientCacheStart)&&(o=!0),e+t>f.renderedRowCount&&(f.dataBelow||m.clientCacheStart+f.renderedRowCount<f.cacheSize)&&(o=!0),o||$dyn.log.list&&$dyn.log.list("List: Loading Data - not needed. Requested start: %s, requested size: %s",e,t),o}var x={};function F(e,t,o){if(function(){if(!f||!1!==x.isDirty)return 1;var e=!(f.dataAbove===x.dataAbove&&f.dataBelow===x.dataBelow&&f.cacheSize===x.cacheSize&&f.fetchedDataStartPosition===x.fetchedDataStartPosition&&f.renderedRowCount===x.renderedRowCount&&m.clientCacheStart===x.clientCacheStart);return e||$dyn.log.list&&$dyn.log.list("List: Loading Data - state didn't change"),e}()&&T(e,t)&&$dyn.value(m.Enabled)&&$dyn.value(m.Visible)){m.clientLastEndPosition=e,m.prevScrollDirection=o,L($dyn.value(L)+1),r=t,x={isDirty:!1,dataAbove:f.dataAbove,dataBelow:f.dataBelow,cacheSize:f.cacheSize,fetchedDataStartPosition:f.fetchedDataStartPosition,renderedRowCount:f.renderedRowCount,clientCacheStart:m.clientCacheStart};var n=window.setTimeout(function(){o===$dyn.ui.ScrollDirection.up?g.style.display="block":y.style.display="block"},500);$dyn.callFunction(m.LoadData,m,[e,t],function(e){window.clearTimeout(n),g.style.display="none",y.style.display="none",0<(e=parseInt(e))&&m.applyServerCacheCoordinateShift(e),A?O++:(B(!0),L($dyn.value(L)-1))})}}function k(e){if(f&&f.rowHeight)return 2*Math.ceil(e/f.rowHeight)}function P(){if(f&&f.rowHeight){var e=m.GetScrollRegionTop();return Math.floor((e-f.bufferAboveHeight)/f.rowHeight)}}function R(e){var t=m._renderer.getRowHeight(u);if(e&&t)return Math.ceil(e/t)}function M(e){var t;if(f&&f.rowHeight&&f.cacheSize){var o=P(),n=R(e),i=r||k(e);t=i<n?o:o-Math.round((i-n)/2),(t=m.ConvertClientCacheIndexToServerCacheIndex(t))+i>=f.cacheSize&&(t=f.cacheSize-i),t<0&&(t=0)}return t}function E(){return m._fastEditingAllowed()?$dyn.util.InfiniteScrollMode.slow:$dyn.util.InfiniteScrollMode.fast}var N,A,D,L=$dyn.observable(0),O=0,B=m._dataLoadedRenderPending=$dyn.observable(!1);function V(){var e=m.GetScrollRegionTop(),t=!1;return f&&((e<f.dataTriggerMin||e>f.dataTriggerMax)&&(t=function(e){var t=m.GetScrollRegionHeight();if(!f||!f.rowHeight||!t||$dyn.shell.isShellInitializing()||void 0===m.clientCacheStart)return!1;var o=E(),n=k(t);if(o===$dyn.util.InfiniteScrollMode.slow){var i=!1,r=$dyn.ui.ScrollDirection.none;if(e>f.dataTriggerMax?(i=!0,m._scrollDirection=$dyn.ui.ScrollDirection.down):e<f.dataTriggerMin&&(i=!0,m._scrollDirection=$dyn.ui.ScrollDirection.up),i)F(M(t),n,r)}else{var a=m.clientCacheStart,s=!1;if(e>f.dataTriggerMax){var l=m._renderer.getBottomRowPageIndex();if(void 0!==l)var u=m.ConvertPageIndexToServerCacheIndex(l);if(f.dataBelow||u+1<f.cacheSize){var d=u;0===e&&void 0===m.clientLastStartPosition&&(m.doNotScrollIntoView=!0),F(d,n,$dyn.ui.ScrollDirection.down),s=!0}}if(e<f.dataTriggerMin&&!s){var c=a;if(f.dataAbove||0<=c){d=0;0==c&&f.dataAbove&&void 0===m.clientLastStartPosition&&(m.doNotScrollIntoView=!0,n=m._getVisibleRowCount(t)),F(d=c-n+1,n,$dyn.ui.ScrollDirection.up)}}}return!0}(e)),e>=f.selectionFocusTriggerMin&&e<=f.selectionFocusTriggerMax&&(m._renderer.focusCellInActiveRow(),f.selectionFocusTriggerMax=void 0,f.selectionFocusTriggerMin=void 0)),t}function H(){G()&&D&&(!1===w&&h(),V(),D=!1)}function G(){return $dyn.value(L)<=0&&!$dyn.value(B)&&!$dyn.value($dyn.clientBusy)}m.usingDisposable($dyn.observe(L,function(){H()})),m.usingDisposable($dyn.observe(B,function(){H()})),m.usingDisposable($dyn.observe($dyn.clientBusy,function(){H()}));var z=!1;function U(){if(f&&f.rowHeight&&m.DataSource){var e=P(),t=e+R(m.GetScrollRegionHeight())-1;e=m.ConvertClientCacheIndexToServerCacheIndex(e),t=m.ConvertClientCacheIndexToServerCacheIndex(t);var o=$dyn.value(m.FetchedDataStartPosition),n=$dyn.value(m.DataSource).length;return o<=e&&t<=o+n-1}return!0}function W(){f&&(m.UpdateScrollTop()&&(x.isDirty=!0),z||!U()&&f&&f.rowHeight&&f.cacheSize&&(z=!0,$dyn.callFunction(m.SetClientViewStart,m,[],void 0,void 0,function(e){z=!1;var t=M(m.GetScrollRegionHeight());e.PositionalParameters=[t],$dyn.log.list&&$dyn.log.list("List: SetClientViewStart command is executing with an argument: %s",t)})),D||(G()?V():D=!0)),N&&clearTimeout(N),A=!0,N=setTimeout(function(){N=void 0,A=!1,0<O&&(B(!0),L($dyn.value(L)-O),O=0)},100)}return m._loadDataNeeded=T,m._readjustScrollState=h,m._updateWhiteSpaceWidth=a,m._ensureFullViewPortContent=p,m._pageCoversViewport=U,m._getFirstVisibleRow=P,m._getDesiredPageStart=M,m._getDesiredPageSize=k,m._getVisibleRowCount=R,m._dataLoadPending=L,m._dataLoadedRenderPending=B,m._infiniteScrollMode=E,$dyn.value(m.InfiniteScroll)&&(m._scrollHandler=function(){i.css("margin-left",m.GetScrollRegion().scrollLeft),W()},m._resizeHandler=function(){a()}),m.usingDisposable($dyn.layout.registerEndReflowHandler(m.element,function(){m.IsRendering||(l&&clearTimeout(l),l=m.setTimeout(function(){$dyn.log.list&&$dyn.log.list("List: Reflow Handler invoked"),$dyn.value(m._allResourcesLoaded)&&(m.SyncHorizontalScrollOffset(),$dyn.value(m.InfiniteScroll)&&m.UpdateScrollRegionHeight(),m._renderTriggeredWhileHidden&&null!==u.offsetParent?(m._renderTriggeredWhileHidden=!1,m.rerender()):$dyn.value(m.InfiniteScroll)&&(h(),p())),l=void 0,m._reflowHandlerInvoked&&m._reflowHandlerInvoked()}))})),m._clientCacheStartUpdated=function(e){I+=e},m.usingDisposable($dyn.observe(m.InfiniteScroll,function(e){e||(m._scrollHandler=null,m._resizeHandler=null,f=m._scrollParameters=null,$(g).height(0),$(y).height(0))})),m.__restoreSelectionFocus=m._renderer.restoreSelectionFocus.bind(m._renderer),{apply:function(o,e){var p=this;u.dynVirtualContext={getContext:function(){return m._getVirtualControl.apply(m,arguments)}};var n=o;if(null!=o){if(!(e instanceof $dyn.DataContext))throw new TypeError("The argument 'dataContext' must be a an instance of $dyn.DataContext");if(!(o instanceof Array)){n=o.collection,m._deferred=o.deferred;var i=o.preRender,r=o.postRender,t=o.updating,a=o.skipRenderDuringStaticLoading}if(v){m.UpdateActiveItemBindings?(m._selectedItem=$dyn.observable(),p.updateSelectedItem=function(){var e=$dyn.value(n);if(e){var t=$dyn.value(o.selectedIndex)||0;e[t]&&m._selectedItem(e[t])}},p.updateSelectedItem()):m._selectedItem=$dyn.computed(function(){var e=$dyn.value(n),t=$dyn.value(o.selectedIndex)||0;return e&&e[t]});var s=new $dyn.DataContext(m._selectedItem,e);v.setAttribute("data-dyn-row-active",!0),d.dataBindItem(v,s)}var h;m._headersDataBound=!1,$dyn.observe(m.ShowHeader,function(e){m._header=$(m.element).find(".listHeader")[0],e&&!m._headersDataBound&&($dyn.dataBind(m._header,m.element.dynContext),m._headersDataBound=!0),m._header.hidden=!e}),p.resources=function(){var e=m.Root&&m.Root.element;return e?$dyn.resources.getResource(e):[]},p.applyForeach=function(){var e=u.dynForeachOptions;if(null!=(n=e.collection)){u.dynListRendering&&$dyn.log("list binding already pending"),u.dynListRendering=!0;var t=function(){var e=h;h=!1,m._renderer.renderBody(u,r,e)};$dyn.applyFunction(i),a&&$dyn.shell.isPreProcessing&&0<$dyn.value(L)||(m._deferred?$dyn.async(t,void 0,"Grid render foreach"):t()),c=!0,u.dynListRendering=!1}};var l=!!$dyn.peek($dyn.shell.isShellInitializing)&&$dyn.shell.isShellInitializing;p.list={collection:n,groupBy:o.groupBy,rerenderOptions:m._rerenderOptions,dataChanged:m._dataChangedVersion,dataLoadPending:L,selectedIndex:o.selectedIndex,markedIndexes:m.MarkedIndexes,allResourcesLoaded:m._allResourcesLoaded,shellInitializing:l,defaultActionEnabled:m.NavigationEnabled,columnHeaderMetadata:m.ColumnHeaderMetadata,internalSelectedRowId:m._dataProvider.InternalSelectedRowId,allowEdit:m.AllowEdit,userNotBusyAndSyncInactive:m._renderer.userNotBusyAndSyncInactive,rowSyncState:m._syncManager.rowSyncState,dataSelectedRowId:m._dataProvider.DataSelectedRowId},p.applyChanges=function(e){var t=!1,o=!1,n=!1,i=!1,r=!1;if(!$dyn.shell.isShellInitializing()&&m._allResourcesLoaded()&&($dyn.log.list&&$dyn.log.list("List: Apply changes %o",e),(e.collection||e.dataLoadPending||e.dataChanged||e.pendingSelectedRow)&&(n=!0),(e.allResourcesLoaded||e.shellInitializing)&&(n=h=i=!0),e.columnHeaderMetadata&&(i=!0,m.isResizing||(n=h=!0)),(e.allowEdit||e.rerenderOptions||e.groupBy||e.defaultActionEnabled)&&(n=h=!0),e.selectedIndex&&(t=!0),e.markedIndexes&&(o=!0),e.rowSyncState&&(r=!0),i&&m._renderHeader(),(e.userNotBusyAndSyncInactive||e.dataSelectedRowId||t)&&$dyn.peek(m._renderer.userNotBusyAndSyncInactive())&&!m._fastEditingAllowed()&&m._dataProvider.syncInternalSelectedRowToDataSelectedRow(),(t||e.userNotBusyAndSyncInactive||e.internalSelectedRowId)&&m._renderer._updateSelectedRow(),!n||(e.allowEdit&&(m._renderer._forceRender=!0),m.UpdateActiveItemBindings&&(h||e.collection)&&p.updateSelectedItem(),!1===p.render()))){if(e.internalSelectedRowId){var a=m._renderer,s=a._lastSelectingRowId=a._selectingRowId,l=a._selectingRowId=$dyn.peek(m._dataProvider.InternalSelectedRowId),u=a._rowIdToRenderedRow,d=u[s],c=u[l];a._updateSelectingRow(s,d&&a._getRenderedRowElementByRowData(d)),a._updateSelectingRow(l,c&&a._getRenderedRowElementByRowData(c)),!$dyn.peek(m._dataLoadedRenderPending)&&c&&l!==s&&(a.focusCellInActiveRow()||a.scrollUserSelectedRowIntoView())}o&&m._renderer._markedIndexesChanged(),r&&m._renderer._rowSyncStateChanged()}},m.usingDisposable($dyn.bulkObserve(p.list,p.applyChanges,t,p)),$dyn.observe(p.resources(),function(e){if(e&&0<e.length){var o=!0;$.each(e,function(e,t){void 0===t||t.loaded||(o=!1)}),m._allResourcesLoaded(o),o||$.when.apply($.when,e.map(function(e){if(!e.loaded)return e.promise()})).done(function(){m._resetCachedInactiveItemElement(),m._allResourcesLoaded(!0)})}else m._allResourcesLoaded(!0)}),p.render=function(){if(0<$dyn.value(L))return $dyn.log.list&&$dyn.log.list("Render: Not rendering because a data load is pending"),!1;if(null===u.offsetParent&&!m.ForceInvisibleRender&&!m.IsInsidePreviewForm())return $dyn.log.list&&$dyn.log.list("Render: Not visible"),!(m._renderTriggeredWhileHidden=!0);var e={};for(var t in p.list)e[t]=$dyn.value(p.list[t]);u.dynForeachOptions=e,p.applyForeach()}}},dispose:function(){1==c&&(e.children().each(function(e,t){$dyn.unbind(t)}),c=!1),m._selectedRow&&!$.contains(u,m._selectedRow)&&($dyn.unbind(m._selectedRow),m._selectedRow=null),m._headersDataBound&&($dyn.unbind(m._header),m._headersDataBound=!1),N&&clearTimeout(N),u.dynVirtualContext&&(u.dynVirtualContext=null),u.dynForeachOptions&&(u.dynForeachOptions=null)}}},$dyn.controls.List.RowOperationsManager=function(e,t,o,n){this._listContext=e,this._dataProvider=t,this._renderer=o,this._syncManager=n,this._activeCell=$dyn.observable(""),this._listContext.ToggleMark&&(this.ToggleMark=this._listContext.ToggleMark)},$dyn.controls.List.RowOperationsManager.prototype={_dataProvider:null,_renderer:null,_syncManager:null,_activeCell:null,RowClicked:function(e){$dyn.log.list&&$dyn.log.list("List: RowClicked");var t=$(e.target).closest(".rowTemplate")[0],o=this._renderer.getInternalRowIdByElement(t),n=$dyn.peek(this._dataProvider.InternalSelectedRowId),i=e.target,r=!(!i||!i.classList.contains("checkMarkTarget"));if(t&&$dyn.value(this._listContext.Enabled)&&(!this._listContext._hasTextSelection(e)||r)){var a,s=this._listContext.InputMode=$dyn.ui.InputType.mouse,l=this._listContext._renderer.getActivePageRelatedIndex(o);switch(e.which){case $dyn.ui.MouseButtonCodes.leftButton:var u=e.ctrlKey||e.shiftKey;!u&&this._listContext._isInvalidMarkTarget(e)||(a=this.calculateMarkMode(e),$dyn.log.list&&$dyn.log.list("List: Mark Mode is "+a),a===$dyn.controls.List.MarkMode.toggle&&o===n&&this.ExecuteRowMarkUpdate()),a===$dyn.controls.List.MarkMode.select&&o===n&&!this._listContext.MarkedIndexes()[l]&&(!$dyn.peek(this._listContext._fastEdit)||this._listContext._syncManager.isQueueEmpty()&&$dyn.peek(this._listContext._fastEdit))&&this.ExecuteRowMarkUpdate();$dyn.length(this._listContext.DataSource);this.FocusRowAndSelectCell(null,s,e),u||(this.OnMouseSecondaryNavigation(e),this._listContext&&this._listContext.element&&this.formActiveRowChangedNotify());break;case $dyn.ui.MouseButtonCodes.rightButton:var d=this._listContext.MarkedIndexes()[l];this.calculateMarkMode(e),d&&!this._listContext.IsCardList()?this._listContext._markingAction=$dyn.controls.List.MarkMode.none:o===n&&this.ExecuteRowMarkUpdate(),this.FocusRowAndSelectCell(null,s,e)}}},FocusRowRelativeToActiveRow:function(e,t,o,n,i){this.FocusRowAndSelectCell(e,o,n,i),n&&n.preventDefault&&n.preventDefault()},PerformNonEditModeNavigationAction:function(e){var t=!1;if(!$dyn.value(this._listContext.IsNoResultsMessageDisplayed)){t=!0;var o=this._renderer.getUserSelectedElement(),n=this._renderer.getInternalRowIdByElement(o);if(!$dyn.value(this._listContext.AllowEdit)&&$dyn.value(this._listContext.Enabled)&&$dyn.value(this._listContext.NavigationAction)&&$dyn.value(this._listContext.ForcePrimaryNavigation))this._syncManager.queueDefaultAction(n),e&&e.preventDefault&&e.preventDefault();else if(this._listContext.IsNavigationAction(e)&&$dyn.value(this._listContext.NavigationEnabled)){if(!o)return!1;e&&e.preventDefault&&e.preventDefault(),this._listContext.Root&&this._listContext.Root.updateLastClientSelectedControl&&this._listContext.Root.updateLastClientSelectedControl(),this._syncManager.queueDefaultAction(n)}this._listContext&&this._listContext.element&&this.formActiveRowChangedNotify()}return t},calculateMarkMode:function(e){var t,o=$(e.target);return $dyn.value(this._listContext.IsMarkingEnabled)||$dyn.value(this._listContext.IsSelectionIndicatorVisible)?"click"===e.type&&(o.hasClass("checkMarkTarget")||o.hasClass("markContainer"))?t=this._listContext._markingAction=$dyn.controls.List.MarkMode.toggle:($dyn.value(this._listContext.IsMarkingEnabled)?e.ctrlKey&&e.shiftKey?t=$dyn.controls.List.MarkMode.rangeExpansion:e.ctrlKey?(t=e.which==$dyn.ui.KeyCodes.upArrow||e.which==$dyn.ui.KeyCodes.downArrow?$dyn.controls.List.MarkMode.none:$dyn.controls.List.MarkMode.toggle,this._rangeSelection=!1):e.shiftKey?t=$dyn.controls.List.MarkMode.rangeSelect:$dyn.value(this._listContext.IsSelectionIndicatorVisible)?(t=$dyn.controls.List.MarkMode.select,this._listContext._rangeSelection=!1):$dyn.value(this._listContext.IsSelectionIndicatorVisible)||(t=$dyn.controls.List.MarkMode.clearMark,this._listContext._rangeSelection=!1):$dyn.value(this._listContext.IsSelectionIndicatorVisible)&&(t=$dyn.controls.List.MarkMode.select),this._listContext._rangeSelection||t!=$dyn.controls.List.MarkMode.rangeSelect||(this._listContext._rangeSelection=!0,this._listContext._rangePivot=this._listContext.SelectedIndex()+$dyn.value(this._listContext.FetchedDataStartPosition)),this._listContext._markingAction=t,this._listContext._markingAction):t=this._listContext._markingAction=$dyn.controls.List.MarkMode.none},rangePivotWithinPage:function(){return this._listContext._rangePivot-$dyn.value(this._listContext.FetchedDataStartPosition)},ExecuteRowMarkUpdate:function(){this._listContext._supportsMarking()&&this._syncManager.queueToggleMark($dyn.peek(this._dataProvider.InternalSelectedRowId))},OnKeyboardSecondaryNavigation:function(e){if($dyn.value(this._listContext.Enabled)){if(this._listContext.IsNavigationAction(e)&&$dyn.value(this._listContext.NavigationEnabled)){var t=$(e.target).closest(".rowTemplate")[0];if(!t)return;e.preventDefault();var o=this._renderer.getInternalRowIdByElement(t);this._syncManager.queueDefaultAction(o)}}else e.preventDefault()},OnMouseSecondaryNavigation:function(e){function t(){e.preventDefault(),e.stopImmediatePropagation(),$dyn.log.stopPropagation&&$dyn.log.stopPropagation("Mouse Secondary Navigation (Navigation Action)")}if($dyn.value(this._listContext.Enabled)){var o=$(e.target).closest(".rowTemplate")[0];if(!o)return;var n=this._renderer.getInternalRowIdByElement(o);if(!$dyn.value(this._listContext.AllowEdit)&&$dyn.value(this._listContext.Enabled)&&$dyn.value(this._listContext.NavigationAction)&&$dyn.value(this._listContext.ForcePrimaryNavigation)){var i=$dyn.context(e.target);i&&$dyn.value(i.AllowEdit)||t(),this._syncManager.queueDefaultAction(n)}else this._listContext.IsNavigationAction(e)&&$dyn.value(this._listContext.NavigationEnabled)?($dyn.util.clickedText(e.target)||this._listContext.IsCardList())&&(t(),this._syncManager.queueDefaultAction(n)):this._listContext.IsValidSecondaryNavigation(e)||t()}else t()},ToggleMark:function(e){var t=this._dataProvider.MarkedIndexes(),o=this._listContext.SelectedIndex();t[o]=!t[o]},FocusRowAndSelectCell:function(e,t,o,n){var i,r,a;if(this._listContext.arrowKeyDownTriggered=!1,$dyn.log.list&&$dyn.log.list.info("List: Entering FocusRowAndSelectCell"),$dyn.log.list&&$dyn.log.list.info("List: Row focus, relative: %s, mouse: %s, event: %o",e,t===$dyn.ui.InputType.mouse,o),this._dataProvider.InternalSelectedRowId()==this._dataProvider.DataSelectedRowId()?this._listContext.ClearMessages=!0:this._listContext.ClearMessages=!1,t===$dyn.ui.InputType.mouse){if(a=$(o.target).closest(".rowTemplate")[0])if((r=this._renderer.getInternalRowIdByElement(a))!==this._dataProvider.InternalSelectedRowId()&&this.updateActiveElement(a),!(!!this._listContext.Root&&this._listContext.Root.HasInvalidControls())||$dyn.util.waitForClientBusy()||$dyn.value(this._listContext._fastEdit))i=r,this._activeCell(this._listContext._getParentControlName(o.target)),this._dataProvider.changeRow(i);else{var s=this._dataProvider.InternalSelectedRowId()===this._dataProvider.DataSelectedRowId(),l=r!==this._dataProvider.DataSelectedRowId();s&&l&&(this._listContext.Root?this._listContext.Root.SetFocusToInvalidControl():$dyn.errorMessageBox({Text:$dyn.label("BoundaryError"),Label:"BoundaryError"}))}}else if(a=this._renderer.getUserSelectedElement(),this._listContext.arrowKeyDownTriggered=!0,a)if(r=this._renderer.getInternalRowIdByElement(a),(i=this._renderer.getRowIdByOffset(e))!==this._dataProvider.InternalSelectedRowId()&&this.updateActiveElement(a),!(!!this._listContext.Root&&this._listContext.Root.HasInvalidControls())||$dyn.util.waitForClientBusy()||$dyn.value(this._listContext._fastEdit))if(i)this._dataProvider.changeRow(i);else if(n)if(this._dataProvider.isBackendLastRow(r)){if(this._listContext.CreateNewRecordOnKeyDown)if($dyn.peek(this._listContext._fastEdit)){if((void 0===this._listContext.downArrowKeyUpTriggered||this._listContext.downArrowKeyUpTriggered)&&$dyn.value(this._listContext.AllowCreateOnKeyDown)){var u=$dyn.util.findFirstFocusableControl(this._listContext.element,void 0,!1);this._activeCell(this._listContext._getParentControlName(u)),this._dataProvider.createRow(r,!0),this._listContext.downArrowKeyUpTriggered=!1}}else this._syncManager.rowKeyDownNewRowInNonFastEditMode()}else $dyn.peek(this._listContext.InfiniteScroll)||this._syncManager.queueChangeRowByDelta(r,e,!1);else this._syncManager.queueChangeRowByDelta(r,e,!1);else o&&o.stopImmediatePropagation(),this._listContext.Root.SetFocusToInvalidControl();else this._syncManager.queueChangeRowByDelta(void 0,e,!1);$dyn.log.list&&$dyn.log.list.info("List: Leaving FocusRowAndSelectCell")},updateActiveElement:function(e,t){var o=!1;if(document.activeElement){var n=$(document.activeElement).closest("[data-dyn-controlname]").addBack()[0],i=$(e).find(n)[0];if(i){var r=$dyn.context(i);r||(this._listContext._getVirtualControl(i),r=$dyn.context(i)),r&&(r.updateValue&&(o=r.updateValue(!0,!1,t)),r.focusOutCleanup&&r.focusOutCleanup(!0))}}return o},formActiveRowChangedNotify:function(){if($dyn.util.isInZoomWidthMode()&&this.isEementInSidePanel()){var e=this._listContext.Root.SidePanel;e&&e.SidePanelElement&&$dyn.context(e.SidePanelElement).Visible&&e.toggleVisibility()}},isEementInSidePanel:function(){return void 0===this.elementInSidePanel&&(this.elementInSidePanel=!1,this._listContext.element.parentElement&&this._listContext.element.parentElement.parentElement&&this._listContext.element.parentElement.parentElement.classList.contains("SidePanel")&&(this.elementInSidePanel=!0)),this.elementInSidePanel},getActiveCell:function(){return this._activeCell},dispose:function(){}}}(),function(){var m=-1,v=1;$dyn.controls.List.DataProvider=function(e){var t=this;this._externalPropertyBag=e.PropertyBag,this.Collection=$dyn.observable(),$dyn.observe(this.DataSource,function(e){t.Collection(e)}),e.GetDataId&&(this._getDataId=e.GetDataId),e.GetDataVersion&&(this._getDataVersion=e.GetDataVersion),this._enumerator=new $dyn.controls.List.DataProvider.Enumerator(this),this._internalRowIdToDataRowId={},this._dataRowIdToInternalRowId={},this.DataSelectedRowId=$dyn.cachedComputed(this._getDataSelectedRowId,null,this),this.InternalSelectedRowId=$dyn.observable(null),this.pendingRowToPivot={},this.pivotToPendingRows={},this._isCreateRowFromKeyDown=!1,this.onRowBecameCommitted=new $dyn.eventHost,this._disposables=[];e.SelectedIndex},$dyn.controls.List.DataProvider.prototype={_internalRowIdToDataRowId:null,_dataRowIdToInternalRowId:null,_internalRowIdAllocator:1,_rowInsertDirection:1,_disposables:null,_enumerator:null,committedRowType:"committed",_isCreateRowFromKeyDown:!1,_externalPropertyBag:null,get FetchedDataStartPosition(){return this._getExternalProperty("FetchedDataStartPosition")},set FetchedDataStartPosition(e){this._setExternalProperty("FetchedDataStartPosition",e)},get CacheSize(){return this._getExternalProperty("CacheSize")},set CacheSize(e){this._setExternalProperty("CacheSize",e)},get DataAbove(){return this._getExternalProperty("DataAbove")},set DataAbove(e){this._setExternalProperty("DataAbove",e)},get DataBelow(){return this._getExternalProperty("DataBelow")},set DataBelow(e){this._setExternalProperty("DataBelow",e)},get DataSource(){return this._getExternalProperty("DataSource")},set DataSource(e){this._setExternalProperty("DataSource",e)},get SelectedIndex(){return this._getExternalProperty("SelectedIndex")},set SelectedIndex(e){this._setExternalProperty("SelectedIndex",e)},get MarkedIndexes(){return this._getExternalProperty("MarkedIndexes")},set MarkedIndexes(e){this._setExternalProperty("MarkedIndexes",e)},get DataChanged(){return this._getExternalProperty("_dataChangedVersion")},Collection:null,InternalSelectedRowId:null,DataSelectedRowId:null,rowIdByPageIndexGetter:null,_getExternalProperty:function(e){if(this._externalPropertyBag)return this._externalPropertyBag[e]},_setExternalProperty:function(e,t){this._externalPropertyBag&&(this._externalPropertyBag[e]=t)},_nextDataId:0,_getDataId:function(e){if(e&&"[object Object]"===Object.prototype.toString.call(e)){if(!e.__listDataId){var t=++$dyn.controls.List.DataProvider.prototype._nextDataId;Object.defineProperty(e,"__listDataId",{value:t,enumerable:!1})}return e.__listDataId}},_getDataVersion:function(e){return 1},_allocateInternalRowId:function(){return this._internalRowIdAllocator++},pendingRowToPivot:{},pivotToPendingRows:{},isRowPending:function(e){return this.pendingRowToPivot[e]},hasMarkedRows:function(e){for(var t=!1,o=this.DataSource?$dyn.length(this.DataSource):0,n=this.MarkedIndexes(),i=0;i<o&&!t;i++)e&&i===$dyn.peek(this.SelectedIndex)||(t=!0===n[i]);return t},_getDataSelectedRowId:function(){var e,t=$dyn.value(this.Collection),o=$dyn.value(this.SelectedIndex);return $dyn.value(this.DataChanged),0<=o&&o<t.length?e=this.getOrCreateInternalRowId(this._getDataId($dyn.value(this.Collection)[$dyn.value(o)])):this.rowIdByPageIndexGetter&&(e=this.rowIdByPageIndexGetter(o)),$dyn.log.list&&$dyn.log.list("List: [Data Provider] Recalculated DataSelectedRowId. New value: "+e),e},createRow:function(e,t,o){$dyn.log.list&&$dyn.log.list.info("List: Entering DataProvider::createRow"),this._isCreateRowFromKeyDown=t;var n,a=this,i=this._allocateInternalRowId(),r=void 0!==e?e:this.InternalSelectedRowId,s=o||this._rowInsertDirection,l=s;function u(e,t,o){for(var n=t;n<e.length;++n){var i=e[n];if(i){var r=i.id;a.pendingRowToPivot[r]&&a.pendingRowToPivot[r].order&&(a.pendingRowToPivot[r].order+=o)}}}if(this.isRowPending(r)){n=this.pendingRowToPivot[r].pivot;var d=this.pendingRowToPivot[r].order,c=d<0?m:v,p=Math.abs(d);c!==s&&--p,this.pivotToPendingRows[n][c].splice(p,0,{id:i,version:1,marked:!1}),u(this.pivotToPendingRows[n][c],p+1,c),l=c*(p+1)}else n=this.getDataRowIdByInternalRowId(r),this.pivotToPendingRows[n]||(this.pivotToPendingRows[n]={},this.pivotToPendingRows[n][v]=[],this.pivotToPendingRows[n][m]=[]),this.pivotToPendingRows[n][s].unshift({id:i,version:1,marked:!1}),u(this.pivotToPendingRows[n][s],1,s);this.pendingRowToPivot[i]={pivot:n,order:l},$dyn.ui.updateBlock(null,function(){$dyn.isObservable(this.DataSource)&&this.DataSource.valueChanged.raise(),this.InternalSelectedRowId(i)},this),$dyn.log.list&&$dyn.log.list.info("List: New row id %s",i),$dyn.log.list&&$dyn.log.list.info("List: Leaving DataProvider::createRow")},deleteRow:function(e){if(this.isRowPending(e)){var t=this.pendingRowToPivot[e].pivot,o=(this.getInternalRowId(t),this.pendingRowToPivot[e].order),n=o<0?-1:1,i=!1,r=null;if($dyn.peek(this.InternalSelectedRowId)===e&&(i=!0,-1!=t)){var a=this.getEnumerator();a.reset(),a.initWithRowId(e),a.moveNext()&&(r=a.current().id)}var s=Math.abs(o)-1;if(this.pivotToPendingRows[t][n].splice(Math.abs(o)-1,1),this.pivotToPendingRows[t][1].length||this.pivotToPendingRows[t][-1].length||delete this.pivotToPendingRows[t],this.pivotToPendingRows[t]&&this.pivotToPendingRows[t][n].length)for(var l=s;l<this.pivotToPendingRows[t][n].length;++l){var u=this.pivotToPendingRows[t][n][l].id;this.pendingRowToPivot[u]&&this.pendingRowToPivot[u].order&&(this.pendingRowToPivot[u].order-=n)}return delete this.pendingRowToPivot[e],$dyn.ui.updateBlock(null,function(){$dyn.isObservable(this.DataSource)&&this.DataSource.valueChanged.raise(),i&&(null!=r?this.InternalSelectedRowId(r):this.InternalSelectedRowId(this._getBottomRowId()))},this),!0}return!1},updatePivotTables:function(e,t){if(e&&0<=t){this.lastDeletedActiveRowId=-1,this._firstRowDeleted=!1;var o=this.Collection()[t],n=this._getDataId(o);if(void 0!==this.pendingRowToPivot[e]){var i=this.pendingRowToPivot[e].pivot,r=this.pendingRowToPivot[e].order,a=r<0?m:v,s=this.pivotToPendingRows[i][a];if(this.pivotToPendingRows[i][a]=[],1<s.length){var l=Math.abs(r),u=s.slice(l),d=s.slice(0,l-1);d&&0<d.length?this.pivotToPendingRows[i][a]=d:(this.pivotToPendingRows[i]={},this.pivotToPendingRows[i][m]=[],this.pivotToPendingRows[i][v]=[],delete this.pivotToPendingRows[i]),u&&(this.pivotToPendingRows[n]={},this.pivotToPendingRows[n][m]=[],this.pivotToPendingRows[n][v]=[],this.pivotToPendingRows[n][a]=u)}if(u)for(var c=0;c<u.length;c++){var p=u[c];this.pendingRowToPivot[p.id].pivot=n,this.pendingRowToPivot[p.id].order=a*(c+1)}this._dataRowIdToInternalRowId[n]=e,this._internalRowIdToDataRowId[e]=n;var h=this.DataSelectedRowId();e!==h&&delete this._internalRowIdToDataRowId[h],this.DataSelectedRowId.valueChanged.onDependencyChanged(),delete this.pendingRowToPivot[e],this.onRowBecameCommitted.raise(e)}}},updatePivotTablesAfterDelete:function(e,t,o){if(e){var n;if(1<=t){var i=this.Collection()[t-1];n=this._getDataId(i)}else{if(1<=this.Collection().length&&!o){i=this.Collection()[t];n=this._getDataId(i)}else n=-1;this._firstRowDeleted=!0}var r,a=this._internalRowIdToDataRowId[e],s=this.pivotToPendingRows[a];if(s&&(s[v]&&0<s[v].length&&s[v][0]?r=s[v][0].id:s[m]&&0<s[m].length&&s[m][0]&&(r=s[m][0].id)),r&&void 0!==this.pendingRowToPivot[r]){var l=this.pendingRowToPivot[r].pivot,u=this.pendingRowToPivot[r].order<0?m:v,d=this.pivotToPendingRows[l][u];if(delete this.pivotToPendingRows[l],d){var c;this.pivotToPendingRows[n]={},this.pivotToPendingRows[n][m]=[],this.pivotToPendingRows[n][v]=[],this.pivotToPendingRows[n][u]=d;for(var p=0;p<d.length;p++){var h=d[p];this.pendingRowToPivot[h.id].pivot=n,this.pendingRowToPivot[h.id].order=u*(p+1),0==p&&(c=h.id)}-1==n&&(this._dataRowIdToInternalRowId[n]=c,this._internalRowIdToDataRowId[c]=n)}}}},updateDataId:function(e,n){var i=this,t=this._dataRowIdToInternalRowId[e];t&&(delete this._dataRowIdToInternalRowId[e],this._dataRowIdToInternalRowId[n]=t,this._internalRowIdToDataRowId[t]=n);var o=this.pivotToPendingRows[e];if(o){var r=o[-1],a=o[1],s=function(e){for(var t=0;t<e.length;++t){var o=e[t];o&&(i.pendingRowToPivot[o.id].pivot=n)}};r&&s(r),a&&s(a),this.pivotToPendingRows[n]=o,delete this.pivotToPendingRows[e]}},changeRow:function(e){$dyn.log.list&&$dyn.log.list.info("List: Entering DataProvider::changeRow for internalRowId %s",e),this.InternalSelectedRowId(e,!0),$dyn.log.list&&$dyn.log.list.info("List: Leaving DataProvider::changeRow")},syncInternalSelectedRowToDataSelectedRow:function(){this.InternalSelectedRowId($dyn.peek(this.DataSelectedRowId)),$dyn.log.list&&$dyn.log.list("List: [Data Provider] Synced internal selected row id to data selected row id. New value: "+$dyn.peek(this.InternalSelectedRowId))},getEnumerator:function(){return this._enumerator},getOrCreateInternalRowId:function(e){var t=this._dataRowIdToInternalRowId[e];return t||(t=this._allocateInternalRowId(),this._dataRowIdToInternalRowId[e]=t,this._internalRowIdToDataRowId[t]=e),t},getIsCreateRowFromKeyDown:function(){return this._isCreateRowFromKeyDown},setIsCreateRowFromKeyDown:function(e){this._isCreateRowFromKeyDown=e},getInternalRowId:function(e){return this._dataRowIdToInternalRowId[e]},getPageIndexByInternalRowId:function(e){return this.getPageIndexByDataRowId(this.getDataRowIdByInternalRowId(e))},getDataRowIdByInternalRowId:function(e){return this._internalRowIdToDataRowId[e]},getRelativeDataRowIdByInternalRowId:function(e){var t=void 0,o=this.pendingRowToPivot[e];return o&&(t=o.pivot),t},getPageIndexByDataRowId:function(e){var t=$dyn.value(this.Collection);if(t)for(var o=0;o<t.length;++o){var n=t[o];if(n)if(this._getDataId(n)===e)return o}},getDataRowIdByPageIndex:function(e){var t=$dyn.value(this.Collection);if(t){var o=t[e];if(o)return this._getDataId(o)}},getInternalRowIdByPageIndex:function(e){var t=this.getDataRowIdByPageIndex(e);return this._dataRowIdToInternalRowId[t]},_getDataByInternalRowId:function(e){var t=$dyn.value(this.Collection),o=this.getPageIndexByInternalRowId(e);if(0<=o&&o<t.length)return t[o]},getDataProviderItemByInternalRowId:function(e){var t=this.getPageIndexByInternalRowId(e);return this._getDataProviderItemByIndex(t)},getFirstItem:function(){return this._getDataProviderItemByIndex(0)},getLastItem:function(){var e=$dyn.value(this.Collection);if(e.length)return this._getDataProviderItemByIndex(e.length-1)},isBackendLastRow:function(e){var t=$dyn.peek(this.Collection);if(!this._isActivePageLast()||!t.length)return!1;var o=e;this.isRowPending(e)&&(o=this._dataRowIdToInternalRowId[this.pendingRowToPivot[e].pivot]);var n=(t=$dyn.peek(this.Collection))[t.length-1];return this._dataRowIdToInternalRowId[this._getDataId(n)]===o},isIndexWithinPage:function(e){return 0<=e&&e<this.getPageLength()},_isActivePageLast:function(){var e=$dyn.peek(this.Collection),t=$dyn.peek(this.CacheSize),o=$dyn.peek(this.FetchedDataStartPosition);return!$dyn.value(this.DataBelow)&&e.length+o>=t},_getDataProviderItemByIndex:function(e){var t=$dyn.value(this.Collection),o=t&&t[e];if(o){var n=this._getDataId(o),i=this.getOrCreateInternalRowId(n),r=this._getDataVersion(o),a=$dyn.peek(this.DataSelectedRowId);return $.extend({},o,{id:i,marked:$dyn.peek(this.MarkedIndexes)[e],version:r,selected:a===i,type:this.committedRowType})}},_getPendingRowItemByIndex:function(e,t){var o=this.pivotToPendingRows[e];if(o)return(t<0?o[-1]:o[1])[Math.abs(t)-1]},_getPendingRowItemCollectionByIndex:function(e,t){var o=this.pivotToPendingRows[e];if(o)return t<0?o[-1]:o[1]},_getTopPendingRowIndexByPivot:function(e){var t=this.pivotToPendingRows[e];return t?-t[-1].length:0},_getBottomPendingRowIndexByPivot:function(e){var t=this.pivotToPendingRows[e];return t?t[1].length:0},_getBottomRowId:function(){var e=$dyn.value(this.Collection);if(!e||!e.length)return null;var t=this.getDataRowIdByPageIndex(e.length-1),o=this.getInternalRowId(t),n=this._getBottomPendingRowIndexByPivot(t);return n?this.pivotToPendingRows[t][1][n-1].id:o},getPageLength:function(){return $dyn.peek(this.Collection).length},dispose:function(){for(var e=0;e<this._disposables.length;++e){var t=this._disposables[e];t&&t.dispose&&"function"==typeof t.dispose&&t.dispose()}}},$dyn.controls.List.DataProvider.Enumerator=function(e){this._dataProvider=e,this.reset()},$dyn.controls.List.DataProvider.Enumerator.prototype={_dataProvider:null,_collectionIndex:null,_pendingRowIndex:null,_beforeCollection:!0,_afterCollection:!1,reset:function(){var e=$dyn.value(this._dataProvider.Collection);if(e&&0<e.length){this._collectionIndex=0;var t=this._dataProvider._getDataId(e[this._collectionIndex]);this._pendingRowIndex=this._dataProvider._getTopPendingRowIndexByPivot(t)||0,this._beforeCollection=!0,this._afterCollection=!1}else this._collectionIndex=null,this._pendingRowIndex=null,this._beforeCollection=!1,this._afterCollection=!0},initWithRowId:function(e){if(this._dataProvider.isRowPending(e)){if(!this._dataProvider.pendingRowToPivot[e])return;var t=this._dataProvider.pendingRowToPivot[e].pivot,o=this._dataProvider.pendingRowToPivot[e].order,n=this._dataProvider.getPageIndexByDataRowId(t);this._collectionIndex=n,this._pendingRowIndex=o}else this._collectionIndex=this._dataProvider.getPageIndexByInternalRowId(e),this._pendingRowIndex=0;this._beforeCollection=!1,this._afterCollection=!1},current:function(e,t){var o;if(!this._beforeCollection&&!this._afterCollection){var n=$dyn.value(this._dataProvider.Collection);if(null!==this._collectionIndex&&void 0!==this._collectionIndex){var i=n[this._collectionIndex],r=this._dataProvider._getDataId(i);if(!r&&e){r=-1;var a=this._dataProvider._getPendingRowItemCollectionByIndex(r,1);a&&a.length>t&&(o=a[t])}else o=0===this._pendingRowIndex?this._dataProvider._getDataProviderItemByIndex(this._collectionIndex):this._dataProvider._getPendingRowItemByIndex(r,this._pendingRowIndex)}}return o},moveNext:function(){var o=this;if(this._afterCollection)return!1;if(this._beforeCollection)return!(this._beforeCollection=!1);function e(){if(o._collectionIndex++,o._collectionIndex>=n.length)return!(o._afterCollection=!0);var e=n[o._collectionIndex],t=o._dataProvider._getDataId(e);return o._pendingRowIndex=o._dataProvider._getTopPendingRowIndexByPivot(t)||0,!0}var t,n=$dyn.value(this._dataProvider.Collection),i=n[this._collectionIndex],r=this._dataProvider._getDataId(i),a=this._dataProvider.pivotToPendingRows[r];return a&&(a[-1],t=a[1]),0===this._pendingRowIndex?t&&t.length?(this._pendingRowIndex=1,!0):e():this._pendingRowIndex<0?(this._pendingRowIndex++,!0):(this._pendingRowIndex++,!(!t||this._pendingRowIndex>t.length)||e())}}}(),function(){var u=$dyn.ui.selector;$dyn.controls.List.Renderer=function(e,t){var o=this;this._listContext=e,this._dataProvider=t.dataProvider,this._syncEngineState=t.syncEngineState,this._listBody=t.listBody,this._invalidRow=t.invalidRow,this._renderForeachTask=$dyn.bindingHandlers.foreach.task,this._itemTask=$dyn.bindingHandlers.foreach.itemTask,this._rowIdToRenderedRow={},this._rowIds=[],this._userActionBusy=$dyn.observable(!1),this._userActionBusyRenderPending=$dyn.observable(!1),this.userNotBusyAndSyncInactive=$dyn.cachedComputed(this._userNotBusyAndSyncInactive,null,this),this._disposables=[],this.rowSyncState=t.rowSyncState,this._rowHasPendingEdit=t.rowHasPendingEdit,this._markAllRecords=t.markAllRecords,this._listContext.Root&&this._disposables.push($dyn.observe(this._listContext.Root.ActiveControl,function(e){o._listContext._fastEditingAllowed()||o._syncActiveCellToActiveControl()})),this._disposables.push($dyn.observe(this._invalidRow,this._invalidRowChanged,this)),this._disposables.push($dyn.observe(this._markAllRecords,this._setAllMarkedRows,this)),this._onRowBecameCommittedSubscription=this._dataProvider.onRowBecameCommitted.subscribe(this._onRowBecameCommitted,this)},$dyn.controls.List.Renderer.prototype={_activeCell:null,_markAllRecords:!1,allRecordsMarkTriggered:!1,_dataProvider:null,_rowIds:null,_rowIdToRenderedRow:null,_listContext:null,_listBody:null,get _selectedRowId(){return this._activeRowInTheDOM()?this.getInternalRowIdByElement(this._listContext._selectedRow):null},userNotBusyAndSyncInactive:null,_selectingRowId:null,_inactiveRowElement:null,_activeRowElement:null,_syncEngineState:null,_invalidRow:null,_previousInvalidRow:null,_disposables:null,_placeholderRowId:"_placeholderRowId",_isInvalidClass:"is-invalid",_isLoadingClass:"is-loading",_rowSelecting:"data-dyn-row-selecting",_renderModeMerge:"merge",_renderModeReplace:"replace",_renderedGroupBy:!1,_userActionBusyTimer:void 0,_throttleOnResize:null,_recalculateRowHeightWithinLayoutBlock:!0,_userActionBusy:null,_userActionBusyRenderPending:null,_fullRenderPostponed:!1,_lastRenderMode:"replace",_isRendering:!1,_rowHasPendingEdit:function(e){return!1},_renderForeachTask:null,_itemTask:null,_rowHeight:null,_deletedPendingRows:null,_firstRowDeleted:null,getRowHeight:function(e,t){if(!this._rowHeight||t){var o=$(e).find(".rowTemplate.listItem").last();o.length&&null!==o[0].offsetParent&&!$dyn.shell.isShellInitializing()&&(this._rowHeight=o.outerHeight())}return this._rowHeight},_createNewInactiveRowElement:function(e){this._listContext._inactiveItem(e);var t=$(this._listContext._inactiveItemElement).clone(!0,!0);return t.find("[id]").each(function(){this.id=this.id+"_row_"+e.id}),t[0].dynRowItem=e,t.attr("id",t.attr("id")+"_row_"+e.id),t.attr("data-dyn-row-active",!1),t[0]},_getRenderedRowByIndex:function(e){return this._getRenderedRowById(this._rowIds[e])},_getRenderedRowById:function(e){return this._rowIdToRenderedRow[e]},_getFirstRenderedPageRow:function(){for(var e=$dyn.peek(this._dataProvider.Collection),t=0,o=e&&e.length;t<o;++t){var n=this._dataProvider.getDataRowIdByPageIndex(t),i=this._dataProvider.getInternalRowId(n);if(this._rowIdToRenderedRow[i])return this._rowIdToRenderedRow[i]}},_getLastRenderedPageRow:function(){for(var e=$dyn.peek(this._dataProvider.Collection),t=e&&e.length-1;0<=t;--t){var o=this._dataProvider.getDataRowIdByPageIndex(t),n=this._dataProvider.getInternalRowId(o);if(this._rowIdToRenderedRow[n])return this._rowIdToRenderedRow[n]}},isRowWithinActivePage:function(e){var t=this._rowIdToRenderedRow[e],o=this._getFirstRenderedPageRow(),n=this._getLastRenderedPageRow();if(t&&o&&n){var i=t.order,r=o.order,a=n.order;return r<=i&&i<=a}},newRecord:function(e){var t=$dyn.util.findFirstFocusableControl(this._listContext.element);if($dyn.peek(this._listContext._fastEdit)&&e){this._activeCell(this._listContext._getParentControlName(t));var o=this.getInternalRowIdByElement(e);return this._dataProvider.createRow(o),!0}return!1},deleteRecord:function(e,t){if($dyn.peek(this._listContext._fastEdit)){this._deletedPendingRows=null;for(var o=0;o<this.getRenderedRowCount();++o){var n=this._getRenderedRowByIndex(o);n&&n.id&&n.type!==this._dataProvider.committedRowType&&n.id!==this._placeholderRowId&&(this._deletedPendingRows||(this._deletedPendingRows={}),this._deletedPendingRows[n.id]=n)}}if(e){var i=this.getInternalRowIdByElement(e),r=!1;if(!1!==this._listContext._syncManager.removeRowFromQueue(i)&&(r=this._dataProvider.deleteRow(i)),r)t.preventDefault(),t.stopPropagation();else if(!this._listContext._syncManager.inErrorState()&&this._listContext._syncManager.isQueueEmpty()||this._listContext._syncManager.isActiveRow(parseInt(i))||($dyn.log.list&&$dyn.log.list("List - [Row Operations Manager]. Prevented row deletion on Alt+F9 or Alt+Delete. SyncManager state is: %s",this._listContext._syncManager.state),t.preventDefault(),t.stopPropagation()),this._listContext._syncManager.isActiveRow(parseInt(i)))return t.originalEvent&&(t.originalEvent.IgnoreShortcuts=!1),this._dataProvider.lastDeletedActiveRowId=i,this._dataProvider.deleteTriggered=!0,this._listContext.Root&&this._listContext.Root.MessageBar&&this._listContext.Root.MessageBar._clearWarningMessagesNotAttachedToInputControls(),!1}},getActivePageRelatedIndex:function(e){var t=this.isRowWithinActivePage(e);if(!0===t)return this._dataProvider.getPageIndexByInternalRowId(e);if(!1===t){var o=this._rowIdToRenderedRow[e],n=this._getFirstRenderedPageRow(),i=this._getLastRenderedPageRow();if(o&&n&&i){if(o.order<n.order)return o.order-n.order;if(o.order>i.order)return this._dataProvider.getPageLength()-1+o.order-i.order}}},getRowIdByOffset:function(e){var t=$dyn.peek(this._dataProvider.InternalSelectedRowId),o=this._rowIdToRenderedRow[t];if(o){var n=o.order+e;if(0<=n&&n<this.getRenderedRowCount())return this._rowIds[n]}},getRowIdByActivePageIndex:function(e){if(0<=e&&e<this._dataProvider.getPageLength())return this._dataProvider.getInternalRowIdByPageIndex(e);if(e<0){var t=this._getFirstRenderedPageRow();if(t){var o=t.order+e;return this._rowIds[o]}}else{var n=this._getLastRenderedPageRow();if(n){o=e+1-this._dataProvider.getPageLength()+n.order;return this._rowIds[o]}}},getRenderedRowCount:function(){return this._rowIds.length},restrictedRenderingMode:function(){return!!$dyn.peek(this._userActionBusy)},_getBottomCommittedRow:function(){for(var e=this._rowIds.length-1;0<=e;--e){var t=this._rowIdToRenderedRow[this._rowIds[e]];if(t&&t.type===this._dataProvider.committedRowType)return t}},getBottomRowPageIndex:function(){var e=this._getBottomCommittedRow();if(e)return this.getActivePageRelatedIndex(e.id)},tryFocus:function(e,t){$dyn.log.focus&&$dyn.log.focus("Entering grid:tryFocus");var o=!0;if(this.userNotBusyAndSyncInactive()||t){var n=this._listContext.AllowHeaderFocus()?this._listContext._headerRowElement:this.getUserSelectedElement();if(n){var i=this._listContext._getParentControlName(e);$.contains(n,e)?this._activeCell(i):o=!!$(n).find('[data-dyn-controlname="'+i+'"]').length}}else this.focusCellInActiveRow(),o=!1;return $dyn.log.focus&&$dyn.log.focus("Leaving grid:tryFocus"),o},_syncActiveCellToActiveControl:function(){if(this._activeCell&&this._listContext.Root){var e=$dyn.peek(this._listContext.Root.ActiveControl),t=this._listContext._selectedRow;t&&0<$(t).find('[data-dyn-controlname="'+e+'"]').length?this._activeCell(e):this._activeCell("")}},_userNotBusyAndSyncInactive:function(){return!$dyn.value(this._userActionBusy)&&$dyn.value(this._syncEngineState)===$dyn.util.SyncEngineState.inactive},_runDiscardPolicy:function(e){var a=this;if(!0===this._listContext._disableDiscardPolicy)return!1;if(void 0!==this._listContext.clientCacheStart&&null!==this._listContext.clientCacheStart){var t=this.getRowHeight(e),o=this._listContext.GetScrollRegionHeight();if(t&&this._listContext._scrollParameters&&0<o){var n=this._listContext._getFirstVisibleRow(),i=this._listContext._getVisibleRowCount(o),r=this._listContext._RowCountThresholdFraction*i,s=this.getRenderedRowCount();if(r<s){var l=Math.round(.5*r);l<2*i&&(l=2*i);var u=n-Math.floor((l-i)/2),d=n+i+Math.ceil((l-i)/2)-1;s<=d&&(u-=d-s+1,d=s-1),u<0&&(d-=u,u=0);var c=function(e,t){for(var o=e;o<t;++o){var n=a._getRenderedRowElementByIndex(o);n&&n.parentNode&&n.parentNode.removeChild(n);var i=a._getRenderedRowByIndex(o);if(i){var r=i.id;r&&delete a._rowIdToRenderedRow[r]}}a._rowIds.splice(e,t)},p=0;if(this._listContext.mergeBelow&&this._listContext._scrollParameters.bufferBelowHeight){var h=this._listContext._getVisibleRowCount(this._listContext._scrollParameters.bufferBelowHeight),m=this._listContext._getVisibleRowCount(this._listContext._scrollParameters.bufferAboveHeight);h&&(p+=h),m&&(p-=m)}return c(d+1,s),c(0,u+p),$dyn.log.list&&$dyn.log.list("List: Discard policy. Discarding "+(u+p)+" rows above"),$dyn.log.list&&$dyn.log.list("List: Discard policy. Discarding "+(s-d-1)+" rows below"),this._listContext.UpdateClientCacheStart(this._listContext.clientCacheStart+u,p),!0}}}return!1},_getFocusTargetByCellName:function(e,t){var o=$(e).find("[data-dyn-controlname='"+t+"']");if(o&&o.length){var n=o[0].getAttribute("data-dyn-focus");if(n)return o.find(n)[0]}},_getCellSelection:function(e){var t,o,n=$(e).find(document.activeElement);if(n&&n.length?(t=document.activeElement,o=this._listContext._getParentControlName(document.activeElement)):document.activeElement===document.body&&$dyn.peek(this._activeCell)&&(t=this._getFocusTargetByCellName(e,$dyn.peek(this._activeCell)),o=$dyn.peek(this._activeCell)),t)return{start:$dyn.ui.selectionStart(t),end:$dyn.ui.selectionEnd(t),cellName:o}},_transferCellSelection:function(e,t){if(e&&t&&t.cellName){var o=this._getFocusTargetByCellName(e,t.cellName);o&&($dyn.ui.selectionStart(o,t.start),$dyn.ui.selectionEnd(o,t.end))}},TransferInputFocus:function(e,t){var o=!0,n=this._listContext.Root;if(n&&(o=n.TakeFocus&&n.isFormActive()),o){var i,r=null,a=null;if(t&&t.length){var s=t.closest(".listCell");s.length&&(r=e.children().eq(s.index()));var l=$dyn.shell.clearBodyFocusCorrection();a=jQuery.Event("blur"),t.trigger(a),$dyn.shell.bodyFocusCorrection=l}else if($dyn.peek(this._activeCell))if("checkMarkTarget"===(i=$dyn.peek(this._activeCell))){var u=e.find(".checkMarkTarget");u&&u.length&&u.focus()}else r=e[0]===this._listContext._headerRowElement?e.find('[data-dyn-columnname="'+i+'"]'):e.find('[data-dyn-controlname="'+i+'"]');else this._listContext.Root&&this._listContext.Root.ActiveControl()&&(i=this._listContext.Root.ActiveControl(),r=e[0]===this._listContext._headerRowElement?e.find('[data-dyn-columnname="'+i+'"]'):e.find('[data-dyn-controlname="'+i+'"]'));if(r){var d=null,c=r.find("[data-dyn-focus]").addBack().first();if(c.length){var p=c.attr("data-dyn-focus");p&&(d=c.find(p))}if(d&&d.length||(d=r.find("input").first()),$dyn.log.list&&$dyn.log.list.trace("List: [fast] Transfering focus to: %s",i),(!a||!a.isDefaultPrevented())&&d&&d.focus().length){if(!d.prop("readonly")&&this._listContext.arrowKeyDownTriggered){if(d.select(),$dyn.shell.blockingDiv&&"none"!==$dyn.shell.blockingDiv.style.display){var h=$dyn.context($dyn.shell.getActiveForm());if(h){var m=d[0],v={element:m,selectionStart:$dyn.ui.selectionStart(m),selectionEnd:$dyn.ui.selectionEnd(m),formId:h.Id};$dyn.shell.updateFocusableElement(v)}}this._listContext.arrowKeyDownTriggered=!1}var g;if(n&&n.updateActiveElement)g=e[0]===this._listContext._headerRowElement?d.addBack().closest("[data-dyn-role]")[0]:d.addBack().closest("[data-dyn-controlname]")[0],n.updateActiveElement(g)}}}return o},setActiveCell:function(e){this._activeCell=e},setUserActionBusy:function(){var e=$dyn.context(this._listContext.AllowEdit)&&this._listContext.hasPendingEdits()&&$dyn.peek(this._listContext._fastEdit)?4e3:400;this._userActionBusyTimer?(this._userActionBusyTimer.cancel(),this._userActionBusyTimer=void 0,$dyn.log.list&&$dyn.log.list("List: [busy] User still active")):$dyn.log.list&&$dyn.log.list("List: [busy] User active"),this._userActionBusy(!0);var t=this;this._userActionBusyTimer=$dyn.async(function(){t._userActionBusy(!1),$dyn.log.list&&$dyn.log.list("List: [busy] User not active")},e)},_updateSelectedRow:function(e){$dyn.log.list&&$dyn.log.list("List: [Renderer] Entering UpdateSelectedRow"),$dyn.peek(this._userActionBusy)?$dyn.log.list&&$dyn.log.list("List: [Renderer] User is busy"):$dyn.log.list&&$dyn.log.list("List: [Renderer] User is not busy");var t=$dyn.peek(this._syncEngineState);t===$dyn.util.SyncEngineState.active?$dyn.log.list&&$dyn.log.list("List: [Renderer] Sync Engine is active"):$dyn.log.list&&$dyn.log.list("List: [Renderer] Sync Engine is inactive"),$dyn.log.list&&$dyn.log.list("List: [Renderer] Selected Row id is %s",this._selectedRowId);var o=$dyn.peek(this._dataProvider.InternalSelectedRowId),n=$dyn.peek(this._dataProvider.DataSelectedRowId);this._activeRowInTheDOM()?(document.body.setAttribute("aria-busy","true"),t===$dyn.util.SyncEngineState.active||o!==n?($dyn.log.list&&$dyn.log.list("List: [Renderer] Detaching active row"),this._detachActiveRow()):e||this._selectedRowId!==$dyn.peek(this._dataProvider.DataSelectedRowId)&&(this._makeRowInactive(this._selectedRowId),this._makeRowActive($dyn.peek(this._dataProvider.DataSelectedRowId)))):this._activeRowInTheDomAllowed()&&($dyn.log.list&&$dyn.log.list("List: [Renderer] Attaching active row"),this._attachActiveRow(),this._listContext._selectedRow.setAttribute("aria-selected",!0),document.body.setAttribute("aria-busy","false")),$dyn.log.list&&$dyn.log.list("List: [Renderer] Leaving UpdateSelectedRow")},_activeRowInTheDOM:function(){var e=!1;if($dyn.peek(this._listContext.GroupBy)){var t;if(this._listContext._selectedRow){var o=$(this._listContext._selectedRow).closest(".listBody");o&&(t=o[0])}e=!(!this._listContext._selectedRow||t!==this._listBody)}else e=!(!this._listContext._selectedRow||this._listContext._selectedRow.parentElement!==this._listBody);return e},_detachActiveRow:function(){this._selectedRowId&&0<$dyn.length(this._listContext.DataSource)&&this._makeRowInactive(this._selectedRowId)},_attachActiveRow:function(){this._selectedRowId&&(this.$_lastActiveElement=this._makeRowInactive(this._selectedRowId)),this._makeRowActive($dyn.peek(this._dataProvider.DataSelectedRowId))},setRowMarking:function(e,t){e&&(t=t&&this._listContext._supportsMarking(),e.setAttribute("data-dyn-row-marked",t),e.setAttribute("aria-selected",t),e.children&&e.children[0]&&$(".marked-record-checkbox[role='checkbox']",e.children[0]).attr("aria-checked",t))},_onRowBecameCommitted:function(e){var t=this._rowIdToRenderedRow[e];t&&(t.type=this._dataProvider.committedRowType)},_getRowState:function(e){var t,o,n,i,r,a={};if(e&&(i=$dyn.context(e)),i&&(r=$dyn.value(i.Children)),r)for(t=0,o=r.length;t<o;t++)n=r[t],a=this._getStateFromChildControl(n,a);return a},_getRowStateForInactiveRow:function(e){var t,o,n,i,r={};if(e&&(i=e.children),i)for(t=0,o=i.length;t<o;t++)n=$dyn.context(i[t]),r=this._getStateFromChildControl(n,r);return r},_getStateFromChildControl:function(e,t){var o;return e&&e.GetState&&(o=e.GetState()),o&&(t[e.Name]=o),t},_applyRowState:function(e,t){var o,n,i,r;if(e){var a=t.children;for(o=0,n=a.length;o<n;o++){i=a[o];var s=e[(r=$dyn.context(i))&&r.Name||i.getAttribute("data-dyn-controlname")];s&&(r=r||(r=this._listContext._getVirtualControl(i))&&r.current)&&r.ApplyState&&r.ApplyState(s)}}},_makeRowInactive:function(e){var t=this._rowIdToRenderedRow[e];if(t&&this._listContext._selectedRow.parentNode&&this._selectedRowId===e&&t.selected){var o,n,i,r,a=this._dataProvider.getDataProviderItemByInternalRowId(e);i=a?(o=this._createNewInactiveRowElement(a),n=a.version,r=a.type,a.marked):(o=t.element,n=t.version,r=t.type,t.marked);var s=this._listContext._selectedRow;if(o&&s){var l=s.parentNode,u=document.activeElement,d=$dyn.context(u);if(d&&$.contains(this._listBody,u)&&(d.updateValue&&d.updateValue(!0),d.focusOutCleanup&&d.focusOutCleanup(!0)),e===$dyn.peek(this._dataProvider.DataSelectedRowId)){var c=this._getRowState(s);this._applyRowState(c,o)}this.setRowMarking(o,!!i);var p=this._getCellSelection(s),h=document.activeElement;$.contains(s,h)&&($dyn.ui.selectionStart(h,-1),$dyn.ui.selectionEnd(h,-1),$(h).blur()),l&&(l.replaceChild(o,s),e===this._dataProvider.InternalSelectedRowId()&&$dyn.peek(this._listContext.Mode)===$dyn.ui.ListMode.tabular&&this._transferCellSelection(o,p)),e===$dyn.peek(this._invalidRow)&&this._setIsInvalidClass(o),$dyn.util.isEnhancedTabSequenceEnabled()&&o.children&&o.children[0]&&$(".marked-record-checkbox[role='checkbox']",o.children[0]).attr("tabindex",-1);var m={element:o,id:e,version:n,selected:!1,marked:i,order:t.order,type:r};this._setInternalRowId(o,e),this._rowIdToRenderedRow[e]=m,o.setAttribute("data-dyn-row-active",!1),e===this._dataProvider.InternalSelectedRowId()&&this.focusCellInActiveRow()}}},_makeRowActive:function(o){var e=this._rowIdToRenderedRow[o];if(e&&e.element&&e.element.parentNode&&this._selectedRowId!==o&&!e.selected){var t,n,i,r=this._dataProvider.getDataProviderItemByInternalRowId(o);i=r?(t=r.version,n=r.marked,r.type):(t=e.version,n=e.marked,e.type);var a=this._listContext._selectedRow,s=e.element;if(s&&a){var l=s.parentNode,u=this._getCellSelection(s);if($dyn.peek(this._listContext._fastEdit)){var d=this._getRowStateForInactiveRow(s);this._applyRowState(d,a)}var c=s.id,p=s.querySelector(".listCell-firstCell .textbox");if(p){var h=s.querySelector(".listCell-firstCell .textbox").name;h&&(a.querySelector(".listCell-firstCell .textbox").id=c+"_"+h+"_input")}else(p=s.querySelector(".listCell-firstCell"))&&(a.querySelector(".listCell-firstCell").id=p.Id);l.replaceChild(a,s),this._listContext.UpdateActiveItemBindings&&this._listContext._selectedItem&&s.dynRowItem&&this._listContext._selectedItem(s.dynRowItem),o===this._dataProvider.InternalSelectedRowId()&&$dyn.peek(this._listContext.Mode)===$dyn.ui.ListMode.tabular&&this._transferCellSelection(a,u);var m={element:s,id:o,version:t,selected:!0,marked:n,order:e.order,type:i};this._setInternalRowId(a,o),a.setAttribute("data-dyn-row-active",!0);var v=a.querySelector(".listCell-firstCell .textbox");v=v||a.querySelector(".listCell-firstCell"),this._listContext.activeRowDefaultCellId(v.id),$(a).find("[role=gridcell]").each(function(e,t){t.setAttribute("aria-rowindex",o)}),o===$dyn.peek(this._invalidRow)?this._setIsInvalidClass(a):this._removeIsInvalidClass(a),this._rowIdToRenderedRow[o]=m,this.setRowMarking(a,!!n),$dyn.util.isEnhancedTabSequenceEnabled()&&a.children&&a.children[0]&&$(".marked-record-checkbox[role='checkbox']",a.children[0]).attr("tabindex",0),o===this._dataProvider.InternalSelectedRowId()&&"checkMarkTarget"!==this._activeCell()&&this.focusCellInActiveRow(),this._listContext._syncManager._clientInitiatedRowChange?this._listContext._syncManager._clientInitiatedRowChange=!1:this.scrollUserSelectedRowIntoView(),this._listContext._scrollParameters&&(this._listContext._scrollParameters.selectionFocusTriggerMax=void 0,this._listContext._scrollParameters.selectionFocusTriggerMin=void 0)}}},_updateSelectingRow:function(e,t){var o=this._lastSelectingRowId,n=this._selectingRowId;n===o&&null!==this._listContext._syncManager._leaveRecordRowIndex||(e===o&&($dyn.log.list&&$dyn.log.list.trace("List: Update selecting row (last): %s, %o",e,t),t&&t!==this._listContext._selectedRow&&(t.removeAttribute(this._rowSelecting),$("[data-dyn-focus]",t).each(function(e,t){var o=t.getAttribute("data-dyn-focus");$(o,t).attr("tabindex","-1")}))),e===n&&($dyn.log.list&&$dyn.log.list.trace("List: Update selecting row: %s, %o",e,t),t&&t!==this._listContext._selectedRow&&(t.setAttribute(this._rowSelecting,!0),$("[data-dyn-focus]",t).each(function(e,t){var o=t.getAttribute("data-dyn-focus");$(o,t).attr("tabindex","0")}))))},_markedIndexesChanged:function(){var e=this._dataProvider.getEnumerator();for(e.reset();e.moveNext();){var t=e.current(),o=t.id,n=this._rowIdToRenderedRow[o];if(n&&n.marked!==t.marked){var i=this._getRenderedRowElementByRowData(n);i&&(this.setRowMarking(i,!!t.marked),n.marked=t.marked)}}},_rowSyncStateChanged:function(){var e=this.rowSyncState(),t=this._dataProvider.getEnumerator();for(t.reset();t.moveNext();){var o=t.current().id,n=e[o],i=this._rowIdToRenderedRow[o];if(i){var r=this._getRenderedRowElementByRowData(i);r&&(n?r.classList.add(this._isLoadingClass):r.classList.remove(this._isLoadingClass),i.rowStatus=n)}}},_invalidRowChanged:function(e){if($dyn.peek(this._listContext._fastEdit)&&e!==this._previousInvalidRow){var t;if(this._previousInvalidRow&&e!==this._previousInvalidRow)if(t=this._rowIdToRenderedRow[this._previousInvalidRow]){var o=this._getRenderedRowElementByRowData(t);this._removeIsInvalidClass(o)}if(e)if(t=this._rowIdToRenderedRow[e]){o=this._getRenderedRowElementByRowData(t);this._setIsInvalidClass(o)}this._previousInvalidRow=e}},_setAllMarkedRows:function(){if(this.allRecordsMarkTriggered){var e,t=this._rowIdToRenderedRow;for(var o in t)if(o&&(e=this._getRenderedRowElementByRowData(t[o])),e&&this.setRowMarking){var n=$dyn.value(this._markAllRecords);this.setRowMarking(e,$dyn.util.stringToBoolean(n))}this.allRecordsMarkTriggered=!1}},_setIsInvalidClass:function(e){e.classList.add(this._isInvalidClass),e.classList.remove(this._isLoadingClass)},_removeIsInvalidClass:function(e){e.classList.remove(this._isInvalidClass)},_updateRenderedRowsIndexes:function(){for(var e=0;e<this._rowIds.length;++e){var t=this._getRenderedRowByIndex(e);t&&(t.order=e)}},_getRenderedRowElementByRowData:function(e){if(e)return e.selected?this._listContext._selectedRow:e.element},_getRenderedRowElementById:function(e){var t=this._getRenderedRowById(e);return this._getRenderedRowElementByRowData(t)},_getRenderedRowElementByIndex:function(e){var t=this._getRenderedRowByIndex(e);return this._getRenderedRowElementByRowData(t)},_setInternalRowId:function(e,t){e.setAttribute("data-dyn-rowid",t)},_activeRowInTheDomAllowed:function(){var e=$dyn.peek(this._userActionBusy),t=$dyn.peek(this._syncEngineState),o=$dyn.peek(this._dataProvider.InternalSelectedRowId),n=$dyn.peek(this._dataProvider.DataSelectedRowId);return!e&&t===$dyn.util.SyncEngineState.inactive&&o===n},getInternalRowIdByElement:function(e){if(e){var t=parseInt(e.getAttribute("data-dyn-rowid"),10);return isNaN(t)?void 0:t}},getUserSelectedElement:function(){return this._getRenderedRowElementByRowData(this.getUserSelectedRenderedRow())},getServerSelectedElement:function(){return this._getRenderedRowElementByRowData(this.getServerSelectedRenderedRow())},isUserSelectedRowRendered:function(){return!!this.getUserSelectedElement()},getUserSelectedRenderedRow:function(){var e=$dyn.peek(this._dataProvider.InternalSelectedRowId);return this._rowIdToRenderedRow[e]},getServerSelectedRenderedRow:function(){var e=$dyn.peek(this._dataProvider._getDataSelectedRowId());return this._rowIdToRenderedRow[e]},focusCellInActiveRow:function(){var e=this._listContext.AllowHeaderFocus()?this._listContext._headerRowElement:this.getUserSelectedElement();return this.TransferInputFocus($(e))},scrollUserSelectedRowIntoView:function(){this._listContext.scrollItemIntoView(this.getUserSelectedElement())},restoreSelectionFocus:function(){if(this._listContext.Root&&this._listContext.Root.isFormActive()&&$dyn.value(this._listContext.Root.TakeFocus)&&$dyn.value(this._listContext.Root.ReadyState)!==$dyn.ui.ReadyState.aborted){var e=$dyn.value(this._listContext.Root.ActiveControl());if(!e)return;var t=$(u().attr("data-dyn-controlname",e).find(this._listContext.element));if(0===t.length)return;if(1===t.length&&0!==t.closest(".place-holder").length)return void($dyn.value(this._listContext.IsNoResultsMessageDisplayed)&&this._listContext.focusNoRowIndicator());var o=this.getUserSelectedElement(),n=this._listContext._scrollParameters;if(o)if(n){var i=o.offsetTop,r=i+n.rowHeight,a=i-this._listContext.GetScrollRegionHeight(),s=this._listContext.GetScrollRegionTop();if(a<=s&&s<=r)this.focusCellInActiveRow(),n.selectionFocusTriggerMax=void 0,n.selectionFocusTriggerMin=void 0;else{var l=this._listContext.GetScrollRegion();n.selectionFocusTriggerMax=r,n.selectionFocusTriggerMin=a,this._listContext.AllowHeaderFocus()?this.focusCellInActiveRow():document.activeElement!==l&&($dyn.log.focus&&$dyn.log.focus("Grid->Focus the scroll region after rendering infinite scroll grid"),l.focus())}}else this.focusCellInActiveRow()}},renderBody:function(o,n,i){var r=this,e=$dyn.peek(this._listContext._dataLoadedRenderPending);e&&(this._forceRender=!0);var t=e&&this._listContext._infiniteScrollMode()===$dyn.util.InfiniteScrollMode.fast;this._renderAll(o,n,i&&!$dyn.peek(this._userActionBusy),t),this._lastRenderMode=e?this._renderModeMerge:this._renderModeReplace,i&&$dyn.peek(this._userActionBusy)&&(this._fullRenderPostponed=!0),$dyn.peek(this._userActionBusy)&&!$dyn.peek(r._userActionBusyRenderPending)&&(r._userActionBusyRenderPending(!0),this._disposables.push($dyn.observe(this._userActionBusy,function(e){if(!e){r._fullRenderPostponed&&(i=!0,r._fullRenderPostponed=!1);var t=r._lastRenderMode===r._renderModeMerge&&r._listContext._infiniteScrollMode()===$dyn.util.InfiniteScrollMode.fast;return r._renderAll(o,n,i,t),r._userActionBusyRenderPending(!1),!1}})))},_renderAll:function(e,t,o,n){var i=performance.now(),r=this;this._renderForEachTask&&this._renderForEachTask.start();var a,s,l,u,d,c,p,h,m=$dyn.value(this._dataProvider.DataSource),v=!1;if(this._listContext._inactiveItemElement&&m){this._isRendering=!0,this._listContext._skipOffsetParentCheck=!0;var g=$dyn.peek(this._listContext._fastEdit),y=($dyn.peek(this._listContext.SelectedIndex),this._listContext._supportsMarking()),f=m.length,b=this.restrictedRenderingMode(),C=$dyn.value(this._listContext.GroupBy);if(C&&($dyn.setValue(this._listContext,"InfiniteScroll",!1),o=!0),!C&&!this._renderedGroupBy||b||($dyn.util.listEmpty(e,!1),o=!0),this._listContext.ExtendedStyle&&$dyn.setValue(this._listContext,"InfiniteScroll",!1),$dyn.log.list&&$dyn.log.list("List: Starting rendering. Server state: CacheSize: %i, FetchedDataStartPosition: %i, DataAbove: %s, DataBelow: %s, PageSize: %i. Client state: CacheStart: %i, RowCount: %i, FullRender: %s, mergeMode: %s",$dyn.value(this._listContext.CacheSize),$dyn.value(this._listContext.FetchedDataStartPosition),$dyn.value(this._listContext.DataAbove),$dyn.value(this._listContext.DataBelow),$dyn.value(this._listContext.DataSource).length,this._listContext.clientCacheStart,this.getRenderedRowCount(),o,n),o&&(n=!1),this._listContext._deferred){var w=!1;$dyn.peek($dyn.ui.updating)||($dyn.ui.updating(!0),w=!0),this._listContext._deferred=!1}var _,S,I,T,x,F,k,P,R,M=$dyn.ui.layout();M||$dyn.ui.layout(!0),this._recalculateRowHeightWithinLayoutBlock&&(this._layoutSubscriptionId&&($dyn.ui.layout.valueChanged.unsubscribe(this._layoutSubscriptionId),this._layoutSubscriptionId=null),this._layoutSubscriptionId=$dyn.ui.layout.valueChanged.subscribe(function(e){$dyn.value(e)||(this._rowHeight===this.getRowHeight(this._listBody,!0)&&(this._recalculateRowHeightWithinLayoutBlock=!1),$dyn.ui.layout.valueChanged.unsubscribe(this._layoutSubscriptionId),this._layoutSubscriptionId=null)},this)),o&&this._listContext._updateDefaultActionEnabled(),C&&(x=$(this._listContext._inactiveItemElement).find('[data-dyn-controlname="'+C+'"]')[0],F=$dyn.templates.GroupTemplate);var E=null,N=null,A=[],D=[],L=null,O=[],B=[],V=null,H=!1;if(n){var G=this._renderingMergeDirection();if(G.mergeAbove===G.mergeBelow)return $dyn.logError("Direction of loaded data is not defined. Skipping the rendering."),this._postRenderAll(!1,b,w,M,t),this._cleanupRenderAll(i),{changeSkipped:v};V=G.insertAfterId,N=G.insertAfterElement,H=G.mergeAbove,G.mergeBelow}this._lastSelectingRowId=this._selectingRowId,this._selectingRowId=$dyn.peek(this._dataProvider.InternalSelectedRowId);var z=function(e,t){return e.type===r._dataProvider.committedRowType?!b||r._forceRender:!t},U=function(e){return!b||r._forceRender},W=function(e,t,o){j(),r._setInternalRowId(t,e.id),Q();var n={element:t,id:e.id,version:e.version,selected:!1,marked:y&&e.marked,type:e.type,rowStatus:e.rowStatus};return $.extend(n,o),R={type:"create",renderedRow:n,id:e.id},n.selectedElement&&r.setRowMarking(n.selectedElement,!!e.marked),r.setRowMarking(t,!!e.marked),e.rowStatus?t.classList.add(r._isLoadingClass):t.classList.remove(r._isLoadingClass),$dyn.peek(r._invalidRow)===e.id&&r._setIsInvalidClass(t),R},K=function(e,t,o){var n=t||o.element;L=E=null,N=n,V=e.id,te=Ce,o&&o.marked!==e.marked&&n&&r.setRowMarking(n,!!e.marked),o&&o.rowStatus!==e.rowStatus&&n&&(e.rowStatus?n.classList.add(r._isLoadingClass):n.classList.remove(r._isLoadingClass)),Z[o.id]=!0},q=function(e,t,o,n){j(),Q();var i={element:t,id:e.id,version:e.version,selected:!1,marked:y&&e.marked,type:e.type,rowStatus:e.rowStatus};return $.extend(i,n),R={type:"move",renderedRow:i,id:e.id},o&&o.marked!==e.marked&&be&&r.setRowMarking(be,!!e.marked),o&&o.rowStatus!==e.rowStatus&&be&&(e.rowStatus?be.classList.add(r._isLoadingClass):be.classList.remove(r._isLoadingClass)),J[e.id]=!0,R},j=function(){E||(E=document.createDocumentFragment(),A.push(E),D.push(N))},Q=function(){L||(L=[],O.push(L),B.push(V))},Y=this.rowSyncState(),Z={},J={},X={},ee=!1,te=-1,oe=this._activeRowInTheDomAllowed(),ne=0,ie=0,re=0,ae=0;if(g){var se=!1,le=0;if(0<m.length&&(se=!0),this._listContext._syncManager.isQueueEmpty())this._dataProvider._firstRowDeleted=!1,this._firstRowDeleted=!1,this._deletedPendingRows=null,this._dataProvider.lastDeletedActiveRowId=-1;else if(this._deletedPendingRows){if($dyn.util.calculateAssociativeArraySize(this._deletedPendingRows)+m.length!==this.getRenderedRowCount()&&0<=this._dataProvider.lastDeletedActiveRowId){var ue=this.getUserSelectedElement(),de=0;if(ue){var ce=this.getInternalRowIdByElement(ue);ce!==this._rowIds[de]&&(de=this.getActivePageRelatedIndex(ce)),de=de||$dyn.value(this._dataProvider.SelectedIndex)}var pe=!1;0==m.length&&(pe=!0),this._dataProvider.updatePivotTablesAfterDelete(this._dataProvider.lastDeletedActiveRowId,de,pe),this._dataProvider.lastDeletedActiveRowId=-1}}}var he=this._dataProvider.getEnumerator();he.reset();for(;he.moveNext();)if(this._itemTask&&this._itemTask.start(0),this._firstRowDeleted?(xe=he.current(!0,le),le++):xe=he.current(),xe){P=null;var me=xe.id;R=null;var ve=this._rowIdToRenderedRow[me],ge=Y[me];xe.rowStatus=ge;var ye=null;if(oe&&xe.selected){(P=this._listContext._selectedRow).setAttribute("data-dyn-row-active",!0),this._listContext.activeRowDefaultCellId(P.id);fe=xe.version;if(me){if((ve=this._rowIdToRenderedRow[me])&&ve.selected){Ce=ve.order;!o&&te<Ce?(K(xe,P,ve),ie++):U()?(R=q(xe,r._createNewInactiveRowElement(xe),ve,{selected:!0}),re++):(K(xe,P,ve),ie++,v=!0)}else z(xe)?(R=W(xe,r._createNewInactiveRowElement(xe),{selected:!0,selectedElement:P}),ne++):(ve&&(K(xe,P,ve),ie++),v=!0);this._setInternalRowId(P,me),$dyn.util.isEnhancedTabSequenceEnabled()&&P.children&&P.children[0]&&$(".marked-record-checkbox[role='checkbox']",P.children[0]).attr("tabindex",0),ee=!0}else $dyn.logError("List - [Rendering] Rendering loop. ItemId is not valid. Skipping the item")}else if(me){var fe=xe.version;if(o||!ve||ve.selected)z(xe,ve)?(this._deletedPendingRows&&xe.type!==this._dataProvider.committedRowType&&(ye=this._deletedPendingRows[xe.id]),P=ye?ye.element:r._createNewInactiveRowElement(xe),R=W(xe,P),ne++):(ve&&(K(xe,null,ve),ie++),v=!0);else{var be=ve.element,Ce=ve.order;ve.version!==fe?(p=xe,(h=U())&&(r._rowHasPendingEdit(p.id)||$dyn.peek(r._invalidRow)===p.id)||!h?(K(xe,be,ve),ie++,v=!0):(this._deletedPendingRows&&xe.type!==this._dataProvider.committedRowType&&(ye=this._deletedPendingRows[xe.id]),P=ye?ye.element:r._createNewInactiveRowElement(xe),R=W(xe,P),X[me]=ve,0)):(te<Ce?(K(xe,be,ve),ie++):U()?(R=q(xe,be,ve),re++):(K(xe,be,ve),ie++,v=!0),P=be)}}else $dyn.logError("List - [Rendering] Rendering loop. ItemId is not valid. Skipping the item");C&&!b&&(oe&&me===$dyn.peek(this._dataProvider.DataSelectedRowId)||this._listContext._inactiveItem(xe),(T=$dyn.context(x))&&_!==(S=$dyn.value(T.formattedValue))&&(I&&(I.appendChild(E),I=null),I||((k=F.cloneNode(!0)).getElementsByClassName("listGroupTitle")[0].innerText=S,I=k.getElementsByClassName("listGroupContent")[0],e.appendChild(k)),_=S)),a=xe,s=R,l=P,d=L,c=0,(u=E)&&l&&u.appendChild(l),a.id!==r._lastSelectingRowId&&a.id!==r._selectingRowId||r._updateSelectingRow(a.id,l),d&&s&&d.push(s),r._itemTask&&r._itemTask.stop(c),c++}this._lastSelectingRowId=this._selectingRowId,this._updateClientCacheStart(n,H);var we=function(e){if(e){var t=e.element;t&&t.parentNode&&(t.parentNode.removeChild(t),ae++),!ee&&e.selected&&r._listContext._selectedRow.parentNode&&(r._listContext._selectedRow.parentNode.removeChild(r._listContext._selectedRow),ae++);var o=e.id;o&&delete r._rowIdToRenderedRow[o]}},_e={};if(n)for(var Se=Object.keys(X),Ie=(Te=0,Se.length);Te<Ie;++Te){we(xe=X[Se[Te]]),_e[xe.id]=!0}else for(var Te=0;Te<this.getRenderedRowCount();++Te){var xe;if((xe=this._getRenderedRowByIndex(Te))&&(xe.type!==r._dataProvider.committedRowType||U()))(me=xe&&xe.id)?(Z[me]||J[me]||(we(xe),_e[me]=!0),J[me]&&(_e[me]=!0)):we(xe);else v=!0}for(Te=0;Te<this._rowIds.length;)_e[this._rowIds[Te]]?this._rowIds.splice(Te,1):++Te;if($dyn.log.list&&$dyn.log.list("List: Rendering: Created count: %i, Reused count: %i, Moved count: %i, Removed count: %i",ne,ie,re,ae),0===f?(j(),this._listContext._selectedRow.classList.add("place-holder"),E.appendChild(this._listContext._selectedRow),this._rowIdToRenderedRow[this._placeholderRowId]={element:null,selected:!0,marked:!1,order:0,id:this._placeholderRowId},this._rowIds.push(this._placeholderRowId),$dyn.log.list&&$dyn.log.list("List: Rendering placeholder row")):this._listContext._selectedRow.classList.remove("place-holder"),I&&E)I.appendChild(E),I=null;else for(Te=0,Ie=A.length;Te<Ie;++Te){var Fe=D[Te];Fe&&Fe.parentNode&&Fe.parentNode===e?($dyn.log.list&&$dyn.log.list("List: Rendering insert before row.%o",Fe.nextSibling),e.insertBefore(A[Te],Fe.nextSibling)):0!==Te||null!==Fe&&Fe.parentNode?$dyn.logError("List: Insertion point unknown for dom fragment"):($dyn.log.list&&$dyn.log.list("List: Rendering insert at the begin.%o",e.firstChild),e.firstChild?e.insertBefore(A[Te],e.firstChild):e.appendChild(A[Te]))}var ke=function(e,t){for(var o=[],n=0;n<t.length;++n){var i=t[n];"create"!==i.type&&"move"!==i.type||(o.push(i.id),r._rowIdToRenderedRow[i.id]=i.renderedRow)}Array.prototype.splice.apply(r._rowIds,[e,0].concat(o))},Pe=function(e){for(var t=0;t<r._rowIds.length;++t)if(r._rowIds[t]===e)return t};o=!1;for(Te=0,Ie=O.length;Te<Ie;++Te){var Re=O[Te],Me=B[Te];ke(Me?Pe(Me)+1:0,Re)}if(C){var Ee,Ne=function(){$(".listGroupContent").each(function(e){var t=$(this.children[0]).outerHeight(!0),o=$(this).closest(".scrollRegion").height()-$(this).siblings(".listGroupTitle").outerHeight(),n=Math.floor(o/t),i=Math.ceil(this.childElementCount/n),r=$(this.children[0]).outerWidth(!0);$(this).width(r*i),$(this).height(t*n)})};this._throttleOnResize=function(){clearTimeout(Ee),Ee=setTimeout(Ne,200)},$(window).resize(this._throttleOnResize),$(P).is(":hidden")?setTimeout(Ne,200):Ne()}if(this._renderedGroupBy=!!C,g&&!se&&this._deletedPendingRows){var Ae=void 0,De=[];for(var Te in this._deletedPendingRows)(xe=this._deletedPendingRows[Te]).isFromKeyDown=!1,De.push(xe),void 0===Ae&&(Ae=xe.id),this._itemTask&&this._itemTask.start(0);this._firstRowDeleted=!0,this._dataProvider._firstRowDeleted=!0,this._listContext.DataSource(De),this._dataProvider.InternalSelectedRowId(Ae)}return this._postRenderAll(!0,b,w,M,t),this._cleanupRenderAll(i),{changeSkipped:v}}},_updateClientCacheStart:function(e,t){var o=$dyn.peek(this._dataProvider.FetchedDataStartPosition);$dyn.peek(this._dataProvider.DataSource).length?e&&!t||this._listContext.UpdateClientCacheStart(o):e||this._listContext.UpdateClientCacheStart(void 0)},_postRenderAll:function(e,t,o,n,i){var r=this;if(this._listContext._readjustScrollState(),e){$dyn.value(this._listContext.InfiniteScroll)&&this._runDiscardPolicy(this._listBody)&&this._listContext._readjustScrollState(),this._updateRenderedRowsIndexes(),$dyn.value(this._listContext.InfiniteScroll)&&this._listContext._ensureFullViewPortContent(),this._listContext._updateWhiteSpaceWidth();performance.now();$dyn.applyFunction(i);performance.now();this.isUserSelectedRowRendered()||this._dataProvider.syncInternalSelectedRowToDataSelectedRow();var a=this.getUserSelectedElement();a&&this._selectedRowId!==this._selectingRowId&&a.setAttribute(this._rowSelecting,!0),this._listContext.Root&&"SysTaskRecorderPane"===this._listContext.Root.FormName||($dyn.value(this._listContext.InfiniteScroll)?this.restoreSelectionFocus():this.focusCellInActiveRow())}o&&$dyn.ui.updating(!1),t||$dyn.layout.queueArrange(this._listBody.parentNode),n||$dyn.ui.layout(!1),this._forceRender=!1,e&&!$dyn.peek(this._listContext._dataLoadedRenderPending)&&this._listContext._selectedRow.parentNode===this._listBody&&this._listContext.setTimeout(function(){r._listContext.scrollItemIntoView(r._listContext._selectedRow)}),$dyn.value(this._listContext.InfiniteScroll)&&!this._listContext.doNotScrollIntoView&&this._listContext.setTimeout(function(){if(!r._listContext._scrollParameters.bufferAboveHeight&&r._listContext.mergeAbove)r._listContext.clientLastStartPosition&&((e=r._rowIdToRenderedRow[r._listContext.clientLastStartPosition-1])&&e.element&&r._listContext.SetScrollRegionTop(e.element.offsetTop),r._listContext.clientLastStartPosition=void 0);else if(!r._listContext._scrollParameters.bufferBelowHeight&&r._listContext.mergeBelow&&r._listContext.clientLastEndPosition){var e,t=r._listContext.CalculateNumberOfVisibleRows();(e=r._rowIdToRenderedRow[r._listContext.clientLastEndPosition-t+1])&&e.element&&r._listContext.SetScrollRegionTop(e.element.offsetTop),r._listContext.clientLastEndPosition=void 0}}),this._listContext.doNotScrollIntoView&&(this._listContext.doNotScrollIntoView=!1,this._listContext.clientLastEndPosition=void 0)},_cleanupRenderAll:function(e){this._listContext._dataLoadedRenderPending(!1),this._listContext._renderTriggeredWhileHidden=!1,this._listContext._skipOffsetParentCheck=!1,this._isRendering=!1,this._renderForEachTask&&this._renderForEachTask.stop();var t="<unknown>",o=$dyn.context(this._listBody);o&&o.Name&&(t=o.Name);var n=performance.now();$dyn.log.list&&$dyn.log.list("List: Finished rendering. Client state: CacheStart: %i, RowCount: %i",this._listContext.clientCacheStart,this.getRenderedRowCount()),$dyn.log.list&&$dyn.log.list("List: for each render time: %s, %s (ms)",t,n-e)},_renderingMergeDirection:function(){var e=!1,t=!1,o=null,n=null,i=this._dataProvider.getFirstItem();if(this._listContext.prevScrollDirection===$dyn.ui.ScrollDirection.down)e=!0;else if(this._listContext.prevScrollDirection===$dyn.ui.ScrollDirection.up)t=!0;else{i&&this._rowIdToRenderedRow[i.id]&&(e=!0);var r=this._dataProvider.getLastItem();r&&this._rowIdToRenderedRow[r.id]&&(t=!0)}if(e){var a=i?this._rowIdToRenderedRow[i.id]:void 0,s=a?this._getRenderedRowByIndex(a.order-1):void 0;n=s?(o=s.element,s.id):o=null}return this._listContext.prevScrollDirection=$dyn.ui.ScrollDirection.none,{mergeAbove:this._listContext.mergeAbove=t,mergeBelow:this._listContext.mergeBelow=e,insertAfterId:n,insertAfterElement:o}},dispose:function(){for(var e=0;e<this._disposables.length;++e){var t=this._disposables[e];t&&t.dispose&&"function"==typeof t.dispose&&t.dispose()}this._dataProvider&&this._dataProvider.onRowBecameCommitted.unsubscribe(this._onRowBecameCommittedSubscription),this._throttleOnResize&&($(window).off("resize",this._throttleOnResize),this._throttleOnResize=null),this._layoutSubscriptionId&&($dyn.ui.layout.valueChanged.unsubscribe(this._layoutSubscriptionId),this._layoutSubscriptionId=null)}}}(),function(){function e(e){this.element=e.element,this._syncManager=e.syncManager,this._renderer=e.renderer,this._getSelectedRow=e.getSelectedRow,this._allowEdit=e.allowEdit,this._edits={},this.element&&(this._changeEventListener=this._onCellEdit.bind(this),this._readOnlyEventListener=this._onCellReadOnlyEvent.bind(this),this.element.addEventListener(this._changeEvent,this._changeEventListener),this.element.addEventListener(this._readOnlyEvent,this._readOnlyEventListener))}e.prototype={element:void 0,_syncManager:void 0,_renderer:void 0,_selectedRow:void 0,_allowEdit:void 0,_changeEvent:$dyn.ui.ChangeEvent,_readOnlyEvent:$dyn.ui.ReadOnlyEvent,_getRowIdByElement:function(e){return this._renderer.getInternalRowIdByElement(e)},_edits:void 0,_getActiveControl:function(e){if(this._getSelectedRow()){var t=$dyn.util.filter(this._getSelectedRow().children,$dyn.ui.selector().attr("data-dyn-controlname",e))[0];if(t)return $dyn.context(t)}},_getCell:function(e){var t=$(e).closest(".listCell")[0],o=$(t).closest(".listItem")[0],n=$dyn.context(t),i=this._getRowIdByElement(o);if(t&&n&&n.GetState&&o){var r=t.getAttribute("data-dyn-controlname");if(r)return{rowId:i,columnName:r,cellControl:n,rowElement:o}}},_onCellReadOnlyEvent:function(e){var t=this._getCell(e.target);if(t){var o=t.rowId,n=t.columnName,i=t.cellControl,r=(t.rowElement,null);if(i&&i.GetState&&(r=i.GetState()),r){this._syncManager.queueCellEdit(o,n,r,function(){var e=this._getActiveControl(n);e&&e.ApplyState&&e.ApplyState(r),i&&i.ResetState&&i.ResetState()}.bind(this),function(){i&&i.ResetState&&i.ResetState()})}}},_onCellEdit:function(e){var t=this._getCell(e.target);if(t){var n=t.rowId,i=t.columnName,r=t.cellControl,a=(t.rowElement,r.GetState());if(a&&$dyn.value(r.AllowEdit)){var s=this._edits[n];s=s||(this._edits[n]={}),r.validating=!0,s[i]=a;var l=this;this._syncManager.queueCellEdit(n,i,a,function(){var t=this._getActiveControl(i),o=t&&t.GetState(a),e=t&&t.ApplyState(a);return e&&e.done(function(e){e&&(r.ApplyState(o,!0),t.ApplyState(o,!0))}).always(function(){r.validating=!1,s[i]===a&&(delete s[i],0===Object.keys(s).length&&delete l._edits[n])}),e}.bind(this),function(){r.validating=!1})}}},dispose:function(){this.element&&(this._changeEventListener&&(this.element.removeEventListener(this._changeEvent,this._changeEventListener),this._changeEventListener=null),this._readOnlyEventListener&&(this.element.removeEventListener(this._readOnlyEvent,this._readOnlyEventListener),this._readOnlyEventListener=null))}},$dyn.controls.List.EditManager=e}(),function(){var s={pending:$dyn.debug.general?"pending":0,processing:$dyn.debug.general?"processing":1,processed:$dyn.debug.general?"processed":2,notQueued:$dyn.debug.general?"notQueued":3},u={newRow:$dyn.debug.general?"newRow":0,existingRow:$dyn.debug.general?"existingRow":1};$dyn.controls.List.SyncManager=function(e,t){var o=this;this._listContext=e,this._dataProvider=t,this.invalidRow=$dyn.observable(null),this._leaveRecordRowIndex=void 0,this._activeRowValid=$dyn.computed(function(){return!$dyn.value(o.invalidRow)}),this._disposables=[],this._shouldReprocess=$dyn.observable(!1),this._syncInProgress=$dyn.observable(!1),this._pendingRowChange=$dyn.observable(!1),this._syncEngineState=$dyn.observable(),this.isQueueEmpty=$dyn.computed(this._isQueueEmpty,void 0,this),this._pendingRowIdToPendingRow={},this._pendingRowsQueue=$dyn.observableArray([]),this._pendingRowsToDirectInteractionQueue=$dyn.observableArray([]),this._disposables.push($dyn.observe(this._dataProvider.InternalSelectedRowId,this.internalSelectedRowUpdated,this,null,!0)),this._disposables.push($dyn.observe(this._pendingRowsToDirectInteractionQueue,this.pendingRowsToDirectInteractionQueueUpdated,this)),this._disposables.push($dyn.observe(function(){return o._getSyncEngineState()},function(e){o._syncEngineState(e)})),this.rowSyncState=$dyn.observable({}),this._pendingEdits=$dyn.observable({})},$dyn.controls.List.SyncManager.prototype={rowSyncState:void 0,_dataProvider:null,_currentProcessingRow:void 0,_activeRowValid:void 0,_shouldReprocess:void 0,_syncEngineState:void 0,_syncInProgress:void 0,_pendingEdits:void 0,_pendingRowIdToPendingRow:void 0,_pendingRowsQueue:void 0,_pendingRowsToDirectInteractionQueue:void 0,_disposables:void 0,internalSelectedRowUpdated:function(e){if($dyn.log.list&&$dyn.log.list("List: [SyncManager] Entering SyncManager::internalSelectedRowUpdated"),e){var t=this.isNewRowOnKeyDown();if(this.inErrorState()||!this.isQueueEmpty()||this.isNewRow(e)){var o=this._listContext.InputMode;if(this._shouldQueuePendingRow(e,!1)){var n=this.createPendingRow({rowId:e});this.setPendingRowType(n,t),n.processImmediate=n.processImmediate||o===$dyn.ui.InputType.mouse||this._listContext._markingAction===$dyn.controls.List.MarkMode.toggle,n.isDirty=n.isDirty||this._listContext._markingAction===$dyn.controls.List.MarkMode.toggle,this.queuePendingRow(n),!$dyn.peek(this._listContext._fastEdit)||this.isQueueEmpty()?this.processQueue():this.isQueueEmpty()||$dyn.peek(this._dataProvider.DataSelectedRowId)===e?this._dataProvider.deleteTriggered&&!this.isQueueEmpty()&&(this.processQueue(),this._dataProvider.deleteTriggered=!1,this._dataProvider._firstRowDeleted=!1):(this._listContext&&this._listContext.Root&&this._listContext.Root.MessageBar&&this._listContext.ClearMessages&&(this._listContext.Root.MessageBar._clearWarningMessagesNotAttachedToInputControls(),this._listContext.ClearMessages=!1),this.processQueue())}}else{var i=this._listContext._renderer.getActivePageRelatedIndex(e);if(void 0!==i&&this._shouldQueuePendingRow(e,!0)){n={rowId:e};this._pendingRowsToDirectInteractionQueue.push(n);var r=$dyn.value(this._dataProvider.SelectedIndex);this._listContext._fastEditingAllowed()&&this._leaveRecordRowIndex!==r&&(this._leaveRecordRowIndex=r,$dyn.log.list&&$dyn.log.list("List: [SyncManager] Queueing change to row index %s directly to interaction queue",r),this._leaveRecord(!1)),$dyn.log.list&&$dyn.log.list("List: [SyncManager] Queueing change to row index %s directly to interaction queue",i),this.changeRow(i,e)}}}$dyn.log.list&&$dyn.log.list("List: [SyncManager] Leaving SyncManager::internalSelectedRowUpdated")},pendingRowsToDirectInteractionQueueUpdated:function(e){this.isPendingRowsToDirectInteractionQueueEmpty()&&this.processQueue()},hasPendingEdits:function(){return Object.keys($dyn.peek(this._pendingEdits)).length},rowHasPendingEdit:function(e){return!!$dyn.peek(this._pendingEdits)[e]},_isQueueEmpty:function(){return!$dyn.value(this._pendingRowsQueue).length},isPendingRowsToDirectInteractionQueueEmpty:function(){return!$dyn.peek(this._pendingRowsToDirectInteractionQueue).length},inErrorState:function(){return!!$dyn.peek(this.invalidRow)},isActiveRow:function(e){var t=this._dataProvider.DataSelectedRowId();return $dyn.log.list&&$dyn.log.list("List: [SyncManager] InternalSelectedRowId: %s, DataSelectedRowId: %s",e,t),e===t},isNewRowOnKeyDown:function(){var e=this._dataProvider.getIsCreateRowFromKeyDown();return e&&this._dataProvider.setIsCreateRowFromKeyDown(!1),e},removeRowFromQueue:function(e){for(var t=0;t<$dyn.peek(this._pendingRowsQueue).length;++t){var o=$dyn.peek(this._pendingRowsQueue)[t];if(o&&o.rowId===e)return o.status===s.pending&&($dyn.ui.updateBlock(null,function(){this._pendingRowsQueue.splice(t,1),delete this._pendingRowIdToPendingRow[e],this._removePendingEdit(e)},this),!0)}},rowKeyDownNewRowInNonFastEditMode:function(){var e=this.createPendingRow({});e.type=u.newRow,e.processImmediate=!0,e.isDirty=!1,e.isFromKeyDown=!0,e.rowKeyDownNewRowInNonFastEditMode=!0,this.queuePendingRow(e),this.processQueue()},_shouldQueuePendingRow:function(e,t){var o=!0;if(this.isActiveRow(e)){this._shouldReprocess()||($dyn.log.list&&$dyn.log.list("List: [SyncManager] Should reprocess is true"),this.setShouldReprocess(!0)),$dyn.log.list&&$dyn.log.list("List: [SyncManager] User on active row");var n=t?this._pendingRowsToDirectInteractionQueue():this._pendingRowsQueue();if(0===n.length)$dyn.log.list&&$dyn.log.list("List: [SyncManager] Pending rows queue is empty. shouldQueuePendingRow: false "),o=!1;else n[n.length-1].rowId===e?($dyn.log.list&&$dyn.log.list("List: [SyncManager] Not changing rows. shouldQueuePendingRow: false"),o=!1):$dyn.log.list&&$dyn.log.list("List: [SyncManager] Changing rows. shouldQueuePendingRow: true")}else $dyn.log.list&&$dyn.log.list("List: [SyncManager] Change requested to row that's not the current active row. shouldQueuePendingRow: true");return o},isNewRow:function(e){var t=this._dataProvider.getDataRowIdByInternalRowId(e);if((!t||-1==t)&&this._dataProvider.getRelativeDataRowIdByInternalRowId(e))return!0;return!1},setPendingRowType:function(e,t){var o=e.rowId;this.isNewRow(o)?(e.type=u.newRow,e.isFromKeyDown=t,e.isDirty=!0,e.processImmediate=!0):(e.type=u.existingRow,e.isDirty=!1,e.processImmediate=!1)},dataSelectedRowUpdated:function(e){$dyn.log.list&&$dyn.log.list("List: [SyncManager] Entering SyncManager::dataSelectedRowUpdated"),$dyn.log.list&&$dyn.log.list("List: [SyncManager] DataSelectedRowId: %s",e)},queueToggleMark:function(e){this._queueExecuteAction(e,"ToggleMark",function(){$dyn.applyFunction(this.ToggleMark,this)})},queueDefaultAction:function(e){this._queueExecuteAction(e,"DefaultAction",function(){$dyn.applyFunction(this.NavigationAction,this)})},queueChangeRowByDelta:function(s,l,u){var d=this,c=this._listContext;this._queueExecuteAction(s,"ChangeRowByDelta",function(){var e,t=$dyn.peek(d._dataProvider.SelectedIndex);void 0!==s&&void 0!==(e=d._listContext._renderer.getActivePageRelatedIndex(s))||(e=t);var o=l+e,n=c.ConvertPageIndexToServerCacheIndex(o);if($dyn.value(c.InfiniteScroll)){if(!u){var i=$dyn.peek(d._dataProvider.CacheSize);i<=n&&(n=i-1),n<0&&(n=0)}var r=d._listContext.ConvertServerCacheIndexToPageIndex(n);d._leaveAndChangeRow(r)}else{var a=$dyn.value(d._dataProvider.DataSource).length;o<0?d._leaveAndLoadPreviousPage(l):a<=o?d._leaveAndLoadNextPage(l):d._leaveAndChangeRow(o)}},!0)},_queueExecuteAction:function(e,t,o){var n={name:t,action:o,cancel:function(){}};if(this._canExecuteNow(e))$dyn.log.list&&$dyn.log.list("List: [SyncManager] Executing actions"),this._doExecuteActions([n]);else{var i=this._getOrCreatePendingRow(e);i.status===s.notQueued?i.executeActions.push(n):this._mergeAction(i.executeActions,n),i.isDirty=!0,i.processImmediate=!0,this.queuePendingRow(i),this.processQueue()}},_canExecuteNow:function(e){var t=!1;e&&!this.isActiveRow(e)||(!e||0===this._pendingRowsQueue().length||this._currentProcessingRow&&this._currentProcessingRow.rowId===e)&&(t=!0);return t},_doExecuteActions:function(e){if(e){for(var t=this._listContext,o=0,n=e.length;o<n;o++)e[o].action.call(t);e.length=0}},_getOrCreatePendingRow:function(e){var t=this._pendingRowIdToPendingRow[e];return t||(t=this.createPendingRow({rowId:e}),this.setPendingRowType(t)),t},createPendingRow:function(e){return this._nextNewRowId?this._nextNewRowId++:this._nextNewRowId=1,e.state=[],e.executeActions=[],e.id=this._nextNewRowId,e.status=s.notQueued,e},queueCellEdit:function(e,t,o,n,i){$dyn.log.list&&$dyn.log.list("List: [SyncManager] Entering SyncManager::queueCellEdit"),$dyn.log.list&&$dyn.log.list("List: [SyncManager] queueCellEdit - InternalRowId: %s, Control name: %s,  Control state: %o",e,t,o);var r;if(e){var a;if(r={name:t,state:o,action:n,cancel:i},this._canSyncCellChangesNow(e))$dyn.log.list&&$dyn.log.list("List: [SyncManager] Syncing cell changes on active row"),this.syncCellChanges([r]);else(a=this._getOrCreatePendingRow(e)).status===s.notQueued?a.state.push(r):this._mergeAction(a.state,r),a.isDirty=!0,a.processImmediate=!0,this.queuePendingRow(a),this.processQueue();$dyn.log.list&&$dyn.log.list("List: [SyncManager] Leaving SyncManager::queueCellEdit")}},_addPendingEdit:function(e){this._pendingEdits()[e]=!0,this._pendingEdits.valueChanged.raise()},_removePendingEdit:function(e){delete this._pendingEdits()[e],this._pendingEdits.valueChanged.raise()},_canSyncCellChangesNow:function(e){var t=!1;this.isActiveRow(e)&&(t=!(0<this._pendingRowsQueue().length&&this._currentProcessingRow&&this._currentProcessingRow.rowId!==e));return t},_mergeAction:function(e,t){for(var o=!1,n=0,i=e.length;n<i;n++){var r=e[n];if(r&&r.name===t.name){r.cancel(),e[n]=t,o=!0;break}}o||e.push(t)},_mergeActions:function(e,t){for(var o=0,n=t.length;o<n;o++){var i=t[o];this._mergeAction(e,i)}},_setRowSyncState:function(e,t){if(e){var o=this.rowSyncState();o[e]!=t&&(t?o[e]=!0:delete o[e],this.rowSyncState.valueChanged.raise())}},queuePendingRow:function(e){$dyn.log.list&&$dyn.log.list("List: [SyncManager] Entering SyncManager::queuePendingRow"),$dyn.log.list&&$dyn.log.list("List: [SyncManager] Request to queue row id %s %o",e.rowId,e);var t=this._pendingRowIdToPendingRow[e.rowId];if(t?t!==e&&($dyn.log.list&&$dyn.log.list("List: [SyncManager] Row exists in queue with same row id, but it's not the pendingRow"),t.processImmediate=t.processImmediate||e.processImmediate,t.isDirty=t.isDirty||e.isDirty,this._mergeActions(t.state,e.state),this._mergeActions(t.executeActions,e.executeActions),this._dataProvider.deleteTriggered&&this._dataProvider._firstRowDeleted&&(t.isFromKeyDown=e.isFromKeyDown),e=t):($dyn.log.list&&$dyn.log.list("List: [SyncManager] Pending row doesn't exist in the queue"),e.rowId&&(this._pendingRowIdToPendingRow[e.rowId]=e),e.status=s.pending,$dyn.ui.updateBlock(null,function(){this.runDiscardPolicy(),$dyn.log.list&&$dyn.log.list("List: [SyncManager] Queueing pending row"),this._pendingRowsQueue.push(e)},this)),e.isDirty&&this._setRowSyncState(e.rowId,!0),e.processImmediate){var o=this._pendingRowsQueue();o&&(o[0].processImmediate=!0)}(e.state&&e.state.length||e.type===u.newRow||e.isFromKeyDown)&&this._addPendingEdit(e.rowId),$dyn.log.list&&$dyn.log.list("List: [SyncManager] Leaving SyncManager::queuePendingRow")},runDiscardPolicy:function(){var e=this._pendingRowsQueue(),t=e[e.length-1];t&&t!==this._currentProcessingRow&&!t.isDirty&&(this.dequeuePendingRow(t),this._setRowSyncState(t.rowId,!1))},dequeuePendingRow:function(e){this._currentProcessingRow=null,delete this._pendingRowIdToPendingRow[e.rowId];var t=this._pendingRowsQueue().indexOf(e);-1!==t&&($dyn.log.list&&$dyn.log.list("List: [SyncManager] Removing Internal RowId %s from queue",e.rowId),$dyn.ui.updateBlock(null,function(){this._pendingRowsQueue.splice(t,1),this._setRowSyncState(e.rowId,!1),this._removePendingEdit(e.rowId)},this))},dequeuePendingRowsToDirectInteractionQueue:function(e){var t=this._listContext._renderer.getActivePageRelatedIndex(e);$dyn.log.list&&$dyn.log.list("List: [SyncManager] Remove row index %s from Direct Interaction Queue",t);for(var o=0;o<$dyn.peek(this._pendingRowsToDirectInteractionQueue).length;++o){var n=$dyn.peek(this._pendingRowsToDirectInteractionQueue)[o];n&&n.rowId===e&&this._pendingRowsToDirectInteractionQueue.splice(o,1)}},_getSyncEngineState:function(){return(0<$dyn.length(this._pendingRowsQueue)||0<$dyn.length(this._pendingRowsToDirectInteractionQueue))&&(this._activeRowValid()||this._syncInProgress())?($dyn.log.list&&$dyn.log.list("List: [SyncManager] SyncEngine active"),$dyn.util.SyncEngineState.active):($dyn.log.list&&$dyn.log.list("List: [SyncManager] SyncEngine inactive"),$dyn.util.SyncEngineState.inactive)},processQueue:function(e,t){$dyn.log.list&&$dyn.log.list("List: [SyncManager] Entering SyncManager::processQueue");var o=this._pendingRowsQueue(),n=o&&o.length;if($dyn.log.list&&$dyn.log.list("List: [SyncManager] Processing queue: length: %o, row processing: %o, active row valid: %s, should reprocess: %s, queue: %o",n,this._currentProcessingRow,this._activeRowValid(),this._shouldReprocess(),o.slice(0)),!this.isPendingRowsToDirectInteractionQueueEmpty()||this.isQueueEmpty()||this._currentProcessingRow||!this._activeRowValid()&&!this._shouldReprocess())this.isPendingRowsToDirectInteractionQueueEmpty()&&this.isQueueEmpty()&&(this._syncInProgress(!1),this.syncRowAndCell(e,t));else{var i=o[0],r=i.rowId;if(!i.isDirty&&this.isActiveRow(r))return $dyn.log.list&&$dyn.log.list("List: [SyncManager] Attempting to process active row that's not dirty. Abort processing"),this.dequeuePendingRow(i),void this.processQueue();if(i.isDirty&&this.isActiveRow(r))return $dyn.log.list&&$dyn.log.list("List: [SyncManager] Calling Execute Actions for internalRowId %s",r),this._doExecuteActions(i.executeActions),$dyn.log.list&&$dyn.log.list("List: [SyncManager] Syncing cell changes for internalRowId %s",r),this.syncCellChanges(i.state),this.dequeuePendingRow(i),void this.processQueue();if(i.type===u.existingRow){var a=this._listContext._renderer.getActivePageRelatedIndex(r);if(null==a)return $dyn.log.list&&$dyn.log.list("List: [SyncManager] Attempting to change to an invalid row index: %s. Abort processing",a),this.dequeuePendingRow(i),void this.processQueue();this._setRowStateToProcessing(i),this._leaveAndChangeRow(a,i.rowId,!0)}else if(i.isFromKeyDown)this._setRowStateToProcessing(i),this._leaveAndCreateRowOnKeyDown(i);else{var s=this._dataProvider.getRelativeDataRowIdByInternalRowId(r);if(!s)return $dyn.log.list&&$dyn.log.list("List: [SyncManager] Unable to locate a reference internal row id to create the new row"),this.dequeuePendingRow(i),void this.processQueue();var l=this._listContext._renderer.getActivePageRelatedIndex(this._dataProvider.getInternalRowId(s));if(null==l&&-1!=s)return $dyn.log.list&&$dyn.log.list("List: [SyncManager] Unable to locate a reference row index to create the new row. Abort processing"),this.dequeuePendingRow(i),void this.processQueue();-1==s&&(l=null),this._setRowStateToProcessing(i),this._leaveAndCreateRow(l,r)}}$dyn.log.list&&$dyn.log.list("List: [SyncManager] Leaving SyncManager::processQueue")},_setRowStateToProcessing:function(e){$dyn.log.list&&$dyn.log.list("List: [SyncManager] Setting row state to processing"),e.status=s.processing,this._setRowSyncState(e.rowId,!0),this._currentProcessingRow=e},_loadPreviousPage:function(e){var t=this._listContext,o=this;this._syncInProgress(!0),$dyn.callFunction(t.LoadPreviousPage,t,[Math.abs(e).toString()],function(e){e?o.callbackSuccess():$dyn.async(function(){o._dataProvider.changeRow(0)},void 0,"Go to top row in current page")})},_loadNextPage:function(e){var t=this._listContext,o=this,n=$dyn.value(this._dataProvider.DataSource).length;this._syncInProgress(!0),$dyn.callFunction(t.LoadNextPage,t,[e.toString()],function(e){e?o.callbackSuccess():$dyn.async(function(){o._dataProvider.changeRow(n-1)},void 0,"Go to bottom row in the current page.")})},_leaveAndCreateRow:function(e,t){$dyn.log.list&&$dyn.log.list("List: [SyncManager] Entering SyncManager::_leaveAndCreateRow");var o=this;this._listContext._fastEditingAllowed()?$dyn.microTask(function(){o._leaveRecord(!0).done(function(){o.createRow(e,t)})},o):this.createRow(e,t),$dyn.log.list&&$dyn.log.list("List: [SyncManager] Leaving SyncManager::_leaveAndCreateRow")},_leaveAndCreateRowOnKeyDown:function(e){$dyn.log.list&&$dyn.log.list("List: [SyncManager] Entering SyncManager::_leaveAndCreateRowOnKeyDown");var t,o,n=this;t=this._listContext._markingAction,o=this._listContext.rangePivotWithinPage(),this._listContext._fastEditingAllowed()?$dyn.microTask(function(){n._leaveRecord(!0).done(function(){n.createRowOnKeyDown(e,t,o)})},n):this.createRowOnKeyDown(e,t,o),$dyn.log.list&&$dyn.log.list("List: [SyncManager] Leaving SyncManager::_leaveAndCreateRowOnkeyDown")},_leaveAndChangeRow:function(e,t,o){$dyn.log.list&&$dyn.log.list("List: [SyncManager] Entering SyncManager::_leaveAndChangeRow");var n=this;this._listContext._fastEditingAllowed()?$dyn.microTask(function(){n._leaveRecord(!0).done(function(){n.changeRow(e,t,o)})},n):this.changeRow(e,t,o),$dyn.log.list&&$dyn.log.list("List: [SyncManager] Leaving SyncManager::_leaveAndChangeRow")},_leaveAndLoadNextPage:function(e){var t=this;this._listContext._fastEditingAllowed()?$dyn.microTask(function(){t._leaveRecord(!0).done(function(){t._loadNextPage(e)})},t):t._loadNextPage(e)},_leaveAndLoadPreviousPage:function(e){var t=this;this._listContext._fastEditingAllowed()?$dyn.microTask(function(){t._leaveRecord(!0).done(function(){t._loadPreviousPage(e)})},t):this._loadPreviousPage(e)},_leaveRecord:function(e){var t=this,o=new $.Deferred,n=$dyn.value(this._dataProvider.SelectedIndex);if($dyn.log.list&&$dyn.log.list("List: [SyncManager] Entering SyncManager::LeaveRecord Active Row Index:%s, IsFromPendingRowsQueue:%s",n,e),this._dataProvider.isIndexWithinPage(n)){var i=this._dataProvider.getDataRowIdByPageIndex(n);this._listContext._initialDataStartPosition=$dyn.value(this._dataProvider.FetchedDataStartPosition);this.changeRow(n,null,e,!0,function(e){t._leaveRecordCallback(e,i,n),e?o.resolve():t._leaveRecordRowIndex=null})}else o.resolve();return $dyn.log.list&&$dyn.log.list("List: [SyncManager] Leaving SyncManager::_leaveRecord"),o.promise()},_leaveRecordCallback:function(e,t,o){$dyn.log.list&&$dyn.log.list("List: [SyncManager] Entering SyncManager::_leaveRecordCallback");var n=this._dataProvider.getInternalRowId(t);if(e){$dyn.log.list&&$dyn.log.list("List: [SyncManager] Leave Record for row id %s, succeeded",n);var i=$dyn.value(this._dataProvider.SelectedIndex),r=this._dataProvider.getDataRowIdByPageIndex(i);r!==t&&o===i&&(this._dataProvider.updateDataId(t,r),$dyn.log.list&&$dyn.log.list("List: [SyncManager] LeaveRecord changed data id - data id before: "+t+" After: "+r))}else $dyn.log.list&&$dyn.log.list("List: [SyncManager] Leave Record for row id %s, failed",n),this.callbackFailure(n,!1);$dyn.log.list&&$dyn.log.list("List: [SyncManager] Leaving SyncManager::_leaveRecordCallback")},createRow:function(e,t){var o=this;$dyn.microTask(function(){$dyn.log.list&&$dyn.log.list("List: [SyncManager] Sending New Row interaction to server (Alt+N)"),this._syncInProgress(!0),$dyn.callFunction(o._listContext.CreateNewRecord,o._listContext,[e],function(e){o.createNewRecordCallback(-1!=e,t)})},o)},createRowOnKeyDown:function(e,t,o){var n=this,i=e.rowId;$dyn.microTask(function(){$dyn.log.list&&$dyn.log.list("List: [SyncManager] Sending New Row interaction to server (Key Down)");var e=$dyn.peek(n._listContext._fastEdit);this._syncInProgress(!0),$dyn.callFunction(n._listContext.CreateNewRecordOnKeyDown,n._listContext,[t,o,i,e],function(e){n.createNewRecordCallback(-1!=e,i)})},n)},changeRow:function(t,o,n,e,i){$dyn.log.list&&$dyn.log.list("List: [SyncManager] Sending Change Row Interaction to row index: %s",t);var r,a,s=this,l=this._listContext.InputMode,u=!n&&l===$dyn.ui.InputType.keyboard;if(i=i||function(e){s.changeSelectedIndexCallback(e,o,n)},e){r=$dyn.controls.List.MarkMode.none,a=null,this._syncInProgress(!0);$dyn.callFunction(this._listContext.ChangeSelectedIndex,this._listContext,[t,r,a,u,i,void 0,!0,function(){s._pendingRowChange(!0)}])}else{r=this._listContext._markingAction,a=this._listContext.rangePivotWithinPage();var d=function(){$dyn.microTask(function(){if($dyn.log.list&&$dyn.log.list("List: [SyncManager] Executing changeRow micro task for row index %s",t),this._listContext._initialDataStartPosition=$dyn.value(this._dataProvider.FetchedDataStartPosition),this._syncInProgress(!0),!$dyn.value(this._pendingRowChange)||$dyn.value(this._listContext._fastEdit)){$dyn.callFunction(this._listContext.ChangeSelectedIndex,this._listContext,[t,r,a,u,i,void 0,!1,function(){s._pendingRowChange(!0)}])}else void 0!==this._pendingRowChangeSubscriber&&null!==this._pendingRowChangeSubscriber&&(this.dequeuePendingRowsToDirectInteractionQueue(this._pendingRowChangeId),this._pendingRowChange.valueChanged.unsubscribe(this._pendingRowChangeSubscriber),this._pendingRowChangeSubscriber=null),this._pendingRowChangeSubscriber=this._pendingRowChange.valueChanged.subscribe(function(e){if(!$dyn.value(e)){s._pendingRowChange.valueChanged.unsubscribe(s._pendingRowChangeSubscriber);$dyn.callFunction(s._listContext.ChangeSelectedIndex,s._listContext,[t,r,a,u,i,void 0,!1,function(){s._pendingRowChange(!0)}])}}),this._pendingRowChangeId=o},s)};0<$dyn.value(this._listContext._dataLoadPending)||$dyn.value(this._listContext._dataLoadedRenderPending)?$dyn.observe(this._listContext._dataLoadPending,function(e){if(0===$dyn.value(e))return $dyn.observe(s._listContext._dataLoadedRenderPending,function(e){if(!$dyn.value(e))return t=s._listContext._renderer.getActivePageRelatedIndex(o),d(),!1}),!1}):d()}},changeSelectedIndexCallback:function(e,t,o){$dyn.log.list&&$dyn.log.list("List: [SyncManager] Entering SyncManager::changeSelectedIndexCallback for row id %s:",t),$dyn.microTask(function(){1===e||!0===e?(this._clientInitiatedRowChange=!0,this.callbackSuccess(t,o)):0===e||!1===e?(this.callbackFailure(t,o),void 0!==this._pendingRowChangeSubscriber&&null!==this._pendingRowChangSubscriber&&(this._pendingRowChange.valueChanged.unsubscribe(this._pendingRowChangeSubscriber),this._pendingRowChangeSubscriber=null)):$dyn.log.list&&$dyn.log.list("List: [SyncManager] Interaction for row id %s, throttled",t),this._pendingRowChange(!1),o||this.dequeuePendingRowsToDirectInteractionQueue(t)},this),$dyn.log.list&&$dyn.log.list("List: [SyncManager] Leaving SyncManager::changeSelectedIndexCallback")},createNewRecordCallback:function(e,t){if($dyn.log.list&&$dyn.log.list("List: [SyncManager] Entering SyncManager::createNewRecordCallback"),$dyn.peek(this._listContext._fastEdit)){var o=this._listContext.SelectedIndex();this._dataProvider.updatePivotTables(t,o)}$dyn.microTask(function(){e?this.callbackSuccess(t,!0):this.callbackFailure(t,!0)},this),$dyn.log.list&&$dyn.log.list("List: [SyncManager] Leaving SyncManager::createNewRecordCallback")},callbackSuccess:function(e,t){if($dyn.log.list&&$dyn.log.list("List: [SyncManager] Callback success for internalRowId %s",e),t){var o,n,i=this._currentProcessingRow;if(i&&i.status===s.processing)this._doExecuteActions(i.executeActions),$dyn.log.list&&$dyn.log.list("List: [SyncManager] Syncing cell changes for internalRowId %s",e),this.syncCellChanges(i.state),this._currentProcessingRow=null,o=i.type!==u.existingRow,n=i.rowKeyDownNewRowInNonFastEditMode,this.dequeuePendingRow(i),this.processQueue(o,n)}else this._syncInProgress(!1);$dyn.ui.updateBlock(null,function(){this.setInvalidRow(null),this.setShouldReprocess(!1)},this)},syncRowAndCell:function(e,t){var o=this._dataProvider.InternalSelectedRowId(),n=this._dataProvider.DataSelectedRowId(),i=this._listContext._renderer&&this._listContext._renderer.getActivePageRelatedIndex(o);o==n||t||void 0===i||($dyn.log.list&&$dyn.log.list("List: [SyncManager] Internal selected row id: %s different from data selected row id: %s",o,n),this._leaveAndChangeRow(i,o));var r=this._listContext.Root&&this._listContext.Root.ActiveControl(),a=$dyn.value(this._listContext.GetActiveCell());$dyn.log.list&&$dyn.log.list("List: [SyncManager] Current Active Control: %s;  User active control %s",r,a),a&&!e&&void 0!==i&&$dyn.microTask(function(){$dyn.callFunction(this._listContext.SelectCell,this._listContext,[i,a,$dyn.ui.InputType.notSpecified,!1])},this)},callbackFailure:function(e,t,o){$dyn.log.list&&$dyn.log.list("List: [SyncManager] Callback failed for internal row id %s",e);var n=this._currentProcessingRow;n&&(n.status=s.pending),this._currentProcessingRow=null,n&&n.rowKeyDownNewRowInNonFastEditMode&&!n.isDirty&&this._activeRowValid()?$dyn.ui.updateBlock(null,function(){this.setShouldReprocess(!1),this._syncInProgress(!1)},this):$dyn.ui.updateBlock(null,function(){this._activeRowValid()&&this.setInvalidRow(e),this.setShouldReprocess(!1),this._syncInProgress(!1)},this),n&&!n.isDirty&&(t||o)&&this.dequeuePendingRow(n)},syncCellChanges:function(e){$dyn.log.list&&$dyn.log.list("List: [SyncManager] Entering SyncManager::syncCellChanges");var t,o=this;if(e&&0<e.length){$dyn.log.list&&$dyn.log.list("List: [SyncManager] State to sync: %o",e);var n=$.map(e,function(e){return e.action()});t=$.when.apply($.when,n).done(function(){$dyn.log.list&&$dyn.log.list("List: [SyncManager] All cell changes have been successfully synced"),$dyn.ui.updateBlock(null,function(){o.setInvalidRow(null),o._syncInProgress(!1)},this)}).fail(function(){$dyn.log.list&&$dyn.log.list("List: [SyncManager] One or more cell changes have failed to sync"),$dyn.ui.updateBlock(null,function(){o.setInvalidRow($dyn.peek(o._dataProvider.DataSelectedRowId)),o._syncInProgress(!1)},this)}),e.length=0}else $dyn.log.list&&$dyn.log.list("List: [SyncManager] No state to sync"),(t=new $.Deferred).resolve();return $dyn.log.list&&$dyn.log.list("List: [SyncManager] Leaving SyncManager::syncCellChanges"),t},setInvalidRow:function(e){this.invalidRow(e),$dyn.log.list&&$dyn.log.list("List: [SyncManager] Invalid row id : %s",e)},setShouldReprocess:function(e){this._shouldReprocess(e),$dyn.log.list&&$dyn.log.list("List: [SyncManager] ShouldReprocess flag is : %s",this._shouldReprocess())},dispose:function(){for(var e=0;e<this._disposables.length;++e){var t=this._disposables[e];t&&t.dispose&&"function"==typeof t.dispose&&t.dispose()}}}}();__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(a){!function(e){var r,t=(r=a.ui.Control,__extends(o,r),Object.defineProperty(o.prototype,"Name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"FilterManager",{get:function(){return!this._filterManager&&this.Root&&(this._filterManager=this.Root.FilterManager),this._filterManager},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"ColumnHeader",{get:function(){return this._columnHeader||(this._columnHeader=$(this.element).closest(".columnHeader")),this._columnHeader},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"GridContext",{get:function(){if(!this._gridContext){var e=$(this.element).parents("[data-dyn-role='List']");0<e.length&&(this._gridContext=a.context(e[0]))}return this._gridContext},enumerable:!1,configurable:!0}),o.prototype.getContextMenuOptions=function(){var e=[];if(this.GridContext&&a.value(this.GridContext.AllowPersonalization)&&this.Root&&a.value(this.Root.AllowExplicitPersonalization)&&!this.Root.isPopup()){var t={Label:a.label("ContextMenu_HideColumn"),Command:this.Hide.bind(this),Enabled:!0};e.push(t);var o={Label:a.label("ContextMenu_AddColumns"),Command:this.GridContext.addColumns.bind(this.GridContext),Enabled:!0};e.push(o)}return e=e.concat(r.prototype.getContextMenuOptions.call(this))},o.prototype.columnHeaderResizeEventHandling=function(e){this&&this.Root&&"Popup"===this.Root.TypeName&&null!==this.Root.popupResizeEventTarget&&(this.Root.popupResizeEventTarget=e.target),e.stopPropagation()},o.prototype.StartColumnHeaderResize=function(e,t){if(a.log.list&&a.log.list("List: Start column header resize"),$(e.target).is(".columnHeaderWrapper")){var o=a.context(e.target);if(o&&o.GridContext){var n=void 0;n=a.util.isRTLMode()?t.originalSize.width+(t.originalSize.width-t.size.width):t.originalSize.width+(t.size.width-t.originalSize.width),o.GridContext.isResizing=!0,o.GridContext._processColumnHeaderResize(e,!1,n)}}},o.prototype.StopColumnHeaderResize=function(e,t){if(a.log.list&&a.log.list("List: Stop column header resize"),$(e.target).is(".columnHeaderWrapper")){var o=a.context(e.target);if(o&&o.GridContext){var n=void 0;n=a.util.isRTLMode()?t.originalSize.width+(t.originalSize.width-t.size.width):t.originalSize.width+(t.size.width-t.originalSize.width),o.GridContext._processColumnHeaderResize(e,!0,n),o.GridContext.isResizing=!1}}},o.prototype.flyoutClickSubscriber=function(e){return 1!==$(e.clickTarget).closest(".flyout-menuItem").length&&a.util.flyout.defaultFlyoutClickSubscriber(e)},o.prototype.focusIn=function(e){var t=this,o=this.Root;o&&o.SetServerSelectedControl&&this.Name&&(a.setValue(o,"ActiveControl",this.Name),a.async(function(){a.callFunction(o.SetServerSelectedControl,o,[t.Name])},void 0,"Send SetServerSelectedControl to the server")),this.ColumnHeader.length&&this.ColumnHeader.addClass("hasFocus"),e.stopImmediatePropagation(),e.preventDefault(),a.log.stopPropagation&&a.log.stopPropagation("Prevent focusIn from bubbling up from grid column headers.")},o.prototype.focusOut=function(){this.ColumnHeader.length&&this.ColumnHeader.removeClass("hasFocus")},o.prototype.keyDown=function(e){a.util.handleShortcuts(this,e)},o.prototype.dispose=function(){this.ColumnHeaderPopup&&!this.ColumnHeaderPopup.hidden&&a.unbind(this.ColumnHeaderPopup),r.prototype.dispose.call(this)},o.prototype.updateFieldFilterExpressions=function(e){var t=e;if(e){var o=a.value(e);o.forEach(function(e){e.IsEditable=a.util.stringToBoolean(e.IsEditable)});var n=a.observableObject(o);t=a.value(n)}if(this.FilterExpressions(t),this.element){this.element.setAttribute("aria-haspopup","true"),this.ColumnHeaderPopup.hidden&&(a.dataBind(this.ColumnHeaderPopup,this.element.dynContext),this.ColumnHeaderPopup.hidden=!1);var i=a.context(this.ColumnHeaderPopup);i&&i.UpdateColumnHeaderAriaLabel()}else this.FlyOutPickerOpen(!1)},o.prototype.Hide=function(){a.callFunction(this.ExecutePersonalizationCommand,this,["SelectForHide",!1]),a.callFunction(this.PersistPersonalization,this,[a.ax.personalizableProperties.Visible,!1]),this.Root&&this.Root.ShowOrHideHiddenFields&&this.Root.ShowOrHideHiddenFields(!1)},o.prototype.buildFilteringFieldsSimpleObjectList=function(){var t=[];return this.FilteringFields&&this.FilteringFields.forEach(function(e){t.push({FormDataSourceName:a.value(e.FormDataSourceName),FieldName:a.value(e.FieldName)})}),t},o);function o(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return o&&"List"===o.TypeName&&(i._gridContext=o),void 0===i._name&&(i._name=""),i.ColumnHeaderPopup=$(t).children(".columnHeader-popup")[0],e.DataSource&&(i.FormDataSourceName=e.DataSource.FormDataSourceName,i.FieldName=e.DataSource.FieldName,i.IsFilterable=a.computed(function(){return a.value(e.DataSource.IsFilterable)||a.value(i.FieldName)===a.util.dataAreaId&&o&&a.value(o.DataSource)&&a.value(o.DataSource)[0]&&a.value(o.DataSource)[0].parent&&a.value(o.DataSource)[0].parent.IsCrossCompany}),i.IsSortable=e.DataSource.IsSortable,i.IsFiltered=e.DataSource.IsFiltered,i.IsSorted=void 0===e.DataSource.IsSorted?a.ui.SortDirection.none:e.DataSource.IsSorted,i.IsPrimarySort=e.DataSource.IsPrimarySort||!1,i.Label=e.DataSource.Label,i.Alignment=e.DataSource.Alignment,i.ControlType=e.DataSource.ControlType,i.FilteringFields=e.DataSource.FilteringFields,i.HelpText=e.DataSource.HelpText),i.FilterExpressions=a.observable(null),i.FlyOutPickerOpen=a.observable(!1),i.skipAriaAttributes=a.computed(function(){return!a.value(i.IsFilterable)&&!a.value(i.IsSortable)}),i.sortDirection=a.computed(function(){var e=a.ui.SortDirection.none;return a.value(i.IsPrimarySort)&&(e=a.value(i.IsSorted)),a.util.enumName(e,a.ui.SortDirection)}),i.ShowAddFilterDropDown=a.computed(function(){return a.value(i.FlyOutPickerOpen)&&(a.value(i.IsFilterable)||a.value(i.IsSortable))},function(e){var t=e;i.FilterManager&&t&&(a.value(i.IsFilterable)||a.value(i.IsSortable))?i.FilterManager.getFieldFilters(i.buildFilteringFieldsSimpleObjectList(),i.Name,a.value(i.Label),i.getFieldFilterCallBack):t=!1,i.FlyOutPickerOpen(t),i.Root&&i.Root.element&&(a.value(i.FlyOutPickerOpen)?$(i.Root.element).on("formClose",i.CloseFilter):$(i.Root.element).off("formClose",i.CloseFilter))}),a.observe(i.FlyOutPickerOpen,function(e){if(i.ColumnHeader.length)if(e)i.ColumnHeader.addClass("hasOpenPopup");else{var t=a.context(i.ColumnHeaderPopup);t&&t.UpdateColumnHeaderAriaLabel(!0),i.ColumnHeader.removeClass("hasOpenPopup")}}),i.CloseFilter=function(){a.setValue(i,"ShowAddFilterDropDown",!1)},i.getFieldFilterCallBack=function(e){var t=!0;if(e&&i.FilteringFields&&e.length===i.FilteringFields.length)for(var o=0;o<e.length;o++){if(!e[o]||!e[o].Capability){t=!1;break}var n=a.value(i.FilteringFields[o].Label);n&&(a.value(e[o].Capability).FieldLabel=n)}else t=!1;return t?i.updateFieldFilterExpressions(e):(i.FlyOutPickerOpen(!1),a.error({Message:a.label("List_ColumnNotFilterable"),Label:"List_ColumnNotFilterable"},i)),t},i}(e.ColumnHeader=t).prototype.FormDataSourceName="",t.prototype.FieldName="",t.prototype.ShowAddFilterDropDown=!1,t.prototype.IsFilterable=!1,t.prototype.IsSortable=!1,t.prototype.IsFiltered=!1,t.prototype.IsSorted=-1,t.prototype.Label="",t.prototype.Alignment=a.ui.autoValue,t.prototype.HelpText="";var n={RightArrowResize:{Keys:{keyCode:a.ui.KeyCodes.rightArrow},Handler:function(e){if(a.log.list&&a.log.list("List: Right arrow column resize"),this&&this.element&&this.GridContext){var t=void 0;t=a.util.isRTLMode()?this.element.clientWidth-1:this.element.clientWidth+1,this.GridContext._processColumnHeaderResize(e,!0,t)}},Description:function(){var e=a.label("Grid_GrowColumn");return a.util.isRTLMode()&&(e=a.label("Grid_ShrinkColumn")),e}},LeftArrowResize:{Keys:{keyCode:a.ui.KeyCodes.leftArrow},Handler:function(e){if(a.log.list&&a.log.list("List: Left arrow column resize"),this&&this.element&&this.GridContext){var t=void 0;t=a.util.isRTLMode()?this.element.clientWidth+1:this.element.clientWidth-1,this.GridContext._processColumnHeaderResize(e,!0,t)}},Description:function(){var e=a.label("Grid_ShrinkColumn");return a.util.isRTLMode()&&(e=a.label("Grid_GrowColumn")),e}}};t.prototype.Shortcuts=a.extendPrototype(t.prototype.Shortcuts,n)}(a.controls||(a.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();var __awaiter=this&&this.__awaiter||function(e,a,s,l){return new(s=s||Promise)(function(o,t){function n(e){try{r(l.next(e))}catch(e){t(e)}}function i(e){try{r(l.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?o(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,i)}r((l=l.apply(e,a||[])).next())})},__generator=this&&this.__generator||function(o,n){var i,r,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(a=2&t[0]?r.return:t[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,t[1])).done)return a;switch(r=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(o,s)}catch(e){t=[6,e],r=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};!function(l){!function(e){var r,t=(r=e.ProtoForm,__extends(o,r),Object.defineProperty(o.prototype,"FilterManager",{get:function(){return!this._filterManager&&this._parentRoot&&(this._filterManager=this._parentRoot.FilterManager),this._filterManager},enumerable:!1,configurable:!0}),o.prototype.UpdateColumnHeaderAriaLabel=function(e){void 0===e&&(e=!1);var t=l.value(this.FilterExpressions),o=l.value(l.value(this.IsSorted)),n="";if(t&&t.length&&!e){var i=l.label("FilterManager_ColumnFilterOpened"),r="";switch(o){case l.ui.SortDirection.ascending:r=l.label("FilterManager_SortedAscendingAria");break;case l.ui.SortDirection.descending:r=l.label("FilterManager_SortedDescendingAria");break;default:r=l.label("FilterManager_UnsortedAria")}var a=l.format(l.label("FilterManager_FilterCountAria"),t.length);t.forEach(function(e){var t=l.value(e.Capability);a+=l.util.getFilterFieldDescriptionAria(e,t)}),n=i+" "+r+" "+a}var s=$(this.element);s.attr("aria-busy","true"),s.attr("aria-label",n),s.attr("aria-busy","false")},o.prototype.processKeyDown=function(e){l.util.handleShortcuts(this,e)},o.prototype.setControlFocus=function(e){var t,o,n=l.ui.findControlElement(e,l.ui.RootType.columnHeader);if(n&&(l.log.focus&&l.log.focus("ColumnHeader setControlFocus - setting focus to control %s",e),l.util.focusElement(n),null!==(o=null===(t=this.element)||void 0===t?void 0:t.classList)&&void 0!==o&&o.contains("sysPopup-hidden"))){var i=n.getAttribute("data-dyn-focus");i&&$(n).find(i).select()}},o.prototype.HandleEnter=function(e){if(this.element){var t=e.target;if(t&&t.tagName&&"input"===t.tagName.toLowerCase()&&$.contains(this.element,t))return this.applyFilters(),!0}return!1},o.prototype.HandleEscape=function(e){return!(this.ShouldReturnFocus=!0)},o.prototype.UnwrappedFilterExpressions=function(){return l.util.unwrapFilterExpressions(this.FilterExpressions)},o.prototype.applySort=function(a){return __awaiter(this,void 0,void 0,function(){var t,o,n,i,r;return __generator(this,function(e){switch(e.label){case 0:return o=!(t=[]),this.grid&&this.grid.hasGrouping()?(o=!0,[4,this.grid.getGroupingFilterExpressions()]):[3,2];case 1:return n=e.sent(),i=n.concat(l.value(this.FilterExpressions)),t.push(l.util.unwrapFilterExpressions(i)),(r=this.grid.getGroupingSortDirections()).push(a?"1":"0"),t.push(r),[3,3];case 2:t.push(this.UnwrappedFilterExpressions()),t.push(a?"1":"0"),e.label=3;case 3:return t.push("1"),l.value(l.ax.taskRecording.isRecording())&&(t.push(this.Name),t.push(a?l.value(this.AscendingLabel):l.value(this.DescendingLabel))),o?this.FilterManager.setMultipleFieldSorts(t,l.telemetry.ActionEvents.gridColumnSort,this.setFilterSortReturnFocusCallback):this.FilterManager.setFieldSorts(t,l.telemetry.ActionEvents.gridColumnSort,this.setFilterSortReturnFocusCallback),[2]}})})},o);function o(e,t,o,n){var i=r.call(this,e,t,o,n)||this;switch(i.IsSorted=l.observable(-1),i._parentRoot=o?o.Root:void 0,i.FilterExpressions=[],e.DataSource&&(i.IsSorted(e.DataSource.IsSorted),i.FormDataSourceName=e.DataSource.FormDataSourceName,i.FieldName=e.DataSource.FieldName,i.FilterExpressions=e.DataSource.FilterExpressions,i.controlType=l.value(e.DataSource.ControlType),i.FlyOutPickerOpen=e.DataSource.FlyOutPickerOpen,i.controlName=e.DataSource.Name,e.DataSource.Grid&&(i.grid=e.DataSource.Grid),!i._parentRoot&&e.DataSource.Root&&(i._parentRoot=e.DataSource.Root)),i.Root||(i.Root=i._parentRoot),l.observe(i.FlyOutPickerOpen,function(e){!l.value(e)&&i.controlName&&(i.ShouldReturnFocus&&i._parentRoot&&i._parentRoot.setControlFocus?i._parentRoot.setControlFocus(i.controlName):i.grid&&$(i.grid.element).find(".dyn-headerCell[data-dyn-controlname='"+i.controlName+"']").focus())},void 0,void 0,!0),i.ButtonsEnabled=l.computed(function(){var t=!1;if(i.FilterExpressions){var e=l.value(i.FilterExpressions);e&&e.forEach(function(e){t=l.util.stringToBoolean(l.value(e.IsEditable))||t})}return t}),i.AscendingLabel=l.observable(""),i.DescendingLabel=l.observable(""),i.controlType){case l.ui.ControlTypes.Integer:case l.ui.ControlTypes.Int64:case l.ui.ControlTypes.Real:i.AscendingLabel(l.label("List_IncSortNumber")),i.DescendingLabel(l.label("List_DecSortNumber"));break;case l.ui.ControlTypes.Date:case l.ui.ControlTypes.DateTime:case l.ui.ControlTypes.Time:i.AscendingLabel(l.label("List_IncSortTime")),i.DescendingLabel(l.label("List_DecSortTime"));break;case l.ui.ControlTypes.Enum:case l.ui.ControlTypes.ComboBox:i.AscendingLabel(l.label("List_IncSortEnum")),i.DescendingLabel(l.label("List_DecSortEnum"));break;default:i.AscendingLabel(l.label("List_IncSortString")),i.DescendingLabel(l.label("List_DecSortString"))}return i.DescendingToggle=l.computed(function(){var e=l.value(i.IsSorted);return l.value(e)===l.ui.SortDirection.descending}),i.AscendingToggle=l.computed(function(){var e=l.value(i.IsSorted);return l.value(e)===l.ui.SortDirection.ascending}),i.setFilterSortReturnFocusCallback=function(){i.ShouldReturnFocus=!1,i.FlyOutPickerOpen(!1)},i.SortAscending=function(){i.applySort(!0)},i.SortDescending=function(){i.applySort(!1)},i.applyFilters=function(){i.FilterManager.applyFieldFilters(i.UnwrappedFilterExpressions(),i.Name,l.telemetry.ActionEvents.gridColumnFilter,i.setFilterSortReturnFocusCallback)},i.resetFilters=function(){var e;i.FilterManager.resetFieldFilters(i.UnwrappedFilterExpressions(),i.Name,l.telemetry.ActionEvents.gridColumnFilter,i.setFilterSortReturnFocusCallback),null!==(e=i.grid)&&void 0!==e&&e.resetFieldFilters&&i.grid.resetFieldFilters(i.controlName)},i}(e.ColumnHeaderPopup=t).prototype.FormDataSourceName="",t.prototype.FieldName="",t.prototype.Name="",t.prototype.IsSorted=-1,t.prototype.applyFilters=null,t.prototype.resetFilters=null,t.prototype.Label="",t.prototype.AscendingLabel="List_IncSortString",t.prototype.DescendingLabel="List_DecSortString",t.prototype.ShouldReturnFocus=!1;var n={applyFilter:{Keys:{keyCode:l.ui.KeyCodes.enter},Handler:function(e){return this.HandleEnter(e)},ShowToUser:!1},applyFilterAlt:{Keys:{alt:!0,keyCode:l.ui.KeyCodes.enter},Handler:function(e){return this.HandleEnter(e)},Description:"Apply column filtering"},escapeHandling:{Keys:{keyCode:l.ui.KeyCodes.esc},Handler:function(e){return this.HandleEscape(e)},Description:"Close column filtering",Category:l.ui.ShortcutCategory.Close}};t.prototype.Shortcuts=l.extendPrototype(t.prototype.Shortcuts,n)}(l.controls||(l.controls={}))}($dyn=$dyn||{}),function(){Globalize.addCultureInfo("en",{messages:{List_DefaultCheckBoxText:"Select Rows ",List_DefaultHeaderCheckBoxText:"Mark all rows",List_NoResultsMessage:"We didn't find anything to show here.",List_LoadingMoreData:"Loading more data...",List_IncSortNumber:"Sort smallest to largest",List_DecSortNumber:"Sort largest to smallest",List_IncSortTime:"Sort oldest to newest",List_DecSortTime:"Sort newest to oldest",List_IncSortString:"Sort A to Z",List_DecSortString:"Sort Z to A",List_ColumnNotFilterable:"Column is not filterable.",Grid_Next:"Next",Grid_Previous:"Previous"}}),$dyn.ui.ListMode={tabular:"Tabular",list:"List"};var v={newRow:$dyn.debug.general?"newRow":0,existingRow:$dyn.debug.general?"existingRow":1},g={pending:$dyn.debug.general?"pending":0,processing:$dyn.debug.general?"processing":1,processed:$dyn.debug.general?"processed":2,notQueued:$dyn.debug.general?"notQueued":3},V=$dyn.ui.selector;$dyn.controls.HierarchicalGridBase=function(e,u,t){var v,g=this,d=g._$listElement=$(u);g.ForEachRenderCount=$dyn.observable(0),g.isContainer=!0,g._isCardList=void 0,g.PageSize=25,g._PendingRowChangeCount=$dyn.observable(0),g._fastEdit=$dyn.observable($dyn.debug.gridFastEdit),g._fastEdit()&&u&&u.classList.add("isPendingCommit"),g._pendingRowsQueue=$dyn.observableArray([]),g._processServerChanges=$dyn.observable(!0),g.usingDisposable($dyn.observe(g._pendingRowsQueue,g._pendingRowsQueueUpdated,g)),this._userActionBusyTimer=void 0,this._userActionBusy=$dyn.observable(!1),this._activeRowValid=$dyn.observable(!0),this._pendingExistingRows={},this._pendingNewRowsToExistingMap={},this._createdPendingRows={},this._pendingRowIdToPendingRow={},this.usingDisposable($dyn.observe(this._userActionBusy,this._userActionBusyChanged,this)),g._allResourcesLoaded=$dyn.observable(!0),g.renderedRows=[],$dyn.ui.Control.apply(this,arguments),g._fastEdit()&&$dyn.setValue(this,"InfiniteScroll",!1),g.LayoutMinWidth={minSizeFunction:$dyn.layout.gridLayoutMinWidth,cssClassArgument:"listRoot"},g.LayoutMinHeight={minSizeFunction:$dyn.layout.gridLayoutMinHeight,cssClassArgument:"listRoot"},$dyn.isObservable(g.SelectedIndex)||(g.SelectedIndex=$dyn.observable(g.SelectedIndex)),$dyn.isObservable(g.GridLines)||(g.GridLines=$dyn.observable(g.GridLines)),this._activeCell.rowIndex=g.ConvertPageIndexToServerCacheIndex($dyn.peek(g.SelectedIndex)),g.LastSelectedIndex=g.ConvertPageIndexToServerCacheIndex($dyn.peek(g.SelectedIndex)),$dyn.isObservable(g.MarkedIndexes)||(g.MarkedIndexes=$dyn.observable(g.MarkedIndexes||[])),g.markedIndexesChanged=function(){if($dyn.log.list&&$dyn.log.list("List: _PendingRowChangeCount "+$dyn.value(g._PendingRowChangeCount)),g._supportsMarking()&&0==$dyn.value(g._PendingRowChangeCount)){$dyn.log.list&&$dyn.log.list("List: Marking Row(s)");for(var e=g.MarkedIndexes()||[],t=$(".listBody .listItem",g.element),o=g.ConvertServerCacheIndexToClientCacheIndex($dyn.value(g.FetchedDataStartPosition)),n=0,i=e.length;n<i;n++)t[n+o]&&g._setRowMarking(t[n+o],e[n])}},g.ChildHierarchy=this._rowElementGenerator(u),g.ChildHierarchy.valueChanged.subscribe(function(e){$dyn.log.list&&$dyn.log.list("List: Inactive row schema changed"),g._resetCachedInactiveItemElement($dyn.value(e)[0]),g._rerenderOptions($dyn.peek(g._rerenderOptions)+1)}),g._listBodyElement=$(".listBody",this.element)[0],g._headerRowElement=this.element&&this.element.querySelector(".listAsTable-HeaderRow"),g._inactiveItem=$dyn.observable(),g.dataSourceName=$dyn.observable("");var n,i,r,y={};g.ColumnHeaderMetadata=$dyn.computed(function(){var c=$dyn.value(u.dynChildren),p=[],h={},m={},e=null;return c.length&&(e=$dyn.value(c[0].dynChildren)),e&&e.length&&$.each(e,function(e,t){var o,n,i,r,a,s=$dyn.ui.getObservableProperty,l=$dyn.role(c[0]).getChildRole(t),u=$dyn.context(t);if(!l.isDataBound()&&u&&$dyn.log("Role %o at index %i for control %s not databound yet",l,e,t.getAttribute("data-dyn-controlname")),u)if(o=u.Name,r=v&&v[o],i=y[o],a=r&&r.Version,o&&(m[o]=u),(n=u===i?r:{FormDataSourceName:s(u,"DataSourceName"),IsNumber:u.IsNumber,Name:o,Visible:s(u,"Visible"),Alignment:s(u,"Alignment"),IsFiltered:s(u,"IsFiltered"),IsSorted:s(u,"SortDirection"),Label:g.getColumnLabel(s(u,"Label"),u.Name,s(u,"ShowLabel")),Width:s(u,"Width"),IsFilterable:s(u,"IsFilterable"),FieldName:s(u,"FieldName"),IsSortable:s(u,"IsFilterable"),ControlType:s(u,"TypeName"),IsLookupField:s(u,"LookupButton"),IsBound:!0,Version:void 0!==a?a+1:1}).FilteringFields=[],"ReferenceGroup"==u.TypeName)n.IsLookupField=!0,$dyn.value(u.Children).forEach(function(e){var t={IsFilterable:s(e,"IsFilterable"),FormDataSourceName:s(e,"DataSourceName"),FieldName:s(e,"FieldName"),ControlType:e.TypeName,Visible:s(e,"Visible"),Label:g.getColumnLabel(s(e,"Label"),e.Name,s(e,"ShowLabel")),Name:e.Name};n.FilteringFields.push(t)});else if("SegmentedEntry"==u.TypeName){var d={IsFilterable:s(u,"IsFilterable"),FormDataSourceName:u.ReferenceValueDataSourceName,FieldName:u.ReferenceValueDataSourceFieldName,ControlType:u.TypeName,Visible:s(u,"Visible"),Label:g.getColumnLabel(s(u,"Label"),u.Name,s(u,"ShowLabel")),Name:u.Name};n.FilteringFields.push(d)}else{d={IsFilterable:s(u,"IsFilterable"),FormDataSourceName:s(u,"DataSourceName"),FieldName:s(u,"FieldName"),ControlType:u.TypeName,Visible:s(u,"Visible"),Label:g.getColumnLabel(s(u,"Label"),u.Name,s(u,"ShowLabel")),Name:u.Name};n.FilteringFields.push(d)}else o=t.getAttribute("data-dyn-controlname"),a=(r=v&&v[o])&&r.Version,n=r&&!1===r.IsBound?r:{FormDataSourceName:g.DataSourceName,IsNumber:void 0,Name:o,IsFiltered:$dyn.observable(!1),IsSorted:$dyn.observable(-1),Visible:void 0,Alignment:void 0,Label:void 0,Width:void 0,IsFilterable:$dyn.observable(!1),FieldName:"",ControlType:"",IsLookupField:!1,IsBound:!1,Version:void 0!==a?a+1:1},o&&(m[o]=void 0);p.push(n),o&&(h[o]&&$dyn.logError("List: Duplicate control, name=%s",o),h[o]=n)}),v=h,y=m,p}),g.RenderedHeaderMetadata=$dyn.observable(),!d[0]||d.find(".listView").first()[0]&&(g.ListBoxIdentifier=d.find(".listView").first()[0].id);g._rerenderOptions=$dyn.observable(0),g.rerender=function(){g._rerenderOptions($dyn.peek(g._rerenderOptions)+1)},g._dataChangedVersion=$dyn.observable(0),g.dataChanged=function(){g._dataChangedVersion($dyn.peek(g._dataChangedVersion)+1)},$dyn.observe(function(){var e=u?$dyn.value(u.dynChildren):null,t=[],o=null;if(e&&e.length&&0<e.length){var n=e[0],i=$dyn.role(n),r=$dyn.context(n);i&&!i.isDataBound()&&r&&$dyn.log.list&&$dyn.log.list("Role %o not databound yet",i),o=$dyn.value(e[0].dynChildren)}if(o&&o.length)for(var a=0;a<o.length;a++){var s=$dyn.role(e[0]),l=o[a];i=s.getChildRole(l),r=$dyn.context(l);!i.isDataBound()&&r&&$dyn.log.list&&$dyn.log.list("Role %o at index %i for control %s not databound yet",i,a,l.getAttribute("data-dyn-controlname")),r&&t.push($dyn.value(r.Visible))}return t},function(e){e&&0<e.length&&g.rerender()}),g._densityChangeHandler=function(e,t){d.addClass("layoutPending"),g.RowHeightInPixels=t,g.ScrollbarSizeInPixels=2*t/3},$(document).on("densitychanged",g._densityChangeHandler),g.IsNoResultsMessageDisplayed=$dyn.computed(function(){return 0===$dyn.length(g.DataSource)}),g.NoResultImage=$dyn.shell.rootPath.concat("resources/images/emptyGrid.svg"),g.PerformNonEditModeNavigationAction=function(e){if(!$dyn.value(g.AllowEdit)&&$dyn.value(g.Enabled)&&$dyn.value(g.NavigationAction)&&$dyn.value(g.ForcePrimaryNavigation))$dyn.applyFunction(g.NavigationAction,g),e&&e.preventDefault&&e.preventDefault(),e.stopPropagation(),$dyn.log.stopPropagation&&$dyn.log.stopPropagation("Prevent form level Enter shortcut.");else if(g.IsNavigationAction(e)&&$dyn.value(g.NavigationEnabled)){var t=$(e.target).closest(".listItem")[0];if(!t)return;var o=g.rowIndex(t);e.preventDefault(),e.stopPropagation(),g.ClearMarkedState(o),g.Root&&g.Root.updateLastClientSelectedControl&&g.Root.updateLastClientSelectedControl(),$dyn.applyFunction(g.NavigationAction,g)}},g.ShowHeader=$dyn.computed(function(){return $dyn.value(g.Mode)===$dyn.ui.ListMode.tabular&&$dyn.value(g.IsHeaderVisible)}),g.isRowItemVisible=function(e,t){return e.offsetTop>=t[0].scrollTop&&e.offsetTop<t[0].scrollTop+t[0].clientHeight},g.scrollItemIntoView=function(e,t){t&&t[0]&&e&&!g.isRowItemVisible(e,t)&&$dyn.scrollIntoView(e,t[0])},g.SyncHorizontalScrollOffset=function(e){n||(n=d.find(".scrollRegion").first(),i=d.find(".table_header").first());var t=-n.scrollLeft();if($dyn.util.isRTLMode()&&$dyn.util.isWebKit()){t=Math.abs(t);t=-(n[0].scrollWidth-n[0].clientWidth-t)}if(r!==t){$dyn.util.isRTLMode()?i.css("margin-right",t.toString()+"px"):i.css("margin-left",t.toString()+"px"),e&&e("List: Sync offset from %s to %s",r,t);var o=d.find(".columnHeaderWrapper[aria-expanded='true']");if(o[0])$dyn.context(o[0])&&o[0].click()}r=t},g.applyServerCacheCoordinateShift=function(e){g._rangePivot+=e,g.clientCacheStart+=e,g.LastSelectedIndex+=e,g._serverCacheCoordinateShiftHandler&&g._serverCacheCoordinateShiftHandler(e),g._InternalFocusedRowIndex+=e},g.OnScroll=function(e){g.SyncHorizontalScrollOffset(),g._scrollHandler&&g._scrollHandler(e),g._onScrollHandled&&g._onScrollHandled()},g._updateRowMarking=function(e){if(g._supportsMarking()){if(e.unmarked)for(var t=0,o=e.unmarked.length;t<o;t++){var n=e.unmarked[t];(i=this.FindRowAtIndex(n))&&g._setRowMarking(i,!1)}if(e.marked)for(t=0,o=e.marked.length;t<o;t++){var i;n=e.marked[t];(i=this.FindRowAtIndex(n))&&($dyn.log.list&&$dyn.log.list("List: Marking row index "+n),g._setRowMarking(i,!0))}}},g.ExecuteRowMarkUpdate=function(){g._supportsMarking()&&$dyn.callFunction(g.ToggleMark,g)},g.ClearMarkedState=function(e){var t=-1,o=!1;if(g._supportsMarking()){var n=g.MarkedIndexes();t=$dyn.length(g.DataSource)-1;for(var i=[],r={unmarked:i},a=0;a<=t;a++)n[a]?e!==a&&(i.push(a),o=!0):a==e&&(r.marked=[a],o=!0);o&&g._updateRowMarking(r)}},g.MarkRange=function(e,t){if(g._supportsMarking()){for(var o={marked:[],unmarked:[]},n=$dyn.length(g.DataSource),i=g.MarkedIndexes(),r=0;r<=n-1;r++)i[r]&&o.unmarked.push(r);if(t<e){var a=e;e=t,t=a}n<=t&&(t=n-1),e<0&&(e=0);for(r=e;r<=t;r++)o.marked.push(r);g._updateRowMarking(o)}},g.CalculateRowHeight=function(){return d.find(".listView .listItem").first().outerHeight()},g.CalculateNumberOfVisibleRows=function(){var e=0,t=g.CalculateRowHeight();return 0<t&&(e=Math.floor(g.GetScrollRegionHeight()/t)),e},g.FindActiveElement=function(){return document.activeElement?g.GetSelectedRow().find(document.activeElement):null},g.GetSelectedRow=function(){return d.find(".listItem[data-dyn-row-active=true]")},g.TransferInputFocus=function(e,t){var o=!0;if(g.Root&&!g.Root.TakeFocus&&(o=!1),o){var n,i=null,r=null,a=!1;if(t&&t.length){var s=t.closest(".listCell");s.length&&(i=e.children().eq(s.index()));var l=$dyn.shell.clearBodyFocusCorrection();r=jQuery.Event("blur"),t.trigger(r),$dyn.shell.bodyFocusCorrection=l,t.prop("readonly")||(a=!0)}else if(this._fastEdit()){n=this._activeCell.controlName;i=e.find('[data-dyn-controlname="'+escape(n)+'"]')}else if(g.Root&&g.Root.ActiveControl()){n=g.Root.ActiveControl();i=e.find('[data-dyn-controlname="'+escape(n)+'"]')}if(i){var u=null,d=i.find("[data-dyn-focus]").first().addBack();if(d.length){var c=d.attr("data-dyn-focus");c&&(u=d.find(c))}u&&u.length||(u=i.find("input").first()),$dyn.log.list&&$dyn.log.list.trace("List: [fast] Transfering focus to: %s",n),r&&r.isDefaultPrevented()||!u||!u.focus().length||a&&u.select()}}return o},g.CurrentPageIndex=function(){var e=-1,t=$dyn.value(g.DataSource);return 0<t.length&&t[0]&&t[0].parent&&(e=$dyn.value(t[0].parent.pageIndex)),e},g.HasSinglePage=function(){var e=-1,t=-1,o=$dyn.value(g.DataSource),n=$dyn.length(g.DataSource);o&&0<o.length&&o[0]&&o[0].parent&&(e=$dyn.value(o[0].parent.pageIndex),t=$dyn.value(o[0].parent.clientPageSize));var i=t&&-1!==t?t:g.PageSize;return 0===n||n<i&&0===e||t<=0},g.ArePagingButtonsVisible=$dyn.computed(function(){var e=!0;return!$dyn.value(g.InfiniteScroll)&&$dyn.value(g.IsPagingSupported)&&!g.HasSinglePage()||(e=!1),e}),g.GetPreviouslyFocusedRowIndex=function(){return $dyn.value(g.AllowEdit)&&!$dyn.value(g._fastEdit)?$dyn.value(g.SelectedIndex):(void 0===g._InternalFocusedRowIndex&&(g._InternalFocusedRowIndex=$dyn.value(g.SelectedIndex)+$dyn.value(g.FetchedDataStartPosition)),g.ConvertServerCacheIndexToPageIndex(g._InternalFocusedRowIndex))},g.FocusRowRelativeToActiveRow=function(e,t,o,n){var i=$dyn.length(g.DataSource),r=g.GetPreviouslyFocusedRowIndex(),a=r+e;if(g._fastEdit()&&g.AllowEdit())return g.InputMode=$dyn.ui.InputType.keyboard,void g._fastEditUpdateRow(e,i,t,l,g.InputMode,o);function s(e){var t=g.ConvertPageIndexToClientCacheIndex(e);return 0<=t&&t<g.RenderedRowsCount()}if($dyn.value(g.InfiniteScroll)&&!0===n&&s(r)&&!s(a)&&!g._isLastRow(a-1))return!1;if(a!=r){var l=g.FindActiveElement();if(l){var u=$dyn.context(l[0]);u&&(u.updateValue&&u.updateValue(!0),u.focusOutCleanup&&u.focusOutCleanup(!0))}if(!(!!g.Root&&g.Root.HasInvalidControls())||$dyn.util.waitForClientBusy()){if(!$dyn.value(g.InfiniteScroll))if(a<0){g.CurrentPageIndex();$dyn.callFunction(g.LoadPreviousPage,g,[Math.abs(e).toString()],function(e){e||$dyn.async(function(){var e=r;g.FocusRowRelativeToActiveRow(e,t,o)},void 0,"Go to top row in current page")})}else if(i<=a){$dyn.callFunction(g.LoadNextPage,g,[e.toString()],function(e){e||$dyn.async(function(){var e=i-r-1;g.FocusRowRelativeToActiveRow(e,t,o)},void 0,"Go to bottom row in the current page.")})}($dyn.value(g.InfiniteScroll)||0<=a&&a<i)&&(g.InputMode=$dyn.ui.InputType.keyboard,g.UpdateRow(r,a,i,t,l,g.InputMode,o))}else o.stopImmediatePropagation(),g._invalidateRowSelection(a,g.ConvertServerCacheIndexToPageIndex(g.LastSelectedIndex),t),g.Root.SetFocusToInvalidControl()}},g.RowKeyDown=function(e){var t;if($dyn.log.list&&$dyn.log.list("List: Row Key Down"),!e.altKey||!e.shiftKey){g._fastEdit()&&g.AllowEdit()&&($dyn.peek($dyn.ui.updating)||($dyn.ui.updating(!0),t=!0),g._setUserActionBusy());var o=$(e.target).closest(".rowTemplate")[0],n=this.SelectedIndex();if(o&&(n=this.rowIndex(o)),e.altKey||e.which!=$dyn.ui.KeyCodes.downArrow)if(e.altKey||e.which!=$dyn.ui.KeyCodes.upArrow)if($dyn.util.isShortcutKeyPressed(e,{keyCode:$dyn.ui.KeyCodes.pageDown}))g.FocusRowRelativeToActiveRow(g.CalculateNumberOfVisibleRows(),this.calculateMarkMode(e),e);else if($dyn.util.isShortcutKeyPressed(e,{keyCode:$dyn.ui.KeyCodes.pageUp}))g.FocusRowRelativeToActiveRow(-g.CalculateNumberOfVisibleRows(),this.calculateMarkMode(e),e);else if($dyn.util.isShortcutKeyPressed(e,{ctrl:!0,keyCode:$dyn.ui.KeyCodes.spacebar})){var i=this.IsMarked(n);g._updateRowMarking({marked:i?[]:[n],unmarked:i?[n]:[]}),g.ExecuteRowMarkUpdate(),e.preventDefault()}else if($dyn.util.isShortcutKeyPressed(e,{ctrl:!0,shift:!0,keyCode:$dyn.ui.KeyCodes.letterM}))$dyn.value(g.AllowEdit)||g.ToggleMarkAllRecordsMode(),e.preventDefault(),e.stopPropagation();else if($dyn.util.isShortcutKeyPressed(e,{keyCode:$dyn.ui.KeyCodes.enter}))g.PerformNonEditModeNavigationAction(e);else if($dyn.util.isShortcutKeyPressed(e,{ctrl:!0,keyCode:$dyn.ui.KeyCodes.letterG})){var r=g.FindActiveElement();if(r){var a=$dyn.context(r[0]);if(a){var s=a.Name;a.ReferenceGroup&&(s=a.ReferenceGroup.Name);var l=d.find($dyn.format("[data-dyn-columnname={0}]",s)).find(".columnHeaderWrapper");l&&(l.click(),e.preventDefault(),e.stopPropagation(),$dyn.log("Event propagation stopped for ctrl+g inside grid"))}}}else $dyn.util.isShortcutKeyPressed(e,{alt:!0,keyCode:$dyn.ui.KeyCodes.letterN})&&g._fastEdit()?(g._createNewRow(g._getRowElementFromEvent(e)),e.preventDefault(),e.stopPropagation()):($dyn.util.isShortcutKeyPressed(e,{keyCode:$dyn.ui.KeyCodes.tab})&&g._fastEdit()||$dyn.util.isShortcutKeyPressed(e,{shift:!0,keyCode:$dyn.ui.KeyCodes.tab})&&g._fastEdit())&&this._onTabKey(e);else g.FocusRowRelativeToActiveRow(-1,this.calculateMarkMode(e),e,!0),e.stopPropagation();else g.FocusRowRelativeToActiveRow(1,this.calculateMarkMode(e),e,!0),e.stopPropagation();t&&$dyn.ui.updating(!1)}},g.OnKeyboardSecondaryNavigation=function(e){if($dyn.value(g.Enabled)){if(g.IsNavigationAction(e)&&$dyn.value(g.NavigationEnabled)){var t=$(e.target).closest(".rowTemplate")[0];if(!t)return;var o=g.rowIndex(t);e.preventDefault(),g.ClearMarkedState(o),$dyn.function(g.NavigationAction)()}}else e.preventDefault()},g.OnMouseSecondaryNavigation=function(e){function t(){e.preventDefault(),e.stopImmediatePropagation(),$dyn.log.stopPropagation&&$dyn.log.stopPropagation("Mouse Secondary Navigation (Navigation Action)")}if($dyn.value(g.Enabled)){var o=$(e.target).closest(".rowTemplate")[0];if(!o)return;var n=g.rowIndex(o);if(!$dyn.value(g.AllowEdit)&&$dyn.value(g.Enabled)&&$dyn.value(g.NavigationAction)&&$dyn.value(g.ForcePrimaryNavigation)){var i=$dyn.context(e.target);i&&$dyn.value(i.AllowEdit)||t(),$dyn.function(g.NavigationAction)()}else g.IsNavigationAction(e)&&$dyn.value(g.NavigationEnabled)?(g.ClearMarkedState(n),($dyn.util.clickedText(e.target)||g.IsCardList())&&(t(),$dyn.function(g.NavigationAction)())):g.IsValidSecondaryNavigation(e)||t()}else t()},g.IsNavigationAction=function(e){return $dyn.value(g.NavigationEnabled)&&(g.IsCardList()||g.TargetSupportsNavigation(e))},g.IsCardList=function(){return void 0===g._isCardList&&(g._isCardList=$(g.element).hasClass("cardList")),g._isCardList},g.TargetSupportsNavigation=function(e){var t=$(e.target).closest(".listCell");return t&&t.hasClass("supportsNavigation")},g.IsValidSecondaryNavigation=function(e){var t=$(e.target).closest(".listItem");return 1===t.length||t.hasClass("marked")},g.FocusRowAndSelectCell=function(e,t,o,n,i){if($dyn.log.list&&$dyn.log.list("List: Entered FocusRowAndSelectCell"),g.InputMode=n,g.FocusRow(e,o,n,i),i&&!i.ctrlKey&&!i.shiftKey&&!i.altKey&&i.target){var r=g._getParentControlName(i.target);r&&0<=e&&e<t&&$dyn.callFunction(g.SelectCell,g,[e,r,n,!1])}$dyn.log.list&&$dyn.log.list("List: Leaving FocusRowAndSelectCell")},g.BlockingDivAllowedKeyDown=function(e){$dyn.log.list&&$dyn.log.list("List: Entered BlockingDivAllowedKeyDown handler"),g.RowKeyDown(e),$dyn.log.list&&$dyn.log.list("List: Leaving BlockingDivAllowedKeyDown handler")},g.UpdateRow=function(e,t,o,n,i,r,a){$dyn.log.list&&$dyn.log.list("List: PreviouslyFocusedRowIndex: "+e),$dyn.log.list&&$dyn.log.list("List: NewFocusedRowIndex: "+t),$dyn.log.list&&$dyn.log.list("List: FetchedDataStartPosition: "+$dyn.value(g.FetchedDataStartPosition));var s=t+$dyn.value(g.FetchedDataStartPosition),l=$dyn.value(g.CacheSize);$dyn.log.list&&$dyn.log.list("List: Cache Index: "+s),$dyn.log.list&&$dyn.log.list("List: Cache Size: "+l),s<0?s=t=0:l+1<=s&&0<l&&(t=l-$dyn.value(g.FetchedDataStartPosition)-1,s=l-1),g._InternalFocusedRowIndex=s,$dyn.log.list&&$dyn.log.list("List: UpdatedFocusedRowIndex: "+t),g.SelectAndMarkRow(e,t,n,i),g.FocusRowAndSelectCell(t,o,n,r,a),a&&a.preventDefault&&a.preventDefault()},g.SelectAndMarkRow=function(e,t,o,n){$dyn.log.list&&$dyn.log.list("List: SelectAndMarkRow: Previous row index: %s; New row index: %s",e,t);var i=$(g.FindRowAtIndex(t));if(g.UpdateRowSelection(e,t),e!=t){if(o==$dyn.controls.HierarchicalGridBase.MarkMode.rangeSelect&&g.MarkRange(g.rangePivotWithinPage(),t),o===$dyn.controls.HierarchicalGridBase.MarkMode.select){var r=$dyn.value(g.AllowEdit)?t:-1;g.ClearMarkedState(r)}var a=g.TransferInputFocus(i,n);a||g.scrollItemIntoView(i[0],g._$scrollContainer)}return a},g.FocusRow=function(t,o,e,n){var i,r,a;if($dyn.log.list&&$dyn.log.list("List: FocusRow: SelectedIndex: "+$dyn.value(g.SelectedIndex)),$dyn.log.list&&$dyn.log.list("List: FocusRow: Change to row index "+t),$dyn.value(g.SelectedIndex)!=t||0<g._PendingRowChangeCount()||$dyn.value(g.MarkAllRecords)){var s=$dyn.context($dyn.value(g.Root&&g.Root.ActiveElement));if(s&&(s.updateValue&&s.updateValue(!0),s.focusOutCleanup&&s.focusOutCleanup(!0)),!(!!g.Root&&g.Root.HasInvalidControls())||$dyn.util.waitForClientBusy()){var l=g.LastSelectedIndex,u=g.ConvertServerCacheIndexToPageIndex(l);if(g._initialDataStartPosition=$dyn.value(g.FetchedDataStartPosition),g._fastEdit()&&$dyn.value(g.AllowEdit))g._changePendingSelectedIndex(t,o,e,n);else{var d=e===$dyn.ui.InputType.keyboard;$dyn.log.list&&$dyn.log.list("List: FocusRow: Sending ChangeSelectedIndex for row "+t),g._PendingRowChangeCount(g._PendingRowChangeCount()+1),$dyn.log.list&&$dyn.log.list("List: FocusRow: Incrementing _PendingRowChangeCount to "+$dyn.value(g._PendingRowChangeCount)),i=performance.now(),$dyn.callFunction(g.ChangeSelectedIndex,g,[t,o,g.rangePivotWithinPage(),d,function(e){r=performance.now(),a=r-i,$dyn.log.list&&$dyn.log.list("List: Duration of ChangeSelectedIndex: %s ms",a),g._PendingRowChangeCount(g._PendingRowChangeCount()-1),$dyn.log.list&&$dyn.log.list("List: ChangeRowCallback: Decrementing _PendingRowChangeCount to "+$dyn.value(g._PendingRowChangeCount)),e||($dyn.log.list&&$dyn.log.list("Change selected row failed on the server"),g._invalidateRowSelection(t,u,o),g.LastSelectedIndex=l)}])}return g.LastSelectedIndex=g.ConvertPageIndexToServerCacheIndex(t),t}g._invalidateRowSelection(t,g.ConvertServerCacheIndexToPageIndex(g.LastSelectedIndex),o),g.Root?g.Root.SetFocusToInvalidControl():$dyn.errorMessageBox({Text:$dyn.label("BoundaryError"),Label:"BoundaryError"})}else g._fastEdit()&&!g._activeRowValid()&&(g._setCurrentPendingRow(null),g._activeRowValid(!0));return $dyn.value(g.SelectedIndex)},g.recalculateRowIndex=function(e){var t=$dyn.value(g.FetchedDataStartPosition);if(g._initialDataStartPosition==t)return e;var o=e+g._initialDataStartPosition-t;return $dyn.log.list&&$dyn.log.list("List: recalculateRowIndex: Updating ChangeSelectedIndex row from %s to %s",e,o),o},g.headerLayoutTimer=null,g.incrementRenderCountOnHeaderLayout=!1,g.performHeaderLayout=function(e){$dyn.value(g.ShowHeader)&&(d.find(".table_header").layoutFloatingTableHeader(d.find(".TabularView")),g.incrementRenderCountOnHeaderLayout=!1)},g.postRenderInternal=function(e){if(0<d.closest("[data-dyn-lastvisible='false']").length)e||d.addClass("layoutPending");else if(!e||d.hasClass("layoutPending")){d.removeClass("layoutPending"),g.ApplyAutoSizing(),$dyn.value(g.Mode)!==$dyn.ui.ListMode.tabular?g.ForEachRenderCount($dyn.value(g.ForEachRenderCount)+1):g.performHeaderLayout(!0),$dyn.applyFunction(g.PostRender,g);var t=g.Root;!$dyn.value(g.InfiniteScroll)&&t&&t.restoreFocus&&t.restoreFocus(g.element)}},g.forceRenderCardListIE=function(){if($dyn.layout.provider.name===$dyn.layout.Providers.css3grid&&1!=$dyn.value(g.VisibleColumnCount)&&g.element.classList.contains("cardList")){var e=g._listBodyElement.style.display;g._listBodyElement.style.display="none",g._listBodyElement.style.display=e}},g.restoreSelectionFocus=function(){$dyn.log.list&&$dyn.log.list("List: [fast] Restoring focus"),g._fastEdit()&&g._currentPendingRow?g._restoreFocusToPendingRow():g.Root&&g.Root.restoreFocus&&g.Root.restoreFocus(g.element)},g.getDataColumnContextsByIndex=function(i){var r=[],e=$dyn.value(u.dynChildren);return e.length&&jQuery.each(e,function(e,t){var o=$dyn.value(t.dynChildren);if(o)var n=o[i];n&&r.push($dyn.context(n))}),r},g.interiorColumnIndex=function(e){return e-1},g.findControlElementsInAllRows=function(e){return $('[data-dyn-controlname="'+e+'"]',d)},g.IsStaticRowHeightValid=function(){return 0===d.find(".listItem").last().find(".customCellHeight").length},g.UpdateRowSelection=function(e,t){if(e!=t){g._selectingElement&&(g._selectingElement.removeAttribute("data-dyn-row-selecting"),g._selectingElement=null);var o=this.FindRowAtIndex(e);o&&o.setAttribute("data-dyn-row-active",!1),(o=this.FindRowAtIndex(t))&&($dyn.log.list&&$dyn.log.list("List: Selecting index "+t),g.InputMode===$dyn.ui.InputType.mouse?o.setAttribute("data-dyn-row-active",!0):(g._selectingElement=o).setAttribute("data-dyn-row-selecting",!0))}},g.RowClicked=function(e){g._fastEdit()&&g.AllowEdit()&&g._setUserActionBusy(),$dyn.log.list&&$dyn.log.list("List: RowClicked");var t=$(e.target).closest(".rowTemplate")[0];e.target;if(t&&!g._hasTextSelection(e)){g.InputMode=$dyn.ui.InputType.mouse;var o,n=this.rowIndex(t),i=g.GetPreviouslyFocusedRowIndex(),r=n+$dyn.value(g.FetchedDataStartPosition);g._InternalFocusedRowIndex=r,$dyn.log.list&&$dyn.log.list("List: RowClicked:_InternalFocusedRowIndex is "+r);var a=this.MarkedIndexes()[n];switch(this.UpdateRowSelection(i,n),e.which){case $dyn.ui.MouseButtonCodes.leftButton:g._isInvalidMarkTarget(e)||(o=this.calculateMarkMode(e),$dyn.log.list&&$dyn.log.list("List: Mark Mode is "+o),o===$dyn.controls.HierarchicalGridBase.MarkMode.toggle?(g._updateRowMarking({marked:a?[]:[n],unmarked:a?[n]:[]}),n==i&&g.ExecuteRowMarkUpdate()):o===$dyn.controls.HierarchicalGridBase.MarkMode.rangeSelect&&g.MarkRange(g.rangePivotWithinPage(),n)),o===$dyn.controls.HierarchicalGridBase.MarkMode.select&&(g.ClearMarkedState(n),n!=i||g.MarkedIndexes()[n]||g.ExecuteRowMarkUpdate());var s=$dyn.length(g.DataSource);g._fastEdit()?g._fastEditFocusRowAndSelectCell(null,s,o,g.InputMode,e):g.FocusRowAndSelectCell(n,s,o,g.InputMode,e),g.OnMouseSecondaryNavigation(e);break;case $dyn.ui.MouseButtonCodes.rightButton:o=this.calculateMarkMode(e),g._isInvalidMarkTarget(e)||g._updateRowMarking({marked:a?[]:[n],unmarked:a?[n]:[]}),n==i&&g.ExecuteRowMarkUpdate(),e.preventDefault(),g.FocusRow(n,o)}}},g.HeightOverride=$dyn.observable(!1),g.CachedScrollRegionHeight,g.CachedScrollRegionTop,g.scrollRegion,g.WindowResizeHandler=function(){g.UpdateScrollRegionWidth(),g._resizeHandler&&g._resizeHandler()},g.ApplyAutoSizing=function(){var l=g.GetScrollRegion();d.find(".table_header").first();0<l.length&&($dyn.observe($dyn.options(function(){return{layoutHeight:g.LayoutHeight,visibleRows:g.VisibleRowCount,rowHeight:g.RowHeightInPixels,scrollbarSize:g.ScrollbarSizeInPixels,override:g.HeightOverride}},$dyn.ui.updating),function(e){var t=e.layoutHeight.toLowerCase(),o=e.override;l.__layoutHeight&&l.__layoutHeight!==t||l.__layoutHeightOverride&&l.__layoutHeightOverride!==o?l.height(""):(l.__layoutHeight=t,l.__layoutHeightOverride=o);var n="auto"==t||"sizetocontent"==t||o?e.visibleRows:0,i=$dyn.densityThemeManager._defaultDensity;$dyn.user&&$dyn.user().Density&&(i=$dyn.value($dyn.user().Density));var r=(e.rowHeight||i)+3,a=e.scrollbarSize||2*i/3;if(!g.IsStaticRowHeightValid()||$dyn.value(g.Mode)===$dyn.ui.ListMode.list){var s=d.find(".listItem").last();0<s.length&&(r=s[0].offsetHeight)}0<n&&0!=r&&g.SetScrollRegionHeight(r*n+a)}),$dyn.observe($dyn.options(function(){return{visibleColumns:g.VisibleColumnCount}},$dyn.ui.updating),function(e){e.visibleColumns}))}},$dyn.controls.HierarchicalGridBase.prototype=$dyn.ui.extendPrototype($dyn.ui.Control.prototype,{IsSelectionIndicatorVisible:!0,IsHeaderVisible:!0,DataSource:null,NavigationEnabled:!1,ForcePrimaryNavigation:!1,NavigationAction:null,ShowHeader:!0,ShowSelection:!0,SelectedIndex:-1,FetchedDataStartPosition:0,CacheSize:0,DataAbove:!1,DataBelow:!1,LastSelectedIndex:-1,Virtualized:!1,LoadPreviousPage:null,LoadNextPage:null,ExportAllowed:!0,ExportLabel:"",ExportToExcel:null,MarkAllRecords:!1,MarkedIndexes:null,IsMarkingEnabled:!0,RowHeightInPixels:null,ScrollbarSizeInPixels:null,VisibleRowCount:0,VisibleColumnCount:0,Mode:$dyn.ui.ListMode.tabular,IsPagingSupported:!0,InfiniteScroll:null,GroupBy:"",PreRender:null,PostRender:null,GetDataVersion:null,GetDataId:null,AsyncRender:!0,ShowRowLabels:!1,GridLines:$dyn.ui.GridLines.Auto,OriginatingType:"",_selectedRow:void 0,_rangePivot:null,_initialDataStartPosition:null,_rangeSelection:!1,_markingAction:null,_densityChangeHandler:null,clientCacheStart:void 0,_InternalFocusedRowIndex:void 0,_RowCountThresholdFraction:8,InputMode:null,properties:{HideSelection:{defaultValue:!1,serialize:!0,invokeHandlers:!1}},_fastEdit:!1,_pendingRowsCount:0,_pendingRowProcessing:void 0,_pendingExistingRows:void 0,_pendingNewRowsToExistingMap:void 0,_activeRowValid:void 0,_pendingRowsQueue:void 0,_lastPendingInvalidIndex:void 0,_tabFocusing:!1,_tabFocused:!1,_processPendingRowsQueue:function(e){var i,t,o,r,n,a,s=this;a=e&&e.length,$dyn.log.list&&$dyn.log.list.trace("List: [fast] Processing queue: length: %o, row processing: %o, active row valid: %s, queue: %o",a,this._pendingRowProcessing,this._activeRowValid(),e.slice(0)),0<a&&!this._pendingRowProcessing&&this._activeRowValid()&&(i=e[0],this._pendingRowProcessing=i,n=this.SelectedIndex(),i.status=g.processing,i.type===v.newRow?($dyn.log.list&&$dyn.log.list.info("List: [fast] Processing new row: %o",i),i.target,(t=$dyn.value(this.DataSource))&&(r=this.GetDataId(t[n]),o=this._convertDataIdToPageIndex(i.targetDataId)),$dyn.microTask(function(){$dyn.callFunction(this.CreateNewRecord,this,[o],function(e){var t=s.SelectedIndex(),o=$dyn.value(s.DataSource),n=s.GetDataId(o[t]);-1!==(e=parseInt(e,10))&&r===n&&($dyn.logError("List: [fast] New selected item id can not be the same the old, new %s, old: %s, row id: %s",n,r,e),e=-1),s._createNewRecordCallback(e,i)})},this)):($dyn.log.list&&$dyn.log.list.info("List: [fast] Processing existing row: %o",i.rowIndex),$dyn.microTask(function(){$dyn.log.list&&$dyn.log.list("List: [fast] Change to index %s",i.rowIndex);var e=i.inputMode===$dyn.ui.InputType.keyboard;$dyn.callFunction(this.ChangeSelectedIndex,this,[i.rowIndex,i.markMode,i.rangePivotWithinPage,e,function(e){s._changeSelectedIndexCallback(e,i)}])},this)))},_convertDataIdToPageIndex:function(e){var t,o,n,i;for(o=0,n=(t=$dyn.value(this.DataSource)).length;o<n;o++)if(this.GetDataId(t[o])===e){i=o;break}return i},_pendingRowsQueueUpdated:function(e){e&&0<e.length&&this._processPendingRowsQueue(e)},_createNewRecordCallback:function(e,t){if(-1!==e)$dyn.log.list&&$dyn.log.list.info("List: [fast] Create new record success: %s",e),this._processPendingRowCallbackSuccess(t),this._selectedRow.parentNode&&this._makeRowInactive(this._lastPendingInvalidIndex),this._lastPendingInvalidIndex=void 0;else{$dyn.log.list&&$dyn.log.list.info("List: [fast] Create new record fail"),this._pendingRowProcessing=null;var o=this.SelectedIndex();this._lastPendingInvalidIndex!==o&&(void 0!==this._lastPendingInvalidIndex&&this._makeRowInactive(this._lastPendingInvalidIndex),this._makeRowActive(o),this._lastPendingInvalidIndex=o),this._activeRowValid(!1)}},_changeSelectedIndexCallback:function(e,t){if(e)$dyn.log.list&&$dyn.log.list.info("List: [fast] Change selected index success"),this._pendingExistingRows&&delete this._pendingExistingRows[t.targetDataId],this._processPendingRowCallbackSuccess(t),this._selectedRow.parentNode&&this._makeRowInactive(this.SelectedIndex()),this._lastPendingInvalidIndex=void 0;else{$dyn.log.list&&$dyn.log.list.info("List: [fast] Change selected index failed"),this._pendingRowProcessing=null,this._rerenderOptions($dyn.peek(this._rerenderOptions)+1);var o=this.SelectedIndex();this._lastPendingInvalidIndex!==o&&(void 0!==this._lastPendingInvalidIndex&&this._makeRowInactive(this._lastPendingInvalidIndex,!0),this._makeRowActive(o),this._lastPendingInvalidIndex=o),this._activeRowValid(!1),this._setCurrentPendingRow(null)}},_processPendingRowCallbackSuccess:function(e){this._applyChangesToRow(e),e.status=g.processed,this._pendingRowProcessing=null},_setUserActionBusy:function(){this._userActionBusyTimer?(clearTimeout(this._userActionBusyTimer),this._userActionBusyTimer=void 0,$dyn.log.list&&$dyn.log.list("List: [busy] User still active")):$dyn.log.list&&$dyn.log.list("List: [busy] User active"),this._userActionBusy(!0);var e=this;this._userActionBusyTimer=setTimeout(function(){e._userActionBusy(!1),$dyn.log.list&&$dyn.log.list("List: [busy] User not active")},4e3)},_userActionBusyChanged:function(e){$dyn.log.list&&$dyn.log.list("List: [fast] Use busy changed: %o",e);var t=this._activeCell.pendingRow;!e&&t&&0===$dyn.length(this._pendingRowsQueue)&&($dyn.log.list&&$dyn.log.list("List: [fast] Applying pending change after not busy: %o",t),t.rowIndex===this.SelectedIndex()&&(this._endCellEdit(),this._applyPendingChange(t,this._selectedRow,!0),this._activeCell={rowIndex:this.SelectedIndex(),controlName:this._activeCell.controlName},t.status=g.processed))},_onTabKey:function(e){this._activeCell;this._tabFocusing=!0,$dyn.log.list&&$dyn.log.list("List: [fast] Detecting user focus"),setTimeout(this._tabCallback.bind(this))},_tabCallback:function(){if(this._tabFocused)$dyn.log.list&&$dyn.log.list("List: [fast] Detecting user focus success");else{if($dyn.debug.general)$(document.activeElement).closest(".listRoot")[0]!==this.element?$dyn.log.list&&$dyn.log.list("List: [fast] Detecting user focus outside of grid"):$dyn.log.list&&$dyn.log.list("List: [fast] Detecting user focus failed");this._activeCell={rowIndex:this._activeCell.rowIndex,pendingRow:this._activeCell.pendingRow,controlName:null},this._endCellEdit()}this._tabFocusing=!1,this._tabFocused=!1},getCommonGridContextMenuOptions:function(){var e=[];if(this.ExportToExcel&&$dyn.value(this.ExportAllowed)){var t={Label:$dyn.label("ContextMenu_ExportAllRows"),Command:this.ExecuteExportToExcel.bind(this,!1)};e.push(t),$dyn.callFunction(this.hasMarkedRows,this)&&(t={Label:$dyn.label("ContextMenu_ExportMarkedRows"),Command:this.ExecuteExportToExcel.bind(this,!0)},e.push(t))}return e},getContextMenuOptions:function(){var e=this.getCommonGridContextMenuOptions();return Array.prototype.push.apply(e,$dyn.ui.Control.prototype.getContextMenuOptions.apply(this)),e},_focusIn:function(e){if(this._tabFocusing){var t=this._getParentControlName(e.target);this._endCellEdit(),this._activeCell={rowIndex:this._activeCell.rowIndex,pendingRow:this._activeCell.pendingRow,controlName:t},this._beginCellEdit(),this._tabFocused=!0}},_restoreFocusToPendingRow:function(){var e,t,o;this.Root&&(this.Root._focusChanging=!0,e=this._activeCell.controlName||this.Root.ActiveControl(),$dyn.log.list&&$dyn.log.list("List: [fast] Restoring focus to: %s",e),t=this._activeCell.pendingRow&&this._activeCell.pendingRow.element,(o=$('[data-dyn-controlname="'+e+'"]',t))[0]?this.TransferInputFocus(o):$dyn.logError("List: no control to focus"),this.Root._focusChanging=!1)},tryFocus:function(e){$dyn.log.list&&$dyn.log.list("List: [fast] Form try focus: %s",0<this._pendingRowsQueue().length);var t=!0;if(this._fastEdit()){var o=this._getParentControlName(e);o&&(this._activeCell={rowIndex:this._activeCell.rowIndex,pendingRow:this._activeCell.pendingRow,controlName:o}),0<this._pendingRowsQueue().length&&(t=!1)}return t},getFocusCallback:function(e){return function(){e&&e()}},get _selectedCell(){return this.__selectedCell},set _selectedCell(e){this.__selectedCell!==e&&(this.__selectedCell=e)},get _activeCell(){return this.__activeCell||(this.__activeCell={}),this.__activeCell},set _activeCell(e){var t=this.__activeCell;t!==e&&($dyn.log.list&&$dyn.log.list.trace("List: [fast] Active cell changing: new index: %s, old index: %s, new controlName: %s, old controlName: %s, prev cell: %o, new cell: %o",e.rowIndex,t.rowIndex,e.controlName,t.controlName,t,e),this.__activeCell=e)},_beginCellEdit:function(){var e,t,o,n,i=this._currentPendingRow,r=this._activeCell.initialState;if(this._activeCell.controlName||$dyn.logWarning("List: [fast] Begin called without a focused control: %o, row: %o",this._activeCell,i),r&&$dyn.logWarning("List: [fast] Begin edit already called on cell: %o, row: %o",this._activeCell,i),i){var a=this._activeCell.controlName;if($dyn.log.list&&$dyn.log.list.trace("List: [fast] Cell edit begin: controlName %o, row: %o",a,i),a)if(e=$('[data-dyn-controlname="'+escape(a)+'"]',i.element),o=(t=this._getVirtualControl(e[0]))&&t.current){i.initialState||(i.initialState={});var s=i.initialState[a];$dyn.log.list&&$dyn.log.list("List: [fast] Setting active cell initial statue: %o, row: %o",s,i),(this._activeCell.initialState=s)||(r?i.initialState[a]=r:(this._activeCell.initialState=n=o.GetState&&o.GetState(),n&&($dyn.log.list&&$dyn.log.list("List: [fast] Cell edit adding initial state for: %s, row: %o",a,i),i.initialState[a]=n)))}else $dyn.logWarning("List: [fast] Virtual control not found: %s, row: %o",a,i)}$dyn.log.list&&$dyn.log.list.trace("List: [fast] Cell edit begin done: cell: %o",this._activeCell)},_endCellEdit:function(e){var t,o,n,i,r,a,s,l,u,d,c,p,h=e;if(0===arguments.length&&(h=this._currentPendingRow),p=this._activeCell.initialState,this._activeCell.initialState=null,h){i=h.element;var m=this._activeCell.controlName;if(m&&(c=h.initialState&&h.initialState[m],p&&!c&&($dyn.log.list&&$dyn.log.list.trace("List: [fast] Active cell initial state used: %o, row: %o",p,h),h.initialState||(h.initialState={}),c=h.initialState[m]=p)),$dyn.log.list&&$dyn.log.list.trace("List: [fast] Cell edit end: controlName %o, row: %o",m,h),i&&(r=$('[data-dyn-controlname="'+escape(m)+'"]',i)[0],s=(a=this._getVirtualControl(r))&&a.current)){var v=!1;if(t=s.GetState&&s.GetState()){for(h.state||(h.state=[]),o=0,n=h.state.length;o<n;o++)if((l=h.state[o])&&l.name===m){v=!0,this._hasStateChanged(t,l.state)?(h.state=h.state.slice(0),d={name:m,state:t},h.state.splice(o,1,d),$dyn.log.list&&$dyn.log.list("List: [fast] Cell edit state replace: new %o, old %o, initial: %o",d,l,c)):$dyn.log.list&&$dyn.log.list("List: [fast] Cell edit state not changed: new %o, initial: %o",l,c),u=l;break}this._hasStateChanged(c,t)?(u||(l={name:m,state:t},h.state=h.state.slice(0),h.state.push(l)),v=!0,$dyn.log.list&&$dyn.log.list("List: [fast] Cell edit state add: %o, initial: %o",t,c)):(v=!1,$dyn.log.list&&$dyn.log.list("List: [fast] Cell edit state not changed from initial: %o, initial: %o",t,c))}v?r.setAttribute("data-dyn-pending",!0):r.removeAttribute("data-dyn-pending")}return h.state&&Object.freeze(h.state),h.state}},_hasStateChanged:function(e,t){var o,n,i,r,a;if(!e||!t)return!0;if(o=Object.keys(t),n=Object.keys(e),o.length!==n.length)return!0;for(i=0,r=o.length;i<r;i++)if(t[a=o[i]]!==e[a])return!0;return!1},_getPendingInitialState:function(e){var t,o,n,i,r,a;if(e.initialState={},e.version=1,r=$dyn.context(this._selectedRow),a=$dyn.value(r.Children))for(o=0,n=a.length;o<n;o++)(t=(i=a[o]).GetState&&i.GetState())&&(e.initialState[i.Name]||(e.initialState[i.Name]=t))},_createNewRow:function(e,t){var o,n,i,r,a,s,l,u;this._currentPendingRow&&this._endCellEdit(),o=this._activeCell.rowIndex;var d=this.renderedRows[o];for(n=this._createPendingRow({type:v.newRow,relativeRowId:o,targetDataId:this._getDataIdByPageIndex(o),target:d}),(i=(this._pendingRowIdToPendingRow[n.id]=n).target&&n.target.element)&&i.parentNode||!this._selectedRow.parentNode||(i=this._selectedRow),r=0,l=e;l;){if(o=parseInt(l.getAttribute("aria-posinset"),10),!isNaN(o)){--o;d=this.renderedRows[o];n.targetDataId=this._getDataIdByPageIndex(o),n.target=d;break}r++,l=$dyn.debug.gridAppend?l.previousSibling:l.nextSibling}if(a=this._renderPendingRow(n),n.element=a,n.element.setAttribute("data-dyn-pendingid",n.id),s=$dyn.debug.gridAppend?e.nextSibling:e,e.parentNode.insertBefore(a,s),(u=this._pendingNewRowsToExistingMap[n.targetDataId])?u.splice(r,0,n):this._pendingNewRowsToExistingMap[n.targetDataId]=u=[n],$dyn.log.list&&$dyn.log.list("List: [fast] Create row: %o, rowIndex: %s, insert order: %s, related new rows: %o, active cell: %o",n,o,r,u,this._activeCell),!t)var c=$("input",a)[0],p=this._getParentControlName(c);this._activeCell={controlName:p||this._activeCell.controlName,pendingRow:n},this.TransferInputFocus($(a)),$("[data-dyn-row-selecting]",this._listBodyElement).removeAttr("data-dyn-row-selecting"),a.setAttribute("data-dyn-row-selecting",!0),this._queuePendingRow(n)},_changePendingSelectedIndex:function(e,t,o,n){var i,r=this.renderedRows[e];r&&(this._pendingExistingRows=this._pendingExistingRows||{},i=this._pendingExistingRows[r.id],this._pendingExistingRows[r.id]?this._getPendingRowFromPendingQueue(i.id)||this._queuePendingRow(i):((i=this._createPendingRow({rowIndex:e,type:v.existingRow,markMode:t,inputMode:o,rangePivotWithinPage:this.rangePivotWithinPage(),targetDataId:r.id,target:r,element:r.element})).element.setAttribute("data-dyn-pendingid",i.id),this._pendingExistingRows[i.targetDataId]=i,this._queuePendingRow(i)),this._setCurrentPendingRow(i))},_createPendingRow:function(e){return this._nextNewRowId?this._nextNewRowId++:this._nextNewRowId=1,e.id=this._nextNewRowId,e.status=g.notQueued,this._pendingRowIdToPendingRow[this._nextNewRowId]=e},_queuePendingRow:function(e){$dyn.log.list&&$dyn.log.list("List: [fast] Adding pending row: %o",e),e.status=g.pending,this._setCurrentPendingRow(e),0===this._pendingRowsQueue().length&&this._selectedRow.parentNode&&this._makeRowInactive(this.SelectedIndex(),!0),this._pendingRowsQueue.push(e)},_setControlState:function(e,t,o,n,i){var r,a,s,l,u,d,c,p,h,m,v,g=e.state,y=e.name;if(u=o.children)for(r=0,a=u.length;r<a;r++)if(l=u[r],(s=(s=$dyn.context(l))||(s=this._getVirtualControl(l))&&s.current)&&s.Name===y){if(d={},g)for(m=0,v=(h=Object.keys(g)).length;m<v;m++)p=g[c=h[m]],(t&&t[c])!==p&&(d[c]=p);return void(0<Object.keys(d).length?($dyn.log.list&&$dyn.log.list("List: [fast] Setting control state: %s, changes: %o, state: %o, initial state: %o, row: %o",y,d,g,t,n),s.ApplyState&&s.ApplyState(d)):$dyn.log.list&&$dyn.log.list("List: [fast] No changes for control: %s, state: %o, initial state: %o, row: %o",y,g,t,n))}},_getCurrentPendingRow:function(){return this.__currentPendingRow||(this.__currentPendingRow=$dyn.observable()),this.__currentPendingRow},get _currentPendingRow(){return $dyn.value(this._getCurrentPendingRow())},set _currentPendingRow(e){this._getCurrentPendingRow()(e)},_setCurrentPendingRow:function(e,t){var o,n=this._currentPendingRow;e!==n&&(n&&(!1!==t&&this._endCellEdit(),n.status===g.notQueued&&this.SelectedIndex()===n.rowIndex&&($dyn.log.list&&$dyn.log.list("List: [fast] Applying unqueued pending row: %o",n),this._applyPendingChange(n,this._selectedRow,!0)),n.status!==g.pending||n.state&&0!==n.state.length||n.type!==v.existingRow||this._pendingRowProcessing===n||($dyn.log.list&&$dyn.log.list("List: [fast] Removing unchanged pending row: %o",n),delete this._pendingExistingRows[n.targetDataId],n.element.removeAttribute("data-dyn-pendingid"),-1!==(o=this._pendingRowsQueue().indexOf(n))&&this._pendingRowsQueue().splice(o,1))),$dyn.log.list&&$dyn.log.list("List: [fast] Set pending row: %o, prev: %o",e,n),this._currentPendingRow=e,this._beginCellEdit())},_applyInitialState:function(e,t){var o,n,i;if(e.initialState){var r=Object.keys(e.initialState);for(n=0,i=r.length;n<i;n++){var a=r[n];(o=e.initialState[a])&&this._setControlState({name:a,state:o},void 0,t,e,!1)}}},_applyPendingChange:function(e,t,o){var n,i,r;if(e.state)for(i=e.state.length,n=0;n<i;n++)(r=e.state[n])&&this._setControlState(r,o&&e.initialState[r.name],t,e,o)},_applyChangesToRow:function(o){var e,t,n,i,r,a,s,l,u,d,c,p;this._currentPendingRow;n=o.element,i=$dyn.value(this.DataSource);var h=this.SelectedIndex();if(r=i[h],a=this.GetDataId(r),s=o.targetDataId,n.removeAttribute("data-dyn-pendingid"),$("[data-dyn-pending]",n).removeAttr("data-dyn-pending"),o.type===v.newRow&&s!==a){this._createdPendingRows[a]=n;var m=this.ConvertPageIndexToClientCacheIndex(h);if(n.setAttribute("aria-posinset",this.SelectedIndex()+1),this.renderedRows[m]={element:n,version:this.GetDataVersion?this.GetDataVersion(r):void 0,selected:!1,marked:!!this.MarkedIndexes()[h],id:a},d=this._pendingNewRowsToExistingMap&&this._pendingNewRowsToExistingMap[s])for(e=0,t=d.length;e<t;e++)if(d[e].id===o.id){if(0===e?delete this._pendingNewRowsToExistingMap[s]:this._pendingNewRowsToExistingMap[s]=d.slice(0,e),this._pendingNewRowsToExistingMap[a]=d.slice(e+1),0===this._pendingNewRowsToExistingMap[a].length)delete this._pendingNewRowsToExistingMap[a];else for(l=0,u=(c=this._pendingNewRowsToExistingMap[a]).length;l<u;l++)(p=c[l]).targetDataId=a,p.target={id:a,index:this.SelectedIndex(),element:n};break}}$dyn.log.list&&$dyn.log.list("List: [fast] Scheduling task for applying pending row: %o",o),$dyn.microTask(function(){if($dyn.log.list&&$dyn.log.list("List: [fast] Applying pending row: %o, state: %o, initialState",o,o.state,o.initialState),this._userActionBusy()||this._endCellEdit(),this._applyPendingChange(o,this._selectedRow,!0),this._pendingRowsQueue.splice(0,1),0===this._pendingRowsQueue().length&&($dyn.log.list&&$dyn.log.list("List: [fast] Pending rows queue is empty"),this._userActionBusy())){var e=this._activeCell.pendingRow,t=this._createPendingRow({rowIndex:h,type:v.existingRow,status:g.notQueued,targetDataId:e.targetDataId,target:e.target,element:e.element});this._activeCell={rowIndex:this.SelectedIndex(),controlName:this._activeCell.controlName,pendingRow:t,initialState:this._activeCell.initialState},this._setCurrentPendingRow(t,!1)}},this),this.Root.ActiveControl(this._selectedCell)},_renderPendingNewRows:function(){var e,t,o,n,i,r,a,s,l,u,d,c,p,h;for($dyn.log.list&&$dyn.log.list("List: [fast] Render: %o",this._pendingNewRowsToExistingMap),o=0,n=(h=Object.keys(this._pendingNewRowsToExistingMap)).length;o<n;o++){for(t=h[o],l=this._pendingNewRowsToExistingMap[t],i=0,r=this.renderedRows.length;i<r;i++)if(this.renderedRows[i].id===t){e=this.renderedRows[i];break}if(e){if(u=document.createDocumentFragment(),$dyn.debug.gridAppend)for(a=0;a<l.length;a++)s=l[a],d=this._renderPendingRow(s),u.appendChild(d);else for(a=l.length-1;0<=a;a--)s=l[a],d=this._renderPendingRow(s),u.appendChild(d);c=e.selected?this._selectedRow:e.element,p=$dyn.debug.gridAppend?c.nextSibling:c,c.parentNode.insertBefore(u,p)}else $dyn.logError("List: [fast] Could not find render row %s",t)}},_renderedCurrentPendingRow:void 0,_renderPendingRow:function(e,t,o,n){var i=e.element;return i||(this._inactiveItem(t||{}),this._applyPendingChange(e,this._inactiveItemElement),i=this._inactiveItemElement.cloneNode(!0),e.element=i,e.type===v.newRow&&i.removeAttribute("aria-posinset"),i.setAttribute("data-dyn-pendingid",e.id)),i},_getPendingRowByPendingId:function(e){return this._pendingRowIdToPendingRow[e]},_getPendingRowFromPendingQueue:function(e){var t,o,n,i=this._pendingRowsQueue();for(t=0,o=i.length;t<o;t++)if((n=i[t])&&n.id===e)return n},_fastEditFocusRowAndSelectCell:function(e,t,o,n,i){var r,a,s,l,u,d,c,p,h,m,v,g=!1,y=!1;c=$(i.target).closest(".rowTemplate")[0],$dyn.log.list&&$dyn.log.list.info("List: [fast] Row focus, relative: %s, mouse: %s, event: %o",e,n===$dyn.ui.InputType.mouse,i),this._currentPendingRow,this._currentPendingRow&&this._endCellEdit(),c&&(a=this.rowIndex(c),n===$dyn.ui.InputType.mouse?(s=c,isNaN(a)?(g=!0,(l=this._getPendingRowByPendingId(parseInt(s.getAttribute("data-dyn-pendingid"),10)))!==this._currentPendingRow&&this._setCurrentPendingRow(l)):r=a):(1===e?s=c.nextElementSibling:-1===e&&(s=c.previousElementSibling),s?(l=this._getPendingRowByPendingId(parseInt(s.getAttribute("data-dyn-pendingid"),10)))?(g=!0,l!==this._currentPendingRow&&this._setCurrentPendingRow(l)):(r=parseInt(s.getAttribute("aria-posinset"),10)-1,this._currentPendingRow&&this._endCellEdit()):(!isNaN(a)&&this._isLastRow(a)?y=!0:(u=this._getPendingRowByPendingId(parseInt(c.getAttribute("data-dyn-pendingid"),10)))&&(d=this._convertDataIdToPageIndex(u.targetDataId),!isNaN(d)&&this._isLastRow(d)&&(y=!0)),y&&this._createNewRow(c,!0)))),(p=$("[data-dyn-row-selecting]",this._listBodyElement)).removeAttr("data-dyn-row-selecting"),g?this._activeRowValid()&&this._processPendingRowsQueue(this._pendingRowsQueue()):this.FocusRow(r,o,n,i),s&&(l=this.__currentPendingRow,s!==this._selectedRow&&s.setAttribute("data-dyn-row-selecting",!0),$('[data-dyn-controlname="'+escape(this._selectedCell)+'"]',p),h=this._getParentControlName(i.target),this._selectedCell=h,m=this._activeCell,v=this._activeCell={controlName:h,pendingRow:this._currentPendingRow,rowIndex:r},l&&this._beginCellEdit(),m.rowIndex!==v.rowIndex||v.pendingRow!==m.pendingRow?this.TransferInputFocus($(s)):$dyn.log.list&&$dyn.log.list.info("List: [fast] Row not changed, new cell: %o, prev cell: %o",v,m))},_fastEditUpdateRow:function(e,t,o,n,i,r){this._fastEditFocusRowAndSelectCell(e,t,o,i,r),r&&r.preventDefault&&r.preventDefault()},_fastEditSelectAndMarkRow:function(e,t,o,n){var i;$(this.FindRowAtIndex(t)),this.UpdateRowSelection(e,t),e!==t&&(o===$dyn.controls.HierarchicalGridBase.MarkMode.rangeSelect&&this.MarkRange(this.rangePivotWithinPage(),t),o===$dyn.controls.HierarchicalGridBase.MarkMode.select&&(i=$dyn.value(this.AllowEdit)?t:-1,this.ClearMarkedState(i)))},_selectedIndexChanged:function(){var e,t,o;$dyn.log.list&&$dyn.log.list("List: _PendingRowChangeCount "+$dyn.value(this._PendingRowChangeCount)),0<$dyn.value(this._PendingRowChangeCount)?$dyn.log.list&&$dyn.log.list("List: SelectedIndexChanged: Not updating selected index"):($dyn.value(this.DataSource),e=this.SelectedIndex(),this._activeCell={rowIndex:e,controlName:this._activeCell.controlName},this._supportsMarking(),this.GetDataId&&"function"==typeof this.GetDataId&&this.GetDataVersion&&this.GetDataVersion,this.ConvertServerCacheIndexToClientCacheIndex(this.LastSelectedIndex),(t=this.ConvertServerCacheIndexToPageIndex(this.LastSelectedIndex))!==e&&($dyn.log.list&&$dyn.log.list("List: selected index changed - old %s, new %s",t,e),o=this._makeRowInactive(this.LastSelectedIndex),this._makeRowActive(e,o),$dyn.callFunction(this.PostSelectedIndexChanged,this,[e])),this.LastSelectedIndex=this._InternalFocusedRowIndex=this.ConvertPageIndexToServerCacheIndex(e))},_makeRowInactive:function(e,t){var o,n,i,r,a,s,l,u=$dyn.value(this.DataSource),d=this._supportsMarking(),c=this.ConvertServerCacheIndexToClientCacheIndex(e),p=this.ConvertServerCacheIndexToPageIndex(e),h=this.GetDataId&&"function"==typeof this.GetDataId&&this.GetDataVersion&&"function"==typeof this.GetDataVersion;return 0<=p&&p<u.length?(a=u[p],this._inactiveItem(a),n=this._inactiveItemElement.cloneNode(!0),h&&(i=this.GetDataId(a),r=this.GetDataVersion(a),this._fastEdit()&&t&&((s=this.renderedRows[p]).element=n,l=this._createPendingRow({rowIndex:p,type:v.existingRow,targetDataId:s.id,target:s,element:this._selectedRow}),$dyn.log.list&&$dyn.log.list("List: [fast] Switch active row to inactive, index: %s",p),this._getPendingInitialState(l),l.element=n,this._pendingExistingRows[i]=l,this._applyInitialState(l,s.element)))):this.renderedRows[c]&&this.renderedRows[c].selected&&(n=this.renderedRows[c].element,i=this.renderedRows[c].id,r=this.renderedRows[c].version),n&&(n.setAttribute("aria-posinset",c+1),d&&this._setRowMarking(n,!!this.MarkedIndexes()[p]),document.activeElement&&(o=$(this._selectedRow).find(document.activeElement)),this._selectedRow.parentNode&&(this._selectedRow.parentNode.replaceChild(n,this._selectedRow),this.renderedRows[c]={element:n,version:r,selected:!1,marked:!!this.MarkedIndexes()[p],id:i})),o},_makeRowActive:function(e,t){var o,n,i,r=this._supportsMarking(),a=$dyn.value(this.DataSource);$dyn.log.list&&$dyn.log.list("List: [fast] Switch active row to active, index: %s",e),0<=e&&e<a.length&&(o=a[e],this._selectedItem(),i=this.ConvertPageIndexToClientCacheIndex(e),this._selectedRow.setAttribute("aria-posinset",i+1),this.renderedRows[i]&&(n=this.renderedRows[i].element),n&&n.parentNode&&(n.parentNode.replaceChild(this._selectedRow,n),this.renderedRows[i]={element:n,version:this.GetDataVersion?this.GetDataVersion(o):void 0,selected:!0,marked:!!this.MarkedIndexes()[e],id:this.GetDataId?this.GetDataId(o):void 0},t&&this.TransferInputFocus($(this._selectedRow),t)),this._selectedRow.setAttribute("data-dyn-row-active",!0),r&&this._setRowMarking(this._selectedRow,!!this.MarkedIndexes()[e]),!$dyn.value(this._dataLoadedRenderPending)&&this._selectedRow.parentNode&&(this._scrollParameters&&(this._scrollParameters.selectionFocusTriggerMax=void 0,this._scrollParameters.selectionFocusTriggerMin=void 0),this.scrollItemIntoView(this._selectedRow,this._$scrollContainer)))},_getDataIdByPageIndex:function(e){var t=$dyn.value(this.DataSource());if(t){var o=t[e];if(o)return this.GetDataId(o)}},_getRowElementFromEvent:function(e){return $(e.target).closest(".listItem")[0]},_getVirtualControl:function(e){var t=$(e).closest("[data-dyn-controlname]").addBack()[0];if(t){var o='[data-dyn-controlname="'+escape(t.getAttribute("data-dyn-controlname"))+'"]',n=$(this._inactiveItemElement).find(o)[0];if(n){var i=$(e).closest(".listItem")[0],r=this.rowIndex(i),a=$dyn.value(this.DataSource);if(a){var s=a[r];this._inactiveItem(s);var l=Object.create(n.dynContext.current);return l.index=r,l.serverIndex=this.ConvertPageIndexToServerCacheIndex(r)+1,l.dynContext=new $dyn.DataContext(l,n.dynContext),l.element=t,l.__elementCache={},l.dynContext}}}},ToggleMarkAllRecordsMode:function(){if(this._supportsMarking()){$dyn.callFunction(this.SetMarkAllRecordsMode,this,!$dyn.value(this.MarkAllRecords));for(var e=this._getAllRowElements(),t=0,o=e.length;t<o;t++){var n=e[t];this._setRowMarking(n,!$dyn.value(this.MarkAllRecords))}}},FindRowAtIndex:function(e){var t=parseInt(e),o=this.ConvertPageIndexToClientCacheIndex(t);return this._$listElement.find(".listItem[aria-posinset="+(o+1)+"]")[0]},_getAllRowElements:function(){return this._$listElement.find(".listBody .listItem")},_isLastRow:function(e){return this.ConvertPageIndexToServerCacheIndex(e)===$dyn.value(this.CacheSize)-1&&!1===$dyn.value(this.DataBelow)},UpdateClientCacheStart:function(e){var t=0;void 0!==this.clientCacheStart&&null!==this.clientCacheStart&&null!=e&&(t=this.clientCacheStart-e),this.clientCacheStart=e,this._clientCacheStartUpdated&&this._clientCacheStartUpdated(t)},ConvertPageIndexToServerCacheIndex:function(e){return e+$dyn.peek(this.FetchedDataStartPosition)},ConvertPageIndexToClientCacheIndex:function(e){return this.ConvertPageIndexToServerCacheIndex(e)-this.clientCacheStart},ConvertClientCacheIndexToServerCacheIndex:function(e){return e+this.clientCacheStart},ConvertClientCacheIndexToPageIndex:function(e){return this.ConvertClientCacheIndexToServerCacheIndex(e)-$dyn.peek(this.FetchedDataStartPosition)},ConvertServerCacheIndexToClientCacheIndex:function(e){return e-this.clientCacheStart},ConvertServerCacheIndexToPageIndex:function(e){return e-$dyn.peek(this.FetchedDataStartPosition)},RenderedRowsCount:function(){return this.renderedRows&&this.renderedRows.length},ChangeSelectedIndex:function(e){if(this._PendingRowChangeCount(0),Array.isArray(e)){var t=e[0],o=e[1],n=e[2],i=this.DataSource?$dyn.value(this.DataSource).length:0,r=this.MarkedIndexes();switch(o){case $dyn.controls.HierarchicalGridBase.MarkMode.select:for(var a=0;a<i;a++)r[a]&&(r[a]=!1);r[t]=!0;break;case $dyn.controls.HierarchicalGridBase.MarkMode.toggle:r[t]=!r[t];break;case $dyn.controls.HierarchicalGridBase.MarkMode.rangeSelect:var s,l;l=t<n?(s=t,n):(s=n,t);for(a=0;a<i;a++)r[a]&&(r[a]=!1);for(a=s;a<=l;a++)r[a]=!0;break;case $dyn.controls.HierarchicalGridBase.MarkMode.clearMark:for(a=0;a<i;a++)r[a]&&(r[a]=!1)}this.MarkedIndexes.valueChanged.raise(),this.SelectedIndex(t)}},setChildControlFocus:function(){var e=$dyn.util.findFirstFocusableControl(this.element);if(e)return this.setFocus(e,this.Root),e},findFieldByName:function(e){if(this._selectedRow)return $.find("[data-dyn-controlname='"+escape(e)+"']",this._selectedRow)},_layoutCompleted:function(){this.postRenderInternal(!0),this.forceRenderCardListIE()},_getHeaderId:function(e){return e&&$dyn.value(e.Name)},_getHeaderVersion:function(e){return e&&e.Version},_headerPrefixTemplate:"HierarchicalGridBaseMarkAllHeader",_getHeaderPrefix:function(){return this._headerPrefix||(this._headerPrefix=$dyn._getTemplate(this._headerPrefixTemplate).cloneNode(!0),this._headerPrefix.removeAttribute("id"),$dyn.dataBind(this._headerPrefix,this.element.dynContext)),this._headerPrefix},_renderHeader:function(){this.RenderedHeaderMetadata(this.ColumnHeaderMetadata())},_headerPreRender:function(){var e=this._getHeaderPrefix(),t=e&&e.parentNode;t&&t.removeChild(e)},_headerPostRender:function(){var e=this._getHeaderPrefix(),t=this._headerRowElement;t&&t.insertBefore(e,t.firstChild)},_resizeControlColumn:function(e,t,o){var n=this.getDataColumnContextsByIndex(e);if(n.length){for(var i=0;i<n.length;i++)if(n[i]){var r,a,s=this.findControlElementsInAllRows(n[i].Name);for(r=0,a=s.length;r<a;r++){var l=$dyn.context(s[r]);l&&l.LayoutWidth?l.LayoutWidth(t):$dyn.bindingHandlers.sizing.widthChanged(s[r],t)}}o&&1===n.length&&$dyn.callFunction(n[0].PersistPersonalization,n[0],["width",t])}},_processColumnHeaderResize:function(e,t,o){var n=$(e.target),i=n.closest(".columnHeader");if(1===i.length){var r=n.closest(".columnHeaderWrapper"),a=this.interiorColumnIndex(i.index());r.outerWidth(o),this._resizeControlColumn(a,o,t)}},_isInvalidMarkTarget:function(e){var t=!1;if(e){var o=e.target?$dyn.context(e.target):null,n=!!o&&$dyn.value(o.IsHyperlink),i=this.IsNavigationAction(e);(n||i)&&(t=$dyn.util.clickedText(e.target))}return t},getTaskGuideParams:function(e){var t,o=(e=$dyn.ui.Control.prototype.getTaskGuideParams.apply(this,[e])).action;e.arguments;if(-1!==o.indexOf("LoadNextPage")){if(t=$(this.element).children(".pagingButtons")){var n=t.children('[title="'+$dyn.label("Grid_Next")+'"]');e.target=n,e.my="top center",e.at="bottom center"}}else if(-1!==o.indexOf("LoadPreviousPage")){if(t=$(this.element).children(".pagingButtons")){n=t.children('[title="'+$dyn.label("Grid_Previous")+'"]');e.target=n,e.my="top center",e.at="bottom center"}}else o.match("MarkActiveRow|UnmarkActiveRow|ChangeSelectedIndex|ChangeSelectedIndexInCache|NavigationAction")&&(e.target=$(this.element));return e},SelectCell:function(e){var t=e[1];e[0];this.Root&&this.Root.ActiveControl&&($dyn.isObservable(this.Root.ActiveControl)?this.Root.ActiveControl(t):this.Root.ActiveControl=t)},_getParentControlName:function(e){for(var t=e;t&&"function"==typeof t.getAttribute;){var o=t.getAttribute("data-dyn-controlname"),n=t.getAttribute("data-dyn-role");if(o&&n&&"HierarchicalGridBaseRowTemplate"!==n)return o;t=t.parentNode}},ToggleMark:function(e){var t=this.MarkedIndexes(),o=this.SelectedIndex();t[o]=!t[o]},SetMarkAllRecordsMode:function(e){for(var t=this.DataSource?$dyn.value(this.DataSource).length:0,o=this.MarkedIndexes(),n=0;n<t;n++)o[n]=e},Create:function(){},Delete:function(){},getColumnLabel:function(e,t,o){return null==o||$dyn.value(o)?e:""},_invalidateRowSelection:function(e,t,o){if(e!==t){switch((r=this.FindRowAtIndex(e))&&r.removeAttribute("data-dyn-row-active"),o){case $dyn.controls.HierarchicalGridBase.MarkMode.select:case $dyn.controls.HierarchicalGridBase.MarkMode.toggle:this._removeRowMarking(r);break;case $dyn.controls.HierarchicalGridBase.MarkMode.rangeSelect:for(var n=e<t?t:e,i=t<=e?t:e;i<=n;i++){var r=this.FindRowAtIndex(i);this._removeRowMarking(r)}}var a=this.FindRowAtIndex(t);a&&(a.setAttribute("data-dyn-row-active",!0),this._setRowMarking(a,!0))}},_supportsMarking:function(){var e=!1,t=$dyn.value(this.IsMarkingEnabled),o=$dyn.value(this.IsSelectionIndicatorVisible);return t&&o?e=!0:t&&!o?e=this._markingAction!==$dyn.controls.HierarchicalGridBase.MarkMode.select:!t&&o&&(e=this._markingAction==$dyn.controls.HierarchicalGridBase.MarkMode.select),e},_setRowMarking:function(e,t){e&&(e.setAttribute("data-dyn-row-active",t),e.setAttribute("data-dyn-row-marked",t),e.children&&e.children[0]&&$(".marked-record-checkbox[role='checkbox']",e.children[0]).attr("aria-checked",t))},_removeRowMarking:function(e){e&&e.hasAttribute("data-dyn-row-active")&&(e.setAttribute("data-dyn-row-active",!1),e.children&&e.children[0]&&$(".marked-record-checkbox[role='checkbox']",e.children[0]).removeAttr("aria-checked"))},hasMarkedRows:function(){for(var e=!1,t=this.DataSource?$dyn.value(this.DataSource).length:0,o=this.MarkedIndexes(),n=0;n<t&&!e;n++)e=!0===o[n];return e},columnMutator:function(e,t){e.classList.add("listCell"),0===t&&e.classList.add("listCell-firstCell")},IsMarked:function(e){return this.MarkedIndexes()[e]},calculateMarkMode:function(e){var t,o=$(e.target);return $dyn.value(this.IsMarkingEnabled)||$dyn.value(this.IsSelectionIndicatorVisible)?o.hasClass("checkMarkTarget")||o.hasClass("markContainer")?(this._markingAction=$dyn.controls.HierarchicalGridBase.MarkMode.toggle,$dyn.controls.HierarchicalGridBase.MarkMode.toggle):($dyn.value(this.IsMarkingEnabled)?e.ctrlKey&&e.shiftKey?t=$dyn.controls.HierarchicalGridBase.MarkMode.rangeExpansion:e.ctrlKey?(t=e.which==$dyn.ui.KeyCodes.upArrow||e.which==$dyn.ui.KeyCodes.downArrow?$dyn.controls.HierarchicalGridBase.MarkMode.none:$dyn.controls.HierarchicalGridBase.MarkMode.toggle,this._rangeSelection=!1):e.shiftKey?t=$dyn.controls.HierarchicalGridBase.MarkMode.rangeSelect:$dyn.value(this.IsSelectionIndicatorVisible)?(t=$dyn.controls.HierarchicalGridBase.MarkMode.select,this._rangeSelection=!1):$dyn.value(this.IsSelectionIndicatorVisible)||(t=$dyn.controls.HierarchicalGridBase.MarkMode.clearMark,this._rangeSelection=!1):$dyn.value(this.IsSelectionIndicatorVisible)&&(t=$dyn.controls.HierarchicalGridBase.MarkMode.select),this._rangeSelection||t!=$dyn.controls.HierarchicalGridBase.MarkMode.rangeSelect||(this._rangeSelection=!0,this._rangePivot=this.SelectedIndex()+$dyn.value(this.FetchedDataStartPosition)),this._markingAction=t,this._markingAction):$dyn.controls.HierarchicalGridBase.MarkMode.none},rangePivotWithinPage:function(){return this._rangePivot-$dyn.value(this.FetchedDataStartPosition)},_rowElementGenerator:function(e){var t=this;return $dyn.computed(function(){var d=t._fastEdit()&&$dyn.value(t.AllowEdit)?"cellEditor":"cellRoleName",c=function(e){var t=document.createElement(e.nodeName),o=e.getAttribute("data-dyn-controlname");o&&t.setAttribute("data-dyn-controlname",o);var n=e.getAttribute("data-dyn-role");n&&(n=$dyn.controls[n]&&$dyn.controls[n].prototype[d]||n,t.setAttribute("data-dyn-role",n));var i=e.getAttribute("data-dyn-options");i&&t.setAttribute("data-dyn-bind",i.slice(1,-1));var r=$dyn.value(e.dynChildren);if(r)for(var a=0,s=r.length;a<s;a++){var l=r[a],u=c(l);t.appendChild(u)}return t};return c(e).children})},_cachedInactiveItemElement:void 0,get _inactiveItemElement(){var e=this._cachedInactiveItemElement;return e||($dyn.log.list&&$dyn.log.list("List: Generating inactive row element"),e=this._cachedInactiveItemElement=this.ChildHierarchy()[0]),e&&!$dyn.context(e)&&(this._itemDataContext||(this._listBodyRole=$dyn.role(this._listBodyElement),this._itemDataContext=new $dyn.DataContext(this._inactiveItem,this._listBodyElement.dynContext)),$dyn.log.list&&$dyn.log.list("List: Databinding inactive row element"),this._listBodyRole.dataBindItem(e,this._itemDataContext),$dyn.layout.arrange(e)),e},_resetCachedInactiveItemElement:function(e){this._cachedInactiveItemElement&&($dyn.log.list&&$dyn.log.list("List: Unbind inactive row"),$dyn.unbind(this._cachedInactiveItemElement)),this._cachedInactiveItemElement=e||null},updateSchema:function(e){$dyn.log.list&&$dyn.log.list("List: Inactive row schema changed (updateSchema)"),this._resetCachedInactiveItemElement(),this._rerenderOptions($dyn.peek(this._rerenderOptions)+1)},rowIndex:function(e){if(e){var t=parseInt(e.getAttribute("aria-posinset"))-1;return this.ConvertClientCacheIndexToPageIndex(t)}},rowClick:function(e){$dyn.context($(e.currentTarget).closest(".listRoot")[0]).RowClicked(e)},_getValues:function(){var e=$(".listBody",this.element).find(".listItem"),n=[];return e.each(function(e,t){var o=$(t),i=new Array;o.find(".listCell:not(.repeater-template)").each(function(e,t){var o="";if($(t).is(".checkBox-container"))o=!!$(t).attr("aria-checked");else{var n=$(t).find("input");if(0<n.length)o=n[0].value}i.push(o)}),n.push(i)}),n},_hasTextSelection:function(e){if(e.ctrlKey||e.metaKey||e.shiftKey)return!1;var t=window.getSelection().toString();return t?($dyn.log.list&&$dyn.log.list("List: row click canceled due to selection: %s",t),!0):!(!document.activeElement||$dyn.ui.selectionStart(document.activeElement)===$dyn.ui.selectionEnd(document.activeElement))&&($dyn.log.list&&$dyn.log.list('List: row click canceled due to selection: start="%s", end="%s"',$dyn.ui.selectionStart(document.activeElement),$dyn.ui.selectionEnd(document.activeElement)),!0)},ExecuteExportToExcel:function(e){$dyn.callFunction(this.ExportToExcel,this,e)},GetScrollRegion:function(){return this.scrollRegion||(this.scrollRegion=$(this.element).find(".scrollRegion").first(),this.WindowResizeHandler&&$(window).resize(this.WindowResizeHandler)),this.scrollRegion},GetScrollRegionHeight:function(){return this.GetScrollRegion().height()},SetScrollRegionHeight:function(e){this.GetScrollRegion().height(e)},GetScrollRegionWidth:function(){return this.CachedScrollRegionWidth||this.UpdateScrollRegionWidth(),this.CachedScrollRegionWidth},UpdateScrollRegionWidth:function(){this.CachedScrollRegionWidth=this.GetScrollRegion().width()},GetScrollRegionTop:function(){return void 0!==this.CachedScrollRegionTop&&null!==this.CachedScrollRegionTop||(this.CachedScrollRegionTop=this.GetScrollRegion().scrollTop()),this.CachedScrollRegionTop},UpdateScrollTop:function(e){e<0&&(e=0);var t=this.CachedScrollRegionTop;return this.CachedScrollRegionTop=null!=e?e:this.GetScrollRegion().scrollTop(),t!==this.CachedScrollRegionTop},SetScrollRegionTop:function(e){this.GetScrollRegion().scrollTop(e),this.UpdateScrollTop(e)},_updateDefaultActionEnabled:function(){var e=$dyn.value(this.NavigationEnabled);this._updateRowDefaultAction(this._cachedInactiveItemElement,e,"_lastInactiveDefaultControl"),this._updateRowDefaultAction(this._selectedRow,e,"_lastActiveDefaultControl")},_updateRowDefaultAction:function(e,t,o){var n=this[o];if(t&&e){var i=this._getDefaultControl(e);i&&(i.DefaultActionEnabled=!0),this[o]=i}!n||t&&n===i||(n.DefaultActionEnabled=!1)},_getDefaultControl:function(e){var t=$dyn.children(e);if(t)for(var o=0,n=t.length;o<n;o++){var i=t[o],r=$dyn.context(i);if(r&&r.SupportsDefaultAction)return r}},dispose:function(){$dyn.ui.Control.prototype.dispose.call(this),$(document).off("densitychanged",this._densityChangeHandler),this.WindowResizeHandler&&$(window).off("resize",this.WindowResizeHandler),this._cachedInactiveItemElement&&($dyn.unbind(this._cachedInactiveItemElement),this._cachedInactiveItemElement=null),this._lastInactiveDefaultControl=null,this._lastActiveDefaultControl=null}}),$dyn.controls.HierarchicalGridBase.MarkMode={select:0,toggle:1,rangeSelect:2,rangeExpansion:3,none:4,clearMark:5},$dyn.controls.HierarchicalGridBaseRowTemplate=function(e,t,o){$dyn.ui.Control.apply(this,arguments),this.ParentGrid=o,this.ServerFocusableControl=o},$dyn.controls.HierarchicalGridBaseRowTemplate.prototype=$dyn.extendPrototype($dyn.ui.Control.prototype,{ParentGrid:void 0,AllowPersonalization:!1,focusCallback:function(e){var t=e[0]?e[0]:this.element;if(t){var o=this.ParentGrid?this.ParentGrid.element:$(t).parents('[data-dyn-role="List"]')[0];o&&$dyn.util.focusElement(o),$dyn.log.focus&&$dyn.log.focus("Focus: Grid->focusCallback set to: %s",this.Name)}}}),$dyn.bindingHandlers.hierarchicalgridbase=function(ve,a){var ge=$dyn.bindingHandlers.foreach.task,ye=$dyn.bindingHandlers.foreach.itemTask,e=$(ve);a=a||$dyn.role(ve);var fe=$dyn.context(ve),s=!1,be=ve.dynSelectedRow;if(!be){var t=e.children().not(".repeater-template");t.attr($dyn.const.stopBindingAttribute,!0),$dyn.util.listEmpty(ve),be=fe._selectedRow=ve.dynSelectedRow=t[0].children[0]}var o,l=$(fe.element).find(".scrollRegion").first();function d(e){if(!o||e){var t=$(ve).find(".rowTemplate.listItem:last");t.length&&t[0].offsetHeight&&!$dyn.shell.isShellInitializing()&&(o=t.outerHeight())}return o}var m=ve.parentNode,v=$(".listRoot-loadingAbove",m)[0];v||(v=$("<div class='listRoot-loading listRoot-loadingAbove' style='display: none;'><span>"+$dyn.label("List_LoadingMoreData")+"</span></div>")[0],m.insertBefore(v,ve));var g=$(".listRoot-loadingBelow",m)[0];g||(g=$("<div class='listRoot-loading listRoot-loadingBelow' style='display: none;'><span>"+$dyn.label("List_LoadingMoreData")+"</span></div>")[0],m.insertBefore(g,ve.nextSibling));var n,y,r,f,b,i=$(m).find(".listRoot-loading span");function Ce(){var e=fe.GetScrollRegionWidth();e!==n&&0!==e&&(n=e,i.css("max-width",e))}var C,w=0,_=0;function u(e,t,o){e=e||0;var n=$dyn.value(o.CacheSize)||0,i=$dyn.value(o.FetchedDataStartPosition)||0,r=$dyn.value(o.DataAbove),a=$dyn.value(o.DataBelow),s=void 0!==fe.clientCacheStart&&(r||0<fe.clientCacheStart),l=void 0!==fe.clientCacheStart&&(a||fe.clientCacheStart+t<n);f!==s&&(v.style.display=s?"block":"none",f=s),b!==l&&(g.style.display=l?"block":"none",b=l),!w&&s&&(w=$(v).outerHeight()),!_&&l&&(_=$(g).outerHeight());var u=0,d=0;s&&(u=w),l&&(d=_);var c=fe.GetScrollRegionHeight(),p=u,h=$(m).height()-d-c;s&&(p+=e),l&&(h-=e),function(){if(0!==S){if(y){var e=S*y.rowHeight;fe.SetScrollRegionTop(fe.GetScrollRegionTop()+e)}S=0}}(),y=fe._scrollParameters={cacheSize:n,fetchedDataStartPosition:i,dataAbove:r,dataBelow:a,dataTriggerMax:h,dataTriggerMin:p,rowHeight:e,renderedRowCount:t,bufferAboveHeight:u,bufferBelowHeight:d},C=0!==c}var S=0;var c;function we(){y&&(M||($dyn.value(E)<=0&&!$dyn.value(Se)&&!$dyn.value($dyn.clientBusy)?A():M=!0))}function _e(){if($dyn.value(fe.InfiniteScroll)){var e=d();if(fe)u(e,fe.RenderedRowsCount(),fe)}}function p(e,t){if(!y||void 0===fe.clientCacheStart||fe.Root&&fe.Root.IsCloseRequested&&fe.Root.IsCloseRequested())return!1;if(t<=0||e>=fe.clientCacheStart&&0<t&&e+t<=fe.clientCacheStart+y.renderedRowCount)return $dyn.log.list&&$dyn.log.list("List: Loading Data - not needed. Requested start: %s, requested size: %s",e,t),!1;if(e+t<=0&&!y.dataAbove)return $dyn.log.list&&$dyn.log.list("List: Loading Data - not needed. Requested start: %s, requested size: %s",e,t),!1;if(e>=y.cacheSize&&!y.dataBelow)return $dyn.log.list&&$dyn.log.list("List: Loading Data - not needed. Requested start: %s, requested size: %s",e,t),!1;var o=!1;return e<fe.clientCacheStart&&(y.dataAbove||0<fe.clientCacheStart)&&(o=!0),e+t>y.renderedRowCount&&(y.dataBelow||fe.clientCacheStart+y.renderedRowCount<y.cacheSize)&&(o=!0),o||$dyn.log.list&&$dyn.log.list("List: Loading Data - not needed. Requested start: %s, requested size: %s",e,t),o}var h={};function I(e,t){(function(){if(!y||!1!==h.isDirty)return 1;var e=!(y.dataAbove===h.dataAbove&&y.dataBelow===h.dataBelow&&y.cacheSize===h.cacheSize&&y.fetchedDataStartPosition===h.fetchedDataStartPosition&&y.renderedRowCount===h.renderedRowCount&&fe.clientCacheStart===h.clientCacheStart);return e||$dyn.log.list&&$dyn.log.list("List: Loading Data - state didn't change"),e})()&&p(e,t)&&(E($dyn.value(E)+1),r=t,h={isDirty:!1,dataAbove:y.dataAbove,dataBelow:y.dataBelow,cacheSize:y.cacheSize,fetchedDataStartPosition:y.fetchedDataStartPosition,renderedRowCount:y.renderedRowCount,clientCacheStart:fe.clientCacheStart},$dyn.callFunction(fe.LoadData,self,[e,t],function(e){0<(e=parseInt(e))&&fe.applyServerCacheCoordinateShift(e),R?N++:(Se(!0),E($dyn.value(E)-1))}))}function T(e){if(y&&y.rowHeight)return 2*Math.ceil(e/y.rowHeight)}function x(){if(y&&y.rowHeight){var e=fe.GetScrollRegionTop();return Math.floor((e-y.bufferAboveHeight)/y.rowHeight)}}function F(e){var t=d();if(e&&t)return Math.round(e/t)}function k(e){var t;if(y&&y.rowHeight&&y.cacheSize){var o=x(),n=F(e),i=r||T(e);t=i<n?o:o-Math.round((i-n)/2),(t=fe.ConvertClientCacheIndexToServerCacheIndex(t))+i>=y.cacheSize&&(t=y.cacheSize-i),t<0&&(t=0)}return t}var P,R,M,E=$dyn.observable(0),N=0,Se=fe._dataLoadedRenderPending=$dyn.observable(0);function A(){var e=fe.GetScrollRegionTop(),t=!1;return y&&((e<y.dataTriggerMin||e>y.dataTriggerMax)&&(t=function(e){var t=fe.GetScrollRegionHeight();if(!y||!y.rowHeight||!t||$dyn.shell.isShellInitializing()||void 0===fe.clientCacheStart)return!1;var o=T(t),n=fe.clientCacheStart,i=!1;if(e>y.dataTriggerMax){var r=n+fe.RenderedRowsCount();if(y.dataBelow||r<y.cacheSize)I(r-1,o),i=!0}if(e<y.dataTriggerMin&&!i){if(y.dataAbove||0<=n)I(n-o,o)}return!0}(e)),e>=y.selectionFocusTriggerMin&&e<=y.selectionFocusTriggerMax&&(fe.restoreSelectionFocus(),y.selectionFocusTriggerMax=void 0,y.selectionFocusTriggerMin=void 0)),t}function D(){$dyn.value(E)<=0&&!$dyn.value(Se)&&M&&!$dyn.value($dyn.clientBusy)&&(!1===C&&_e(),A(),M=!1)}fe.usingDisposable($dyn.observe(E,function(){D()})),fe.usingDisposable($dyn.observe(Se,function(){D()})),fe.usingDisposable($dyn.observe($dyn.clientBusy,function(){D()}));var L=!1;function O(){if(y&&y.rowHeight&&fe.DataSource){var e=x(),t=e+F(fe.GetScrollRegionHeight())-1;e=fe.ConvertClientCacheIndexToServerCacheIndex(e),t=fe.ConvertClientCacheIndexToServerCacheIndex(t);var o=$dyn.value(fe.FetchedDataStartPosition),n=$dyn.value(fe.DataSource).length;return o<=e&&t<=o+n-1}return!0}function B(){y&&(fe.UpdateScrollTop()&&(h.isDirty=!0),L||!O()&&y&&y.rowHeight&&y.cacheSize&&(L=!0,$dyn.callFunction(fe.SetClientViewStart,fe,[],void 0,void 0,function(e){L=!1;var t=k(fe.GetScrollRegionHeight());e.PositionalParameters=[t],$dyn.log.list&&$dyn.log.list("List: SetClientViewStart command is executing with an argument: %s",t)})),M||($dyn.value(E)<=0&&!$dyn.value(Se)&&!$dyn.value($dyn.clientBusy)?A():M=!0)),P&&clearTimeout(P),R=!0,P=setTimeout(function(){P=void 0,R=!1,0<N&&(Se(!0),E($dyn.value(E)-N),N=0)},100)}function Ie(){if(fe.Root&&fe.Root.isFormActive()&&$dyn.value(fe.Root.TakeFocus)&&$dyn.value(fe.Root.ReadyState)!==$dyn.ui.ReadyState.aborted){var e=$dyn.value(fe.Root.ActiveControl());if(!e)return;var t=$(V().attr("data-dyn-controlname",e).find(fe.element));if(0===t.length||1===t.length&&0!==t.closest(".place-holder").length)return;if(y){var o=y.bufferAboveHeight+y.rowHeight*fe.ConvertPageIndexToClientCacheIndex($dyn.value(fe.SelectedIndex)),n=o,i=o+y.rowHeight-fe.GetScrollRegionHeight(),r=fe.GetScrollRegionTop();i<=r&&r<=n?(fe.restoreSelectionFocus(),y.selectionFocusTriggerMax=void 0,y.selectionFocusTriggerMin=void 0):(y.selectionFocusTriggerMax=n,y.selectionFocusTriggerMin=i,document.activeElement!==l[0]&&($dyn.log.focus&&$dyn.log.focus("Grid->Focus the scroll region after rendering infinite scroll grid"),l.focus()))}else fe.restoreSelectionFocus()}}return fe._loadDataNeeded=p,fe._readjustScrollState=_e,fe._pageCoversViewport=O,fe._getFirstVisibleRow=x,fe._getDesiredPageStart=k,fe._getDesiredPageSize=T,fe._getVisibleRowCount=F,fe._dataLoadPending=E,fe._dataLoadedRenderPending=Se,$dyn.value(fe.InfiniteScroll)&&(fe._scrollHandler=function(){i.css("margin-left",fe.GetScrollRegion().scrollLeft()),B()},fe._resizeHandler=function(){Ce()}),fe.usingDisposable($dyn.layout.registerEndReflowHandler(fe.element,function(){fe.SyncHorizontalScrollOffset($dyn.log.list),c&&clearTimeout(c),c=fe.setTimeout(function(){$dyn.log.list&&$dyn.log.list("List: Reflow Handler invoked"),$dyn.value(fe.InfiniteScroll)&&(_e(),we()),c=void 0,fe._reflowHandlerInvoked&&fe._reflowHandlerInvoked()})})),fe._clientCacheStartUpdated=function(e){S+=e},fe.usingDisposable($dyn.observe(fe.InfiniteScroll,function(e){e||(fe._scrollHandler=null,fe._resizeHandler=null,y=fe._scrollParameters=null,$(v).height(0),$(g).height(0))})),fe.__restoreSelectionFocus=Ie,{apply:function(re,e){var ae=this;ve.dynVirtualContext={getContext:function(){return fe._getVirtualControl.apply(fe,arguments)}};var se=re;if(null!=re){if(!(e instanceof $dyn.DataContext))throw new TypeError("The argument 'dataContext' must be a an instance of $dyn.DataContext");if(!(re instanceof Array)){se=re.collection;var le=re.deferred,o=re.preRender,ue=re.postRender;if(fe._fastEdit()){var t=fe._updating=$dyn.observable(!1);fe._updatingComputed=function(){return 0<fe._pendingRowsQueue().length||fe._userActionBusy()||0<$dyn.value(fe._PendingRowChangeCount)||$dyn.value(re.updating)},$dyn.observe(fe._updatingComputed,function(e){t(e)})}else{t=$dyn.computed(function(){return 0<$dyn.value(fe._PendingRowChangeCount)||$dyn.value(re.updating)});fe._updatingComputed=t}var de=re.renderPlaceholderRow,n=re.skipRenderDuringStaticLoading,ce=fe._$scrollContainer=re.scrollContainer}if(ae.collection=se,ae.selectedIndex=re.selectedIndex,be){fe._selectedItem=ae.selectedItem=$dyn.computed(function(){var e=$dyn.value(re.collection);return e&&e[ae.selectedIndex()]});var i=new $dyn.DataContext(ae.selectedItem,e);be.setAttribute("aria-posinset",parseInt(ae.selectedIndex())+1),be.setAttribute("data-dyn-row-active",!0),fe.MarkedIndexes()&&fe._setRowMarking(be,!!fe.MarkedIndexes()[ae.selectedIndex()]),a.dataBindItem(be,i)}fe._headersDataBound=!1,$dyn.observe(fe.ShowHeader,function(e){fe._header=$(fe.element).find(".listHeader")[0],e&&!fe._headersDataBound&&($dyn.dataBind(fe._header,fe),fe._headersDataBound=!0),fe._header.hidden=!e}),ae.isValidCollectionItemId=function(e){return e&&0!=e},ae.resources=function(){var e=fe.Root&&fe.Root.element;return e?$dyn.resources.getResource(e):[]};var pe,he=function(e){var t=fe.renderedRows[e];if(t)return t.selected?be:t.element};ae.runDiscardPolicy=function(){if(!0===fe._disableDiscardPolicy)return!1;if(void 0!==fe.clientCacheStart&&null!==fe.clientCacheStart){var e=d(),t=fe.GetScrollRegionHeight();if(e&&y&&0<t){var o=x(),n=F(t),i=fe._RowCountThresholdFraction*n,r=fe.renderedRows.length;if(i<r){var a=Math.round(i/2);a<2*n&&(a=2*n);var s=o-Math.floor((a-n)/2),l=o+n+Math.ceil((a-n)/2)-1;r<=l&&(s-=l-r+1,l=r-1),s<0&&(l-=s,s=0);var u=function(e,t){for(var o=e;o<t;++o){var n=he(o);n&&n.parentNode&&n.parentNode.removeChild(n)}fe.renderedRows.splice(e,t)};return u(l+1,r),u(0,s),$dyn.log.list&&$dyn.log.list("List: Discard policy. Discarding "+s+" rows above"),$dyn.log.list&&$dyn.log.list("List: Discard policy. Discarding "+(r-l-1)+" rows below"),fe.UpdateClientCacheStart(fe.clientCacheStart+s),!0}}}return!1},ae.applyForeach=function(){var e=ve.dynForeachOptions;if(null!=(se=e.collection)){ve.dynListRendering&&$dyn.log("list binding already pending"),ve.dynListRendering=!0;var t=function(){var e=performance.now();if(ge&&ge.start(),fe._inactiveItemElement&&se){var t,o=$dyn.value(fe.FetchedDataStartPosition),n=$dyn.peek(re.selectedIndex),i=fe._supportsMarking(),r=se.length,a=fe.MarkedIndexes(),s=$dyn.peek(Se),l=fe.GetDataId&&"function"==typeof fe.GetDataId&&fe.GetDataVersion&&"function"==typeof fe.GetDataVersion;void 0!==fe.clientCacheStart&&(t=o-fe.clientCacheStart);var u=$dyn.value(re.groupBy);if(u&&($dyn.setValue(fe,"InfiniteScroll",!1),pe=!0),fe.ExtendedStyle&&$dyn.setValue(fe,"InfiniteScroll",!1),$dyn.log.list&&$dyn.log.list("List: Starting rendering. Server state: CacheSize: %i, FetchedDataStartPosition: %i, DataAbove: %s, DataBelow: %s, PageSize: %i. Client state: CacheStart: %i, RowCount: %i, FullRenderPending: %s, PreserveOldRows: %s, SupportsDataId: %s",$dyn.value(fe.CacheSize),$dyn.value(fe.FetchedDataStartPosition),$dyn.value(fe.DataAbove),$dyn.value(fe.DataBelow),$dyn.value(fe.DataSource).length,fe.clientCacheStart,fe.RenderedRowsCount(),pe,s,l),pe&&$dyn.util.listEmpty(ve,!1),le){var d=!1;$dyn.peek($dyn.ui.updating)||($dyn.ui.updating(!0),d=!0),le=!1}var c,p,h,m,v,g,y,f,b=$dyn.ui.layout();b||$dyn.ui.layout(!0),pe&&fe._updateDefaultActionEnabled(),u&&(v=$(fe._inactiveItemElement).find('[data-dyn-controlname="'+u+'"]')[0],g=$dyn.templates.HierarchicalGridBaseGroupTemplate);var C=null,w=null,_=[],S=[],I={};if(null!=t){for(var T=t;T<r+t&&T<fe.renderedRows.length;T++){(G=fe.renderedRows[T])&&G.id&&(I[G.id]=$.extend({},G,{order:T}))}s&&(fe.renderedRows[t-1]&&(w=he(t-1)),fe.renderedRows.length&&t>=fe.renderedRows.length&&(w=he(fe.renderedRows.length-1)))}for(var x=function(){C||(C=document.createDocumentFragment(),_.push(C),S.push(w))},F=function(e){return fe._inactiveItem(e),fe._inactiveItemElement.cloneNode(!0)},k=[],P=-1,R=0,M=0,E=0,N=0,A=0;A<r;A++){ye&&ye.start(A);var D=!1,L=se[A];if(A!==n){var O=fe.GetDataId&&fe.GetDataId(L);if(l&&ae.isValidCollectionItemId(O)){var B=fe._pendingExistingRows&&fe._pendingExistingRows[O],V=fe._currentPendingRow===B,H=fe.GetDataVersion(L),G=I[O];if(pe||!G||G.version!==H||G.selected)x(),f=F(se[A]),R++;else{var z=G.element,U=G.order;P<U?(C=null,w=z,P=U,G&&G.marked!==a[A]&&fe._setRowMarking(z,a[A]),D=!0,M++):(x(),E++),f=z,I[O]=null}k.push({element:f,id:O,version:H,selected:!1,marked:i&&a[A],pendingRow:B,pendingRowSelected:V,index:A})}else x(),f=F(se[A]),k.push({element:f,selected:!1,marked:i&&a[A]}),s=!1,R++}else{be.setAttribute("data-dyn-row-active",!0),f=be;O=fe.GetDataId?fe.GetDataId(L):void 0;var W=fe.GetDataVersion?fe.GetDataVersion(L):void 0;if(l&&ae.isValidCollectionItemId(O)){G=I[O];!pe&&G&&G.selected&&G.order>P?(C=null,w=be,I[O]=null,M++):(x(),E++),(G&&G.marked!==a[A]&&G.selected||!G)&&(fe._setRowMarking(f,a[A]),D=!0)}else x(),R++;k.push({element:F(L),id:O,version:W,selected:!0,marked:i&&a[A],index:A})}!D&&i&&fe._setRowMarking(f,!!a[A]),u&&(A===n&&fe._inactiveItem(se[A]),(m=$dyn.context(v))&&c!==(p=$dyn.value(m.formattedValue))&&(h&&(h.appendChild(C),h=null),h||((y=g.cloneNode(!0)).getElementsByClassName("listGroupTitle")[0].innerText=p,h=y.getElementsByClassName("listGroupContent")[0],ve.appendChild(y)),c=p)),C&&f&&C.appendChild(f),ye&&ye.stop(A)}r?(!s||void 0===fe.clientCacheStart||null===fe.clientCacheStart||o<fe.clientCacheStart)&&fe.UpdateClientCacheStart(o):s||fe.UpdateClientCacheStart(void 0),fe.LastSelectedIndex=me=fe.ConvertPageIndexToServerCacheIndex(n),fe._fastEdit()&&fe._currentPendingRow||(fe._InternalFocusedRowIndex=me);var K=n<0||r<=n,q=function(e){if(e){var t=e.element;t&&t.parentNode&&(t.parentNode.removeChild(t),N++),e.selected&&K&&be.parentNode&&(be.parentNode.removeChild(be),N++)}};if(s)for(var j=0,Q=Object.keys(I),Y=Q.length;j<Y;++j){q(L=I[O=Q[j]])}else for(j=0;j<fe.renderedRows.length;++j){O=(L=fe.renderedRows[j])&&L.id;(!ae.isValidCollectionItemId(O)||void 0===I[O]||void 0!==I[O]&&null!==I[O])&&q(L)}if($dyn.log.list&&$dyn.log.list("List: Rendering: Created count: %i, Reused count: %i, Moved count: %i, Removed count: %i",R,M,E,N),0===r&&de?(x(),be.classList.add("place-holder"),C.appendChild(be),k.push({element:null,selected:!0,marked:!1}),$dyn.log.list&&$dyn.log.list("List: Rendering placeholder row")):be.classList.remove("place-holder"),h)h.appendChild(C),h=null;else for(j=0,Y=_.length;j<Y;++j){var Z=S[j];Z&&Z.parentNode&&Z.parentNode===ve?($dyn.log.list&&$dyn.log.list("List: Rendering insert before row.%o",Z.nextSibling),ve.insertBefore(_[j],Z.nextSibling)):0!==j||null!==Z&&Z.parentNode?$dyn.logError("List: Insertion point unknown for dom fragment"):($dyn.log.list&&$dyn.log.list("List: Rendering insert at the begin.%o",ve.firstChild),ve.insertBefore(_[j],ve.firstChild))}if(pe=!1,s){var J=0<=t?t:0,X=0<=t?r:r+t;Array.prototype.splice.apply(fe.renderedRows,[J,X].concat(k))}else fe.renderedRows=k;if(u){var ee,te=function(){$(".listGroupContent").each(function(e){var t=$(this.children[0]).outerHeight(!0),o=$(this).closest(".scrollRegion").height()-$(this).siblings(".listGroupTitle").outerHeight(),n=Math.floor(o/t),i=Math.ceil(this.childElementCount/n),r=$(this.children[0]).outerWidth(!0);$(this).width(r*i),$(this).height(t*n)})};$(window).resize(function(){clearTimeout(ee),ee=setTimeout(te,200)}),$(f).is(":hidden")?setTimeout(te,200):te()}fe._fastEdit()&&fe._renderPendingNewRows(),_e(),$dyn.value(fe.InfiniteScroll)&&(ae.runDiscardPolicy()&&_e(),we()),function(){if(fe.renderedRows.length)for(var e=0;e<fe.renderedRows.length;++e){var t=fe.renderedRows[e];t&&t.element&&(t.element.setAttribute("aria-posinset",e+1),t.element.setAttribute("aria-setsize",fe.renderedRows.length)),t&&t.selected&&(be.setAttribute("aria-posinset",e+1),be.setAttribute("aria-setsize",fe.renderedRows.length))}}(),Ce();performance.now();$dyn.applyFunction(ue);performance.now();$dyn.value(fe.InfiniteScroll)&&Ie(),d&&$dyn.ui.updating(!1),$dyn.layout.queueArrange(ve.parentNode),b||$dyn.ui.layout(!1),$dyn.value(Se)||be.parentNode!==ve||fe.setTimeout(function(){fe.scrollItemIntoView(be,ce)})}Se(!1),ge&&ge.stop();var oe="<unknown>",ne=$dyn.context(ve);ne&&ne.Name&&(oe=ne.Name);var ie=performance.now();$dyn.log.list&&$dyn.log.list("List: Finished rendering. Client state: CacheStart: %i, RowCount: %i",fe.clientCacheStart,fe.RenderedRowsCount()),$dyn.log.list&&$dyn.log.list("List: for each render time: %s, %s (ms)",oe,ie-e)};$dyn.applyFunction(o),n&&$dyn.shell.isPreProcessing&&0<$dyn.value(E)||(le?$dyn.async(t,void 0,"Grid render foreach"):t()),s=!0,ve.dynListRendering=!1}};var me=fe.ConvertPageIndexToServerCacheIndex(re.selectedIndex());ae.selectedIndexChanged=function(){if($dyn.log.list&&$dyn.log.list("List: _PendingRowChangeCount "+$dyn.value(fe._PendingRowChangeCount)),0<$dyn.value(fe._PendingRowChangeCount))$dyn.log.list&&$dyn.log.list("List: SelectedIndexChanged: Not updating selected index");else{var e=$dyn.value(ae.list.collection),t=re.selectedIndex(),o=fe._supportsMarking(),n=fe.GetDataId&&"function"==typeof fe.GetDataId&&fe.GetDataVersion&&"function"==typeof fe.GetDataVersion,i=fe.ConvertServerCacheIndexToClientCacheIndex(me),r=fe.ConvertServerCacheIndexToPageIndex(me);if(r!==t){var a,s,l,u;if($dyn.log.list&&$dyn.log.list("List: selected index changed - old %s, new %s",r,t),0<=r&&r<e.length){var d=e[r];fe._inactiveItem(d),s=fe._inactiveItemElement.cloneNode(!0),n&&(l=fe.GetDataId(d),u=fe.GetDataVersion(d))}else fe.renderedRows[i]&&fe.renderedRows[i].selected&&(s=fe.renderedRows[i].element,l=fe.renderedRows[i].id,u=fe.renderedRows[i].version);if(s&&(s.setAttribute("aria-posinset",i+1),o&&fe._setRowMarking(s,!!fe.MarkedIndexes()[r]),document.activeElement&&(a=$(be).find(document.activeElement)),be.parentNode&&(be.parentNode.replaceChild(s,be),fe.renderedRows[i]={element:s,version:u,selected:!1,marked:!!fe.MarkedIndexes()[r],id:l})),0<=t&&t<e.length){var c,p=e[t];ae.selectedItem();i=fe.ConvertPageIndexToClientCacheIndex(t);be.setAttribute("aria-posinset",i+1),fe.renderedRows[i]&&(c=fe.renderedRows[i].element),c&&c.parentNode&&(c.parentNode.replaceChild(be,c),fe.renderedRows[i]={element:c,version:fe.GetDataVersion?fe.GetDataVersion(p):void 0,selected:!0,marked:!!fe.MarkedIndexes()[t],id:fe.GetDataId?fe.GetDataId(p):void 0},a&&fe.TransferInputFocus($(be),a)),be.setAttribute("data-dyn-row-active",!0),o&&fe._setRowMarking(be,!!fe.MarkedIndexes()[t]),!$dyn.value(Se)&&be.parentNode&&(y&&(y.selectionFocusTriggerMax=void 0,y.selectionFocusTriggerMin=void 0),fe.scrollItemIntoView(be,ce))}$dyn.callFunction(fe.PostSelectedIndexChanged,ae,[t])}fe.LastSelectedIndex=fe._InternalFocusedRowIndex=me=fe.ConvertPageIndexToServerCacheIndex(t)}},fe._fastEdit()&&(ae.selectedIndexChanged=fe._selectedIndexChanged.bind(fe)),fe._serverCacheCoordinateShiftHandler=function(e){me+=e};var r=!!$dyn.peek($dyn.shell.isShellInitializing)&&$dyn.shell.isShellInitializing;ae.list={collection:se,groupBy:re.groupBy,rerenderOptions:fe._rerenderOptions,dataChanged:fe._dataChangedVersion,dataLoadPending:E,selectedIndex:re.selectedIndex,markedIndexes:fe.MarkedIndexes,allResourcesLoaded:fe._allResourcesLoaded,shellInitializing:r,defaultActionEnabled:fe.NavigationEnabled,pendingSelectedRow:fe._getCurrentPendingRow(),columnHeaderMetadata:fe.ColumnHeaderMetadata},ae.applyChanges=function(e){var t=!1,o=!1,n=!1,i=!1;!$dyn.shell.isShellInitializing()&&fe._allResourcesLoaded()&&((e.collection||e.dataLoadPending||e.dataChanged||e.pendingSelectedRow)&&(n=!0),(e.allResourcesLoaded||e.columnHeaderMetadata||e.shellInitializing)&&(i=!0),(e.rerenderOptions||e.groupBy||e.shellInitializing||e.defaultActionEnabled||e.allResourcesLoaded)&&(n=pe=!0),e.selectedIndex&&(t=!0),e.markedIndexes&&(o=!0),i&&fe._renderHeader(),n&&!1!==ae.render()||(t&&ae.selectedIndexChanged(),o&&fe.markedIndexesChanged()))},fe.usingDisposable($dyn.bulkObserve(ae.list,ae.applyChanges,t,ae)),$dyn.observe(ae.resources(),function(e){if(e&&0<e.length){var o=!0;$.each(e,function(e,t){void 0===t||t.loaded||(o=!1)}),fe._allResourcesLoaded(o),o||$.when.apply($.when,e.map(function(e){if(!e.loaded)return e.promise()})).done(function(){fe._resetCachedInactiveItemElement(),fe._allResourcesLoaded(!0)})}else fe._allResourcesLoaded(!0)}),ae.render=function(){if($dyn.log.list&&$dyn.log.list("Render: _PendingRowChangeCount "+$dyn.value(fe._PendingRowChangeCount)),0<$dyn.value(E)||0<$dyn.value(fe._PendingRowChangeCount))return $dyn.log.list&&$dyn.log.list("Render: Not rendering"),!1;var e={};for(var t in ae.list)e[t]=$dyn.value(ae.list[t]);ve.dynForeachOptions=e,ae.applyForeach()}}},dispose:function(){1==s&&(e.children().each(function(e,t){$dyn.unbind(t)}),s=!1,fe._selectedRow&&!fe._selectedRow.parentElement&&$dyn.unbind(fe._selectedRow),fe._headersDataBound&&$dyn.unbind(fe._header),fe._updatingComputed.valueChanged&&fe._updatingComputed.valueChanged.clearAllDependencies()),P&&clearTimeout(P)}}},$dyn.controls.HierarchicalGridBaseColumnHeader=function(a,s,e){$dyn.ui.Control.apply(this,arguments);var l=this;e&&(l.Root=e.Root),l.ColumnHeaderPopup=$(s).children(".columnHeader-popup")[0],a.DataSource&&(l.FormDataSourceName=a.DataSource.FormDataSourceName,l.FieldName=a.DataSource.FieldName,l.IsFilterable=a.DataSource.IsFilterable,l.IsSortable=a.DataSource.IsSortable,l.IsFiltered=a.DataSource.IsFiltered,l.IsSorted=a.DataSource.IsSorted,l.Label=a.DataSource.Label,l.Alignment=a.DataSource.Alignment,l.ControlType=a.DataSource.ControlType,l.FilteringFields=a.DataSource.FilteringFields),l.FilterExpressions=$dyn.observable(null),l.getFieldFilterCallBack=function(e){var t=!0;if(e&&e.length===l.FilteringFields.length)for(var o=0;o<e.length;o++){if(!e[o]||!e[o].Capability){t=!1;break}var n=$dyn.value(l.FilteringFields[o].Label);n&&(e[o].Capability.FieldLabel=n)}else t=!1;return t?l.updateFieldFilterExpressions(e):(l.FlyOutPickerOpen(!1),$dyn.error({Message:$dyn.label("List_ColumnNotFilterable"),Label:"List_ColumnNotFilterable"},l)),t},l.updateFieldFilterExpressions=function(e){var t=e;if(e){var o=$dyn.value(e);o.forEach(function(e){e.IsEditable=$dyn.util.stringToBoolean(e.IsEditable)});var n=$dyn.observableObject(o);t=$dyn.value(n)}if(l.FilterExpressions(t),a){var i=$dyn.context(s);l.ColumnHeaderPopup.hidden&&($dyn.dataBind(l.ColumnHeaderPopup,i),l.ColumnHeaderPopup.hidden=!1);var r=$dyn.context(l.ColumnHeaderPopup);r&&r.UpdateColumnHeaderAriaLabel()}else l.FlyOutPickerOpen(!1)},l.StartColumnHeaderResize=function(e,t){if($dyn.log.list&&$dyn.log.list("List: Start column header resize"),l&&l.element){var o=$(l.element).parents("[data-dyn-role='HierarchicalGridBase']");if(0<o.length)if($(e.target).is(".columnHeaderWrapper")){var n,i=$dyn.context(o[0]);if(i)n=$dyn.util.isRTLMode()?t.originalSize.width+(t.originalSize.width-t.size.width):t.originalSize.width+(t.size.width-t.originalSize.width),i._processColumnHeaderResize(e,!1,n)}}},l.StopColumnHeaderResize=function(e){if($dyn.log.list&&$dyn.log.list("List: Stop column header resize"),l&&l.element){var t=$(l.element).parents("[data-dyn-role='HierarchicalGridBase']");if(0<t.length){var o=$dyn.context(t[0]);o&&o._processColumnHeaderResize(e,!0)}}},l.flyoutClickSubscriber=function(e){return 1!=$(e.clickTarget).closest(".flyout-menuItem").length&&$dyn.util.flyout.defaultFlyoutClickSubscriber(e)},l.CloseFilter=function(){l.ShowAddFilterDropDown(!1)},l.FlyOutPickerOpen=$dyn.observable(!1),l.ShowAddFilterDropDown=$dyn.computed(function(){return $dyn.value(l.FlyOutPickerOpen)&&$dyn.value(l.Enabled)&&($dyn.value(l.IsFilterable)||$dyn.value(l.IsSortable))},function(e){var t=e;l.FilterManager&&t&&($dyn.value(l.IsFilterable)||$dyn.value(l.IsSortable))?l.FilterManager.getFieldFilters(l.buildFilteringFieldsSimpleObjectList(),l.Name,$dyn.value(l.Label),l.getFieldFilterCallBack):t=!1,l.FlyOutPickerOpen(t),$dyn.value(l.FlyOutPickerOpen())?l.Root&&$(l.Root.element).on("formClose",l.CloseFilter):l.Root&&$(l.Root.element).off("formClose",l.CloseFilter)}),$dyn.observe(l.FlyOutPickerOpen,function(e){var t=$(s).closest(".columnHeader");if(null!==t)if(e)t.addClass("hasOpenPopup");else{var o=$dyn.context(l.ColumnHeaderPopup);o&&o.UpdateColumnHeaderAriaLabel(!0),t.removeClass("hasOpenPopup")}})},$dyn.controls.HierarchicalGridBaseColumnHeader.prototype=$dyn.extendPrototype($dyn.ui.Control.prototype,{FilterExpression:null,FormDataSourceName:"",FieldName:"",Enabled:!0,Name:"",RequestLookupForm:null,ShowAddFilterDropDown:!1,IsFilterable:!1,IsSortable:!1,IsFiltered:!1,IsSorted:-1,Label:"",Alignment:"Auto",AlternateFilteringFields:void 0,buildFilteringFieldsSimpleObjectList:function(){var t=[];return this.FilteringFields&&this.FilteringFields.forEach(function(e){t.push({FormDataSourceName:$dyn.value(e.FormDataSourceName),FieldName:$dyn.value(e.FieldName)})}),t},focusIn:function(e){var t=this,o=t.Root;o&&o.SetServerSelectedControl&&t.Name&&($dyn.setValue(o,"ActiveControl",t.Name),$dyn.async(function(){$dyn.callFunction(o.SetServerSelectedControl,o,[t.Name])},void 0,"Send SetServerSelectedControl to the server")),e.stopImmediatePropagation(),e.preventDefault(),$dyn.log.stopPropagation&&$dyn.log.stopPropagation("Prevent focusIn from bubbling up from grid column headers.")},get FilterManager(){return!this._filterManager&&this.Root&&(this._filterManager=this.Root.FilterManager),this._filterManager},dispose:function(){this.ColumnHeaderPopup&&!this.ColumnHeaderPopup.hidden&&$dyn.unbind(this.ColumnHeaderPopup),$dyn.ui.Control.prototype.dispose.apply(this)}}),$dyn.controls.HierarchicalGridBaseColumnHeaderPopup=function(e,t,o){$dyn.controls.ProtoForm.apply(this,arguments);var n=this;n.FieldCapability=$dyn.observable(null),n.IsSorted=$dyn.observable(-1),n.Root=o.Root,n.FilterExpressions=[],$dyn.observe(n.DataSource.FlyOutPickerOpen,function(e){!$dyn.value(e)&&n.ShouldReturnFocus&&n.Root&&n.Root.setControlFocus&&n.Name&&n.Root.setControlFocus(n.Name)}),e.DataSource&&(n.IsSorted(e.DataSource.IsSorted),n.FormDataSourceName=e.DataSource.FormDataSourceName,n.FieldName=e.DataSource.FieldName,n.FilterExpressions=e.DataSource.FilterExpressions),n.ButtonsEnabled=$dyn.computed(function(){var t=!1;n.FilterExpressions&&$dyn.value(n.FilterExpressions).forEach(function(e){t=$dyn.value(e.IsEditable)||t});return t});var i=$dyn.value(e.DataSource.ControlType);switch(n.AscendingLabel=$dyn.observable(""),n.DescendingLabel=$dyn.observable(""),i){case $dyn.ui.ControlTypes.Integer:case $dyn.ui.ControlTypes.Int64:case $dyn.ui.ControlTypes.Real:n.AscendingLabel($dyn.label("List_IncSortNumber")),n.DescendingLabel($dyn.label("List_DecSortNumber"));break;case $dyn.ui.ControlTypes.Date:case $dyn.ui.ControlTypes.DateTime:case $dyn.ui.ControlTypes.Time:n.AscendingLabel($dyn.label("List_IncSortTime")),n.DescendingLabel($dyn.label("List_DecSortTime"));break;default:n.AscendingLabel($dyn.label("List_IncSortString")),n.DescendingLabel($dyn.label("List_DecSortString"))}n.DescendingToggle=$dyn.computed(function(){var e=$dyn.value(n.IsSorted);return $dyn.value(e)===$dyn.ui.SortDirection.descending}),n.AscendingToggle=$dyn.computed(function(){var e=$dyn.value(n.IsSorted);return $dyn.value(e)===$dyn.ui.SortDirection.ascending}),n.applySort=function(e){var t,o=[];o.push(n.UnwrappedFilterExpressions()),t=e?(o.push("1"),$dyn.value(n.AscendingLabel)):(o.push("0"),$dyn.value(n.DescendingLabel)),o.push("1"),$dyn.value($dyn.ax.taskRecording.isRecording())&&(o.push(n.Name),o.push(t)),n.FilterManager.setFieldSorts(o,$dyn.telemetry.ActionEvents.gridColumnSort),n.ShouldReturnFocus=!0,n.DataSource.FlyOutPickerOpen(!1)},n.SortAscending=function(){n.applySort(!0)},n.SortDescending=function(){n.applySort(!1)},n.applyFilters=function(){n.FilterManager.applyFieldFilters(n.UnwrappedFilterExpressions(),n.Name,$dyn.telemetry.ActionEvents.gridColumnFilter),n.ShouldReturnFocus=!0,n.DataSource.FlyOutPickerOpen(!1)},n.resetFilters=function(){n.FilterManager.resetFieldFilters(n.UnwrappedFilterExpressions(),n.Name,$dyn.telemetry.ActionEvents.gridColumnFilter),n.ShouldReturnFocus=!0,n.DataSource.FlyOutPickerOpen(!1)}},$dyn.controls.HierarchicalGridBaseColumnHeaderPopup.prototype=$dyn.extendPrototype($dyn.controls.ProtoForm.prototype,{FormDataSourceName:"",FieldName:"",Enabled:!0,AllowEdit:!0,Operator:"",Values:[],FieldCapability:null,Name:"",RequestLookupForm:null,IsSorted:-1,applyFilters:null,resetFilters:null,Label:"",AscendingLabel:"List_IncSortString",DescendingLabel:"List_DecSortString",ShouldReturnFocus:!1,get FilterManager(){return!this._filterManager&&this.Root&&(this._filterManager=this.Root.FilterManager),this._filterManager},Shortcuts:{applyFilter:{Keys:{keyCode:$dyn.ui.KeyCodes.enter},Handler:function(e){return this.HandleEnter(e)}},escapeHandling:{Keys:{keyCode:$dyn.ui.KeyCodes.esc},Handler:function(e){return this.HandleEscape(e)}}},UpdateColumnHeaderAriaLabel:function(e){var t=$dyn.value(this.DataSource.FilterExpressions),o=$dyn.value($dyn.value(this.IsSorted)),n="";if(t.length&&!e){var i=$dyn.label("FilterManager_ColumnFilterOpened"),r="";switch(o){case $dyn.ui.SortDirection.ascending:r=$dyn.label("FilterManager_SortedAscendingAria");break;case $dyn.ui.SortDirection.descending:r=$dyn.label("FilterManager_SortedDescendingAria");break;default:r=$dyn.label("FilterManager_UnsortedAria")}var a=$dyn.format($dyn.label("FilterManager_FilterCountAria"),t.length);t.forEach(function(e){var t=$dyn.value(e.Capability);a+=$dyn.util.getFilterFieldDescriptionAria(e,t)}),n=i+" "+r+" "+a}var s=$(this.element);s.attr("aria-busy","true"),s.attr("aria-label",n),s.attr("aria-busy","false")},UnwrappedFilterExpressions:function(){var e=$dyn.value(this.DataSource.FilterExpressions),t=[];return e.forEach(function(e){t.push($dyn.util.unwrapFilterExpression(e))}),t},HandleEnter:function(e){if(this.element){var t=e.target;if(t&&t.tagName&&"input"==t.tagName.toLowerCase()&&$.contains(this.element,t))return this.applyFilters(),!0}return!1},HandleEscape:function(e){return!(this.ShouldReturnFocus=!0)},processKeyDown:function(e){$dyn.util.handleShortcuts(this,e)}});var o=$dyn.HtmlImports.prototype.onResourceLoaded.subscribe(function(e){if(e&&-1!==e.indexOf("HierarchicalGrid")){var t=$dyn.projectManagement.hierarchicalGrid.templateFactory.createGridTemplate;t&&($dyn.projectManagement.hierarchicalGrid.templateFactory.createGridTemplate=function(){var e=t.apply($dyn.projectManagement.hierarchicalGrid.templateFactory,arguments);return $(e).attr("data-dyn-role","HierarchicalGridBase"),e},$dyn.HtmlImports.prototype.onResourceLoaded.unsubscribe(o))}})}();__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){var e,a,t;function o(e,t,o,n){var i=a.call(this,e,t,o,n)||this;return i.$list=o||{},i._rowLabel=r.observable(),i.DataSource&&!i.DataSource.parent&&o&&o.element&&o.element.dynChildren&&(i.$index=o.element.dynChildren().indexOf(t),i.usingDisposable(r.observe(function(){var e=r.value(o.DataSource);if(e)return r.getFieldValue(i.$list.RowLabelColumn,e[i.$index])},function(e){i._rowLabel(e),r.callFunction(i.$list.scheduleHeaderLayout,i.$list)}))),i}e=r.controls||(r.controls={}),a=r.ui.Control,__extends(o,a),t=o,e.RowTemplate_Table=t}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(v){!function(e){var m,t=(m=v.ui.Control,__extends(o,m),o.prototype._rowMutator=function(e,t){"RowTemplate"===e.getAttribute("data-dyn-role")&&(e.setAttribute("data-dyn-role","RowTemplate_Table"),e.setAttribute("data-dyn-role-orig","RowTemplate")),e.setAttribute("aria-rowindex",(t+1).toString())},o.prototype._columnMutator=function(e,t){e.classList.add("listCell"),e.setAttribute("data-colindex",(t+1).toString())},o.prototype._getValues=function(){var e=$(".listBody",this.element).find(".listItem"),n=[];return e.each(function(e,t){var o=$(t),i=[];o.find(".listCell:not(.repeater-template)").each(function(e,t){var o="";if($(t).is(".checkBox-container"))o=!!$(t).attr("aria-checked");else{var n=$(t).find("input");0<n.length&&(o=n[0].value)}i.push(o)}),n.push(i)}),n},o.prototype._changeRow=function(e){if(0<=e&&e<this._rowCount){v.setValue(this,"RowIndex",e);var t=v.context(this.getElementAt(v.value(this.ColumnIndex),e)),o=t&&t.Name;return v.callFunction(this.SelectCell,this,[o]),!0}return!1},o.prototype._processColumnHeaderResize=function(e,t,o){var n=$(e.target).closest(".columnHeaderWrapper");if(n.length){var i=n.attr("data-colindex"),r=parseInt(i,10);if(0<r){n.outerWidth(o);var a=$(n).width();this._resizeControlColumn(r-1,a),v.log.stopPropagation&&v.log.stopPropagation("Table column header handling resize event"),e.stopPropagation&&e.stopPropagation()}}},o.prototype._resizeControlColumn=function(e,t){var o,n,i=this.getDataColumnContextsByIndex(e);try{for(var r=__values(i),a=r.next();!a.done;a=r.next()){var s=a.value;s&&s.LayoutWidth&&(s.LayoutWidth=t)}}catch(e){o={error:e}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}},o.prototype.calculateMarkMode=function(){},o.prototype.setChildControlFocus=function(){var e=this.getElementAt(v.value(this.ColumnIndex),v.value(this.RowIndex));if(e){var t=v.context(e);this._focusChanging=!0;var o=t?t.focusCallback:v.util.focusElement(e,t.Name);o&&o.call(t,[]),this._focusChanging=!1}},o.prototype.focusCallback=function(){this.setChildControlFocus()},o.prototype.SelectCell=function(){},o.prototype._getHeaderId=function(e){return e&&v.value(e.Name)},o.prototype._getHeaderVersion=function(e){return e&&e.Version},o.prototype.findFieldByName=function(e){return $.find(".listBody [data-dyn-controlname='"+e+"']")},o.prototype.dispose=function(){v.ui.Control.prototype.dispose.call(this),this._headerTabbingContainerDispose&&this._headerTabbingContainerDispose()},o.prototype.performHeaderLayout=function(){var e=$(this.element);v.value(this.ShowHeader)&&(e.find(".table_header").layoutFloatingTableHeader(e.find(".TabularView")),this.incrementRenderCountOnHeaderLayout=!1)},o.prototype.rowIndex=function(e){if(e)return parseInt(e.getAttribute("aria-rowindex"),10)-1},o.prototype.getColumnLabel=function(e,t){return void 0===t||v.value(t)?e:""},o.prototype.getDataColumnContextsByIndex=function(i){var r=[],e=v.children(this.element);return e.length&&jQuery.each(e,function(e,t){var o,n=v.children(t);n&&(o=n[i]),o&&r.push(v.context(o))}),r},o.prototype.GetScrollRegion=function(){return this.scrollRegion||(this.scrollRegion=$(this.element).find(".scrollRegion").first()),this.scrollRegion},o.prototype.getRowElement=function(e){return v.children(this.element)[e]},Object.defineProperty(o.prototype,"_rowCount",{get:function(){return v.children(this.element).length},enumerable:!1,configurable:!0}),o.prototype.SetScrollRegionHeight=function(e){this.GetScrollRegion().height(e),this.UpdateScrollRegionHeight()},o.prototype.UpdateScrollRegionHeight=function(){this.CachedScrollRegionHeight=this.GetScrollRegion().height()},o.prototype._getCellFromElement=function(e){var t=-1,o=-1,n=$(e).closest(".listItem")[0];if(n)if(n.classList.contains("listAsTable-HeaderRow"))o=v.value(this.RowIndex),t=0<(t=parseInt(e.getAttribute("data-colindex"),10))?t-1:-1;else{o=0<(o=parseInt(n.getAttribute("aria-rowindex"),10))?o-1:-1;var i=$(e).closest(".listCell")[0];i&&(t=0<(t=parseInt(i.getAttribute("data-colindex"),10))?t-1:-1)}return{columnIndex:t,rowIndex:o}},o.prototype.getElementAt=function(e,t){var o=v.children(this.element)[t];if(o)return v.children(o)[e]},o.prototype.UpdateRowSelection=function(e,t){if(e!==t){this._selectingElement&&(this._selectingElement.removeAttribute("data-dyn-row-selecting"),this._selectingElement=null);var o=this.FindRowAtIndex(e);o&&o.setAttribute("data-dyn-row-active","false"),(o=this.FindRowAtIndex(t))&&(v.log.list&&v.log.list("List: Selecting index "+t),this.InputMode===v.ui.InputType.mouse?(o.setAttribute("data-dyn-row-active","true"),this.SelectedRow(o.id)):(this._selectingElement=o).setAttribute("data-dyn-row-selecting","true"))}},o.prototype.IsNavigationAction=function(e){return v.value(this.NavigationEnabled)&&this.TargetSupportsNavigation(e)},o.prototype.TargetSupportsNavigation=function(e){var t=$(e.target).closest(".listCell");return t&&t.hasClass("supportsNavigation")},o.prototype.IsValidSecondaryNavigation=function(e){return 1===$(e.target).closest(".listItem").length},o.prototype.FindRowAtIndex=function(e){return $(this.element).find(".listItem[aria-rowindex="+(e+1)+"]")[0]},o.prototype._getHeaderPrefix=function(){return this._headerPrefix||(this._headerPrefix=v._getTemplate(this._headerPrefixTemplate).cloneNode(!0),this._headerPrefix.removeAttribute("id"),v.dataBind(this._headerPrefix,this.element.dynContext)),this._headerPrefix},o.prototype.SelectCellByName=function(e){v.callFunction(this.SelectCell,this,e)},o);function o(e,t,o,n){var u=m.call(this,e,t,o,n)||this;u._keyDown=function(e){v.util.handleShortcuts(u,e)},u.StartColumnHeaderResize=function(e,t){var o;o=v.util.isRTLMode()?t.originalSize.width+(t.originalSize.width-t.size.width):t.originalSize.width+(t.size.width-t.originalSize.width),u._processColumnHeaderResize(e,!0,o)},u.StopColumnHeaderResize=function(e){v.log.list&&v.log("column header resize header function called"),u._processColumnHeaderResize(e,!0)},u.OnScroll=function(){u.SyncHorizontalScrollOffset&&u.SyncHorizontalScrollOffset()},u.FocusIn=function(e){var t=e.target,o=v.context(t);if(!u._focusChanging){u._focusChanging=!0;var n=u._getCellFromElement(t),i=o&&o.Name,r=v.value(u.ColumnIndex),a=v.value(u.RowIndex);if(n.columnIndex!==r||n.rowIndex!==a)if("RowTemplate_Table"===o.TypeName){v.log.list&&v.log.list("Table: Select row: old row=%s, new row=%s",a,n.rowIndex);var s=a,l=n.rowIndex;u.UpdateRowSelection(s,l),v.setValue(u,"ColumnIndex",n.columnIndex)}else"Table"!==o.TypeName&&(v.log.list&&v.log.list("Table: Focus cell: old col=%s, old row=%s, new col=%s, new row=%s, %s",r,a,n.columnIndex,n.rowIndex,i),v.callFunction(u.SelectCell,u,[i]));v.setValue(u,"ColumnIndex",n.columnIndex),v.setValue(u,"RowIndex",n.rowIndex),v.setValue(u.Root,"ActiveControl",u.Name),u._focusChanging=!1}v.log.list&&v.log.list("Table: Stop propagation of focus event handled by table"),e.stopImmediatePropagation()},u.OnKeyboardSecondaryNavigation=function(e){if(v.value(u.Enabled)){if(u.IsNavigationAction(e)&&v.value(u.NavigationEnabled)){if(!$(e.target).closest(".rowTemplate")[0])return;e.preventDefault(),v.getFunction(u.NavigationAction)()}}else e.preventDefault()},u.OnMouseSecondaryNavigation=function(e){function t(){e.preventDefault(),e.stopImmediatePropagation(),v.log.stopPropagation&&v.log.stopPropagation("Mouse Secondary Navigation (Navigation Action)")}if(v.value(u.Enabled)){if(!$(e.target).closest(".rowTemplate")[0])return;if(!v.value(u.AllowEdit)&&v.value(u.Enabled)&&v.value(u.NavigationAction)&&v.value(u.ForcePrimaryNavigation)){var o=v.context(e.target);o&&v.value(o.AllowEdit)||t(),v.getFunction(u.NavigationAction)()}else u.IsNavigationAction(e)&&v.value(u.NavigationEnabled)?v.util.clickedText(e.target)&&(t(),v.getFunction(u.NavigationAction)()):u.IsValidSecondaryNavigation(e)||t()}else t()},u._headerPreRender=function(){var e=u._getHeaderPrefix(),t=e&&e.parentNode;t&&t.removeChild(e)},u._headerPostRender=function(){var e=u._getHeaderPrefix(),t=u._headerRowElement;t&&t.insertBefore(e,t.firstChild);var o=v.length(u.ColumnHeaderMetadata);u.element.setAttribute("aria-colcount",o.toString())},u.postRenderInternal=function(){u.element.setAttribute("aria-rowcount",u._rowCount.toString()),u.performHeaderLayout(),v.applyFunction(u.PostRender,u)},u.headerFocusOut=function(e){var t=document.activeElement;e&&e.relatedTarget&&(t=e.relatedTarget),$(t).closest(".listAsTable-HeaderRow").length<=0&&(u.AllowHeaderFocus(!1),u._headerTabbingContainerDispose&&(u._headerTabbingContainerDispose(),u._headerTabbingContainerDispose=null))};var i=$(t);u.ForEachRenderCount=v.observable(0),u.LayoutMinWidth={minSizeFunction:v.layout.gridLayoutMinWidth,cssClassArgument:"listRoot"},u.LayoutMinHeight={minSizeFunction:v.layout.gridLayoutMinHeight,cssClassArgument:"listRoot"},u.ShowHeader=v.computed(function(){return v.value(u.Mode)===v.ui.ListMode.tabular&&v.value(u.IsHeaderVisible)}),u.AllowHeaderFocus=v.observable(!1),u.SkipColumnHeaders=v.computed(function(){return!v.value(u.AllowHeaderFocus)}),u.SelectedRow=v.observable(),u.RenderedHeaderMetadata=v.observable(),u._headerRowElement=u.element&&u.element.querySelector(".listAsTable-HeaderRow"),u._noRowsIndicator=u.element&&u.element.querySelector(".list-No-Rows-Indicator");var r=-1,a=-1,s=[];u.ColumnHeaderMetadata=v.computed(function(){var e=v.value(u.ColumnLabels);if(e)for(var t=0;t<e.length;t++){var o=e[t],n="Column"+t,i=s[t];i?i.Label(u.getColumnLabel(o,!0)):s[t]={Alignment:"Auto",ControlType:"",FieldName:"",FormDataSourceName:u.DataSourceName,IsFilterable:v.observable(!1),IsFiltered:v.observable(!1),IsLookupField:!1,IsNumber:!1,IsSortable:v.observable(!1),IsSorted:v.observable(-1),Label:v.observable(u.getColumnLabel(o,!0)),Name:n,Visible:!0}}var r=null!=e?e.length:0;return r<s.length&&s.splice(r,s.length-r),u.performHeaderLayout(),s}),u.ListBoxIdentifier="lb-".concat(u.Name).concat(u.Root?"_"+u.Root.Id:""),u.IsNoResultsMessageDisplayed=v.computed(function(){return 0===v.length(u.DataSource)||0===v.length(u.ColumnLabels)}),u.NoResultImage=v.shell.rootPath.concat("resources/images/emptyGrid.svg"),u.usingDisposable(v.observe(v.options(function(){return{rowIndex:u.RowIndex,columnIndex:u.ColumnIndex,children:v._getChildren(t)}},v.ui.updating),function(e){var t=e.children[r];t&&(t.setAttribute("data-dyn-row-active","false"),t.setAttribute("data-dyn-row-selecting","false"));var o=e.children[e.rowIndex];o&&(o.setAttribute("data-dyn-row-active","true"),u.SelectedRow(o.id)),u._focusChanging||r===e.rowIndex&&a===e.columnIndex||(v.log.list&&v.log.list("Table: Active cell changed: old col=%s, old row=%s, new col=%s, new row=%s",a,r,e.columnIndex,e.rowIndex),u.Root&&v.value(u.Root.ActiveControl)===u.Name&&(v.log.list&&v.log.list("Table: Active cell changed - focusing child"),u.setChildControlFocus())),r=e.rowIndex,a=e.columnIndex})),v.isObservable(u.GridLines)||(u.GridLines=v.observable(u.GridLines));var l,d,c,p=v.observable(0),h=!1;return u.scheduleHeaderLayout=function(){h||(h=!0,p(v.value(p)+1))},u.usingDisposable(v.observe(v.options({ColumnLabels:u.ColumnLabels,Children:u.Children,HeaderLayout:p},v.ui.updating),function(){u.performHeaderLayout(),h=!1})),u.SyncHorizontalScrollOffset=function(){l||(l=i.find(".scrollRegion").first(),d=i.find(".table_header").first());var e=-l.scrollLeft();if(v.util.isRTLMode()&&v.util.isWebKit()){var t=Math.abs(e);e=-(l[0].scrollWidth-l[0].clientWidth-t)}c!==e&&(v.util.isRTLMode()?d.css("margin-right",e.toString()+"px"):d.css("margin-left",e.toString()+"px"),v.log.list&&v.log.list("List: Sync offset from %s to %s",c,e)),c=e},u}(e.Table=t).prototype.isContainer=!0,t.prototype.RowLabelColumn="_RowLabel_",t.prototype._headerPrefixTemplate="TableRowLabelsHeader",t.prototype.RowIndex=-1,t.prototype.ColumnIndex=-1,t.prototype.ColumnLabels=null,t.prototype.IsHeaderVisible=!0,t.prototype.DataSource=null,t.prototype.NavigationEnabled=!1,t.prototype.ForcePrimaryNavigation=!1,t.prototype.NavigationAction=null,t.prototype.ShowHeader=!0,t.prototype.SelectedIndex=-1,t.prototype.ExportAllowed=!0,t.prototype.ExportLabel="",t.prototype.ExportToExcel=null,t.prototype.RowHeightInPixels=33,t.prototype.VisibleRowCount=0,t.prototype.VisibleColumnCount=0,t.prototype.Mode=v.ui.ListMode.tabular,t.prototype.ShowRowLabels=!1,t.prototype.GridLines=v.ui.GridLines.Auto,t.prototype.OriginatingType="";var n={AltShiftH:{Keys:{alt:!(t.prototype.InputMode=null),shift:!0,keyCode:v.ui.KeyCodes.letterH},Handler:function(e){if(v.value(this.ShowHeader)){if($(e.target).parents().is(".listHeader"))this.AllowHeaderFocus(!1),v.value(this.IsNoResultsMessageDisplayed)?this._noRowsIndicator&&this._noRowsIndicator.focus():this.setChildControlFocus();else{var t=v.value(this.ColumnIndex),o=void 0;0<=t&&(o=$.find("[data-colindex="+(t+1)+"]")),(!o||o.length<=0)&&(o=$.find(".columnHeaderWrapper:not(.markingColumnHeader,.rowLabelHeaderWrapper)")),o&&o.length&&(this.AllowHeaderFocus(!0),this._headerTabbingContainerDispose=v.util.tabbingContainer(this._headerRowElement,v.label("ListHeader_RegionTitle")),v.log.focus&&v.log.focus("Focusing header: "+t),o[0].focus())}return!0}return!1},ShowToUser:function(){return v.value(this.ShowHeader)},Description:function(){return v.value(this.AllowHeaderFocus)?v.label("Grid_FocusActiveRowShortcut"):v.label("Grid_FocusColumnHeaderShortCut")},Category:v.ui.ShortcutCategory.Navigate},DownArrow:{Keys:{keyCode:v.ui.KeyCodes.downArrow},Handler:function(){return!v.value(this.AllowHeaderFocus)&&this._changeRow(v.value(this.RowIndex)+1)},ShowToUser:function(){return!v.value(this.AllowHeaderFocus)},Description:v.label("Grid_NextRowShortcut")},LeftArrowResize:{Keys:{keyCode:v.ui.KeyCodes.leftArrow},Handler:function(e){if(this&&e.target&&this.AllowHeaderFocus&&e.target.classList.contains("columnHeaderWrapper")){var t=$(e.target).parents("[data-dyn-role='Table']");if(0<t.length){var o=v.context(t[0]);if(o){var n=void 0;return n=v.util.isRTLMode()?e.target.clientWidth+1:e.target.clientWidth-1,o._processColumnHeaderResize(e,!0,n),!0}}}return!1},ShowToUser:function(){return v.value(this.AllowHeaderFocus)},Description:function(){var e=v.label("Grid_ShrinkColumn");return v.util.isRTLMode()&&(e=v.label("Grid_GrowColumn")),e}},RightArrowResize:{Keys:{keyCode:v.ui.KeyCodes.rightArrow},Handler:function(e){if(this&&e.target&&this.AllowHeaderFocus&&e.target.classList.contains("columnHeaderWrapper")){var t=$(e.target).parents("[data-dyn-role='Table']");if(0<t.length){var o=v.context(t[0]);if(o){var n=void 0;return n=v.util.isRTLMode()?e.target.clientWidth-1:e.target.clientWidth+1,o._processColumnHeaderResize(e,!0,n),!0}}}return!1},ShowToUser:function(){return v.value(this.AllowHeaderFocus)},Description:function(){var e=v.label("Grid_GrowColumn");return v.util.isRTLMode()&&(e=v.label("Grid_ShrinkColumn")),e}},UpArrow:{Keys:{keyCode:v.ui.KeyCodes.upArrow},Handler:function(){return!v.value(this.AllowHeaderFocus)&&this._changeRow(v.value(this.RowIndex)-1)},ShowToUser:function(){return!v.value(this.AllowHeaderFocus)},Description:v.label("Grid_PreviousRowShortcut")}};t.prototype.Shortcuts=v.extendPrototype(v.ui.Control.prototype.Shortcuts,n)}(v.controls||(v.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(e,a,s,l){return new(s=s||Promise)(function(o,t){function n(e){try{r(l.next(e))}catch(e){t(e)}}function i(e){try{r(l.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?o(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(n,i)}r((l=l.apply(e,a||[])).next())})},__generator=this&&this.__generator||function(o,n){var i,r,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(a=2&t[0]?r.return:t[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,t[1])).done)return a;switch(r=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(o,s)}catch(e){t=[6,e],r=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=this&&this.__read||function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,i,r=o.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=r.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(o=r.return)&&o.call(r)}finally{if(i)throw i.error}}return a};!function(D){var e,t,S,o;e=D.ui||(D.ui={}),(t=e.ListMode||(e.ListMode={})).tabular="Tabular",t.list="List",(o=S=D.reactGrid||(D.reactGrid={})).featureName="CLIReactGridEnableFeature",o.RAILS_MODE_TIMEOUT_DELAY=500,o.appliedVirtualizedProperty=!1,o.featureValueChange=function(e,t){e&&(D.observe(D.user().RegionalSettings,D.shell.setControlLibraryCultureSettings),D.observe(D.user().Language,D.shell.setControlLibraryMessages),D.observe(D.user().UserSessionDate,function(e){e&&!moment.utc().isSame(moment.utc(e),"day")&&ControlLibrary.LocalizationManager.instance.setMessage("DateEdit_GoToToday",D.label("Input_DatePickerSessionDate"))}),D.log.controlLib&&ControlLibrary.Logger.instance.enableAll(!0),D.observe(D.user().Theme,function(e){if(0<=D.util.converters.numberString(e))return D.densityThemeManager.updateReactTheme(),!1}),D.user().removeFlightChangeListener(D.reactGrid.featureName,D.reactGrid.featureValueChange))},function(e){var t,o;t=e.List||(e.List={}),(o=t.MarkMode||(t.MarkMode={}))[o.select=0]="select",o[o.toggle=1]="toggle",o[o.rangeSelect=2]="rangeSelect",o[o.rangeExpansion=3]="rangeExpansion",o[o.none=4]="none",o[o.clearMark=5]="clearMark",Globalize.addCultureInfo("en",{messages:{ContextMenu_FreezeColumn:"Freeze column",ContextMenu_UnfreezeColumn:"Unfreeze column",Grid_CalculatingTotals:"Calculating totals",Grid_CollapseAllGroups:"Collapse all groups",Grid_ExpandAllGroups:"Expand all groups",Grid_HideFooter:"Hide footer",Grid_HideTotal:"Hide total",Grid_RowProcessed:"{0} rows processed",Grid_ShowFooter:"Show footer",Grid_TotalAverage:"Average",Grid_TotalColumn:"Total this column",Grid_TotalMaximum:"Maximum",Grid_TotalMinimum:"Minimum",Grid_TotalNone:"None",Grid_TotalSum:"Sum",Grid_UngroupAll:"Ungroup all",Grid_ViewColumnTotals:"View column totals",ReactGrid_AddEditField:"Add field to edit",ReactGrid_BulkEdit:"Edit selected rows...",ReactGrid_BulkEditFieldLabel:"Field",ReactGrid_BulkEditHeaderText:"Edit rows",ReactGrid_BulkEditMoveDown:"Move down",ReactGrid_BulkEditMoveUp:"Move up",ReactGrid_BulkEditRemoveField:"Remove field",ReactGrid_BulkEditValueLabel:"Value",ReactGrid_CalculatedValue:"Change calculated value for the current column",ReactGrid_CollapseCurrentGroup:"Collapse current group",ReactGrid_DeleteRow:"Delete row",ReactGrid_Discard:"Discard",ReactGrid_DiscardUnsaved:"Discard",ReactGrid_ExpandCurrentGroup:"Expand current group",ReactGrid_FollowLink:"\r\nClick to follow link'",ReactGrid_FooterHide:"Hide footer",ReactGrid_FooterShown:"Show footer",ReactGrid_FreezeColumn:"Freeze this column",ReactGrid_GoToActiveRow:"Go to active row",ReactGrid_GoToColumnHeader:"Go to the column header",ReactGrid_GoToFooter:"Move to the footer",ReactGrid_GoToProcessingRow:"Go to the row the system is processing",ReactGrid_GroupColumn:"Group by this column",ReactGrid_HideGroupHeaderLabel:"Hide column names in groups",ReactGrid_InvalidRowLink:"Fix it",ReactGrid_OpenGridOptions:"Open grid options",ReactGrid_PasteConfirmation:"Do you want to save your changes?",ReactGrid_PastedTooManyColumns:"There are more columns in your pasted content than there are in the table. Data in the extra columns have been ignored.",ReactGrid_PleaseWaitPrompt:"Your changes are still being worked on. Do you want to wait for all changes to save, or discard your unsaved changes?",ReactGrid_PleaseWaitRowChange:"Your last action is still being worked on. Do you want to wait or cancel any pending actions?",ReactGrid_ProvideInputLink:"Open dialog",ReactGrid_ReplaceGroupConfirmationDate:"Grouping by date subunits is only supported as the last grouping column. Select OK to replace the date subunit grouping and group on this column instead?",ReactGrid_ReplaceGroupConfirmationDateTime:"Grouping by date or time subunits is only supported as the last grouping column. Select OK to replace the date or time subunit grouping and group on this column instead?",ReactGrid_ReplaceGroupConfirmationTime:"Grouping by time subunits is only supported as the last grouping column. Select OK to replace the time subunit grouping and group on this column instead?",ReactGrid_ResumePrompt:"Changes to a previous row cannot be saved until you handle a pending dialog. Continue working until youre ready to see this dialog.",ReactGrid_Revert:"Revert",ReactGrid_RowLimited:"We're unable to load any more records because you've reached the limit set by your organization. Please filter your data more or contact your system admin to increase this limit.",ReactGrid_Save:"Save",ReactGrid_ShowGroupHeaderLabel:"Show column names in groups",ReactGrid_UnfreezeColumn:"Unfreeze this column",ReactGrid_UngroupColumn:"Ungroup this column",ReactGrid_UnsavedChanges:"Unsaved changes were discarded due to a data refresh. Please check your data.",ReactGrid_ValidationPrompt:"Changes to a previous row cannot be saved until you fix a validation issue. Continue working until youre ready to fix this.",ReactGrid_Wait:"Wait"}});function T(e){var t=$(this.listControl.element).find(".dyn-activeRowCell [data-dyn-controlname='"+this._name+"']");return D.util.objectAssign(e,{adjustMethod:"flip",at:D.layout.qTipPosition.rightCenter,my:D.layout.qTipPosition.leftCenter,target:t&&0<t.length?t:""}),e}var m,_={IsFilterable:!0,IsFiltered:!0,IsSorted:!0,SortDirection:!0},u={Date:!0,DateTime:!0,Input:!0,Int64:!0,Integer:!0,Real:!0,ReferenceGroup:!0,Time:!0,CheckBox:!1,ComboBox:!1,Image:!1},d={AllowEdit:!0,ExtendedStyle:!0,ForcePrimaryNavigation:!0,GridLines:!0,Height:!0,HeightOverride:!0,HideSelection:!0,InfiniteScroll:!0,IsHeaderVisible:!0,IsMarkingEnabled:!0,IsSelectionIndicatorVisible:!0,Mode:!0,NavigationEnabled:!0,VisibleColumnCount:!0,VisibleRowCount:!0,Width:!0,WidthOverride:!0},c="AddNewColumnId",n="FooterButtonId",p="BulkEditId",i="GroupHeaderLabelButton",r="ExpandAllGroupsId",a="CollapseAllGroupsId",s="UngroupAllId",l=(m=D.ui.Control,__extends(A,m),A.freezingEnabled=function(){return D.util.isFlightEnabled("CLIGridFreezingFeature")},A.extendedAggregationEnabled=function(){return D.util.isFlightEnabled("CLIGridExtendedAggregationFeature")},A.bulkEditEnabled=function(){return D.util.isFlightEnabled("CLIGridBulkEditFeature")},A.lostKeyPreventionEnabled=function(){return D.util.isFlightEnabled("CLIGridLostKeyPreventionFeature")},A.valueCalculator=function(e,t){var o,n,i=e.FieldName,r=D.value(e.TotalType);"Max"!==r&&"Min"!==r||(i+="_".concat(r));var a=D.value(t.markedCount)<=1?null===(o=t.totals)||void 0===o?void 0:o[i]:null===(n=t.markedTotals)||void 0===n?void 0:n[i];if(a){var s=D.util.createBigNumOptions(e);a.configure(s);var l=void 0;if("Auto"!==D.value(e.DisplaceNegative)){var u=parseInt(D.value(e.DisplaceNegative),10);!1===a.IsShownAsNegative()&&0<u&&(l=u)}if("Avg"===r&&0<D.length(t.items)){var d=a.clone();return d.IgnoreDecimals()&&d.configure({ignoreDecimal:!1,numberOfDecimals:1}),d.SetValue(d.GetNumber()/D.length(t.items)),{text:d.GetValue(),displaceText:l}}return{text:a.GetValue(),displaceText:l}}return{text:null}},A.emptyValueCalculator=function(){return{text:null}},A.prototype.getUniqueId=function(){return this.Root?"".concat(this.Name,"_").concat(this.Root.Id):this.Name},A.prototype.gridOrAnyChildEditable=function(){return D.value(this.AllowEdit)||this.calculatedAllowEdit},A.prototype.ForceBlockingDiv=function(e){if(("CreateNewRecord"===e||"CreateNewRecordOnKeyDown"===e)&&!D.value(this.AllowPreemptiveClient))return!0},A.prototype.hasGrouping=function(){return this.groupingManager.hasGrouping()},A.prototype.getGroupingFilterExpressions=function(){return __awaiter(this,void 0,void 0,function(){var t,o,n,i,r,a,s,l;return __generator(this,function(e){switch(e.label){case 0:if(t=[],!this.groupingManager.hasGrouping())return[3,8];e.label=1;case 1:e.trys.push([1,6,7,8]),o=__values(this.groupingManager.columnGrouping),n=o.next(),e.label=2;case 2:return n.done?[3,5]:(i=n.value,[4,this.getFilterExpressions(i.ControlName,!1)]);case 3:r=e.sent(),t=t.concat(r),e.label=4;case 4:return n=o.next(),[3,2];case 5:return[3,8];case 6:return a=e.sent(),s={error:a},[3,8];case 7:try{n&&!n.done&&(l=o.return)&&l.call(o)}finally{if(s)throw s.error}return[7];case 8:return[2,t]}})})},A.prototype.getGroupingSortDirections=function(){var t,e,o=[];if(this.groupingManager.hasGrouping())try{for(var n=__values(this.groupingManager.columnGrouping),i=n.next();!i.done;i=n.next()){var r=i.value,a=this.getColumnInfo(r.ControlName);D.value(a.SortDirection)===D.ui.SortDirection.ascending?o.push("1"):o.push("0")}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return o},A.prototype.updateConfirmations=function(e,t){e===D.ui.ScrollDirection.down?this.ConfirmedNoDataBelow(t):e===D.ui.ScrollDirection.up&&this.ConfirmedNoDataAbove(t)},A.prototype.MayHaveMoreData=function(e){return!(!D.value(this.DataAbove)&&!D.value(this.DataBelow)&&D.length(this.DataSource)===D.value(this.CacheSize))&&!D.value(this.IsSizeLimited)&&(e===D.ui.ScrollDirection.down?D.value(this.HasNextPage):e===D.ui.ScrollDirection.up?D.value(this.HasPreviousPage):void 0)},A.prototype.AreControlsCrossBoundary=function(e,t){return D.peek(e.ServiceBoundary)!==D.peek(t.ServiceBoundary)},A.prototype.tryFocus=function(e){return(e?e.getAttribute("data-dyn-controlname"):"")!==this.activeColumnName||!this.ControlLibGridRef||!this.ControlLibGridRef.hasFocus()},A.prototype.getLiveControl=function(e){for(var t,o,n,i=this,r=this,a=e,s=!1,l=!1,u=!1,d=null,c=D.value(this.Mode)===D.ui.ListMode.list;a&&a.classList;){if(a.classList.contains("dyn-activeRowCell")||a.classList.contains("dyn-inactiveRowCell")){d=a;break}if(a.classList.contains("dyn-headerCell")){d=a,s=!0;break}if(a.classList.contains("dyn-grid")||a.classList.contains("dyn-listGrid")){l=!0;break}if(c&&a.hasAttribute("data-dyn-controlname")&&!a.classList.contains("dyn-listGrid")){d=a,u=!0;break}a=a.parentElement}if(!l&&d){var p="";(s||u||(d=$(d).find(".public_fixedDataTableCell_cellContent >")[0]))&&(p=d.getAttribute("data-dyn-controlname"));var h=this.getColumnInfo(p);if(h){if("ReferenceGroup"===(h._typeName||h.TypeName)){var m=$(e).closest("[data-dyn-controlname]").attr("data-dyn-controlname"),v=h._element||h.element;if(v&&v.dynChildren){var g=v.dynChildren();try{for(var y=__values(g),f=y.next();!f.done;f=y.next()){var b=f.value,C=D.controlOptions(b);C._name===m&&(C.ReferenceGroup||(C.ReferenceGroup=h),C.getTaskGuideParams=function(e){var t=e.action;if(t&&-1!==t.indexOf("RequestPopup")){e=T.call(this.ReferenceGroup,e);var o=$(".lookup-popup.active-form");o&&1===o.length&&(e.target=o),D.ui.isPopupHost(this.ReferenceGroup)&&!this.ReferenceGroup.popupObserver&&(this.ReferenceGroup.popupObserver=D.observe(this.ReferenceGroup.Popup,function(){D.ax&&D.ax.taskGuide&&D.ax.taskGuide.repositionGuidedQtip&&!D.value(D.ax.taskGuide.repositionGuidedQtip)&&D.async(function(){D.ax.taskGuide.repositionGuidedQtip(!0)},0,"reset task guide qtip")}))}else e=T.call(this,e);return e}.bind(C),C.addMessage=h.addMessage,h=C)}}catch(e){t={error:e}}finally{try{f&&!f.done&&(o=y.return)&&o.call(y)}finally{if(t)throw t.error}}}}null!==(n=h.shortcutToolTip)&&void 0!==n&&n.destroyed&&(h.shortcutToolTip=null),void 0===h.Name&&h._name&&(h.Name=h._name),h.listControl=this,h.Root=this.Root,h.isInGrid=function(){return!0},h.isInTable=function(){return!1},h.convertMasterTrackingId=!0,h.allowUserChanges=function(){return D.value(this.AllowEdit)&&D.value(this.Enabled)&&D.value(this.Visible)}.bind(h),h.focusCallback=function(){var e=this;if(this.listControl){var t=this.Name;this.ReferenceGroup&&(t=this.ReferenceGroup.Name),this.listControl.scrollColumnIntoViewIfNeeded(t,function(){e.listControl&&e.listControl.ControlLibGridRef&&(D.log.focus&&D.log.focus("React Grid (%s): column (%s) focus callback",e.listControl.Name,t),e.listControl.ControlLibGridRef.focusColumn(t))})}D.focusCompleted(!0)}.bind(h);var w={};if(D.util.objectAssign(w,h,{element:d,serverIndex:this.previewTrackingId,Value:this.previewValue}),void 0===w.Name&&h.Name&&(w.Name=h.Name),s&&(w.Shortcuts=D.controls.ColumnHeader.prototype.Shortcuts),void 0!==this.previewControlIsValid&&(w.controlIsValid=function(){return i.previewControlIsValid}),0<D.length(this.DataSource))if(s){var _=this.getActiveRowCollectionIndex();-1!==_&&(w.DataSource=D.value(this.DataSource)[_])}else{var S=this.getRowIndexFromElement(e),I=this.groupingManager.rowIndexToCollectionIndex(S);-1!==I&&(w.DataSource=D.value(this.DataSource)[I])}r=w}}return r},A.prototype.getColumnInfo=function(e){var t,o=this.columnNameToInfoIndex[e];if(void 0!==o){var n=this.columnInfo[o];if(n&&e!==n.Name&&null!==(t=n.ChildCols)&&void 0!==t&&t.length){var i=n.ChildNameToColIndex[e];return n.ChildCols[i]}return this.columnInfo[o]}},A.prototype.refGroupChildIndexUpdate=function(e,t){this.columnNameToInfoIndex[e]=this.columnNameToInfoIndex[t]},A.prototype.scrollActiveRowIntoView=function(){var e,t;null!==(t=null===(e=this.ControlLibGridRef)||void 0===e?void 0:e.scrollActiveRowIntoView)&&void 0!==t&&t.call(e)},A.prototype.focusHeader=function(){var e,t;null!==(t=null===(e=this.ControlLibGridRef)||void 0===e?void 0:e.focusHeader)&&void 0!==t&&t.call(e)},A.prototype.scrollRowIntoView=function(e){var t,o;null!==(o=null===(t=this.ControlLibGridRef)||void 0===t?void 0:t.scrollRowIntoView)&&void 0!==o&&o.call(t,e)},A.prototype.scrollColumnIntoViewIfNeeded=function(e,t){this.ControlLibGridRef&&this.ControlLibGridRef.scrollColumnIntoViewIfNeeded?this.ControlLibGridRef.scrollColumnIntoViewIfNeeded(e,t):void 0!==t&&t()},A.prototype.setChildControlFocus=function(){return!!this.ControlLibGridRef&&(this.ControlLibGridRef.focusActiveCell(),!0)},A.prototype.goToActiveRow=function(){var e=this.getRowIndexFromTrackingId(D.value(this.SelectedRowTrackingId));e===this.getActiveRowIndex()?(this.scrollActiveRowIntoView(),this.setChildControlFocus()):0<=e&&(this.scrollRowIntoView(e),this.changeRow(e,this.activeColumnName,0,D.ui.InputType.notSpecified))},A.prototype.recalculateRowIndex=function(e){return e},A.prototype.getCollectionIndexFromActiveRowTrackingId=function(){return D.isServerBoundDataSource(this.DataSource)?this.getCollectionIndexFromTrackingId(D.value(this.ActiveRowTrackingId)):-1},A.prototype.getActiveRowIndex=function(){return this.getRowIndexFromTrackingId(D.value(this.InternalSelectedRowTrackingId))},A.prototype.getActiveRowAriaNumber=function(){return D.value(this.IsHeaderVisible)?this.getActiveRowIndex()+2:this.getActiveRowIndex()+1},A.prototype.getActiveRowCollectionIndex=function(){return this.groupingManager.rowIndexToCollectionIndex(this.getActiveRowIndex())},A.prototype.getCollectionIndexFromPageIndex=function(e){var t=e;if(!D.value(this.InfiniteScroll)){var o=D.value(this.PageIndex),n=D.value(this.PageSize);0<o&&0<n&&(t+=o*n)}return t},A.prototype.getPageIndexFromCollectionIndex=function(e){var t=e;if(!D.value(this.InfiniteScroll)){var o=D.value(this.PageIndex),n=D.value(this.PageSize);0<o&&0<n&&(t-=o*n)}return t},A.prototype.getRowIndexFromTrackingId=function(e){return e&&this.groupingManager?this.groupingManager.getRowIndexFromTrackingId(e):-1},A.prototype.getCollectionIndexFromTrackingId=function(e){var t;if(null!==(t=D.serverForm)&&void 0!==t&&t.ModelManager&&D.isServerBoundDataSource(this.DataSource)){var o=this.DataSource.__boundDataSource.name+"_"+e,n=this.Root&&this.Root.Id,i=D.serverForm.ModelManager.getModel(o,n);return i?i.collectionIndex:-1}return e?parseInt(e,10):-1},A.prototype.getRecIdFromTrackingId=function(e){var t;if(null!==(t=D.serverForm)&&void 0!==t&&t.ModelManager&&D.isServerBoundDataSource(this.DataSource)){var o=this.DataSource.__boundDataSource.name+"_"+e,n=this.Root&&this.Root.Id,i=D.serverForm.ModelManager.getModel(o,n);return i?i.getValue("recId_internal"):""}return""},A.prototype.getTrackingIdFromRowIndex=function(e){return this.groupingManager.getTrackingIdFromRowIndex(e)},A.prototype.getTrackingIdFromRecId=function(e){return D.isServerBoundDataSource(this.DataSource)?this.DataSource.__boundDataSource.getTrackingIdByRecId(e):""},A.prototype.getTrackingIdFromCollectionIndex=function(e){var t,o,n;return e<0||e>=D.length(this.DataSource)?"":D.isServerBoundDataSource(this.DataSource)?null!==(o=null===(t=D.value(this.DataSource)[e])||void 0===t?void 0:t.masterTrackingId)&&void 0!==o?o:"":null!==(n=null==e?void 0:e.toString())&&void 0!==n?n:""},A.prototype.getActiveRowClientIndex=function(){return this.getActiveRowIndex()},A.prototype._getValues=function(){var e=$(".fixedDataTableLayout_rowsContainer",this.element).find(".public_fixedDataTable_bodyRow"),n=[];return e.each(function(e,t){var o=$(t),i=[];o.find("[data-dyn-controlname]").each(function(e,t){var o="";if($(t).is(".dyn-checkbox"))o="true"===(o=$(t).find("[role='checkbox']").attr("aria-checked"))?"True":"False";else{var n=$(t).find("input");0<n.length&&(o=n[0].value)}i.push(o)}),n.push(i)}),n},A.prototype.renderReactListAsync=function(){var e=this;if(this.renderTimeout())this.renderTimeout().cancel();else if(this.requestingData)return;this.needToCalculateChildrenBeforeRender?this.calculateChildrenAndRenderAsync():(this.Root&&this.Root.controlRenderPending&&this.Root.controlRenderPending(this.Name),this.renderTimeout(D.async(function(){e.treatGridAsVisible()?e.renderReactList():(D.log.reactList&&D.log.reactList("ReactList: Prevent invisible render"),e.Root&&e.Root.controlRenderComplete&&e.Root.controlRenderComplete(e.Name)),e.renderTimeout(null)},0,"Render ReactList")))},A.prototype.renderReactListSync=function(){this.renderTimeout()&&(this.renderTimeout().cancel(),this.renderTimeout(null)),this.Root&&this.Root.controlRenderPending&&this.Root.controlRenderPending(this.Name),this.renderReactList()},A.prototype.getCommonGridContextMenuOptions=function(){var e=[];if(this.ExportToExcel&&D.value(this.ExportAllowed)){var t={Command:this.ExecuteExportToExcel.bind(this,!1),Label:D.label("ContextMenu_ExportAllRows")};e.push(t),0<this.getMarkedRowCount()&&(t={Command:this.ExecuteExportToExcel.bind(this,!0),Label:D.label("ContextMenu_ExportMarkedRows")},e.push(t))}if(D.value(this.AllowPersonalization)&&this.Root&&D.value(this.Root.AllowExplicitPersonalization)&&!this.Root.isPopup()){var o={Label:D.label("ContextMenu_AddColumns"),Command:this.addColumns,Enabled:!0};e.push(o)}return e},A.prototype.getContextMenuOptions=function(){var e=this.getCommonGridContextMenuOptions();return Array.prototype.push.apply(e,m.prototype.getContextMenuOptions.call(this)),e},A.prototype.requestTotalsFromControlLibrary=function(t){var o=this;this.MayHaveMoreDataAboveOrBelow()&&this.ControlLibGridRef.requestTotals?this.ControlLibGridRef.requestTotals(function(e){t&&t(e),o.renderReactListAsync()}):t&&t(!1)},A.prototype.addGroupingSort=function(l,u,d){return __awaiter(this,void 0,void 0,function(){var t,o,n,i,r,a,s;return __generator(this,function(e){switch(e.label){case 0:return t="1",u===D.ui.SortDirection.descending&&(t="0"),[4,this.getFilterExpressions(l.Name,!1)];case 1:return o=e.sent(),i=!(n=[]),this.hasGrouping()?(i=!0,[4,this.getGroupingFilterExpressions()]):[3,3];case 2:return r=e.sent(),a=r.concat(o),n.push(D.util.unwrapFilterExpressions(a)),(s=this.getGroupingSortDirections()).push(t),n.push(s),[3,4];case 3:n.push(D.util.unwrapFilterExpressions(o)),n.push(t),e.label=4;case 4:return n.push("1"),i?this.FilterManager.setMultipleFieldSorts(n,null,d):this.FilterManager.setFieldSorts(n,null,d),[2]}})})},A.prototype.removeSort=function(u,d){return __awaiter(this,void 0,void 0,function(){var t,o,n,i,r,a,s,l;return __generator(this,function(e){switch(e.label){case 0:if(!u)return[2];t=[],e.label=1;case 1:e.trys.push([1,6,7,8]),o=__values(u),n=o.next(),e.label=2;case 2:return n.done?[3,5]:(i=n.value,[4,this.getFilterExpressions(i.ControlName,!1)]);case 3:r=e.sent(),t=t.concat(D.util.unwrapFilterExpressions(r)),e.label=4;case 4:return n=o.next(),[3,2];case 5:return[3,8];case 6:return a=e.sent(),s={error:a},[3,8];case 7:try{n&&!n.done&&(l=o.return)&&l.call(o)}finally{if(s)throw s.error}return[7];case 8:return this.FilterManager.removeFieldSorts([t],d),[2]}})})},A.prototype.deleteClientRow=function(a){if(D.serverForm&&D.isServerBoundDataSource(this.DataSource)){var s=this.Root&&this.Root.Id;this.modelCollectionIds.forEach(function(e){var t=D.serverForm.ModelManager.getModelCollection(e,s);if(t){var o="".concat(t.name,"_").concat(a),n=D.serverForm.ModelManager.getModel(o);if(n){n.isSelected=!1,n.isMarked=!1;var i=n.collectionIndex;D.isObservableArray(t.items)&&t.items.splice(i,1),t.numberOfClientRows--;for(var r=i;r<D.length(t.items);r++)D.value(t.items)[r].collectionIndex=r;D.serverForm.ModelManager.deleteModel(o,s)}}})}else{var e=this.getCollectionIndexFromTrackingId(a);D.value(this.DataSource).splice(e,1)}},A.prototype.getClientMarking=function(){return D.isServerBoundDataSource(this.DataSource)&&D.value(this.DataSource.__boundDataSource.clientMarking)},A.prototype.setClientMarking=function(o){if(D.serverForm&&D.isServerBoundDataSource(this.DataSource)){var n=this.Root&&this.Root.Id;this.modelCollectionIds.forEach(function(e){var t=D.serverForm.ModelManager.getModelCollection(e,n);t&&t.clientMarking(o)})}},A.prototype.getColumnMessages=function(e){var t,o,n=[];try{for(var i=__values(this.columnInfo),r=i.next();!r.done;r=i.next()){var a=r.value,s=this.getRowData(e,"_VIRTUALIZED_".concat(a.Name,"_Validity"));s&&0<D.length(s.messages)&&(n=n.concat(s.messages))}}catch(e){t={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}return n},A.prototype.dispose=function(){var t,e,o,n,i,r;this.postRenderTimeout&&(window.clearTimeout(this.postRenderTimeout),this.postRenderTimeout=void 0),this.postRenderCallbacks=null,this.railsModeTimeout&&(window.clearTimeout(this.railsModeTimeout),this.railsModeTimeout=void 0),this.renderTimeout()&&(this.renderTimeout().cancel(),this.renderTimeout(null)),this.calculateChildrenTimeout()&&(this.calculateChildrenTimeout().cancel(),this.calculateChildrenTimeout(null)),this.element&&(ReactDOM&&ReactDOM.unmountComponentAtNode(this.RenderTarget),this.element.removeEventListener("mousewheel",this.handleMouseWheel)),this.reflowEndWatcher&&(this.reflowEndWatcher.dispose(),this.reflowEndWatcher=null),this.clearSubscription&&D.isServerBoundDataSource(this.DataSource)&&(this.DataSource.__boundDataSource.onClear.unsubscribe(this.clearSubscription),this.clearSubscription=void 0),this.cacheClearAsync&&(this.cacheClearAsync.cancel(),this.cacheClearAsync=null),this.HasPreviousPage&&this.HasPreviousPage.valueChanged&&this.HasPreviousPage.valueChanged.clearAllDependencies(),this.HasNextPage&&this.HasNextPage.valueChanged&&this.HasNextPage.valueChanged.clearAllDependencies(),this.IsSizeLimited&&this.IsSizeLimited.valueChanged&&this.IsSizeLimited.valueChanged.clearAllDependencies(),this.DisplayRowCount&&this.DisplayRowCount.valueChanged&&this.DisplayRowCount.valueChanged.clearAllDependencies();try{for(var a=__values(this.columnObservers),s=a.next();!s.done;s=a.next())s.value.dispose()}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}for(var l in this.columnObservers=null,this.activeColumnHeaderPopup&&(this.activeColumnHeaderPopup=null),this.ColumnPopups)this.ColumnPopups.hasOwnProperty(l)&&(D.unbind(this.ColumnPopups[l].$popupElement[0]),this.ColumnPopups[l].$popupElement.remove(),this.ColumnPopups[l].flyoutOptions&&(null!==(o=this.ColumnPopups[l].flyoutOptions.activeFlyoutSubscriber)&&void 0!==o&&o.dispose(),null!==(n=this.ColumnPopups[l].flyoutOptions.showSubscriber)&&void 0!==n&&n.dispose(),this.ColumnPopups[l].flyoutOptions=null));for(var u in this.ColumnPopups=null,this.dataSourceObservers)this.dataSourceObservers.hasOwnProperty(u)&&this.dataSourceObservers[u].dispose();var d=(this.dataSourceObservers=null)===(i=this.Root)||void 0===i?void 0:i.Id;if(D.serverForm&&d){for(var c in this.relatedItemSubscribers)if(this.relatedItemSubscribers.hasOwnProperty(c)){var p=D.serverForm.ModelManager.getModelCollection(c,d);p&&p.itemsChanged().unsubscribe(this.relatedItemSubscribers[c])}if(this.relatedItemSubscribers=null,-1!==this.formModelSubscriber){var h=D.serverForm.getModel(d);h&&null!==(r=h._propertyChangedHost)&&void 0!==r&&r.unsubscribe(this.formModelSubscriber),this.formModelSubscriber=-1}}this.dataCache&&this.dataCache.dispose(),this.dataCache=null,this.syncManager&&this.syncManager.dispose(),this.syncManager=null,this.groupingManager&&this.groupingManager.dispose(),this.groupingManager=null,this.filterManager=null,$(document).off("themechanged",this.themeChangedHandler),this.childrenChangedComputed&&this.childrenChangedComputed.valueChanged.clearAllDependencies(),this.columnInfo=[],this.FilterExpressions=null,this.FilteringFields=null,this.renderTarget&&(this.renderTarget=null),this.ControlLibGridRef&&(this.ControlLibGridRef=void 0),this.keyUpProcessingDebounce&&(this.keyUpProcessingDebounce.cancel(),this.keyUpProcessingDebounce=void 0),this.groupingColumnWidthUpdate&&(this.groupingColumnWidthUpdate.cancel(),this.groupingColumnWidthUpdate=void 0),this.columnWidthUpdate&&(this.columnWidthUpdate.cancel(),this.columnWidthUpdate=void 0),this.bulkEditLightBox&&(this.bulkEditLightBox=null),this.disposeGridOptions(),m.prototype.dispose.call(this)},A.prototype.MayHaveMoreDataAboveOrBelow=function(){return this.MayHaveMoreData(D.ui.ScrollDirection.down)||this.MayHaveMoreData(D.ui.ScrollDirection.up)},A.prototype.getCollapseAllStatus=function(){return this.collapseNewGroups},A.prototype.getCollectionData=function(e,t,o){var n,i=D.value(this.DataSource)[e];if(i){if(null===(n=D.serverForm)||void 0===n||!n.isModel(i))return i[t];var r="_INTERNAL_".concat(t);if(o&&i.collectionName!==o){var a=i.getRelated&&i.getRelated(o,e);if(a&&a.doesPropertyExist){if(a.doesPropertyExist(r))return a.getValue(r);if(a.doesPropertyExist(t))return a.getValue(t)}}else if(i.doesPropertyExist){if(i.doesPropertyExist(r))return i.getValue(r);if(i.doesPropertyExist(t))return i.getValue(t)}}},A.prototype.getFilteringFieldsForColumn=function(e){var t,o,n=[];if("ReferenceGroup"===e.TypeName){var i=e._element||e.element;if(i&&i.dynChildren){var r=i.dynChildren();if(r)try{for(var a=__values(r),s=a.next();!s.done;s=a.next()){var l=s.value,u=D.controlOptions(l);u&&n.push({FieldName:u.FieldName,FormDataSourceName:u.DataSourceName,Label:D.value(u.Label)})}}catch(e){t={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(t)throw t.error}}}}else n="SegmentedEntry"===e.TypeName?[{FieldName:D.value(e.ReferenceValueDataSourceFieldName),FormDataSourceName:D.value(e.ReferenceValueDataSourceName),Label:D.value(e.Label)}]:[{FieldName:e.FieldName,FormDataSourceName:e.DataSourceName,Label:D.value(e.Label)}];return n},A.prototype.getColumnsWithTotals=function(){return this.columnInfo.filter(function(e){return D.value(e.AllowTotal)&&D.value(e.TotalShown)})},A.prototype.getColumnsOptions=function(){var o=this;if(this.element&&this.element.dynChildren&&0<D.length(this.element.dynChildren)){var e=this.element.dynChildren()[0];if(e){var t=e.dynChildren();if(t){var n=[],i=function(e){var t=D.controlOptions(e);"Group"===t.TypeName?(t.isInGrid=function(){return!0},t.isInTable=function(){return!1},t.listControl=o,t.Root=o.Root,e.dynChildren().forEach(function(e){i(e)})):n.push(t)};return t.forEach(function(e){i(e)}),n}}}},A.prototype.resetGroupingGridOptions=function(){this.groupHeaderLabelButton=null,this.gridOptions=null},A.prototype.hasDirtyDataSource=function(){var t,e,o=!1;if(D.serverForm&&D.isServerBoundDataSource(this.DataSource)){var n=this.Root&&this.Root.Id;try{for(var i=__values(this.modelCollectionIds),r=i.next();!r.done;r=i.next()){var a=r.value,s=D.serverForm.ModelManager.getModelCollection(a,n);if(s&&s.IsDirty){o=!0;break}}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}}return o},A.prototype.applyVirtualizedPropertyFirstTime=function(){D.value(this.creatingChildren)||this.calculateChildrenAndRenderAsync()},A.prototype.syncToLegacyBehaviorPendingRow=function(){this.legacyBehaviorPendingRow&&(this.setInternalSelectedRow(this.legacyBehaviorPendingRow,D.value(this.InternalSelectedRowTrackingId)),this.legacyBehaviorPendingRow="")},A.prototype.resetInternalSelectedTrackingId=function(){var e=D.value(this.SelectedRowTrackingId),t=D.value(this.InternalSelectedRowTrackingId);e!==t&&(D.log.syncManager&&D.log.syncManager("resetInternalSelectedTrackingId (serverId, clientId): (".concat(e,", ").concat(t,")")),this.setInternalSelectedRow(e,t))},A.prototype.addGrouping=function(n,i){var e,r=this;null!==(e=D.serverForm)&&void 0!==e&&e.interactionManager.incrementGlobalBlockingFlag(!0,"ReactGrid_Grouping"),this.addGroupingSort(i,D.ui.SortDirection.ascending,function(){var e,t={ControlName:i._name};n&&(t.GroupingUnit=n);var o=r.groupingManager.columnGrouping.concat([t]);r.groupingManager.group({ColumnGroupings:o},!0),null!==(e=D.serverForm)&&void 0!==e&&e.interactionManager.decrementGlobalBlockingFlag()})},A.prototype.removeGrouping=function(e){var t,o,n,i=this;if(0===e)n=null,o=this.groupingManager.columnGrouping;else{var r=this.groupingManager.columnGrouping.slice(0,e);n={ColumnGroupings:r},o=this.groupingManager.columnGrouping.slice(e)}null!==(t=D.serverForm)&&void 0!==t&&t.interactionManager.incrementGlobalBlockingFlag(!0,"ReactGrid_Ungrouping"),this.removeSort(o,function(){var e;i.groupingManager.group(n,!0),null!==(e=D.serverForm)&&void 0!==e&&e.interactionManager.decrementGlobalBlockingFlag()})},A.prototype.columnChanged=function(){var t=this;D.observe(this.creatingChildren,function(e){if(!e)return t.calculateChildrenAndRenderAsync(),!1})},A.prototype.getCurrentGroupTrackingId=function(){var e,t=this.groupingManager.getActiveGroupTrackingId();if(!t)if(this.groupingManager.isGroupHeaderTrackingId(D.value(this.InternalSelectedRowTrackingId)))t=D.value(this.InternalSelectedRowTrackingId);else{var o=this.getActiveRowCollectionIndex(),n=D.value(this.DataSource)[o];n&&(t=null!==(e=D.serverForm)&&void 0!==e&&e.isModel(n)?n.getValue(D.reactGrid.PARENT_GROUP_KEY):n[D.reactGrid.PARENT_GROUP_KEY])}return t},A.prototype.resetFieldFilters=function(e){this.FilterExpressions[e]&&this.FilterExpressions[e](null)},A.prototype.setLookupValue=function(e,t,o){var n,i,r=this.getColumnInfo(e),a=r.ReferenceGroup?r.ReferenceGroup:r;if(this.bulkEditLightBoxOpen&&!o)this.bulkEditLightBox.setLookupValue(e,t);else{var s=D.value(this.SelectedRowTrackingId),l=this.getCollectionIndexFromTrackingId(s),u=D.value(this.DataSource),d=void 0;if(d=null!=u&&u[l]&&a.DataSourceName&&u[l].collectionName!==a.DataSourceName?null===(i=(n=u[l]).getRelated)||void 0===i?void 0:i.call(n,a.DataSourceName,l):null==u?void 0:u[l]){var c="_VIRTUALIZED_".concat(a.Name,"_DataVersion"),p=d.getValue(c);if(void 0===p&&(p=0),d.setValue(c,p+1,!0,a.Root.Id),!o){var h="_VIRTUALIZED_".concat(a.Name,"_Validity"),m=d.getValue(h),v=t;r.ReferenceGroup&&((v=m?D.util.objectAssign({},m.userValue):{})[r.Name]=t);var g=D.util.objectAssign({},m,{userValue:v});d.setValue(h,g,!0,a.Root.Id)}D.reactGrid.appliedVirtualizedProperty=!0}}},A.prototype.treatGridAsVisible=function(){return this.ForceInvisibleRender||this.element&&null!==this.element.offsetParent||this.IsInsidePreviewForm()},A.prototype.getCollectionDataPropValue=function(){if(!D.value(this.InfiniteScroll)){var e=D.length(this.DataSource),t=D.value(this.PageIndex),o=D.value(this.PageSize);if(0<e&&0<=t&&0<o){var n=t*o,i=n+o;return e<i&&(i=void 0),D.value(this.DataSource).slice(n,i)}}return D.value(this.DataSource)},A.prototype.enablePaging=function(){return!(D.value(this.InfiniteScroll)||!(D.length(this.DataSource)>D.value(this.PageSize)||D.length(this.DataSource)<D.value(this.CacheSize)||D.value(this.DataAbove)||D.value(this.DataBelow)))},A.prototype.getLastPageIndex=function(){var e=D.value(this.PageSize);return 0<e?Math.ceil(D.length(this.DataSource)/e)-1:0},A.prototype.hasNextPage=function(){return D.value(this.InfiniteScroll)?D.value(this.HasNextPage):!!(D.value(this.DataBelow)||D.length(this.DataSource)<D.value(this.CacheSize))||D.value(this.PageIndex)<this.getLastPageIndex()},A.prototype.hasPreviousPage=function(){return D.value(this.InfiniteScroll)?D.value(this.HasPreviousPage):0<D.value(this.PageIndex)},A.prototype.getRowIndexFromElement=function(e){var t=-1,o=$(e).closest("[aria-rowindex]");return o&&0<o.length&&(t=parseInt(o.attr("aria-rowindex"),10),isNaN(t)||(t--,D.value(this.IsHeaderVisible)&&t--)),t},A.prototype.getFilterExpressions=function(i,r){var a=this;return new Promise(function(t,o){if(D.value(a.FilterExpressions[i]))t(D.value(a.FilterExpressions[i]));else{a.FilterExpressions[i]||(a.FilterExpressions[i]=D.observable());var n=a.getColumnInfo(i);a.FilteringFields=a.getFilteringFieldsForColumn(n),a.FilterManager.getFieldFilters(a.FilteringFields,i,D.value(n.Label),function(e){a.getFieldFilterCallBack(n,r)(e)?t(D.value(a.FilterExpressions[i])):o()})}})},A.prototype.onCacheClear=function(){var e=this;this.ControlLibGridRef&&this.ControlLibGridRef.recalculateScrollTop(),this.syncManager&&this.syncManager.onCacheClear(),this.ConfirmedNoDataBelow(!1),this.ConfirmedNoDataAbove(!1);var t=this.getEmptyColumnCounts();this.gridCounts={ColumnCounts:t.columnCounts,IsPartialCount:!1,MarkedRowCount:this.getMarkedRowCount()},this.clearRangeSelection(),this.cacheClearAsync=D.async(function(){e.groupingManager&&(e.groupingManager.onCacheClear()||e.renderReactListAsync())})},A.prototype.furtherRequestGroupTotals=function(e,t){function o(){n.retrievingGroupData&&(D.setValue(n,"dataRetrievalProgressText",D.format(D.label("Grid_RowProcessed"),D.length(n.DataSource))),window.setTimeout(function(){n.furtherRequestGroupTotals(e,t)}))}var n=this;this.retrievingGroupData&&(this.groupingManager.isFirstGroup(e)&&D.value(this.HasPreviousPage)?window.setTimeout(function(){n.getPreviousPage(null,o)}):this.groupingManager.isLastGroup(e)&&D.value(this.HasNextPage)?window.setTimeout(function(){n.getNextPage(null,o)}):(t&&t(),this.createdRetreivalDialog&&(D.shell.dialogBack(),this.createdRetreivalDialog=!1),this.retrievingGroupData=!1))},A.prototype.createRetreivalDialog=function(e){var t=this;D.setValue(this,"dataRetrievalProgressText",D.format(D.label("Grid_RowProcessed"),D.length(this.DataSource)));var o={context:{CancelClicked:function(){t.requestingData=!1,t.retrievingGroupData=!1,e&&e(!0)},DisableAnimation:!!D.flags.disableAnimations,ProgressText:this.dataRetrievalProgressText,TitleText:D.label("Grid_CalculatingTotals")},role:"Dialog",templateId:"ProgressMessage"};D.shell.createForm(o),D.shell.dialog(o),this.createdRetreivalDialog=!0},A.prototype.setSelectedOnCollectionIndex=function(e,t){if(t){var o=D.length(t.items);if(0<o&&e<o){var n=t.items()[e];n&&(n.isSelected=!0)}}},A.prototype.setInternalSelectedRow=function(e,t){var o=this.getRowIndexFromTrackingId(e),n=this.groupingManager.rowIndexToCollectionIndex(o),i=this.groupingManager.isGroupHeaderTrackingId(e);if(D.isServerBoundDataSource(this.DataSource))i?this.DataSource.__boundDataSource.internalActiveMasterTrackingId(e):this.setActiveRowCollectionIndex(n);else{var r=this.getRowIndexFromTrackingId(t),a=this.groupingManager.rowIndexToCollectionIndex(r),s=this.groupingManager.isGroupHeaderTrackingId(t),l=D.value(this.DataSource);i||l[n]&&(l[n][D.reactGrid.ISSELECTED_NAME]=!0),l[a]&&!s&&(l[a][D.reactGrid.ISSELECTED_NAME]=!1),D.setValue(this,"InternalSelectedRowTrackingId",e)}},A.prototype.setActiveRowCollectionIndex=function(i){var r=this;0<=i&&D.serverForm&&D.isServerBoundDataSource(this.DataSource)&&this.modelCollectionIds.forEach(function(e){var o=r.Root&&r.Root.Id,t=D.serverForm.ModelManager.getModelCollection(e,o);if(t){r.setSelectedOnCollectionIndex(i,t);var n=D.serverForm.ModelManager.getChildCollectionIds(D.value(t.masterDataSourceName),o);n&&0<n.length&&n.forEach(function(e){var t=D.serverForm.ModelManager.getModelCollection(e,o);t&&!r.dataSourceObservers[t.name]&&r.setSelectedOnCollectionIndex(i,t)})}})},A.prototype.disposeGridOptions=function(){this.gridOptions=null,this.addColumnButton=null,this.footerButton=null,this.groupHeaderLabelButton=null,this.expandAllGroupsButton=null,this.collapseAllGroupsButton=null,this.ungroupAllButton=null,this.bulkEditButton=null},A.prototype.getExpandAllGroupsButton=function(e){if(!this.expandAllGroupsButton){var t={Id:"".concat(this.getUniqueId(),"_").concat(r),key:r,Label:D.label("Grid_ExpandAllGroups"),OnClick:this.expandAllGroups,Style:e};this.expandAllGroupsButton=React.createElement(ControlLibrary.Button,t)}return this.expandAllGroupsButton},A.prototype.getCollapseAllGroupsButton=function(e){if(!this.collapseAllGroupsButton){var t={Id:"".concat(this.getUniqueId(),"_").concat(a),key:a,Label:D.label("Grid_CollapseAllGroups"),OnClick:this.collapseAllGroups,Style:e};this.collapseAllGroupsButton=React.createElement(ControlLibrary.Button,t)}return this.collapseAllGroupsButton},A.prototype.getUngroupAllButton=function(e){if(!this.ungroupAllButton){var t={Id:"".concat(this.getUniqueId(),"_").concat(s),key:s,Label:D.label("Grid_UngroupAll"),OnClick:this.ungroupAll,Style:e};this.ungroupAllButton=React.createElement(ControlLibrary.Button,t)}return this.ungroupAllButton},A.prototype.getGroupHeaderLabelButton=function(e){if(!this.groupHeaderLabelButton){var t={Id:"".concat(this.getUniqueId(),"_").concat(i),key:i,Label:D.value(this.ShowGroupHeaderLabel)?D.label("ReactGrid_HideGroupHeaderLabel"):D.label("ReactGrid_ShowGroupHeaderLabel"),OnClick:this.toggleGroupHeaderLabel,Style:e};this.groupHeaderLabelButton=React.createElement(ControlLibrary.Button,t)}return this.groupHeaderLabelButton},A.prototype.getAddColumnButton=function(e){if(!this.addColumnButton){var t={Id:"".concat(this.getUniqueId(),"_").concat(c),key:c,Label:D.label("ContextMenu_AddColumns"),OnClick:this.addColumns,Style:e};this.addColumnButton=React.createElement(ControlLibrary.Button,t)}return this.addColumnButton},A.prototype.getFooterButton=function(e){if(!this.footerButton){var t=D.value(this.FooterShown),o={Id:"".concat(this.getUniqueId(),"_").concat(n),key:n,Label:t?D.label("Grid_HideFooter"):D.label("Grid_ShowFooter"),OnClick:t?this.hideFooter:this.showFooter,Style:e};this.footerButton=React.createElement(ControlLibrary.Button,o)}return this.footerButton},A.prototype.getBulkEditButton=function(e){if(!this.bulkEditButton){var t={Id:"".concat(this.getUniqueId(),"_").concat(p),key:p,Label:D.label("ReactGrid_BulkEdit"),OnClick:this.bulkEdit,Style:e};this.bulkEditButton=React.createElement(ControlLibrary.Button,t)}return this.bulkEditButton},A.prototype.getMarkedRowIndexes=function(){var e=[],t=this.getMarkedRowCount();if(0<t){var o=this.getActiveRowCollectionIndex(),n=D.isServerBoundDataSource(this.DataSource);if(1===t&&this.getRowMark(o,n))e.push(this.groupingManager.collectionIndexToRowIndex(o));else if(o<D.length(this.DataSource)/2)for(var i=0;i<D.length(this.DataSource)&&(this.getRowMark(i,n)&&e.push(this.groupingManager.collectionIndexToRowIndex(i)),e.length!==t);i++);else for(i=D.length(this.DataSource)-1;0<=i&&(this.getRowMark(i,n)&&e.push(this.groupingManager.collectionIndexToRowIndex(i)),e.length!==t);i--);}return e},A.prototype.getEditFieldsForBulkEdit=function(){var t,e,o,n,i=[];if(this.columnInfo)try{for(var r=__values(this.columnInfo),a=r.next();!a.done;a=r.next()){var s=a.value;if(D.value(s.Enabled)&&D.value(s.AllowEdit)&&"Image"!==s.TypeName)if("ReferenceGroup"===s.TypeName){var l=s._element||s.element;if(l&&l.dynChildren){var u=l.dynChildren();if(u)try{for(var d=(o=void 0,__values(u)),c=d.next();!c.done;c=d.next()){var p=c.value,h=D.controlOptions(p);h&&i.push({columnInfo:h,version:0})}}catch(e){o={error:e}}finally{try{c&&!c.done&&(n=d.return)&&n.call(d)}finally{if(o)throw o.error}}}}else i.push({columnInfo:s,version:0})}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return i},Object.defineProperty(A.prototype,"RenderTarget",{get:function(){return this.element&&!this.renderTarget&&(this.renderTarget=this.element.querySelector(".reactGrid"),this.renderTarget||(this.renderTarget=this.element)),this.renderTarget},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"GridStyle",{get:function(){return this.gridStyle||(this.gridStyle={marginLeft:D.ui.theme.getUnitValue("margin")}),this.gridStyle},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"LookupRootStyle",{get:function(){return this.lookupRootStyle||(this.lookupRootStyle={marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.lookupRootStyle},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"InsideFastTabStyle",{get:function(){return this.insideFastTabStyle||(this.insideFastTabStyle={marginTop:0}),this.insideFastTabStyle},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"RightSplitterStyle",{get:function(){return this.rightSplitterStyle||(this.rightSplitterStyle={marginRight:0}),this.rightSplitterStyle},enumerable:!1,configurable:!0}),Object.defineProperty(A.prototype,"BottomSplitterStyle",{get:function(){return this.bottomSplitterStyle||(this.bottomSplitterStyle={marginBottom:0}),this.bottomSplitterStyle},enumerable:!1,configurable:!0}),A.prototype._getDefaultControl=function(e){var t,o,n,i=D.children(e);if(i&&!this.IsCardList())try{for(var r=__values(i),a=r.next();!a.done;a=r.next()){var s=a.value,l=D.controlOptions(s);if(l&&u[l.TypeName]&&(n=n||l,D.value(l.IsDefaultActionGridControl))){n=l;break}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}return n},A.prototype.IsCardList=function(){return"cardList"===D.value(this.ExtendedStyle)},A.prototype.performKeyDownNavigationAction=function(e,t){var o=this;if(0<D.length(this.DataSource)&&D.value(this.NavigationAction)){var n=!1;if((!D.value(this.AllowEdit)&&D.value(this.Enabled)&&D.value(this.ForcePrimaryNavigation)||D.value(this.NavigationEnabled)&&(this.IsCardList()||this.defaultControlName===e.Name))&&(n=!0),n)return this.dataCache.turnOffFastFetch(),t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),D.async(function(){o.Root&&o.Root.updateLastClientSelectedControl&&o.Root.updateLastClientSelectedControl(),D.callFunction(o.NavigationAction,o)},0,"Calling navigation action on react grid"),!0}return!1},A.prototype.firstPotentialEditableColumn=function(){var t,e;if(this.columnInfo)try{for(var o=__values(this.columnInfo),n=o.next();!n.done;n=o.next()){var i=n.value;if(D.value(i.Enabled)&&"Image"!==i.TypeName)return i._name}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},A.prototype.updateActiveColumn=function(e){null!=e&&e.startsWith("_GRID_")?this.Root&&D.value(this.Root.ActiveControl)!==this.Name&&(this.Root.ActiveControl(this.Name),this.Root.updateActiveElement(document.activeElement)):this.activeColumnName=null!=e?e:""},A.prototype.hasRangeSelection=function(){return this.cellsRange.rowStart!==this.cellsRange.rowEnd||this.cellsRange.columnStart!==this.cellsRange.columnEnd},A.prototype.setRowMark=function(r,a,e){var s=this;if(e){var l=this.Root&&this.Root.Id;this.modelCollectionIds.forEach(function(e){var t=D.serverForm.ModelManager.getModelCollection(e,l),o=s.getTrackingIdFromCollectionIndex(r);if(t){var n="".concat(t.name,"_").concat(o),i=D.serverForm.ModelManager.getModel(n);i&&(i.isMarked=a)}})}else{var t=D.value(this.DataSource)[r];if(t&&t[D.reactGrid.ISMARKED_NAME]!==a){t[D.reactGrid.ISMARKED_NAME]=a;var o=t[D.reactGrid.PARENT_GROUP_KEY];o&&this.groupingManager.adjustGroupMarkCount(o,a?1:-1)}}},A.prototype.getRowMark=function(e,t){if(t){var o=D.value(this.DataSource)[e];return!!o&&o.isMarked}var n=D.value(this.DataSource)[e];return!!n&&n[D.reactGrid.ISMARKED_NAME]},A.prototype.clearRangeSelection=function(){this.rangeSelection=!1,this.rangePivotTrackingId=""},A.prototype.getDataSourceFieldToControlMap=function(){var t,e,o={};try{for(var n=__values(this.columnInfo),i=n.next();!i.done;i=n.next()){var r=i.value;if(r.DataSourceName){var a=o[r.DataSourceName];if(a||(a={},o[r.DataSourceName]=a),r.FieldName){var s=a[r.FieldName];s||(s=[],a[r.FieldName]=s),s.push(r)}}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return o},A.prototype.getColumnCounts=function(e,t){var o,n,i,r,a,s={},l=this.getDataSourceFieldToControlMap();for(var u in l)if(l.hasOwnProperty(u)&&!u.endsWith("_form")){var d=void 0;if(D.isServerBoundDataSource(this.DataSource)&&null!=(d=D.value(this.DataSource.__boundDataSource))&&d.getRelatedCollection&&u!==d.name&&(d=d.getRelatedCollection(u)),d){t&&t(d);var c=D.value(d.fieldsWithTotals)||[],p=l[u];try{for(var h=(o=void 0,__values(c)),m=h.next();!m.done;m=h.next()){var v=m.value;if(v in p){var g=p[v];try{for(var y=(i=void 0,__values(g)),f=y.next();!f.done;f=y.next()){var b=f.value;if(!this.countsExcludedControls[b._name]){var C=e(b,d);s[b._name]=C.text,C.displaceText&&((a=a||{})[b._name]=C.displaceText)}}}catch(e){i={error:e}}finally{try{f&&!f.done&&(r=y.return)&&r.call(y)}finally{if(i)throw i.error}}}}}catch(e){o={error:e}}finally{try{m&&!m.done&&(n=h.return)&&n.call(h)}finally{if(o)throw o.error}}}}return{columnCounts:s,displaceColumnCount:a}},A.prototype.getCalculatedColumnCounts=function(){var o=this;return this.gridCountVersions={},this.getColumnCounts(this.MayHaveMoreDataAboveOrBelow()||this.IsSizeLimited()||D.length(this.DataSource)<=0?A.emptyValueCalculator:A.valueCalculator,function(e){if(!(e.name in o.gridCountVersions)){var t=D.value(e.markedCount)<=1?e.totalsVersion:e.markedTotalsVersion;o.gridCountVersions[e.name]=function(){return t!==(D.value(e.markedCount)<=1?e.totalsVersion:e.markedTotalsVersion)}}})},A.prototype.getEmptyColumnCounts=function(){return this.gridCountVersions={},this.getColumnCounts(A.emptyValueCalculator)},A.prototype.getMarkedRowCount=function(){return D.isServerBoundDataSource(this.DataSource)&&D.value(this.DataSource.__boundDataSource.markedCount)||0},A.prototype.getAllData=function(e){function t(){o.requestingData&&(D.setValue(o,"dataRetrievalProgressText",D.format(D.label("Grid_RowProcessed"),D.length(o.DataSource))),window.setTimeout(function(){o.getAllData(e)}))}var o=this;this.dataCache.turnOffFastFetch(),D.value(this.IsSizeLimited)?(this.requestingData=!1,e&&e()):D.value(this.HasPreviousPage)?(this.requestingData=!0,window.setTimeout(function(){o.getPreviousPage(null,t)})):D.value(this.HasNextPage)?(this.requestingData=!0,window.setTimeout(function(){o.getNextPage(null,t)})):(this.requestingData=!1,e&&e())},A.prototype.updateColumnTotalShown=function(e,t){var o=this.getColumnInfo(e);o&&D.value(o.TotalShown)!==t&&(D.setValue(o,"TotalShown",t),D.value(o.UpdateTotalShown)&&D.callFunction(o.UpdateTotalShown,o,[t]))},A.prototype.updateColumnTotalType=function(e,t){if(A.extendedAggregationEnabled()){var o=this.getColumnInfo(e);o&&D.value(o.TotalType)!==t&&(D.setValue(o,"TotalType",t),D.value(o.UpdateTotalType)&&D.callFunction(o.UpdateTotalType,o,[t]))}},A.prototype.isColumnFilterable=function(e){var t=!1;return e&&(D.value(e.IsFilterable)?t=!0:D.value(e.FieldName)===D.util.dataAreaId&&D.isServerBoundDataSource(this.DataSource)&&(t=this.DataSource.__boundDataSource.IsCrossCompany)),t},A.prototype.scrollPopupToShowRow=function(e){var t=this.element&&this.element.closest('[data-dyn-role="Popup"]');if(t){var o=e+(D.value(this.IsHeaderVisible)?2:1),n=this.element.querySelector('[aria-rowindex="'.concat(o,'"]'));n&&(n.getBoundingClientRect().bottom>t.getBoundingClientRect().bottom?this.element.scrollIntoView(!1):n.getBoundingClientRect().top<t.getBoundingClientRect().top&&this.element.scrollIntoView(!0))}},A.prototype.createOrShowColumnHeaderPopup=function(e){var t=this;if(this.ColumnPopups[e._name]){var o=D.context(this.ColumnPopups[e._name].$popupElement[0]);D.setValue(o,"IsSorted",D.value(e.SortDirection));var n=this.ColumnPopups[e._name].$reorderElement;n&&n.addClass("hasOpenPopup"),this.ColumnPopups[e._name].show(!0)}else{var i=$("<div></div>");i[0].hidden=!0,i.addClass("columnHeader-popup sysPopup"),i.attr("data-dyn-role","ColumnHeaderPopup");var r=$(this.element).find(".dyn-headerCell[data-dyn-controlname='"+e._name+"']"),a=D.observable(!1);this.FilterExpressions[e._name]||(this.FilterExpressions[e._name]=D.observable());var s={ControlType:e.TypeName,FieldName:e.FieldName,FilterExpressions:this.FilterExpressions[e._name],FlyOutPickerOpen:a,FormDataSourceName:e.DataSourceName,Grid:this,IsSorted:D.value(e.SortDirection),Name:e._name,Root:this.Root};D.dataBind(i[0],s);var l={flyout:i,positionResize:!0,putAnimationOnTarget:!0,scrollTarget:$(this.element),show:a,target:r};D.util.flyout(l,!1);var u=this.getReorderElement(r);this.ColumnPopups[e._name]={$popupElement:i,$reorderElement:u,flyoutOptions:l,show:a},u&&u.addClass("hasOpenPopup"),a(!0);var d=D.context(i[0]);D.observe(a,function(e){e?(t.activeColumnHeaderPopup=i[0],r.addClass("hasOpenPopup")):(r.removeClass("hasOpenPopup"),u&&u.removeClass("hasOpenPopup"),t.activeColumnHeaderPopup===i[0]&&(t.activeColumnHeaderPopup=null),d&&d.UpdateColumnHeaderAriaLabel(!0))})}},A.prototype.getFieldFilterCallBack=function(i,r){var a=this;return function(e){var t=!0;if(e&&a.FilteringFields&&e.length===a.FilteringFields.length)for(var o=0;o<e.length;o++){if(!e[o]||!e[o].Capability){t=!1;break}var n=D.value(a.FilteringFields[o].Label);n&&(D.value(e[o].Capability).FieldLabel=n)}else t=!1;return t?a.updateFieldFilterExpressions(e,i,r):D.error({Message:D.label("List_ColumnNotFilterable"),Label:"List_ColumnNotFilterable"},a),t}},A.prototype.getReorderElement=function(e){var t,o=e.closest(".public_fixedDataTableCell_hasReorderHandle");return o.length&&(t=o.find("> .fixedDataTableCellLayout_columnReorderContainer")),t},A.prototype.updateFieldFilterExpressions=function(e,t,o){var n,i=e;if(e){var r=D.value(e);r.forEach(function(e){e.IsEditable=D.util.stringToBoolean(e.IsEditable)}),n=r;var a=D.observableObject(r);i=D.value(a)}if(this.FilterExpressions[t._name]&&(this.FilterExpressions[t._name](i),this.FilterExpressions[t._name].__source=n),o&&this.ColumnPopups[t._name]){var s=D.context(this.ColumnPopups[t._name].$popupElement[0]);s&&s.UpdateColumnHeaderAriaLabel(),this.ColumnPopups[t._name].$popupElement[0].hidden=!1}},Object.defineProperty(A.prototype,"FilterManager",{get:function(){return!this.filterManager&&this.Root&&(this.filterManager=this.Root.FilterManager),this.filterManager},enumerable:!1,configurable:!0}),A.prototype.actOnDataBinding=function(e){var t,o=this;if("ReferenceGroup"===e._typeName){var n=e._element||e.element;if(n&&n.dynChildren){var i=n.dynChildren();if(0<i.length){var r=D.controlOptions(i[0]);r&&this.actOnDataBinding(r)}}}else if(D.isServerBoundDataSource(this.DataSource)&&e.DataSourceName)if(e.DataSourceName.endsWith("_form")){if(null!==(t=this.Root)&&void 0!==t&&t.Id){var a=D.serverForm.getModel(this.Root.Id);a&&(this.formModelSubscriber=a.propertyChanged().subscribe(function(){o.dataVersion++,o.renderReactListAsync()}))}}else{var s=e.DataSourceName!==this.DataSource.__dataSourceName,l=s?this.DataSource.__boundDataSource.getRelatedCollection(e.DataSourceName):this.DataSource.__boundDataSource;if(l){if(s&&this.dataSourceObservers&&!this.dataSourceObservers[e.DataSourceName]){var u=D.observe(l.items,function(){o.dataVersion++,o.renderReactListAsync()},this,void 0,!0);this.relatedItemSubscribers[l.id]=l.itemsChanged().subscribe(function(){o.dataVersion++,o.renderReactListAsync()}),this.dataSourceObservers[e.DataSourceName]=u,this.modelCollectionIds.push(l.id)}if(e.FieldName&&(this.gridCountVersions[e.DataSourceName]&&delete this.gridCountVersions[e.DataSourceName],this.gridCountVersions[e.DataSourceName]=function(){return!0},D.value(e.Enabled))){var d=l.items().length;if(0<d){var c=l.items()[0].doesPropertyExist(e.FieldName),p=c,h=c;if(1<d&&(p=l.items()[d-1].doesPropertyExist(e.FieldName),2<d)){var m=Math.floor((d-1)/2);h=l.items()[m].doesPropertyExist(e.FieldName)}c&&p&&h||(this.missingFields[l.name]||(this.missingFields[l.name]={}),this.missingFields[l.name][e.FieldName]=!0)}}}}},A.prototype.handleMissingFields=function(){var e=this;this.missingFields&&0<Object.keys(this.missingFields).length&&this.Refresh&&window.setTimeout(function(){D.log.reactList&&D.log.reactList("ReactList: Refresh data due to missing fields"),D.callFunction(e.Refresh,e)})},A.prototype.calculateChildrenAndRenderAsync=function(){var e=this;this.calculateChildrenTimeout()&&this.calculateChildrenTimeout().cancel(),this.calculateChildrenTimeout(D.async(function(){e.treatGridAsVisible()?e.calculateChildren(function(){e.groupingManager.updateGroupHeadersAndRerender()}):(e.needToCalculateChildrenBeforeRender=!0,D.log.reactList&&D.log.reactList("ReactList: Prevent invisible children calculation")),e.calculateChildrenTimeout(null)},0,"Call calculate children"))},A.prototype.calculateChildren=function(e){var t,o,n,i,r,a,s,l,u=this;this.needToCalculateChildrenBeforeRender=!1,this.columnInfo=[],this.columnNameToInfoIndex={},this.missingFields={};try{for(var d=__values(this.columnObservers),c=d.next();!c.done;c=d.next())c.value.dispose()}catch(e){t={error:e}}finally{try{c&&!c.done&&(o=d.return)&&o.call(d)}finally{if(t)throw t.error}}this.columnObservers=[];var p=this.getColumnsOptions();if(p)if(this.creatingChildren(!0),0===D.reactGrid.loadControlResources(p,function(){u.calculateChildren(e)})){this.calculatedAllowEdit=!1,this.calculatedAllowTotals=!1;var h=this.hasFrozenChild=!1;try{for(var m=__values(p),v=m.next();!v.done;v=m.next()){var g=v.value;if(D.ui.disposePopupHost.apply(g),D.value(g.Visible))if("Card"===g.TypeName){g.isInGrid=function(){return!0},g.isInTable=function(){return!1},g.listControl=this,g.Root=this.Root,void 0===g.Name&&g._name&&(g.Name=g._name),this.cardId=this.Root?"".concat(g.Name,"_").concat(this.Root.Id):g.Name,this.isTileCard="TileCard"===D.value(g.ExtendedStyle);var y=(g._element||g.element).dynChildren().map(function(e){return D.controlOptions(e)});try{for(var f=(r=void 0,__values(y)),b=f.next();!b.done;b=f.next()){var C=b.value;this.augmentColumnOptions(C)}}catch(e){r={error:e}}finally{try{b&&!b.done&&(a=f.return)&&a.call(f)}finally{if(r)throw r.error}}}else this.augmentColumnOptions(g),D.value(this.Mode)===D.ui.ListMode.list&&(g.IsAdditionalInfo=!0);else h=h||0<=this.groupingManager.getGroupingIndex(g.Name),null!==(s=this.ColumnPopups)&&void 0!==s&&s[g.Name]&&delete this.ColumnPopups[g.Name],null!==(l=this.FilterExpressions)&&void 0!==l&&l[g.Name]&&delete this.FilterExpressions[g.Name],D.isObservable(g.Visible)&&this.columnObservers.push(D.observe(g.Visible,this.columnChanged,this,void 0,!0))}}catch(e){n={error:e}}finally{try{v&&!v.done&&(i=m.return)&&i.call(m)}finally{if(n)throw n.error}}h&&this.groupingManager.onColumnHidden(),this.handleMissingFields(),this.creatingChildren(!1),e&&(e(),e=void 0)}else this.firstRender&&void 0===e&&(e=function(){u.renderReactListAsync()});else this.creatingChildren(!1),e&&(e(),e=void 0)},A.prototype.augmentColumnOptions=function(e){var t,o,n,r=this;if(e.isInGrid=function(){return!0},e.isInTable=function(){return!1},e.listControl=this,e.Root=this.Root,void 0===e.Name&&e._name&&(e.Name=e._name),void 0===e._typeName&&e.TypeName&&(e._typeName=e.TypeName),"Toolbar"===e.TypeName){var a=[],s={},i=e._element||e.element,l=D.value(null==i?void 0:i.dynChildren);null!=l&&l.map(function(e){var t=D.controlOptions(e);if("ToolbarGroup"===t.TypeName){r.columnObservers.push(D.bulkObserve(t,r.columnChanged,D.ui.updating,r,void 0,D.reactGrid.COLUMN_PROPERTIES_TO_OBSERVE,!0));var o=t._element||t.element,n=D.value(null==o?void 0:o.dynChildren);null!=n&&n.map(function(e){var t=D.controlOptions(e);r.columnObservers.push(D.bulkObserve(t,r.columnChanged,D.ui.updating,r,void 0,D.reactGrid.COLUMN_PROPERTIES_TO_OBSERVE,!0));var o=t._name;if(s[o]=a.length,a.push(t),"MenuButton"===t.TypeName)if(D.value(t.HasBeenOpened)){var n=t._element||t.element;if(null!=n&&n.dynChildren){D.isObservable(n.dynChildren)&&r.columnObservers.push(D.observe(n.dynChildren,r.columnChanged,r,void 0,!0));var i=D.value(n.dynChildren);null!=i&&i.map(function(e){var t=D.controlOptions(e);r.columnObservers.push(D.bulkObserve(t,r.columnChanged,D.ui.updating,r,void 0,D.reactGrid.COLUMN_PROPERTIES_TO_OBSERVE,!0));var o=t._name;s[o]=a.length,a.push(t)})}}else D.isObservable(t.HasBeenOpened)&&r.columnObservers.push(D.observe(t.HasBeenOpened,r.columnChanged,r,void 0,!0))})}}),e.ChildCols=a,e.ChildNameToColIndex=s}else if("MenuButton"===e.TypeName){var u=[],d={};if(this.columnObservers.push(D.bulkObserve(e,this.columnChanged,D.ui.updating,this,void 0,D.reactGrid.COLUMN_PROPERTIES_TO_OBSERVE,!0)),D.value(e.HasBeenOpened)){var c=e._element||e.element;if(null!=c&&c.dynChildren){D.isObservable(c.dynChildren)&&this.columnObservers.push(D.observe(c.dynChildren,this.columnChanged,this,void 0,!0));var p=D.value(c.dynChildren);null!=p&&p.map(function(e){var t=D.controlOptions(e);r.columnObservers.push(D.bulkObserve(t,r.columnChanged,D.ui.updating,r,void 0,D.reactGrid.COLUMN_PROPERTIES_TO_OBSERVE,!0));var o=t._name;d[o]=u.length,u.push(t)})}}else D.isObservable(e.HasBeenOpened)&&this.columnObservers.push(D.observe(e.HasBeenOpened,this.columnChanged,this,void 0,!0));e.ChildCols=u,e.ChildNameToColIndex=d}else{if(this.calculatedAllowEdit=this.calculatedAllowEdit||D.value(e.AllowEdit),this.hasFrozenChild=this.hasFrozenChild||D.value(e.IsFrozen),"ReferenceGroup"===e.TypeName){var h=e._element||e.element;if(null!=h&&h.dynChildren){var m=D.value(h.dynChildren);if(m)try{for(var v=__values(m),g=v.next();!g.done;g=v.next()){var y=g.value,f=D.controlOptions(y);f&&(f.ReferenceGroup=e,this.populateRecordability(f))}}catch(e){t={error:e}}finally{try{g&&!g.done&&(o=v.return)&&o.call(v)}finally{if(t)throw t.error}}}}else this.populateRecordability(e);e.AllowTotal="Real"===e.TypeName||"Integer"===e.TypeName||"Int64"===e.TypeName,this.calculatedAllowTotals=this.calculatedAllowTotals||e.AllowTotal,e.addMessage=function(e,t){this.messages?this.messages.push(e):this.messages=[e];var o=this.listControl,n=o.getCollectionIndexFromTrackingId(D.value(o.SelectedRowTrackingId));if(-1!==n){var i="_VIRTUALIZED_"+this._name+"_Validity",r={messages:[t]};if(D.isServerBoundDataSource(o.DataSource)){var a=(s=D.value(o.DataSource))[n];this.DataSourceName&&s[n]&&s[n].collectionName!==this.DataSourceName&&(a=s[n].getRelated(this.DataSourceName,n)),a&&((l=a.getValue(i))&&(l.messages&&l.messages.push(t),D.util.objectAssign(r,l)),a.setValue(i,r,!0,this.Root.Id),D.reactGrid.appliedVirtualizedProperty=!0)}else{var s,l;(a=(s=D.value(o.DataSource))[n])&&((l=a[i])&&(l.messages&&l.messages.push(t),D.util.objectAssign(r,l)),a[i]=r)}}else D.log.reactList&&D.log.reactList("ReactList: Unable to add message to validity because collectionIndex is -1")}.bind(e),e.getContextMenuOptions=function(t){var n=this,e=[],i=this.listControl;if(i){var o="",r=!1,a=void 0,s=void 0;if(i.isColumnFilterable(this)&&D.reactGrid.GroupingManager.flightEnabled()){var l=i.groupingManager.getGroupingIndex(this._name);if(-1<l)a=function(){i.removeGrouping(l)},o=D.label("Grid_Ungroup"),r=!0;else{var u=function(o){return function(){var e=i.groupingManager.prohibitedLastGrouping();if(""!==e){var t="";switch(e){case"Date":t=D.label("ReactGrid_ReplaceGroupConfirmationDate");break;case"Time":t=D.label("ReactGrid_ReplaceGroupConfirmationTime");break;case"DateTime":t=D.label("ReactGrid_ReplaceGroupConfirmationDateTime");break;default:t=""}D.showMessageBox({callback:function(e){e===D.controls.MessageBox.Button.Ok&&(i.removeGrouping(i.groupingManager.columnGrouping.length-1),i.addGrouping(o,n))},showCancelButton:!0,showDiagnostic:!1,showOkButton:!0,Text:t})}else i.addGrouping(o,n)}};"Date"===this.TypeName||"DateTime"===this.TypeName||"Time"===this.TypeName?(s=[],"DateTime"!==this.TypeName&&"Time"!==this.TypeName||(D.value(this.TimeSeconds)&&s.push({Command:u(S.DateGroupingUnit.Second),Enabled:!0,Label:D.label("Input_TimeSecond")}),D.value(this.TimeMinute)&&s.push({Command:u(S.DateGroupingUnit.Minute),Enabled:!0,Label:D.label("Input_TimeMinute")}),D.value(this.TimeHours)&&s.push({Command:u(S.DateGroupingUnit.Hour),Enabled:!0,Label:D.label("Input_TimeHour")})),"Date"!==this.TypeName&&"DateTime"!==this.TypeName||("None"!==D.value(this.DateDay)&&(s.push({Command:u(S.DateGroupingUnit.Day),Enabled:!0,Label:D.label("Input_DateDay")}),s.push({Command:u(S.DateGroupingUnit.Week),Enabled:!0,Label:D.label("Input_DateWeek")})),"None"!==D.value(this.DateMonth)&&(s.push({Command:u(S.DateGroupingUnit.Month),Enabled:!0,Label:D.label("Input_DatePickerMonthLabel")}),s.push({Command:u(S.DateGroupingUnit.Quarter),Enabled:!0,Label:D.label("Input_DateQuarter")})),"None"!==D.value(this.DateYear)&&s.push({Command:u(S.DateGroupingUnit.Year),Enabled:!0,Label:D.label("Input_DatePickerYearLabel")}))):a=u(),o=D.label("Grid_GroupBy"),r=D.length(i.groupingManager.columnGrouping)<D.reactGrid.MAX_LEVEL_GROUPING}e.push({Command:a,contextMenuOptions:s,Enabled:r,Label:o})}if(D.value(this.AllowTotal))if(A.extendedAggregationEnabled()){var d=[];d.push({Command:function(){D.value(n.TotalShown)&&i.requestRemoveTotalColumn(n._name,null)},Label:D.label("Grid_TotalNone")}),u=function(e){return function(){D.value(i.FooterShown)?(i.requestAddTotalColumn(n._name,null,!0,e),i.requestTotalsFromControlLibrary()):D.value(n.TotalSown)?i.requestTotals(function(e){e||i.showFooter()}):(i.requestAddTotalColumn(n._name,null,!0,e),i.requestTotals(function(e){e||i.showFooter()}))}},d.push({Command:u("Avg"),Label:D.label("Grid_TotalAverage")}),d.push({Command:u("Max"),Label:D.label("Grid_TotalMaximum")}),d.push({Command:u("Min"),Label:D.label("Grid_TotalMinimum")}),d.push({Command:u("Sum"),Label:D.label("Grid_TotalSum")}),e.push({contextMenuOptions:d,Label:D.label("Grid_ViewColumnTotals")})}else D.value(i.FooterShown)?D.value(this.TotalShown)?e.push({Command:function(){i.requestRemoveTotalColumn(n._name,null)},Label:D.label("Grid_HideTotal")}):e.push({Command:function(){i.requestAddTotalColumn(n._name,null,!0,"Sum"),i.requestTotalsFromControlLibrary()},Label:D.label("Grid_TotalColumn")}):D.value(this.TotalShown)?e.push({Command:function(){i.requestTotals(function(e){e||i.showFooter()})},Label:D.label("Grid_TotalColumn")}):e.push({Command:function(){i.requestAddTotalColumn(n._name,null,!0,"Sum"),i.requestTotals(function(e){e||i.showFooter()})},Label:D.label("Grid_TotalColumn")});if(i.Root){if(D.value(i.Mode)===D.ui.ListMode.tabular&&D.value(i.Root.AllowPersonalization)&&D.controls.ReactList.freezingEnabled()){var c=void 0,p="";p=D.value(this.IsFrozen)?(c=function(){i.freezeColumn(n._name,!1)},D.label("ContextMenu_UnfreezeColumn")):(c=function(){i.freezeColumn(n._name,!0)},D.label("ContextMenu_FreezeColumn"));var h={Command:c,Enabled:!0,Label:p};e.push(h)}if(D.value(i.Root.AllowExplicitPersonalization)&&!i.Root.isPopup()){var m={Command:function(){D.callFunction(n.ExecutePersonalizationCommand,n,["SelectForHide",!1]),D.callFunction(n.PersistPersonalization,n,[D.ax.personalizableProperties.Visible,!1]),i.Root&&i.Root.ShowOrHideHiddenFields&&i.Root.ShowOrHideHiddenFields(!1)},Enabled:!0,Label:D.label("ContextMenu_HideColumn")};e.push(m)}}}var v={Command:function(){var e=n.listControl.getLiveControl(t);D.showAvailableShorcutsDialog(D.util.getAvailableShortcutsText(e,t))},Label:D.label("Framework_ViewShortcuts")};return e.push(v),e}.bind(e),e.getTaskGuideParams=T.bind(e);var b=D.reactGrid.getControlProperties(e.TypeName);if(b){var C=D.util.objectAssign({},D.reactGrid.COLUMN_PROPERTIES_TO_OBSERVE,b);this.columnObservers.push(D.bulkObserve(e,this.columnChanged,D.ui.updating,this,void 0,C,!0))}else this.columnObservers.push(D.bulkObserve(e,this.columnChanged,D.ui.updating,this,void 0,D.reactGrid.COLUMN_PROPERTIES_TO_OBSERVE,!0));this.columnObservers.push(D.bulkObserve(e,this.updateFilterSortClasses,D.ui.updating,this,void 0,_,!0)),D.isObservable(e.IsValid)&&this.columnObservers.push(D.observe(e.IsValid,function(e){var t,o,n=this.listControl,i="";this.Root&&(i=this.Root.Id,this.Root.UpdateInvalidControlList&&this.Root.UpdateInvalidControlList(this));var r=D.value(n.SelectedRowTrackingId);if(e){if(0<D.length(this.messages)){try{for(var a=__values(this.messages),s=a.next();!s.done;s=a.next()){var l=s.value;D.messageManager.remove(l,i)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(t)throw t.error}}this.messages=[]}n.syncManager.setValidity({override:void 0,messages:[]},r,this._name,this.DataSourceName),n.syncManager.setDataVersion(r,this._name,this.DataSourceName)}else n.syncManager.setValidity({override:!1},r,this._name,this.DataSourceName)},e,void 0,!0)),this.actOnDataBinding(e),D.value(e.TotalShown)?delete this.countsExcludedControls[e._name]:this.countsExcludedControls[e._name]=!0}if(!1!==D.value(e.Visible)){var w=this.columnInfo.length;this.columnNameToInfoIndex[e._name]=w,this.columnInfo.push(e),null!==(n=e.ChildCols)&&void 0!==n&&n.length&&e.ChildCols.forEach(function(e){r.columnNameToInfoIndex[e._name]=w})}},A.prototype.populateRecordability=function(e){"Input"!==e.TypeName&&"ComboBox"!==e.TypeName&&"CheckBox"!==e.TypeName&&"Int64"!==e.TypeName&&"Real"!==e.TypeName&&"Date"!==e.TypeName&&"Time"!==e.TypeName&&"DateTime"!==e.TypeName&&"Integer"!==e.TypeName&&"MultilineInput"!==e.TypeName||(e.recordability=D.util.recordabilityDefault.bind(e))},A.prototype.updateFilterSortClasses=function(){var t,e;try{for(var o=__values(this.columnInfo),n=o.next();!n.done;n=o.next()){var i=n.value,r=$(this.element).find(".fixedDataTableLayout_rowsContainer > .fixedDataTableRowLayout_rowWrapper"),a=r&&r.find("[data-dyn-controlname='"+i._name+"']");if(a){var s=a.closest("[role='columnheader']");if(s.attr("aria-sort","none"),a.removeClass("isFilterable isFiltered sort-ascending sort-descending"),this.isColumnFilterable(i)&&a.addClass("isFilterable"),D.value(i.IsFiltered)&&a.addClass("isFiltered"),-1<D.value(i.SortDirection)&&D.value(i.IsPrimarySort)){var l=D.util.enumName(D.value(i.SortDirection),D.ui.SortDirection);s.attr("aria-sort",l),a.addClass("sort-"+l)}}}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},A.prototype.renderReactList=function(){var e,t,o,n;if(this.element&&!this.pauseRendering){var i=!1;if(this._parent){var r=D.value(this._parent.ExtendedStyle);i="listPanel_selPanel"===r||"listPanel_availPanel"===r}var a,s,l=this.getActiveRowIndex(),u=this.Root&&this.Root.element;u&&u.classList.contains("lookup-popup")?a=this.LookupRootStyle:this.element.parentElement&&this.element.parentElement.classList.contains("section-container")&&(a=this.InsideFastTabStyle),this.element.classList.contains("right-splitter")&&(a=a?D.util.objectAssign({},a,this.RightSplitterStyle):this.RightSplitterStyle),this.element.classList.contains("bottom-splitter")&&(a=a?D.util.objectAssign({},a,this.BottomSplitterStyle):this.BottomSplitterStyle),u&&!u.classList.contains("lookup-popup")&&(a=a?D.util.objectAssign({},a,this.GridStyle):this.GridStyle);var d=D.value(this.GridLines);this.Root&&(s=!D.value(this.Root.IsInViewMode));var c,p=this.gridOrAnyChildEditable();switch(d){case D.ui.GridLines.None:c=0;break;case D.ui.GridLines.All:c=2;break;case D.ui.GridLines.Vertical:c=1;break;default:c=p&&s?2:0}var h,m=!1;this.element.parentElement&&this.element.parentElement.parentElement&&this.element.parentElement.parentElement.classList.contains("SidePanel")&&(m=!0);var v,g="";if(this._parent&&(h=D.value(this._parent.LayoutArrangeMethod),g=D.value(this._parent.Columns),v=D.value(this._parent.LayoutWidth),"number"!=typeof g&&g!==D.layout.Columns.balanced&&g!==D.layout.Columns.fill&&g!==D.layout.Columns.limitHeight)){var y=parseInt(g,10);isNaN(y)||(g=y)}var f=D.value(this.LayoutWidth),b="Manual",C=parseInt(f,10);if(isNaN(C)){if(C=void 0,"SizeToAvailable"==(b=f===D.layout.Size.available?"SizeToAvailable":"SizeToContent")){var w=!1;this.element.classList.contains("fill-width")||(w=!0),!w&&g&&"number"==typeof g&&h===D.layout.ArrangeMethod.vertical&&v===D.layout.Size.content&&(w=!0),w&&(this.WidthOverride._current=!0,b="SizeToContent")}}else{var _=0;null==(F=null===(t=null===(e=window.ControlLibrary)||void 0===e?void 0:e.ThemeManager.instance.getCurrentTheme())||void 0===t?void 0:t.units.margin)&&(F=0),a?(_=void 0===a.marginRight?F:a.marginRight,_+=void 0===a.marginLeft?F:a.marginLeft):F&&(_+=2*F),C-=_}var S=D.value(this.LayoutHeight),I="Manual",T=parseInt(S,10);if(isNaN(T)){T=void 0,I=S===D.layout.Size.available?"SizeToAvailable":"SizeToContent";var x=!1;!g||g!==D.layout.Columns.fill&&g!==D.layout.Columns.balanced&&h!==D.layout.ArrangeMethod.horizontalWrap||(x=!0),x||"SizeToAvailable"===I&&!D.value(this.HeightOverride)||(x=!0),x&&(this.HeightOverride._current=!0,I="SizeToContent")}else{var F,k=0;null==(F=null===(n=null===(o=window.ControlLibrary)||void 0===o?void 0:o.ThemeManager.instance.getCurrentTheme())||void 0===n?void 0:n.units.margin)&&(F=0),a?(k=void 0===a.marginTop?F:a.marginTop,k+=void 0===a.marginBottom?F:a.marginBottom):F&&(k+=2*F),T-=k}if(D.value(this.Mode)===D.ui.ListMode.tabular&&this.gridCounts&&D.value(this.FooterShown)){var P=void 0;for(var R in this.gridCountVersions)if(this.gridCountVersions[R]()){var M=this.getCalculatedColumnCounts();P={ColumnCounts:M.columnCounts,DisplaceColumnCount:M.displaceColumnCount};break}P&&(this.gridCounts=D.util.objectAssign({},this.gridCounts,P))}var E=0;i&&("SizeToAvailable"!==I&&(T=9*D.ui.theme.getUnitValue("gridUnit"),I="Manual"),D.length(this.DataSource)<=0&&(C=D.ui.theme.getUnitValue("columnSize"),b="Manual"),E=D.ui.theme.getUnitValue("columnSize"));var N=D.isServerBoundDataSource(this.DataSource);ReactDOM&&ReactDOM.render(React.createElement(D.reactGrid.UI.ReactGrid,{ActiveRowIndex:l,AllowColumnReorder:!(!this.Root||!D.value(this.Root.AllowExplicitPersonalization)),AllowEdit:p,AllowExtendedAggregation:A.extendedAggregationEnabled(),AllowMultipleMarking:D.util.stringToBoolean(D.value(this.IsMarkingEnabled)),AllowTotals:this.calculatedAllowTotals,AllRowsMarked:D.util.stringToBoolean(D.value(this.MarkAllRecords)),CardId:this.cardId,ClassName:D.value(this.ExtendedStyle),CollectionData:this.getCollectionDataPropValue(),CollectionDataLengthOffset:this.groupingManager.collectionLengthOffset(),CollectionDataVersion:this.dataVersion,ColumnInfo:this.columnInfo,DataId:N?D.reactGrid.MASTERTRACKINGID:void 0,DefaultControl:this.defaultControlName,Enabled:D.value(this.Enabled),EnableInfiniteScroll:D.value(this.InfiniteScroll),EnableLostKeyPrevention:A.lostKeyPreventionEnabled(),EnablePaging:this.enablePaging(),EnhancedTabSequence:D.util.isEnhancedTabSequenceEnabled(),FooterInitiallyShown:D.value(this.FooterShown),ForceNavigationAction:D.value(this.ForcePrimaryNavigation),GetGridOptions:this.getGridOptions,GetNextPage:this.getNextPage,GetPreviousPage:this.getPreviousPage,GetRowData:this.getRowData,GridCounts:this.gridCounts,GridLines:c,GridOptionsClose:this.gridOptionsClose,GroupingColumnWidth:D.value(this.GroupingColumnWidth),HasFixedChild:this.hasFrozenChild,HasGrouping:this.hasGrouping(),HasNextPage:this.hasNextPage(),HasPreviousPage:this.hasPreviousPage(),Height:T,HeightMode:I,HideSelection:D.util.stringToBoolean(D.value(this.HideSelection)),Id:this.getUniqueId(),IsInSidePanel:m,IsTabbingContainer:this.syncManager.RailsMode,IsTileCard:this.isTileCard,Label:D.value(this.Label),LoadDirection:this.dataCache.LastReceivedLoadDirection,LoadingMessage:this.loadingMessage,MarkedSelectedVersion:this.markedSelectedVersion,MinWidth:E,Mode:D.value(this.Mode),Name:this.Name,NavigationAction:this.executeAction,NavigationEnabled:D.util.stringToBoolean(D.value(this.NavigationEnabled)),NoResultsMessage:this.noResultsMessage,OnColumnFocus:this.columnFocus,OnColumnMouseEnter:this.columnMouseEnter,OnColumnReorder:this.columnMove,OnColumnResize:this.columnResize,OnColumnSelected:this.columnSelected,OnCopy:this.onCopy,OnFooterVisibilityChange:this.footerVisibilityChange,OnGroupHeaderClick:this.toggleGroupExpandCollapse,OnHeaderFocus:this.headerFocus,OnKeyDown:this.onKeyDown,OnLastRowArrowDown:this.lastRowArrowDown,OnMouseEnter:this.mouseEnter,OnMouseLeave:this.mouseLeave,OnPaste:this.onPaste,OnRangeSelection:this.onRangeSelected,OnRequestAddTotalColumn:this.requestAddTotalColumn,OnRequestGroupTotals:this.requestGroupTotals,OnRequestRemoveTotalColumn:this.requestRemoveTotalColumn,OnRequestTotals:this.requestTotals,OnRowChange:this.changeRow,OnRowClicked:this.onRowClicked,OnScrollEnd:this.scrollEnd,OnScrollStart:this.scrollStart,OnSyncCellClicked:this.onSyncCellClicked,OnSyncCellHover:this.onSyncCellHover,PageBufferFactor:this.dataCache.PageBufferFactor,PageSize:this.dataCache.PageSize<D.length(this.DataSource)?this.dataCache.PageSize:D.length(this.DataSource),PersonalizationMode:this.personalizationMode,PostRender:this.postRender,PreviousDataId:N?D.reactGrid.OLD_MASTERTRACKINGID:void 0,RecalculateSize:this.recalculateSize,RowsMarkedByDefault:D.value(this.RowsMarkedByDefault),SetRef:this.setRef,ShowHeader:D.value(this.IsHeaderVisible),ShowMarkingColumn:D.value(this.IsSelectionIndicatorVisible),Style:a,ThemeVersion:this.themeVersion,ToggleMark:this.toggleMark,ToggleMarkAll:this.toggleMarkAll,Type:"ReactGrid",VisibleColumnCount:D.value(this.VisibleColumnCount),VisibleRowCount:D.value(this.VisibleRowCount),Width:C,WidthMode:b}),this.RenderTarget)}},A.prototype.findSyncingColumn=function(e){var t=e.target,o=!1;if(t)do{if(t.classList&&t.classList.contains("dyn-syncingColumn")){o=!0;break}t=t.parentElement}while(t&&t!==document.body);return o?t:void 0},A.prototype.IsInsidePreviewForm=function(){return!(!this.Root||!this.Root.IsPreviewForm)},A.prototype.ExecuteExportToExcel=function(e){D.callFunction(this.ExportToExcel,this,e)},A.prototype.formActiveRowChangedNotify=function(){if(D.util.isInZoomWidthMode()&&this.isElementInSidePanel()){var e=this.Root.SidePanel;e&&e.SidePanelElement&&D.context(e.SidePanelElement).Visible&&e.toggleVisibility()}},A.prototype.isElementInSidePanel=function(){return void 0===this.elementInSidePanel&&(this.elementInSidePanel=!1,this.element&&this.element.parentElement&&this.element.parentElement.parentElement&&this.element.parentElement.parentElement.classList.contains("SidePanel")&&(this.elementInSidePanel=!0)),this.elementInSidePanel},A.prototype._getListRowChangeShortCutDescription=function(e,t){return D.controls.List.prototype._getListRowChangeShortCutDescription.call(this,e,t)},A.prototype._getListControlSpaceShortCutDescription=function(){var e=D.label("Grid_CurrentRowSelectionShortcut"),t=D.isServerBoundDataSource(this.DataSource);return this.getRowMark(this.getActiveRowCollectionIndex(),t)&&(e=D.label("Grid_CurrentRowClearShortcut")),e},A.prototype._getListMarkAllShortCutDescription=function(){var e=D.label("Grid_SelectAllRowsShortcut");return D.value(this.MarkAllRecords)&&(e=D.label("Grid_ClearAllRowsShortcut")),e},A);function A(e,t,o,n){var F=m.call(this,e,t,o,n)||this;F.LayoutMinWidth={minSizeFunction:D.layout.gridLayoutMinWidth,cssClassArgument:"react-listRoot"},F.LayoutMinHeight={minSizeFunction:D.layout.gridLayoutMinHeight,cssClassArgument:"react-listRoot"},F.addColumns=function(){D.callFunction(F.ExecutePersonalizationCommand,F,["SelectForAdd"])},F.focusIn=function(e){e&&e.target&&F.getRowIndexFromElement(e.target)!==F.getRowIndexFromTrackingId(D.value(F.SelectedRowTrackingId))&&e.stopImmediatePropagation()},F.keyUp=function(e){!F.gridOrAnyChildEditable()&&D.util.isShortcutKeyPressed(e,{isCtrlKeyAgnostic:!0,isShiftKeyAgnostic:!0,keyCode:[D.ui.KeyCodes.upArrow,D.ui.KeyCodes.downArrow,D.ui.KeyCodes.pageUp,D.ui.KeyCodes.pageDown]})&&(D.InsideTestWrapper?F.syncManager.processLastQueuedRowChange():(F.keyUpProcessingDebounce&&F.keyUpProcessingDebounce.cancel(),F.keyUpProcessingDebounce=D.async(function(){F.syncManager.processLastQueuedRowChange(),F.keyUpProcessingDebounce=void 0},10,"Debounce keyup in to mimic control lib grid")))},F.keyDown=function(e){D.util.handleShortcuts(F,e)},F.mouseDown=function(e){var t=0,o=!1,n=function(){o&&(D.shell.endExtendedEventLoop(),o=!1),t&&(window.clearTimeout(t),t=0)},i=function(){n(),window.removeEventListener("mouseup",i,!0)};o||(D.shell.startExtendedEventLoop(),o=!0),t&&window.clearTimeout(t),t=window.setTimeout(n,5e3),window.addEventListener("mouseup",i,!0)},F.showFooter=function(){F.setFooterShown(!0)},F.hideFooter=function(){F.setFooterShown(!1)},F.requestRemoveTotalColumn=function(e,t){if(F.countsExcludedControls[e]=!0,Object.keys(F.gridCountVersions).length)for(var o in F.gridCountVersions)F.gridCountVersions.hasOwnProperty(o)&&(delete F.gridCountVersions[o],F.gridCountVersions[o]=function(){return!0});else F.gridCounts&&F.gridCounts.ColumnCounts&&(F.gridCounts=D.util.objectAssign({},F.gridCounts,{ColumnCounts:F.getEmptyColumnCounts()}));F.updateColumnTotalShown(e,!1),F.postRenderCallbacks.push(function(){t&&t()}),F.renderReactListAsync()},F.requestAddTotalColumn=function(e,t,o,n){if(void 0===o&&(o=!0),void 0===n&&(n="Sum"),delete F.countsExcludedControls[e],Object.keys(F.gridCountVersions).length)for(var i in F.gridCountVersions)F.gridCountVersions.hasOwnProperty(i)&&(delete F.gridCountVersions[i],F.gridCountVersions[i]=function(){return!0});else F.gridCounts&&F.gridCounts.ColumnCounts&&(F.gridCounts=D.util.objectAssign({},F.gridCounts,{ColumnCounts:F.getEmptyColumnCounts()}));F.updateColumnTotalShown(e,!0),F.updateColumnTotalType(e,n),o&&(F.postRenderCallbacks.push(function(){t&&t()}),F.renderReactListAsync())},F.requestTotals=function(t){function e(){var e=F.getCalculatedColumnCounts();F.gridCounts={ColumnCounts:e.columnCounts,DisplaceColumnCount:e.displaceColumnCount,IsPartialCount:!!F.IsSizeLimited(),MarkedRowCount:F.gridCounts&&F.gridCounts.MarkedRowCount,RowCount:F.DisplayRowCount()},F.postRenderCallbacks.push(t),F.renderReactListAsync(),F.telemetryEventArgs.totals=D.telemetry.addControlActionEvent(F,F.telemetryEventArgs.totals,D.telemetry.ActionEvents.gridRequestTotals,{},!0),F.createdRetreivalDialog&&(D.shell.dialogBack(),F.createdRetreivalDialog=!1)}F.MayHaveMoreDataAboveOrBelow()?(F.createRetreivalDialog(t),F.getAllData(e)):Object.keys(F.gridCounts.ColumnCounts).length?e():t&&t()},F.requestGroupTotals=function(e,t){function o(){F.retrievingGroupData&&(D.setValue(F,"dataRetrievalProgressText",D.format(D.label("Grid_RowProcessed"),D.length(F.DataSource))),window.setTimeout(function(){F.furtherRequestGroupTotals(n,t)}))}var n=F.groupingManager.getTrackingIdFromRowIndex(e);F.retrievingGroupData||(F.retrievingGroupData=!0,F.dataCache.turnOffFastFetch(),F.createRetreivalDialog(t),F.groupingManager.isFirstGroup(n)&&D.value(F.HasPreviousPage)?window.setTimeout(function(){F.getPreviousPage(null,o)}):F.groupingManager.isLastGroup(n)&&D.value(F.HasNextPage)&&window.setTimeout(function(){F.getNextPage(null,o)}))},F.freezeColumn=function(e,t){var o,n,i=F.getColumnInfo(e);if(i){var r="";try{for(var a=__values(F.columnInfo),s=a.next();!s.done;s=a.next()){var l=s.value;if(l&&i._name!==l._name){if(!D.value(l.IsFrozen))break;r=l._name}}}catch(e){o={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}if(F.columnNameToInfoIndex[i._name]!==(r?F.columnNameToInfoIndex[r]+1:0)){var u=F.Name+",";r&&(u+=r),D.callFunction(i.ExecutePersonalizationCommand,i,["SelectForMove"]),D.callFunction(i.ExecutePersonalizationCommand,i,["MoveControl",u])}t!==D.value(i.IsFrozen)&&(D.setValue(i,"IsFrozen",t),D.callFunction(i.UpdateIsFrozen,i,[t]))}},F.changeRow=function(e,t,o,n){if(e<0)return e;var i=F.getTrackingIdFromRowIndex(e);if(""===i)return e;var r=D.value(F.InternalSelectedRowTrackingId);if(i===r)return e;if(F.railsModeTimeout&&window.clearTimeout(F.railsModeTimeout),F.syncManager.RailsMode&&i===D.value(F.SelectedRowTrackingId))switch(F.syncManager.getRowSyncState(i)){case 3:F.railsModeTimeout=window.setTimeout(function(){F.syncManager.resume()},D.reactGrid.RAILS_MODE_TIMEOUT_DELAY);break;case 2:F.railsModeTimeout=window.setTimeout(function(){F.syncManager.RailsMode=!1},D.reactGrid.RAILS_MODE_TIMEOUT_DELAY)}var a,s=o,l=D.value(F.DataSource),u=D.isServerBoundDataSource(F.DataSource),d=F.groupingManager.rowIndexToCollectionIndex(e),c=F.groupingManager.isGroupHeaderTrackingId(i);if(c||F.groupingManager.clearActiveGroup(),c){if(s===D.controls.List.MarkMode.select)s=D.controls.List.MarkMode.clearMark;else if(s===D.controls.List.MarkMode.rangeSelect||s===D.controls.List.MarkMode.rangeExpansion)s=D.controls.List.MarkMode.none;else if(s===D.controls.List.MarkMode.toggle){var p=F.groupingManager.getGroupStartCollectionIndex(i);a={endIndex:F.groupingManager.getGroupEndCollectionIndex(i),newIsMarked:1!==F.groupingManager.getGroupHeaderData(e,D.reactGrid.ISMARKED_NAME),startIndex:p}}}else s!==D.controls.List.MarkMode.select&&s!==D.controls.List.MarkMode.none&&(parseInt(i,10)<0||F.syncManager.hasDataInteractions()||F.syncManager.IsPaused)&&(s=D.controls.List.MarkMode.select);var h=F.getRowIndexFromTrackingId(r),m=F.groupingManager.rowIndexToCollectionIndex(h),v=r,g=h,y=F.groupingManager.isGroupHeaderTrackingId(r),f=m;if(F.rangeSelection){var b=!1;if(F.rangePivotTrackingId){var C=F.getRowIndexFromTrackingId(F.rangePivotTrackingId);-1<C?(v=F.rangePivotTrackingId,g=C,y=F.groupingManager.isGroupHeaderTrackingId(v),f=F.groupingManager.rowIndexToCollectionIndex(g)):b=!0}else b=!0;b&&F.clearRangeSelection()}if(y){p=F.groupingManager.getGroupStartCollectionIndex(v);(!(g<e)||(f=p)===d&&0<p)&&(f=p-1),v=F.getTrackingIdFromCollectionIndex(f)}if(D.value(F.PreemptiveClient)){switch(F.setInternalSelectedRow(i,r),!u||c&&s!==D.controls.List.MarkMode.toggle&&s!==D.controls.List.MarkMode.clearMark||F.setClientMarking(!0),s){case D.controls.List.MarkMode.select:if(-1<m&&l[m]&&F.getRowMark(m,u)&&F.setRowMark(m,!1,u),u&&0===F.getMarkedRowCount())F.setRowMark(d,!0,u);else for(var w=0;w<D.length(l);w++)F.setRowMark(w,w===d,u);F.clearRangeSelection();break;case D.controls.List.MarkMode.toggle:if(c)for(var _=a.startIndex;_<=a.endIndex;_++)F.setRowMark(_,a.newIsMarked,u);else F.setRowMark(d,!F.getRowMark(d,u),u);break;case D.controls.List.MarkMode.rangeSelect:F.rangeSelection||(F.rangeSelection=!0,F.rangePivotTrackingId=r);case D.controls.List.MarkMode.rangeExpansion:var S=void 0,I=void 0;if(I=d<f?(S=d,f):(S=f,d),s===D.controls.List.MarkMode.rangeSelect)for(w=0;w<D.length(l);w++)F.setRowMark(w,S<=w&&w<=I,u);else for(_=S;_<=I;_++)F.setRowMark(_,!0,u);break;case D.controls.List.MarkMode.clearMark:if(-1<m&&F.getRowMark(m,u)&&F.setRowMark(m,!1,u),!u||0<F.getMarkedRowCount())for(_=0;_<D.length(l);_++)F.setRowMark(_,!1,u);F.clearRangeSelection()}F.markedSelectedVersion++,F.renderReactListSync()}else F.legacyBehaviorPendingRow=i;if(c){if(s===D.controls.List.MarkMode.toggle){var T=F.getTrackingIdFromCollectionIndex(a.startIndex),x=F.getTrackingIdFromCollectionIndex(a.endIndex);F.syncManager.markGroup(T,x,a.newIsMarked)}else s===D.controls.List.MarkMode.clearMark&&F.syncManager.unmarkAll();F.syncManager.queueSaveIfNeeded(v)}else F.syncManager.changeRow(i,s,v,n,t);return n===D.ui.InputType.keyboard&&F.scrollPopupToShowRow(e),n===D.ui.InputType.mouse&&F.formActiveRowChangedNotify(),d},F.postRender=function(){var t,e;if(F.element&&F.element.parentElement&&D.value(F.LayoutWidth)===D.layout.Size.content){var o=F.element.clientWidth;F.previousWidth!==o&&(F.previousWidth=o,F.gridInitiatedArrange=!0,D.layout.arrange(F.element.parentElement,!0,!1))}F.updateFilterSortClasses(),F.Root&&F.Root.controlRenderComplete&&F.Root.controlRenderComplete(F.Name),F.postRenderTimeout&&window.clearTimeout(F.postRenderTimeout);var n=F.isScrolling?200:0;F.postRenderTimeout=window.setTimeout(function(){var e,t;if(F.postRenderTimeout=void 0,F.Root){var o=D.value(F.Root.ActiveControl),n=F.getColumnInfo(o);if(n&&F.Root.TakeFocus&&F.Root.isFormActive()&&F.Root.isInActiveFocusRegion()&&(null===(t=null===(e=D.ui.getNavBar())||void 0===e?void 0:e.isFocused)||void 0===t||!t.call(e))&&F.ControlLibGridRef&&(!F.ControlLibGridRef.hasFocus()||document.activeElement===document.body)){var i=!!F.activeColumnHeaderPopup&&F.activeColumnHeaderPopup.contains(document.activeElement),r=Boolean(document.activeElement.closest(".formPersonalization-popup")),a=Boolean(document.activeElement.closest(".ScrollbarLayout_main"));if(!i&&!r&&!a){F.scrollColumnIntoViewIfNeeded(o,function(){D.log.focus&&D.log.focus("React Grid (%s): post render focus fix",F.Name);var e=F.ControlLibGridRef.hasFocus();F.ControlLibGridRef.setSkipResetScrollTopOnFocus(!0),(n.ReferenceGroup?F.ControlLibGridRef.focusChildOfColumn(n.ReferenceGroup.Name,o):F.ControlLibGridRef.focusColumn(o))?(F.Root.updateActiveElement(document.activeElement),e||F.ControlLibGridRef.selectActiveCell()):D.log.focus&&D.log.focus("React Grid (%s): post render unable to set focus",F.Name)})}}}if(F.element&&F._parent&&D.value(F._parent.LayoutHeight)===D.layout.Size.content){var s=F.element.clientHeight;F.previousHeight!==s&&(F.previousHeight=s,F._parent.element&&F._parent.element.parentElement&&D.ui.updateBlock(F._parent.element.parentElement,function(){F.gridInitiatedArrange=!0},F))}},n);try{for(var i=__values(F.postRenderCallbacks),r=i.next();!r.done;r=i.next()){(0,r.value)()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}F.postRenderCallbacks=[],!D.value(F.InfiniteScroll)||D.flags.disableFastFetch||F.dataCache.isFastFetchOn()||F.dataCache.getFastFetchOffReason()!==S.FastFetchOffReason.invisibleGrid||F.dataCache.turnOnFastFetch()},F.expandAllGroups=function(){F.groupingManager.expandCollapseAllGroups(!0),F.collapseNewGroups=!1},F.collapseAllGroups=function(){F.groupingManager.expandCollapseAllGroups(!1),F.setInternalSelectedRow(F.groupingManager.getActiveGroupTrackingId(),D.value(F.InternalSelectedRowTrackingId)),F.collapseNewGroups=!0},F.toggleGroupExpandCollapse=function(e){F.groupingManager.toggleGroupExpandCollapse(e),F.dataVersion++,F.getActiveRowIndex()===e?(F.markedSelectedVersion++,F.renderReactListSync()):F.changeRow(e,"groupByColumn",4,D.ui.InputType.mouse)},F.getRowData=function(e,t,o){if(!(e<0||e>=D.length(F.DataSource)+F.groupingManager.collectionLengthOffset())){if(F.groupingManager.isGroupHeader(e))return F.groupingManager.getGroupHeaderData(e,t,o);var n=F.groupingManager.rowIndexToCollectionIndex(e);return F.getCollectionData(n,t,o)}D.log.reactList&&D.log.reactList("ReactList: Trying to get data for invalid row index")},F.gridOptionsClose=function(e){return!e||!e.endsWith(p)&&!e.endsWith(c)},F.getGridOptions=function(){var e,t;if(!F.gridOptions){F.gridOptions=[];var o=D.ui.theme.get(),n={":hover":{backgroundColor:o.appBarPressed},borderColor:"transparent",color:o.fieldTextColor,font:o.defaultFont};D.value(F.AllowPersonalization)&&F.Root&&D.value(F.Root.AllowExplicitPersonalization)&&!F.Root.isPopup()&&F.gridOptions.push(F.getAddColumnButton(n)),F.gridOptions.push(F.getFooterButton(n)),A.bulkEditEnabled()&&(F.calculatedAllowEdit||D.value(null===(e=F.Root)||void 0===e?void 0:e.IsInViewMode)&&D.value(null===(t=F.Root)||void 0===t?void 0:t.CanSwitchViewMode))&&F.gridOptions.push(F.getBulkEditButton(n)),F.groupingManager.hasGrouping()&&(F.gridOptions.push(F.getGroupHeaderLabelButton(n)),F.gridOptions.push(F.getExpandAllGroupsButton(n)),F.gridOptions.push(F.getCollapseAllGroupsButton(n)),F.gridOptions.push(F.getUngroupAllButton(n)))}return F.gridOptions},F.ungroupAll=function(){F.groupingManager.group(null)},F.toggleGroupHeaderLabel=function(){F.resetGroupingGridOptions();var e=!D.value(F.ShowGroupHeaderLabel);D.setValue(F,"ShowGroupHeaderLabel",e),D.callFunction(F.UpdateShowGroupHeaderLabel,F,[e])},F.bulkEditRequestTotalsCallback=function(e){e||F.bulkEdit()},F.bulkEdit=function(){F.MayHaveMoreDataAboveOrBelow()&&D.value(F.RowsMarkedByDefault)?F.requestTotals(F.bulkEditRequestTotalsCallback):F.Root&&D.value(F.Root.IsInViewMode)&&D.value(F.Root.CanSwitchViewMode)?F.Root.executeShortcuts(!0,"ViewEdit",void 0,function(){D.observe(F.HasRenderCallPending,function(e){if(!e)return F.calculatedAllowEdit&&F.openBulkEditLightBox(),!1})}):F.openBulkEditLightBox()},F.openBulkEditLightBox=function(){F.telemetryEventArgs.bulkEdit=D.telemetry.addControlActionEvent(F,F.telemetryEventArgs.bulkEdit,D.telemetry.ActionEvents.gridBulkEdit,{},!0),F.bulkEditLightBox=D.showBulkEditLightBox(F.getEditFieldsForBulkEdit(),F.applyMultipleEdits,F.onBulkEditLightBoxClose),F.bulkEditLightBoxOpen=!0},F.onBulkEditLightBoxClose=function(){F.bulkEditLightBoxOpen=!1,F.bulkEditLightBox=null},F.applyMultipleEdits=function(e){var t,o,n,i;if(0<e.length){var r=F.getMarkedRowIndexes();if(0===r.length&&0<=F.getActiveRowIndex()&&r.push(F.getActiveRowIndex()),0<r.length){F.syncManager.IsPaused=!0,F.syncManager.RailsMode=!0;var a=F.getActiveRowIndex(),s=F.activeColumnName,l=F.getColumnInfo(e[0].ColumnName),u=l.ReferenceGroup?l.ReferenceGroup.Name:l.Name;F.pauseRendering=!0;try{for(var d=__values(r),c=d.next();!c.done;c=d.next()){var p=c.value;F.changeRow(p,u,4,D.ui.InputType.notSpecified);try{for(var h=(n=void 0,__values(e)),m=h.next();!m.done;m=h.next()){var v=m.value,g=F.getColumnInfo(v.ColumnName);if(g){var y={RowIndex:p};"ComboBox"===g.TypeName?g.SetSelectedItemInternal(v.FieldValue,y):g.SetValueInternal&&g.SetValueInternal(v.FieldValue,y),g.ReferenceGroup&&g.ReferenceGroup.ResolveChangesInternal(y)}}}catch(e){n={error:e}}finally{try{m&&!m.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(o=d.return)&&o.call(d)}finally{if(t)throw t.error}}F.changeRow(a,s,4,D.ui.InputType.notSpecified),F.pauseRendering=!1,F.dataVersion++,F.renderReactListAsync(),F.syncManager.showPastePrompt()}}},F.onKeyDown=function(e,t){if(!e.isPropagationStopped||!e.isPropagationStopped())if(D.util.isShortcutKeyPressed(e.nativeEvent,{ctrl:!0,keyCode:D.ui.KeyCodes.f10}))D.contextMenu.openContextMenuHandler(e.nativeEvent,!0),e.stopPropagation&&e.stopPropagation();else if(D.util.isShortcutKeyPressed(e.nativeEvent,{alt:!0,keyCode:D.ui.KeyCodes.upArrow}))F.previewValue=t.Value,D.shell.previewManager.enhancedPreviewShortcutHandler(F.getLiveControl(e.target),e.nativeEvent),e.stopPropagation&&e.stopPropagation();else if(D.util.isShortcutKeyPressed(e.nativeEvent,{keyCode:D.ui.KeyCodes.enter})){F.performKeyDownNavigationAction(F.getLiveControl(e.target),e);F.formActiveRowChangedNotify()}},F.lastRowArrowDown=function(e,t){if(D.value(F.AllowCreateOnKeyDown)){var o=D.value(F.InternalSelectedRowTrackingId),r=F.Root&&F.Root.Id,a="-1";if(D.value(F.PreemptiveClient)&&D.serverForm&&D.isServerBoundDataSource(F.DataSource)){a=F.DataSource.__boundDataSource.generateClientTrackingId().toString();var n,i=D.length(F.DataSource.__boundDataSource.items)-1,l=F.DataSource.__boundDataSource.items()[i];n=l.getValue(D.reactGrid.PARENT_GROUP_KEY);var s,u=F.DataSource.__boundDataSource.id;if(F.modelCollectionIds.forEach(function(e){var t={Id:a,Item:{Id:a,Properties:{_RESERVED_ForceEdit:!0,MasterTrackingId:a}}},o=D.serverForm.ModelManager.getModelCollection(e,r);if(o){o.clientMarking(!0);var n=D.value(o.items)[D.length(o.items)-1];n&&(n.isSelected=!1,n.isMarked=!1);var i=o.deserializeModel(t,D.length(o.items),r);o.numberOfClientRows++,D.isObservableArray(o.items)&&o.items.push(i),i.isSelected=!0,i.isMarked=!1,e===u&&(s=i)}}),s&&n&&F.groupingManager.addNewRow(s,n),F.markedSelectedVersion++,F.dataVersion++,F.ControlLibGridRef&&(F.ControlLibGridRef.recalculateScrollTop(),A.lostKeyPreventionEnabled())){if(l&&F.ControlLibGridRef.getActiveRowId&&l.masterTrackingId!==F.ControlLibGridRef.getActiveRowId()&&F.ControlLibGridRef.getLostKeysForRecord){var d=F.ControlLibGridRef.getLostKeysForRecord(l.masterTrackingId);d&&d.forEach(function(e,t){var o,n,i=F.getColumnInfo(t);if(i){var r={RowIndex:F.getRowIndexFromTrackingId(l.masterTrackingId)},a=F.ControlLibGridRef.getActiveCellRef(t),s={valid:!0,messages:[]};a&&a.validator&&(s=a.validator(e)),s.valid&&null!==(o=i.SetValueInternal)&&void 0!==o&&o.call(i,e,r),null!==(n=i.SetValidityInternal)&&void 0!==n&&n.call(i,__assign(__assign({},s),{userValue:e}),r)}}),F.ControlLibGridRef.clearLostKeysForRecord(l.masterTrackingId)}F.ControlLibGridRef.handleKeysWhileRendering&&F.ControlLibGridRef.handleKeysWhileRendering(a)}F.renderReactListAsync();var c=D.value(F.ActiveControlOnCreate)||F.firstPotentialEditableColumn();if(c){F.scrollColumnIntoViewIfNeeded(c,function(){!F.ControlLibGridRef||c===F.activeColumnName&&c===F.ControlLibGridRef.getActiveColumnName()||F.ControlLibGridRef.focusColumn(c),F.Root&&F.Root.ActiveControl&&F.Root.ActiveControl(c)})}}F.syncManager.createRow(a,t,o,e)}},F.mouseEnter=function(e,t){if(!D.value(D.ax.formPersonalizationPane.formPersonalizationToolbar.Mode)){var o=F.groupingManager.rowIndexToCollectionIndex(t.RowIndex),n=D.value(F.DataSource)[o];if(n)if(D.isServerBoundDataSource(F.DataSource)){F.previewTrackingId=n.masterTrackingId;var i=parseInt(F.previewTrackingId,10);if(isNaN(i)||i<0)return}else F.previewTrackingId=n.MasterTrackingId;"ImageEdit"===t.Type||"ImageEditCell"===t.Type?F.previewValue=t.EncodedData:F.previewValue=t.Value,F.previewControlIsValid=!t.Validity||t.Validity.valid;var r=$(e.target).addBack().closest("[data-dyn-controlname]")[0];D.preview.tryOpenPreview(r,e.nativeEvent)}},F.mouseLeave=function(e,t){F.previewTrackingId=void 0,F.previewValue=void 0,F.previewControlIsValid=void 0;var o=$(e.target).addBack().closest("[data-dyn-controlname]")[0];if(!o){var n=t.RowIndex+1;D.value(F.IsHeaderVisible)&&n++,o=$(F.element).find("[aria-rowindex=".concat(n,"] [data-dyn-controlname='").concat(t.Name,"']"))[0]}D.preview.tryClosePreview(o,e.nativeEvent)},F.columnMouseEnter=function(e){D.superTooltip.tryOpenSuperTooltip(e.target)},F.headerFocus=function(e,t){var o;F.updateActiveColumn(t);var n=F.getColumnInfo(t);n&&null!==(o=F.Root)&&void 0!==o&&o.activateControl&&F.Root.activateControl(n,!0,!0),D.superTooltip.tryOpenSuperTooltip(e.target)},F.columnFocus=function(e,t,o){if(F.updateActiveColumn(t),o!==F.getRowIndexFromTrackingId(D.value(F.SelectedRowTrackingId))){var n=F.getTrackingIdFromRowIndex(o),i=parseInt(n,10);!isNaN(i)&&0<i&&F.syncManager.queueDependentRowAction(n,"selectCell",function(e){D.callFunction(F.SelectCell,F,[e,t,D.ui.InputType.notSpecified,!0])})}},F.onCopy=function(){if(0<=F.cellsRange.rowStart&&F.hasRangeSelection()){for(var e="",t=F.cellsRange.rowStart;t<=F.cellsRange.rowEnd;t++){if(-1!==F.groupingManager.rowIndexToCollectionIndex(t)){for(var o=F.cellsRange.columnStart;o<=F.cellsRange.columnEnd;o++){var n=F.columnInfo[o],i=0;if("ReferenceGroup"===n.TypeName)for(;i<D.length(n.ChildCols);)e+=n.ChildCols[i].copyForExcel({RowIndex:t}),i++;else e+=n.copyForExcel({RowIndex:t});o!==F.cellsRange.columnEnd&&(e+="\t")}t!==F.cellsRange.rowEnd&&(e+="\n")}}navigator.clipboard.writeText(e)}},F.onPaste=function(e){var t,o;if(D.value(F.AllowEdit)&&D.value(F.Enabled)&&e.clipboardData){var n=e.clipboardData.getData("text")||"";if(""===n)return;var i=Papa.parse(n,{delimiter:"\t"}),r=i.data;if(0<r.length)""===r[r.length-1].toString().trim()&&r.pop();if(r.length<=0)return;if(1===r.length){if(!Array.isArray(r[0])||r[0].length<=0)return;if(Array.isArray(r[0])&&1===r[0].length)return}else if(e.target&&"textarea"===e.target.type){if(1===i.errors.length&&"UndetectableDelimiter"===i.errors[0].code)return;if(-1===r.findIndex(function(e){var t;return Array.isArray(e)&&(1<e.length||(null===(t=e[0])||void 0===t?void 0:t.includes("\n")))}))return}e.preventDefault&&e.preventDefault();var a=F.getRowIndexFromTrackingId(D.value(F.InternalSelectedRowTrackingId));if(e.target){var s=D.ui.getLiveControl(e.target);if(s&&s.pasteFromExcel&&D.value(s.LookupButton)&&!1===D.value(s.ReplaceOnLookup)){var l="";if(1===r.length&&Array.isArray(r[0])&&0<r[0].length&&-1===r[0].findIndex(function(e){return e.includes(",")})?l=r[0].join(","):-1===r.findIndex(function(e){return!Array.isArray(e)||1!==e.length||e[0].includes(",")})&&(r.forEach(function(e){l+="".concat(e[0],",")}),l=l.slice(0,-1)),l)return void s.pasteFromExcel(l,{RowIndex:a})}}if(F.getActiveRowCollectionIndex()+r.length>=D.length(F.DataSource)&&D.value(F.HasNextPage))return F.dataCache.turnOffFastFetch(),void F.getNextPage(null,function(){return F.onPaste(e)});F.telemetryEventArgs.pasteFromExcel=D.telemetry.addControlActionEvent(F,F.telemetryEventArgs.pasteFromExcel,D.telemetry.ActionEvents.gridPasteFromExcel,{},!0),F.syncManager.IsPaused=!0,F.syncManager.RailsMode=!0;var u=F.columnNameToInfoIndex[F.activeColumnName],d=a,c=!1;F.pauseRendering=!0;for(var p=0;p<r.length;p++){F.groupingManager.isGroupHeader(a)&&(F.groupingManager.getGroupIsCollapsed(F.getTrackingIdFromRowIndex(a))&&F.groupingManager.toggleGroupExpandCollapse(a),F.changeRow(++a,F.columnInfo[u].DataSourceName,4,D.ui.InputType.keyboard));var h=r[p],m=0,v=0;try{for(var g=(t=void 0,__values(h)),y=g.next();!y.done;y=g.next()){var f=y.value,b=u+m;if(!(b<F.columnInfo.length)){c=!0;break}var C=F.columnInfo[b],w=!0;"ReferenceGroup"===C.TypeName?(w=!1,C.ChildCols[v].pasteFromExcel(f,{RowIndex:a}),++v>=D.length(C.ChildCols)&&(C.pasteFromExcel({RowIndex:a}),w=!(v=0))):C.pasteFromExcel&&C.pasteFromExcel(f,{RowIndex:a}),w&&m++}}catch(e){t={error:e}}finally{try{y&&!y.done&&(o=g.return)&&o.call(g)}finally{if(t)throw t.error}}if(p<r.length-1)if(F.groupingManager.rowIndexToCollectionIndex(a)<D.length(F.DataSource)-1)F.changeRow(++a,F.columnInfo[u].DataSourceName,4,D.ui.InputType.keyboard);else{if(!D.value(F.AllowCreateOnKeyDown))break;F.lastRowArrowDown(F.columnInfo[u].Name,D.controls.List.MarkMode.none),a++}}F.changeRow(d,F.columnInfo[u].DataSourceName,4,D.ui.InputType.keyboard),F.pauseRendering=!1,F.dataVersion++,F.renderReactListAsync(),c&&D.warn({Message:D.label("ReactGrid_PastedTooManyColumns")},F),F.syncManager.showPastePrompt()}},F.onRangeSelected=function(e,t,o,n){var i=!1;F.cellsRange.rowStart!==e&&(F.cellsRange.rowStart=e,i=!0),F.cellsRange.rowEnd!==t&&(F.cellsRange.rowEnd=t,i=!0);var r=F.columnNameToInfoIndex[o];F.cellsRange.columnStart!==r&&(F.cellsRange.columnStart=r,i=!0);var a=F.columnNameToInfoIndex[n];F.cellsRange.columnEnd!==a&&(F.cellsRange.columnEnd=F.columnNameToInfoIndex[n],i=!0),i&&(F.markedSelectedVersion++,F.renderReactListAsync())},F.onRowClicked=function(e,t,o){var n=!0;if(D.value(F.Enabled)&&D.value(F.NavigationAction)){var i=!1;!D.value(F.AllowEdit)&&D.value(F.ForcePrimaryNavigation)?n=!(i=!0):D.value(F.NavigationEnabled)&&(F.IsCardList()||o===F.defaultControlName)&&(F.IsCardList()&&(i=!0),n=!1),i&&(F.executeAction(t),e&&(D.log.stopPropagation&&D.log.stopPropagation("ReactGrid - onRowClicked"),e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()))}if(n){var r=F.getColumnInfo(o);r&&D.value(r.IsHyperlink)&&(n=!0)}return n},F.executeAction=function(e){var t;void 0!==e&&(t=F.getTrackingIdFromRowIndex(e));function o(){var e,t;null!==(e=F.syncManager)&&void 0!==e&&e.RailsMode||(null!==(t=F.dataCache)&&void 0!==t&&t.turnOffFastFetch(),F.Root&&F.Root.updateLastClientSelectedControl&&F.Root.updateLastClientSelectedControl(),D.callFunction(F.NavigationAction,F))}var n=D.value(F.SelectedRowTrackingId);void 0!==t&&t!==n?F.syncManager.queueDependentRowAction(t,"navigationAction",o):o()},F.toggleMark=function(){var e,t=D.value(F.InternalSelectedRowTrackingId),o=F.getActiveRowIndex(),n=F.groupingManager.isGroupHeaderTrackingId(t);if(n){var i=F.groupingManager.getGroupStartCollectionIndex(t);e={endIndex:F.groupingManager.getGroupEndCollectionIndex(t),newIsMarked:1!==F.groupingManager.getGroupHeaderData(o,D.reactGrid.ISMARKED_NAME),startIndex:i}}if(D.value(F.PreemptiveClient)){var r=D.isServerBoundDataSource(F.DataSource);if(n)for(var a=e.startIndex;a<=e.endIndex;a++)F.setRowMark(a,e.newIsMarked,r);else{var s=F.getActiveRowCollectionIndex();F.setRowMark(s,!F.getRowMark(s,r),r)}F.markedSelectedVersion++,F.renderReactListSync()}if(n){var l=F.getTrackingIdFromCollectionIndex(e.startIndex),u=F.getTrackingIdFromCollectionIndex(e.endIndex);F.syncManager.markGroup(l,u,e.newIsMarked)}else D.value(F.SelectedRowTrackingId)!==t?F.syncManager.attachToggleMark(t,D.getFunction(F.ToggleMark).bind(F)):D.applyFunction(F.ToggleMark,F)},F.toggleMarkAll=function(){if(D.value(F.IsMarkingEnabled)){var e=!D.value(F.MarkAllRecords);if(D.value(F.PreemptiveClient)){D.setValue(F,"MarkAllRecords",e);var t=D.isServerBoundDataSource(F.DataSource);t&&F.setClientMarking(!0);for(var o=0;o<D.length(F.DataSource);o++)F.setRowMark(o,e,t);F.markedSelectedVersion++,F.renderReactListSync()}F.syncManager.toggleMarkAll(e)}},F.getNextPage=function(e,o){if(!D.value(F.InfiniteScroll)){var t=D.value(F.PageIndex);if(t<F.getLastPageIndex())return D.setValue(F,"PageIndex",t+1),F.dataVersion++,F.renderReactListAsync(),void(o&&o())}F.dataCache&&(F.dataCache.isFillingCache()?F.dataCache.onFastFetchComplete(function(e){F.dataCache.IsPrimary||e!==S.FastFetchOffReason.failure?o&&o():D.async(function(){var e,t;(null===(t=null===(e=F.Root)||void 0===e?void 0:e.isNavigationActiveForm)||void 0===t?void 0:t.call(e))&&F.dataCache&&F.dataCache.dataLoadNew(D.ui.ScrollDirection.down,o)})}):F.dataCache.dataLoadNew(D.ui.ScrollDirection.down,o))},F.getPreviousPage=function(e,o){if(!D.value(F.InfiniteScroll)){var t=D.value(F.PageIndex);if(0<t)return D.setValue(F,"PageIndex",t-1),F.dataVersion++,F.renderReactListAsync(),void(o&&o())}F.dataCache&&(F.dataCache.isFillingCache()?F.dataCache.onFastFetchComplete(function(e){F.dataCache.IsPrimary||e!==S.FastFetchOffReason.failure?o&&o():D.async(function(){var e,t;(null===(t=null===(e=F.Root)||void 0===e?void 0:e.isNavigationActiveForm)||void 0===t?void 0:t.call(e))&&F.dataCache&&F.dataCache.dataLoadNew(D.ui.ScrollDirection.up,o)})}):F.dataCache.dataLoadNew(D.ui.ScrollDirection.up,o))},F.columnResize=function(e,t){if("_GRID_groupByColumn"===e)D.setValue(F,"GroupingColumnWidth",t),F.groupingColumnWidthUpdate&&F.groupingColumnWidthUpdate.cancel(),F.groupingColumnWidthUpdate=D.async(function(){D.callFunction(F.PersistPersonalization,F,["GroupingColumnWidth",t]),F.groupingColumnWidthUpdate=void 0},100,"Update GroupingColumnWidth on resize",F);else{var o=F.getColumnInfo(e);if(o){var n=$(F.element).find(".dyn-headerCell[data-dyn-controlname='"+o._name+"']");F.isColumnFilterable(o)&&n.addClass("isFilterable"),-1<D.value(o.SortDirection)&&n.addClass("sort-"+D.util.enumName(D.value(o.SortDirection),D.ui.SortDirection)),D.isObservable(o.Width)?o.Width._current=t:o.Width=t,F.columnWidthUpdate&&F.columnWidthUpdate.cancel(),F.columnWidthUpdate=D.async(function(){D.callFunction(o.PersistPersonalization,o,["width",t]),F.columnWidthUpdate=void 0},100,"Updaing column width on resize",F)}}},F.scrollStart=function(){F.isScrolling=!0},F.scrollEnd=function(){F.isScrolling=!1},F.columnSelected=function(e){var t=F.getColumnInfo(e);if(F.ColumnPopups[e]&&D.value(F.ColumnPopups[e].show))F.ColumnPopups[e].show(!1);else if(F.isColumnFilterable(t)&&F.FilterManager){F.dataCache.turnOffFastFetch(),D.value(F.FilterExpressions[e])&&D.setValue(F.FilterExpressions,e,null);var o=$(F.element).find(".dyn-headerCell[data-dyn-controlname='"+e+"']");D.util.activateLoadingAnimation(o[0]),F.getFilterExpressions(e,!0).then(function(){F.createOrShowColumnHeaderPopup(t)})}},F.columnMove=function(e,t){var u=F.getColumnInfo(e);if(u){var d,c=F.getColumnInfo(t),p=F.Name,h=null==c?void 0:c._name;D.callFunction(u.ExecutePersonalizationCommand,u,["SelectForMove"],function(){var t,e;try{d=JSON.parse(D.value(F.Root.PersonalizationData))}catch(e){D.logNonFatalError("ReactGrid: Invalid form PersonalizationData encountered during column move")}if(c&&Array.isArray(d))try{for(var o=__values(d),n=o.next();!n.done;n=o.next()){var i=n.value,r=__read(i.split(","),2),a=r[0],s=r[1];if(s===c._name){p=a,h=s;break}}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}var l=p+",";h&&(l+=h),F.callingMove=!0,D.async(function(){D.callFunction(u.ExecutePersonalizationCommand,u,["MoveControl",l],function(){F.callingMove=!1})})})}},F.setRef=function(e){F.ControlLibGridRef=e},F.onSyncCellClicked=function(e,t,o){var n=F.findSyncingColumn(e);F.syncManager.syncCellClicked(t,n)},F.onSyncCellHover=function(e,t,o){var n=F.findSyncingColumn(e);F.syncManager.syncCellHover(t,n)},F.setFooterShown=function(e){F.ControlLibGridRef&&F.ControlLibGridRef.footerShouldShow&&F.ControlLibGridRef.footerShouldShow(e,function(){return F.footerVisibilityChange(e)})},F.footerVisibilityChange=function(e){D.setValue(F,"FooterShown",e),D.callFunction(F.UpdateFooterShown,F,[D.value(F.FooterShown)])},F.firstRender=!0,F.activeColumnName="",F.calculatedAllowEdit=!1,F.calculatedAllowTotals=!1,F.callingMove=!1,F.dataVersion=0,F.defaultControlName="",F.isContainer=!0,F.loadingMessage=D.label("Shell_LoadingTitle"),F.markedSelectedVersion=0,F.recalculateSize=0,F.requestingData=!1,F.themeVersion=0,F.isScrolling=!1,F.preemptiveClientInternal=!0,F.createdRetreivalDialog=!1,F.retrievingGroupData=!1,F.hasFrozenChild=!1,F.elementInSidePanel=void 0,F.rangeSelection=!1,F.rangePivotTrackingId="",F.collapseNewGroups=!1,F.formModelSubscriber=-1,F.bulkEditLightBoxOpen=!1,F.pauseRendering=!1,F.needToCalculateChildrenBeforeRender=!1,e&&void 0!==e.OverrideNoResultsMessage&&null!==e.OverrideNoResultsMessage?F.noResultsMessage=D.value(e.OverrideNoResultsMessage):F.noResultsMessage=D.label("List_NoResultsMessage"),F.HeightOverride=D.observable(!1),F.WidthOverride=D.observable(!1),F.cellsRange={},F.ColumnPopups={},F.countsExcludedControls={},F.dataSourceObservers={},F.relatedItemSubscribers={},F.FilterExpressions={},F.gridCountVersions={},F.missingFields={},F.columnInfo=[],F.columnNameToInfoIndex={},F.columnObservers=[],F.postRenderCallbacks=[],F.modelCollectionIds=[],F.telemetryEventArgs={},F.dataRetrievalProgressText=D.observable(""),F.creatingChildren=D.observable(!1),F.ConfirmedNoDataAbove=D.observable(!1),F.ConfirmedNoDataBelow=D.observable(!1),F.HasPreviousPage=D.computed(function(){return D.value(F.DataAbove)||!D.value(F.ConfirmedNoDataAbove)&&D.length(F.DataSource)<D.value(F.CacheSize)}),F.HasNextPage=D.computed(function(){return D.value(F.DataBelow)||!D.value(F.ConfirmedNoDataBelow)&&D.length(F.DataSource)<D.value(F.CacheSize)}),F.renderTimeout=D.observable(),F.calculateChildrenTimeout=D.observable(),F.HasRenderCallPending=D.computed(function(){return!(!D.value(F.renderTimeout)&&!D.value(F.calculateChildrenTimeout))}),F.InProcessOfCreatingChildren=D.computed(function(){return D.value(F.creatingChildren)||!!D.value(F.calculateChildrenTimeout)}),D.isObservable(F.FooterShown)||(F.FooterShown=D.observable(F.FooterShown)),D.observe(F.FooterShown,function(){F.footerButton=null,F.gridOptions=null,F.renderReactListAsync()},F,void 0,!0),D.observe(F.SelectedRowTrackingId,function(){F.markedSelectedVersion++,F.renderReactListAsync()},F,void 0,!0),D.bulkObserve(F,function(){F.renderReactListAsync()},F.Updating,F,void 0,d,!0),F.lastHasPreviousPage=D.peek(F.HasPreviousPage),F.lastHasNextPage=D.peek(F.HasNextPage),D.bulkObserve({hasPreviousPage:F.HasPreviousPage,hasNextPage:F.HasNextPage},function(e){var t=!1;if(e.hasPreviousPage&&F.lastHasPreviousPage!==D.peek(F.HasPreviousPage)&&(F.lastHasPreviousPage=D.peek(F.HasPreviousPage),t=!0),e.hasNextPage&&F.lastHasNextPage!==D.peek(F.HasNextPage)&&(F.lastHasNextPage=D.peek(F.HasNextPage),t=!0),D.peek(F.HasNextPage)||D.peek(F.HasPreviousPage)||F.gridCounts.RowCount||(t=!0),t){if(D.peek(F.HasPreviousPage)||D.peek(F.HasNextPage)){var o=F.getEmptyColumnCounts();F.gridCounts={ColumnCounts:o.columnCounts,IsPartialCount:!!F.IsSizeLimited(),MarkedRowCount:F.getMarkedRowCount()}}else{var n=F.getCalculatedColumnCounts();F.gridCounts={ColumnCounts:n.columnCounts,DisplaceColumnCount:n.displaceColumnCount,IsPartialCount:!!F.IsSizeLimited(),MarkedRowCount:F.gridCounts&&F.gridCounts.MarkedRowCount,RowCount:F.DisplayRowCount()}}F.renderReactListAsync()}},F.Updating,F,void 0,void 0,!0),F.dataCache=new D.reactGrid.DataCache(F.LoadDataByTrackingId,F,F.DataSource),F.syncManager=new D.reactGrid.SyncManager(F,F.DataSource),F.groupingManager=new D.reactGrid.GroupingManager(F);function i(){F.childrenChangedComputed=D.childHierarchyChanged(F.element),F.usingDisposable(D.observe(F.childrenChangedComputed,function(){var e,t,o,n=null===(o=null===(t=(e=F.element).dynChildren)||void 0===t?void 0:t.call(e))||void 0===o?void 0:o[0];if(null!=n&&n.dynChildren){var i=F._getDefaultControl(n);F.defaultControlName=i?i._name:"",F.firstRender||F.callingMove?F.calculateChildren():F.calculateChildrenAndRenderAsync()}}))}F.IsSizeLimited=D.computed(function(){var e=F.dataCache&&F.dataCache.MaxCacheSize;return!!e&&D.length(F.DataSource)>=e}),F.DisplayRowCount=D.computed(function(){var e=F.dataCache&&F.dataCache.MaxCacheSize,t=D.length(F.DataSource);return 0<e&&e<=t?e:t}),D.observe(F.DisplayRowCount,function(e){F.gridCounts&&!D.util.isNullOrUndefined(F.gridCounts.RowCount)&&F.gridCounts.RowCount!==e&&(F.gridCounts=__assign(__assign({},F.gridCounts),{RowCount:e}),F.renderReactListAsync())},F,void 0,!0),F.PreemptiveClient=D.computed(function(){return D.value(F.AllowPreemptiveClient)&&F.preemptiveClientInternal});var r=D.value(F.IsSizeLimited);if(D.observe(F.IsSizeLimited,function(e){!r&&e&&F.requestTotals(function(e){D.warn({Label:"ReactGrid_RowLimited",Message:D.label("ReactGrid_RowLimited")},F)}),r=e,D.isServerBoundDataSource(F.DataSource)&&(F.DataSource.__boundDataSource.clientGridSizeLimited=e)}),t){if(F.reflowEndWatcher=D.layout.registerEndReflowHandler(t,function(){F.gridInitiatedArrange?F.gridInitiatedArrange=!1:D.observe(F.creatingChildren,function(e){if(!e)return F.syncManager.reevaluateSurroundingBlockingDiv(),F.recalculateSize++,F.renderReactListAsync(),!1})}),t.dynChildren){var a=t.dynChildren()[0];a.dynChildren?i():D.dataBind(a,e,i)}F.handleMouseWheel=function(e){F.element&&F.element.querySelector(".ScrollbarLayout_mainVertical")&&e.preventDefault()},t.addEventListener("mousewheel",F.handleMouseWheel)}if(F.DataSource){if(D.isObservable(F.DataSource)){var s=D.observe(F.DataSource,function(){F.dataVersion++,F.renderReactListAsync()},F,void 0,!0);D.isServerBoundDataSource(F.DataSource)&&(F.dataSourceObservers[F.DataSource.__dataSourceName]=s)}D.isServerBoundDataSource(F.DataSource)&&(F.modelCollectionIds.push(F.DataSource.__boundDataSource.id),F.DataSource.__boundDataSource.markedCount&&F.usingDisposable(D.observe(F.DataSource.__boundDataSource.markedCount,function(e){F.gridCounts={ColumnCounts:F.gridCounts&&F.gridCounts.ColumnCounts&&D.util.objectAssign({},F.gridCounts.ColumnCounts),IsPartialCount:F.gridCounts&&F.gridCounts.IsPartialCount,MarkedRowCount:e,RowCount:F.gridCounts&&F.gridCounts.RowCount},F.markedSelectedVersion++,F.renderReactListAsync()},F,void 0,!0)),F.DataSource.__boundDataSource.onClear&&(F.clearSubscription=F.DataSource.__boundDataSource.onClear.subscribe(function(){F.onCacheClear()})))}if(F.themeChangedHandler=function(){F.themeVersion++,F.columnChanged()},D.ax.formPersonalizationPane&&D.isObservable(D.ax.formPersonalizationPane.formPersonalizationToolbar.Mode)&&F.usingDisposable(D.observe(D.ax.formPersonalizationPane.formPersonalizationToolbar.Mode,function(e){F.personalizationMode!==e&&(F.personalizationMode=e,!F.firstRender&&D.value(F.AllowPersonalization)&&(F.postRenderCallbacks.push(function(){D.ax.personalizationUtil&&D.ax.personalizationUtil.forceUpdatePersonalizationClasses()}),F.renderReactListAsync()))})),$(document).on("themechanged",F.themeChangedHandler),F.Root&&D.isObservable(F.Root.IsInViewMode)&&F.usingDisposable(D.observe(F.Root.IsInViewMode,function(){F.columnChanged()},F,void 0,!0)),D.peek(F.HasPreviousPage)||D.peek(F.HasNextPage)){var l=F.getEmptyColumnCounts();F.gridCounts={ColumnCounts:l.columnCounts,IsPartialCount:!!F.IsSizeLimited(),MarkedRowCount:F.getMarkedRowCount()}}else{var u=F.getCalculatedColumnCounts();F.gridCounts={ColumnCounts:u.columnCounts,DisplaceColumnCount:u.displaceColumnCount,IsPartialCount:!!F.IsSizeLimited(),MarkedRowCount:F.getMarkedRowCount(),RowCount:F.DisplayRowCount()}}return F.groupingManager.updateGroupHeadersAndRerender(),F}var h={AvailableShortcuts:{Handler:function(e){var t=this.getLiveControl(e.target);t?(D.ui.Control.prototype.showShortcutsHandler.call(t,e.target),this.getColumnInfo(t.Name).shortcutToolTip=t.shortcutToolTip):this.showShortcutsHandler&&this.showShortcutsHandler(e.target)},Keys:{alt:(e.ReactList=l).prototype.AllowPreemptiveClient=!0,shift:!0,keyCode:D.ui.KeyCodes.letterK},ShowToUser:!1},CollapseCurrentGroup:{ChordKeys:{alt:!0,keyCode:D.ui.KeyCodes.letterT},Description:D.label("ReactGrid_CollapseCurrentGroup"),Handler:function(){var e=this.getCurrentGroupTrackingId();if(this.hasGrouping()&&e&&!this.groupingManager.getGroupIsCollapsed(e)){var t=this.getRowIndexFromTrackingId(e);this.toggleGroupExpandCollapse(t)}},Keys:{keyCode:D.ui.KeyCodes.letterC},ShowToUser:function(){var e=this.getCurrentGroupTrackingId();return this.hasGrouping()&&e&&!this.groupingManager.getGroupIsCollapsed(e)}},Delete:{Description:D.label("ReactGrid_DeleteRow"),Handler:function(){var e=D.value(this.InternalSelectedRowTrackingId);return e&&(!D.isServerBoundDataSource(this.DataSource)||parseInt(e,10)<0)?(this.deleteClientRow(e),!0):D.value(this.SelectedRowTrackingId)!==e&&void 0},Keys:{alt:!0,keyCode:D.ui.KeyCodes.deleteKey},ShowToUser:function(){var e=D.value(this.InternalSelectedRowTrackingId);return e&&(!D.isServerBoundDataSource(this.DataSource)||parseInt(e,10)<0)}},ExpandCollapseAllGroups:{ChordKeys:{alt:!0,keyCode:D.ui.KeyCodes.letterT},Description:function(){return this.getCollapseAllStatus()?D.label("Grid_ExpandAllGroups"):D.label("Grid_CollapseAllGroups")},Handler:function(){this.hasGrouping()&&(this.getCollapseAllStatus()?this.expandAllGroups():this.collapseAllGroups())},Keys:{keyCode:D.ui.KeyCodes.letterE},ShowToUser:function(){return this.hasGrouping()}},ExpandCollapseCurrentGroup:{Description:function(){var e=this.getActiveRowIndex();if(this.groupingManager.isGroupHeader(e)){var t=this.getTrackingIdFromRowIndex(e);return this.groupingManager.getGroupIsCollapsed(t)?D.label("ReactGrid_ExpandCurrentGroup"):D.label("ReactGrid_CollapseCurrentGroup")}return""},Handler:function(){var e=this.getActiveRowIndex();return!!this.groupingManager.isGroupHeader(e)&&(this.toggleGroupExpandCollapse(e),!0)},Keys:{keyCode:D.ui.KeyCodes.spacebar},ShowToUser:function(){var e=this.getActiveRowIndex();return this.groupingManager.isGroupHeader(e)}},FreezeColumn:{ChordKeys:{alt:!0,keyCode:D.ui.KeyCodes.letterT},Description:function(){var e="",t=this.getColumnInfo(this.activeColumnName);return t&&(e=D.value(t.IsFrozen)?D.label("ReactGrid_UnfreezeColumn"):D.label("ReactGrid_FreezeColumn")),e},Handler:function(){var e=this.getColumnInfo(this.activeColumnName);e&&(D.value(e.IsFrozen)?this.freezeColumn(this.activeColumnName,!1):this.freezeColumn(this.activeColumnName,!0))},Keys:{keyCode:D.ui.KeyCodes.letterP},ShowToUser:function(){return D.controls.ReactList.freezingEnabled()}},GoToActiveRow:{ChordKeys:{alt:!0,shift:!0,keyCode:D.ui.KeyCodes.letterM},Description:D.label("ReactGrid_GoToActiveRow"),Handler:function(){this.goToActiveRow()},Keys:{keyCode:D.ui.KeyCodes.letterA}},GoToFooter:{Description:D.label("ReactGrid_GoToFooter"),Keys:{keyCode:D.ui.KeyCodes.letterF,alt:!0,shift:!0}},GoToProcessingRow:{ChordKeys:{alt:!0,keyCode:D.ui.KeyCodes.letterT},Description:D.label("ReactGrid_GoToProcessingRow"),Handler:function(){this.goToActiveRow(),this.syncManager.resume()},Keys:{keyCode:D.ui.KeyCodes.letterA}},GridOptions:{ChordKeys:{alt:!0,keyCode:D.ui.KeyCodes.letterT},Description:D.label("ReactGrid_OpenGridOptions"),Handler:function(){var e;null!==(e=this.element.querySelector(".dyn-gridOptions"))&&void 0!==e&&e.click()},Keys:{keyCode:D.ui.KeyCodes.letterO}},GroupUngroupColumn:{ChordKeys:{alt:!0,keyCode:D.ui.KeyCodes.letterT},Description:function(){return-1<this.groupingManager.getGroupingIndex(this.activeColumnName)?D.label("ReactGrid_UngroupColumn"):D.label("ReactGrid_GroupColumn")},Handler:function(){if(D.reactGrid.GroupingManager.flightEnabled()){var e=this.getColumnInfo(this.activeColumnName),t=this.groupingManager.getGroupingIndex(this.activeColumnName);-1<t?this.removeGrouping(t):this.addGrouping("",e)}},Keys:{keyCode:D.ui.KeyCodes.letterG},ShowToUser:function(){return D.reactGrid.GroupingManager.flightEnabled()}},HeaderFocus:{ChordKeys:{alt:!0,keyCode:D.ui.KeyCodes.letterT},Description:D.label("ReactGrid_GoToColumnHeader"),Handler:function(){this.focusHeader()},Keys:{keyCode:D.ui.KeyCodes.letterH}},Restore:{Description:D.label("Form_Revert"),Handler:function(){this.syncManager&&this.syncManager.restoreRecord(D.value(this.InternalSelectedRowTrackingId))},Keys:{ctrl:!0,shift:!0,keyCode:D.ui.KeyCodes.f5}},ShowFooter:{ChordKeys:{alt:!0,keyCode:D.ui.KeyCodes.letterT},Description:function(){return D.value(this.FooterShown)?D.label("ReactGrid_FooterHide"):D.label("ReactGrid_FooterShown")},Handler:function(){D.value(this.FooterShown)?this.hideFooter():this.showFooter()},Keys:{keyCode:D.ui.KeyCodes.letterF}},TotalColumn:{ChordKeys:{alt:!0,keyCode:D.ui.KeyCodes.letterT},Description:D.label("ReactGrid_CalculatedValue"),Handler:function(){var e=this.getColumnInfo(this.activeColumnName);if(D.value(e.AllowTotal))if(D.controls.ReactList.extendedAggregationEnabled())if(D.value(e.TotalShown))switch(D.value(e.TotalType)){case"Sum":this.requestAddTotalColumn(this.activeColumnName,null,!0,"Min"),this.requestTotalsFromControlLibrary();break;case"Min":this.requestAddTotalColumn(this.activeColumnName,null,!0,"Max"),this.requestTotalsFromControlLibrary();break;case"Max":this.requestAddTotalColumn(this.activeColumnName,null,!0,"Avg"),this.requestTotalsFromControlLibrary();break;case"Avg":this.requestRemoveTotalColumn(this.activeColumnName,null)}else this.requestAddTotalColumn(this.activeColumnName,null,!0,"Sum"),this.requestTotalsFromControlLibrary();else D.value(e.TotalShown)?(this.requestAddTotalColumn(this.activeColumnName,null),this.requestTotalsFromControlLibrary()):this.requestRemoveTotalColumn(this.activeColumnName,null)},Keys:{keyCode:D.ui.KeyCodes.letterV},ShowToUser:function(){var e=this.getColumnInfo(this.activeColumnName);return e&&D.value(e.AllowTotal)}}},v=D.controls.List.prototype.Shortcuts;for(var g in v)v[g]&&!1!==v[g].ShowToUser&&(h[g]=Object.assign({},v[g],{Handler:void 0}));l.prototype.Shortcuts=h}(D.controls||(D.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};var __rest=this&&this.__rest||function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(o[n[i]]=e[n[i]])}return o};!function(Q){var e,t,o,n;function i(e){var n=o.call(this,e)||this;return n.onRequestAddTotalColumn=function(e,t,o){n.props.OnRequestAddTotalColumn&&n.props.OnRequestAddTotalColumn(e,o,!0,t)},n.cachedContext={DisableAnimation:Q.flags.disableAnimations,IsPhone:Q.shell.isPhone},ControlLibrary.FlyoutAnchor.setContext(n.cachedContext),n.state={columns:null,columnsVersion:0,isLoadingResources:!1},n}(e=Q.reactGrid||(Q.reactGrid={})).LoadedControlResources={},e.areResourcesLoading=function(){return Object.getOwnPropertyNames(Q.reactGrid.LoadedControlResources).some(function(e){return"pending"===Q.reactGrid.LoadedControlResources[e].state()})},e.hasColumnsWithResourcesLoading=function(e){return e.some(function(e){var t=Q.value(e.ReactResource);return t&&"pending"===Q.reactGrid.LoadedControlResources[t].state()})},e.loadControlResources=function(e,o){return e.filter(function(e){var t=Q.value(e.ReactResource);return!!t&&(void 0===Q.reactGrid.LoadedControlResources[t]?(Q.reactGrid.LoadedControlResources[t]=Q.getResourceManager(t).promise(),Q.reactGrid.LoadedControlResources[t].done(function(){o&&!Q.reactGrid.areResourcesLoading()&&o()}),!0):"pending"===Q.reactGrid.LoadedControlResources[t].state()&&(Q.reactGrid.LoadedControlResources[t].done(function(){o&&!Q.reactGrid.areResourcesLoading()&&o()}),!0))}).length},t=e.UI||(e.UI={}),o=React.Component,__extends(i,o),i.prototype.componentWillMount=function(){var e=this.updateColumns(this.props),t=this.props.ColumnInfo&&0<this.props.ColumnInfo.length?Q.reactGrid.hasColumnsWithResourcesLoading(this.props.ColumnInfo):Q.reactGrid.areResourcesLoading();t!==this.state.isLoadingResources&&(e.isLoadingResources=t),this.setState(e)},i.prototype.componentWillUpdate=function(){this.cachedContext.DisableAnimation===Q.flags.disableAnimations&&this.cachedContext.IsPhone===Q.shell.isPhone||(this.cachedContext={DisableAnimation:Q.flags.disableAnimations,IsPhone:Q.shell.isPhone},ControlLibrary.FlyoutAnchor.setContext(this.cachedContext))},i.prototype.componentWillReceiveProps=function(e){var t=!1,o={};e.ColumnInfo===this.props.ColumnInfo&&e.DefaultControl===this.props.DefaultControl&&e.ForceNavigationAction===this.props.ForceNavigationAction&&e.NavigationEnabled===this.props.NavigationEnabled&&e.NavigationAction===this.props.NavigationAction||(o=this.updateColumns(e),t=!0);var n=e.ColumnInfo&&0<e.ColumnInfo.length?Q.reactGrid.hasColumnsWithResourcesLoading(e.ColumnInfo):Q.reactGrid.areResourcesLoading();this.state.isLoadingResources!==n&&(o.isLoadingResources=n,t=!0),t&&this.setState(o)},i.prototype.componentDidMount=function(){this.props.PostRender()},i.prototype.componentDidUpdate=function(){this.props.PostRender()},i.prototype.render=function(){return React.createElement(ControlLibrary.RootContainerContext.Provider,{value:this.cachedContext},this.getGridComponent())},i.prototype.getGridComponent=function(){var e=this.props,t=e.AllowColumnReorder,o=e.AllowExtendedAggregation,n=e.AllowTotals,i=e.AllRowsMarked,r=e.CardId,a=e.ClassName,s=(e.ColumnInfo,e.CollectionData),l=e.CollectionDataVersion,u=(e.DefaultControl,e.EnableLostKeyPrevention),d=e.FooterInitiallyShown,c=(e.ForceNavigationAction,e.GetGridOptions),p=e.GridCounts,h=e.GridLines,m=e.GridOptionsClose,v=e.GroupingColumnWidth,g=e.HasFixedChild,y=e.HasGrouping,f=e.IsInSidePanel,b=e.IsTileCard,C=e.Mode,w=(e.NavigationAction,e.NavigationEnabled,e.OnColumnReorder),_=e.OnColumnResize,S=e.OnColumnSelected,I=e.OnCopy,T=e.OnFooterVisibilityChange,x=e.OnGroupHeaderClick,F=e.OnHeaderFocus,k=e.OnLastRowArrowDown,P=e.OnPaste,R=e.OnRangeSelection,M=(e.OnRequestAddTotalColumn,e.OnRequestGroupTotals),E=e.OnRequestRemoveTotalColumn,N=e.OnRequestTotals,A=e.OnSyncCellClicked,D=e.OnSyncCellHover,L=(e.PostRender,e.RowsMarkedByDefault),O=e.SetRef,B=e.ShowHeader,$=e.ShowMarkingColumn,V=e.ToggleMark,H=e.ToggleMarkAll,G=(e.Type,e.VisibleColumnCount),z=__rest(e,["AllowColumnReorder","AllowExtendedAggregation","AllowTotals","AllRowsMarked","CardId","ClassName","ColumnInfo","CollectionData","CollectionDataVersion","DefaultControl","EnableLostKeyPrevention","FooterInitiallyShown","ForceNavigationAction","GetGridOptions","GridCounts","GridLines","GridOptionsClose","GroupingColumnWidth","HasFixedChild","HasGrouping","IsInSidePanel","IsTileCard","Mode","NavigationAction","NavigationEnabled","OnColumnReorder","OnColumnResize","OnColumnSelected","OnCopy","OnFooterVisibilityChange","OnGroupHeaderClick","OnHeaderFocus","OnLastRowArrowDown","OnPaste","OnRangeSelection","OnRequestAddTotalColumn","OnRequestGroupTotals","OnRequestRemoveTotalColumn","OnRequestTotals","OnSyncCellClicked","OnSyncCellHover","PostRender","RowsMarkedByDefault","SetRef","ShowHeader","ShowMarkingColumn","ToggleMark","ToggleMarkAll","Type","VisibleColumnCount"]);if(C!==Q.ui.ListMode.list)return React.createElement(ControlLibrary.Grid,__assign({},z,{AllowColumnReorder:t,AllowExtendedAggregation:o,AllowTotals:n,AllRowsMarked:i,ChildrenVersion:this.state.columnsVersion,className:a,CollectionData:this.state.isLoadingResources?[]:s,CollectionDataVersion:this.state.isLoadingResources?-1:l,DebounceKeyDown:!Q.InsideTestWrapper,EnableLostKeyPrevention:u,FooterInitiallyShown:d,GridCounts:p,GridLines:h,GridOptions:null==c?void 0:c(),GridOptionsClose:m,GroupingColumnInitialWidth:v,HasFixedChild:g,IsLoading:this.state.isLoadingResources,OnColumnReorder:w,OnColumnResize:_,OnColumnSelected:S,OnCopy:I,OnFooterVisibilityChange:T,OnGroupHeaderClick:x,OnHeaderFocus:F,OnLastRowArrowDown:k,OnMarkAllRowsChange:H,OnPaste:P,OnRangeSelection:R,OnRequestAddTotalColumn:this.onRequestAddTotalColumn,OnRequestGroupTotals:M,OnRequestRemoveTotalColumn:E,OnRequestTotals:N,OnRowMarkChange:V,OnSyncCellClicked:A,OnSyncCellHover:D,ref:O,RowsMarkedByDefault:L,ShowGroupByColumn:y,ShowGroupMarking:!0,ShowHeader:B,ShowMarkingColumn:$,ShowSyncingColumn:this.props.AllowEdit}),this.state.isLoadingResources?null:this.state.columns);var U=null!=r?r:"".concat(this.props.Id,"_Card"),W=Q.ui.theme.getUnitValue("smallCardWidth"),K=void 0,q="SizeToContent";if(this.props.EnableInfiniteScroll||void 0===G&&!y)return"helpPaneCardList"===a&&(K=4*Q.densityThemeManager._getCurrentDensity(),q="Manual"),React.createElement(ControlLibrary.ListGrid,__assign({},z,{ChildrenVersion:this.state.columnsVersion,className:a,CollectionData:this.state.isLoadingResources?[]:s,CollectionDataVersion:this.state.isLoadingResources?-1:l,IsInSidePanel:f,IsLoading:this.state.isLoadingResources,OnRowMarkChange:V,ref:O,Width:W,WidthMode:"Manual"}),React.createElement(ControlLibrary.Card,{Actions:this.state.Actions,AdditionalInfo:this.state.AdditionalInfo,AlwaysShowActions:this.state.AlwaysShowActions,Caption:this.state.Caption,Footer:this.state.Footer,Heading:this.state.Heading,Height:K,HeightMode:q,Id:U,Image:this.state.Image,Notes:this.state.Notes,Status:this.state.Status},this.state.isLoadingResources?null:this.state.columns));var j=G;return 0===G&&"SizeToContent"===this.props.WidthMode&&(j=1),b&&(K=W=Q.ui.theme.getUnitValue("tileMediumWidth"),q="Manual"),React.createElement(ControlLibrary.PagedCardListGrid,__assign({},z,{ChildrenVersion:this.state.columnsVersion,className:a,CollectionData:this.state.isLoadingResources?[]:s,CollectionDataVersion:this.state.isLoadingResources?-1:l,ColumnCount:j,HasGrouping:y,IsLoading:this.state.isLoadingResources,OnRowMarkChange:V,ref:O}),React.createElement(ControlLibrary.Card,{Actions:this.state.Actions,AdditionalInfo:this.state.AdditionalInfo,AlwaysShowActions:this.state.AlwaysShowActions,Caption:this.state.Caption,Footer:this.state.Footer,Heading:this.state.Heading,Height:K,HeightMode:q,Id:U,Image:this.state.Image,IsTileCard:b,Notes:this.state.Notes,Status:this.state.Status,Width:W,WidthMode:"Manual"},this.state.isLoadingResources?null:this.state.columns))},i.prototype.updateColumns=function(e){for(var t=[],o={},n=[],i=0;i<e.ColumnInfo.length;i++){var r=e.ColumnInfo[i],a=Q.value(r.ExtendedStyle);"Footer1"===a&&Q.setValue(r,"Width","medium");var s=Q.reactGrid.generateColumn(r,e);s&&(e.Mode===Q.ui.ListMode.list?e.IsInSidePanel&&0===i&&"Image"!==r.TypeName?o.Heading=s:"Image"===r.TypeName?"businessCard_notification"===a?o.Status=s:o.Image=s:"Toolbar"===r.TypeName?(o.Actions=s,o.AlwaysShowActions=!1):"MenuButton"===r.TypeName?(o.Actions=s,o.AlwaysShowActions=!0):"Heading"===a?o.Heading=s:"ImageCaption"===a?o.Caption=s:"Footer1"===a?o.Footer=s:"businessCard_notes"===a||"AppListGrid"===e.Name&&"SysAppStore_Status"===r._name?o.Notes=s:"AppListGrid"===e.Name&&"ColorPlaceholder"===r._name||(r.IsAdditionalInfo?n.push(s):t.push(s)):t.push(s))}return e.Mode===Q.ui.ListMode.list&&(!o.Heading&&0<t.length&&(o.Heading=t[0],t.splice(0,1)),0<n.length&&(o.AdditionalInfo=n)),o.columns=t,o.columnsVersion=this.state.columnsVersion+1,o},n=i,t.ReactGrid=n}($dyn=$dyn||{}),function(p){p.DataCacheManager={},function(e){var d,t;(t=d=e.FastFetchOffReason||(e.FastFetchOffReason={}))[t.defaultValue=0]="defaultValue",t[t.notPrimary=1]="notPrimary",t[t.inactiveForm=2]="inactiveForm",t[t.noMoreData=3]="noMoreData",t[t.cacheFull=4]="cacheFull",t[t.apiCall=5]="apiCall",t[t.failure=6]="failure",t[t.infiniteScrollDisabled=7]="infiniteScrollDisabled",t[t.invisibleGrid=8]="invisibleGrid",t[t.fastFetchFlagDisabled=9]="fastFetchFlagDisabled";var o=(c.flipDirection=function(e){var t=p.ui.ScrollDirection.none;return e===p.ui.ScrollDirection.up?t=p.ui.ScrollDirection.down:e===p.ui.ScrollDirection.down&&(t=p.ui.ScrollDirection.up),t},Object.defineProperty(c.prototype,"FastFetch",{get:function(){return p.value(this.fastFetch)},set:function(e){e&&(this.fastFetchOffReason=d.defaultValue),p.setValue(this,"fastFetch",e)},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"IsPrimary",{get:function(){return this.isPrimary},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"IsLoading",{get:function(){return this.isLoading},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"LastRequestedLoadDirection",{get:function(){return p.serverForm&&p.serverForm.ModelManager?p.serverForm.ModelManager.lastRequestedLoadDirection:this.lastRequestedLoadDirection},set:function(e){p.serverForm&&p.serverForm.ModelManager?p.serverForm.ModelManager.lastRequestedLoadDirection=e:this.lastRequestedLoadDirection=e},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"LastReceivedLoadDirection",{get:function(){return p.serverForm&&p.serverForm.ModelManager?p.serverForm.ModelManager.lastReceivedLoadDirection:this.lastReceivedLoadDirection},set:function(e){this.resetObserver&&(this.resetObserver.dispose(),this.resetObserver=null),p.serverForm&&p.serverForm.ModelManager?p.serverForm.ModelManager.lastReceivedLoadDirection=e:this.lastReceivedLoadDirection=e},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"MaxCacheSize",{get:function(){return this.maxCacheCapacity},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"PageSize",{get:function(){return this.currentPageSize},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"PageBufferFactor",{get:function(){return this.currentPageSize<100?100/this.currentPageSize:1},enumerable:!1,configurable:!0}),c.prototype.dataLoadNew=function(e,t){var o=this;if(!this.isDisposed){var n=function(e){t&&t(e),o.defaultCallBack(e)};if(this.isLoading)n(-1);else{if(this.isLoading=!0,this.prevItemsLength=p.length(this.dataSource),this.lastRequestedPageSize=this.currentPageSize,this.startTime=Date.now(),this.maxCacheCapacity&&this.prevItemsLength>=this.maxCacheCapacity)return p.log.reactList&&p.log.reactList("CurrentSize: "+this.prevItemsLength+" size limited"),this.isLoading=!1,void n(-1);var i=this.currentPageSize,r=0;(this.LastRequestedLoadDirection=e)===p.ui.ScrollDirection.down&&(r=p.length(this.dataSource)-1);var a=[];p.value(this.dataSource)[r]?a.push(p.value(this.dataSource)[r].masterTrackingId):a.push(0),a.push(i),a.push(e),p.callFunction(this.loadFunction,this.context,a,n,void 0,void 0,void 0,function(){o.isLoading=!1,o.fastFetchOffReason=d.failure,o.FastFetch=!1,n(-1),o.resetLoadDirection()})}}},c.prototype.resetLoadDirection=function(){var t=this;this.LastRequestedLoadDirection=p.ui.ScrollDirection.none,this.hasRenderCallPending()?this.resetObserver=p.observe(this.context.HasRenderCallPending,function(e){if(!e)return t.LastReceivedLoadDirection=p.ui.ScrollDirection.none,t.resetObserver=null,!1},this,void 0,!0):this.LastReceivedLoadDirection=p.ui.ScrollDirection.none},c.prototype.hasRenderCallPending=function(){return!(!this.context||!this.context.HasRenderCallPending)&&this.context.HasRenderCallPending()},c.prototype.turnOffFastFetch=function(){this.isPrimary?(this.fastFetchOffReason=d.apiCall,this.FastFetch=!1,this.clientBusyObserver&&(this.clientBusyObserver.dispose(),this.clientBusyObserver=null)):this.primaryDataCache&&this.primaryDataCache.turnOffFastFetch()},c.prototype.turnOnFastFetch=function(){var e=this;this.isPrimary&&!this.FastFetch?(this.FastFetch=!0,this.fastFetchData()):this.primaryDataCache&&(this.primaryDataCache.isActiveAndVisible()?this.primaryDataCache.turnOnFastFetch():(this.primaryDataCache.isPrimary=!1,this.isPrimary=!0,this.FastFetch=!0,this.fastFetchData(),this.onFastFetchComplete(function(){e.isPrimary=!1,e.primaryDataCache.isPrimary=!0})))},c.prototype.isFastFetchOn=function(){return this.isPrimary?this.FastFetch:!!this.primaryDataCache&&this.primaryDataCache.isFastFetchOn()},c.prototype.getFastFetchOffReason=function(){return this.isPrimary?this.fastFetchOffReason:this.primaryDataCache?this.primaryDataCache.getFastFetchOffReason():d.defaultValue},c.prototype.isFillingCache=function(){return this.isPrimary?this.FastFetch:!!this.primaryDataCache&&this.primaryDataCache.isFillingCache()},c.prototype.onFastFetchComplete=function(e){var t=this;this.isPrimary?(this.fastFetchOffCallbacks.includes(e)||this.fastFetchOffCallbacks.push(e),this.fastFetchObserver||(this.fastFetchObserver=p.observe(this.fastFetch,function(e){if(!e)return t.fastFetchOffCallbacks.forEach(function(e){e(t.fastFetchOffReason)}),t.fastFetchObserver=null,!(t.fastFetchOffCallbacks=[])}))):this.primaryDataCache&&this.primaryDataCache.onFastFetchComplete(e)},c.prototype.isActiveAndVisible=function(){return this.isOnActiveForm()&&this.isGridVisible()},c.prototype.dispose=function(){var e,t;if(this.modelCollection){this.modelCollection.onClear&&this.clearSubscription&&this.modelCollection.onClear.unsubscribe(this.clearSubscription);var o=this.modelCollection.name;if(this.context){var n=null===(e=this.context.Root)||void 0===e?void 0:e.Id,i=this.context.Name;if(p.DataCacheManager[n]&&p.DataCacheManager[n][o]&&p.DataCacheManager[n][o][i]){var r=p.DataCacheManager[n][o][i].isPrimary;if(delete p.DataCacheManager[n][o][i],r){var a=Object.keys(p.DataCacheManager[n][o]);0<a.length&&(p.DataCacheManager[n][o][a[0]].isPrimary=!0)}}}}this.clientBusyObserver&&(this.clientBusyObserver.dispose(),this.clientBusyObserver=null),this.fastFetchObserver&&(this.fastFetchObserver.dispose(),this.fastFetchObserver=null),0<(null===(t=this.fastFetchOffCallbacks)||void 0===t?void 0:t.length)&&(this.fastFetchOffCallbacks=[]),this.context=null,this.loadFunction=null,this.modelCollection=null,this.dataSource=null,this.primaryDataCache=null,this.isDisposed=!0},c.prototype.fastFetchData=function(){var t=this;if(this.FastFetch&&this.context){var o=p.ui.ScrollDirection.none;p.value(this.context.DataAbove)?o=p.ui.ScrollDirection.up:p.value(this.context.DataBelow)?o=p.ui.ScrollDirection.down:p.value(this.context.HasPreviousPage)?o=p.ui.ScrollDirection.up:p.value(this.context.HasNextPage)&&(o=p.ui.ScrollDirection.down),this.context.MayHaveMoreData&&this.context.MayHaveMoreData(o)?this.clientBusyObserver=p.observe(p.clientBusy,function(e){if(!e)return t.dataLoadNew(o),t.clientBusyObserver=null,!1}):(this.fastFetchOffReason=d.noMoreData,this.FastFetch=!1)}},c.prototype.defaultCallBack=function(e){var t=this;if(this.loadTime=Date.now()-this.startTime,-1!==e){this.isLoading=!1,this.LastReceivedLoadDirection=this.LastRequestedLoadDirection;var o=!0,n=p.length(this.dataSource)-this.prevItemsLength,i=0==n;if(this.context&&this.context.updateConfirmations(this.LastReceivedLoadDirection,i),this.adaptivePageSizing&&n>=this.lastRequestedPageSize-1){var r=p.length(this.dataSource)<this.initialCacheCapacity?500:1e3,a=this.currentPageSize;this.loadTime<.9*r&&(a=Math.round(this.currentPageSize*(r/this.loadTime)))>this.initialCacheCapacity&&(a=this.initialCacheCapacity),p.log.reactList&&p.log.reactList("RequestedPageSize: ".concat(this.currentPageSize," loadTime: ").concat(this.loadTime," optimalTime: ").concat(r," NewPageSize: ").concat(a)),this.currentPageSize=a}if(this.FastFetch)if(p.length(this.dataSource)>=this.initialCacheCapacity)this.fastFetchOffReason=d.cacheFull,this.FastFetch=!1;else if(this.isOnActiveForm()){var s=this.LastRequestedLoadDirection,l=this.context.MayHaveMoreData(s);if(!l){var u=c.flipDirection(s);(l=this.context.MayHaveMoreData(u))&&(s=u)}l?(o=!1,this.clientBusyObserver=p.observe(p.clientBusy,function(e){if(!e)return t.dataLoadNew(s),t.clientBusyObserver=null,!1})):(this.fastFetchOffReason=d.noMoreData,this.FastFetch=!1)}else this.fastFetchOffReason=d.inactiveForm,this.FastFetch=!1;o&&this.resetLoadDirection()}},c.prototype.isGridVisible=function(){var e;return null===(e=this.context)||void 0===e?void 0:e.treatGridAsVisible()},c.prototype.isOnActiveForm=function(){var e,t,o;return null===(o=null===(t=null===(e=this.context)||void 0===e?void 0:e.Root)||void 0===t?void 0:t.isNavigationActiveForm)||void 0===o?void 0:o.call(t)},c);function c(e,t,o){var n,i=this;this.loadFunction=e,this.context=t,this.dataSource=o,this.fastFetch=p.observable(!1),this.fastFetchOffReason=d.defaultValue,this.fastFetchOffCallbacks=[],this.currentPageSize=25,this.lastRequestedPageSize=0,this.initialCacheCapacity=200,this.isLoading=!1,this.lastRequestedLoadDirection=p.ui.ScrollDirection.none,this.lastReceivedLoadDirection=p.ui.ScrollDirection.none,this.resetObserver=null,this.clientBusyObserver=null,this.fastFetchObserver=null,this.isDisposed=!1,this.adaptivePageSizing=!0;var r=null===(n=null==t?void 0:t.Root)||void 0===n?void 0:n.Id;if(r&&p.isServerBoundDataSource(o)){this.modelCollection=o.__boundDataSource,this.modelCollection.onClear&&(this.clearSubscription=this.modelCollection.onClear.subscribe(function(){!i.FastFetch&&i.isPrimary&&p.value(i.context.InfiniteScroll)&&!p.flags.disableFastFetch&&(i.FastFetch=!0,p.async(function(){var e=i.isOnActiveForm();e&&i.isGridVisible()?i.fastFetchData():(i.fastFetchOffReason=e?d.invisibleGrid:d.inactiveForm,i.FastFetch=!1)}))})),p.DataCacheManager[r]||(p.DataCacheManager[r]={});var a=this.modelCollection.name;if(p.DataCacheManager[r][a]){this.isPrimary=!1,this.fastFetchOffReason=d.notPrimary;var s=Object.keys(p.DataCacheManager[r][a]);0<s.length&&(this.primaryDataCache=p.DataCacheManager[r][a][s[0]])}else p.DataCacheManager[r][a]={},this.isPrimary=!0,p.value(this.context.InfiniteScroll)&&!p.flags.disableFastFetch?this.FastFetch=!0:(this.fastFetchOffReason=p.flags.disableFastFetch?d.fastFetchFlagDisabled:d.infiniteScrollDisabled,this.adaptivePageSizing=!1);p.DataCacheManager[r][a][t.Name]=this}var l=p.util.getFlightValue("MaxReactGridRows");this.maxCacheCapacity=l&&0<l?l:null,this.fastFetchData()}e.DataCache=o}(p.reactGrid||(p.reactGrid={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(I){!function(y){var f="_RESERVED_SyncState";function r(e){return!(!e||0!==e.ActionType&&1!==e.ActionType)}var e=(t.prototype.getLogInfo=function(e,t){var o=null!=e?e:t?this.context.getTrackingIdFromRecId(t):"",n=null!=t?t:e?this.context.getRecIdFromTrackingId(e):"";return"TrackingId: ".concat(o,", RecId: ").concat(n)},t.prototype.updateIfInvalid=function(e){var t=!1,o=this.getRowSyncState(e);return 2!==o&&3!==o||(this.hasDataInteractions(e)?this.setRowSyncState(e,1):this.setRowSyncState(e,0),this.setRailsModeMessagingContent(null),t=!0),t},t.prototype.queueDependentRowAction=function(e,t,o){if(!this.pendingDependentRowActions[e]){var n=this.context.getRecIdFromTrackingId(e);this.pendingDependentRowActions[e]={recId:n,actions:{}}}this.pendingDependentRowActions[e].actions[t]=o},t.prototype.attachToggleMark=function(e,t){var o;null!==(o=this.pendingDependentRowActions[e])&&void 0!==o&&o.actions.toggleMark?delete this.pendingDependentRowActions[e].actions.toggleMark:this.queueDependentRowAction(e,"toggleMark",t)},t.prototype.discardPendingDependentRowActions=function(){this.pendingDependentRowActions={}},t.prototype.discardPendingChanges=function(){var t=this;this.context&&this.discardQueuedDataChanges(I.value(this.context.SelectedRowTrackingId),!1),this.hasQueuedRowChanges()&&(this.queuedRowChanges.forEach(function(e){void 0!==e.rowId&&(t.discardQueuedDataChanges(e.rowId,!1),1===e.action.ActionType&&t.context&&t.context.deleteClientRow(e.rowId))}),this.queuedRowChanges=[]),this.queuedDataChanges={},this.resetExitConfirmation()},t.prototype.removeQueuedRowChange=function(t,o){0<this.queuedRowChanges.length&&(this.queuedRowChanges=this.queuedRowChanges.filter(function(e){return!(e.rowId===t&&(2===o||e.action.ActionType===o))}))},t.prototype.processFirstQueuedRowChange=function(e){var t=this;0<this.queuedRowChanges.length&&(e?I.async(function(){0<t.queuedRowChanges.length&&!t.queuedRowChanges[0].action.InProgress&&(t.queuedRowChanges[0].action.execute(),r(t.queuedRowChanges[0].action)||t.queuedRowChanges.shift())},void 0,"Send next pending row change"):this.queuedRowChanges[0].action.InProgress||(this.queuedRowChanges[0].action.execute(),r(this.queuedRowChanges[0].action)||this.queuedRowChanges.shift()))},t.prototype.changeRow=function(e,t,o,n,i,r,a){void 0===r&&(r=!1),void 0===a&&(a=!1);var s=new b(e,t,o,n,i,this),l=this.context&&n===I.ui.InputType.keyboard&&!this.context.gridOrAnyChildEditable();this.PendingRowChangeAction||0<this.queuedRowChanges.length||this.IsPaused?(this.queueRowChange(e,s,!l,a,r),this.context&&2===this.getRowSyncState(o)&&o===I.value(this.context.SelectedRowTrackingId)&&this.processFirstQueuedRowChange(!1)):l?this.queueRowChange(e,s,!1,a,r):s.execute()},t.prototype.createRow=function(e,t,o,n){var i=new _(e,t,o,I.ui.InputType.keyboard,n,this);this.PendingRowChangeAction||0<this.queuedRowChanges.length||this.IsPaused?(this.queueRowChange(e,i),this.setRowSyncState(e,1),this.context&&2===this.getRowSyncState(o)&&o===I.value(this.context.SelectedRowTrackingId)&&this.processFirstQueuedRowChange(!1)):i.execute()},t.prototype.processLastQueuedRowChange=function(){if(0<this.queuedRowChanges.length){var e=this.queuedRowChanges.length-1,t=this.queuedRowChanges[e].action;t.InProgress||(I.log.syncManager&&I.log.syncManager("Process last queued row change and clear out all not in progress row changes"),t.execute(),r(t)||this.queuedRowChanges.pop(),this.queuedRowChanges=this.queuedRowChanges.filter(function(e){return e.action.InProgress}))}},t.prototype.changeData=function(e,t,o,n,i){if(!this.context||this.PendingRowChangeAction||e!==I.value(this.context.SelectedRowTrackingId)||this.IsPaused&&2!==this.getRowSyncState(e)){if(I.log.syncManager&&I.log.syncManager("changeData queue: %s",this.getLogInfo(e)),this.RailsMode=!0,I.shell.registerUnsavedChanges(this.context.getUniqueId()),this.hasDataInteractions(e))this.queuedDataChanges[e].changesCounter++;else{var r=this.context.getRecIdFromTrackingId(e);if(this.queuedDataChanges[e]={updates:{},changesCounter:0,recId:r},0===this.getRowSyncState(e)&&this.setRowSyncState(e,1),!this.IsPaused&&0<=parseInt(e,10)&&!this.doesRowChangeExist(e,0)&&!this.isRowChangePending(e,0)){var a="";if(this.hasQueuedRowChanges()){var s=this.queuedRowChanges.length-1;a=this.queuedRowChanges[s].rowId}else this.PendingRowChangeAction&&(a=this.PendingRowChangeAction.trackingId);I.log.syncManager&&I.log.syncManager("Queuing data change with no queued row change, queue a row change: %s",this.getLogInfo(e));var l=I.value(this.context.SelectedRowTrackingId)===e;this.changeRow(e,I.controls.List.MarkMode.select,a,I.ui.InputType.notSpecified,t,l)}}var u=this.queuedDataChanges[e].changesCounter;this.queuedDataChanges[e].updates[t]?(this.queuedDataChanges[e].updates[t].sync=o,this.queuedDataChanges[e].updates[t].order=u,this.queuedDataChanges[e].updates[t].undo=n,this.queuedDataChanges[e].updates[t].redo=i):this.queuedDataChanges[e].updates[t]={sync:o,order:u,undo:n,redo:i}}else I.log.syncManager&&I.log.syncManager("changeData execute immediate: %s",this.getLogInfo(e)),o(e)},t.prototype.getValidity=function(e,t,o){if(this.context&&this.dataSource){var n=this.context.getRowIndexFromTrackingId(e),i=I.value(this.dataSource)[n];if(i){var r="_VIRTUALIZED_"+t+"_Validity";if(I.serverForm&&I.serverForm.isModel(i)&&o&&i.collectionName!==o&&(i=i.getRelated(o,n)),I.serverForm&&I.serverForm.isModel(i))return i.getValue(r);if(i)return i[r]}}},t.prototype.setValidity=function(e,t,o,n){if(this.context&&this.dataSource){var i=this.context.getCollectionIndexFromTrackingId(t),r=I.value(this.dataSource)[i];if(I.serverForm&&I.serverForm.isModel(r)&&n&&r.collectionName!==n&&(r=r.getRelated(n,i)),r){var a="_VIRTUALIZED_"+o+"_Validity";if(I.serverForm&&I.serverForm.isModel(r)){var s=r.getValue(a),l=I.util.objectAssign({},s,e);r.setValue(a,l,!1,this.rootId),I.reactGrid.appliedVirtualizedProperty=!0}else s=r[a],l=I.util.objectAssign({},s,e),r[a]=l}}},t.prototype.setDataVersion=function(e,t,o){if(this.context&&this.dataSource){var n=this.context.getCollectionIndexFromTrackingId(e),i=I.value(this.dataSource),r=i[n];if(I.serverForm&&I.serverForm.isModel(r)&&o&&i[n].collectionName!==o&&(r=i[n].getRelated&&i[n].getRelated(o,n)),r){var a,s="_VIRTUALIZED_".concat(t,"_DataVersion");I.serverForm&&I.serverForm.isModel(r)?(void 0===(a=r.getValue(s))&&(a=0),r.setValue(s,a+1,!0,this.rootId),I.reactGrid.appliedVirtualizedProperty=!0):(void 0===(a=r[s])&&(a=0),r[s]=a+1)}}},t.prototype.setInternalValue=function(e,t,o,n){if(void 0===n&&(n=""),this.context&&this.dataSource){var i;I.log.syncManager&&I.log.syncManager("setInternalValue (value, field, ds): %s, %s, %s, %s",e,t,o,this.getLogInfo(n)),i=n?this.context.getCollectionIndexFromTrackingId(n):this.context.getActiveRowCollectionIndex();var r=I.value(this.dataSource)[i];if(r){var a="_INTERNAL_".concat(t);if(I.serverForm&&I.serverForm.isModel(r))if(o&&r.collectionName!==o){var s=r.getRelated(o,i);s&&s.doesPropertyExist(t)&&s.setValue(a,e,!1,this.rootId)}else r.doesPropertyExist(t)?(I.log.syncManager&&I.log.syncManager("setInternalValue actual (value, field): %s, %s, %s",e,a,this.getLogInfo(r.id)),r.setValue(a,e,!1,this.rootId)):I.log.syncManager&&I.log.syncManager("setInternal value invalid property (value, field): %s, %s, %s",e,t,this.getLogInfo(r.id));else r[a]=e}else I.log.syncManager&&I.log.syncManager("setInternalValue couldnt find rowId: %s",this.getLogInfo(n))}},t.prototype.clearInternalValue=function(e,t,o){var n=!1;if(!this.context||!this.dataSource)return n;I.log.syncManager&&I.log.syncManager("clearInternalValue (field, ds): %s, %s, %s",t,o,this.getLogInfo(e));var i=this.context.getCollectionIndexFromTrackingId(e),r=I.value(this.dataSource)[i];if(r){var a="_INTERNAL_".concat(t);if(I.serverForm&&I.serverForm.isModel(r))if(o&&r.collectionName!==o){var s=r.getRelated(o,i);s&&s.doesPropertyExist(a)&&(s.getValue(t)!==s.getValue(a)&&(n=!0),s.removeProperty(a))}else r.doesPropertyExist(a)&&(r.getValue(t)!==r.getValue(a)&&(n=!0),r.removeProperty(a));else r[a]!==r[t]&&(n=!0),delete r[a]}return n},Object.defineProperty(t.prototype,"RailsMode",{get:function(){return this.surroundingBlockingDivShown},set:function(e){e&&!this.surroundingBlockingDivShown?(this.SurroundingBlockingDiv.show(this.AllowedElements),this.surroundingBlockingDivShown=!0,this.context&&this.context.renderReactListAsync()):!e&&this.surroundingBlockingDivShown&&(this.setRailsModeMessagingContent(null),this.SurroundingBlockingDiv.hide(),this.surroundingBlockingDivShown=!1,this.cachedSurroundingBlockingDiv.removeClass("fadeInQuick"),this.cachedSurroundingBlockingDiv.removeClass("fastEditRailsMode"),this.context&&this.context.renderReactListAsync())},enumerable:!1,configurable:!0}),t.prototype.setRowSyncState=function(e,t){if(this.context&&this.dataSource){var o=this.context.getCollectionIndexFromTrackingId(e),n=I.value(this.dataSource)[o];n&&(n.getValue&&n.getValue(f)!==t?n.setValue(f,t,!1,this.rootId):n[f]=t,this.context.markedSelectedVersion++,this.context.renderReactListAsync())}},t.prototype.getRowSyncState=function(e){if(this.context&&this.dataSource){var t,o=this.context.getCollectionIndexFromTrackingId(e);if(-1<o){var n=I.value(this.dataSource)[o];n&&(t=n.getValue?n.getValue(f):n[f])}return void 0===t&&(t=0),t}},t.prototype.hasQueuedRowChanges=function(){return 0<this.queuedRowChanges.length},t.prototype.doesRowChangeExist=function(e,t){var o,n;try{for(var i=__values(this.queuedRowChanges),r=i.next();!r.done;r=i.next()){var a=r.value;if(a.rowId===e&&(2===t||a.action.ActionType===t))return!0}}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return!1},t.prototype.isRowChangePending=function(e,t){return!(!this.PendingRowChangeAction||this.PendingRowChangeAction.trackingId!==e||2!==t&&this.PendingRowChangeAction.ActionType!==t)},t.prototype.queueRowChange=function(e,t,o,n,i){if(void 0===o&&(o=!0),void 0===n&&(n=!1),void 0===i&&(i=!1),0<this.queuedRowChanges.length)if(0===this.queuedRowChanges[this.queuedRowChanges.length-1].action.ActionType&&(this.hasDataInteractions()||this.IsPaused)){var r=this.queuedRowChanges[this.queuedRowChanges.length-1].rowId;if(!this.hasDataInteractions(r)||0===Object.keys(this.queuedDataChanges[r].updates).length){var a=this.queuedRowChanges.pop();I.log.syncManager&&I.log.syncManager("pop empty row change: %s",this.getLogInfo(a.rowId,a.recId)),t.previousActiveRow===a.rowId&&(t.previousActiveRow=a.action.previousActiveRow)}}else 4===this.queuedRowChanges[this.queuedRowChanges.length-1].action.ActionType&&(I.log.syncManager&&I.log.syncManager("pop SaveRecord: %s",this.getLogInfo(this.queuedRowChanges[this.queuedRowChanges.length-1].rowId,this.queuedRowChanges[this.queuedRowChanges.length-1].recId)),this.queuedRowChanges.pop());if(this.context&&(i||e!==I.value(this.context.SelectedRowTrackingId)&&!this.doesRowChangeExist(e,2)&&!this.isRowChangePending(e,2))){var s=this.context.getRecIdFromTrackingId(e);n?(I.log.syncManager&&I.log.syncManager("queueRowChange at beginning: %s",this.getLogInfo(e,s)),this.queuedRowChanges.unshift({rowId:e,action:t,recId:s})):(I.log.syncManager&&I.log.syncManager("queueRowChange at end: %s",this.getLogInfo(e,s)),this.queuedRowChanges.push({rowId:e,action:t,recId:s})),o&&(this.RailsMode=!0)}},t.prototype.toggleMarkAll=function(e){var t=new c(e,this);this.hasQueuedRowChanges()?this.queuedRowChanges.push({action:t}):t.execute()},t.prototype.markGroup=function(e,t,o){var n=new m(e,t,o,this);this.hasQueuedRowChanges()?this.queuedRowChanges.push({action:n}):n.execute()},t.prototype.unmarkAll=function(){var e=new l(this);this.hasQueuedRowChanges()?this.queuedRowChanges.push({action:e}):e.execute()},t.prototype.queueSaveIfNeeded=function(e){var t,o=new a(this,e),n=!1,i=!1;if(this.hasQueuedRowChanges()){var r=this.queuedRowChanges[this.queuedRowChanges.length-1];void 0!==r.rowId&&this.hasDataInteractions(r.rowId)&&(n=!0)}else(this.context.hasDirtyDataSource()||null!==(t=I.serverForm)&&void 0!==t&&t.interactionManager.hasPendingResponse(!0))&&(i=n=!0);this.context&&2===this.getRowSyncState(e)&&e===I.value(this.context.SelectedRowTrackingId)&&(i=!0,this.hasQueuedRowChanges()||(n=!0)),n&&this.queuedRowChanges.push({action:o}),i&&this.processFirstQueuedRowChange(!1)},t.prototype.isWaitingForUserResume=function(){return void 0!==this.resumeClicked},t.prototype.setResumeCallback=function(e){var t=this;I.log.syncManager&&I.log.syncManager("setResumeCallback"),this.IsPaused=!0;var o=!(this.RailsMode=!0);this.context&&(I.value(this.context.SelectedRowTrackingId)===I.value(this.context.InternalSelectedRowTrackingId)?o=!0:!this.PendingRowChangeAction||this.isPendingRowActionCreate()||this.PendingRowChangeAction.trackingId!==I.value(this.context.InternalSelectedRowTrackingId)||this.hasDataInteractions()?this.setRowSyncState(I.value(this.context.SelectedRowTrackingId),3):(o=!0,this.context.goToActiveRow(),this.PendingRowChangeAction.forcedToActiveRow=!0)),o?(e&&e(),this.RailsMode=!1):(this.setRailsModeMessagingContent(this.getResumeContent()),this.currentMessagingContent=3,this.resumeClicked=function(){e&&e(),t.setRailsModeMessagingContent(null),t.RailsMode=!1})},t.prototype.resumeCallbackComplete=function(){if(I.log.syncManager&&I.log.syncManager("resumeCallbackComplete"),(this.hasQueuedRowChanges()||this.hasDataInteractions())&&(this.RailsMode=!0),!this.deletePending){if(this.clearPendingGrid(),this.context){var e=I.value(this.context.SelectedRowTrackingId);this.setRowSyncState(e,0),this.hasDataInteractions(e)&&this.sendDataInteractions(e)}this.isPendingRowActionCreate()||this.processFirstQueuedRowChange(!0)}},t.prototype.clearPendingGrid=function(){this.IsPaused=!1,this.context&&this.context.Root&&(this.context.Root.PendingGrid=void 0)},t.prototype.isPendingGrid=function(){return this.context&&this.context.Root&&this.context.Root.PendingGrid===this.context},t.prototype.syncCellClicked=function(e,t){var o=this.context.getTrackingIdFromRowIndex(e),n=this.getRowSyncState(o);if(3===n)this.resume();else{var i=100,r=100;I.flags.disableAnimations&&(r=i=0);var a={delay:i,event:"unfocus"},s={delay:r,event:"",ready:!0};this.createQTip(e,o,n,a,s,t,!0),this.qtip&&(this.qtipOpenedByClick=!0)}},t.prototype.syncCellHover=function(e,t){if(!this.qtip||!this.qtipOpenedByClick){var o=this.context.getTrackingIdFromRowIndex(e),n=this.getRowSyncState(o);if(3!==n){var i=100,r=400;I.flags.disableAnimations&&(r=i=0);var a={delay:i,fixed:!0},s={delay:r,ready:!0};this.createQTip(e,o,n,a,s,t,!1)}}},t.prototype.updatePreviousRowInQueuedRowChanges=function(t,o){this.queuedRowChanges.forEach(function(e){r(e.action)&&(0===e.action.ActionType&&e.rowId===t?(e.rowId=o,e.action.trackingId=o):e.action.previousActiveRow===t&&(e.action.previousActiveRow=o))})},t.prototype.mergeModels=function(m,v){var g=this;I.log.syncManager&&I.log.syncManager("mergeModels (old, new): %s, %s",m,v),I.serverForm&&this.context&&(0<this.context.modelCollectionIds.length?this.context.modelCollectionIds.forEach(function(e){var t,o,n=I.serverForm.ModelManager.getModelCollection(e,g.rootId);if(n){var i="".concat(n.name,"_").concat(m),r=I.serverForm.ModelManager.getModel(i,g.rootId),a="".concat(n.name,"_").concat(v),s=I.serverForm.ModelManager.getModel(a,g.rootId);if(s&&(s.setValue(y.OLD_MASTERTRACKINGID,m,!1,g.rootId),r)){var l=r.getPropertyNames();try{for(var u=__values(l),d=u.next();!d.done;d=u.next()){var c=d.value;if(c===f||c.startsWith("_INTERNAL_")||c.startsWith("_VIRTUALIZED")&&c.endsWith("_Validity")){var p=r.getValue(c);I.log.syncManager&&I.log.syncManager("merge property (property, value, oldModelId, newModelId): %s, %s, %s, %s",c,p,i,a),s.setValue(c,p,!1,g.rootId)}}}catch(e){t={error:e}}finally{try{d&&!d.done&&(o=u.return)&&o.call(u)}finally{if(t)throw t.error}}if(r.isSelected&&(s.isSelected=!0),r.isMarked&&(s.isMarked=!0),r.collectionIndex===s.collectionIndex&&(r.collectionIndex=s.collectionIndex+1),n.numberOfClientRows--,I.isObservableArray(n.items)){n.items.splice(r.collectionIndex,1);for(var h=r.collectionIndex;h<I.length(n.items);h++)I.value(n.items)[h].collectionIndex=h}I.serverForm.ModelManager.deleteModel(i,g.rootId)}}}):I.value(this.context.InternalSelectedRowTrackingId)===m&&I.setValue(this.context,"InternalSelectedRowTrackingId",v))},t.prototype.syncClientRowToServer=function(){if(this.context&&!this.hasQueuedRowChanges()){var e=I.value(this.context.InternalSelectedRowTrackingId),t=I.value(this.context.SelectedRowTrackingId),o=t!==e&&0<=parseInt(e,10);o&&(this.rootId&&this.modelCollection&&I.serverForm&&void 0===I.serverForm.ModelManager.getModel("".concat(this.modelCollection.name,"_").concat(e),this.rootId)&&(o=!1),o&&this.isRowChangePending(e,2)&&(o=!1),o&&(I.log.syncManager&&I.log.syncManager("syncClientRowToServer (clientId, serverId): (%s, %s)",e,t),this.changeRow(e,I.controls.List.MarkMode.select,t,I.ui.InputType.notSpecified,this.context.activeColumnName)))}},t.prototype.sendDataInteractions=function(s,e){var l=this;if(void 0===e&&(e=!0),this.hasDataInteractions(s)||e){var t=function(){var t,e;if(l.hasDataInteractions(s)){var o=[];for(var n in l.queuedDataChanges[s].updates)l.queuedDataChanges[s].updates[n]&&(o[l.queuedDataChanges[s].updates[n].order]=l.queuedDataChanges[s].updates[n]);try{for(var i=__values(o),r=i.next();!r.done;r=i.next()){var a=r.value;a&&a.sync(s)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}delete l.queuedDataChanges[s],l.resetExitConfirmation()}1===l.getRowSyncState(s)&&l.setRowSyncState(s,0)};e?I.async(t,void 0,"Sync any pending data changes for server active row"):t()}},t.prototype.hasDataInteractions=function(e,t){var o;return void 0===e?0<Object.keys(this.queuedDataChanges).length:void 0===t?!!this.queuedDataChanges[e]:!(null===(o=this.queuedDataChanges[e])||void 0===o||!o.updates[t])},t.prototype.updateQueuedDataChanges=function(e,t){this.hasDataInteractions(e)&&(this.queuedDataChanges[t]=this.queuedDataChanges[e],delete this.queuedDataChanges[e])},t.prototype.executeDependentRowActions=function(i){var e,t,r=this;null!==(t=null===(e=this.pendingDependentRowActions)||void 0===e?void 0:e[i])&&void 0!==t&&t.actions&&I.async(function(){var e,t,o;if(null!==(t=null===(e=r.pendingDependentRowActions)||void 0===e?void 0:e[i])&&void 0!==t&&t.actions){for(var n in r.pendingDependentRowActions[i].actions)null!==(o=r.pendingDependentRowActions[i])&&void 0!==o&&o.actions[n]&&r.pendingDependentRowActions[i].actions[n](i);delete r.pendingDependentRowActions[i]}},void 0,"Send dependent row actions after row changed successfully")},t.prototype.hasDependentRowActions=function(e){var t;if(!this.pendingDependentRowActions)return!1;if(void 0===e)return 0<Object.keys(this.pendingDependentRowActions).length;var o=null===(t=this.pendingDependentRowActions[e])||void 0===t?void 0:t.actions;return!!(o&&0<Object.keys(o).length)},t.prototype.updatePendingDependentRowActions=function(e,t){this.pendingDependentRowActions[e]&&(this.pendingDependentRowActions[t]=this.pendingDependentRowActions[e],delete this.pendingDependentRowActions[e])},t.prototype.getValidationContent=function(){var t=this,e=document.createElement("div"),o=document.createElement("span");o.innerText=I.label("ReactGrid_ValidationPrompt");var n=document.createElement("a");return n.href="#",n.onclick=function(e){return t.context.goToActiveRow(),t.context.setClientMarking(!1),t.context.preemptiveClientInternal=!1,t.RailsMode=!1},n.innerText=I.label("ReactGrid_InvalidRowLink"),e.appendChild(o),e.appendChild(n),e},t.prototype.showPastePrompt=function(){this.currentMessagingContent=4,this.setRailsModeMessagingContent(this.getPasteMessagingContent()),this.fadeInBlockingDivs()},t.prototype.reevaluateSurroundingBlockingDiv=function(){if(this.surroundingBlockingDivShown)switch(this.reevaluateElements=!0,this.SurroundingBlockingDiv.removeClass("fadeInQuick"),this.SurroundingBlockingDiv.show(this.AllowedElements),this.currentMessagingContent){case 1:this.setRailsModeMessagingContent(this.getPleaseWaitContent());break;case 3:this.setRailsModeMessagingContent(this.getResumeContent());break;case 2:this.setRailsModeMessagingContent(this.getValidationContent());break;case 4:this.setRailsModeMessagingContent(this.getPasteMessagingContent())}},t.prototype.cacheClearedRowChangeFail=function(n,i,r,a,s){var l=this;function e(e){if(l.context){var t="";n&&(t=l.context.getTrackingIdFromRecId(n)),t=t||l.context.getTrackingIdFromCollectionIndex(i);var o=l.context.getRowIndexFromTrackingId(t);-1!==o?(I.log.syncManager&&I.log.syncManager("Re-do failed row change: %s",l.getLogInfo(t,n)),e?l.context.changeRow(o,s,r,a):l.changeRow(t,r,I.value(l.context.SelectedRowTrackingId),a,s,!1,!0)):l.context.goToActiveRow()}}I.log.syncManager&&I.log.syncManager("cache clear caused row change to fail: RecId: %s",n),this.hasQueuedRowChanges()?e(!1):I.async(function(){e(!0)})},t.prototype.resume=function(){this.resumeClicked&&(this.resumeClicked(),this.resumeClicked=void 0)},t.prototype.rowSaveFailed=function(){var e=!1;if(this.context){var t=I.value(this.context.SelectedRowTrackingId);0<=this.context.getRowIndexFromTrackingId(t)&&(3!==this.getRowSyncState(t)&&this.setRowSyncState(t,2),I.value(this.context.PreemptiveClient)&&(this.context.gridOrAnyChildEditable()||I.value(this.context.Mode)!==I.ui.ListMode.list)||(e=!0),e?(this.context.goToActiveRow(),I.errorMessageBox({Text:I.label("BoundaryError")}),this.RailsMode=!1):(this.IsPaused=!0,this.RailsMode=!0,this.hasRailsModeMessagingContent()||(this.fadeInBlockingDivs(),this.setRailsModeMessagingContent(this.getValidationContent()),this.currentMessagingContent=2)))}return e},t.prototype.onCacheClear=function(){var i=this;!this.PendingRowChangeAction||0!==this.PendingRowChangeAction.ActionType&&1!==this.PendingRowChangeAction.ActionType||(this.PendingRowChangeAction.cacheCleared=!0),I.serverForm&&this.modelCollection&&this.modelCollection.addPostUpdateAction(function(){i.queuedRowChanges=i.queuedRowChanges.filter(function(e){var t=!1;if(e)if(e.rowId&&parseInt(e.rowId,10)<0)t=!0,r(e.action)&&e.action.previousRecId&&(o=i.context.getTrackingIdFromRecId(e.action.previousRecId))&&o!==e.action.previousActiveRow&&(e.action.previousActiveRow=o);else if(e.recId){var o,n=i.context.getTrackingIdFromRecId(e.recId);if(n&&r(e.action))e.rowId=n,e.action.trackingId=n,!e.action.previousRecId||(o=i.context.getTrackingIdFromRecId(e.action.previousRecId))&&o!==e.action.previousActiveRow&&(e.action.previousActiveRow=o),t=!0}return t});var t=!1;Object.keys(i.queuedDataChanges).filter(function(e){var t=!1;if(e&&0<parseInt(e,10)){var o=i.queuedDataChanges[e].recId;if(o){var n=i.context.getTrackingIdFromRecId(o);n?(i.updateQueuedDataChanges(e,n),i.redoQueuedDataChanges(n)):t=!0}else t=!0}return t}).forEach(function(e){delete i.queuedDataChanges[e],t=t||!0}),t&&(I.info({Message:I.label("ReactGrid_UnsavedChanges"),Label:"ReactGrid_UnsavedChanges"},i.context),i.resetExitConfirmation()),Object.keys(i.pendingDependentRowActions).filter(function(e){var t=!1;if(e&&0<parseInt(e,10)){var o=i.pendingDependentRowActions[e].recId;if(o){var n=i.context.getTrackingIdFromRecId(o);n?i.updatePendingDependentRowActions(e,n):t=!0}else t=!0}return t}).forEach(function(e){delete i.pendingDependentRowActions[e]}),i.isPendingRowActionCreate()||(i.PendingRowChangeAction=void 0,i.isPendingGrid()&&i.clearPendingGrid()),I.length(i.queuedRowChanges)<=0&&(i.RailsMode=!1),i.IsPaused=!1})},t.prototype.restoreRecord=function(e){var t=this.getRowSyncState(e);if(2===t){var o=this.context?this.context.Root:void 0;o&&o.executeShortcuts&&o.executeShortcuts(!1,"Restore"),this.hasQueuedRowChanges()?this.processFirstQueuedRowChange(!0):(this.IsPaused=!1,this.RailsMode=!1,this.setRowSyncState(e,0),this.context.preemptiveClientInternal||(this.context.preemptiveClientInternal=!0))}else 1===t&&(this.discardQueuedDataChanges(e),this.context.dataVersion++);this.context.markedSelectedVersion++,this.context.renderReactListAsync()},t.prototype.dispose=function(){this.qtip&&this.destroyQtip(),this.cachedSurroundingBlockingDiv&&this.cachedSurroundingBlockingDiv.destroy(),this.selectedRowObserver&&this.selectedRowObserver.dispose(),this.internalSelectedRowObserver&&this.internalSelectedRowObserver.dispose(),this.msgBarObserver&&this.msgBarObserver.dispose(),this.msgBarComputed&&this.msgBarComputed.valueChanged.clearAllDependencies(),this.msgBarAnimationHandlersUsed&&this.context&&this.context.Root&&this.context.Root.MessageBar&&this.context.Root.MessageBar.element&&(this.context.Root.MessageBar.element.removeEventListener("transitionend",this.msgBarAnimationEnd,!1),this.context.Root.MessageBar.element.removeEventListener("animationend",this.msgBarAnimationEnd,!1),this.context.Root.MessageBar.element.removeEventListener("webkitAnimationEnd",this.msgBarAnimationEnd,!1)),this.queuedRowChanges=[],this.queuedDataChanges={},this.resetExitConfirmation(),this.context=null,this.dataSource=null,this.modelCollection=null},t.prototype.hasRailsModeMessagingContent=function(){if(this.surroundingBlockingDivShown&&this.context)return this.SurroundingBlockingDiv.hasMessagingContent(this.context.element)},t.prototype.setRailsModeMessagingContent=function(e){this.surroundingBlockingDivShown&&this.context&&this.SurroundingBlockingDiv.addMessagingContent(this.context.element,e),null===e&&(this.currentMessagingContent=0)},t.prototype.fadeInBlockingDivs=function(){this.SurroundingBlockingDiv.addClass("fadeInQuick"),this.SurroundingBlockingDiv.addClass("fastEditRailsMode")},t.prototype.resetExitConfirmation=function(){this.context&&!this.hasDataInteractions()&&I.shell.unregisterUnsavedChanges(this.context.getUniqueId())},t.prototype.isPendingRowActionCreate=function(){return this.PendingRowChangeAction&&1===this.PendingRowChangeAction.ActionType},t.prototype.destroyQtip=function(){this.qtip&&this.qtip.destroy(!0),this.qtip=null,this.qtipVisible(!1),this.qtipOpenedByClick=!1},t.prototype.createQTip=function(e,t,o,n,i,r,a){var s=this;if(this.context&&r){this.destroyQtip();var l,u=null,d=null,c=!1;switch(o){case 2:c=!0;var p=this.getToolbarWithGroup(),h=p.toolbar,m=p.toolbarGroup;this.getRevertButton(t,m),this.getDeleteButton(t,m),u=0!==this.context.getColumnMessages(e).length?(h.classList.add("message"),$(this.getMessagesGroup(e)).add(h)):$(h),d=I.context(h);break;case 1:c=!0;var v=this.getToolbarWithGroup(),g=v.toolbar,y=v.toolbarGroup;0<=parseInt(t,10)?this.getRevertButton(t,y):this.getDeleteButton(t,y),u=$(g),d=I.context(g)}c&&(d&&d._cancelPendingOverflow(),this.qtip=$(r).qtip({content:{text:u},events:{hide:function(e,t){var o;null!=l&&l();var n=null===(o=null==d?void 0:d.element)||void 0===o?void 0:o.parentElement;n&&($(n).off("keydown.syncQtip"),I.util.empty(n)),s.destroyQtip(),$(document.body).off("resetShellOnNavigation.syncQtip"),a&&r.focus()},visible:function(e,t){if(s.qtipVisible(!0),d&&(d._updateOverflow(),a&&d.element)){var o=d.element.parentElement;o&&(o.tabIndex=-1,l=I.util.tabbingContainer(o),$(o).on("keydown.syncQtip",function(e){e.which===I.ui.KeyCodes.esc&&(t.hide(),e.stopImmediatePropagation(),e.preventDefault())}));var n=I.util.findFirstTabbableControl(d.element);null!=n&&n.focus()}$(document.body).on("resetShellOnNavigation.syncQtip",function(){s.destroyQtip()})}},hide:n,position:{at:"center right",my:"center left"},show:i,style:{classes:"qtip-light syncColumn-qtip",tip:{corner:!0,height:7,width:15}}}).qtip("api"))}},t.prototype.getPasteMessagingContent=function(){var e=document.createElement("div"),t=document.createElement("span");t.innerText=I.label("ReactGrid_PasteConfirmation");var o=document.createElement("button");o.className="dynamicsButton button-isDefault",o.innerText=I.label("ReactGrid_Save"),o.addEventListener("click",this.pasteSave);var n=document.createElement("button");n.className="dynamicsButton",n.innerText=I.label("ReactGrid_Discard"),n.addEventListener("click",this.pasteDiscard);var i=document.createElement("div");return i.className="pasteButtonGroup",i.appendChild(o),i.appendChild(n),e.appendChild(t),e.appendChild(i),e},t.prototype.removeQueuedDataChanges=function(e,t){void 0===t&&(t=!0),this.hasDataInteractions(e)&&(delete this.queuedDataChanges[e],t&&this.resetExitConfirmation())},t.prototype.discardQueuedDataChanges=function(e,t){var o;if(void 0===t&&(t=!0),this.hasDataInteractions(e)){for(var n in this.queuedDataChanges[e].updates)null!==(o=this.queuedDataChanges[e].updates[n])&&void 0!==o&&o.undo&&this.queuedDataChanges[e].updates[n].undo(e);this.removeQueuedDataChanges(e,t)}1===this.getRowSyncState(e)&&this.setRowSyncState(e,0)},t.prototype.redoQueuedDataChanges=function(e){var t;if(this.hasDataInteractions(e))for(var o in this.queuedDataChanges[e].updates)null!==(t=this.queuedDataChanges[e].updates[o])&&void 0!==t&&t.redo&&this.queuedDataChanges[e].updates[o].redo(e)},t.prototype.getToolbarWithGroup=function(){var e=I.ui.createControl("Toolbar");return{toolbar:e,toolbarGroup:I.ui.createChildControl("ToolbarGroup",{},e)}},t.prototype.getRevertButton=function(e,t){var o=this;return I.ui.createChildControl("Button",{ButtonDisplay:I.ui.ButtonDisplay.textWithImageLeft,Click:function(){o.restoreRecord(e),o.destroyQtip()},ImageName:"Restore",Label:I.label("ReactGrid_Revert"),Name:"SyncCellQtipRevert"},t,{tagName:"button"})},t.prototype.getDeleteButton=function(n,e){var i=this;return I.ui.createChildControl("Button",{ButtonDisplay:I.ui.ButtonDisplay.textWithImageLeft,Click:function(){i.removeQueuedRowChange(n,2),i.removeQueuedDataChanges(n);var e=i.getRowSyncState(n);if(1===e)i.context.deleteClientRow(n);else if(2===e){var t=function(){i.hasQueuedRowChanges()?(i.modelCollection&&i.modelCollection.internalActiveMasterTrackingId(i.queuedRowChanges[0].rowId),i.processFirstQueuedRowChange(!0)):(i.IsPaused=!1,i.RailsMode=!1,i.context.preemptiveClientInternal||(i.context.preemptiveClientInternal=!0)),i.deletePending=!1},o=i.context?i.context.Root:void 0;o&&o.executeShortcuts?(i.deletePending=!0,o.executeShortcuts(!1,"DeleteRecord",void 0,t)):(i.context.deleteClientRow(n),t())}i.destroyQtip()},ImageName:"Delete",Label:I.label("ReactGrid_DeleteRow"),Name:"SyncCellQtipDelete"},e,{tagName:"button"})},t.prototype.getMessagesGroup=function(e){var t,o,n=this.context.getColumnMessages(e),i=I.ui.createControl("Group");try{for(var r=__values(n),a=r.next();!a.done;a=r.next()){var s=a.value;I.ui.createChildControl("Label",{Text:s},i,{tagName:"span"})}}catch(e){t={error:e}}finally{try{a&&!a.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}return i},Object.defineProperty(t.prototype,"SurroundingBlockingDiv",{get:function(){var e=this;return this.cachedSurroundingBlockingDiv||(this.cachedSurroundingBlockingDiv=new I.shell.multiElementSurroundingBlockingDiv(function(){e.fadeInBlockingDivs(),e.hasRailsModeMessagingContent()||(e.setRailsModeMessagingContent(e.getPleaseWaitContent()),e.currentMessagingContent=1)})),this.cachedSurroundingBlockingDiv},enumerable:!1,configurable:!0}),t.prototype.getPleaseWaitContent=function(){var e=this,t=this.hasDataInteractions(),o=document.createElement("div"),n=document.createElement("span");n.innerText=t?I.label("ReactGrid_PleaseWaitPrompt"):I.label("ReactGrid_PleaseWaitRowChange");var i=document.createElement("button");i.className="dynamicsButton button-isDefault",i.innerText=I.label("ReactGrid_Wait"),i.addEventListener("click",function(){return e.pasteWait(),!1});var r=document.createElement("button");r.className="dynamicsButton",r.innerText=t?I.label("ReactGrid_DiscardUnsaved"):I.label("MessageBox_Cancel"),r.addEventListener("click",function(){return e.pasteDiscard(),e.context&&e.context.goToActiveRow(),!1});var a=document.createElement("div");return a.className="pasteButtonGroup",a.appendChild(i),a.appendChild(r),o.appendChild(n),o.appendChild(a),o},t.prototype.getResumeContent=function(){var o=this,e=document.createElement("div"),t=document.createElement("span");t.innerText=I.label("ReactGrid_ResumePrompt");var n=document.createElement("a");return n.innerText=I.label("ReactGrid_ProvideInputLink"),n.href="#",n.onclick=function(e){o.context.goToActiveRow();var t=o.context.getRowIndexFromTrackingId(I.value(o.context.SelectedRowTrackingId));return o.syncCellClicked(t),!1},e.appendChild(t),e.appendChild(n),e},Object.defineProperty(t.prototype,"AllowedElements",{get:function(){var t=this;if(this.context&&this.context.element){if(this.reevaluateElements||!this.allowedElements||0===this.allowedElements.length){this.allowedElements=[this.context.element];var e=this.context.Root;e&&e.MessageBar&&(e.MessageBar.IsVisible()&&this.allowedElements.push(e.MessageBar.element),I.flags.disableAnimations?this.msgBarComputed||(this.msgBarComputed=I.computed(function(){t.context.Root.MessageBar.IsVisible(),t.context.Root.MessageBar.InfoExpanded(),t.context.Root.MessageBar.WarningExpanded(),t.context.Root.MessageBar.ErrorExpanded()}),this.msgBarObserver=I.observe(this.msgBarComputed,function(){t.reevaluateElementsAsync&&t.reevaluateElementsAsync.cancel(),t.reevaluateElementsAsync=I.async(function(){t.reevaluateSurroundingBlockingDiv()})},this,null,!0)):this.msgBarAnimationHandlersUsed||(this.context.Root.MessageBar.element.addEventListener("transitionend",this.msgBarAnimationEnd,!1),this.context.Root.MessageBar.element.addEventListener("animationend",this.msgBarAnimationEnd,!1),this.context.Root.MessageBar.element.addEventListener("webkitAnimationEnd",this.msgBarAnimationEnd,!1),this.msgBarObserver=I.observe(this.context.Root.MessageBar.IsVisible,function(e){I.value(e)||(t.reevaluateElementsAsync&&t.reevaluateElementsAsync.cancel(),t.reevaluateElementsAsync=I.async(function(){t.reevaluateSurroundingBlockingDiv()}))},this,null,!0),this.msgBarAnimationHandlersUsed=!0)),this.reevaluateElements=!1}return this.allowedElements}},enumerable:!1,configurable:!0}),t);function t(e,t){var i=this;this.context=e,this.dataSource=t,this.pasteSave=function(){i.setRailsModeMessagingContent(null),i.IsPaused=!1,i.sendDataInteractions(I.value(i.context.SelectedRowTrackingId),!1),i.hasQueuedRowChanges()?i.processFirstQueuedRowChange(!1):i.RailsMode=!1},this.pasteDiscard=function(){i.setRailsModeMessagingContent(null),i.discardPendingChanges(),i.RailsMode=!1,i.IsPaused=!1,i.context.dataVersion++,i.context.markedSelectedVersion++,i.context.renderReactListAsync()},this.pasteWait=function(){i.setRailsModeMessagingContent(null)},this.msgBarAnimationEnd=function(e){"color"!==e.propertyName&&(i.reevaluateElementsAsync&&(i.reevaluateElementsAsync.cancel(),i.reevaluateElementsAsync=void 0),i.reevaluateSurroundingBlockingDiv())},I.isServerBoundDataSource(t)&&(this.modelCollection=t.__boundDataSource),this.IsPaused=!1,this.currentMessagingContent=0,this.msgBarAnimationHandlersUsed=!1,this.deletePending=!1,this.reevaluateElements=!0,this.surroundingBlockingDivShown=!1,this.queuedRowChanges=[],this.allowedElements=[],this.queuedDataChanges={},this.qtipOpenedByClick=!1,this.qtipVisible=I.observable(!1),this.pendingDependentRowActions={},e&&(e.Root&&e.Root&&e.Root.Id&&(this.rootId=e.Root.Id),I.isObservable(e.SelectedRowTrackingId)&&(this.oldSelectedRowTrackingId=I.value(e.SelectedRowTrackingId),this.selectedRowObserver=I.observe(e.SelectedRowTrackingId,function(e){var t,o;if(I.log.syncManager&&I.log.syncManager("SelectedRowTrackingId observer: %s",i.getLogInfo(e)),(i.updateIfInvalid(i.oldSelectedRowTrackingId)||i.IsPaused&&-1===i.context.getCollectionIndexFromTrackingId(i.oldSelectedRowTrackingId))&&(i.context.preemptiveClientInternal||(i.context.preemptiveClientInternal=!0,i.context.legacyBehaviorPendingRow?i.context.syncToLegacyBehaviorPendingRow():i.context.resetInternalSelectedTrackingId()),i.IsPaused=!1),i.PendingRowChangeAction||i.hasQueuedRowChanges()){var n=!1;e&&(0<i.queuedRowChanges.length&&(i.removeQueuedRowChange(e,0),n=!0),i.sendDataInteractions(e),i.executeDependentRowActions(e)),0===i.queuedRowChanges.length&&I.value(i.context.PreemptiveClient)&&(null!==(t=i.PendingRowChangeAction)&&void 0!==t&&t.forcedToActiveRow?(null!==(o=i.context)&&void 0!==o&&o.resetInternalSelectedTrackingId(),n=!0):i.syncClientRowToServer()),0<i.queuedRowChanges.length&&!i.isPendingRowActionCreate()&&!i.deletePending?(i.context.preemptiveClientInternal&&!i.context.getClientMarking()&&i.context.setClientMarking(!0),i.processFirstQueuedRowChange(!0)):n&&i.context&&(i.context.markedSelectedVersion++,i.context.renderReactListAsync())}else i.context&&!i.context.getClientMarking()&&(i.context.resetInternalSelectedTrackingId(),i.context.ControlLibGridRef&&i.context.ControlLibGridRef.recalculateScrollTop(),i.context.markedSelectedVersion++,i.context.renderReactListAsync());i.oldSelectedRowTrackingId=e},this,void 0,!0)),I.log.syncManager&&I.isObservable(e.InternalSelectedRowTrackingId)&&(this.internalSelectedRowObserver=I.observe(e.InternalSelectedRowTrackingId,function(e){I.log.syncManager&&I.log.syncManager("InternalSelectedRowTrackingId observer: %s",i.getLogInfo(e))},this,void 0,!0)))}y.SyncManager=e;function o(e){this.syncManager=e,this.InProgress=!1}var n,a=(__extends(i,n=o),i.prototype.execute=function(){this.syncManager.context&&!this.InProgress&&(this.InProgress=!0,I.callFunction(this.syncManager.context.SaveRecord,this.syncManager.context,void 0,this.callback,void 0,void 0,void 0,this.failureCallback))},i);function i(e,t){var o=n.call(this,e)||this;return o.previousActiveRow=t,o.callback=function(e){I.util.stringToBoolean(e)?(o.syncManager.updateIfInvalid(o.previousActiveRow)&&(o.syncManager.IsPaused=!1),o.syncManager.hasQueuedRowChanges()||(o.syncManager.RailsMode=!1)):o.syncManager.rowSaveFailed()},o.failureCallback=function(){o.callback(!1)},o.ActionType=4,o}var s,l=(__extends(u,s=o),u.prototype.execute=function(){this.syncManager.context&&!this.InProgress&&(this.InProgress=!0,I.callFunction(this.syncManager.context.UnmarkAll,this.syncManager.context,void 0,this.callback,void 0,void 0,void 0,this.callback))},u);function u(e){var t=s.call(this,e)||this;return t.callback=function(){!t.syncManager.hasQueuedRowChanges()&&t.syncManager.context&&t.syncManager.context.setClientMarking(!1)},t.ActionType=6,t}var d,c=(__extends(p,d=o),p.prototype.execute=function(){this.syncManager.context&&!this.InProgress&&(this.InProgress=!0,I.callFunction(this.syncManager.context.SetMarkAllRecordsMode,this.syncManager.context,this.markAllValue,this.callback,void 0,void 0,void 0,this.callback))},p);function p(e,t){var o=d.call(this,t)||this;return o.markAllValue=e,o.callback=function(){!o.syncManager.hasQueuedRowChanges()&&o.syncManager.context&&o.syncManager.context.setClientMarking(!1)},o.ActionType=5,o}var h,m=(__extends(v,h=o),v.prototype.execute=function(){this.syncManager.context&&!this.InProgress&&(this.InProgress=!0,I.callFunction(this.syncManager.context.UpdateGroupMarking,this.syncManager.context,[this.startTrackingId,this.endTrackingId,this.markValue],this.callback,void 0,void 0,void 0,this.callback))},v);function v(e,t,o,n){var i=h.call(this,n)||this;return i.startTrackingId=e,i.endTrackingId=t,i.markValue=o,i.callback=function(){!i.syncManager.hasQueuedRowChanges()&&i.syncManager.context&&i.syncManager.context.setClientMarking(!1)},i.ActionType=3,i}var g,b=(__extends(C,g=o),C.prototype.execute=function(){var n=this;if(this.syncManager.context&&!this.InProgress){this.activeColumnName&&this.syncManager.queueDependentRowAction(this.trackingId,"selectCell",function(e){var t,o;null!==(o=null===(t=n.syncManager)||void 0===t?void 0:t.context)&&void 0!==o&&o.SelectCell&&I.callFunction(n.syncManager.context.SelectCell,n,[e,n.activeColumnName,I.ui.InputType.notSpecified,!0,!0])}),I.log.syncManager&&I.log.syncManager("RowChangeAction execute: %s",this.syncManager.getLogInfo(this.trackingId,this.recId)),this.InProgress=!0;var e=this.inputMode===I.ui.InputType.keyboard&&!this.syncManager.context.gridOrAnyChildEditable(),t=!I.value(this.syncManager.context.PreemptiveClient);I.callFunction(this.syncManager.context.ChangeSelectedIndex,this.syncManager.context,[this.trackingId,this.markMode,this.previousActiveRow,e,this.callback,void 0,!1,this.beforeExecuteCallback,!0,t])}},C);function C(e,t,o,n,i,r){var a=g.call(this,r)||this;return a.trackingId=e,a.markMode=t,a.previousActiveRow=o,a.inputMode=n,a.activeColumnName=i,a.callback=function(e){if(I.util.stringToBoolean(e))a.syncManager.PendingRowChangeAction===a&&(a.syncManager.PendingRowChangeAction=void 0,a.syncManager.isPendingGrid()&&!a.syncManager.isWaitingForUserResume()&&a.syncManager.clearPendingGrid()),0===a.ActionType&&a.syncManager.removeQueuedRowChange(a.trackingId,0),a.syncManager.hasQueuedRowChanges()||(a.syncManager.RailsMode=!1,a.syncManager.context&&a.syncManager.context.setClientMarking(!1));else if(-1===e)a.syncManager.removeQueuedRowChange(a.trackingId,0);else{if(a.syncManager.PendingRowChangeAction===a&&(a.syncManager.PendingRowChangeAction=void 0,a.syncManager.isPendingGrid()&&!a.syncManager.isWaitingForUserResume()&&a.syncManager.clearPendingGrid()),a.InProgress=!1,!a.forcedToActiveRow)if(a.cacheCleared&&0===a.ActionType)a.syncManager.cacheClearedRowChangeFail(a.recId,a.collectionIndex,a.markMode,a.inputMode,a.activeColumnName);else a.syncManager.rowSaveFailed()||a.syncManager.doesRowChangeExist(a.trackingId,a.ActionType)||a.syncManager.queueRowChange(a.trackingId,a,!0,!0),a.syncManager.discardPendingDependentRowActions()}},a.beforeExecuteCallback=function(){I.log.syncManager&&I.log.syncManager("RowChangeAction BeforeExecute: %s",a.syncManager.getLogInfo(a.trackingId,a.recId)),(a.syncManager.PendingRowChangeAction=a).syncManager.context&&(a.collectionIndex=a.syncManager.context.getCollectionIndexFromTrackingId(a.trackingId),a.syncManager.context.Root&&(a.syncManager.context.Root.PendingGrid=a.syncManager.context))},a.ActionType=0,a.cacheCleared=!1,a.forcedToActiveRow=!1,a.syncManager.context&&(a.recId=a.syncManager.context.getRecIdFromTrackingId(a.trackingId),a.previousRecId=a.syncManager.context.getRecIdFromTrackingId(a.previousActiveRow)),a}var w,_=(__extends(S,w=b),S.prototype.execute=function(){if(this.syncManager.context&&!this.InProgress){I.log.syncManager&&I.log.syncManager("RowCreateAction execute: %s",this.trackingId),this.InProgress=!0;var e=I.value(this.syncManager.context.AllowPreemptiveClient);0===this.syncManager.context.getCollectionIndexFromTrackingId(this.trackingId)?I.callFunction(this.syncManager.context.CreateNewRecord,this.syncManager.context,["",this.trackingId,e],this.callbackInternal,void 0,this.beforeExecuteCallbackInternal,void 0,this.failureCallback):I.callFunction(this.syncManager.context.CreateNewRecordOnKeyDown,this.syncManager.context,[this.markMode,this.previousActiveRow,this.trackingId,e],this.callbackInternal,void 0,this.beforeExecuteCallbackInternal,void 0,this.failureCallback)}},S);function S(e,t,o,n,i,r){var a=w.call(this,e,t,o,n,i,r)||this;return a.failureCallback=function(){a.callbackInternal("-1")},a.callbackInternal=function(e){void 0!==e&&(e=e.toString());var t="-1"!==e;t&&a.cacheCleared&&a.syncManager.context&&(t=-1!==a.syncManager.context.getCollectionIndexFromTrackingId(e));t?(a.syncManager.context&&a.syncManager.context.dataCache&&(a.syncManager.context.dataCache.LastReceivedLoadDirection=I.ui.ScrollDirection.down),a.syncManager.mergeModels(a.trackingId,e),a.syncManager.removeQueuedRowChange(a.trackingId,1),a.syncManager.updatePreviousRowInQueuedRowChanges(a.trackingId,e),a.syncManager.updateQueuedDataChanges(a.trackingId,e),a.syncManager.updatePendingDependentRowActions(a.trackingId,e),a.syncManager.context&&e===I.value(a.syncManager.context.SelectedRowTrackingId)&&(a.syncManager.hasDataInteractions(e)?a.syncManager.sendDataInteractions(e):3!==a.syncManager.getRowSyncState(e)&&a.syncManager.setRowSyncState(e,0),a.syncManager.hasDependentRowActions(e)&&a.syncManager.executeDependentRowActions(e),!I.value(a.syncManager.context.PreemptiveClient)&&a.syncManager.context.ControlLibGridRef&&a.syncManager.context.ControlLibGridRef.recalculateScrollTop()),a.syncManager.hasQueuedRowChanges()||a.syncManager.syncClientRowToServer(),a.syncManager.processFirstQueuedRowChange(!0)):0===a.syncManager.getRowSyncState(a.trackingId)&&a.syncManager.setRowSyncState(a.trackingId,1),a.callback(t),a.syncManager.context&&a.syncManager.context.dataCache&&a.syncManager.context.dataCache.resetLoadDirection()},a.beforeExecuteCallbackInternal=function(){a.syncManager.context&&a.syncManager.context.dataCache&&(a.syncManager.context.dataCache.LastRequestedLoadDirection=I.ui.ScrollDirection.down),a.beforeExecuteCallback()},a.ActionType=1,a}}(I.reactGrid||(I.reactGrid={}))}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(Q){!function(e){function O(e){return e&&"ReactGrid"===e.Type}function B(e){return e&&"ReferenceGroup"===e.Type}var o={};e.registerColumn=function(e,t){o[e]=t};var n={};function V(e,t){return t?"".concat(e,"_").concat(t.Id):e}function H(e,t){return"_VIRTUALIZED_"+e+"_"+t}function G(e){var t=e||Q.context(Q.shell.getActiveForm());return t&&Q.peek(t.CanSwitchViewMode)&&Q.peek(t.IsInViewMode)?function(){t.executeShortcuts(!0,"ViewEdit")}:null}function z(e,t){var o,n="Manual",i=parseInt(Q.value(e.Width),10);isNaN(i)&&(n=Q.layout.sizing.isDiscreteSize(Q.value(e.Width))?(i=t?"xsmall"===(o=Q.value(e.Width))?"small":"small"===o?"medium":o:Q.value(e.Width),"DiscreteSizing"):Q.value(e.Width)===Q.layout.Size.available?(i=void 0,"SizeToAvailable"):(i=void 0,"SizeToContent"));var r="Manual",a=parseInt(Q.value(e.Height),10);return isNaN(a)&&(r=Q.value(e.Height)===Q.layout.Size.available?(a=void 0,"SizeToAvailable"):(a=void 0,"SizeToContent")),{height:a,width:i,heightMode:r,widthMode:n}}function I(e){var t,o=Q.value(e.SignDisplay);switch(Q.value(e.SupportsCorrection)&&Q.value(e.DisplaceNegative)!==Q.ui.autoValue&&(o=Q.ui.SignDisplayType.Auto),o){case Q.ui.SignDisplayType.None:t="n";break;case Q.ui.SignDisplayType.Prefixed:t="-n";break;case Q.ui.SignDisplayType.Suffixed:t="n-";break;case Q.ui.SignDisplayType.Parentheses:t="(n)";break;case Q.ui.SignDisplayType.Auto:}return t}function T(e){var t=Q.value(e.AllowNegative),o=t===Q.ui.autoValue||null==t;return o=o||Q.util.stringToBoolean(t)}function U(e){var t,o;switch(null===(t=Q.value(e.TimeSeparator))||void 0===t?void 0:t.toLocaleLowerCase()){case"colon":o=":";break;case"comma":o=",";break;case"dot":o=".";break;case"space":o=" ";break;case"slash":o="/";break;case"none":o="";break;default:o=void 0}return o}function W(c,e){var t,p=this,h=null===(t=this.listControl)||void 0===t?void 0:t.syncManager;if(h){var o=this.listControl.getTrackingIdFromRowIndex(e.RowIndex);if(c.valid){var n={userValue:c.userValue},i=!1;o!==Q.value(this.listControl.SelectedRowTrackingId)&&(n.override=void 0,e.Validity&&!1===e.Validity.override&&(i=!0)),h.setValidity(n,o,this._name,this.DataSourceName),i&&Q.serverForm&&(Q.reactGrid.appliedVirtualizedProperty=!1,Q.serverForm.UpdateModelManager.raiseChanges())}else h.setValidity({userValue:c.userValue,override:!1,messages:c.messages},o,this._name,this.DataSourceName),h.changeData(o,this.Name,function(e){var t,o,n,i;if(p.messages&&0<Q.length(p.messages)){try{for(var r=__values(p.messages),a=r.next();!a.done;a=r.next()){var s=a.value;Q.messageManager.remove(s,p.Root.Id)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}p.messages=[]}if(p.IsValid(!1),c.messages){h&&h.setValidity({messages:[]},e,p._name,p.DataSourceName);try{for(var l=__values(c.messages),u=l.next();!u.done;u=l.next()){var d=u.value;Q.warn({Message:d},p)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}}},function(e){h&&(h.setValidity({override:void 0,messages:[]},e,p._name,p.DataSourceName),h.setDataVersion(e,p._name,p.DataSourceName))},function(e){h&&h.setValidity({userValue:c.userValue,override:!1,messages:c.messages},e,p._name,p.DataSourceName)})}}function K(){var t,e;if(this.listControl&&this.listControl.syncManager){var o=Q.value(this.listControl.InternalSelectedRowTrackingId);this.listControl.syncManager.setValidity({messages:[]},o,this._name,this.DataSourceName)}if(this.messages&&0<Q.length(this.messages)){try{for(var n=__values(this.messages),i=n.next();!i.done;i=n.next()){var r=i.value;Q.messageManager.remove(r,this.Root.Id)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.messages=[]}}function d(t){var e;if(!t.Popup){t.highlyResponsivePopups=!0,t.openedBaseElement=void 0,t.FlyoutId=Q.observable(""),t.pendingPopup=function(e){t._pendingPopup=e},t.getActiveIsLoadingAnimation=function(){return t._activeIsLoadingAnimation},t.setActiveIsLoadingAnimation=function(e){t._activeIsLoadingAnimation=e},Q.ui.popupHost.apply(t);var o=t.listControl.element,n={getAnchor:function(){return $(o).find(".dyn-activeRowCell [data-dyn-controlname='"+t._name+"']")},getTarget:function(){return $(o).find(".dyn-activeRowCell [data-dyn-controlname='"+t._name+"'] .dyn-lookup-button")},flyoutId:t.FlyoutId,focusTarget:function(){return $(o).find(".dyn-activeRowCell [data-dyn-controlname='"+t._name+"']")},highlyResponsive:!0,positionResize:!0,putAnimationOnTarget:!0,requestPopup:t.showPopup,show:t.ShowFlyout,skipAria:!0,takeFocus:!1};Q.util.flyout(n,!1),t.flyoutOptions=n,null!==(e=t.listControl)&&void 0!==e&&e.columnObservers&&(t.flyoutOptions.showSubscriber&&t.listControl.columnObservers.push(t.flyoutOptions.showSubscriber),t.flyoutOptions.activeFlyoutSubscriber&&t.listControl.columnObservers.push(t.flyoutOptions.activeFlyoutSubscriber))}}function c(e){var t;if(e.listControl&&e.listControl.ControlLibGridRef){var o=e.listControl.ControlLibGridRef.getActiveCellRef(e._name);return null===(t=null==o?void 0:o.getControlRef)||void 0===t?void 0:t.call(o)}}function p(i,r,a,s){i.autoPresentLookupTimer=Q.async(function(){if(i.autoPresentLookupTimer=void 0,i.displayedValues=function(){var e={};return e[r]=a,e},Q.value(i.ShowFlyout))if(i.popupHostElement){var e=Q.context(i.popupHostElement);if(e&&Q.value(e.IsFormReady)){var t=i.displayedValues(!1);t["@activeFilter"]=a,Q.callFunction(e.Filter,e,[t])}else p(i,r,a,s)}else p(i,r,a,s);else n=c(i),null!==(o=null==n?void 0:n.openLookup)&&void 0!==o&&o.call(n);var o,n},s)}function q(u){function e(e,t){var o,n=u.listControl,i=n.getRowIndexFromTrackingId(Q.value(n.SelectedRowTrackingId)),r=null==e?void 0:e.RowIndex;if(void 0===r||r===i){if(u.autoPresentLookupTimer&&(u.autoPresentLookupTimer.cancel(),u.autoPresentLookupTimer=void 0),!u.displayedValues){var a=n.syncManager.getValidity(Q.value(n.SelectedRowTrackingId),u._name,u.DataSourceName);!a||!1!==a.valid&&!1!==a.override?u.displayedValues=function(e){var t,o={},n=c(u);return null!==(t=null==n?void 0:n.inputComponentRef)&&void 0!==t&&t.inputRef&&(e&&!n.inputComponentRef.isValueDirty()||(o[u._name]=n.inputComponentRef.inputRef.value),o.__selectionStart=String(n.inputComponentRef.getSelectionStart()),o.__selectionEnd=String(n.inputComponentRef.getSelectionEnd())),o}:u.displayedValues=function(){var e={};return e[u._name]=a.userValue,e}}var s;if(d(s=u),Q.setValue(s,"ShowFlyout",!0),!1===Q.value(u.ReplaceOnLookup)){var l=null!==(o=null==e?void 0:e.Name)&&void 0!==o?o:"";p(u,l,"",0)}Q.observe(u.ShowFlyout,function(e){if(!e)return t&&t(),u.displayedValues=void 0,u.openedBaseElement&&(Q.util.clearLookupAriaValues(u.openedBaseElement,!0),u.openedBaseElement=void 0),!1}),Q.observe(u.FlyoutId,function(e){if(e){var t=u.flyoutOptions.getAnchor();if(t){var o=t.find("input")[0];o&&(Q.util.setupLookupAriaValues(o,e),u.openedBaseElement=o)}return!1}})}}u.testOpenLookup=e;function l(e,t){if(u.TextChanged&&Q.callFunction(u.TextChanged,u,[e]),!Q.shell.isPhone){u.autoPresentLookupTimer&&(u.autoPresentLookupTimer.cancel(),u.autoPresentLookupTimer=void 0);var o=Q.ui.typeAheadTimer;void 0!==Q.debug.typeAheadTimer&&(o=Q.debug.typeAheadTimer),!1===Q.value(u.ReplaceOnLookup)?Q.value(u.ShowFlyout)&&p(u,t,e.slice(u.enhancedTypeAheadSelectionStart),0):p(u,t,e,o)}}return{AllowTyping:!Q.value(u.LookupOnly),CloseLookup:function(e){var t=u.listControl.getRowIndexFromTrackingId(Q.value(u.listControl.SelectedRowTrackingId));e&&e.RowIndex!==t||(u.autoPresentLookupTimer&&(u.autoPresentLookupTimer.cancel(),u.autoPresentLookupTimer=void 0),u._pendingPopup?u._pendingPopup.cancel():Q.setValue(u,"ShowFlyout",!1))},OnBlur:function(e,t){var o;if(e&&e.relatedTarget?o=e.relatedTarget:document.activeElement&&(o=document.activeElement),o&&!Q.util.flyout.isClosableFocusRegion(o))return!1;if(u.autoPresentLookupTimer&&!u.enterLookupTimer&&(u.autoPresentLookupTimer.cancel(),u.autoPresentLookupTimer=void 0),u.IsFocused){var n=e.relatedTarget||document.activeElement,i=u.Popup&&u.Popup()&&n&&$.contains(u.Popup()[0],n),r=n&&"ShellBlockingDiv"===n.id;if(i||r)return!1;u.IsFocused=!1,u._pendingPopup?u._pendingPopup.cancel():Q.value(u.ShowFlyout)&&Q.setValue(u,"ShowFlyout",!1)}},OnChange:function(t,e){var o,n=u.listControl.getRowIndexFromTrackingId(Q.value(u.listControl.SelectedRowTrackingId)),i=null==e?void 0:e.RowIndex,r=null!==(o=null==e?void 0:e.Name)&&void 0!==o?o:"";if(void 0!==i&&i!==n){var a=u.listControl.syncManager,s=u.listControl.getTrackingIdFromRowIndex(i);a.queueDependentRowAction(s,"filterFlyout_"+r,function(e){e===Q.value(u.listControl.InternalSelectedRowTrackingId)&&r===u.listControl.activeColumnName&&l(t,r)})}else l(t,r)},OnFocus:function(e,t){u.IsFocused||(u.IsFocused=!0)},OnKeyDown:function(o,e){var t,n=Q.ui.selectionStart(null===(t=o.nativeEvent)||void 0===t?void 0:t.target);if(Q.value(u.ShowFlyout))if(n<u.enhancedTypeAheadSelectionStart&&Q.setValue(u,"ShowFlyout",!1),u.popupHostElement){var i=Q.context(u.popupHostElement);if(i)if(Q.util.isShortcutKeyPressed(o.nativeEvent,{keyCode:Q.util.Lookup.KeysToSendToLookup})){var r=function(){u.enterLookupTimer&&(u.enterLookupTimer=void 0);var e=Q.value(i.UseReactGrid)?"[data-dyn-role='ReactList']":"[data-dyn-role='List']",t=Q.context($(u.popupHostElement).find(e)[0]);t&&(Q.value(i.UseReactGrid)?t.ControlLibGridRef&&t.ControlLibGridRef.handleKeyDown(o):t.RowKeyDown&&t.RowKeyDown(o.nativeEvent))};if(u.autoPresentLookupTimer&&Q.util.isShortcutKeyPressed(o.nativeEvent,{keyCode:Q.ui.KeyCodes.enter})){o.persist&&o.persist();var a=Q.ui.typeAheadTimer;void 0!==Q.debug.typeAheadTimer&&(a=Q.debug.typeAheadTimer),u.enterLookupTimer=Q.async(r,a,"Sending enter to lookup grid",u)}else r();o.stopPropagation&&o.stopPropagation()}else Q.util.isShortcutKeyPressed(o.nativeEvent,{keyCode:Q.ui.KeyCodes.downArrow,alt:!0})&&Q.value(i.IsFormReady)&&(i.TakeFocus=!0,i.takeFocusToggled=!0,i.takeNavigationFocus(),o.stopPropagation&&o.stopPropagation())}else Q.util.isShortcutKeyPressed(o.nativeEvent,{keyCode:Q.ui.KeyCodes.tab,isShiftKeyAgnostic:!0})&&Q.setValue(u,"ShowFlyout",!1);else u.enhancedTypeAheadSelectionStart=n},OnKeyUp:function(e,t){if(Q.value(u.ShowFlyout)&&u.popupHostElement){var o=Q.context(u.popupHostElement);if(o&&Q.value(o.UseReactGrid)&&Q.util.isShortcutKeyPressed(e.nativeEvent,{keyCode:[Q.ui.KeyCodes.upArrow,Q.ui.KeyCodes.downArrow,Q.ui.KeyCodes.pageUp,Q.ui.KeyCodes.pageDown]})){var n=Q.context($(u.popupHostElement).find("[data-dyn-role='ReactList']")[0]);n&&n.keyUp(e.nativeEvent)}}},OpenLookup:e}}function j(e){if(e){var t=e.split(" ",3);if(3===t.length)return"rgb(".concat(t.join(","),")")}}e.registerControlProperty=function(e,t){n[e]||(n[e]={}),n[e][t]=!0},e.registerControlProperties=function(e,t){n[e]?Q.util.objectAssign(n[e],t):n[e]=t||{}},e.COLUMN_PROPERTIES_TO_OBSERVE={AllowEdit:!0,BackgroundColor:!0,Enabled:!0,ExtendedStyle:!0,ForegroundColor:!0,Height:!0,HelpText:!0,IsFrozen:!0,IsHyperlink:!0,Label:!0,LookupButton:!0,PlaceHolder:!0,Required:!0,ShowLabel:!0,Skip:!0,Visible:!0,Width:!0},e.getControlProperties=function(e){return n[e]},e.generateColumn=function(e,t){return o[e.TypeName]?o[e.TypeName](e,t):o.Input(e,t)},e.requestPopupOptions=d;function t(r,o){var e=null;if(Q.value(r.Visible)){var t=z(r,Q.value(r.LookupButton)),n=0;"Auto"!==Q.value(r.DisplaceNegative)&&(n=parseInt(Q.value(r.DisplaceNegative),10));var a=function(t,e){var n=this,i=this.listControl.syncManager,o=this.listControl.getTrackingIdFromRowIndex(e.RowIndex);i.setInternalValue(t,this.FieldName,this.DataSourceName,o),i.changeData(o,this.Name,function(o){K.apply(n);function e(e){if(i)if(i.hasDataInteractions(o,n.Name))Q.log.syncManager&&Q.log.syncManager("SetValue callback ignored due to another SetValue being queued (rowId, control): (%s, %s)",o,n.Name);else{var t=i.clearInternalValue(o,n.FieldName,n.DataSourceName);Q.util.stringToBoolean(e)&&i.setValidity({override:void 0},o,n._name,n.DataSourceName),t&&i.setDataVersion(o,n._name,n.DataSourceName)}}Q.callFunction(n.SetValue,n,[t],e,null,null,null,e)},function(e){i&&i.clearInternalValue(e,n.FieldName,n.DataSourceName)&&i.setDataVersion(e,n._name,n.DataSourceName)},function(e){i&&i.setInternalValue(t,n.FieldName,n.DataSourceName,e)})}.bind(r);r.SetValueInternal=a,r.Shortcuts=Q.controls.Integer.prototype.Shortcuts;var s=W.bind(r);r.SetValidityInternal=s;var i="Integer"===r.TypeName?"2147483647":"9223372036854775807",l="Integer"===r.TypeName?"-2147483648":"-9223372036854775808",u=Q.value(r.ShowZero),d="Auto"===u;d=d||Q.util.stringToBoolean(u);var c=O(o)&&o.NavigationEnabled&&r._name===o.DefaultControl||B(o)&&o.IsDefaultControl,p=Q.value(r.IsHyperlink),h=c||p?function(e){if(O(o)&&o.NavigationEnabled&&e.IsDefaultControl)o.NavigationAction(e.RowIndex);else if(B(o)&&o.IsDefaultControl&&o.ParentProps.NavigationEnabled)o.ParentProps.NavigationAction(e.RowIndex);else{if(r.listControl&&r.listControl.syncManager&&r.listControl.syncManager.RailsMode||O(o)&&o.ForceNavigationAction&&o.NavigationAction)return;Q.getFunction(r.ExecuteHyperlink)()}}:null,m=function(e,t){Q.value(this.CanHavePreview)&&Q.value(this.RequestEnhancedPreview)&&o.OnMouseEnter&&o.OnMouseEnter(e,t)}.bind(r),v=function(e,t){Q.value(this.CanHavePreview)&&Q.value(this.RequestEnhancedPreview)&&o.OnMouseLeave&&o.OnMouseLeave(e,t)}.bind(r),g=Q.value(r.HelpText);(p||c)&&(g=Q.label("ReactGrid_FollowLink"));var y={AllowEdit:Q.value(r.AllowEdit),AllowNegativeValue:T(r),AllowTotal:Q.value(r.AllowTotal),BackgroundColor:j(Q.value(r.BackgroundColor)),DisplaceNegative:n,Enabled:Q.value(r.Enabled),ForegroundColor:j(Q.value(r.ForegroundColor)),HelpText:g,IsDefaultControl:c,IsHyperlink:p,key:r._name,Label:Q.value(r.Label),MaxValue:i,MinValue:l,Name:r._name,OnEditClick:G(r.Root),OnLinkNavigate:h,OnMouseEnter:m,OnMouseLeave:v,PlaceholderText:Q.value(r.PlaceHolder),Required:Q.value(r.Required),RotateSign:Q.util.stringToBoolean(Q.value(r.RotateSign)),SetValidity:s,SetValue:a,ShowLabel:Q.value(r.ShowLabel),ShowLookupButton:Q.value(r.LookupButton),ShowZero:d,SignDisplay:I(r),Skip:Q.value(r.Skip),ThousandSeparator:"",TotalType:Q.value(r.TotalType),Width:t.width,WidthMode:t.widthMode},f={},b=Q.value(r.ExtendedStyle);b&&(f.className=b);var C=Q.value(r.Alignment);C&&"Auto"!==C&&(f.Alignment=C.toLowerCase()),Q.value(r.LookupButton)?Q.util.objectAssign(y,q(r)):r.TextChanged&&(f.OnChange=function(e){Q.callFunction(this.TextChanged,this,[e])}.bind(r));var w=[];Q.value(r.DisplayOptions)&&!$.isEmptyObject(Q.value(r.DisplayOptions))&&(w.push("ContainerStyle","InputStyle","UseColorOnSelectedRow"),f.ContainerStyle={FieldName:H(r._name,"ContainerStyle"),DataSourceName:r.DataSourceName},f.InputStyle={FieldName:H(r._name,"InputStyle"),DataSourceName:r.DataSourceName},f.UseColorOnSelectedRow={FieldName:H(r._name,"UseColorOnSelectedRow"),DataSourceName:r.DataSourceName});var _=Q.util.createBigNumOptions(r);if(r.BigNumber=new ControlLibrary.BigNumber(_),r.maxBigNumber=new ControlLibrary.BigNumber(_),r.maxBigNumber.SetValue(i),r.minBigNumber=new ControlLibrary.BigNumber(_),r.minBigNumber.SetValue(l),r.copyForExcel=function(e){var t=r.listControl.groupingManager.rowIndexToCollectionIndex(e.RowIndex),o=r.listControl.getCollectionData(t,r.FieldName,r.DataSourceName);return r.BigNumber.SetValue(o),r.BigNumber.GetValue()},r.pasteFromExcel=function(e,t){if(r.BigNumber){var o=!0,n="";if(r.BigNumber.SetLocalizedValue(e),r.BigNumber.IsNaN()?(o=!1,n=Q.format(Q.label("Input_InvalidNumberValue"),e,r.Label?r.Label:r.Name)):r.BigNumber.IsNegative()&&!T(r)?(o=!1,n=Q.format(Q.label("Input_PositiveOnly"),r.Label?r.Label:r.Name,e)):(0<r.BigNumber.CompareToBigNumber(r.maxBigNumber)||r.BigNumber.CompareToBigNumber(r.minBigNumber)<0)&&(o=!1,n=Q.format(Q.label("Input_ValueOutOfRange"),r.minBigNumber.GetValue(),r.maxBigNumber.GetValue())),o){var i=r.BigNumber.IsBlank()?"":r.BigNumber.GetNumberString();a(i,t)}else s({messages:[n],userValue:e,valid:!1},t)}},r.FieldName?(w.push("Value","Validity","DataVersion"),f.Value={FieldName:r.FieldName,DataSourceName:r.DataSourceName},f.Validity={FieldName:H(r._name,"Validity"),DataSourceName:r.DataSourceName},f.DataVersion={FieldName:H(r._name,"DataVersion"),DataSourceName:r.DataSourceName}):f.Value=Q.value(r.Value),f.BoundProperties=w,B(o))f.OnChange=o.OnChange,f.Id=r._name,Q.util.objectAssign(y,f),e=React.createElement(ControlLibrary.IntEdit,y);else{f.Id=V(r._name,r.Root);var S={IsFixed:Q.controls.ReactList.freezingEnabled()&&Q.value(r.IsFrozen)};Q.util.objectAssign(y,f,S),e=React.createElement(ControlLibrary.IntEditCell,y)}}return e}Q.reactGrid.registerColumn("Integer",t),Q.reactGrid.registerColumn("Int64",t);var i={Alignment:!0,AllowNegative:!0,AllowTotal:!0,DisplaceNegative:!0,RotateSign:!0,ShowZero:!0,SignDisplay:!0,TotalShown:!0,TotalType:!0};Q.reactGrid.registerControlProperties("Integer",i),Q.reactGrid.registerControlProperties("Int64",i),Q.reactGrid.registerColumn("Real",function(r,o){var e=null;if(Q.value(r.Visible)){var t=z(r,Q.value(r.LookupButton)),n=0;"Auto"!==Q.value(r.DisplaceNegative)&&(n=parseInt(Q.value(r.DisplaceNegative),10));var a=function(t,e){var n=this,i=this.listControl.syncManager,o=this.listControl.getTrackingIdFromRowIndex(e.RowIndex);i.setInternalValue(t,this.FieldName,this.DataSourceName,o),i.changeData(o,this.Name,function(o){K.apply(n);function e(e){if(i)if(i.hasDataInteractions(o,n.Name))Q.log.syncManager&&Q.log.syncManager("SetValue callback ignored due to another SetValue being queued (rowId, control): (%s, %s)",o,n.Name);else{var t=i.clearInternalValue(o,n.FieldName,n.DataSourceName);Q.util.stringToBoolean(e)&&i.setValidity({override:void 0},o,n._name,n.DataSourceName),t&&i.setDataVersion(o,n._name,n.DataSourceName)}}Q.callFunction(n.SetValue,n,[t],e,null,null,null,e)},function(e){i&&i.clearInternalValue(e,n.FieldName,n.DataSourceName)&&i.setDataVersion(e,n._name,n.DataSourceName)},function(e){i&&i.setInternalValue(t,n.FieldName,n.DataSourceName,e)})}.bind(r);r.SetValueInternal=a,r.Shortcuts=Q.controls.Real.prototype.Shortcuts;var s=W.bind(r);r.SetValidityInternal=s;var i=Q.value(r.ShowZero),l="Auto"===i;l=l||Q.util.stringToBoolean(i);var u=O(o)&&o.NavigationEnabled&&r._name===o.DefaultControl||B(o)&&o.IsDefaultControl,d=Q.value(r.IsHyperlink),c=u||d?function(e){if(O(o)&&o.NavigationEnabled&&e.IsDefaultControl)o.NavigationAction(e.RowIndex);else if(B(o)&&o.IsDefaultControl&&o.ParentProps.NavigationEnabled)o.ParentProps.NavigationAction(e.RowIndex);else{if(r.listControl&&r.listControl.syncManager&&r.listControl.syncManager.RailsMode||O(o)&&o.ForceNavigationAction&&o.NavigationAction)return;Q.getFunction(r.ExecuteHyperlink)()}}:null,p=function(e,t){Q.value(this.CanHavePreview)&&Q.value(this.RequestEnhancedPreview)&&o.OnMouseEnter&&o.OnMouseEnter(e,t)}.bind(r),h=function(e,t){Q.value(this.CanHavePreview)&&Q.value(this.RequestEnhancedPreview)&&o.OnMouseLeave&&o.OnMouseLeave(e,t)}.bind(r),m=Q.value(r.HelpText);(d||u)&&(m=Q.label("ReactGrid_FollowLink"));var v={AllowEdit:Q.value(r.AllowEdit),AllowNegativeValue:T(r),AllowTotal:Q.value(r.AllowTotal),BackgroundColor:j(Q.value(r.BackgroundColor)),DisplaceNegative:n,Enabled:Q.value(r.Enabled),ForegroundColor:j(Q.value(r.ForegroundColor)),HelpText:m,IsDefaultControl:u,IsHyperlink:d,key:r._name,Label:Q.value(r.Label),Name:r._name,OnEditClick:G(r.Root),OnLinkNavigate:c,OnMouseEnter:p,OnMouseLeave:h,PlaceholderText:Q.value(r.PlaceHolder),Required:Q.value(r.Required),RotateSign:Q.util.stringToBoolean(Q.value(r.RotateSign)),SetValidity:s,SetValue:a,ShowLabel:Q.value(r.ShowLabel),ShowLookupButton:Q.value(r.LookupButton),ShowZero:l,SignDisplay:I(r),Skip:Q.value(r.Skip),SupportsCorrection:Q.value(r.SupportsCorrection),TotalType:Q.value(r.TotalType),Width:t.width,WidthMode:t.widthMode},g={};void 0!==Q.value(r.NoOfDecimals)&&"Auto"!==Q.value(r.NoOfDecimals)&&(g.NumberOfDecimals=Q.value(r.NoOfDecimals)),void 0!==Q.value(r.MinNoOfDecimals)&&"Auto"!==Q.value(r.MinNoOfDecimals)&&(g.MinNumberOfDecimals=Q.value(r.MinNoOfDecimals));var y=Q.value(r.ExtendedStyle);y&&(g.className=y);var f=Q.value(r.Alignment);f&&"Auto"!==f&&(g.Alignment=f.toLowerCase()),Q.value(r.LookupButton)?Q.util.objectAssign(v,q(r)):r.TextChanged&&(g.OnChange=function(e){Q.callFunction(this.TextChanged,this,[e])}.bind(r));var b=Q.value(r.ThousandSeparator);if(void 0!==b&&b!==Q.ui.ThousandSeparator.auto)switch(b){case Q.ui.ThousandSeparator.none:g.ThousandSeparator="";break;case Q.ui.ThousandSeparator.comma:g.ThousandSeparator=",";break;case Q.ui.ThousandSeparator.space:g.ThousandSeparator=" ";break;case Q.ui.ThousandSeparator.apostrophe:g.ThousandSeparator="'";break;case Q.ui.ThousandSeparator.dot:g.ThousandSeparator="."}var C=Q.value(r.DecimalSeparator);if(void 0!==C&&C!==Q.ui.DecimalSeparator.auto)switch(C){case Q.ui.DecimalSeparator.comma:g.DecimalSeparator=",";break;case Q.ui.DecimalSeparator.dot:g.DecimalSeparator="."}var w=[];Q.value(r.DisplayOptions)&&!$.isEmptyObject(Q.value(r.DisplayOptions))&&(w.push("ContainerStyle","InputStyle","UseColorOnSelectedRow"),g.ContainerStyle={FieldName:H(r._name,"ContainerStyle"),DataSourceName:r.DataSourceName},g.InputStyle={FieldName:H(r._name,"InputStyle"),DataSourceName:r.DataSourceName},g.UseColorOnSelectedRow={FieldName:H(r._name,"UseColorOnSelectedRow"),DataSourceName:r.DataSourceName}),Q.value(r.SupportsCorrection)?(w.push("IsCorrection"),g.IsCorrection={FieldName:H(r._name,"IsCorrection"),DataSourceName:r.DataSourceName}):g.IsCorrection=!1,r.FieldName?(w.push("Value","Validity","DataVersion"),g.Validity={FieldName:H(r._name,"Validity"),DataSourceName:r.DataSourceName},g.Value={FieldName:r.FieldName,DataSourceName:r.DataSourceName},g.DataVersion={FieldName:H(r._name,"DataVersion"),DataSourceName:r.DataSourceName}):g.Value=Q.value(r.Value);var _=Q.util.createBigNumOptions(r);if(r.BigNumber||(r.BigNumber=new ControlLibrary.BigNumber(_)),r.maxBigNumber=new ControlLibrary.BigNumber(_),r.maxBigNumber.SetValue("999999999999999.99"),r.minBigNumber=new ControlLibrary.BigNumber(_),r.minBigNumber.SetValue("-999999999999999.99"),r.copyForExcel=function(e){var t=r.listControl.groupingManager.rowIndexToCollectionIndex(e.RowIndex),o=r.listControl.getCollectionData(t,r.FieldName,r.DataSourceName);return r.BigNumber.SetValue(o),r.BigNumber.GetValue()},r.pasteFromExcel=function(e,t){if(r.BigNumber){var o=!0,n="";if(r.BigNumber.SetLocalizedValue(e),r.BigNumber.IsNaN()?(o=!1,n=Q.format(Q.label("Input_InvalidNumberValue"),e,r.Label?r.Label:r.Name)):r.BigNumber.IsNegative()&&!T(r)?(o=!1,n=Q.format(Q.label("Input_PositiveOnly"),r.Label?r.Label:r.Name,e)):(0<r.BigNumber.CompareToBigNumber(r.maxBigNumber)||r.BigNumber.CompareToBigNumber(r.minBigNumber)<0)&&(o=!1,n=Q.format(Q.label("Input_ValueOutOfRange"),r.minBigNumber.GetValue(),r.maxBigNumber.GetValue())),o){var i=r.BigNumber.IsBlank()?"":r.BigNumber.GetNumberString();a(i,t)}else s({messages:[n],userValue:e,valid:!1},t)}},g.BoundProperties=w,B(o))g.Id=r._name,g.OnChange=o.OnChange,Q.util.objectAssign(v,g),e=React.createElement(ControlLibrary.RealEdit,v);else{g.Id=V(r._name,r.Root);var S={IsFixed:Q.controls.ReactList.freezingEnabled()&&Q.value(r.IsFrozen)};Q.util.objectAssign(v,g,S),e=React.createElement(ControlLibrary.RealEditCell,v)}}return e}),Q.reactGrid.registerControlProperties("Real",{Alignment:!0,AllowNegative:!0,AllowTotal:!0,DecimalSeparator:!0,DisplaceNegative:!0,MinNoOfDecimals:!0,NoOfDecimals:!0,RotateSign:!0,ShowZero:!0,SignDisplay:!0,SupportsCorrection:!0,ThousandSeparator:!0,TotalShown:!0,TotalType:!0}),Q.reactGrid.registerColumn("Time",function(t,o){var e=null;if(Q.value(t.Visible)){var n=z(t,!0),i="auto"===Q.value(t.TimeFormat).toLowerCase()?void 0:"hour24"===Q.value(t.TimeFormat).toLowerCase(),r=U(t),a=function(t,e){var n=this,i=this.listControl.syncManager,o=this.listControl.getTrackingIdFromRowIndex(e.RowIndex);i.setInternalValue(t,this.FieldName,this.DataSourceName,o),i.changeData(o,this.Name,function(o){K.apply(n);function e(e){if(i)if(i.hasDataInteractions(o,n.Name))Q.log.syncManager&&Q.log.syncManager("SetValue callback ignored due to another SetValue being queued (rowId, control): (%s, %s)",o,n.Name);else{var t=i.clearInternalValue(o,n.FieldName,n.DataSourceName);Q.util.stringToBoolean(e)&&i.setValidity({override:void 0},o,n._name,n.DataSourceName),t&&i.setDataVersion(o,n._name,n.DataSourceName)}}Q.callFunction(n.SetValue,n,[t],e,null,null,null,e)},function(e){i&&i.clearInternalValue(e,n.FieldName,n.DataSourceName)&&i.setDataVersion(e,n._name,n.DataSourceName)},function(e){i&&i.setInternalValue(t,n.FieldName,n.DataSourceName,e)})}.bind(t);t.SetValueInternal=a,t.Shortcuts=Q.controls.Time.prototype.Shortcuts;var s=G(t.Root),l=W.bind(t);t.SetValidityInternal=l;var u=O(o)&&o.NavigationEnabled&&t._name===o.DefaultControl||B(o)&&o.IsDefaultControl,d=Q.value(t.IsHyperlink),c=u||d?function(e){if(O(o)&&o.NavigationEnabled&&e.IsDefaultControl)o.NavigationAction(e.RowIndex);else if(B(o)&&o.IsDefaultControl&&o.ParentProps.NavigationEnabled)o.ParentProps.NavigationAction(e.RowIndex);else{if(t.listControl&&t.listControl.syncManager&&t.listControl.syncManager.RailsMode||O(o)&&o.ForceNavigationAction&&o.NavigationAction)return;Q.getFunction(t.ExecuteHyperlink)()}}:null,p=function(e,t){Q.value(this.CanHavePreview)&&Q.value(this.RequestEnhancedPreview)&&o.OnMouseEnter&&o.OnMouseEnter(e,t)}.bind(t),h=function(e,t){Q.value(this.CanHavePreview)&&Q.value(this.RequestEnhancedPreview)&&o.OnMouseLeave&&o.OnMouseLeave(e,t)}.bind(t),m=Q.value(t.HelpText);(d||u)&&(m=Q.label("ReactGrid_FollowLink"));var v={AllowEdit:Q.value(t.AllowEdit),BackgroundColor:j(Q.value(t.BackgroundColor)),Enabled:Q.value(t.Enabled),ForegroundColor:j(Q.value(t.ForegroundColor)),HelpText:m,Is24Hour:i,IsDefaultControl:u,IsHyperlink:d,key:t._name,Label:Q.value(t.Label),Name:t._name,OnEditClick:s,OnLinkNavigate:c,OnMouseEnter:p,OnMouseLeave:h,PlaceholderText:Q.value(t.PlaceHolder),Required:Q.value(t.Required),Separator:r,SetValidity:l,SetValue:a,ShowHours:Q.value(t.TimeHours),ShowLabel:Q.value(t.ShowLabel),ShowLookupButton:Q.value(t.LookupButton),ShowMinutes:Q.value(t.TimeMinutes),ShowSeconds:Q.value(t.TimeSeconds),Skip:Q.value(t.Skip),Width:n.width,WidthMode:n.widthMode},g={},y=Q.value(t.ExtendedStyle);y&&(g.className=y);var f=Q.value(t.Alignment);f&&"Auto"!==f&&(g.Alignment=f.toLowerCase()),Q.value(t.LookupButton)?Q.util.objectAssign(v,q(t)):t.TextChanged&&(g.OnChange=function(e){Q.callFunction(this.TextChanged,this,[e])}.bind(t));var b=[];if(Q.value(t.DisplayOptions)&&!$.isEmptyObject(Q.value(t.DisplayOptions))&&(b.push("ContainerStyle","InputStyle","UseColorOnSelectedRow"),g.ContainerStyle={FieldName:H(t._name,"ContainerStyle"),DataSourceName:t.DataSourceName},g.InputStyle={FieldName:H(t._name,"InputStyle"),DataSourceName:t.DataSourceName},g.UseColorOnSelectedRow={FieldName:H(t._name,"UseColorOnSelectedRow"),DataSourceName:t.DataSourceName}),t.copyForExcel=function(e){var t=this.listControl.groupingManager.rowIndexToCollectionIndex(e.RowIndex),o=this.listControl.getCollectionData(t,this.FieldName,this.DataSourceName);return Q.controls.Time.getFormattedValueForControl(o,this)}.bind(t),t.pasteFromExcel=function(e,t){var o=moment.utc(e,"hh:mm:ss A"),n=0;o&&o.isValid()&&(n=3600*o.hour()+60*o.minute()+o.second()),a(n,t)},t.FieldName?(b.push("Value","Validity","DataVersion"),g.Validity={FieldName:H(t._name,"Validity"),DataSourceName:t.DataSourceName},g.Value={FieldName:t.FieldName,DataSourceName:t.DataSourceName},g.DataVersion={FieldName:H(t._name,"DataVersion"),DataSourceName:t.DataSourceName}):g.Value=Q.value(t.Value),g.BoundProperties=b,B(o))g.Id=t._name,g.OnChange=o.OnChange,Q.util.objectAssign(v,g),e=React.createElement(ControlLibrary.TimeEdit,v);else{g.Id=V(t._name,t.Root);var C={IsFixed:Q.controls.ReactList.freezingEnabled()&&Q.value(t.IsFrozen)};Q.util.objectAssign(v,g,C),e=React.createElement(ControlLibrary.TimeEditCell,v)}}return e}),Q.reactGrid.registerControlProperties("Time",{Alignment:!0,TimeFormat:!0,TimeHours:!0,TimeMinutes:!0,TimeSeconds:!0,TimeSeparator:!0});function r(t,o){var e=null;if(Q.value(t.Visible)){var n=z(t,!0),i="DateTime"===t.TypeName,r=function(t,e){var n=this,i=this.listControl.syncManager,o=this.listControl.getTrackingIdFromRowIndex(e.RowIndex);i.setInternalValue(t,this.FieldName,this.DataSourceName,o),i.changeData(o,this.Name,function(o){K.apply(n);function e(e){if(i)if(i.hasDataInteractions(o,n.Name))Q.log.syncManager&&Q.log.syncManager("SetValue callback ignored due to another SetValue being queued (rowId, control): (%s, %s)",o,n.Name);else{var t=i.clearInternalValue(o,n.FieldName,n.DataSourceName);Q.util.stringToBoolean(e)&&i.setValidity({override:void 0},o,n._name,n.DataSourceName),t&&i.setDataVersion(o,n._name,n.DataSourceName)}}Q.callFunction(n.SetValue,n,[t],e,null,null,null,e)},function(e){i&&i.clearInternalValue(e,n.FieldName,n.DataSourceName)&&i.setDataVersion(e,n._name,n.DataSourceName)},function(e){i&&i.setInternalValue(t,n.FieldName,n.DataSourceName,e)})}.bind(t);t.SetValueInternal=r,t.Shortcuts=Q.controls.Date.prototype.Shortcuts;var a=W.bind(t);t.SetValidityInternal=a;var s=G(t.Root),l=function(e){var t;switch(Q.value(e.DateFormat)){case Q.ui.DateFormat.YMD:t="y/M/d";break;case Q.ui.DateFormat.YDM:t="y/d/M";break;case Q.ui.DateFormat.MYD:t="M/y/d";break;case Q.ui.DateFormat.MDY:t="M/d/y";break;case Q.ui.DateFormat.DYM:t="d/y/M";break;case Q.ui.DateFormat.DMY:t="d/M/y";break;case Q.ui.DateFormat.auto:default:t=void 0}return t}(t),u=void 0;if(Q.value(t.DateDay))switch(Q.value(t.DateDay).toLowerCase()){case"none":u="";break;case"digits1or2":u="D";break;case"digits2":u="DD"}var d=void 0;if(Q.value(t.DateMonth))switch(Q.value(t.DateMonth).toLowerCase()){case"none":d="";break;case"digits1or2":d="M";break;case"digits2":d="MM";break;case"short":d="MMM";break;case"long":d="MMMM"}var c=void 0;if(Q.value(t.DateYear))switch(Q.value(t.DateYear).toLowerCase()){case"none":c="";break;case"digits2":c="YY";break;case"digits4":c="YYYY"}var p=void 0,h=void 0;if("Auto"!==Q.value(t.DateSeparator)){var m=void 0;Q.value(t.DateSeparator)&&("n"===(p=(m=Q.value(t.DateSeparator).replace(/\(space\)/gi," ").replace(/\(none\)/gi,"n")).substr(0,1))&&(p=""),"n"===(h=m.substr(1,1))&&(h=""))}var v=O(o)&&o.NavigationEnabled&&t._name===o.DefaultControl||B(o)&&o.IsDefaultControl,g=Q.value(t.IsHyperlink),y=v||g?function(e){if(O(o)&&o.NavigationEnabled&&e.IsDefaultControl)o.NavigationAction(e.RowIndex);else if(B(o)&&o.IsDefaultControl&&o.ParentProps.NavigationEnabled)o.ParentProps.NavigationAction(e.RowIndex);else{if(t.listControl&&t.listControl.syncManager&&t.listControl.syncManager.RailsMode||O(o)&&o.ForceNavigationAction&&o.NavigationAction)return;Q.getFunction(t.ExecuteHyperlink)()}}:null,f=function(e,t){Q.value(this.CanHavePreview)&&Q.value(this.RequestEnhancedPreview)&&o.OnMouseEnter&&o.OnMouseEnter(e,t)}.bind(t),b=function(e,t){Q.value(this.CanHavePreview)&&Q.value(this.RequestEnhancedPreview)&&o.OnMouseLeave&&o.OnMouseLeave(e,t)}.bind(t),C=Q.value(t.HelpText);(g||v)&&(C=Q.label("ReactGrid_FollowLink"));var w=Q.user()?Q.user().UserSessionDate():void 0;w=w&&moment.utc(w).format("YYYY-MM-DD");var _={AllowEdit:Q.value(t.AllowEdit),AlternateToday:w,BackgroundColor:j(Q.value(t.BackgroundColor)),DateDay:u,DateFormat:l,DateMonth:d,DateSeparator1:p,DateSeparator2:h,DateYear:c,Enabled:Q.value(t.Enabled),ForegroundColor:j(Q.value(t.ForegroundColor)),HelpText:C,IsDefaultControl:v,IsHyperlink:g,key:t._name,Label:Q.value(t.Label),MaxDateLabel:Q.value(t.MaxDateLabel),Name:t._name,OnEditClick:s,OnLinkNavigate:y,OnMouseEnter:f,OnMouseLeave:b,PlaceholderText:Q.value(t.PlaceHolder),Required:Q.value(t.Required),SetValidity:a,SetValue:r,ShowLabel:Q.value(t.ShowLabel),ShowLookupButton:Q.value(t.LookupButton)&&Q.value(t.CanOpenLookupForm),Skip:Q.value(t.Skip),UseUserTimeZone:!0,ValueInUtc:!0,Width:n.width,WidthMode:n.widthMode};if(i){var S=Q.value(t.TimeFormat)&&"Auto"!==Q.value(t.TimeFormat)?"hour24"===Q.value(t.TimeFormat).toLowerCase():void 0,I=U(t),T=Q.value(t.TimeZonePreference)!==Q.util.TimeZonePreference.none,x="Date"!==Q.value(t.DisplayOption);Q.util.objectAssign(_,{IgnoreTime:!1,Is24Hour:S,ShowHours:x&&Q.value(t.TimeHours),ShowLabel:Q.value(t.ShowLabel),ShowMinutes:x&&Q.value(t.TimeMinute),ShowSeconds:x&&Q.value(t.TimeSeconds),TimeSeparator:I,TimeZoneName:Q.value(t.ShowTimeZoneIndicator)?Q.value(t.TimeZoneName):"",UseUserTimeZone:T});var F=Q.util.getDateFormat(t),k=Q.util.getTimeFormat(t),P=F;if(""!==k.display){var R=F.parse.slice(),M=(P.display?" ":"")+k.display;P.display+=M,P.parse.forEach(function(e,t,o){o[t]=e+M}),Array.prototype.push.apply(P.parse,R),t._dateFormats=P,t.errorMessageLabel="Input_InvalidDateTimeValue"}}else t._dateFormats=Q.util.getDateFormat(t),t.errorMessageLabel="Input_InvalidDateValue";var E={},N=Q.value(t.ExtendedStyle);N&&(E.className=N);var A=Q.value(t.Alignment);A&&"Auto"!==A&&(E.Alignment=A.toLowerCase()),Q.value(t.LookupButton)&&Q.value(t.CanOpenLookupForm)?Q.util.objectAssign(_,q(t)):t.TextChanged&&(E.OnChange=function(e){Q.callFunction(this.TextChanged,this,[e])}.bind(t));var D=[];if(Q.value(t.DisplayOptions)&&!$.isEmptyObject(Q.value(t.DisplayOptions))&&(D.push("ContainerStyle","InputStyle","UseColorOnSelectedRow"),E.ContainerStyle={FieldName:H(t._name,"ContainerStyle"),DataSourceName:t.DataSourceName},E.InputStyle={FieldName:H(t._name,"InputStyle"),DataSourceName:t.DataSourceName},E.UseColorOnSelectedRow={FieldName:H(t._name,"UseColorOnSelectedRow"),DataSourceName:t.DataSourceName}),t.copyForExcel=function(e){var t=this.listControl.groupingManager.rowIndexToCollectionIndex(e.RowIndex),o=this.listControl.getCollectionData(t,this.FieldName,this.DataSourceName);return Q.controls.DateTime.getFormattedValueForControl(o,this)}.bind(t),t.pasteFromExcel=function(e,t){if(this._dateFormats)if(e){var o=void 0;if((o=i&&Q.value(this.TimeZonePreference)!==Q.util.TimeZonePreference.none?moment.tz(e,this._dateFormats.parse,"User"):moment.utc(e,this._dateFormats.parse))&&o.isValid()){var n=i?"YYYY-MM-DDTHH:mm:ss":"YYYY-MM-DD";e=o.utc().format(n),r(e,t)}else a({messages:[Q.format(Q.label(this.errorMessageLabel),e,this._dateFormats.display)],userValue:e,valid:!1},t)}else r("",t)}.bind(t),E.BoundProperties=D,t.FieldName?(D.push("Value","Validity","DataVersion"),E.Validity={FieldName:H(t._name,"Validity"),DataSourceName:t.DataSourceName},E.Value={FieldName:t.FieldName,DataSourceName:t.DataSourceName},E.DataVersion={FieldName:H(t._name,"DataVersion"),DataSourceName:t.DataSourceName}):E.Value=Q.value(t.Value),B(o))E.Id=t._name,E.OnChange=o.OnChange,Q.util.objectAssign(_,E),e=React.createElement(ControlLibrary.DateEdit,_);else{E.Id=V(t._name,t.Root);var L={IsFixed:Q.controls.ReactList.freezingEnabled()&&Q.value(t.IsFrozen)};Q.util.objectAssign(_,E,L),e=React.createElement(ControlLibrary.DateEditCell,_)}}return e}Q.reactGrid.registerColumn("Date",r),Q.reactGrid.registerColumn("DateTime",r);var a={Alignment:!0,CanOpenLookupForm:!0,DateDay:!0,DateFormat:!0,DateMonth:!0,DateSeparator:!0,DateYear:!0,DisplayOption:!0,ShowTimeZoneIndicator:!0,TimeFormat:!0,TimeHours:!0,TimeMinute:!0,TimeSeconds:!0,TimeSeparator:!0,TimeZoneName:!0,TimeZonePreference:!0};Q.reactGrid.registerControlProperties("Date",a),Q.reactGrid.registerControlProperties("DateTime",a),Q.reactGrid.registerColumn("ComboBox",function(n,o){var e=null;if(Q.value(n.Visible)){var t=z(n,!0),i=Q.value(n.Items),r=Q.util.convertItems(i);n.ComboBoxItems=r;var a=function(t,e){var n=this,i=this.listControl.syncManager,o=this.listControl.getTrackingIdFromRowIndex(e.RowIndex);i.setInternalValue(t,this.FieldName,this.DataSourceName,o),i.changeData(o,this.Name,function(o){K.apply(n);function e(e){if(i)if(i.hasDataInteractions(o,n.Name))Q.log.syncManager&&Q.log.syncManager("SetSelectedItem callback ignored due to another SetSelectedItem being queued (rowId, control): (%s, %s)",o,n.Name);else{var t=i.clearInternalValue(o,n.FieldName,n.DataSourceName);Q.util.stringToBoolean(e)&&i.setValidity({override:void 0},o,n._name,n.DataSourceName),t&&i.setDataVersion(o,n._name,n.DataSourceName)}}Q.callFunction(n.SetSelectedItem,n,[t],e,null,null,null,e)},function(e){i&&i.clearInternalValue(e,n.FieldName,n.DataSourceName)&&i.setDataVersion(e,n._name,n.DataSourceName)},function(e){i&&i.setInternalValue(t,n.FieldName,n.DataSourceName,e)})}.bind(n);n.SetSelectedItemInternal=a,n.Shortcuts=Q.controls.ComboBox.prototype.Shortcuts;var s=W.bind(n),l=Q.value(n.IsHyperlink),u=l?function(e){n.listControl&&n.listControl.syncManager&&n.listControl.syncManager.RailsMode||O(o)&&o.ForceNavigationAction&&o.NavigationAction||Q.getFunction(n.ExecuteHyperlink)()}:null,d=function(e,t){Q.value(this.CanHavePreview)&&Q.value(this.RequestEnhancedPreview)&&o.OnMouseEnter&&o.OnMouseEnter(e,t)}.bind(n),c=function(e,t){Q.value(this.CanHavePreview)&&Q.value(this.RequestEnhancedPreview)&&o.OnMouseLeave&&o.OnMouseLeave(e,t)}.bind(n),p=Q.value(n.HelpText);l&&(p=Q.label("ReactGrid_FollowLink"));var h={AllowEdit:Q.value(n.AllowEdit),AllowEnterToOpenPopup:Q.util.isFlightEnabled(Q.controls.standardizeKeyboardInteractionFeature),Enabled:Q.value(n.Enabled),HelpText:p,IsHyperlink:l,Items:r,key:n._name,Label:Q.value(n.Label),Name:n._name,OnEditClick:G(n.Root),OnLinkNavigate:u,OnMouseEnter:d,OnMouseLeave:c,OnSelectedItem:a,Required:Q.value(n.Required),SetValidity:s,ShowLabel:Q.value(n.ShowLabel),Skip:Q.value(n.Skip),Width:t.width,WidthMode:t.widthMode},m={},v=Q.value(n.ExtendedStyle);v&&(m.className=v);var g=[];if(Q.value(n.DisplayOptions)&&!$.isEmptyObject(Q.value(n.DisplayOptions))&&(g.push("ContainerStyle","InputStyle","UseColorOnSelectedRow"),m.ContainerStyle={FieldName:H(n._name,"ContainerStyle"),DataSourceName:n.DataSourceName},m.InputStyle={FieldName:H(n._name,"InputStyle"),DataSourceName:n.DataSourceName},m.UseColorOnSelectedRow={FieldName:H(n._name,"UseColorOnSelectedRow"),DataSourceName:n.DataSourceName}),n.copyForExcel=function(e){var t=n.listControl.groupingManager.rowIndexToCollectionIndex(e.RowIndex),o=n.listControl.getCollectionData(t,n.FieldName,n.DataSourceName);return ControlLibrary.getSelectedText(o,r)},n.pasteFromExcel=function(e,t){var o=ControlLibrary.getSelectedItemByText(e,r);o&&a(o.value,t)},n.FieldName?(g.push("SelectedItem","Validity","DataVersion"),m.Validity={FieldName:H(n._name,"Validity"),DataSourceName:n.DataSourceName},m.SelectedItem={FieldName:n.FieldName,DataSourceName:n.DataSourceName},m.DataVersion={FieldName:H(n._name,"DataVersion"),DataSourceName:n.DataSourceName}):m.SelectedItem=Q.value(n.SelectedItem),m.BoundProperties=g,B(o))m.Id=n._name,m.OnChange=o.OnChange,Q.util.objectAssign(h,m),e=React.createElement(ControlLibrary.ComboBox,h);else{m.Id=V(n._name,n.Root);var y={IsFixed:Q.controls.ReactList.freezingEnabled()&&Q.value(n.IsFrozen)};Q.util.objectAssign(h,m,y),e=React.createElement(ControlLibrary.ComboBoxCell,h)}}return e}),Q.reactGrid.registerControlProperty("ComboBox","Items"),Q.reactGrid.registerColumn("CheckBox",function(n,o){var e=null;if(Q.value(n.Visible)){var t=z(n),i=function(e,t){var o=this,n=this.listControl.syncManager,i=this.listControl.getTrackingIdFromRowIndex(t.RowIndex),r=Q.util.stringToBoolean(e);n.setInternalValue(r?"1":"0",this.FieldName,this.DataSourceName,i),n.changeData(i,this.Name,function(e){function t(){n&&(n.hasDataInteractions(e,o.Name)?Q.log.syncManager&&Q.log.syncManager("SetValue callback ignored due to another SetValue being queued (rowId, control): (%s, %s)",e,o.Name):n.clearInternalValue(e,o.FieldName,o.DataSourceName)&&n.setDataVersion(e,o._name,o.DataSourceName))}Q.callFunction(o.SetValue,o,[r],t,null,null,null,t)},function(e){n.clearInternalValue(e,o.FieldName,o.DataSourceName)&&n.setDataVersion(e,o._name,o.DataSourceName)},function(e){n&&n.setInternalValue(r?"1":"0",o.FieldName,o.DataSourceName,e)})}.bind(n),r=function(e,t){Q.value(this.CanHavePreview)&&Q.value(this.RequestEnhancedPreview)&&o.OnMouseEnter&&o.OnMouseEnter(e,t)}.bind(n),a=function(e,t){Q.value(this.CanHavePreview)&&Q.value(this.RequestEnhancedPreview)&&o.OnMouseLeave&&o.OnMouseLeave(e,t)}.bind(n);n.SetValueInternal=i;var s="Box",l=!1,u=!1;Q.value(n.Style)===Q.ui.CheckBoxStyle.toggle&&(s="Toggle",u=l=!0);var d={AllowEdit:Q.value(n.AllowEdit),BoxType:s,Enabled:Q.value(n.Enabled),FalseText:Q.label("CheckBox_ToggleFalseText"),HelpText:Q.value(n.HelpText),key:n._name,Label:Q.value(n.Label),Name:n._name,OnMouseEnter:r,OnMouseLeave:a,SetValue:i,ShowAsTextOnlyIfReadOnly:u,ShowLabel:Q.value(n.ShowLabel),ShowText:l,Skip:Q.value(n.Skip),TrueText:Q.label("CheckBox_ToggleTrueText"),Width:t.width,WidthMode:t.widthMode},c={},p=Q.value(n.ExtendedStyle);if(p&&(c.className=p),n.copyForExcel=function(e){var t=n.listControl.groupingManager.rowIndexToCollectionIndex(e.RowIndex),o=n.listControl.getCollectionData(t,n.FieldName,n.DataSourceName);return ControlLibrary.getCheckedValue(o)},n.pasteFromExcel=i,n.Shortcuts=Q.controls.CheckBox.prototype.Shortcuts,n.FieldName?(c.BoundProperties=["Value","DataVersion"],c.Value={FieldName:n.FieldName,DataSourceName:n.DataSourceName},c.DataVersion={FieldName:H(n._name,"DataVersion"),DataSourceName:n.DataSourceName}):Q.value(n.Value)&&(c.Value=Q.value(n.Value)),B(o))c.Id=n._name,c.OnChange=o.OnChange,Q.util.objectAssign(d,c),e=React.createElement(ControlLibrary.CheckBox,d);else{c.Id=V(n._name,n.Root),Q.value(o.Mode)===Q.ui.ListMode.list&&(c.BoxType="TextOnly",c.ShowText=!0);var h={IsFixed:Q.controls.ReactList.freezingEnabled()&&Q.value(n.IsFrozen)};Q.util.objectAssign(d,c,h),e=React.createElement(ControlLibrary.CheckBoxCell,d)}}return e}),Q.reactGrid.registerControlProperty("CheckBox","Style"),Q.reactGrid.registerColumn("Image",function(e,o){var t,n,i=null;if(Q.value(e.Visible)){var r=z(e),a=H(e._name,"Value"),s=function(e,t){Q.value(this.CanHavePreview)&&Q.value(this.RequestEnhancedPreview)&&o.OnMouseEnter&&o.OnMouseEnter(e,t)}.bind(e),l=function(e,t){Q.value(this.CanHavePreview)&&Q.value(this.RequestEnhancedPreview)&&o.OnMouseLeave&&o.OnMouseLeave(e,t)}.bind(e),u=e.DataSourceName;!u&&Q.isServerBoundDataSource(null===(t=e.listControl)||void 0===t?void 0:t.DataSource)&&(u=null===(n=e.listControl)||void 0===n?void 0:n.DataSource.__dataSourceName);var d={BoundProperties:["EncodedData"],EncodedData:{FieldName:a,DataSourceName:u},FitMode:"fit",Height:r.height,HeightMode:r.heightMode,HelpText:Q.value(e.HelpText),Id:V(e._name,e.Root),IsFixed:Q.controls.ReactList.freezingEnabled()&&Q.value(e.IsFrozen),key:e._name,Label:Q.value(e.Label),Name:e._name,OnMouseEnter:s,OnMouseLeave:l,ShowLabel:Q.value(e.ShowLabel),Skip:Q.value(e.Skip),Width:r.width,WidthMode:r.widthMode};e.Shortcuts=Q.controls.Image.prototype.Shortcuts;var c={},p=Q.value(e.ExtendedStyle);if(p&&"image_personProfile"===(c.className=p)&&(c.Rounded=!0),e.Click){var h=function(){Q.value(this.Enabled)&&Q.callFunction(this.Click,this)}.bind(e);c.OnClick=function(e,t){var o=this.listControl.getTrackingIdFromRowIndex(t.RowIndex),n=Q.value(this.listControl.SelectedRowTrackingId);void 0!==o&&o!==n?this.listControl.syncManager.queueDependentRowAction(o,"imageClick_"+this.Name,h):h()}.bind(e)}"AppListGrid"===o.Name&&"AppIconAndColor"===e._name&&(c.Rounded=!0,d.BoundProperties.push("BackgroundColor"),c.BackgroundColor={FieldName:H("AppIconAndColor","BackgroundColor"),DataSourceName:e.DataSourceName}),e.copyForExcel=function(e){return""},Q.util.objectAssign(d,c),i=React.createElement(ControlLibrary.ImageEditCell,d)}return i}),Q.reactGrid.registerColumn("ReferenceGroup",function(e,t){var o,n,i=null;if(Q.value(e.Visible)){var r=z(e,!0),a=[],s=[],l={},u=e._element||e.element;if(u){var d={DataSourceName:[],FieldName:[]},c=q(e),p=t.NavigationEnabled&&e._name===t.DefaultControl,h=Q.value(u.dynChildren);if(h)try{for(var m=__values(h),v=m.next();!v.done;v=m.next()){var g=v.value,y=Q.controlOptions(g);y.ReferenceGroup=e,y.listControl=e.listControl,y.Root=e.Root,y.Name=y._name,d.FieldName.push(y.FieldName),d.DataSourceName.push(y.DataSourceName);var f={IsDefaultControl:p,OnChange:c.OnChange,OnMouseEnter:t.OnMouseEnter,OnMouseLeave:t.OnMouseLeave,ParentProps:t,Type:"ReferenceGroup"},b=Q.reactGrid.generateColumn(y,f);b&&a.push(b),l[y.Name]=s.length,s.push(y),e.listControl.refGroupChildIndexUpdate(y.Name,e.Name)}}catch(e){o={error:e}}finally{try{v&&!v.done&&(n=m.return)&&n.call(m)}finally{if(o)throw o.error}}e.ChildCols=s,e.ChildNameToColIndex=l;var C=W.bind(e),w=function(e){var t=this;this.listControl.syncManager.changeData(this.listControl.getTrackingIdFromRowIndex(e.RowIndex),this.Name,function(e){K.apply(t),Q.callFunction(t.ResolveChanges,t,void 0,null,null,null,null,null)})}.bind(e);e.pasteFromExcel=w,e.ResolveChangesInternal=w,e.Shortcuts=Q.controls.ReferenceGroup.prototype.Shortcuts;var _={AllowEdit:Q.value(e.AllowEdit),AllowEnterToOpenPopup:Q.util.isFlightEnabled(Q.controls.standardizeKeyboardInteractionFeature),BoundProperties:["ChildValues","Validity","DataVersion"],ChildValues:d,CloseLookup:c.CloseLookup,DataVersion:{FieldName:H(e._name,"DataVersion"),DataSourceName:e.DataSourceName},Enabled:Q.value(e.Enabled),HasContent:!1,HelpText:Q.value(e.HelpText),Id:V(e._name,e.Root),IsDefaultControl:p,IsFixed:Q.controls.ReactList.freezingEnabled()&&Q.value(e.IsFrozen),IsHyperlink:Q.value(e.IsHyperlink),key:e._name,Label:Q.value(e.Label),Name:e._name,OnBlur:c.OnBlur,OnFocus:c.OnFocus,OnKeyDown:c.OnKeyDown,OnKeyUp:c.OnKeyUp,OpenLookup:c.OpenLookup,Required:Q.value(e.Required),ResolveValues:w,SetValidity:C,ShowLabel:Q.value(e.ShowLabel),Skip:Q.value(e.Skip),Validity:{FieldName:H(e._name,"Validity"),DataSourceName:e.DataSourceName},Width:r.width,WidthMode:r.widthMode},S={},I=Q.value(e.ExtendedStyle);I&&(S.className=I),Q.util.objectAssign(_,S),i=React.createElement(ControlLibrary.ReferenceGroupCell,_,a)}}return i}),Q.reactGrid.registerColumn("Input",function(o,n){var e=null;if(Q.value(o.Visible)){var t=z(o,Q.value(o.LookupButton)),i=O(n)&&n.NavigationEnabled&&o._name===n.DefaultControl||B(n)&&n.IsDefaultControl,r=Q.value(o.IsHyperlink),a=i||r?function(e){if(O(n)&&n.NavigationEnabled&&e.IsDefaultControl)n.NavigationAction(e.RowIndex);else if(B(n)&&n.IsDefaultControl&&n.ParentProps.NavigationEnabled)n.ParentProps.NavigationAction(e.RowIndex);else{if(o.listControl&&o.listControl.syncManager&&o.listControl.syncManager.RailsMode||O(n)&&n.ForceNavigationAction&&n.NavigationAction)return;Q.getFunction(o.ExecuteHyperlink)()}}:null,s=function(e,t){Q.value(this.CanHavePreview)&&Q.value(this.RequestEnhancedPreview)&&n.OnMouseEnter&&n.OnMouseEnter(e,t)}.bind(o),l=function(e,t){Q.value(this.CanHavePreview)&&Q.value(this.RequestEnhancedPreview)&&n.OnMouseLeave&&n.OnMouseLeave(e,t)}.bind(o),u=function(t,e){var n=this,i=this.listControl.syncManager,o=this.listControl.getTrackingIdFromRowIndex(e.RowIndex);i.setInternalValue(t,this.FieldName,this.DataSourceName,o),i.changeData(o,this.Name,function(o){K.apply(n);function e(e){if(i)if(i.hasDataInteractions(o,n.Name))Q.log.syncManager&&Q.log.syncManager("SetValue callback ignored due to another SetValue being queued (rowId, control): (%s, %s)",o,n.Name);else{var t=i.clearInternalValue(o,n.FieldName,n.DataSourceName);Q.util.stringToBoolean(e)&&i.setValidity({override:void 0},o,n._name,n.DataSourceName),t&&i.setDataVersion(o,n._name,n.DataSourceName)}}Q.callFunction(n.SetValue,n,[t],e,null,null,null,e)},function(e){i&&i.clearInternalValue(e,n.FieldName,n.DataSourceName)&&i.setDataVersion(e,n._name,n.DataSourceName)},function(e){i&&i.setInternalValue(t,n.FieldName,n.DataSourceName,e)})}.bind(o);o.SetValueInternal=u,o.Shortcuts=Q.controls.Input.prototype.Shortcuts;var d=W.bind(o);o.SetValidityInternal=d;var c=void 0;c=Q.value(o.ReplaceOnLookup)?0:1;var p=Q.value(o.HelpText);(r||i)&&(p=Q.label("ReactGrid_FollowLink"));var h={AllowEdit:Q.value(o.AllowEdit),AllowEnterToOpenPopup:Q.util.isFlightEnabled(Q.controls.standardizeKeyboardInteractionFeature),BackgroundColor:j(Q.value(o.BackgroundColor)),Enabled:Q.value(o.Enabled),ForegroundColor:j(Q.value(o.ForegroundColor)),HelpText:p,IsDefaultControl:i,IsEmptyPassword:Q.value(o.IsEmptyPassword),IsHyperlink:r,key:o._name,Label:Q.value(o.Label),LookupButtonIconName:c,Name:o._name,OnEditClick:G(o.Root),OnLinkNavigate:a,OnMouseEnter:s,OnMouseLeave:l,PasswordMode:Q.value(o.PasswordMode),PlaceholderText:Q.value(o.PlaceHolder),Required:Q.value(o.Required),SetValidity:d,SetValue:u,ShowLabel:Q.value(o.ShowLabel),ShowLookupButton:Q.value(o.LookupButton),Skip:Q.value(o.Skip),Width:t.width,WidthMode:t.widthMode},m={},v=Q.value(o.ExtendedStyle);v&&(m.className=v);var g=Q.value(o.LimitText),y="MultilineInput"===o.TypeName;if(Q.value(o.LookupButton)){if(y)Q.util.isFlightEnabled(Q.controls.multilineLookupFeatureName)&&(m.Multiline=y,m.Rows=Q.value(o.DisplayHeight));Q.util.objectAssign(h,q(o)),g=0}else o.TextChanged&&(m.OnChange=function(e){Q.callFunction(this.TextChanged,this,[e])}.bind(o)),(m.Multiline=y)&&(m.Rows=Q.value(o.DisplayHeight));0<g&&(m.MaxLength=g);var f=Q.value(o.Alignment);f&&"Auto"!==f&&(m.Alignment=f.toLowerCase());var b=[];if(Q.value(o.DisplayOptions)&&!$.isEmptyObject(Q.value(o.DisplayOptions))&&(b.push("ContainerStyle","InputStyle","UseColorOnSelectedRow"),m.ContainerStyle={FieldName:H(o._name,"ContainerStyle"),DataSourceName:o.DataSourceName},m.InputStyle={FieldName:H(o._name,"InputStyle"),DataSourceName:o.DataSourceName},m.UseColorOnSelectedRow={FieldName:H(o._name,"UseColorOnSelectedRow"),DataSourceName:o.DataSourceName}),o.copyForExcel=function(e){var t=o.listControl.groupingManager.rowIndexToCollectionIndex(e.RowIndex);return o.listControl.getCollectionData(t,o.FieldName,o.DataSourceName)},o.pasteFromExcel=u,o.FieldName?(b.push("Value","Validity","DataVersion"),m.Validity={FieldName:H(o._name,"Validity"),DataSourceName:o.DataSourceName},m.Value={FieldName:o.FieldName,DataSourceName:o.DataSourceName},m.DataVersion={FieldName:H(o._name,"DataVersion"),DataSourceName:o.DataSourceName}):Q.value(o.Value)&&(m.Value=Q.value(o.Value)),m.BoundProperties=b,B(n))delete h.SetValidity,m.Id=o._name,m.OnChange=n.OnChange,Q.util.objectAssign(h,m),e=React.createElement(ControlLibrary.StringEdit,h);else{m.Id=V(o._name,o.Root),"AppListGrid"===n.Name&&"SysAppStore_Status"===o._name&&(m.Rows=1);var C={IsFixed:Q.controls.ReactList.freezingEnabled()&&Q.value(o.IsFrozen)};Q.util.objectAssign(h,m,C),e=React.createElement(ControlLibrary.StringEditCell,h)}}return e}),Q.reactGrid.registerControlProperties("Input",{Alignment:!0,DisplayHeight:!0,IsEmptyPassword:!0,LimitText:!0,PasswordMode:!0,ReplaceOnLookup:!0}),Q.reactGrid.registerColumn("WrappedTextControl",function(e,t){var o=Q.value(e.IsLink),n={className:"wrappedTextControl",isHyperlink:o,onLinkNavigate:function(){Q.async(function(){Q.callFunction(e.Click,e)},0,"HelpLinkCallback")},readOnly:!0,style:{lineHeight:"normal",whiteSpace:"normal",paddingLeft:0}},i={};return o&&(i.skip=!1),e.FieldName&&e.DataSourceName?(i.BoundProperties=["value"],i.value={FieldName:e.FieldName,DataSourceName:e.DataSourceName}):Q.value(e.Text)&&(i.value=Q.value(e.Text)),Q.util.objectAssign(n,i),React.createElement(ControlLibrary.StaticTextCell,n)}),Q.reactGrid.registerControlProperty("WrappedTextControl","IsLink"),Q.reactGrid.registerColumn("AnchorButton",function(i,e){var t=null;if(Q.value(i.Visible)){var o=z(i),n={HelpText:Q.value(i.HelpText),Id:V(i._name,i.Root),IsFixed:Q.controls.ReactList.freezingEnabled()&&Q.value(i.IsFrozen),key:i._name,Name:i._name,OnClick:function(e,t){function o(){Q.value(i.Enabled)&&i.Click&&Q.callFunction(i.Click,i)}if(void 0!==t.RowIndex&&i.listControl){var n=i.listControl.getRowIndexFromTrackingId(Q.value(i.listControl.SelectedRowTrackingId));if(t.RowIndex!==n)return window.setTimeout(o),!1;o()}else o()},ShowLabel:!0,Skip:Q.value(i.Skip),Text:Q.value(i.Label),Width:o.width,WidthMode:o.widthMode};t=React.createElement(ControlLibrary.HyperlinkCell,n)}return t}),Q.reactGrid.registerColumn("HyperLink",function(e,t){var o=null;if(Q.value(e.Visible)){var n=z(e),i=[],r=Q.value(e.BaseUrl);e.BaseUrl.__ModelFieldName&&(r={FieldName:e.BaseUrl.__ModelFieldName,DataSourceName:e.BaseUrl.__ModelName},i.push("BaseUrl"));var a=Q.value(e.Text);e.Text.__ModelFieldName&&(a={FieldName:e.Text.__ModelFieldName,DataSourceName:e.Text.__ModelName},i.push("Text"));var s=Q.value(e.OpenInNewWindow);e.OpenInNewWindow.__ModelFieldName&&(s={FieldName:e.OpenInNewWindow.__ModelFieldName,DataSourceName:e.OpenInNewWindow.__ModelName},i.push("OpenInNewWindow"));for(var l=[],u=[],d=!1,c=!1,p=1;p<=6;p++){var h="QueryParam"+p.toString()+"Name",m=Q.value(e[h]);if(e[h].__ModelFieldName&&(m={FieldName:e[h].__ModelFieldName,DataSourceName:e[h].__ModelName},d=!0),m){l.push(m);var v="QueryParam"+p.toString()+"Value",g=Q.value(e[v]);e[v].__ModelFieldName&&(g={FieldName:e[v].__ModelFieldName,DataSourceName:e[v].__ModelName},c=!0),u.push(g)}}d&&i.push("QueryParamNames"),c&&i.push("QueryParamValues");var y={BaseUrl:r,BoundProperties:i,HelpText:Q.value(e.HelpText),Id:V(e._name,e.Root),IsFixed:Q.controls.ReactList.freezingEnabled()&&Q.value(e.IsFrozen),key:e._name,Label:Q.value(e.Label),Name:e._name,OpenInNewWindow:s,QueryParamNames:l,QueryParamValues:u,ShowLabel:!0,Skip:Q.value(e.Skip),Text:a,Width:n.width,WidthMode:n.widthMode};o=React.createElement(ControlLibrary.HyperlinkCell,y)}return o});function s(e,t){var o,n,i=[],r=e._element||e.element,a=Q.value(r.dynChildren);if(a)try{for(var s=__values(a),l=s.next();!l.done;l=s.next()){var u=l.value,d=Q.controlOptions(u),c=Q.reactGrid.generateColumn(d,Q.util.objectAssign({},t,{Type:e.TypeName}));i.push(c)}}catch(e){o={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(o)throw o.error}}return i}function l(e,t){var o,n=z(e);e.ImageType===Q.ui.ImageType.symbol&&(o="".concat(e.ImageName,"-symbol"));var i=function(e,t){function o(){Q.value(n.Enabled)&&n.Click&&Q.callFunction(n.Click,n)}var n=this;if(void 0!==t.RowIndex&&this.listControl){var i=this.listControl.getRowIndexFromTrackingId(Q.value(this.listControl.SelectedRowTrackingId));if(t.RowIndex!==i)return window.setTimeout(o),!1;o()}else o()}.bind(e);e.testClick=i;var r=Q.ui.theme.get(),a={":active":{backgroundColor:"transparent",color:"inherit"},":focus":{borderColor:r.accent,borderStyle:"solid",borderWidth:1},":hover":{backgroundColor:r.appBarPressed},backgroundColor:"transparent",borderColor:"transparent",borderRadius:2,fontWeight:400,margin:0};return React.createElement(ControlLibrary.Button,{BeforeExternalGlyphCssClass:o,Enabled:Q.value(e.Enabled),Height:n.height,HeightMode:n.heightMode,HelpText:Q.value(e.HelpText),Id:V(e._name,e.Root),key:e._name,Label:Q.value(e.Label),Name:e._name,OnClick:i,ShowLabel:e.ButtonDisplay!==Q.ui.ButtonDisplay.imageOnly,Skip:Q.value(e.Skip),Style:a,Visible:Q.value(e.Visible),Width:n.width,WidthMode:n.widthMode})}Q.reactGrid.registerColumn("Button",l),Q.reactGrid.registerColumn("MenuItemButton",l),Q.reactGrid.registerColumn("MenuItem",l),Q.reactGrid.registerColumn("MenuButton",function(i,e){var t,o=z(i);i.ImageType===Q.ui.ImageType.symbol&&(t="".concat(i.ImageName,"-symbol"));var n=Q.ui.theme.get(),r={":active":{backgroundColor:"transparent",color:"inherit"},":focus":{borderColor:n.accent,borderStyle:"solid",borderWidth:1},":hover":{backgroundColor:n.appBarPressed},backgroundColor:"transparent",borderColor:"transparent",borderRadius:2,fontWeight:400};return React.createElement(ControlLibrary.MenuButton,{BeforeExternalGlyphCssClass:t,ContainerStyle:r,Enabled:Q.value(i.Enabled),Height:o.height,HeightMode:o.heightMode,HelpText:Q.value(i.HelpText),Id:V(i._name,i.Root),key:i._name,Label:Q.value(i.Label),Name:i._name,OnClick:function(e,t){function o(){Q.value(i.Enabled)&&i.Click&&Q.callFunction(i.Click,i)}if(void 0!==t.RowIndex&&i.listControl){var n=i.listControl.getRowIndexFromTrackingId(Q.value(i.listControl.SelectedRowTrackingId));if(t.RowIndex!==n)return window.setTimeout(o),!1;o()}else o()},ShowLabel:i.ButtonDisplay!==Q.ui.ButtonDisplay.imageOnly,Skip:Q.value(i.Skip),Style:{margin:0},Visible:Q.value(i.Visible),Width:o.width,WidthMode:o.widthMode},s(i,e))}),Q.reactGrid.registerColumn("ToolbarGroup",function(e,t){var o=Q.ui.theme.get(),n=parseInt(o.subUnit,10),i={boxShadow:"0 ".concat(n+1," ").concat(0-n," ").concat(o.appBarSeparatorColor)};return React.createElement(ControlLibrary.ButtonGroup,{AlwaysInOverflow:Q.value(e.AlwaysInOverflow),Id:V(e._name,e.Root),Style:i},s(e,t))}),Q.reactGrid.registerColumn("Toolbar",function(e,t){var o=Q.ui.theme.get(),n={":active":{backgroundColor:"transparent",color:"inherit"},":focus":{borderColor:o.accent,borderStyle:"solid",borderWidth:1},":hover":{backgroundColor:o.appBarPressed},backgroundColor:"transparent",borderColor:"transparent",borderRadius:2,color:o.accent,fontWeight:400,margin:0};return React.createElement(ControlLibrary.Toolbar,{Id:V(e._name,e.Root),OverflowButtonStyle:n,Style:{margin:0}},s(e,t))})}(Q.reactGrid||(Q.reactGrid={}))}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=this&&this.__read||function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,i,r=o.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=r.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(o=r.return)&&o.call(r)}finally{if(i)throw i.error}}return a},__spreadArray=this&&this.__spreadArray||function(e,t,o){if(o||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||((n=n||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))};!function($){$.GroupInfoManager={},function(O){O.MASTERTRACKINGID="MasterTrackingId",O.OLD_MASTERTRACKINGID="Old_MasterTrackingId",O.ISMARKED_NAME="_RESERVED_IsMarked",O.ISSELECTED_NAME="_RESERVED_IsSelected",O.ISACTIVE_NAME="_RESERVED_IsActive",O.PARENT_GROUP_KEY="_RESERVED_ParentGroup",O.ISACTIONABLE_NAME="_RESERVED_IsActionable",O.GROUP_HEADER_PREFIX="_GroupHeader";var v,e;(e=v=O.DateGroupingUnit||(O.DateGroupingUnit={})).Day="day",e.Hour="hour",e.Minute="minute",e.Month="month",e.Quarter="quarter",e.Second="second",e.Week="week",e.Year="year";var t={ShowGroupHeaderLabel:!0};O.MAX_LEVEL_GROUPING=5;var o=(f.flightEnabled=function(){return $.util.isFlightEnabled("CLIGridGroupingFeature")},f.getGroup=function(e,t,o){if($.GroupInfoManager[e]&&$.GroupInfoManager[e][t])return $.GroupInfoManager[e][t][o]},f.adjustMarkedCountForHierarchy=function(e,t,o,n){for(var i=f.getGroup(e,t,o);i;)i.adjustMarkedCount(n),i=i.parentGroupTrackingId?f.getGroup(e,t,i.parentGroupTrackingId):void 0},f.addFieldTotalForHierarchy=function(e,t,o,n,i,r){for(var a=f.getGroup(e,t,o);a;)a.addFieldTotal(r,i,n),a=a.parentGroupTrackingId?f.getGroup(e,t,a.parentGroupTrackingId):void 0},f.isFieldMinMaxForHierarchy=function(e,t,o,n,i,r){var a=[];if(!$.controls.ReactList.extendedAggregationEnabled())return a;for(var s=f.getGroup(e,t,o);s;)s=s.isMinOrMax(r,i,n)?(a.push(s.trackingId),s.parentGroupTrackingId?f.getGroup(e,t,s.parentGroupTrackingId):void 0):void 0;return a},f.calculateMinMax=function(e,t,o,n){var i,r;if(n&&$.controls.ReactList.extendedAggregationEnabled()){var a={};for(var s in n)n[s]&&0<n[s].length&&(h=f.getGroup(e,t,s))&&(a[u=h.level.toString()]||(a[u]=[]),a[u].push(h.trackingId));for(var l=O.MAX_LEVEL_GROUPING-1;0<=l;l--){var u,d=a[u=l.toString()];if(d&&0<d.length)try{for(var c=(i=void 0,__values(d)),p=c.next();!p.done;p=c.next()){var h,m=p.value;(h=f.getGroup(e,t,m))&&(h.hasSubGroups()?h.calculateFieldMinMaxBySubGroups(n[h.trackingId],o):h.calculateFieldMinMaxByCollectionIndices(n[h.trackingId],o))}}catch(e){i={error:e}}finally{try{p&&!p.done&&(r=c.return)&&r.call(c)}finally{if(i)throw i.error}}}}},f.updateFieldMinMaxForHierarchy=function(e,t,o,n,i,r){if($.controls.ReactList.extendedAggregationEnabled())for(var a=f.getGroup(e,t,o);a;)a.updateFieldMinMax(r,i,n),a=a.parentGroupTrackingId?f.getGroup(e,t,a.parentGroupTrackingId):void 0},f.updateHeadersAndRerender=function(e,t){var o=f.getAnyGroup(e,t);o&&o.groupingManager&&o.groupingManager.updateGroupHeadersAndRerender()},f.addNewRowsToGroupingManger=function(o,r,e,t){var n,i,a=f.getAnyGroup(o,r);if(a&&a.groupingManager&&0<$.length(a.groupingManager.columnGrouping))if(t){var s=a.groupingManager.getColumnGroupingData();if(0<$.length(s)){for(var l=a.groupingManager.calculateGroups(s,e,a.groupingManager.rowIndexToTrackingId.length,t),u=l.groups,d=l.trackingIds,c=f.getGroup(o,r,t);c&&c.parentGroupTrackingId;)c=f.getGroup(o,r,c.parentGroupTrackingId);if(c){var p=c.trackingId;d[0]!==p&&(c.nextGroupTrackingId=d[0],u[d[0]].previousGroupTrackingId=p)}try{for(var h=__values(d),m=h.next();!m.done;m=h.next()){var v=m.value;v.startsWith(O.GROUP_HEADER_PREFIX)&&f.getGroup(o,r,v)||a.groupingManager.rowIndexToTrackingId.push(v)}}catch(e){n={error:e}}finally{try{m&&!m.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}var g=function(e){if(e){var n=u[e];if(n){var i=f.getGroup(o,r,e);if(i)i.endTrackingId=n.endTrackingId,i.nextGroupTrackingId=n.nextGroupTrackingId,i.showGroupCalculateLink=n.showGroupCalculateLink,i.groupingManager.context.getColumnsWithTotals().forEach(function(e){var t=n.getValue(e.FieldName,e.DataSourceName);if(t){var o="Integer"===e.TypeName||"Int64"===e.TypeName;i.addFieldTotal(t,e.FieldName,e.DataSourceName,o),i.updateFieldMinMax(t,e.FieldName,e.DataSourceName,o)}});else if(f.addGroup(o,r,n),n.parentGroupTrackingId){var t=f.getGroup(o,r,n.parentGroupTrackingId);t&&t.addSubGroup(e)}}}};for(var y in u)g(y)}}else a.groupingManager.updateGroupHeadersAndRerender()},f.removeFromGroup=function(e,t,o,n,i,r){for(var a=-1,s=0,l=f.getGroup(e,t,o);l;)l.endTrackingId===n?l.startTrackingId===n?(l.endTrackingId="",l.startTrackingId=""):l.endTrackingId=i:l.startTrackingId===n&&(l.startTrackingId=r),0===l.numberOfRows&&(f.deleteGroup(e,t,o),-1!==l.rowIndex&&((-1===a||l.rowIndex<a)&&(a=l.rowIndex),s++)),l=l.parentGroupTrackingId?f.getGroup(e,t,l.parentGroupTrackingId):void 0;return{firstIndex:a,deleteCount:s}},f.removeRowsFromGroupingManager=function(e,t,o,n){var i=f.getAnyGroup(e,t);i&&i.groupingManager&&i.groupingManager.removeFromRowIndices(o,n)},f.getAnyGroup=function(e,t){var o;if($.GroupInfoManager[e]&&$.GroupInfoManager[e][t])for(var n in $.GroupInfoManager[e][t])if($.GroupInfoManager[e][t][n]){o=$.GroupInfoManager[e][t][n];break}return o},f.deleteGroup=function(e,t,o){$.GroupInfoManager[e]&&$.GroupInfoManager[e][t]&&delete $.GroupInfoManager[e][t][o]},f.addGroup=function(e,t,o){e&&t&&o&&($.GroupInfoManager[e]||($.GroupInfoManager[e]={}),$.GroupInfoManager[e][t]||($.GroupInfoManager[e][t]={}),$.GroupInfoManager[e][t][o.trackingId]=o)},f.prototype.dispose=function(){var t,e;if(this.gridPropertyObservers){try{for(var o=__values(this.gridPropertyObservers),n=o.next();!n.done;n=o.next())n.value.dispose()}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this.gridPropertyObservers=[]}this.rowIndexToTrackingId=[],this.fallbackGroupInfoCache&&delete this.fallbackGroupInfoCache},f.prototype.addNewRow=function(e,t){f.addNewRowsToGroupingManger(this.rootId,this.collectionName,[e],t)},f.prototype.removeFromRowIndices=function(e,t){this.rowIndexToTrackingId.splice(e,t);for(var o=e;o<this.rowIndexToTrackingId.length;o++){var n=this.rowIndexToTrackingId[o];if(n.startsWith(O.GROUP_HEADER_PREFIX)){var i=this.getGroup(n);i&&(i.rowIndex=o)}else{var r=$.value(this.context.DataSource)[this.context.getCollectionIndexFromTrackingId(n)];r&&(r.rowIndex=o)}}},f.prototype.collectionLengthOffset=function(){return!this.hasGrouping()||this.rowIndexToTrackingId.length<=0?0:this.rowIndexToTrackingId.length-$.length(this.context.DataSource)},f.prototype.getGroupingIndex=function(t){return this.hasGrouping()?this.columnGrouping.findIndex(function(e){return e.ControlName===t}):-1},f.prototype.group=function(e,t){var o=this;void 0===t&&(t=!1);var n=e?JSON.stringify(e):"";$.setValue(this.context,"ColumnGrouping",n),t?$.async(function(){$.callFunction(o.context.UpdateColumnGrouping,o.context,n)}):$.callFunction(this.context.UpdateColumnGrouping,this.context,n)},f.prototype.isGroupHeader=function(e){return!(-1===e||!this.hasGrouping()||this.rowIndexToTrackingId.length<=0||e>this.rowIndexToTrackingId.length)&&this.rowIndexToTrackingId[e].startsWith(O.GROUP_HEADER_PREFIX)},f.prototype.isGroupHeaderTrackingId=function(e){return!(null==e||!e.startsWith(O.GROUP_HEADER_PREFIX))},f.prototype.isFirstGroup=function(e){var t=this.getGroup(e);return!(!t||t.previousGroupTrackingId)&&(!t.parentGroupTrackingId||this.isFirstGroup(t.parentGroupTrackingId))},f.prototype.isLastGroup=function(e){var t=this.getGroup(e);return!(!t||t.nextGroupTrackingId)&&(!t.parentGroupTrackingId||this.isLastGroup(t.parentGroupTrackingId))},f.prototype.getGroupHeaderData=function(e,t,o){var n=this.rowIndexToTrackingId[e],i=this.getGroup(n);if(i)return i.getValue(t,o)},f.prototype.getGroupStartCollectionIndex=function(e){var t=this.getGroup(e);return t?t.startCollectionIndex:-1},f.prototype.getGroupEndCollectionIndex=function(e){var t=this.getGroup(e);return t?t.endCollectionIndex:-1},f.prototype.getGroupIsCollapsed=function(e){var t=this.getGroup(e);return!!t&&t.isCollapsed},f.prototype.getActiveGroupTrackingId=function(){return this.activeGroupTrackingId},f.prototype.clearActiveGroup=function(){if(this.activeGroupTrackingId){var e=this.getGroup(this.activeGroupTrackingId);e&&(e.isActiveDataRow=!1)}},f.prototype.getNumberOfGroups=function(){if(this.rootId&&this.collectionName){if($.GroupInfoManager[this.rootId]&&$.GroupInfoManager[this.rootId][this.collectionName])return Object.keys($.GroupInfoManager[this.rootId][this.collectionName]).length}else if(this.fallbackGroupInfoCache)return Object.keys(this.fallbackGroupInfoCache).length;return 0},f.prototype.getAllGroupTrackingIds=function(){if(this.rootId&&this.collectionName){if($.GroupInfoManager[this.rootId]&&$.GroupInfoManager[this.rootId][this.collectionName])return Object.keys($.GroupInfoManager[this.rootId][this.collectionName])}else if(this.fallbackGroupInfoCache)return Object.keys(this.fallbackGroupInfoCache);return[]},f.prototype.rowIndexToCollectionIndex=function(e){return!this.hasGrouping()||this.rowIndexToTrackingId.length<=0?this.context.getCollectionIndexFromPageIndex(e):-1===e||void 0===this.rowIndexToTrackingId[e]||this.isGroupHeader(e)?-1:this.context.getCollectionIndexFromTrackingId(this.rowIndexToTrackingId[e])},f.prototype.collectionIndexToRowIndex=function(e){if(!this.hasGrouping()||!this.groupingApplied())return this.context.getPageIndexFromCollectionIndex(e);if(-1!==e){var t=$.peek(this.context.DataSource)[e];if(t)return t.rowIndex}return-1},f.prototype.getTrackingIdFromRowIndex=function(e){if(0<this.rowIndexToTrackingId.length)return this.rowIndexToTrackingId[e];var t=this.rowIndexToCollectionIndex(e);return this.context.getTrackingIdFromCollectionIndex(t)},f.prototype.getRowIndexFromTrackingId=function(e){if(e.startsWith(O.GROUP_HEADER_PREFIX)){var t=this.getGroup(e);return t?t.rowIndex:-1}var o=this.context.getCollectionIndexFromTrackingId(e);return this.collectionIndexToRowIndex(o)},f.prototype.updateGroupHeadersAndRerender=function(){this.updateGroupHeaders(),this.context.firstRender?(this.context.firstRender=!1,this.context.renderReactListSync()):(f.flightEnabled()&&this.context.resetGroupingGridOptions(),this.context.markedSelectedVersion++,this.context.dataVersion++,this.context.renderReactListAsync())},f.prototype.toggleGroupExpandCollapse=function(e){var t,o,n,i=this.rowIndexToTrackingId[e],r=this.getGroup(i);if(r){if(r.isCollapsed){r.isCollapsed=!1;var a=this.getVisibleTrackingIdsForGroup(i);r.isActiveDataRow&&(r.isActiveDataRow=!1,this.activeGroupTrackingId="",this.resetIsActiveRowOnSubGroup(r,!1)),(t=this.rowIndexToTrackingId).splice.apply(t,__spreadArray([e+1,0],__read(a),!1))}else{var s=this.context.getCollectionIndexFromActiveRowTrackingId();s>=r.startCollectionIndex&&s<=r.endCollectionIndex&&(r.isActiveDataRow=!0,this.activeGroupTrackingId=r.trackingId,this.resetIsActiveRowOnSubGroup(r,!0));var l=this.getVisibleTrackingIdsForGroup(i);try{for(var u=__values(l),d=u.next();!d.done;d=u.next()){var c=d.value;if(c.startsWith(O.GROUP_HEADER_PREFIX)){var p=this.getGroup(c);p&&(p.rowIndex=-1)}else{var h=$.value(this.context.DataSource)[this.context.getCollectionIndexFromTrackingId(c)];h&&(h.rowIndex=-1)}}}catch(e){o={error:e}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(o)throw o.error}}this.rowIndexToTrackingId.splice(e+1,l.length),r.isCollapsed=!0}this.resetRowIndices(e+1)}},f.prototype.resetRowIndices=function(e){void 0===e&&(e=0);for(var t=e;t<this.rowIndexToTrackingId.length;t++){var o=this.rowIndexToTrackingId[t];if(o.startsWith(O.GROUP_HEADER_PREFIX)){var n=this.getGroup(o);n&&(n.rowIndex=t)}else{var i=$.value(this.context.DataSource)[this.context.getCollectionIndexFromTrackingId(o)];i&&(i.rowIndex=t)}}},f.prototype.adjustGroupMarkCount=function(e,t){var o=this.getGroup(e);o&&o.adjustMarkedCount(t)},f.prototype.hasGrouping=function(){return f.flightEnabled()&&0<$.length(this.columnGrouping)},f.prototype.prohibitedLastGrouping=function(){var e="";if(0<this.columnGrouping.length){var t=this.columnGrouping[this.columnGrouping.length-1],o=this.context.getColumnInfo(t.ControlName);o&&("Date"===o.TypeName&&"day"!==t.GroupingUnit||"Time"===o.TypeName&&"second"!==t.GroupingUnit||"DateTime"===o.TypeName&&"second"!==t.GroupingUnit)&&(e=o.TypeName)}return e},f.prototype.onColumnHidden=function(){var t,e,o=[],n=$.length(this.columnGrouping);if(0<n){try{for(var i=__values(this.columnGrouping),r=i.next();!r.done;r=i.next()){var a=r.value,s=a.ControlName,l=this.context.getColumnInfo(s);l&&$.value(l.Visible)&&o.push(a)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}o.length!==n&&this.group(0<o.length?{ColumnGroupings:o}:null,!0)}},f.prototype.onCacheClear=function(){var t,e,o=this,n=[],i=$.length(this.columnGrouping);if(0<i){var r=[];try{for(var a=__values(this.columnGrouping),s=a.next();!s.done;s=a.next()){var l=s.value,u=l.ControlName,d=this.context.getColumnInfo(u);if(d){var c=$.value(d.SortDirection);0!==c&&1!==c||n.push(l)}else r.push(u)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}return 0<r.length&&$.value(this.context.InProcessOfCreatingChildren)?$.observe(this.context.InProcessOfCreatingChildren,function(e){if(!e)return o.onCacheClear(),!1}):n.length!==i?this.group(0<n.length?{ColumnGroupings:n}:null):this.updateGroupHeadersAndRerender(),!0}return!1},f.prototype.expandCollapseAllGroups=function(e){var t,o,n,i,r,a,s,l,u=[],d=this.getAllGroupTrackingIds();try{for(var c=__values(d),p=c.next();!p.done;p=c.next()){var h=p.value,m=this.getGroup(h);if(m){if(!m.parentGroupTrackingId&&(u.push(m),!e)){var v=this.getVisibleTrackingIdsForGroup(h);try{for(var g=(n=void 0,__values(v)),y=g.next();!y.done;y=g.next()){var f=y.value;if(f.startsWith(O.GROUP_HEADER_PREFIX)){var b=this.getGroup(f);b&&(b.rowIndex=-1)}else{var C=$.value(this.context.DataSource)[this.context.getCollectionIndexFromTrackingId(f)];C&&(C.rowIndex=-1)}}}catch(e){n={error:e}}finally{try{y&&!y.done&&(i=g.return)&&i.call(g)}finally{if(n)throw n.error}}}m.isCollapsed=!e}}}catch(e){t={error:e}}finally{try{p&&!p.done&&(o=c.return)&&o.call(c)}finally{if(t)throw t.error}}this.clearActiveGroup();var w=[];if(e)try{for(var _=__values(u),S=_.next();!S.done;S=_.next()){var I=S.value;w.push(I.trackingId),Array.prototype.push.apply(w,this.getVisibleTrackingIdsForGroup(I.trackingId))}}catch(e){r={error:e}}finally{try{S&&!S.done&&(a=_.return)&&a.call(_)}finally{if(r)throw r.error}}else{var T=this.context.getCollectionIndexFromActiveRowTrackingId();try{for(var x=__values(u),F=x.next();!F.done;F=x.next())I=F.value,w.push(I.trackingId),T>=I.startCollectionIndex&&T<=I.endCollectionIndex&&(I.isActiveDataRow=!0,this.activeGroupTrackingId=I.trackingId)}catch(e){s={error:e}}finally{try{F&&!F.done&&(l=x.return)&&l.call(x)}finally{if(s)throw s.error}}}this.rowIndexToTrackingId=w,this.resetRowIndices(),this.context.markedSelectedVersion++,this.context.dataVersion++,this.context.renderReactListAsync()},f.prototype.getGroup=function(e){return this.rootId&&this.collectionName?f.getGroup(this.rootId,this.collectionName,e):this.fallbackGroupInfoCache?this.fallbackGroupInfoCache[e]:void 0},f.prototype.resetIsActiveRowOnSubGroup=function(e,t){var o,n,i=this.context.getCollectionIndexFromActiveRowTrackingId();if(e&&e.getSubGroups){var r=e.getSubGroups();if(r)try{for(var a=__values(r),s=a.next();!s.done;s=a.next()){var l=s.value,u=this.getGroup(l);u&&(this.resetIsActiveRowOnSubGroup(u,t),t&&u.isActiveDataRow?u.isActiveDataRow=!1:!t&&u.isCollapsed&&i>=u.startCollectionIndex&&i<=u.endCollectionIndex&&(u.isActiveDataRow=!0,this.activeGroupTrackingId=u.trackingId))}}catch(e){o={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}}},f.prototype.groupingApplied=function(){return 0<this.getNumberOfGroups()},f.prototype.getColumnGroupingData=function(){var t,e,o=[];try{for(var n=__values(this.columnGrouping),i=n.next();!i.done;i=n.next()){var r=i.value,a=r.ControlName,s=this.context.getColumnInfo(a);if(s){var l=this.context.getFilteringFieldsForColumn(s)[0];o.push({columnInfo:s,dataSourceName:l.FormDataSourceName,fieldName:l.FieldName,label:l.Label,unit:r.GroupingUnit})}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return o},f.prototype.updateGroupHeaders=function(){if(!this.updatingGroupHeaders&&f.flightEnabled()){this.updatingGroupHeaders=!0,this.rowIndexToTrackingId=[];var e=$.peek(this.context.DataSource);if(0<$.length(this.columnGrouping)){var t=this.getColumnGroupingData();if(0<$.length(t)){var o=this.calculateGroups(t,e),n=o.groups;this.rowIndexToTrackingId=o.trackingIds,this.rootId&&this.collectionName?($.GroupInfoManager[this.rootId]||($.GroupInfoManager[this.rootId]={}),$.GroupInfoManager[this.rootId][this.collectionName]||($.GroupInfoManager[this.rootId][this.collectionName]={}),$.GroupInfoManager[this.rootId][this.collectionName]=n):this.fallbackGroupInfoCache=n}}else{var i=!1;if(this.groupingApplied()&&(i=!0,this.rootId&&this.collectionName?f.getAnyGroup(this.rootId,this.collectionName).groupingManager===this&&delete $.GroupInfoManager[this.rootId][this.collectionName]:delete this.fallbackGroupInfoCache),i){var r=$.value(this.context.InternalSelectedRowTrackingId);r&&r.startsWith(O.GROUP_HEADER_PREFIX)&&this.context.resetInternalSelectedTrackingId(),e.forEach(function(e){var t;e&&(null!==(t=$.serverForm)&&void 0!==t&&t.isModel(e)?e.removeProperty(O.PARENT_GROUP_KEY):delete e[O.PARENT_GROUP_KEY])})}}this.updatingGroupHeaders=!1}},f.prototype.getVisibleTrackingIdsForGroup=function(e){var t,o,n=[],i=this.getGroup(e);if(i&&!i.isCollapsed)if(i.hasSubGroups())try{for(var r=__values(i.getSubGroups()),a=r.next();!a.done;a=r.next()){var s=a.value;n.push(s),Array.prototype.push.apply(n,this.getVisibleTrackingIdsForGroup(s))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}else for(var l=i.startCollectionIndex,u=i.endCollectionIndex,d=l;d<=u;d++)n.push(this.context.getTrackingIdFromCollectionIndex(d));return n},f.prototype.getGroupTrackingId=function(e,t){for(var o=O.GROUP_HEADER_PREFIX,n=0;n<t.length;n++)o+="_".concat(e[n].columnInfo._name,"_").concat(t[n]);return o},f.prototype.calculateGroups=function(x,e,F,k){var t,o,P=this;void 0===F&&(F=0);var R=this.context.getColumnsWithTotals(),M=x.length-1,E=[];try{for(var n=__values(x),i=n.next();!i.done;i=n.next()){var r=i.value.columnInfo,a=void 0;a="ComboBox"===r.TypeName?this.getComboBoxValue:"CheckBox"===r.TypeName?this.getCheckBoxValue:"Date"===r.TypeName||"DateTime"===r.TypeName?this.getDateValue:"Time"===r.TypeName?this.getTimeValue:"Real"===r.TypeName||"Integer"===r.Type||"Int64"===r.Type?this.getNumberValue:function(e,t,o,n){return P.context.getCollectionData(e,t,o)},E.push(a)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(o=n.return)&&o.call(n)}finally{if(t)throw t.error}}var N={},A=[],D=new Map,L=[];return e.forEach(function(e,t){for(var o,n,i,r,a,s=null!==(o=$.serverForm)&&void 0!==o&&o.isModel(e)?e.collectionIndex:t,l=null!==(n=$.serverForm)&&void 0!==n&&n.isModel(e)?e.masterTrackingId:s.toString(),u=D,d="",c=[],p=0;p<x.length;p++){var h=x[p],m=E[p](s,h.fieldName,h.dataSourceName,h.columnInfo,h.unit);if(c[p]=m,u.has(m)){var v=(_=u.get(m)).GroupId;(a=N[v]).endTrackingId=l,u=_.SubGroupValues,d=_.GroupId}else{v=P.getGroupTrackingId(x,c),a=new B(v,m,l,h.label,p,P);var g=!0;if(d){a.parentGroupTrackingId=d;var y=N[d];y.addSubGroup(v),y.isCollapsed&&(g=!1)}if(g&&(k&&(v===k||k.startsWith("".concat(v,"_")))&&F--,a.rowIndex=A.length+F,A.push(v)),0<L.length){a.showGroupCalculateLink=!0===$.value(P.context.DataBelow);var f=P.getGroupTrackingId(x,L.slice(0,p+1)),b=N[f];b.showGroupCalculateLink=!1,b.parentGroupTrackingId===a.parentGroupTrackingId&&(a.previousGroupTrackingId=f,b.nextGroupTrackingId=v)}else if(a.showGroupCalculateLink=!0===$.value(P.context.DataAbove),a.showGroupCalculateLink||(a.showGroupCalculateLink=!0===$.value(P.context.DataBelow)),k)for(var C=P.getGroup(k);C;)C.showGroupCalculateLink=!1,C=C.parentGroupTrackingId?P.getGroup(C.parentGroupTrackingId):void 0;var w=P.getGroup(v);(w&&w.isCollapsed||P.context.getCollapseAllStatus())&&(a.isCollapsed=!0),N[v]=a;var _={GroupId:v};u.set(m,_),p<M&&(_.SubGroupValues=new Map,u=_.SubGroupValues),d=_.GroupId}}L=c,null!==(i=$.serverForm)&&void 0!==i&&i.isModel(e)?e.setValue(O.PARENT_GROUP_KEY,a.trackingId,!1):e[O.PARENT_GROUP_KEY]=a.trackingId;for(var S=!0,I=a;I;)null!==(r=$.serverForm)&&void 0!==r&&r.isModel(e)?e.isMarked&&I.adjustMarkedCount(1):e[O.ISMARKED_NAME]&&I.adjustMarkedCount(1),R.forEach(function(e){var t=P.context.getCollectionData(s,e.FieldName,e.DataSourceName);if(void 0!==t){var o="Integer"===e.TypeName||"Int64"===e.TypeName;I.addFieldTotal(t,e.FieldName,e.DataSourceName,o),I.updateFieldMinMax(t,e.FieldName,e.DataSourceName,o)}}),S&&I.isCollapsed&&(S=!1),I=I.parentGroupTrackingId?N[I.parentGroupTrackingId]:void 0;if(S){e.rowIndex=A.length+F;var T=P.context.getTrackingIdFromCollectionIndex(s);A.push(T)}}),{groups:N,trackingIds:A}},f);function f(e){var m=this;this.context=e,this.getNumberValue=function(e,t,o,n){var i=m.context.getCollectionData(e,t,o),r="";if(!$.util.isNullOrUndefined(i)){if(!n.BigNumber){var a=$.util.createBigNumOptions(n);n.BigNumber=new ControlLibrary.BigNumber(a)}n.BigNumber.SetValue(i),r=n.BigNumber.GetValue()}return r},this.getCheckBoxValue=function(e,t,o,n){var i=m.context.getCollectionData(e,t,o),r="";return $.util.isNullOrUndefined(i)||(r=$.util.stringToBoolean(i)?$.label("CheckBox_ToggleTrueText"):$.label("CheckBox_ToggleFalseText")),r},this.getComboBoxValue=function(e,t,o,n){var i,r=m.context.getCollectionData(e,t,o),a="";if(!$.util.isNullOrUndefined(r)){var s=$.util.convertItems($.peek(n.Items)),l=ControlLibrary.getSelectedItemByValue(r,s);a=null!==(i=null==l?void 0:l.text)&&void 0!==i?i:""}return a},this.getTimeValue=function(e,t,o,n,i){var r,a,s=m.context.getCollectionData(e,t,o),l="";if(!$.util.isNullOrUndefined(s)){var u={};i&&(i!==v.Minute&&i!==v.Hour||(u.TimeSeconds=n.TimeSeconds,n.TimeSeconds=!1,i===v.Hour&&(u.TimeMinute=n.TimeMinute,n.TimeMinute=!1))),l+=$.controls.Time.getFormattedValueForControl(s,n);var d=Object.keys(u);if(0<d.length)try{for(var c=__values(d),p=c.next();!p.done;p=c.next()){var h=p.value;n[h]=u[h]}}catch(e){r={error:e}}finally{try{p&&!p.done&&(a=c.return)&&a.call(c)}finally{if(r)throw r.error}}}return l},this.getDateValue=function(e,t,o,n,i){var r,a,s=m.context.getCollectionData(e,t,o),l="";if(!$.util.isNullOrUndefined(s)){var u={};i&&(i===v.Day||i===v.Week||i===v.Month||i===v.Quarter||i===v.Year?("DateTime"===n.TypeName&&(u.DisplayOption=n.DisplayOption,n.DisplayOption="Date"),i!==v.Day&&(u.DateDay=n.DateDay,n.DateDay="None",i!==v.Year&&i!==v.Week&&i!==v.Quarter||(u.DateMonth=n.DateMonth,n.DateMonth="None",i===v.Week?(u.DateWeek="",n.DateWeek="digits1or2"):i===v.Quarter&&(u.DateQuarter=!1,n.DateQuarter=!0)))):i!==v.Second&&i!==v.Minute&&i!==v.Hour||i!==v.Second&&(u.TimeSeconds=n.TimeSeconds,n.TimeSeconds=!1,i===v.Hour&&(u.TimeMinute=n.TimeMinute,n.TimeMinute=!1))),l+=$.controls.DateTime.getFormattedValueForControl(s,n);var d=Object.keys(u);if(0<d.length)try{for(var c=__values(d),p=c.next();!p.done;p=c.next()){var h=p.value;n[h]=u[h]}}catch(e){r={error:e}}finally{try{p&&!p.done&&(a=c.return)&&a.call(c)}finally{if(r)throw r.error}}}return l},this.updatingGroupHeaders=!1,this.gridPropertyObservers=[],this.rowIndexToTrackingId=[],this.activeGroupTrackingId="",this.columnGrouping=[],this.collectionName="",e&&($.isServerBoundDataSource(e.DataSource)&&(this.collectionName=e.DataSource.__dataSourceName),e.Root&&e.Root.Id&&(this.rootId=e.Root.Id),f.flightEnabled()&&(this.gridPropertyObservers.push($.observe(e.ColumnGrouping,function(e){if(e)try{m.columnGrouping=JSON.parse(e).ColumnGroupings,m.columnGrouping.length>O.MAX_LEVEL_GROUPING&&m.columnGrouping.splice(O.MAX_LEVEL_GROUPING)}catch(e){m.columnGrouping=[]}else m.columnGrouping=[];m.context.firstRender||m.updateGroupHeadersAndRerender()})),this.gridPropertyObservers.push($.bulkObserve(e,function(){m.updateGroupHeadersAndRerender()},e.Updating,this,void 0,t,!0))))}O.GroupingManager=o;var B=(Object.defineProperty(n.prototype,"numberOfRows",{get:function(){return""===this.startTrackingId||""===this.endTrackingId?0:this.endCollectionIndex-this.startCollectionIndex+1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"startCollectionIndex",{get:function(){return this.groupingManager.context.getCollectionIndexFromTrackingId(this.startTrackingId)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"endCollectionIndex",{get:function(){return this.groupingManager.context.getCollectionIndexFromTrackingId(this.endTrackingId)},enumerable:!1,configurable:!0}),n.prototype.addSubGroup=function(e){this.subGroups||(this.subGroups=[]),this.subGroups.push(e)},n.prototype.hasSubGroups=function(){return this.subGroups&&0<this.subGroups.length},n.prototype.getFirstSubGroupTrackingId=function(){var e="";return this.subGroups&&(e=this.subGroups[0]||""),e},n.prototype.getLastSubGroupTrackingId=function(){var e="";return this.subGroups&&(e=this.subGroups[this.subGroups.length-1]||""),e},n.prototype.getSubGroups=function(){return this.subGroups},n.prototype.getValue=function(e,t){if("_RESERVED_GroupBy"===e){var o=$.value(this.groupingManager.context.Mode)===$.ui.ListMode.list,n=$.peek(this.groupingManager.context.ShowGroupHeaderLabel)&&!o;return"".concat(this.key).concat(this.showGroupCalculateLink?"":" (".concat(this.numberOfRows,")")).concat(n?" [".concat(this.label,"]"):"")}if("_RESERVED_GroupCalculateLink"===e)return this.showGroupCalculateLink;if(e===O.MASTERTRACKINGID)return this.trackingId;if(e===O.ISSELECTED_NAME)return this.trackingId===$.value(this.groupingManager.context.InternalSelectedRowTrackingId);if(e===O.ISACTIVE_NAME)return this.isActiveDataRow;if("_RESERVED_GroupHeaderIsCollapsed"===e)return this.isCollapsed;if("_RESERVED_GroupLevel"===e)return this.level;if(e===O.ISMARKED_NAME)return this.markedCount===this.numberOfRows?1:0<this.markedCount?2:0;if(e===O.ISACTIONABLE_NAME)return!1;if(e!==O.OLD_MASTERTRACKINGID){var i=t?"".concat(t,"_").concat(e):e;if(this.columnTotals[i])return this.columnTotals[i].GetNumberString();if(i.endsWith("_".concat("Avg"))){var r=i.substring(0,i.lastIndexOf("_".concat("Avg")));if(this.columnTotals[r]){var a=this.columnTotals[r].clone();return a.IgnoreDecimals()&&a.configure({ignoreDecimal:!1,numberOfDecimals:1}),a.SetValue(this.columnTotals[r].GetNumber()/this.numberOfRows),a.GetNumberString()}}}},n.prototype.isMinOrMax=function(e,t,o,n){void 0===n&&(n=!1);var i=!1;if(!$.controls.ReactList.extendedAggregationEnabled())return i;var r=new ControlLibrary.BigNumber({ignoreDecimal:n,initialValue:e}),a=this.getTotalKey(t,"Max",o),s=this.getTotalKey(t,"Min",o),l=this.columnTotals[a],u=this.columnTotals[s];return 1!==(null==l?void 0:l.CompareToBigNumber(r))&&1!==(null==u?void 0:u.CompareToBigNumber(r))||(i=!0),i},n.prototype.addFieldTotal=function(e,t,o,n){void 0===n&&(n=!1);var i=this.getTotalKey(t,"Sum",o);this.columnTotals[i]||(this.columnTotals[i]=new ControlLibrary.BigNumber({ignoreDecimal:n,initialValue:0})),this.columnTotals[i].add(e)},n.prototype.getTotalAsBigNumber=function(e){return this.columnTotals[e]},n.prototype.calculateFieldMinMaxBySubGroups=function(e,t){var o,n,i,r;if(this.hasSubGroups()&&$.controls.ReactList.extendedAggregationEnabled())try{for(var a=__values(this.subGroups),s=a.next();!s.done;s=a.next()){var l=s.value,u=this.groupingManager.getGroup(l);try{for(var d=(i=void 0,__values(e)),c=d.next();!c.done;c=d.next()){var p=c.value,h=this.getTotalKey(p,"Max",t),m=this.columnTotals[h],v=u.getTotalAsBigNumber(h);1===v.CompareToBigNumber(m)&&(this.columnTotals[h]=v.clone());var g=this.getTotalKey(p,"Min",t),y=this.columnTotals[g],f=u.getTotalAsBigNumber(g);1===y.CompareToBigNumber(f)&&(this.columnTotals[g]=f.clone())}}catch(e){i={error:e}}finally{try{c&&!c.done&&(r=d.return)&&r.call(d)}finally{if(i)throw i.error}}}}catch(e){o={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}},n.prototype.calculateFieldMinMaxByCollectionIndices=function(e,t,o){var n,i;if(void 0===o&&(o=!1),$.controls.ReactList.extendedAggregationEnabled())for(var r=this.startCollectionIndex;r<=this.endCollectionIndex;r++)try{for(var a=(n=void 0,__values(e)),s=a.next();!s.done;s=a.next()){var l=s.value;this.updateFieldMinMax(this.groupingManager.context.getCollectionData(r,l,t),l,t,o)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}},n.prototype.updateFieldMinMax=function(e,t,o,n){if(void 0===n&&(n=!1),$.controls.ReactList.extendedAggregationEnabled()){var i=new ControlLibrary.BigNumber({ignoreDecimal:n,initialValue:e}),r=this.getTotalKey(t,"Max",o),a=this.columnTotals[r];a&&1!==i.CompareToBigNumber(a)||(this.columnTotals[r]=i);var s=this.getTotalKey(t,"Min",o),l=this.columnTotals[s];l&&1!==l.CompareToBigNumber(i)||(this.columnTotals[s]=i)}},n.prototype.adjustMarkedCount=function(e){this.markedCount+=e},n.prototype.getTotalKey=function(e,t,o){return"Min"===t||"Max"===t?o?"".concat(o,"_").concat(e,"_").concat(t):"".concat(e,"_").concat(t):o?"".concat(o,"_").concat(e):e},n);function n(e,t,o,n,i,r){this.trackingId=e,this.key=t,this.startTrackingId=o,this.label=n,this.level=i,this.groupingManager=r,this.columnTotals={},this.isCollapsed=!1,this.endTrackingId=o,this.markedCount=0,this.showGroupCalculateLink=!0,this.rowIndex=-1,this.parentGroupTrackingId="",this.nextGroupTrackingId="",this.previousGroupTrackingId="",this.isActiveDataRow=!1}O.GroupInfo=B}($.reactGrid||($.reactGrid={}))}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(d){var e,t;function o(e,t){var u=this;this.editableFieldOptions=e,this.onApplyEdits=t,this.applyEdits=function(){u.onApplyEdits(u.getEditsToApply()),d.shell.dialogBack()},this.addEditField=function(){u.addClicked=!0;var e=d.length(u.FieldsToEdit);0<e&&u.updateFieldVersions(e-1),u.FieldsToEdit.push({FieldIsValid:d.observable(!0),FieldValue:d.observable(),FieldValueIsValid:d.observable(!0),SelectedField:d.observable(0)})},this.getIdentifier=function(e){var t,o="";return 0<e.SelectedField()&&!0===e.FieldIsValid()&&(o=null===(t=u.getFieldInfo(e.SelectedField()))||void 0===t?void 0:t.columnInfo.Name),o||u.FieldsToEdit().indexOf(e)},this.getVersion=function(e){var t,o;return null!==(o=null===(t=u.getFieldInfo(e.SelectedField()))||void 0===t?void 0:t.version)&&void 0!==o?o:0},this.setLookupValue=function(o,e){var t=u.FieldsToEdit().find(function(e){var t;return(null===(t=u.getFieldInfo(e.SelectedField()))||void 0===t?void 0:t.columnInfo.Name)===o});t&&(t.FieldValue(e),t.FieldValueIsValid(!0))},this.headerText=d.label("ReactGrid_BulkEditHeaderText"),this.addClicked=!1,this.EditableFields=[],e.forEach(function(e,t){u.EditableFields.push({Label:d.value(e.columnInfo.Label),Value:t+1})}),this.FieldsToEdit=d.observableArray([{FieldIsValid:d.observable(!0),FieldValue:d.observable(),FieldValueIsValid:d.observable(!0),SelectedField:d.observable(0)}]),this.ApplyEnabled=d.computed(function(){var t,e,o=!1,n=u.FieldsToEdit();if(0<n.length){var i=!1,r=!1;try{for(var a=__values(n),s=a.next();!s.done;s=a.next()){var l=s.value;if(!1===d.value(l.FieldIsValid)||!1===d.value(l.FieldValueIsValid)){r=!0;break}!i&&0<d.value(l.SelectedField)&&(i=!0)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}i&&!r&&(o=!0)}return o})}d.showBulkEditLightBox=function(e,t,o){var n=new d.controls.BulkEditLightBox(e,t),i={context:n,role:"Dialog",templateId:"BulkEditLightBox"},r=d.shell.createForm(i);return n.element=r,d.shell.dialog(i),d.context(r).onClose.subscribe(o),n},e=d.controls||(d.controls={}),o.prototype.cancelEdits=function(){d.shell.dialogBack()},o.prototype.postRenderFields=function(){if(this.addClicked){this.addClicked=!1;var e=d.length(this.FieldsToEdit)-1;d.context(this.element).setControlFocus("FieldComboBox_".concat(e))}},o.prototype.getFieldInfo=function(e){return this.editableFieldOptions[e-1]},o.prototype.isFieldSelectionValid=function(o,n){return 0===n||void 0===this.FieldsToEdit().find(function(e,t){return n!==t&&d.value(e.SelectedField)===o})},o.prototype.removeEditField=function(e){this.updateFieldVersions(e),this.FieldsToEdit.splice(e,1)},o.prototype.moveEditFieldUp=function(e){this.updateFieldVersions(e-1),this.FieldsToEdit.swap(e,e-1)},o.prototype.moveEditFieldDown=function(e){this.updateFieldVersions(e),this.FieldsToEdit.swap(e,e+1)},o.prototype.updateFieldVersions=function(e){for(var t=e,o=d.length(this.FieldsToEdit);t<o;t++){var n=this.FieldsToEdit()[t],i=this.getFieldInfo(n.SelectedField());i&&i.version++}},o.prototype.getEditsToApply=function(){var o=this,n=[];return this.FieldsToEdit().forEach(function(e){if(0<e.SelectedField()&&!0===e.FieldValueIsValid()&&!0===e.FieldIsValid()){var t=o.getFieldInfo(d.value(e.SelectedField));n.push({ColumnName:t.columnInfo.Name,FieldValue:d.value(e.FieldValue)})}}),n},t=o,e.BulkEditLightBox=t}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(a){var e,n,t;function o(){var e=null!==n&&n.apply(this,arguments)||this;return e.removeClicked=function(){e.BulkEditLightBox.removeEditField(e.Index)},e.moveUpClicked=function(){e.BulkEditLightBox.moveEditFieldUp(e.Index)},e.moveDownClicked=function(){e.BulkEditLightBox.moveEditFieldDown(e.Index)},e.getRequestPopupHandler=function(r){return function(e){var t=r.Name,o=e[0],n=this.displayedValue?this.displayedValue():"",i=!!this.isDisplayedValueDirty&&this.isDisplayedValueDirty();a.callFunction(r.listControl.BulkEditRequestLookup,r.listControl,[t,o,n,i])}},e}e=a.controls||(a.controls={}),n=a.ui.Control,__extends(o,n),o.prototype.init=function(e,t){var o=this;n.prototype.init.call(this,e,t),this.PlaceholderVisible=a.observable(!0),this.MoreOptionsEnabled=this.ShowMoveUp||this.ShowMoveDown,a.observe(a.options(function(){return{selectedField:o.SelectedField,isDataBound:o.IsDataBound}},a.ui.updating),function(e){if(0<e.selectedField&&e.isDataBound)if(o.BulkEditLightBox.isFieldSelectionValid(e.selectedField,o.Index)){o.FieldIsValid(!0),o.PlaceholderVisible(!1),o._fieldValueControlElement&&(a.ui.removeChildControl(o._fieldValueControlElement,o.getGroup().element),o._fieldValueControlElement=null);var t=o.BulkEditLightBox.getFieldInfo(e.selectedField);o._fieldValueControlElement=a.ui.createChildControl(o.getChildControlType(t),o.getChildControlProps(t),o.getGroup().element,{index:3,insertSelector:".group_content"})}else o.FieldIsValid(!1)})},o.prototype.getChildControlType=function(e){var t=e.columnInfo.TypeName;return"CheckBox"===t?"ComboBox":t},o.prototype.getChildControlProps=function(e){var t,o=e.columnInfo,n={AllowEdit:!0,Enabled:!0,IsValid:this.FieldValueIsValid,Name:"FieldValue_"+this.Index,Required:a.value(o.Required),Value:this.FieldValue},i={},r=null!==(t=a.value(o.LookupButton))&&void 0!==t&&t;switch(o.TypeName){case"Integer":case"Int64":Object.assign(i,{AllowNegative:a.value(o.AllowNegative),ShowZero:a.value(o.ShowZero)});break;case"Real":Object.assign(i,{AllowNegative:a.value(o.AllowNegative),DecimalSeparator:a.value(o.DecimalSeparator),MinNumberOfDecimals:a.value(o.MinNumberOfDecimals),NoOfDecimals:a.value(o.NoOfDecimals),ShowZero:a.value(o.ShowZero),ThousandSeparator:a.value(o.ThousandSeparator)});break;case"Date":case"DateTime":Object.assign(i,{DateDay:a.value(o.DateDay),DateFormat:a.value(o.DateFormat),DateMonth:a.value(o.DateMonth),DateSeparator:a.value(o.DateSeparator),DateYear:a.value(o.DateYear),ShowTimeZoneIndicator:a.value(o.ShowTimeZoneIndicator),TimeFormat:a.value(o.TimeFormat),TimeHours:a.value(o.TimeHours),TimeMinute:a.value(o.TimeMinute),TimeSeconds:a.value(o.TimeSeconds),TimeSeparator:a.value(o.TimeSeparator),TimeZoneName:a.value(o.TimeZoneName),TimeZonePreference:a.value(o.TimeZonePreference)}),r&&!a.value(o.CanOpenLookupForm)&&(r=!1);break;case"Time":Object.assign(i,{TimeFormat:a.value(o.TimeFormat),TimeHours:a.value(o.TimeHours),TimeMinutes:a.value(o.TimeMinutes),TimeSeconds:a.value(o.TimeSeconds),TimeSeparator:a.value(o.TimeSeparator)});break;case"ComboBox":Object.assign(i,{Items:a.value(o.Items),SelectedItem:this.FieldValue}),delete n.Value;break;case"CheckBox":Object.assign(i,{Items:[{Label:a.label("CheckBox_ToggleTrueText"),Value:!0},{Label:a.label("CheckBox_ToggleFalseText"),Value:!1}],SelectedItem:this.FieldValue}),delete n.Value}return r&&Object.assign(i,{CanOpenLookupForm:!0,DisableAutoPresentLookup:!0,LookupButton:!0,RequestPopup:this.getRequestPopupHandler(o)}),Object.assign(n,i),n},o.prototype.getGroup=function(){return this._group||(this._group=a.context(this.element.querySelector("[data-dyn-controlname='BulkEditFieldGroup_".concat(this.Index,"']")))),this._group},t=o,e.BulkEditField=t}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(n){var e,t,o,i,r;e=n.controls||(n.controls={}),(t=e.documentConstants||(e.documentConstants={})).FILE_UPLOAD_MAX_BLOB_SIZE=204800,t.DEFAULT_CHUNK_SIZE=1024e3,t.DOCUMENT_UPLOAD_CHUNKING_SIZE_THRESHOLD=25e6,function(t){t.generatePseudoId=function(){var e=Date.UTC(2013,2,25,0,0,0),t=new Date-e;return(Math.floor(32*Math.random()).toString(32)+t.toString(32)).toUpperCase()},t.hasJQueryFileUploadLoaded=n.observable(!1),t.hasJQueryFileUploadSubmitted=!1;var o=["Scripts/ext/load-image.all.min-2.12.2.js","Scripts/ext/canvas-to-blob.min-3.7.0.js","Scripts/ext/jquery.fileupload-9.18.0.js","Scripts/ext/jquery.fileupload-process-9.18.0.js","Scripts/ext/jquery.fileupload-image-9.18.0.js"];t.loadJQueryFileUpload=function(){if(!t.hasJQueryFileUploadLoaded()&&!t.hasJQueryFileUploadSubmitted){var e=n.observable(!1);n.observe(e,function(e){if(e&&!n.value(t.hasJQueryFileUploadLoaded)&&$(document).fileupload)return t.hasJQueryFileUploadLoaded(!0,!0),!1}),n.util.includeJavaScripts(o,0,e),t.hasJQueryFileUploadSubmitted=!0}},t.GetFileNameWithoutExtension=function(e){if(!e)return"";var t=e.lastIndexOf(".");return 0<=t?e.substring(0,t):e},t.GetFileExtension=function(e){var t="";if(!e)return t;var o=e.lastIndexOf(".");return 0<=o&&(t=e.substring(o,e.length)),t},t.CheckValidFileExtension=function(e,t,o){var n,i;if(void 0===o||""===o.trim())return!0;e=e.toLowerCase(),t=t.toLowerCase();var r=(o=o.toLowerCase()).split(",");try{for(var a=__values(r),s=a.next();!s.done;s=a.next()){var l=s.value;if(!((l=l.trim()).length<1))if("."===l[0]){if(l===e)return!0}else{var u=t.split("/"),d=l.split("/");if(1===d.length||"*"===d[1].trim()){if(u[0]===d[0])return!0}else if(t===l)return!0}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return!1}}(n.util||(n.util={})),o=n.ui||(n.ui={}),(i=o.DocuUploadStyle||(o.DocuUploadStyle={})).StandardStyle="Standard",i.MinimalStyle="Minimal",(r=o.FileUploadStyle||(o.FileUploadStyle={})).StandardStyle="Standard",r.MinimalStyle="Minimal",r.MinimalWithFileNameStyle="MinimalWithFilename"}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(u){!function(e){Globalize.addCultureInfo("en",{messages:{DocumentViewer_AddButtonLabel:"Add",DocumentViewer_AttachmentsButtonLabel:"Attachments",DocumentViewer_ConfirmDelete:"Are you sure you want to delete the attached document?",DocumentViewer_DeleteButtonLabel:"Delete",DocumentViewer_EmptyAddButtonLabel:"Upload",DocumentViewer_EmptyDocuRefText:"No document to preview",DocumentViewer_EmptyText:"Nothing to show",DocumentViewer_FailedDelete:"Failed to delete document",DocumentViewer_iFrameTitle:"Document viewer region",DocumentViewer_NoPreviewDateLabel:"Date",DocumentViewer_NoPreviewExpandedText:"The attached document cannot be previewed. The document might use an unsupported file type or the connection with the Office Web App has failed. Open the document locally to view it.",DocumentViewer_NoPreviewFileNameLabel:"File name",DocumentViewer_NoPreviewText:"No preview available",DocumentViewer_NoRecordText:"No record found",DocumentViewer_OpenButtonLabel:"Open"}});var o,t=(o=u.ui.Control,__extends(a,o),a.prototype.dispose=function(){this.clientBusySubscriberId&&u.clientBusy.valueChanged.unsubscribe(this.clientBusySubscriberId),o.prototype.dispose.call(this)},a.prototype.SelectDocument=function(e){var t,o,n=u.value(this.Documents);try{for(var i=__values(n),r=i.next();!r.done;r=i.next()){var a=r.value;e&&(a.DocuValueRecId==e?a.Selected=1:a.Selected=0),1===a.Selected&&u.setValue(this,"SelectedDocument",a)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}},a.prototype.calculatePreviewSize=function(){if(0===this.MaxPreviewHeight||0===this.MaxPreviewWidth){var e=$(this.element).find("div.documentViewerPreview iframe"),t=void 0,o=void 0,n=0,i=0;if(e.is(":visible"))t=e;else if(0<(o=e.next()).length)n=parseInt(o.css("max-height")),i=parseInt(o.css("max-width")),t=o;else if(t=$(this.element),u.value(this.ToolBarShown)){var r=$(this.element).find(a.ToolBarSelector);r.is(":visible")&&(n-=r.height())}0!==n&&0!==i||(n=t.height(),i=t.width()),this.MaxPreviewHeight=n,this.MaxPreviewWidth=i}},a.ToolBarSelector=".documentViewerToolBar",a.FlyoutSelector=".documentViewerFlyOutDiv",a);function a(e,s,n,t){var l=o.call(this,e,s,n,t)||this;return l.AttachmentsButtonClicked=function(){var e=l.RootControl.find(a.FlyoutSelector),t=l.RootControl.find(a.ToolBarSelector);e.is(":visible")?e.hide():(e.css("left",t.position().left+"px"),e.css("top",(t.position().top+t.height()).toString()+"px"),e.css("width",l.RootControl.width().toString()+"px"),e.show())},l.CloseDocumentsViewerFlyout=function(){l.RootControl.find(a.FlyoutSelector).hide()},l.DocumentViewerFlyoutOptionClicked=function(e){var t="documentViewerSelectedDocument",o="docu-value-rec-id",n=$(e.currentTarget);l.RootControl.find("li[".concat(o,'="').concat(u.value(l.SelectedDocument).DocuValueRecId,'"]')).removeClass(t),n.addClass(t);var i=n.attr(o);l.SelectDocument(i),l.CloseDocumentsViewerFlyout()},l.DownloadDocumentClicked=function(){u.shell.navigateUrl({openInNewTab:!1,url:u.value(l.SelectedDocument).DownloadUrl})},l.DeleteDocumentClicked=function(){if(l.AllowDelete){var e=u.label("DocumentViewer_ConfirmDelete");u.showMessageBox({Text:e,showYesButton:!0,showNoButton:!0,callback:function(e){e===u.controls.MessageBox.Button.Yes&&(u.async.pending.increment("Delete document from viewer init"),u.ui.PerformanceTimer&&u.ui.PerformanceTimer._addAction("DocumentViewer_ConfirmDelete"),$.ajax({beforeSend:function(e){u.serverForm.setCsrfToken(e),e.setRequestHeader(u.serverForm.RequestHeaderKeys.clientSessionKey,u.browserActivity.BrowserSessionActivity.Id),u.ui.PerformanceTimer&&u.ui.PerformanceTimer._startAjax()},complete:l.PerformDelete,type:"DELETE",url:u.value(l.SelectedDocument).DownloadUrl}))}})}},l.PerformDelete=function(e,t){if(u.ui.PerformanceTimer&&u.ui.PerformanceTimer._stopAjax(),"success"===t){var o=u.value(l.Documents).slice(0),n=o.indexOf(u.value(l.SelectedDocument));if(-1!==n){o.splice(n,1);var i=void 0;0<o.length&&(i=n===o.length?n-1:n);var r=void 0;!i&&0!==i||((r=o[i]).Selected=1),u.setValue(l,"SelectedDocument",r),u.setValue(l,"Documents",o)}}else{var a=u.label("DocumentViewer_FailedDelete");if(e)try{var s=JSON.parse(e.responseText);s&&s.ErrorMessage&&(a=s.ErrorMessage)}catch(e){}u.error({Message:a,Label:"DocumentViewer_FailedDelete"},l)}u.async.pending.decrement("Delete document from viewer complete")},u.setValue(l,"LayoutHeight",u.value(l.Height)||u.layout.Size.content),u.setValue(l,"LayoutWidth",u.value(l.Width)||u.layout.Size.content),l.RootControl=$(s),l.NumberOfDocuments=u.observable(0),l.HasRecord=u.observable(!1),l.SelectedDocument=u.observable(null),l.MaxPreviewHeight=0,l.MaxPreviewWidth=0,l.HasDocuments=u.computed(function(){return 0<u.value(l.NumberOfDocuments)}),l.ViewerEmpty=u.computed(function(){return!u.value(l.HasDocuments)}),l.ButtonsEnabled=u.computed(function(){var e=u.value(l.ReferencesDocuRef);return u.value(l.HasRecord)&&0===e}),l.EmptyViewerAddButtonVisible=u.computed(function(){return u.value(l.ButtonsEnabled)&&u.value(l.AllowUpload)}),l.EmptyViewerLabelVisible=u.computed(function(){return!u.value(l.EmptyViewerAddButtonVisible)}),l.EmptyViewerLabel=u.computed(function(){var e;return e=u.value(l.HasRecord)?0===u.value(l.ReferencesDocuRef)?"DocumentViewer_EmptyText":"DocumentViewer_EmptyDocuRefText":"DocumentViewer_NoRecordText",u.label(e)}),l.ToolBarShown=u.computed(function(){return u.value(l.ButtonsEnabled)&&u.value(l.HasDocuments)}),l.AttachmentsButtonShown=u.computed(function(){return 1<u.value(l.NumberOfDocuments)}),l.HasDocumentPreview=u.computed(function(){var e=u.value(l.SelectedDocument);return e&&e.DocumentUrl&&0<e.DocumentUrl.length}),l.HasDocumentNoPreview=u.computed(function(){var e=u.value(l.SelectedDocument);return e&&!(e.DocumentUrl&&0<e.DocumentUrl.length)}),l.PreviewSrcUrl=u.computed(function(){return u.value(l.HasDocumentPreview)?u.value(l.SelectedDocument).DocumentUrl:""}),l.PreviewSrcThumbnail=u.computed(function(){return u.value(l.HasDocumentNoPreview)?u.value(l.SelectedDocument).ThumbnailImageUrl:""}),l.PreviewDocumentName=u.computed(function(){return u.value(l.HasDocumentNoPreview)?u.value(l.SelectedDocument).Name:""}),l.PreviewDate=u.computed(function(){return u.value(l.HasDocumentNoPreview)?u.value(l.SelectedDocument).FriendlyLastModified:""}),u.observe(l.ReferenceValueRecId,function(e){var t;null!==(t=null==n?void 0:n.Root)&&void 0!==t&&t.UseReactGrid()?(l.clientBusySubscriberId&&u.clientBusy.valueChanged.unsubscribe(l.clientBusySubscriberId),l.clientBusySubscriberId=u.clientBusy.valueChanged.subscribe(function(e){u.value(e)||(u.getFunction(l.ReferencedRecordChange)(),u.clientBusy.valueChanged.unsubscribe(l.clientBusySubscriberId))})):u.async(function(){u.getFunction(l.ReferencedRecordChange)()},void 0,"Referenced record change");var o=!1;e&&0!=e?o=!0:u.setValue(l,"SelectedDocument",null),u.setValue(l,"HasRecord",o),u.setValue(l,"HasNoRecord",!o)}),u.observe(l.Documents,function(e){var t;t=e?e.length:0,u.setValue(l,"NumberOfDocuments",t),null!=e&&0<t?l.SelectDocument():u.setValue(l,"SelectedDocument",null)}),u.observe(l.PreviewSrcUrl,function(e){var t="sandbox=''",o="",n=u.value(l.SelectedDocument),i=$(s).find("div.documentViewerPreview"),r=!1,a=u.value(l.Id)+"_wopi";n&&(n.MimeType&&0===n.MimeType.lastIndexOf("image/",0)&&(l.calculatePreviewSize(),o=u.format("<img src='{0}' alt='{1}' style='max-height: {2}px; max-width: {3}px'></img>",e,n.Name,l.MaxPreviewHeight,l.MaxPreviewWidth)),n.TrustedSource&&(t="",n.WopiActionUrl&&(r=!0)),o=o||(r?u.format("<form id='{0}' name='{0}' target='{0}_frame' action='{1}' method='post'><input name='access_token' value='{2}' type='hidden'/><input name='access_token_ttl' value='{3}' type='hidden'/></form><iframe id='{0}_frame' title='{4}' name='{0}_frame'></iframe>",a,n.WopiActionUrl,n.WopiAccessToken,n.WopiAccessTokenTtl,u.label("DocumentViewer_iFrameTitle")):u.format("<iframe title='{2}' src='{0}' {1}></iframe>",e,t,u.label("DocumentViewer_iFrameTitle")))),i.children().remove(),i.append(o),r&&$(i).find("form").submit()}),l.Root&&u.observe(l.Root.Refreshing,function(e){e&&u.getFunction(l.ReferencedRecordChange)()}),l}(e.DocumentViewer=t).prototype.ReferencesDocuRef=0,t.prototype.ReferenceValueRecId=null,t.prototype.Documents=null,t.prototype.AllowDelete=!0,t.prototype.AllowUpload=!0,t.prototype.ReferencedRecordChange=null,t.prototype.AddNewDocument=null,u.ui.addPropertiesToPrototype(t.prototype,{LayoutHeight:{defaultValue:u.layout.Size.content,observable:!0},LayoutWidth:{defaultValue:u.layout.Size.content,observable:!0}})}(u.controls||(u.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(s){!function(e){Globalize.addCultureInfo("en",{messages:{DocumentUpload_BrowseButtonLabel:"Browse",DocumentUpload_CancelButtonlabel:"Cancel",DocumentUpload_DocuTypeLabel:"Document Type",DocumentUpload_FileAccessError:"Critical Error: {0} .Possibly the file is open, please close it. Page will be refreshed",DocumentUpload_FileUploadCaption:"File to upload",DocumentUpload_NameLabel:"Name",DocumentUpload_NotesLabel:"Notes",DocumentUpload_UploadButtonLabel:"Upload",DocumentUpload_UploadStarted:"Document is being uploaded"}});var i,t=(i=s.ui.Control,__extends(o,i),o.prototype.getFileUploadControl=function(){return $(this.element).find('[doc-upload-file-input="'.concat(s.value(this.Name),'"]'))},o.prototype.beginPerformanceTimer=function(){s.ui.PerformanceTimer&&s.ui.PerformanceTimer._addAction("FileManagement"),s.ui.PerformanceTimer&&s.ui.PerformanceTimer._startAjax()},o.prototype.endPerformanceTimer=function(){s.ui.PerformanceTimer&&s.ui.PerformanceTimer._stopAjax()},o.prototype.setupJqUploader=function(){this.reset();var e=this.getFileUploadControl();e&&e.fileupload&&e.fileupload({add:this.FileChanged,always:this.endPerformanceTimer,beforeSend:function(e){s.serverForm.setCsrfToken(e),e.setRequestHeader(s.serverForm.RequestHeaderKeys.clientSessionKey,s.browserActivity.BrowserSessionActivity.Id)},dataType:"json",done:this.handleSuccess,fail:this.handleFailure,limitConcurrentUploads:3,submit:this.beginPerformanceTimer,url:s.util.resolveVirtualPath("/filemanagement")})},o.prototype.reset=function(){try{this.submitUploadAction=null,this.isUploading(!1);var e=this.getFileUploadControl();e&&e.fileupload&&e.fileupload("destroy")}catch(e){}},o.prototype.UploadSuccess=function(){s.async.pending.decrement("Upload document success"),s.getFunction(this.CloseDialog)(),this.isUploading(!1)},o.prototype.UploadFailure=function(e){s.async.pending.decrement("Upload document failure"),s.getFunction(this.UploadFailed)({_specificMessage:e}),this.isUploading(!1)},o);function o(e,t,o,n){var r=i.call(this,e,t,o,n)||this;return r.BrowseButtonClicked=function(){s.observe(s.util.hasJQueryFileUploadLoaded,function(e){if(e){r.setupJqUploader();var t=r.getFileUploadControl();t.val(""),s.setValue(r,"selectedFile","");try{t.click()}catch(e){r.UploadFailure(e.message)}}return!1})},r.UploadButtonClicked=function(){s.async.pending.increment("Upload document init");var e=s.value(r.selectedFile);e?s.getFunction(r.CheckFile)([s.value(r.DocuName),e],void 0,r.PerformUpload):r.UploadFailure("")},r.handleFailure=function(e,t){r.UploadFailure(t&&t.jqXHR&&t.jqXHR.responseJSON&&t.jqXHR.responseJSON.ErrorMessage||"")},r.handleSuccess=function(e,t){t&&t.result&&1===t.result.length&&s.setValue(r,"UploadedFileId",t.result[0].fileId),r.UploadSuccess()},r.FileChanged=function(e,t){var o=t&&t.files&&t.files.length&&t.files[0]||{},n=o.name;n=n&&0<n.length?s.util.parseFileNameWithDirectory(n):"",s.setValue(r,"selectedFile",n),s.setValue(r,"DocuName",s.util.GetFileNameWithoutExtension(n));var i=o.size>s.controls.documentConstants.DOCUMENT_UPLOAD_CHUNKING_SIZE_THRESHOLD;r.getFileUploadControl().fileupload("option","maxChunkSize",i?s.controls.documentConstants.DEFAULT_CHUNK_SIZE:null),r.submitUploadAction=function(){$.blueimp.fileupload.prototype.options.add.call(r.getFileUploadControl(),e,t)},s.getFunction(r.CheckFile)([s.value(r.DocuName),n],void 0,r.FileChangedVerificationComplete)},r.FileChangedVerificationComplete=function(){s.value(r.Style)===s.ui.DocuUploadStyle.MinimalStyle&&s.value(r.selectedFile)&&s.async(function(){s.value(r.FileValid)&&(s.async.pending.increment("Upload document init for minimal style"),r.PerformUpload())},void 0,"File perform upload")},r.PerformUpload=function(){if(r.submitUploadAction){if(!s.value(r.FileValid))return void r.UploadFailure("");if(!window.FileList)return void r.UploadFailure("");r.isUploading(!0);var e=r.getFileUploadControl();r.element.setAttribute("aria-busy","true"),r.element.setAttribute("aria-label",s.label("DocumentUpload_UploadStarted")),r.element.setAttribute("aria-busy","false");var t=[{name:"clientId",value:s.util.generatePseudoId()},{name:"maxChunkSize",value:s.controls.documentConstants.DEFAULT_CHUNK_SIZE},{name:"tableid",value:s.value(r.CurrentTableId)},{name:"recid",value:s.value(r.CurrentRecId)},{name:"companyid",value:s.user().Company()},{name:"accesstoken",value:s.value(r.AccessToken)},{name:"notes",value:s.value(r.Notes)},{name:"docuname",value:s.value(r.DocuName)},{name:"docutypeid",value:s.value(r.SelectedDocumentType)},{name:"ischunked",value:null!=e.fileupload("option","maxChunkSize")}],o=s.value(r.CurrentDocuRefRecId);o&&t.push({name:"docuRefRecId",value:o}),e.fileupload("option","formData",t),r.submitUploadAction()}},s.util.loadJQueryFileUpload(),r.submitUploadAction=null,r.isUploading=s.observable(!1),r.buttonsEnabled=s.computed(function(){return!s.value(r.IsViewMode)&&s.value(r.Enabled)&&!s.value(r.isUploading)}),r.selectedFile=s.observable(""),r.UploadButtonEnabled=s.computed(function(){var e=s.value(r.selectedFile);return!s.value(r.IsViewMode)&&s.value(r.buttonsEnabled)&&e&&0<e.length&&s.value(r.FileValid)}),r.SubControlsAllowEdit=s.computed(function(){return!s.value(r.IsViewMode)&&s.value(r.buttonsEnabled)}),r.FileValid=s.computed(function(){return s.value(r.DocuNameValidity)&&s.value(r.FileTypeValidity)}),r}(e.DocumentUpload=t).prototype.CurrentTableId=null,t.prototype.CurrentRecId=null,t.prototype.CurrentDocuRefRecId=null,t.prototype.AccessToken=null,t.prototype.Notes="",t.prototype.DocuName="",t.prototype.DocuNameValidity=!1,t.prototype.FileTypeValidity=!1,t.prototype.SelectedDocumentType="",t.prototype.DocumentTypes=null,t.prototype.HideNotes=!0,t.prototype.HideDocuName=!0,t.prototype.UploadedFileId="",t.prototype.Style="",t.prototype.CloseDialog=null,t.prototype.UploadFailed=null,t.prototype.CheckFile=null;var n,r=(n=s.ui.Control,__extends(a,n),a);function a(){return null!==n&&n.apply(this,arguments)||this}e.DocUpload=r}(s.controls||(s.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(u){!function(e){Globalize.addCultureInfo("en",{messages:{FileUpload_BrowseButtonLabel:"Browse",FileUpload_CancelButtonlabel:"Cancel",FileUpload_ExtensionError:"Please select a file with one of the following extensions: {0}",FileUpload_Failed:"File upload is failed",FileUpload_FileNameInputLabel:"File Upload Control File Name",FileUpload_InvalidStrategyClass:"The FileUpload Strategy Class you selected does not exist.",FileUpload_LessThanMinError:"File cannot be less than {0} in size",FileUpload_MoreThanMaxError:"File cannot be greater than {0} in size",FileUpload_Started:"File upload is started",FileUpload_Success:"File upload is successful",FileUpload_UploadButtonLabel:"Upload"}});var i,l=".fileUpload-fileInput",t=(i=u.ui.Control,__extends(o,i),o.prototype.dispose=function(){this.reset&&this.reset(),i.prototype.dispose.call(this)},o.prototype.maxSizeBytes=function(){var e=u.value(this.MaxFileSizeInMegaBytes);return e<0&&(e=u.controls.documentConstants.FILE_UPLOAD_MAX_BLOB_SIZE),e*Math.pow(1024,2)},o.prototype.minSizeBytes=function(){return u.value(this.MinFileSizeInMegaBytes)*Math.pow(1024,2)},o.prototype.IsFileTypeValid=function(e){if(this.IsFileTypesFilterValid){var t=u.util.GetFileExtension(e.name);return u.util.CheckValidFileExtension(t,e.type,u.value(this.CommonFileTypesAccepted))}return!1},o.prototype.setupJqUploader=function(){var t,e,o=this;if(this.reset(),this.jqUploaderElement=this.myContainer.find(l),this.setParamToUploader("clientId",u.util.generatePseudoId()),this.setParamToUploader("maxChunkSize",u.controls.documentConstants.DEFAULT_CHUNK_SIZE),this.setParamToUploader("max",this.maxSizeBytes()),this.setParamToUploader("min",this.minSizeBytes()),this.setParamToUploader("strategyClassName",u.value(this.StrategyClassName)),this.setParamToUploader("fileMetaData",u.value(this.FileMetaData)),this.setParamToUploader("isFileTypesFilterValid",u.value(this.IsFileTypesFilterValid)),this.setParamToUploader("commonFileTypesAccepted",u.value(this.CommonFileTypesAccepted)),this.setParamToUploader("formName",void 0!==this.Root?this.Root.FormName:""),this.AdditionalParameters)try{for(var n=__values(u.value(this.AdditionalParameters)),i=n.next();!i.done;i=n.next()){var r=i.value;r.Key&&this.setParamToUploader(r.Key,r.Value)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.jqUploaderElement.fileupload({add:this.onFileAdded,beforeSend:function(e){u.serverForm.setCsrfToken(e),e.setRequestHeader(u.serverForm.RequestHeaderKeys.clientSessionKey,u.browserActivity.BrowserSessionActivity.Id)},dataType:"json",disableImageResize:!1,done:this.onUploadFinished,fail:this.onUploadFailed,formData:this.runtimeParameters,imageMaxHeight:u.value(this.ImageMaxHeight),imageMaxWidth:u.value(this.ImageMaxWidth),limitConcurrentUploads:3,loadImageMaxFileSize:this.maxSizeBytes(),loadImageMinFileSize:this.minSizeBytes(),maxChunkSize:u.controls.documentConstants.DEFAULT_CHUNK_SIZE,progressall:this.onProgressUpdate,url:u.util.resolveVirtualPath(this.UploadUrl),xhr:function(){return o.xhr=$.ajaxSettings.xhr(),o.xhr}})},o.prototype.ShouldUploadImmediately=function(){var e=u.value(this.Style);return e===u.ui.FileUploadStyle.MinimalStyle||e===u.ui.FileUploadStyle.MinimalWithFileNameStyle},o.prototype.setFocusToItem=function(e){e="".concat(this.Name).concat(e),$(this.element).find("[data-dyn-controlname='".concat(e,"']")).focus(),u.log.focus&&u.log.focus("Focus: FileUpload setFocusToItem: %s",e)},o.prototype.setFocusBack=function(){switch(u.value(this.Style)){case u.ui.FileUploadStyle.MinimalStyle:u.value(this.browseEnabled)&&this.setFocusToItem("BrowseButton");break;case u.ui.FileUploadStyle.MinimalWithFileNameStyle:u.value(this.browseEnabled)?this.setFocusToItem("BrowseButton"):this.setFocusToItem("FileNameDisplay");break;default:u.value(this.browseEnabled)?this.setFocusToItem("BrowseButton"):u.value(this.cancelEnabled)?this.setFocusToItem("CancelButton"):u.value(this.UploadButtonEnabled)?this.setFocusToItem("UploadButton"):this.setFocusToItem("FileNameDisplay")}},o.prototype.startFileUpload=function(e,t){u.async.pending.increment("Upload file starting"),this.fileuploadInProgress(!0),this.setAriaLabel(u.label("FileUpload_Started")),this.setFocusBack(),u.applyFunction(this.OnUploadAttemptStarted),$.blueimp.fileupload.prototype.options.add.call(this.jqUploaderElement,t,e),this.jqXHR=e},o.prototype.UploadWasSuccessful=function(e){u.setValue(this,"FileUploadResult",e),this.setAriaLabel(u.label("FileUpload_Success")),u.setValue(this,"Value",e),u.applyFunction(this.OnUploadCompleted)},o.prototype.UploadFailed=function(e){this.setAriaLabel(u.label("FileUpload_Failed")),u.applyFunction(this.OnUploadCompleted)},o.prototype.ParseResult=function(e){return JSON.parse(e.result[0])},o.prototype.finishFileUpload=function(){this.fileuploadInProgress(!1),this.xhr&&this.xhr.upload&&$(this.xhr.upload).off("progress"),this.xhr=null,this.jqXHR=null},o.prototype.setParamToUploader=function(e,t){var o,n,i,r=!1;try{for(var a=__values(this.runtimeParameters),s=a.next();!s.done;s=a.next()){var l=s.value;if(l.name===e){l.value=t,r=!0;break}}}catch(e){o={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}r||((i={}).name=e,i.value=t,this.runtimeParameters.push(i))},o.prototype.setAriaLabel=function(e){this.element&&(this.element.setAttribute("aria-busy","true"),this.element.setAttribute("aria-label",e),this.element.setAttribute("aria-busy","false"))},o.prototype.formatSize=function(e){for(var t=-1;t++,99<(e/=1024););return Math.max(e,.1).toFixed(1)+o.sizeSymbols[t]},o.prototype.resetUx=function(){this.ProgressPercent(0),this.submitDriver=null,this.fileuploadInProgress(!1),this.jqUploaderElement=null},o.prototype.reset=function(){this.resetUx();try{this.jqUploaderElement.fileupload("destroy")}catch(e){}},o.sizeSymbols=["kB","MB","GB","TB","PB","EB"],o);function o(e,t,o,n){var s=i.call(this,e,t,o,n)||this;return s.BrowseButtonClicked=function(){u.observe(u.util.hasJQueryFileUploadLoaded,function(e){if(e){s.setupJqUploader(),s.jqUploaderElement.val("");try{s.jqUploaderElement.click()}catch(e){u.showMessageBox({showOkButton:!0,Text:u.format(u.label("DocumentUpload_FileAccessError"),e.message)}),$.find('[data-dyn-controlname="Ok"]')[0].addEventListener("click",function(){u.shell.dialogBack(),location.reload()})}return!1}})},s.SubmitButtonClicked=function(){s.submitDriver&&s.submitDriver()},s.CancelButtonClicked=function(){s.jqXHR&&s.jqXHR.abort(),s.CloseDialog&&s.CloseDialog()},s.onFileAdded=function(e,t){s.jqUploaderElement=s.myContainer.find(l);var o=t.files[0].name,n=t.files[0].size,i=s.maxSizeBytes(),r="",a="onFileAdded";s.IsFileTypeValid(t.files[0])?""===u.value(s.StrategyClassName).trim()?(r=u.label("FileUpload_InvalidStrategyClass"),a="FileUpload_InvalidStrategyClass"):n<s.minSizeBytes()?(r=u.label("FileUpload_LessThanMinError").replace("{0}",s.formatSize(s.minSizeBytes())),a="FileUpload_LessThanMinError"):i<n&&(r=u.label("FileUpload_MoreThanMaxError").replace("{0}",s.formatSize(i)),a="FileUpload_MoreThanMaxError"):(r=u.label("FileUpload_ExtensionError").replace("{0}",u.value(s.CommonFileTypesAccepted)),a="FileUpload_ExtensionError"),""===r?s.ShouldUploadImmediately()?(u.setValue(s,"FileName",o),s.fileNameDisplayValue(o),s.startFileUpload(t,e)):(u.setValue(s,"FileName",o),s.fileNameDisplayValue(o),s.submitDriver=function(){s.startFileUpload(t,e)}):u.errorMessageBox({Text:r,Label:a})},s.onUploadFinished=function(e,t){if(s.finishFileUpload(),u.async.pending.decrement("Upload file complete"),t&&t.result){var o=s.ParseResult(t);o?(s.ProgressPercent(100),s.UploadWasSuccessful&&s.UploadWasSuccessful(o)):s.UploadFailed&&s.UploadFailed()}u.value(s.browseEnabled)&&s.setFocusBack()},s.onProgressUpdate=function(e,t){t.loaded<t.total&&s.ProgressPercent(Math.round(t.loaded/t.total*100))},s.onUploadFailed=function(e,t){s.finishFileUpload(),u.async.pending.decrement("Upload file failed"),s.UploadFailed&&"abort"!==t.errorThrown&&s.UploadFailed(t.errorThrown)},s.ProgressPercent=u.observable(0),u.util.loadJQueryFileUpload(),s.fileNameDisplayValue=u.observable(""),s.fileuploadInProgress=u.observable(!1),s.ProgressPercentText=u.computed(function(){return"".concat(u.value(s.ProgressPercent),"%")}),s.DisplayProgressBar=u.computed(function(){return u.value(s.fileuploadInProgress)||100===u.value(s.ProgressPercent)}),s.UploadButtonEnabled=u.computed(function(){var e=u.value(s.FileName),t=!u.value(s.IsViewMode)&&""!==e.trim();return!u.value(s.fileuploadInProgress)&&t}),s.cancelEnabled=u.computed(function(){return!u.value(s.IsViewMode)&&u.value(s.Enabled)}),s.browseEnabled=u.computed(function(){return!u.value(s.IsViewMode)&&u.value(s.Enabled)&&!u.value(s.fileuploadInProgress)}),$.when(u.deferred.onTrue(function(){return 0===u.value(u.async.pending)})).done(function(){u.value(s.BrowseText)||u.setValue(s,"BrowseText",u.label("FileUpload_BrowseButtonLabel"))}),u.observe(s.FileName,function(e){var t=u.util.parseFileNameWithDirectory(e);s.fileNameDisplayValue(t)}),s.runtimeParameters=[],s.submitDriver=null,s.myContainer=$(t),s.jqUploaderElement=s.myContainer.find(l),s}(e.FileUpload=t).prototype.FileNameLabel="",t.prototype.StrategyClassName="",t.prototype.CommonFileTypesAccepted="",t.prototype.IsFileTypesFilterValid=!0,t.prototype.UploadUrl="/fileUpload",t.prototype.MaxFileSizeInMegaBytes=u.controls.documentConstants.FILE_UPLOAD_MAX_BLOB_SIZE,t.prototype.MinFileSizeInMegaBytes=-1,t.prototype.AdditionalParameters=[],t.prototype.BrowseText="",t.prototype.Style="",t.prototype.OnUploadAttemptStarted=null,t.prototype.OnUploadCompleted=null,t.prototype.CloseDialog=null,t.prototype.FileName=""}(u.controls||(u.controls={}))}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(w){var _;function p(){return w.contextMenu._menu&&0<w.contextMenu._menu.length}function S(){if(p()&&0<w.contextMenu._menu.children().length)return w.contextMenu._menu.children()[0]}(_=w.contextMenu||(w.contextMenu={}))._menu=null,_._show=w.observable(!1),_._options=null,_._taskRecorderProvider=null,_._menuId=0,_._showRootObserver=null,_.nextMenuId=function(){return++w.contextMenu._menuId},_.setProvider=function(e){w.contextMenu._taskRecorderProvider=e},_.closeContextMenu=function(){var e,t;$(document.body).trigger("closeContextMenus"),w.contextMenu._menuId=0,w.contextMenu.contextControl=null,w.contextMenu.contextRoot=null,w.contextMenu._options&&(null!==(e=w.contextMenu._options.showSubscriber)&&void 0!==e&&e.dispose(),null!==(t=w.contextMenu._options.activeFlyoutSubscriber)&&void 0!==t&&t.dispose(),w.contextMenu._options=null),$(document.body).off("click.dynContextMenu"),$(document.body).off("resetShellOnNavigation.dynContextMenu");var o=S();o&&w.unbind(o),$(".contextMenu").remove(),w.contextMenu._menu=null},_.getContextMenuHost=function(){return w.contextMenu._menu&&0!==w.contextMenu._menu.length||(w.contextMenu._menu=$("<div id='dynContextmenu' class='contextMenu layout-root-scope'></div>"),$(document.body).append(w.contextMenu._menu)),w.contextMenu._menu},_.hasHostBeenCreated=p,_.getRootContextMenu=S,_.showContextMenu=function(o){var e=w.contextMenu.contextControl;if(e&&w.value(e.HasContextMenuOptions)&&e.GetContextMenuOptions){var t=w.value(e.GetContextMenuOptions);t&&t([],function(e){if(e){var t=void 0;$.isPlainObject(e)||(t=JSON.parse(e)),w.contextMenu.displayContextMenu(o,t)}else w.contextMenu.displayContextMenu(o,null)})}else w.contextMenu.displayContextMenu(o,null)},_.displayContextMenu=function(e,t){var o,n,i;e&&e.target&&(i=e.target);var r=w.contextMenu.getContextMenuHost();r.empty();var a=w.contextMenu.contextControl,s=w.context(w.shell.getActiveForm());s!==a&&a&&a.Root&&(s=a.Root),w.contextMenu.contextRoot=s;var l=!0;t&&t.OverrideSystemMenu&&(l=!1);var u=[];if(l){if(s&&s.FormName&&a&&$(i).trigger("contextmenuoptions",[s.FormName,_.contextControl,u]),a&&w.applyFunction(a.isInGrid,a)){for(var d=a.element;d&&(!d.classList||!d.classList.contains("listRoot")&&!d.classList.contains("react-listRoot"));)d=d.parentNode;if(d){var c=w.context(d);if(c&&c.getCommonGridContextMenuOptions){var p=c.getCommonGridContextMenuOptions(i);p&&0<p.length&&u.push.apply(u,p)}}}if(a&&"function"==typeof a.getContextMenuOptions&&a.getContextMenuOptions(i).forEach(function(e){u.push(e)}),w.contextMenu._taskRecorderProvider){var h=w.context(i);h=h||a,w.contextMenu._taskRecorderProvider.prepareShow(u,h)}if(a&&w.value(a.IsHyperlink)&&(!a.Root||"DropDialogPopup"!==a.Root.TypeName)){var m={Command:function(){w.flyout.flyoutManager.removeAllFlyoutsAsync().done(function(){w.applyFunction(a.ExecuteHyperlink,a)})},Label:w.label("ContextMenu_ViewDetails")};u.push(m)}if(w.debug.AllowUpdateUrl&&s&&s.UpdateRecordContext){var v={Command:function(){w.applyFunction(s.UpdateRecordContext,s)},Label:w.label("ContextMenu_UpdateUrl")};u.push(v)}}if(t&&t.ContextMenuOptions&&0<t.ContextMenuOptions.length&&t.ContextMenuOptions.forEach(function(e){var t={Command:function(){w.contextMenu.optionalCommand(e.MenuOptionId)},Label:e.Label};u.push(t),w.contextMenu.addContextOptions(t,e)}),0!==u.length){try{for(var g=__values(u),y=g.next();!y.done;y=g.next()){var f=y.value;w.contextMenu.processOptions(f)}}catch(e){o={error:e}}finally{try{y&&!y.done&&(n=g.return)&&n.call(g)}finally{if(o)throw o.error}}w.contextMenu.contextMenuOptions=u;var b=$("<div data-dyn-role='ContextMenu'></div>");r.append(b),w.contextMenu._options={autoClose:!1,flyout:b,moveTo:!1,show:w.contextMenu._show,skipAria:!0},w.contextMenu.contextRoot&&w.value(w.contextMenu.contextRoot.ActiveElement)?w.contextMenu._options.target=$(w.value(w.contextMenu.contextRoot.ActiveElement)):w.contextMenu.contextControl&&w.contextMenu.contextControl.element&&(w.contextMenu._options.target=$(w.contextMenu.contextControl.element)),w.util.flyout(w.contextMenu._options,!1);var C={contextMenuOptions:w.contextMenu.contextMenuOptions,contextMenuShow:w.contextMenu._show,root:w.contextMenu.contextRoot};w.dataBind(b[0],C),b.css("left","0"),b.css("top","0"),e&&(e.which===w.ui.KeyCodes.f10||!0===e.shiftKey||0===e.clientX&&0===e.clientY||0===e.button?(w.contextMenu._options.of=e.target,w.contextMenu._options.my="center top",w.contextMenu._options.at="center bottom"):(w.contextMenu._options.my="left top",w.contextMenu._options.of=e)),w.contextMenu._options.using=function(e,t){var o=$(S()),n=$(window),i=n.height(),r=n.width(),a=o.outerWidth();!w.util.isRTLMode()&&e.left+a>r&&(e.left-=a);var s=o.outerHeight();e.top+s>i&&(e.top-=s),e.top<0&&(e.top=0);var l={top:e.top,left:e.left};i<s&&(l.maxHeight=i,l.overflow="auto"),o.css(l)},w.contextMenu._show(!0),w.contextMenu._showRootObserver=w.observe(w.contextMenu._show,function(e){if(!e)return w.contextMenu.closeContextMenu(),!1},this,w.contextMenu._showRootObserver,!0)}else w.contextMenu.closeContextMenu()},_.processOptions=function(e){var t,o;if(e.Command){var n=e.Command;e.Command=function(e){n(e),$(document.body).trigger("closeContextMenus")}}if(e.contextMenuOptions)try{for(var i=__values(e.contextMenuOptions),r=i.next();!r.done;r=i.next()){var a=r.value;w.contextMenu.processOptions(a)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}},_.addContextOptions=function(o,e){o.contextMenuOptions=[],e.ContextMenuOptions&&e.ContextMenuOptions.forEach(function(e){var t;e.ContextMenuOptions&&0<e.ContextMenuOptions.length?(t={ContextMenuOptions:e.ContextMenuOptions,Label:e.Label},w.contextMenu.addContextOptions(t,e)):t={Command:function(){w.contextMenu.optionalCommand(e.MenuOptionId)},Label:e.Label},o.contextMenuOptions.push(t)})},_.optionalCommand=function(e){if(w.contextMenu.contextControl){var t=w.value(w.contextMenu.contextControl.SelectedMenuOption);t&&t(e)}},_.openContextMenuHandler=function(e,t){if(p()&&e.target&&($(e.target).parents(".contextMenuContainer").length||$(e.target).hasClass("contextMenuContainer")))e.preventDefault();else{var o,n=w.ui.getSelection();if(!(o=!(!n||""===n.toString()))){var i=e.target;o=0<w.ui.selectionEnd(i)-w.ui.selectionStart(i)}var r,a,s=e.target.nodeName.toLowerCase();r=!("input"!==s&&"textarea"!==s&&!e.target.isContentEditable),w.contextMenu._taskRecorderProvider&&(r=!w.contextMenu._taskRecorderProvider.canShow(e)),a="img"===s,w.contextMenu._show()&&w.contextMenu.closeContextMenu(),w.contextMenu.contextControl=w.ui.getLiveControl(e.target);var l=w.contextMenu.contextControl&&(!w.value(w.contextMenu.contextControl.AllowEdit)||w.contextMenu.contextControl instanceof w.controls.Tree);if(w.flags.useBrowserContextMenu||w.shell.disableContextMenu||!t&&r&&!l||a||o||w.activeForm()&&w.context(w.activeForm())&&w.context(w.activeForm()).IsLightBox)w.contextMenu.contextControl=null;else{e.preventDefault();var u=w.contextMenu.contextControl;if(u&&u instanceof w.controls.Tree){var d=$(e.target).closest(".treeView-treeItem").attr("data-dyn-id");if(0<Number(d)){var c=u.NodeData(Number(d));c&&c.ReactNode&&u.SelectNode(c.ReactNode,w.ui.Tree.HowSelected.ByMouse,w.ui.Tree.SelectionAction.Single)}}$(document.body).on("click.dynContextMenu",function(){w.contextMenu.closeContextMenu()}),$(document.body).on("resetShellOnNavigation.dynContextMenu",function(){w.contextMenu.closeContextMenu()}),w.contextMenu.showContextMenu(e)}}},$(document).on("contextmenu",w.contextMenu.openContextMenuHandler)}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(a){!function(e){Globalize.addCultureInfo("en",{messages:{ContextMenu_AddColumns:"Insert columns...",ContextMenu_ControlName:"Control Name: {0}",ContextMenu_ExportAllRows:"Export all rows",ContextMenu_ExportMarkedRows:"Export marked rows",ContextMenu_FormName:"Form Name: {0}",ContextMenu_HideColumn:"Hide this column",ContextMenu_Personalization:"Personalize",ContextMenu_PersonalizationControl:"Personalize: {0}",ContextMenu_Personalize:"Form information",ContextMenu_UpdateUrl:"Update URL",ContextMenu_ViewDetails:"View details"}});var r,t=(r=a.ui.Container,__extends(o,r),o.prototype.shouldClose=function(){return!this.isHovered()&&!this.hasOpenSubmenu()},o.prototype.hasOpenSubmenu=function(){var t,e;if(this.subMenuButtons&&0<this.subMenuButtons.length)try{for(var o=__values(this.subMenuButtons),n=o.next();!n.done;n=o.next())if(n.value.isSubContextMenuOpen())return!0}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return!1},o.prototype.tryClose=function(){this.ParentSubMenuButton&&this.shouldClose()&&this.ParentSubMenuButton.CloseContextMenu()},o.prototype.postRender=function(){var n=this;this.subMenuButtons=[],0<this.List.length&&$(this.element).find(".contextMenuButton").each(function(e,t){var o=a.context(t);o.isSubContextMenuOpen&&n.subMenuButtons.push(o)})},o.prototype.dispose=function(){this.subMenuButtons=null,$(document.body).off("closeContextMenus."+this.ContextMenuId),r.prototype.dispose.call(this)},o);function o(e,t,o,n){var i=r.call(this,e,t,o,n)||this;return i.closeContextMenu=function(){i.ContextMenuShow&&i.ContextMenuShow(!1),$(document.body).off("closeContextMenus."+i.ContextMenuId)},i.isHovered=a.observable(!1),i.ContextMenuId=a.contextMenu.nextMenuId(),i.Id="ContextMenu_"+i.ContextMenuId,e&&e.DataSource&&(i.List=e.DataSource.contextMenuOptions,i.ContextMenuShow=e.DataSource.contextMenuShow,i.ParentSubMenuButton=e.DataSource.parentSubMenuButton,i.Root=e.DataSource.root),$(document.body).on("closeContextMenus."+i.ContextMenuId,i.closeContextMenu),i}e.ContextMenu=t}(a.controls||(a.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){var e,a,t;function o(e,t,o,n){var i=a.call(this,e,t,o,n)||this;return i.CloseContextMenu=function(){i.closeTimeout=window.setTimeout(function(){if(i.closeTimeout=-1,i.subMenuFlyout&&r.context(i.subMenuFlyout[0])){var e=r.context(i.subMenuFlyout[0]);!i.isHovered()&&e.shouldClose()&&i.showMenu(!1)}},r.flags.disableAnimations?0:250)},i.Click=function(e){i.subFlyoutShowChanged(!i.showMenu()),e.stopPropagation(),r.log.stopPropagation&&r.log.stopPropagation("Context menu -> submenu -> click stopPropagation")},i.hoveredChanged=function(e){i.subFlyoutShowChanged(e)},i.showMenuChanged=function(e){!r.value(e)&&i._parent&&(i._parent.hasOpenSubmenu()||i.element.focus(),i._parent.tryClose())},i.Visible=!0,i.Enabled=!0,i.isHovered=r.observable(!1),i.showMenu=r.observable(!1),i.closeTimeout=-1,i.subMenuFlyout=null,i.options=null,r.observe(i.isHovered,i.hoveredChanged),i.showMenu.valueChanged.subscribe(i.showMenuChanged),i}e=r.controls||(r.controls={}),a=e.Button,__extends(o,a),o.prototype.isSubContextMenuOpen=function(){return this.showMenu()},o.prototype.subFlyoutShowChanged=function(e){var i=this;if(e){if(this.contextMenuOptions&&0<this.contextMenuOptions.length){if(null===this.subMenuFlyout){this.subMenuFlyout=$("<div data-dyn-role='ContextMenu'></div>"),r.contextMenu.getContextMenuHost().append(this.subMenuFlyout),this.options={autoClose:!1,flyout:this.subMenuFlyout,moveTo:!1,show:this.showMenu},r.util.flyout(this.options,!1);var t={contextMenuOptions:this.contextMenuOptions,contextMenuShow:this.showMenu,parentSubMenuButton:this,root:r.contextMenu.contextRoot};r.dataBind(this.subMenuFlyout[0],t);var o=r.context(this.subMenuFlyout[0]);o.hasSubMenu=r.observable(!1),o.isHovered.valueChanged.subscribe(this.CloseContextMenu),this.options.of=$(this.element),r.util.isRTLMode()?(this.options.my="right top",this.options.at="left top"):(this.options.my="left top",this.options.at="right top"),this.options.collision="flip flip",this.options.using=function(e,t){var o=$(i.subMenuFlyout),n=$(window).width();r.util.isRTLMode()||(e.left<0&&(e.left=0),e.left+$(o).outerWidth()>n&&(e.left=n-$(o).outerWidth())),$(o).css({top:e.top}),$(o).css({left:e.left})}}this.showMenu(!0)}}else this.subMenuFlyout&&this.CloseContextMenu()},o.prototype.dispose=function(){var e,t;-1!==this.closeTimeout&&(window.clearTimeout(this.closeTimeout),this.closeTimeout=-1),this.options&&(null!==(e=this.options.showSubscriber)&&void 0!==e&&e.dispose(),null!==(t=this.options.activeFlyoutSubscriber)&&void 0!==t&&t.dispose(),this.options=null),this.subMenuFlyout&&(r.unbind(this.subMenuFlyout[0]),this.subMenuFlyout.remove(),this.subMenuFlyout=null),a.prototype.dispose.call(this)},t=o,(e.SubMenuButton=t).prototype.bindUpdate=!1}($dyn=$dyn||{}),function(u){var e;(e=u.resizableHandle||(u.resizableHandle={}))._addResizableHandle=function(e,t,o,n,i){var r=jQuery(e),a=u.jqueryContext(e);r.resizable({handles:t,minHeight:n,minWidth:o,resize:i,zIndex:"auto"}),r.children(".ui-resizable-handle").each(function(e,t){if(t._hammer=new Hammer.Manager(t),t._hammer.add(new Hammer.Pan({})),t._hammer.on("panstart",u.resizableHandle._panStart),t._hammer.on("panend",u.resizableHandle._panEnd),t._hammer.on("panmove",u.resizableHandle._panMove),u.util.isEnhancedTabSequenceEnabled()&&(t.addEventListener("keydown",u.resizableHandle._keydownHandler),t.setAttribute("tabindex","0")),t.setAttribute("role","separator"),t.setAttribute("title",u.label("Shell_Splitter")),t.setAttribute("aria-labelledby",r.attr("id")),(t.classList.contains("ui-resizable-e")||t.classList.contains("ui-resizable-w"))&&(t.setAttribute("aria-orientation","vertical"),a)){var o=parseInt(u.value(a.LayoutWidth),10);isNaN(o)&&a.element&&(o=a.element.clientWidth),t.setAttribute("aria-valuenow","".concat(o))}if((t.classList.contains("ui-resizable-n")||t.classList.contains("ui-resizable-s"))&&(t.setAttribute("aria-orientation","horizontal"),a)){var n=parseInt(u.value(a.LayoutHeight),10);isNaN(n)&&a.element&&(n=a.element.clientWidth),t.setAttribute("aria-valuenow","".concat(n))}})},e._destroyResizableHandles=function(e){var t=jQuery(e);0<t.length&&t.hasClass("ui-resizable")&&t.resizable("instance")&&t.resizable("destroy"),t.children(".ui-resizable-handle").each(function(e,t){t._hammer&&(t._hammer.off("panstart",u.resizableHandle._panStart),t._hammer.off("panend",u.resizableHandle._panEnd),t._hammer.off("panmove",u.resizableHandle._panMove),t._hammer.destroy(),delete t._hammer),t.removeEventListener("keydown",u.resizableHandle._keydownHandler)})},e._keydownHandler=function(e){if(u.util.isShortcutKeyPressed(e,{keyCode:[u.ui.KeyCodes.rightArrow,u.ui.KeyCodes.leftArrow,u.ui.KeyCodes.downArrow,u.ui.KeyCodes.upArrow]})){var t=u.context(e.target&&e.target.parentElement);if(t){var o=$(e.target),n=parseInt(u.value(t.LayoutWidth),10);isNaN(n)&&(n=t.element.clientWidth);var i=parseInt(u.value(t.LayoutHeight),10);isNaN(i)&&(i=t.element.clientHeight);var r=0,a=0;switch(e.which||e.keyCode){case u.ui.KeyCodes.leftArrow:r=-1;break;case u.ui.KeyCodes.rightArrow:r=1;break;case u.ui.KeyCodes.upArrow:a=-1;break;case u.ui.KeyCodes.downArrow:a=1}if(u.util.isRTLMode()&&(r=-r,a=-a),o.hasClass("ui-resizable-e")||o.hasClass("ui-resizable-w")&&n){var s=n+r;u.setValue(t,"LayoutWidth",s),o.attr("aria-valuenow",s)}if(o.hasClass("ui-resizable-n")||o.hasClass("ui-resizable-s")&&i){var l=i+a;u.setValue(t,"LayoutHeight",l),o.attr("aria-valuenow",l)}u.microTask(function(){u.log.focus&&u.log.focus("Focus: Splitter-> return focus to the splitter"),o.focus()})}}},e._panStart=function(e){var t=u.context(e.target&&e.target.parentElement);if(t){var o=jQuery(e.target);t._hammerVertical=o.hasClass("ui-resizable-e")||o.hasClass("ui-resizable-w"),t._hammerHorizontal=o.hasClass("ui-resizable-n")||o.hasClass("ui-resizable-s"),t._hammerOriginalWidth=parseInt(u.value(t.LayoutWidth),10),isNaN(t._hammerOriginalWidth)&&(t._hammerOriginalWidth=t.element.clientWidth),t._hammerOriginalHeight=parseInt(u.value(t.LayoutHeight),10),isNaN(t._hammerOriginalHeight)&&(t._hammerOriginalHeight=t.element.clientHeight)}},e._panMove=function(e){if(e.target){var t=u.context(e.target.parentElement);if(t){if(t._hammerVertical&&t._hammerOriginalWidth&&(e.target.classList.contains("ui-resizable-e")||e.target.classList.contains("ui-resizable-w"))){var o=t._hammerOriginalWidth+e.deltaX;u.setValue(t,"LayoutWidth",o),e.target.setAttribute("aria-valuenow","".concat(o))}if(t._hammerHorizontal&&t._hammerOriginalHeight&&(e.target.classList.contains("ui-resizable-n")||e.target.classList.contains("ui-resizable-s"))){var n=t._hammerOriginalHeight+e.deltaY;u.setValue(t,"LayoutHeight",n),e.target.setAttribute("aria-valuenow","".concat(n))}}}},e._panEnd=function(e){var t=u.context(e.target&&e.target.parentElement);t&&(delete t._hammerOriginalWidth,delete t._hammerOriginalHeight,delete t._hammerHorizontal,delete t._hammerVertical)}}($dyn=$dyn||{}),function(C){(C.ax||(C.ax={})).getContextMenuOptions=function(e,t,o,n){var i,r,a,s,l=e.target,u={Label:C.label("ContextMenu_Personalize"),contextMenuOptions:[]};n.push(u);var d,c={Command:function(){var e=o.ExecutePersonalizationCommand;void 0===e&&o&&o.Root&&(e=o.Root.ExecutePersonalizationCommand),o&&e&&o.Root&&!o.Root.isPopup()&&C.callFunction(e,o,["LaunchFormPersonalizationPane"])},Enabled:"FormControlPersonalization"!==C.value(t),Label:C.format(C.label("ContextMenu_FormName"),C.value(t)),Name:"GoTo_Form"};u.contextMenuOptions.push(c);var p,h=null;if(C.context(o.element)?h=o.element:C.context(l)&&(h=l),h?(p=C.serverForm.getElementControlParams(h))&&(d=C.value(p.Name)):d=C.value(o.Name),d){var m={Command:function(){var e=C.flags.confirmExit;C.flags.confirmExit=!1,location.assign(C.format("dynamics://Navigation/Form/{0}/Control/{1}",encodeURIComponent(C.value(t)),encodeURIComponent(d))),C.flags.confirmExit=!1,C.async(function(){C.flags.confirmExit=e},void 0,"Reset confirmExit after setting context menu control name.")},Label:C.format(C.label("ContextMenu_ControlName"),d),Name:C.format("GoTo_{0}",d)};u.contextMenuOptions.push(m)}var v=o,g=d||C.value(o.Name),y=o.Root&&(null===(r=(i=o.Root).findControl)||void 0===r?void 0:r.call(i,g));if(y&&(p=C.serverForm.getElementControlParams(y))&&(d=C.value(p.Name)),p&&d&&o&&o.Root){var f=null===(s=(a=o.Root).findControl)||void 0===s?void 0:s.call(a,d);d=f?(v=C.context(f)).Name:(v=null,"")}if(v&&v.Root&&!o.Root.isPopup()){var b=C.ax.formPersonalizationPane.formPersonalizationController.getPersonalizationOptions(d,v);b&&n.push(b)}},$(document).on("contextmenuoptions",C.ax.getContextMenuOptions)}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(g){var e,t,o,n,i,r;function a(e){var r=this;this.dispose=function(){var t,e;try{for(var o=__values(r.subscriptions),n=o.next();!n.done;n=o.next()){var i=n.value;i&&i.dispose&&i.dispose()}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}r.subscriptions=null,g.ax.taskGuide.repositionGuidedQtip=null},this.subscriptions=[],this.guidedStep=null,this.inputChanged=!1,this._currentErrorState=t.ControlLevelErrors.NoError,i.repositionGuidedQtip||(i.repositionGuidedQtip=g.observable(!1)),g.observe(g.ax.taskGuide.repositionGuidedQtip,function(e){e&&r.guidedStep&&r.guidedStepHandler()}),this.subscriptions.push(g.observe(g.clientBusy,function(e){!e&&r.guidedStep&&r.guidedStepHandler()}))}Globalize.addCultureInfo("en",{messages:{TaskGuides_ControlLevel_ErrorMsg1:"You are not on the right page, the page appears to have been closed.",TaskGuides_ControlLevel_ErrorMsg2:"Close this dialog to continue with this task guide.",TaskGuides_ControlLevel_ErrorMsg3:"Close this page to continue with this task guide.",TaskGuides_ControlLevel_ErrorTitle1:"Oops!",TaskGuidesStep_RailsSwitchAckNote:"You can lock or unlock access to all controls using this switch at any step during task guide.",TaskGuidesStep_ShowLess:"Show less",TaskGuidesStep_ShowMore:"Show more"}}),e=g.ax||(g.ax={}),o=t=e.taskRecorder||(e.taskRecorder={}),(n=o.ControlLevelErrors||(o.ControlLevelErrors={}))[n.NoError=0]="NoError",n[n.FormNotFound=1]="FormNotFound",n[n.FormCoveredByDialog=2]="FormCoveredByDialog",n[n.FormCoveredByAnotherForm=3]="FormCoveredByAnotherForm",i=e.taskGuide||(e.taskGuide={}),a.prototype.setup=function(e,t){var o=this;this.input=e,this.output=t,this.subscriptions.push(g.observe(e,function(e){o.guidedStep=e,o.inputChanged=!0,o.guidedStepHandler()}))},a.prototype.guidedStepHandler=function(){var t=this;if(!g.value(g.clientBusy)){var e=this.guidedStep,o=this.inputChanged;this.inputChanged=!1;var n=this._currentErrorState;if(g.serverForm.defaultChannel&&g.serverForm.interactionHandler){var i=g.serverForm.defaultChannel(),r=g.serverForm.interactionHandler;if(e){var a={action:e.action,arguments:e.arguments},s={allowBack:e.allowBack,allowNext:e.allowNext,Example:"",Note:e.note,Step:e.step,Title:e.title},l=void 0;if(e.controlName&&e.formId){if(l=r.getFormElement(e.formId+"_"+i.channel.channelId)){var u=g.ui.findControl(e.controlName,l);u&&(a=u.getTaskGuideParams(a))}}else if(e.formId&&(l=r.getFormElement(e.formId+"_"+i.channel.channelId))){var d=g.context(l);d&&(a=d.getTaskGuideParams(a))}var c=g.shell.getActiveForm(),p=void 0;if(c&&(p=g.context(c)),e.formId&&!l)this._currentErrorState=g.ax.taskRecorder.ControlLevelErrors.FormNotFound;else if(l){var h=g.context(l);l===c||p instanceof g.controls.Popup||p instanceof g.controls.PartForm||h instanceof g.controls.PartForm&&c&&$.contains(c,l)?this._currentErrorState=g.ax.taskRecorder.ControlLevelErrors.NoError:p instanceof g.controls.Dialog?this._currentErrorState=g.ax.taskRecorder.ControlLevelErrors.FormCoveredByDialog:p instanceof g.controls.Form&&(this._currentErrorState=g.ax.taskRecorder.ControlLevelErrors.FormCoveredByAnotherForm)}else this._currentErrorState=g.ax.taskRecorder.ControlLevelErrors.NoError;if(o||this._currentErrorState!==n||g.value(g.ax.taskGuide.repositionGuidedQtip)){g.ax.taskGuide.repositionGuidedQtip(!1);var m=$.extend({},a),v=$.extend({},s);this._currentErrorState===g.ax.taskRecorder.ControlLevelErrors.FormNotFound?($.extend(v,{Note:"",Step:g.label("TaskGuides_ControlLevel_ErrorMsg1"),Title:g.label("TaskGuides_ControlLevel_ErrorTitle1")}),m.target=null,m.avoidRailsModeBlocks=!0):this._currentErrorState===g.ax.taskRecorder.ControlLevelErrors.FormCoveredByDialog?($.extend(v,{Note:"",Step:g.label("TaskGuides_ControlLevel_ErrorMsg2"),Title:""}),p&&(m=p.getTaskGuideParams($.extend(m,{action:""}))),m.avoidRailsModeBlocks=!0):this._currentErrorState===g.ax.taskRecorder.ControlLevelErrors.FormCoveredByAnotherForm&&($.extend(v,{Note:"",Step:g.label("TaskGuides_ControlLevel_ErrorMsg3"),Title:""}),p&&(m=p.getTaskGuideParams($.extend(m,{action:"RequestClose"}))),m.avoidRailsModeBlocks=!0),this._currentErrorState!==g.ax.taskRecorder.ControlLevelErrors.NoError&&g.ax.taskRecording&&g.ax.taskRecording.taskRecorderStateControl&&g.ax.taskRecording.taskRecorderStateControl.LogTaskGuideClientErrorTelemetryEvent&&g.callFunction(g.ax.taskRecording.taskRecorderStateControl.LogTaskGuideClientErrorTelemetryEvent,this,[this._currentErrorState]),g.isObservable(m.target)?(m.targetSubscriptions&&this.subscriptions.concat(m.targetSubscriptions),this.subscriptions.push(g.observe(m.target,function(e){m.target=e,t.output({content:v,options:m})}))):this.output({content:v,options:m})}}}}},r=a,i.ControlComponent=r}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(g){var e,t,o;function n(e){var r=this;this.dispose=function(){var t,e;r._unsubscribeFromScrollEvents(),r._unsubscribeFromResizeEvent(),r.$shadowTarget&&r.$shadowTarget.remove();try{for(var o=__values(r.subscriptions),n=o.next();!n.done;n=o.next()){var i=n.value;i&&i.dispose&&i.dispose()}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}r.subscriptions=null},this._resizeHandler=function(){r._resizeTimeoutId&&clearTimeout(r._resizeTimeoutId),r._resizeTimeoutId=setTimeout(function(){r.output(r._reposition(r.input()))},100)},this._scrollHandler=function(){r._scrollTimoutId&&clearTimeout(r._scrollTimoutId),r._scrollTimoutId=setTimeout(function(){r.output(r._reposition(r.input()))},100)},this.subscriptions=[],this.scrollParents=[],this.$shadowTarget=null,this._resizeTimeoutId=null,this._scrollTimoutId=null,this._createShadowTarget(),this._subscribeToResizeEvent()}e=g.ax||(g.ax={}),t=e.taskGuide||(e.taskGuide={}),n.prototype.setup=function(e,t){var o=this;this.input=e,this.output=t,this.subscriptions.push(g.observe(e,function(e){o._unsubscribeFromScrollEvents(),o._buildScrollParents(),o._subscribeToScrollEvents(),o.output(o._reposition(e))})),this.subscriptions.push(g.observe(g.ax.taskRecording.taskGuideRailsMode,function(e){e&&o.output(o._reposition(o.input()))}))},n.prototype._unsubscribeFromScrollEvents=function(){var t,e;try{for(var o=__values(this.scrollParents),n=o.next();!n.done;n=o.next()){var i=n.value;i&&i.off("scroll",this._scrollHandler)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},n.prototype._subscribeToScrollEvents=function(){var t,e;try{for(var o=__values(this.scrollParents),n=o.next();!n.done;n=o.next()){var i=n.value;i&&i.scroll(this._scrollHandler)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},n.prototype._buildScrollParents=function(){this.scrollParents=[];var e=this.input&&this.input()&&this.input().options;if(e&&e.target&&e.target.length&&e.target.scrollParent)for(var t=e.target.scrollParent();t&&t.length&&t[0]!==document;)this.scrollParents.push(t),t=t.scrollParent()},n.prototype._subscribeToResizeEvent=function(){$(window).on("resize",this._resizeHandler)},n.prototype._unsubscribeFromResizeEvent=function(){$(window).off("resize",this._resizeHandler)},n.prototype._createShadowTarget=function(){var e=document.createElement("div");e.style.position="absolute",e.style.visibility="hidden",document.body.appendChild(e),this.$shadowTarget=$(e)},n.prototype._resizeShadowTarget=function(e){this.$shadowTarget[0].style.left=e.left.toString()+"px",this.$shadowTarget[0].style.top=e.top.toString()+"px",this.$shadowTarget[0].style.width=(e.right-e.left).toString()+"px",this.$shadowTarget[0].style.height=(e.bottom-e.top).toString()+"px"},n.prototype._reposition=function(e){var t,o,n;if(e){var i=$.extend(!0,{},e.content),r=$.extend(!0,{},e.options);if(!(this.scrollParents&&r&&r.target&&r.target[0]&&r.target[0].offsetWidth&&i))return{content:i,options:r};var a=this.scrollParents.slice(0);a.unshift(r.target);var s,l=g.ax.taskGuidesUtil.visibilityDataForNestedElements(a),u=r.target&&$(r.target);if(u&&u[0]&&g.value(g.ax.taskRecording.taskGuideRailsMode)&&!l[0].isGloballyVisible()){var d=g.ui.getLiveControl(u[0]);null!==(n=null==d?void 0:d.isInGrid)&&void 0!==n&&n.call(d)&&null!=d&&d.listControl?(d.listControl.element.scrollIntoViewIfNeeded(),d.listControl.scrollColumnIntoViewIfNeeded(d.Name)):u[0].scrollIntoView(),l=g.ax.taskGuidesUtil.visibilityDataForNestedElements(a)}var c=null,p=0;try{for(var h=__values(l),m=h.next();!m.done;m=h.next()){var v=m.value;if(0===p&&v.isGloballyVisible()){$.extend(r,{shadowTarget:null});break}if(0===p&&v.isGloballyPartiallyVisible()){this._resizeShadowTarget(v.visibleArea),$.extend(r,{shadowTarget:this.$shadowTarget});break}if(0!==p&&v.isGloballyVisible()){s=c.verticalVisibilityLabel()+" "+c.horizontalVisibilityLabel(),$.extend(r,{adjustMethod:"none",at:s,my:s,shadowTarget:null,target:v.$element}),i.Title=g.ax.taskGuidesUtil.qtipPositionToVerbal(s),i.Example="",i.Note="",i.Step="";break}if(0!==p&&v.isGloballyPartiallyVisible()){s=c.verticalVisibilityLabel()+" "+c.horizontalVisibilityLabel(),this._resizeShadowTarget(v.visibleArea),$.extend(r,{adjustMethod:"none",at:s,my:s,shadowTarget:this.$shadowTarget,target:v.$element}),i.Title=g.ax.taskGuidesUtil.qtipPositionToVerbal(s),i.Example="",i.Note="",i.Step="";break}c=v,p++}}catch(e){t={error:e}}finally{try{m&&!m.done&&(o=h.return)&&o.call(h)}finally{if(t)throw t.error}}return{content:i,options:r}}},n.prototype.__forceRecalculate=function(){this.output(this._reposition(this.input()))},o=n,t.ScrollComponent=o}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(n){var e,t,o;function i(e){var r=this;this.dispose=function(){var t,e;r.railsModeTarget(null),r._surroundingBlockingDiv&&r._surroundingBlockingDiv.destroy(),r._lastOpenedflyoutTarget=null,$(document).off("flyoutRegistered",r.flyoutRegisteredHandler),$(document).off("flyoutRemoved",r.flyoutRemovedHandler);try{for(var o=__values(r.subscriptions),n=o.next();!n.done;n=o.next()){var i=n.value;i&&i.dispose&&i.dispose()}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}r.subscriptions=null},this.flyoutRegisteredHandler=function(){if(n.flyout.flyoutManager.areAnyFlyoutsOpen()){var e=n.flyout.flyoutManager.getTopFlyout();if(e&&e.flyout){var t=n.value(e.flyout);t&&0<t.length&&(r._lastOpenedflyoutTarget=r.railsModeTarget(),r.railsModeTarget(null))}}},this.flyoutRemovedHandler=function(){r._lastOpenedflyoutTarget&&r.railsModeTarget(r._lastOpenedflyoutTarget),r.resetTopFlyoutTargetTracker()},this.subscriptions=[],this._blockRenderTimer=null,this.railsModeTarget=n.observable(null),this._lastOpenedflyoutTarget=null,this._railsModeBlocksExist=n.observable(!1),this._surroundingBlockingDiv=new n.shell.surroundingBlockingDiv(n.ax.taskRecording.animatetaskGuideQTip,["taskGuide-ignoreObscurityError","applicationShell-surroundingBlockingDiv"]),$(document).on("flyoutRegistered",this.flyoutRegisteredHandler),$(document).on("flyoutRemoved",this.flyoutRemovedHandler),this.subscriptions.push(n.observe(this._railsModeBlocksExist,function(e){n.util.flyout.forceFlyoutSelection=e})),this.subscriptions.push(n.observe(function(){return n.value(n.ax.taskRecording.taskGuidePlaybackState)&&n.value(n.ax.taskRecording.taskGuideRailsMode)&&n.value(r.railsModeTarget)},function(e){(e||n.value(r._railsModeBlocksExist))&&r._onRenderBlocks()}))}Globalize.addCultureInfo("en",{TaskGuide_ShowSteps:"Show steps",TaskGuidesStep_BackStep:"Previous step",TaskGuidesStep_CollapseTitle:"Collapse",TaskGuidesStep_ExampleLabel:"Example",TaskGuidesStep_ExpandTitle:"Expand",TaskGuidesStep_NextStep:"Skip this step",TaskGuidesStep_NoteLabel:"Note",TaskRecorder_EditStep:"Edit step",TaskRecorder_RecordingInProgress:"Task recording in progress",TaskRecorder_ScenarioName:"Test Scenario Name"}),e=n.ax||(n.ax={}),t=e.taskGuide||(e.taskGuide={}),i.prototype.setup=function(e,t){var o=this;this.input=e,this.output=t,this.subscriptions.push(n.observe(e,function(e){o.evaluateRailsModeBlocks(e)}))},i.prototype.evaluateRailsModeBlocks=function(e){if(this.resetTopFlyoutTargetTracker(),e){var t=e.options,o=t.target&&$(t.target);t.shadowTarget&&$(t.shadowTarget)||!o||!o[0]||t.avoidRailsModeBlocks?this.railsModeTarget(null):this.railsModeTarget(o),this.output(e,!0)}},i.prototype._renderBlocks=function(){n.value(n.ax.taskRecording.taskGuidePlaybackState)&&n.value(n.ax.taskRecording.taskGuideRailsMode)&&null!=n.value(this.railsModeTarget)?(this._surroundingBlockingDiv.show(n.value(this.railsModeTarget)),this._railsModeBlocksExist(!0)):n.value(this._railsModeBlocksExist)&&(this._surroundingBlockingDiv.hide(),this._railsModeBlocksExist(!1)),this._blockRenderTimer=void 0},i.prototype._onRenderBlocks=function(){this._renderBlocks()},i.prototype.resetTopFlyoutTargetTracker=function(){this._lastOpenedflyoutTarget=null},o=i,t.RailsModeComponent=o}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(a){var e,t,o;function n(e){var r=this;this.controller=e,this.dispose=function(){var t,e;try{for(var o=__values(r.subscriptions),n=o.next();!n.done;n=o.next()){var i=n.value;i&&i.dispose&&i.dispose()}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}r.subscriptions=null,$(document).off("flyoutRemoved",r.flyoutRemovedHandler),a.shell.shellReflowEvent().unsubscribe(r.shellReflowSubscriberId)},this.flyoutRemovedHandler=function(){r.guidedStep&&r.deferHandleLayoutUpdates(400)},this.onShellReflow=function(){r._hasShellReflowed=!0},this.subscriptions=[],this._isCurrentlyInErrorState=!1,this.guidedStep=null,this._hasShellReflowed=!1,this.shellReflowSubscriberId=a.shell.shellReflowEvent().subscribe(this.onShellReflow),this.subscriptions.push(a.observe(a.ui.layout,function(e){!e&&r.guidedStep&&r.deferHandleLayoutUpdates(400)})),$(document).on("flyoutRemoved",this.flyoutRemovedHandler)}e=a.ax||(a.ax={}),t=e.taskGuide||(e.taskGuide={}),n.prototype.setup=function(e,t){var o=this;this.input=e,this.output=t,this.subscriptions.push(a.observe(e,function(e){o.guidedStep=e,o.inputChanged=!0,void 0===o._evaluateErrorStateTimer&&o.deferHandleLayoutUpdates(0)}))},n.prototype.deferHandleLayoutUpdates=function(e){var t=this;void 0!==this._evaluateErrorStateTimer&&(this.controller.clearTimeout(this._evaluateErrorStateTimer),this._evaluateErrorStateTimer=void 0),void 0===this._evaluateErrorStateTimer&&(this._evaluateErrorStateTimer=this.controller.setTimeout(function(){t._evaluateErrorStateTimer=void 0,t.handleLayoutUpdates()},e))},n.prototype.handleLayoutUpdates=function(){var e=this.guidedStep,t=this.inputChanged;if(this.inputChanged=!1,e)if(e&&e.options&&!this._targetIsAccessible(e.options.target,e.options.shadowTarget)){if(!this._isCurrentlyInErrorState||t||this._hasShellReflowed){var o=$.extend({},e);o.options=$.extend({},o.options,{shadowTarget:null,target:null}),this._isCurrentlyInErrorState=!0,this.output(o)}}else(this._isCurrentlyInErrorState||t||this._hasShellReflowed)&&(this._isCurrentlyInErrorState=!1,this._hasShellReflowed=!1,this.output(e,!0))},n.prototype._targetIsAccessible=function(e,t){if(e=e&&$(e),t=t&&$(t),!(e&&e[0]&&e[0].offsetWidth&&e[0].offsetHeight))return!1;var o,n=(o=t&&t[0]?t:e).offset(),i=n.top,r=n.left,a=i+o.height(),s=r+o.width();return!!(this._elementFromPointMatchesTarget(e[0],r+1,i+1)||this._elementFromPointMatchesTarget(e[0],s-1,i+1)||this._elementFromPointMatchesTarget(e[0],s-1,a-1)||this._elementFromPointMatchesTarget(e[0],r+1,a-1))},n.prototype._getElementFromPoint=function(e,t){return document.elementFromPoint(e,t)?document.elementFromPoint(e,t):null},n.prototype._elementExistsInHierachy=function(e,t){for(var o=e;o;){if(o===t)return!0;o=o.parentNode}return!1},n.prototype._elementFromPointMatchesTarget=function(e,t,o){var n=this._getElementFromPoint(t,o);return!!(n&&$(n)&&$(n).closest(".taskGuide-ignoreObscurityError")&&$(n).closest(".taskGuide-ignoreObscurityError")[0])||!(!this._elementExistsInHierachy(e,n)&&!this._elementExistsInHierachy(n,e))},o=n,t.LayoutUpdateHandlingComponent=o}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(i){var e,t,o;function n(e){var r=this;this.controller=e,this.dispose=function(){var t,e;try{for(var o=__values(r.subscriptions),n=o.next();!n.done;n=o.next()){var i=n.value;i&&i.dispose&&i.dispose()}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}r.subscriptions=null},this.subscriptions=[]}e=i.ax||(i.ax={}),t=e.taskGuide||(e.taskGuide={}),n.prototype.setup=function(e,t){var o=this;this.input=e,this.output=t,this.subscriptions.push(i.observe(e,function(e){o.output(o._updateQTipPosition(e))}))},n.prototype._updateQTipPosition=function(e){if(e){if(this.controller.testFlag)return e;var t=e.options;t.target=$(t.target),t.shadowTarget=$(t.shadowTarget);var o=$("#mainPane"),n=$("#"+i.shell.stackContainerId);return t.target&&t.target[0]||$.extend(t,{adjust:{x:-10,y:n.offset().top-o.offset().top+10},at:i.layout.qTipPosition.topRight,my:i.layout.qTipPosition.topRight,shadowTarget:null,styles:{hideTip:!0},target:o}),{options:t,content:e.content}}},o=n,t.QTipComponent=o}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(d){var e;Globalize.addCultureInfo("en",{messages:{TaskGuidesStep_ConfirmInfoStep:"Got it",TaskGuidesStep_RailsSwitchAckMsg:"Click here if you wish to unlock access to all controls",TaskGuidesStep_RailsSwitchAckNote:"You can lock or unlock access to all controls using this switch at any step during task guide.",TaskGuidesStep_ShowLess:"Show less",TaskGuidesStep_ShowMore:"Show more"}}),function(e){var l,t;(t=l=e.ActionType||(e.ActionType={})).Info="Info",t.None="";var o=(n.prototype.addSubscription=function(e){this.subscriptions.push(e)},n.prototype.setComponentsDisposal=function(e){this.componentsDisposal=e},n.prototype.initPlaceholder=function(){this.contentPlaceholder=document.createElement("div"),this.contentPlaceholder.setAttribute("data-dyn-template","templateId: 'TaskGuideStep'"),d.dataBind(this.contentPlaceholder,new d.DataContext(this))},n.prototype.chainComponents=function(e,t){var o,n,i=e,r=[];try{for(var a=__values(t),s=a.next();!s.done;s=a.next()){var l=s.value,u=d.observable();l.setup(i,u),r.push(l.dispose),i=u}}catch(e){o={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return{dispose:function(){var t,e;try{for(var o=__values(r),n=o.next();!n.done;n=o.next()){var i=n.value;i&&i()}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},output:i}},n.prototype.setTimeout=function(e,t,o){var n=this;if(!this._ignorePostponedCallbacks){if(!this.testFlag)return this.pendingTimeOut(d.peek(this.pendingTimeOut)+1),window.setTimeout(function(){n.pendingTimeOut(d.peek(n.pendingTimeOut)-1),e.apply(null,o)},t);e.apply(null,o)}},n.prototype.clearTimeout=function(e){this._ignorePostponedCallbacks||this.testFlag||(this.pendingTimeOut(d.peek(this.pendingTimeOut)-1),window.clearTimeout(e))},n.prototype.onRailsBlocksClicked=function(){var t=this,e=0;if(!(d.value(d.clientBusy)||d.value(this.serverUpdatePending)||0<d.value(this.pendingTimeOut)||d.value(this.RailsSwitchAckVisible))){var o=$("#railsModeUnlock");if(e%2==0){var n={action:"",adjustMethod:"flip",at:d.layout.qTipPosition.bottomCenter,my:d.layout.qTipPosition.topCenter,target:o},i={allowBack:!1,allowNext:!1,Note:d.label("TaskGuidesStep_RailsSwitchAckNote"),Step:d.label("TaskGuidesStep_RailsSwitchAckMsg")};this.updateQTip({content:i,options:n});var r=d.observe(d.ax.taskRecording.taskGuideRailsMode,function(e){!e&&t&&d.value(t.RailsSwitchAckVisible)&&(t.clearRailsSwitchAck(),t.chainOutput&&t.updateQTip(d.value(t.chainOutput.output)))}),a=d.observe(this.chainOutput.output,function(){d.value(t.RailsSwitchAckVisible)&&t.clearRailsSwitchAck()});this.clearRailsSwitchAck=function(){r&&(r.dispose(),r=void 0),a&&(a.dispose(),a=void 0),t.RailsSwitchAckVisible(!1)},this.RailsSwitchAckVisible(!0)}else $(document.body).addClass("taskGuide-animate"),window.setTimeout(function(){$(document.body).removeClass("taskGuide-animate")},100);e++}},n.prototype.disposeTaskGuide=function(){if(this.componentsDisposal){if(this.subscriptions)for(var e in this.subscriptions)this.subscriptions[e]&&this.subscriptions[e].dispose&&this.subscriptions[e].dispose();this.componentsDisposal(),this.disposeQTip()}this._forceHideTip=void 0},n.prototype.initTaskGuide=function(e){return this.testFlag=e,this.testFlag||this.initPlaceholder(),this.controlComponent=new d.ax.taskGuide.ControlComponent(this),this.scrollComponent=new d.ax.taskGuide.ScrollComponent(this),this.qtipComponent=new d.ax.taskGuide.QTipComponent(this),this.railsModeComponent=new d.ax.taskGuide.RailsModeComponent(this),this.layoutUpdateHandlingComponent=new d.ax.taskGuide.LayoutUpdateHandlingComponent(this),this.chainOutput=this.chainComponents(this.GuidedStep,[this.controlComponent,this.scrollComponent,this.layoutUpdateHandlingComponent,this.railsModeComponent,this.qtipComponent]),this.setComponentsDisposal(this.chainOutput.dispose),this.testFlag||this.addSubscription(d.observe(this.chainOutput.output,this.updateQTip)),d.value(this.chainOutput.output)},n.prototype.showHideTip=function(e){var t=this._forceHideTip;void 0===t&&(t=e&&e.styles&&e.styles.hideTip),t?this.qtip.elements.tip.css("visibility","hidden"):this.qtip.elements.tip.css("visibility","")},n.prototype.showHideOnTransition=function(e){var t,o=this;this.qtip&&(e?(this.qtip.elements.tooltip.addClass("on-transition"),t=!1):t||(t=!0,window.setTimeout(function(){t&&(o.qtip.elements.tooltip.removeClass("on-transition"),t=!1)},d.flags.disableAnimations?0:400)))},n.prototype.disposeQTip=function(){if(this.qtip){if(this.qtip.options&&this.qtip.options.content&&this.qtip.options.content.text&&0<this.qtip.options.content.text.length){var e=this.qtip.options.content.text[0];d.unbind(e)}this.qtip.destroy(!0),this.qtip=null,this.NextButtonVisible.valueChanged.clear(),this.BackButtonVisible.valueChanged.clear()}},n);function n(){var s=this;this.ToggleDetails=function(){var e=d.value(s.DetailsGroupVisibilityToggled);s.DetailsGroupVisibilityToggled(!e),s.qtip.reposition(),s.showHideTip()},this.ToggleGuidedStep=function(){var e=d.value(s.GuidedStepVisible);s.GuidedStepVisible(!e),s.qtip.reposition(),s.showHideTip()},this.SkipBackGuidedStep=function(){s.showHideOnTransition(!0),s.skipBackGuidedStepTrigger(d.peek(s.skipBackGuidedStepTrigger)+1)},this.SkipGuidedStep=function(){s.showHideOnTransition(!0),s.skipGuidedStepTrigger(d.peek(s.skipGuidedStepTrigger)+1)},this.onContinueTaskGuideClicked=function(){s.clearRailsSwitchAck(),s.chainOutput&&s.updateQTip(d.value(s.chainOutput.output))},this.updateQTip=function(e){var n={height:12,width:26},i={method:"flipinvert",resize:!1,scroll:!1,x:0,y:0};if(e){s.clientIsNotBusy&&s.clientIsNotBusy.reject(),s.clientBusySubscription&&(s.clientBusySubscription.dispose&&s.clientBusySubscription.dispose(),s.clientBusySubscription=void 0);var r=e.options,a=e.content;s.clientIsNotBusy=$.Deferred(),s.clientBusySubscription=d.observe(function(){return!d.value(d.clientBusy)&&!d.value(s.serverUpdatePending)&&d.value(s.pendingTimeOut)<=0},function(e){if(e)return s.clientIsNotBusy&&s.clientIsNotBusy.resolve(),!1}),$.when(s.clientIsNotBusy).done(function(){if(null!==s.clientIsNotBusy&&!1!==d.value(d.ax.taskRecording.taskRecorderStateControl.TaskGuidePlaybackState)){if(s._ignorePostponedCallbacks=!0,d.value(s.GuidedStep)&&(d.value(s.GuidedStep).action===l.Info?s.ActionType(l.Info):s.ActionType(d.value(s.GuidedStep).action)),a&&(s.Title(a.Title),s.Header(a.Header?a.Header:""),s.Image(a.Image),s.Example(a.Example),s.Note(a.Note),s.Step(a.Step),s.GuidedStepVisible(!0),s.BackButtonVisible(!1!==a.allowBack),s.NextButtonVisible(!1!==a.allowNext&&!d.value(s.ConfirmInfoStepVisible)),a.ConfirmInfoStepText?s.ConfirmInfoStepText(a.ConfirmInfoStepText):s.ConfirmInfoStepText(d.label("TaskGuidesStep_ConfirmInfoStep")),s.ShowMinimizeButton(!0!==a.HideMinimizeButton)),r){var e=r.target;if(r.shadowTarget&&r.shadowTarget[0]&&(e=r.shadowTarget),s.qtip){var t=function(){s.lastAppliedClasses&&(s.qtip.elements.tooltip.removeClass(s.lastAppliedClasses),s.lastAppliedClasses=void 0),r.styles&&r.styles.classes&&(s.lastAppliedClasses=r.styles.classes,s.qtip.elements.tooltip.addClass(s.lastAppliedClasses));var o={"position.at":r.at,"position.my":r.my,"position.target":e};$.each($.extend({},i,{method:r.adjustMethod},r.adjust),function(e,t){o["position.adjust."+e]=t}),s.qtip.set(o),s.qtip.focus(),s.showHideTip(r)};!1===d.peek(s.qtipCreated)?d.observe(s.qtipCreated,function(){if(!0===d.peek(s.qtipCreated))return t(),!1}):t()}else{s.qtipCreated(!1);var o="taskGuide-popup binding-focusRegion taskGuide-ignoreObscurityError baseDirection";r.styles&&r.styles.classes&&(s.lastAppliedClasses=r.styles.classes,o=o+" "+s.lastAppliedClasses),s.qtip=$(document.body).qtip({content:{text:$(s.contentPlaceholder)},hide:"false",position:{adjust:{method:r.adjustMethod||"flip",resize:r.adjust&&r.adjust.resize||!1,scroll:r.adjust&&r.adjust.scroll||!1,x:r.adjust&&r.adjust.x||0,y:r.adjust&&r.adjust.y||0},at:r.at||d.layout.qTipPosition.rightCenter,effect:function(e,t,o){if(s._forceHideTip=void 0,t){var n=s.qtip.elements.tooltip.width(),i=s.qtip.elements.tooltip.height();if(t.left<0||t.left+n>$(window).width()||t.top<0||t.top+i>$(window).height()){var r=$("#"+d.shell.stackContainerId);t.left=r.offset().left+r.width()-n-10,t.top=r.offset().top+10,s._forceHideTip=!0}}s.qtip.elements.tooltip.animate(t,{duration:d.flags.disableAnimations?0:400,easing:"swing",queue:!1})},my:r.my||d.layout.qTipPosition.rightCenter,target:e,viewport:$(window)},style:{classes:o,tip:n}}).qtip("api"),window.setTimeout(function(){s.qtip.show(),s.showHideTip(r),s.qtipCreated(!0)},d.flags.disableAnimations?0:400)}}s._ignorePostponedCallbacks=!1,s.clientIsNotBusy=null}})}},this.GuidedStep=null,this.qtip=null,this.tipHidden=!1,this.tipWidth=26,this.Title=d.observable(""),this.Header=d.observable(""),this.Image=d.observable(),this.Example=d.observable(""),this.Note=d.observable(""),this.Step=d.observable(""),this.ActionType=d.observable(l.None),this.ConfirmInfoStepText=d.observable(""),this.DetailsGroupVisibilityToggled=d.observable(!1),this.GuidedStepVisible=d.observable(!0),this.serverUpdatePending=d.observable(!1),this.RailsSwitchAckVisible=d.observable(!1),this.NextButtonVisible=d.observable(!1),this.BackButtonVisible=d.observable(!1),this.skipBackGuidedStepTrigger=d.observable(0),this.skipGuidedStepTrigger=d.observable(0),this.pendingTimeOut=d.observable(0),this._ignorePostponedCallbacks=!1,this.qtipCreated=d.observable(!1),this.clientIsNotBusy=null,this.clientBusySubscription=null,this.ShowMinimizeButton=d.observable(!0),this.componentsDisposal=null,this.subscriptions=[],this.GuidedStepCollapsed=d.computed(function(){return!s.GuidedStepVisible()}),this.TitleVisible=d.computed(function(){return""!==s.Title()}),this.HeaderVisible=d.computed(function(){return""!==s.Header()}),this.ImageVisible=d.computed(function(){return void 0!==s.Image()&&null!==s.Image()}),this.StepVisible=d.computed(function(){return""!==s.Step()}),this.StepAndTitleVisible=d.computed(function(){return s.StepVisible()&&s.TitleVisible()}),this.ExampleGroupVisible=d.computed(function(){return""!==d.value(s.Example)}),this.NoteGroupVisible=d.computed(function(){return""!==d.value(s.Note)}),this.ConfirmInfoStepVisible=d.computed(function(){return d.value(s.ActionType)===d.ax.taskRecorder.ActionType.Info&&!d.value(s.RailsSwitchAckVisible)}),this.DetailsGroupVisible=d.computed(function(){return d.value(s.DetailsGroupVisibilityToggled)}),this.DetailsButtonTitle=d.computed(function(){return d.value(s.DetailsGroupVisible)?d.label("TaskGuidesStep_ShowLess"):d.label("TaskGuidesStep_ShowMore")}),this.DetailsButtonSymbol=d.computed(function(){return void 0!==d.value(s.DetailsButtonTitle)&&d.value(s.DetailsGroupVisible)?"ChevronUp":"ChevronDown"}),d.observe(this.serverUpdatePending,function(e){s.showHideOnTransition(e)})}e.Controller=o}((e=d.ax||(d.ax={})).taskRecorder||(e.taskRecorder={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){var e,a,t;function o(e,t,o,n){var i=a.call(this,e,t,o,n)||this;return i.icon=r.computed(function(){return{Items:["1","Symbol",r.util.stringToBoolean(r.value(i.HasAnnotation))?"Comment":"Edit"]}}),i.Width=r.layout.Size.available,i}Globalize.addCultureInfo("en",{messages:{TaskGuidesStep_RailsSwitchAckButton:"Go back",TaskRecorder_SwitchRailsModeOff:"Unlock",TaskRecorder_SwitchRailsModeOff_ToolTip:"Turn off task guide execution lock down",TaskRecorder_SwitchRailsModeOn:"Lock",TaskRecorder_SwitchRailsModeOn_ToolTip:"Turn on task guide execution lock down"}}),e=r.controls||(r.controls={}),a=r.ui.Control,__extends(o,a),t=o,e.TaskRecorderStepAction=t}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(s){!function(e){var i,t=(i=s.ui.Control,__extends(o,i),o);function o(e,t,o,n){return i.call(this,e,t,o,n)||this}e.WrappedTextControl=t;var r,n=(__extends(a,r=t),a);function a(e,t,o,n){return r.call(this,e,t,o,n)||this}e.WrappedTextControlCell=n,s.cellAdapter({id:"WrappedTextControl"})}(s.controls||(s.controls={}))}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(w){var e,_,t;function o(){return null!==_&&_.apply(this,arguments)||this}e=w.controls||(w.controls={}),_=w.ui.Control,__extends(o,_),o.prototype.init=function(e,t){var o,n;_.prototype.init.call(this,e,t);var i=this.element.firstChild,r=w.value(w.getModelCollection(this.DataSourceName,this.DataSource)),a=w._getTemplate("TaskRowElement"),s=w._getTemplate("TaskStepRowElement"),l=w._getTemplate("StepRowElement"),u=!1,d=1,c=1;try{for(var p=__values(r),h=p.next();!h.done;h=p.next()){var m=h.value,v=w.value(w.getFieldObservable("Step",m)),g=w.util.stringToBoolean(w.value(w.getFieldObservable("IsTask",m))),y=w.value(w.getFieldObservable("AnnotationTitle",m)),f=w.value(w.getFieldObservable("AnnotationDescription",m));if(g)if(v&&-1!==v.indexOf("End"))u=!(c=1);else{var b=$(a).clone();b&&(b.find("span").text(v),$(i).append(b),b.find("td").addClass("taskGuideContent-taskStartRowElement"),u=!0)}else{var C=void 0;""!==y&&(C=u?$(s).clone():$(l).clone())&&i&&(C.find("#StepRowNo").text((u?c++:d++)+"."),C.find("span").text(y),$(i).append(C)),""!==v&&(C=u?$(s).clone():$(l).clone())&&i&&(C.find("span").text(v),""===y&&C.find("#StepRowNo").text((u?c++:d++)+"."),$(i).append(C)),""!==f&&(C=u?$(s).clone():$(l).clone())&&i&&(C.find("span").text(f),$(i).append(C))}}}catch(e){o={error:e}}finally{try{h&&!h.done&&(n=p.return)&&n.call(p)}finally{if(o)throw o.error}}},t=o,e.TaskGuideDocumentViewer=t}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){var e,a,t;function o(e,t,o,n){var i=a.call(this,e,t,o,n)||this;return(r.ax.taskRecording.taskRecorderStateControl=i).taskRecorderController=r.ax.taskRecording.taskRecorderController,i.taskRecorderController.GuidedStep=i.GuidedStep,r.observe(i.taskRecorderController.skipBackGuidedStepTrigger,function(){r.applyFunction(i.SkipBackStep,i)}),r.observe(i.taskRecorderController.skipGuidedStepTrigger,function(){r.applyFunction(i.SkipStep,i)}),r.observe(i.RecordingState,r.ax.taskRecording._handleServerRecordingStateChanged),r.observe(function(){return r.value(r.ax.taskRecording.started)&&!r.value(i.InDiscreteMode)},function(e){e?r.async(function(){r.value(i.InDiscreteMode)||r.ax.taskRecording.addToolbar()}):r.ax.taskRecording.removeToolbar()}),r.observe(i.TaskGuidePlaybackState,function(e){e?i.taskRecorderController.initTaskGuide(!1):i.taskRecorderController.disposeTaskGuide(),r.ax.taskRecording.taskGuidePlaybackState(e),r.ax.taskRecording.taskGuideRailsMode(e)}),i.pingPending=0,r.observe(i.TaskName,function(e){var t=r.ax.taskRecording._toolbar;t?$(".taskRecorderToolbar-stepContext",t).animate({opacity:0},{complete:function(){r.ax.taskRecording.currentTask(e),$(".taskRecorderToolbar-stepContext",t).animate({opacity:1})}}):r.ax.taskRecording.currentTask(e)}),r.ax.taskRecording.isRecording(!0),r.observe(i.PlaybackState,function(e){r.ax.taskRecording._playbackState!==e&&(r.ax.taskRecording._playbackState=e,i.isPlaybackRunning()?(r.ax.taskRecording.isRecording(!1),i.continuePlayback(r.value(i.PlaybackSequence))):r.ax.taskRecording.isRecording(r.value(r.ax.taskRecording.started)))}),r.observe(i.PlaybackSequence,function(e){i.lastSequence!==e&&(i.lastSequence=e,i.continuePlayback(e))}),r.observe(i.PingSequence,function(e){i.lastPingSequence!==e&&(i.lastPingSequence=e,i.pingServer(e))}),r.observe(i.InEditMode,function(e){!0===e?(i.previousActiveForm=r.shell.getActiveForm(),i.previousActiveForm!==i.Root.element&&0===$(i.Root.element).closest(i.previousActiveForm).length&&r.shell.activateElement(i.Root.element)):!1===e&&i.previousActiveForm&&(r.shell.activateElement(i.previousActiveForm),i.previousActiveForm=null)}),r.observe(i.TaskGuidePaneId,function(e){if(!e&&r.ax.taskRecording.runningTaskGuidePane)i.releaseTaskGuideForm(r.ax.taskRecording.runningTaskGuidePane),r.ax.taskRecording.runningTaskGuidePane=void 0;else if(r.serverForm&&r.serverForm.defaultChannel&&r.serverForm.interactionHandler){var t=r.serverForm.defaultChannel(),o=r.serverForm.interactionHandler.getFormElement(e+" "+t.channel.channelId);r.ax.taskRecording.runningTaskGuidePane!==o&&(r.ax.taskRecording.runningTaskGuidePane&&i.releaseTaskGuideForm(r.ax.taskRecording.runningTaskGuidePane),(r.ax.taskRecording.runningTaskGuidePane=o)&&r.context(o).PreventAutoClose(!0))}}),i}e=r.controls||(r.controls={}),a=r.ui.Control,__extends(o,a),o.prototype.stopSession=function(){var t=this;r.observe(r.clientBusy,function(e){if(!e)return r.applyFunction(t.StopSession,t),!1})},o.prototype.isPlaybackRunning=function(){return"Running"===r.ax.taskRecording._playbackState},o.prototype.isPlaybackOn=function(){return"Off"!==r.ax.taskRecording._playbackState},o.prototype.continuePlayback=function(t){var o=this;r.async(function(){r.observe(r.clientBusy,function(e){if(!1===e)return r.value(r.clientInError)?r.applyFunction(o.PausePlayback,o):o.isPlaybackRunning()&&r.callFunction(o.ContinuePlayback,o,[t]),!1})},400,"Task recorder continue playback")},o.prototype.pingServer=function(t){var o=this;this.pingPending++,this.taskRecorderController.serverUpdatePending(0<this.pingPending),r.async(function(){r.observe(r.clientBusy,function(e){if(!1===e)return r.callFunction(o.ClientPing,o,[t],function(){o.pingPending--,o.taskRecorderController.serverUpdatePending(0<o.pingPending)}),!1})},50,"Task recorder ping server")},o.prototype.releaseTaskGuideForm=function(e){e&&(r.context(e).PreventAutoClose(!1),r.shell.getActiveAsideForm()!==e&&r.applyFunction(r.context(e).Close))},t=o,(e.TaskRecorderState=t).prototype.RecordingState="",t.prototype.PlaybackState="",t.prototype.StopRecording=void 0}($dyn=$dyn||{}),function(e){var t,o;function n(){this.canAddValidation=e.computed(function(){return e.serverForm.interactionManager&&e.serverForm.interactionManager.getRootFormId&&null!=e.serverForm.interactionManager.getRootFormId()}),this.VisiblePane=e.observable(!0)}Globalize.addCultureInfo("en",{messages:{TaskRecorder_Cancel:"Cancel",TaskRecorder_Continue:"Continue",TaskRecorder_OpenPane:"Task recorder",TaskRecorder_Start:"Start",TaskRecorder_Stop:"Stop"}}),t=e.ax||(e.ax={}),n.prototype.close=function(){e.value(e.ax.taskRecording.started)||(e.ax.taskRecording.pane=null),e.ax.taskRecording.close()},o=n,t.TaskRecorderPane=o}($dyn=$dyn||{}),function(o){var e,t;function n(e,t){this.VisiblePane=o.observable(!0)}e=o.ax||(o.ax={}),n.prototype.close=function(){o.ax.appDesigner.close()},t=n,e.AppDesignerPane=t}($dyn=$dyn||{}),function(t){var e,o;Globalize.addCultureInfo("en",{messages:{SysAppDesigner_OpenPane:"Mobile apps",SysAppDesigner_PaneTitle:"{0} Mobile"}}),e=t.ax||(t.ax={}),(o=e.appDesigner||(e.appDesigner={})).paneIsOpen=t.observable(!1),o.open=function(){if(!o.pane){o.pane={back:o.close,canGoBack:!0,name:"AppDesignerPane",role:"Dialog",templateId:"AppDesignerPane"},t.shell.createForm(o.pane);var e=t.context(o.pane.targetElement);e.DisplayTarget=t.forms.DisplayTarget.AsidePane,e.PreventAutoClose(!0)}t.shell.open({form:t.context(o.pane.targetElement)}),o.paneIsOpen(!0)},o.close=function(){o.pane&&t.shell.hideAsidePane(o.pane.targetElement),o.paneIsOpen(!1)},o.getPart=function(){var e=document.getElementById("appdesigner_part");return t.context(e)}}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(C){var t,e,w,o;Globalize.addCultureInfo("en",{messages:{TaskRecorder_ContextMenuAddInfoStep:"Add info step",TaskRecorder_ContextMenuCopiedValuePlaceholder:"{0} : {1}",TaskRecorder_ContextMenuCopy:"Copy",TaskRecorder_ContextMenuCurrentValue:"Current Value",TaskRecorder_ContextMenuPaste:"Paste",TaskRecorder_ContextMenuValidate:"Validate",TaskRecorder_ContextMenuValidateAllowEditMode:"Editable",TaskRecorder_ContextMenuValidateDisabled:"Disabled",TaskRecorder_ContextMenuValidateEnabled:"Enabled",TaskRecorder_ContextMenuValidateReadOnlyMode:"Read-only",TaskRecorder_PaneTitle:"Task recorder"}}),e=t=C.ax||(C.ax={}),w=e.taskRecording||(e.taskRecording={}),(o=w.Actions||(w.Actions={})).Pause="Pause",o.Resume="Resume",o.Start="Start",o.Stop="Stop",o.Validation="Validation",w.style="task-recorder-button",w.started=C.observable(!1),w.scopeStarted=C.observable(!1),w.paneName="SysTaskRecorderPane",w.taskRecorderController=new e.taskRecorder.Controller,w.currentTask=C.observable(),w.isRecording=C.observable(),w.taskGuidePlaybackState=C.observable(),w.taskGuideRailsMode=C.observable(!1),w.contextMenuOpen=new C.eventHost,w.disabledPreviewState=C.flags.disablePreview,w.paneIsOpen=C.observable(!1),w.open=function(){if(!w.pane){w.pane={back:w.close,canGoBack:!0,name:"TaskRecorderPane",role:"Dialog",templateId:"TaskRecorderPane"},C.shell.createForm(w.pane);var e=C.context(w.pane.targetElement);e.DisplayTarget=C.forms.DisplayTarget.AsidePane,e.PreventAutoClose(!0)}C.shell.open({form:C.context(w.pane.targetElement)}),w.paneIsOpen(!0)},w.close=function(){w.pane&&C.shell.hideAsidePane(w.pane.targetElement),w.paneIsOpen(!1)},w.getPart=function(){var e=document.getElementById("taskrecorder_steps");return C.context(e)},w.togglePaneVisibility=function(){if(C.value(C.shell.isAsidePaneOpen)){if(w.pane&&w.pane.targetElement){var e=C.context(w.pane.targetElement);e&&e.hide()}}else C.value(C.shell.isAsidePaneOpen)||w.open()},w.toggleTaskGuidePaneVisibility=function(){if(C.value(C.shell.isAsidePaneOpen)&&C.shell.getActiveAsideForm()===w.runningTaskGuidePane){var e=C.context(w.pane.targetElement);e&&e.hide()}else w.toolbarOpenPane()},w.toggleTaskPaneVisibility=function(){if(C.value(C.shell.isAsidePaneOpen)&&w.pane.name===C.context(C.shell.getActiveAsideForm()).FormName){var e=C.context(w.pane.targetElement);e&&e.hide()}else w.toolbarOpenPane()},w.addToolbar=function(){if(!w._toolbar&&!C.shell.isTaskRecorderToolbarOpen()){var e=w._toolbar=$(C._getTemplate("TaskRecorderToolbar")).clone();if(0<e.length){C.dataBind(e[0],new C.DataContext(w)),e.insertBefore($("#mainContainer"));var t=400;C.flags.disableAnimations&&(t=0);var o=e.height();e.height(0),e.animate({height:o}),$("#mainContainer").animate({top:o},t,function(){C.layout.reflowRootForm()}),C.shell.isTaskRecorderToolbarOpen(!0),w._zoomModeHeightObserver=C.observe(C.shell.zoomModeHeight,function(e){e?($("#mainContainer").css({top:C.ui.theme.getUnitValue("taskRecorderToolbarZoomHeight")}),$("#TaskRecorderToolbar").height(C.ui.theme.getUnitValue("taskRecorderToolbarZoomHeight"))):($("#mainContainer").css({top:C.ui.theme.getUnitValue("taskRecorderToolbarHeight")}),$("#TaskRecorderToolbar").height(C.ui.theme.getUnitValue("taskRecorderToolbarHeight")))})}}},w.removeToolbar=function(){if(w._toolbar){var e=w._toolbar;w._toolbar=null,$("#mainContainer").animate({top:0}),e.animate({height:0},{complete:function(){e.remove(),C.unbind(e[0]),C.shell.isTaskRecorderToolbarOpen(!1)}}),w._zoomModeHeightObserver&&(w._zoomModeHeightObserver.dispose(),w._zoomModeHeightObserver=void 0)}},w.toolbarOpenPane=function(){w.runningTaskGuidePane?C.shell.open({form:C.context(w.runningTaskGuidePane)}):w.open()},w.stopSession=function(){w.started(!1),C.value(C.shell.isAsidePaneOpen)||w.toolbarOpenPane(),w&&w.taskRecorderStateControl&&w.taskRecorderStateControl.stopSession()},w.animatetaskGuideQTip=function(){w&&w.taskRecorderController&&w.taskRecorderController.onRailsBlocksClicked()},w.SwitchRailsModeOn=function(){w.taskGuideRailsMode(!0),C.callFunction(w.taskRecorderStateControl.LogRailsModeStateChangedTelemetryEvent,w,[!0])},w.SwitchRailsModeOff=function(){w.taskGuideRailsMode(!1),C.callFunction(w.taskRecorderStateControl.LogRailsModeStateChangedTelemetryEvent,w,[!1])},w.setTaskRecorderFocus=function(){var e=document.querySelector('[data-dyn-form-name="TaskRecorderPane"]');if(e){var t=C.util.findFirstFocusableControl(e),o=C.context(t);o&&o.Root&&o.Root.setControlFocus&&(C.log.focus&&C.log.focus("Focus: Shell->Shortcuts(Task recorder) set focus to the task recorder form"),o.Root.setControlFocus(o.Name))}},w.setTaskGuideFocus=function(){var e=document.querySelector('[data-dyn-form-name="SysTaskGuidePane"]');if(e){var t=C.util.findFirstFocusableControl(e),o=C.context(t);o&&o.Root&&o.Root.setControlFocus&&(C.log.focus&&C.log.focus("Focus: Shell->Shortcuts(Task recorder) set focus to the task guide pane form"),o.Root.setControlFocus(o.Name))}},w._handleServerRecordingStateChanged=function(e){if(w._recordingState!==e){var t="NotRecording"!==(w._recordingState=e);if(w.started(t),w.isRecording(t),!0!=t)C.contextMenu.setProvider(null);else{var b=[];C.contextMenu.setProvider({canShow:function(){return!0},prepareShow:function(e,o){var t,n,i,r,a;if(o){if(C.value(w.taskGuidePlaybackState)||o.Root&&!C.peek(o.Root.Recordable))return;var s=o.recordability&&o.recordability(),l={contextMenuOptions:[],Enabled:null!=s,Label:C.label("TaskRecorder_PaneTitle")};if(s){if(s.copy){var u={Command:function(){C.callFunction(s.copy,o,function(e){var t={ControlName:o.Name,ControlValue:e.Value,Id:e.Id,Label:e.Label};b.push(t)})},Enabled:!0,Label:C.label("TaskRecorder_ContextMenuCopy")};l.contextMenuOptions.push(u)}if(s.paste){var d={contextMenuOptions:[],Enabled:null!=s,Label:C.label("TaskRecorder_ContextMenuPaste")};d.contextMenuOptions=[];var c=function(e){d.contextMenuOptions.push({Command:function(){C.callFunction(s.paste,o,e.Id,e.ControlValue)},Label:C.format(C.label("TaskRecorder_ContextMenuCopiedValuePlaceholder"),e.ControlName,e.Label)})};try{for(var p=__values(b),h=p.next();!h.done;h=p.next()){c(h.value)}}catch(e){t={error:e}}finally{try{h&&!h.done&&(n=p.return)&&n.call(p)}finally{if(t)throw t.error}}l.contextMenuOptions.push(d)}if((a=s).validate||a.validateEnabled||a.validateDisabled||a.validateAllowEditMode||a.validateReadOnlyMode){var m={contextMenuOptions:[],Enabled:null!=s,Label:C.label("TaskRecorder_ContextMenuValidate")};s.validate&&m.contextMenuOptions.push({Command:function(){C.callFunction(s.validate,o,null)},Label:C.label("TaskRecorder_ContextMenuCurrentValue")}),s.validateEnabled?m.contextMenuOptions.push({Command:function(){C.callFunction(s.validateEnabled,o)},Label:C.label("TaskRecorder_ContextMenuValidateEnabled")}):s.validateDisabled&&m.contextMenuOptions.push({Command:function(){C.callFunction(s.validateDisabled,o)},Label:C.label("TaskRecorder_ContextMenuValidateDisabled")}),s.validateAllowEditMode?m.contextMenuOptions.push({Command:function(){C.callFunction(s.validateAllowEditMode,o)},Label:C.label("TaskRecorder_ContextMenuValidateAllowEditMode")}):s.validateReadOnlyMode&&m.contextMenuOptions.push({Command:function(){C.callFunction(s.validateReadOnlyMode,o)},Label:C.label("TaskRecorder_ContextMenuValidateReadOnlyMode")});var v=function(e){m.contextMenuOptions.push({Command:function(){C.callFunction(s.validate,o,e.Id)},Label:C.format(C.label("TaskRecorder_ContextMenuCopiedValuePlaceholder"),e.ControlName,e.Label)})};try{for(var g=__values(b),y=g.next();!y.done;y=g.next()){v(y.value)}}catch(e){i={error:e}}finally{try{y&&!y.done&&(r=g.return)&&r.call(g)}finally{if(i)throw i.error}}l.contextMenuOptions.push(m)}}if(o.AddInfoStep){var f={Command:function(){C.callFunction(o.AddInfoStep,o,void 0,function(){w.open()})},Enabled:!0,Label:C.label("TaskRecorder_ContextMenuAddInfoStep")};l.contextMenuOptions.push(f)}w.contextMenuOpen.raise({RecordOption:l,ContextControl:o}),e.push(l)}}})}}},C.observe(t.taskRecording.started,function(e){e?(t.taskRecording.disabledPreviewState=C.flags.disablePreview,C.flags.disablePreview=!0):C.flags.disablePreview=t.taskRecording.disabledPreviewState})}($dyn=$dyn||{}),function(p){var e,t;Globalize.addCultureInfo("en",{messages:{TaskGuide_GettingStartedIntroHeader:"Getting Started!",TaskGuide_GettingStartedIntroStep:"We're ready to start, are you?",TaskGuide_GettingStartedIntroStepInfoButton:"Let's get started!",TaskGuide_GettingStartedIntroTitle:'This is the "Getting started" pane where you can quickly launch various business processes that we have pre-configured for you.',TaskGuide_GettingStartedWelcomeHeader:"Welcome to Dynamics 365 {0}. Try it out!",TaskGuide_GettingStartedWelcomeStep:"See how easy it is to manage your business processes with Dynamics 365 {0} using sample data.",TaskGuide_GettingStartedWelcomeStepInfoButton:"Dive in !",TaskGuide_GettingStartedWelcomeTitle:"Work smarter than ever before with intelligent tools for the modern workplace. Bringing together the best from Microsoft, Microsoft Dynamics 365 {0} enables you to make smarter decisions, redesign business processes faster and fuel business growth.",TaskGuide_ShortcutDescriptionCollapse:"Collapse the Task guide dialog box",TaskGuide_ShortcutDescriptionExpand:"Expand the Task guide dialog box",TaskGuide_ShortcutDescriptionGoToNextStep:"Go to the next step in the Task guide",TaskGuide_ShortcutDescriptionGoToPreviousStep:"Go to the previous step in the Task guide",TaskGuide_ShortcutDescriptionLock:"Lock the user interface for this Task guide",TaskGuide_ShortcutDescriptionShowLess:"Show less information in the Task guide dialog box",TaskGuide_ShortcutDescriptionShowMore:"Show more information in the Task guide dialog box",TaskGuide_ShortcutDescriptionStopPlayback:"Stop the Task guide",TaskGuide_ShortcutDescriptionToggleFocus:"Switch focus between the Task guide dialog box and the page",TaskGuide_ShortcutDescriptionUnlock:"Unlock the user interface for this Task guide",TaskGuides_VerbalPosition_Down:"Scroll down.",TaskGuides_VerbalPosition_Left:"Scroll left.",TaskGuides_VerbalPosition_Right:"Scroll right.",TaskGuides_VerbalPosition_Up:"Scroll up.",TaskRecorder_ShortcutDescriptionShowSteps:"Show the Task guide steps",TaskRecorder_ShortcutDescriptionStopRecording:"Stop the Task recorder",TaskRecorder_TestMethodNoForm:"Please, navigate to a page and start recording before adding test method"}}),e=p.ax||(p.ax={}),(t=e.taskGuidesUtil||(e.taskGuidesUtil={})).qtipPositionToVerbal=function(e){var t=e.split(" "),o="";if(2===t.length){var n=t[1];switch(t[0]){case p.util.VerticalElementVisibility.INVISIBLE_TOP:o=p.label("TaskGuides_VerbalPosition_Up");break;case p.util.VerticalElementVisibility.INVISIBLE_BOTTOM:o=p.label("TaskGuides_VerbalPosition_Down")}switch(n){case p.util.HorizontalElementVisibility.INVISIBLE_LEFT:o=p.label("TaskGuides_VerbalPosition_Left");break;case p.util.HorizontalElementVisibility.INVISIBLE_RIGHT:o=p.label("TaskGuides_VerbalPosition_Right")}}return o},t.elementsHaveCommonSpace=function(e,t){var o=p.util.elementHorizontalVisibilityInParentContainer(e,t),n=p.util.elementVerticalVisibilityInParentContainer(e,t);return!(o!==p.util.HorizontalElementVisibility.PARTIAL&&o!==p.util.HorizontalElementVisibility.VISIBLE||n!==p.util.VerticalElementVisibility.PARTIAL&&n!==p.util.VerticalElementVisibility.VISIBLE)},t.visibleAreaInContainerElement=function(e,t){if(!e||!t)return null;if(!p.ax.taskGuidesUtil.elementsHaveCommonSpace(e,t))return null;var o=jQuery.extend(!0,{},e);return e.left<t.left&&(o.left=t.left),e.right>t.right&&(o.right=t.right),e.top<t.top&&(o.top=t.top),e.bottom>t.bottom&&(o.bottom=t.bottom),o},t.visibilityDataForNestedElements=function(e){if(e.length<=0)return null;var t=[],o=e[e.length-1],n=p.util.elementRectangle(o),i=new p.ax.taskGuidesUtil.VisibilityData({$element:o,elementRect:n,horizontalVisibility:p.util.HorizontalElementVisibility.VISIBLE,verticalVisibility:p.util.VerticalElementVisibility.VISIBLE,visibleArea:n});t.unshift(i);for(var r=e.length-2;0<=r;--r){var a=e[r],s=p.util.elementRectangle(a),l=p.util.elementHorizontalVisibilityInParentContainer(s,i.visibleArea),u=p.util.elementVerticalVisibilityInParentContainer(s,i.visibleArea),d=new p.ax.taskGuidesUtil.VisibilityData({$element:a,elementRect:s,horizontalVisibility:l,verticalVisibility:u}),c=null;d.isPartiallyVisible()&&(c=p.ax.taskGuidesUtil.visibleAreaInContainerElement(s,i.visibleArea)),d.visibleArea=c,o=a,i=d,t.unshift(d)}return t};var o={TaskGuideNextStepButton:{ChordKeys:{alt:!0,keyCode:p.ui.KeyCodes.letterR},Description:p.label("TaskGuide_ShortcutDescriptionGoToNextStep"),Handler:function(){p.value(p.ax.taskRecording.taskGuidePlaybackState)&&p.value(p.ax.taskRecording.taskRecorderController.NextButtonVisible)&&p.ax.taskRecording.taskRecorderController.SkipGuidedStep()},Keys:{keyCode:p.ui.KeyCodes.letterN},ShowToUser:function(){return p.value(p.ax.taskRecording.taskGuidePlaybackState)}},TaskGuidePreviousStepButton:{ChordKeys:{alt:!0,keyCode:p.ui.KeyCodes.letterR},Description:p.label("TaskGuide_ShortcutDescriptionGoToPreviousStep"),Handler:function(){p.value(p.ax.taskRecording.taskGuidePlaybackState)&&p.value(p.ax.taskRecording.taskRecorderController.BackButtonVisible)&&p.ax.taskRecording.taskRecorderController.SkipBackGuidedStep()},Keys:{keyCode:p.ui.KeyCodes.letterP},ShowToUser:function(){return p.value(p.ax.taskRecording.taskGuidePlaybackState)}},TaskRecorderOpenPane:{ChordKeys:{alt:!0,keyCode:p.ui.KeyCodes.letterR},Description:p.label("TaskRecorder_ShortcutDescriptionShowSteps"),Handler:function(){p.value(p.ax.taskRecording.taskGuidePlaybackState)?p.ax.taskRecording.toggleTaskGuidePaneVisibility():p.value(p.ax.taskRecording.isRecording)&&p.ax.taskRecording.toggleTaskPaneVisibility()},Keys:{keyCode:p.ui.KeyCodes.letterT},ShowToUser:function(){return p.value(p.ax.taskRecording.isRecording)}},TaskRecorderStop:{ChordKeys:{alt:!0,keyCode:p.ui.KeyCodes.letterR},Description:function(){return p.value(p.ax.taskRecording.taskGuidePlaybackState)?p.label("TaskGuide_ShortcutDescriptionStopPlayback"):p.label("TaskRecorder_ShortcutDescriptionStopRecording")},Handler:function(){p.value(p.ax.taskRecording.isRecording)&&p.ax.taskRecording.stopSession()},Keys:{keyCode:p.ui.KeyCodes.letterS},ShowToUser:function(){return p.value(p.ax.taskRecording.taskGuidePlaybackState)||p.value(p.ax.taskRecording.isRecording)}},TaskRecorderToggleRailsMode:{ChordKeys:{alt:!0,keyCode:p.ui.KeyCodes.letterR},Description:function(){return p.value(p.ax.taskRecording.taskGuideRailsMode)?p.label("TaskGuide_ShortcutDescriptionUnlock"):p.label("TaskGuide_ShortcutDescriptionLock")},Handler:function(){p.value(p.ax.taskRecording.taskGuidePlaybackState)&&(p.value(p.ax.taskRecording.taskGuideRailsMode)?p.ax.taskRecording.SwitchRailsModeOff():p.ax.taskRecording.SwitchRailsModeOn())},Keys:{keyCode:p.ui.KeyCodes.letterL},ShowToUser:function(){return p.value(p.ax.taskRecording.taskGuidePlaybackState)}},ToggleTaskGuideExpandCollapse:{ChordKeys:{alt:!0,keyCode:p.ui.KeyCodes.letterR},Description:function(){return p.value(p.ax.taskRecording.taskRecorderController.GuidedStepVisible)?p.label("TaskGuide_ShortcutDescriptionCollapse"):p.label("TaskGuide_ShortcutDescriptionExpand")},Handler:function(){p.value(p.ax.taskRecording.taskGuidePlaybackState)&&p.ax.taskRecording.taskRecorderController.ToggleGuidedStep()},Keys:{keyCode:p.ui.KeyCodes.letterC},ShowToUser:function(){return p.value(p.ax.taskRecording.taskGuidePlaybackState)}},ToggleTaskGuideFocus:{ChordKeys:{alt:!0,keyCode:p.ui.KeyCodes.letterR},Description:p.label("TaskGuide_ShortcutDescriptionToggleFocus"),Handler:function(){var e=document.querySelector(".taskGuideStep");if(e)if(e.contains(document.activeElement)){var t=p.context(p.shell.getActiveForm());t&&(p.log.focus&&p.log.focus("Focus: Shell->Shortcuts(ToggleTaskGuideFocus) return focus to form Id: %s calling takeNavigationFocus",t.Id),t.takeNavigationFocus())}else{p.log.focus&&p.log.focus("Focus: Shell->Shortcuts(ToggleTaskGuideFocus) focus task guide qtip");var o=p.util.findFirstFocusableControl(e);o&&o.focus()}},Keys:{keyCode:p.ui.KeyCodes.letterF},ShowToUser:function(){return p.value(p.ax.taskRecording.taskGuidePlaybackState)}},ToggleTaskGuideShowMore:{ChordKeys:{alt:!0,keyCode:p.ui.KeyCodes.letterR},Description:function(){return p.value(p.ax.taskRecording.taskRecorderController.DetailsGroupVisibilityToggled)?p.label("TaskGuide_ShortcutDescriptionShowLess"):p.label("TaskGuide_ShortcutDescriptionShowMore")},Handler:function(){p.value(p.ax.taskRecording.taskGuidePlaybackState)&&p.ax.taskRecording.taskRecorderController.ToggleDetails()},Keys:{keyCode:p.ui.KeyCodes.letterM},ShowToUser:function(){return p.value(p.ax.taskRecording.taskGuidePlaybackState)}}};p.shell.Shortcuts=p.extendPrototype(p.shell.Shortcuts,o)}($dyn=$dyn||{}),function(e){var t,o,n;function i(e){this.horizontalVisibility=e.horizontalVisibility,this.verticalVisibility=e.verticalVisibility,this.visibleArea=e.visibleArea,this.elementRect=e.elementRect,this.$element=e.$element}t=e.ax||(e.ax={}),o=t.taskGuidesUtil||(t.taskGuidesUtil={}),i.prototype.isVisible=function(){return this.horizontalVisibility===e.util.HorizontalElementVisibility.VISIBLE&&this.verticalVisibility===e.util.VerticalElementVisibility.VISIBLE},i.prototype.isPartiallyVisible=function(){return!(this.horizontalVisibility!==e.util.HorizontalElementVisibility.PARTIAL&&this.horizontalVisibility!==e.util.HorizontalElementVisibility.VISIBLE||this.verticalVisibility!==e.util.VerticalElementVisibility.PARTIAL&&this.verticalVisibility!==e.util.VerticalElementVisibility.VISIBLE)},i.prototype.isInvisible=function(){return!this.isVisible()&&!this.isPartiallyVisible()},i.prototype.isGloballyVisible=function(){return this.visibleArea&&this.isVisible()},i.prototype.isGloballyPartiallyVisible=function(){return this.visibleArea&&this.isPartiallyVisible()},i.prototype.horizontalVisibilityLabel=function(){return this.horizontalVisibility===e.util.HorizontalElementVisibility.PARTIAL?e.util.HorizontalElementVisibility.VISIBLE:this.horizontalVisibility},i.prototype.verticalVisibilityLabel=function(){return this.verticalVisibility===e.util.VerticalElementVisibility.PARTIAL?e.util.VerticalElementVisibility.VISIBLE:this.verticalVisibility},n=i,o.VisibilityData=n}($dyn=$dyn||{}),function(l){var e,t;function o(){var t=this;this.shortcutQTipEscapeHandler=function(e){e.keyCode===l.ui.KeyCodes.esc&&(e.stopPropagation(),l.log.stopPropagation&&l.log.stopPropagation("Escape handler for personalization qtip"),e.preventDefault(),t.closeQtip())},this._formClosing=!1,this.control=null,this.qtip=null}e=l.ax||(l.ax={}),o.prototype.destroyQTip=function(){this.qtip&&(this.restoreActiveForm(),this.clearIndicator(),this.control=null,this.clearQtipRepositionInterval(),this.qtip.destroy(!0),this.qtip=null,l.ax.formPersonalizationPane.qTipDestroyed.raise())},o.prototype.getPersonalizationOptions=function(e,t){var o;if(e&&"SystemDefinedShowFiltersButton"!==e&&"SystemDefinedShowListButton"!==e&&"SystemDefinedManageViewFilters"!==e){var n=l.ax.personalizationUtil.isControlPersonalizable(t);if(l.value(t.Root.AllowExplicitPersonalization)&&n){var i=l.value(t.Label);!(i=i||l.value(t.Caption))&&t instanceof l.controls.Part&&t.PartForm&&t.PartForm.Caption&&(i=l.value(t.PartForm.Caption)),o={Command:function(){l.ax.formPersonalizationPane.formPersonalizationController.openPersonalizationUI(t)},Label:i=l.format(l.label("ContextMenu_PersonalizationControl"),i||e)}}}return o},o.prototype.openPersonalizationUI=function(e){this.handledForAppHostControl(e)||this.openQuickPersonalizationForm(e)},o.prototype.restoreActiveForm=function(){this._previouslyActiveForm&&(l.shell.activateElement(this._previouslyActiveForm),this._previouslyActiveForm=null)},o.prototype.clearIndicator=function(){this.control&&$(l.ui.selector().css(l.ui.personalizationClasses.personalizedElement).toString()).removeClass(l.ui.personalizationClasses.personalizedElement)},o.prototype.clearQtipRepositionInterval=function(){this.qtipRepositionInterval&&(window.clearInterval(this.qtipRepositionInterval),this.qtipRepositionInterval=null)},o.prototype.handledForAppHostControl=function(e){if("object"==typeof e){if(l.controls.WebsiteHostControl&&e instanceof l.controls.WebsiteHostControl)return l.ax.formPersonalizationPane.formPersonalizationToolbar.SelectForEditWebsiteHostControl(e),l.ax.formPersonalizationPane.formPersonalizationToolbar.shouldTarget=!0;if(l.controls.PowerAppsHost&&e instanceof l.controls.PowerAppsHost||"SysPAMenuButton"===e.Name)return l.ax.formPersonalizationPane.formPersonalizationToolbar.SelectForEditPAControl(e),l.ax.formPersonalizationPane.formPersonalizationToolbar.shouldTarget=!0}return!1},o.prototype.openQuickPersonalizationForm=function(r){var a=this;r&&(this.clientIsNotBusy&&this.clientIsNotBusy.reject(),this.clientBusySubscription&&(this.clientBusySubscription.dispose&&this.clientBusySubscription.dispose(),this.clientBusySubscription=void 0),this.clientIsNotBusy=$.Deferred(),this.clientBusySubscription=l.observe(function(){return!l.value(l.clientBusy)},function(e){if(e)return a.clientIsNotBusy&&a.clientIsNotBusy.resolve(),!1}),$.when(this.clientIsNotBusy).done(function(){var e=r.element;r.getPersonalizationElements&&(e=r.getPersonalizationElements()[0]);var t={adjustMethod:"flip",at:"right center",my:"left center"},o=$(window).width(),n=$(e).offset().left,i=$(e).width();n<300&&o-(n+i)<300&&(t.my="top center",t.at="bottom center"),a.destroyQTip(),a.control=r,a._contentPlaceholder=document.createElement("form"),a._contentPlaceholder.setAttribute("data-dyn-template","templateId: 'Popup'"),a.qtip=$(e).qtip({content:{text:$(a._contentPlaceholder)},events:{hide:function(){a._formClosing||a.closeQtip(!0)},render:function(){var e,t;null!==(t=null===(e=a.qtip.elements)||void 0===e?void 0:e.tooltip)&&void 0!==t&&t.attr("role","alertdialog"),document.addEventListener("keydown",a.shortcutQTipEscapeHandler,!0)}},hide:"unfocus",position:{adjust:{method:t.adjustMethod},at:t.at,my:t.my,target:$(e),viewport:$(window)},show:!1,style:{classes:"formPersonalization-popup qtip-light baseDirection",tip:{height:8,width:16}}}).qtip("api"),a.clearQtipRepositionInterval(),a.qtipRepositionInterval=window.setInterval(function(){var e;r&&l.value(r.Visible)&&this.qtip&&(null!==(e=r.Root)&&void 0!==e&&e.UseReactGrid()&&r.isInGrid()||this.qtip.reposition(null,!0))},500),l.async(function(){return a.loadPersonalizationForm()},void 0,"Load Personalization Form"),a.clientIsNotBusy=null}))},o.prototype.loadPersonalizationForm=function(){var a=this,e={canGoBack:!1,name:"FormControlPersonalizationPane",role:"Popup",ShouldBlockOnExecution:!1,targetElement:this._contentPlaceholder},s=l.shell.createForm(e);s.removeAttribute("role"),this._clientFormId=s.getAttribute("data-dyn-formid"),this._personalizationForm=l.context(s),this._personalizationForm.Open=function(){var e,t,o,n,i,r;a.control?(null===(e=a.control.Root)||void 0===e||!e.UseReactGrid()||null===(o=(t=a.control).isInGrid)||void 0===o||!o.call(t)||null!==(i=(n=a.control).isInTable)&&void 0!==i&&i.call(n)||null!==(r=a.control.listControl)&&void 0!==r&&r.scrollActiveRowIntoView(),a._personalizationForm.IsOpen(!0),window.setTimeout(function(){a.qtip?a.control&&(a._previouslyActiveForm=l.shell.getActiveForm(),l.shell.activateElement(s),a.control.element.classList.add(l.ui.personalizationClasses.personalizedElement),l.ax.personalizationUtil.addClassToBreakableGroups(a.control.element,l.ui.personalizationClasses.personalizedElement),a.qtip.show()):l.logError("qtip should not have been destroyed before showing")})):a._personalizationForm.Close()},this._personalizationForm.closeCallback=function(){a._formClosing=!0,a.destroyQTip(),a._formClosing=!1},l.serverForm&&l.serverForm.registerForm({targetElement:s}),l.callFunction(this.control.ExecutePersonalizationCommand,this.control,["LaunchPersonalizationPane",this._clientFormId])},o.prototype.closeQtip=function(e){var t=this;void 0===e&&(e=!1),document.removeEventListener("keydown",this.shortcutQTipEscapeHandler,!0),this._personalizationForm&&(l.callFunction(this._personalizationForm.RequestClose,this._personalizationForm),this._personalizationForm=null),this.restoreActiveForm(),e?window.setTimeout(function(){t.destroyQTip()},100):this.destroyQTip()},t=o,e.formPersonalizationController=t}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(p){var e,t;function o(){var d=this;this.UserCloseToolbar=function(){d.closeToolbarCleanup(),d.SendToolbarAction(p.ui.personalizationToolbarEvents.ActionUserClose)},this.ChangeMode=function(e,t){void 0===t&&(t=!1),d.SavePendingPersonalization(),d.SendToolbarAction(e),d.Mode(e,t)},this.OnFocus=function(e){var t=e.target||e.srcElement;d._showExpandoQtip(e,t)||d.updateAccessibilityDescriptionForTarget(t)},this._handleDrag=function(e){e.preventDefault&&e.preventDefault();var t=d.selectedForMove;if(t){var o=d.getElementOrHeader(t.Name,t.element);if(!d.isDragging){if($(o).addClass(p.ui.personalizationClasses.draggable),$(o).addClass(p.ui.personalizationClasses.dragging),$(o).addClass(p.ui.personalizationClasses.dragClone),d.isDragging=!0,d.controlLayoutHorizontal(t))d.positionX=o.offsetLeft,d.positionY=o.offsetTop;else{var n=o.getBoundingClientRect();d.positionX=n&&n.left?n.left:0,d.positionY=n&&n.left?n.top:0,d.origZIndex=o.style.zIndex}d.origStyleX=o.style.left,d.origStyleY=o.style.top,d.origPosition=o.style.position}if(!e.isFinal){var i=e.deltaX+d.positionX,r=e.deltaY+d.positionY;o.style.left=i+"px",o.style.top=r+"px",d.controlLayoutHorizontal(t)?o.style.position="absolute":(o.style.zIndex=d._moveTargetZIndex,o.style.position="fixed")}}if(e.isFinal){if(t){o=d.getElementOrHeader(t.Name,t.element);$(o).removeClass(p.ui.personalizationClasses.dragging),$(o).removeClass(p.ui.personalizationClasses.draggable),$(o).removeClass(p.ui.personalizationClasses.dragClone),o.style.left=d.origStyleX,o.style.top=d.origStyleY,d.controlLayoutHorizontal(t)||(o.style.zIndex=d.origZIndex),o.style.position=d.origPosition}d.isDragging=!1,d.draggableObject&&d.draggableObject.off("pan",d._handleDrag),d.moveStop()}},this.Clear=function(){var e=d.currentVisibleForms[0];p.callFunction(e.ExecutePersonalizationCommand,e,["ClearPersonalizations"])},this.Import=function(){var e=d.currentVisibleForms[0];d.SystemCloseToolbar(),p.callFunction(e.ExecutePersonalizationCommand,e,["ImportPersonalizations"])},this.Export=function(){var e=d.currentVisibleForms[0];p.callFunction(e.ExecutePersonalizationCommand,e,["ExportPersonalizations"])},this.AddAPage=function(){var e=d.currentVisibleForms[0];p.callFunction(e.ExecutePersonalizationCommand,e,["AddAPage"])},this.updateCurrentHelpText=function(e){if("mouseleave"===e.type)d.CurrentHelpText(d.CurrentSelectedHelpText());else{var t=p.context(e.target);t&&t.HelpText&&d.CurrentHelpText()!==p.value(t.HelpText)&&(""===d.CurrentSelectedHelpText()&&d.CurrentSelectedHelpText(d.CurrentHelpText()),d.CurrentHelpText(p.value(t.HelpText)))}},this.OnClick=function(e){var t=e.target||e.srcElement;p.util.isFlightEnabled(p.reactGrid.featureName)&&(d.isReactGridScrollbar(t)||d.isReactGridReorderHandle(t))||(d.targetIsInteractable(t)||d.targetIsClickable(t)?d.targetIsClickable(t)&&d.currentTargetControl&&d._focusExpandoTargetElement(d.currentTargetControl):(d.ShowMoreMenu(!1),e.stopPropagation(),p.log.stopPropagation&&p.log.stopPropagation("Stop Click event during Personalization"),e.preventDefault(),d.potentialTarget&&(d.EventHandler.onClick(d,d.potentialTarget),d._canUpdateFormPersonalizaData(d.Mode())&&d.updateFormPersonalizationData())))},this.onNavigation=function(){var e=p.context(p.shell.getActiveForm());e&&d._checkIfFormIsNonPersonalizable(p.value(e.FormName))||d.SystemCloseToolbar()},this.OnMouseMove=function(e){var t,a=e.target||e.srcElement,o=d.Mode?d.Mode():void 0;if(o&&o===p.ax.personalizationMode.hide&&$(a).hasClass(p.ui.personalizationClasses.mandatory))d.mandatoryQtip||($(a).qtip({content:{text:p.label("FormPersonalization_MandatoryControlHidden")},hide:"unfocus",show:!1,style:{classes:"personalizationTemporarilyVisibleQtip qtip-content baseDirection"}}).qtip("api"),d.mandatoryQtip=$(a).qtip("api"),d.mandatoryQtip.show());else if(d.mandatoryQtip&&(d.mandatoryQtip.destroy(),d.mandatoryQtip=null),d._showExpandoQtip(e,a)){if(d.targetIsInteractable(a))return void d.resetPotentialTarget();if(d.targetIsClickable(a)&&d.resetPotentialTarget(),e.stopPropagation(),p.log.stopPropagation&&p.log.stopPropagation("Stop MouseMove event during Personalization"),d.dragTarget&&d.isDragging){var n=e.changedTouches,i=n&&n.length&&0<n[0].clientX?n[0].clientX:e.clientX,r=n&&n.length&&0<n[0].clientY?n[0].clientY:e.clientY;!function(e){var t,o;try{for(var n=__values(e),i=n.next();!i.done;i=n.next()){var r=i.value;if(d.selectedForMove)if(!d.getElementOrHeader(d.selectedForMove.Name,d.selectedForMove.element).contains(r)){a=r;break}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(o=n.return)&&o.call(n)}finally{if(t)throw t.error}}}(p.util.elementsFromPoint(i,r));var s=p.context(a);if(!s){var l=$(a).addBack().closest("[data-dyn-controlname]")[0];if(!(s=p.ui.getLiveControl(l)))return void d.clearApprovedPositionIndicator()}s&&(d.moveTarget=s,d.moveStart(e))}if(d.shouldTarget){var u=d.getPersonalizableControl(a);if(u){if(null!==(t=u.Root)&&void 0!==t&&t.UseReactGrid()){if(!u.isInGrid()&&d.potentialTarget===u)return}else if(d.potentialTarget===u)return;return d.resetPotentialTarget(),d.potentialTarget=u,d.getElementOrHeader(d.potentialTarget.Name,d.potentialTarget.element,!0).classList.add(p.ui.personalizationClasses.potentialTarget),void p.ax.personalizationUtil.addClassToBreakableGroups(d.potentialTarget.element,p.ui.personalizationClasses.potentialTarget)}d.resetPotentialTarget()}}},this.OnKeyDown=function(e){var t=e.target||e.srcElement;d._isNonPersonalizableForm(p.ui.getLiveControl(t))||(d.targetIsClickable(t)?p.util.isShortcutKeyPressed(e,d.Shortcuts.ExpandoQtipLeftArrow.Keys)&&d.secondaryOptionQtip&&d.secondaryOptionQtip.tooltip&&d.secondaryOptionQtip.tooltip.find&&p.util.handleShortcuts(d,e):d._handleKeyDown(t,e)||(e.stopPropagation(),p.log.stopPropagation&&p.log.stopPropagation("Stop KeyDown event during Personalization"),e.preventDefault()))},this.BlockEventHandler=function(e){var t=e.target||e.srcElement;p.ax.formPersonalizationToolbar.prototype.targetIsInteractable(t)||p.ax.formPersonalizationToolbar.prototype.targetIsClickable(t)||(e.stopPropagation(),p.log.stopPropagation&&p.log.stopPropagation("Default block event during Personalization"))},this.currentPersonalizableControls={},this.Mode=p.observable(""),this.shouldTarget=!0,this._multiplePersonalizations={},this.AddAPageModeEnabled=p.observable(!1),this.AddAppModeEnabled=p.observable(!1),this.AddPowerAppModeEnabled=p.observable(!1),this.CurrentHelpText=p.observable(""),this.currentNonPersonalizableControls={},this.currentPersonalizations={},this.currentPersonalizationsControlPropertyMap={},this.CurrentSelectedHelpText=p.observable(""),this.currentVisibleForms=[],this.EventHandler=p.ax.personalizationModeEventHandlers.select,this.ExportButtonEnabled=p.observable(!1),this.htmlLoaded=$.Deferred(),this.htmlLoading=!1,this.isDragging=!1,this.isInitialized=!1,this.lastPosX=0,this.lastPosY=0,this.positionX=0,this.positionY=0,this.PreviewOn=p.observable(!1),this.setDragTarget=!1,this.shouldSubTarget=!1,this.ShowMoreMenu=p.observable(!1),this.waitForAsyncDataRetrieval=p.observable(!1),this._moveTargetZIndex="1000",this.nonPersonalizationForms={FormControlFieldSelector:!0,FormRunConfigurationAddApp:!0,FormRunConfigurationAddPAControl:!0,FormRunConfigurationEditPAControl:!0,FormRunConfigurationWebsite:!0,SysCustomFieldAddFieldDialog:!0},this.PropagatedShortcuts={FactBoxPane:p.controls.Form.prototype.Shortcuts.FactBoxPane,GoToActionPane:p.controls.Form.prototype.Shortcuts.GoToActionPane,GoToFilterPane:p.controls.Form.prototype.Shortcuts.GoToFilterPane,GoToNavigationList:p.controls.Form.prototype.Shortcuts.GoToNavigationList,Personalize:p.controls.Form.prototype.Shortcuts.Personalize},p.observe(this.PreviewOn,function(e){d.showHiddenFields(!e)}),p.observe(this.Mode,function(e){return d.modeChanged(e)}),this.SelectButtonToggled=p.computed(function(){return d.Mode()===p.ax.personalizationMode.select}),this.MoveButtonToggled=p.computed(function(){return d.Mode()===p.ax.personalizationMode.move}),this.HideButtonToggled=p.computed(function(){return d.Mode()===p.ax.personalizationMode.hide}),this.MandatoryButtonToggled=p.computed(function(){return d.Mode()===p.ax.personalizationMode.mandatory}),this.TabSummaryButtonToggled=p.computed(function(){return d.Mode()===p.ax.personalizationMode.addToSummary}),this.SkipButtonToggled=p.computed(function(){return d.Mode()===p.ax.personalizationMode.skip}),this.LockButtonToggled=p.computed(function(){return d.Mode()===p.ax.personalizationMode.lock}),this.AddButtonToggled=p.computed(function(){return d.Mode()===p.ax.personalizationMode.addAField}),this.AppAppToggled=p.computed(function(){return d.Mode()===p.ax.personalizationMode.addApp}),this.AddPAToggled=p.computed(function(){return d.Mode()===p.ax.personalizationMode.addPAControl}),this.moreMenu=[{Click:function(){d.ChangeMode(p.ax.personalizationMode.addApp)},HelpText:p.label("FormPersonalization_AddAnApp_ToolTip"),Label:p.label("FormPersonalization_AddAnApp"),Name:"PersonalizationMoreMenuAddApp",Visible:this.AddAppModeEnabled},{Click:this.AddAPage,HelpText:p.label("FormPersonalization_AddAPage"),Label:p.label("FormPersonalization_AddAPage"),Name:"PersonalizationMoreMenuAddPage",Visible:this.AddAPageModeEnabled},{Click:function(){d.ChangeMode(p.ax.personalizationMode.addPAControl)},HelpText:p.label("FormPersonalization_AddPA_ToolTip"),Label:p.label("FormPersonalization_AddPA"),Name:"PersonalizationMoreMenuAddPAControl",Visible:this.AddPowerAppModeEnabled},{Click:this.Clear,HelpText:p.label("FormPersonalization_Clear"),Label:p.label("FormPersonalization_ClearButton"),Name:"PersonalizationMoreMenuClear"},{Click:this.Import,HelpText:p.label("FormPersonalization_Import"),Label:p.label("FormPersonalization_ImportButton"),Name:"PersonalizationMoreMenuImport"},{Click:this.Export,Enabled:this.ExportButtonEnabled,HelpText:p.label("FormPersonalization_Export"),Label:p.label("FormPersonalization_ExportButton"),Name:"PersonalizationMoreMenuExport"}],this.Shortcuts={AddAField:{Keys:{keyCode:p.ui.KeyCodes.letterA},Handler:function(){d.ChangeMode(p.ax.personalizationMode.addAField,!0)},Description:p.label("FormPersonalization_AddFieldMode")},AddApp:{Keys:{keyCode:p.ui.KeyCodes.letterP},Handler:function(){p.value(d.AddAPageModeEnabled)?d.AddAPage():p.value(d.AddAppModeEnabled)?d.ChangeMode(p.ax.personalizationMode.addApp,!0):p.value(d.AddPowerAppModeEnabled)&&d.ChangeMode(p.ax.personalizationMode.addPAControl,!0)},Description:p.label("FormPersonalization_AddAppMode")},AddToSummaryMode:{Keys:{keyCode:p.ui.KeyCodes.letterU},Handler:function(){d.ChangeMode(p.ax.personalizationMode.addToSummary,!0)},Description:p.label("FormPersonalization_SummaryMode")},Clear:{Keys:{ctrl:!0,keyCode:p.ui.KeyCodes.letterC},Handler:function(){d.Clear()},Description:p.label("FormPersonalization_Clear")},Escape:{Keys:{keyCode:p.ui.KeyCodes.esc},Handler:function(){if(p.flyout.flyoutManager.areAnyFlyoutsOpen()){var t=p.flyout.flyoutManager.getTopFlyout().target;if("PersonalizationToolbar_More_button"===t[0].id)var e=p.context(t[0]),o=p.observe(e.ShowFlyout,function(e){e||(t.focus(),o.dispose(),o=void 0)})}else d.UserCloseToolbar();d._destroyExpandoQtip()},Description:p.label("FormPersonalization_Exit")},ExpandoQtipLeftArrow:{Keys:{keyCode:p.ui.KeyCodes.leftArrow},Handler:function(){d.secondaryOptionQtip&&d.secondaryOptionQtip.tooltip&&d.secondaryOptionQtip.tooltip.find&&d.secondaryOptionQtip.tooltip.find(".secondaryQtipButton").focus()},Description:p.label("FormPersonalization_ExpandoLeftArrow"),ShowToUser:!1},ExpandoQtipRightArrow:{Keys:{keyCode:p.ui.KeyCodes.rightArrow},Handler:function(){d.secondaryOptionQtip&&d.secondaryOptionQtip.tooltip&&d.currentTargetControl&&d._focusExpandoTargetElement(d.currentTargetControl)},Description:p.label("FormPersonalization_ExpandoRightArrow"),ShowToUser:!1},Export:{Keys:{keyCode:p.ui.KeyCodes.letterX},Handler:function(){d.Export()},Description:p.label("FormPersonalization_Export")},GoToToolbar:{Keys:{keyCode:p.ui.KeyCodes.letterT},Handler:function(){0===$(document.activeElement).parents(".personalizationToolbar").length?(p.log.focus&&p.log.focus("Focus: Focusing personalization toolbar"),d.toggleToolbarFocusTarget=p.ui.removeFocus(void 0),d.FocusToolbar()):d.toggleToolbarFocusTarget?(p.log.focus&&p.log.focus("Focus: Personalization toolbar toggling focus back to last target"),p.ui.restoreFocus(d.toggleToolbarFocusTarget)):(p.log.focus&&p.log.focus("Focus: Personalization toolbar toggling focus back to root form"),p.context(d.rootFormElement).RestoreFocusToMainFormContainer())},Description:p.label("FormPersonalization_ToggleFocus")},HideMode:{Keys:{keyCode:p.ui.KeyCodes.letterH},Handler:function(){d.ChangeMode(p.ax.personalizationMode.hide,!0)},Description:p.label("FormPersonalization_HideMode")},Import:{Keys:{keyCode:p.ui.KeyCodes.letterI},Handler:function(){d.Import()},Description:p.label("FormPersonalization_Import")},LockMode:{Keys:{keyCode:p.ui.KeyCodes.letterE},Handler:function(){d.ChangeMode(p.ax.personalizationMode.lock,!0)},Description:p.label("FormPersonalization_LockMode")},MandatoryMode:{Keys:{keyCode:p.ui.KeyCodes.letterR},Handler:function(){d.ChangeMode(p.ax.personalizationMode.mandatory,!0)},Description:p.label("FormPersonalization_MandatoryMode")},MoveMode:{Keys:{keyCode:p.ui.KeyCodes.letterM},Handler:function(){d.ChangeMode(p.ax.personalizationMode.move,!0)},Description:p.label("FormPersonalization_MoveMode")},SelectMode:{Keys:{keyCode:p.ui.KeyCodes.letterS},Handler:function(){d.ChangeMode(p.ax.personalizationMode.select,!0)},Description:p.label("FormPersonalization_SelectMode")},SkipMode:{Keys:{keyCode:p.ui.KeyCodes.letterK},Handler:function(){d.ChangeMode(p.ax.personalizationMode.skip,!0)},Description:p.label("FormPersonalization_SkipMode")}},this.isInitialized=!0}e=p.ax||(p.ax={}),o.prototype.LaunchToolbar=function(e){var t=this;this.ensureLoaded(),$.when(this.htmlLoaded).done(function(){return t.initToolBar(e)})},o.prototype.savePendingPersonalizationAndCallUpdatePersonalizationData=function(e){this.SavePendingPersonalization(),this.updateFormPersonalizationData(e)},o.prototype.getElementOrHeader=function(e,t,o){var n,i,r;void 0===o&&(o=!1);var a=$(p.ui.selector().attr("data-dyn-mappedtab",e).toString())[0],s=a||t;if(p.util.isFlightEnabled(p.reactGrid.featureName))if(o)s&&s.classList.contains("fixedDataTableCellLayout_main")&&(t=$(s).find("[data-dyn-controlname]")[0])&&(s=t);else{var l=p.ui.getLiveControl(t);if(null!==(n=null==l?void 0:l.isInGrid)&&void 0!==n&&n.call(l)&&(null===(i=null==l?void 0:l.isInTable)||void 0===i||!i.call(l))&&null!==(r=null==l?void 0:l.Root)&&void 0!==r&&r.UseReactGrid()){var u=$(t).closest(".public_fixedDataTableCell_main")[0];u&&(s=u)}}return s},o.prototype.resetPotentialTarget=function(){$(p.ui.selector().css(p.ui.personalizationClasses.potentialTarget).toString()).removeClass(p.ui.personalizationClasses.potentialTarget),this.potentialTarget=void 0},o.prototype.SelectForEditPAControl=function(e){p.callFunction(e.ExecutePersonalizationCommand,e,["SelectForEditPAControl"])},o.prototype.SelectForEditWebsiteHostControl=function(e){p.callFunction(e.ExecutePersonalizationCommand,e,["SelectForEditWebsiteHostControl"])},o.prototype.SelectForQuickPersonalization=function(e){var t,o=this;e?p.ax.formPersonalizationPane.formPersonalizationController.qtip||(this.shouldTarget=!1,p.ax.formPersonalizationPane.formPersonalizationController.openPersonalizationUI(e),t=p.ax.formPersonalizationPane.qTipDestroyed.subscribe(function(){o.shouldTarget=!0,p.ax.formPersonalizationPane.qTipDestroyed.unsubscribe(t)})):p.logError("formPersonalization: control passed as null in SelectForQuickPersonalization")},o.prototype.SelectForHide=function(e){var t;for(t=e._parent?e._parent:$(e.element).parent()[0]?$(e.element).parent()[0]:$(e).parent()[0];t;){var o=t.element?t.element:t;if(o.classList&&o.classList.contains(p.ui.personalizationClasses.hidden))return;t=t._parent?t._parent:$(t.element).parent()[0]?$(t.element).parent()[0]:$(t).parent()[0]}var n=e.element.classList.contains(p.ui.personalizationClasses.personalized)?"True":"False";"False"==n&&this.HandleHideForChildControls(e,!1);var i=e.Root.FormName;this.ApplyPersonalizations(i,p.ax.personalizableProperties.Visible,n,e)},o.prototype.SelectForAddToSummary=function(e){var t=e.Root.FormName,o=e.element.classList.contains(p.ui.personalizationClasses.personalized)?"False":"True";this.ApplyPersonalizations(t,p.ax.personalizableProperties.FastTabSummary,o,e)},o.prototype.SelectForSkip=function(e){var t=e.Root.FormName,o=e.element.classList.contains(p.ui.personalizationClasses.personalized)?"True":"False";this.ApplyPersonalizations(t,p.ax.personalizableProperties.CanFocus,o,e)},o.prototype.SelectForLock=function(e){var t=e.Root.FormName,o=e.element.classList.contains(p.ui.personalizationClasses.personalized)?"True":"False";this.ApplyPersonalizations(t,p.ax.personalizableProperties.AllowEdit,o,e)},o.prototype.SelectForMandatory=function(e){var t=e.Root.FormName,o=e.element.classList.contains(p.ui.personalizationClasses.personalized)?"False":"True";this.ApplyPersonalizations(t,p.ax.personalizableProperties.Mandatory,o,e)},o.prototype.SelectForAdd=function(e){p.callFunction(e.ExecutePersonalizationCommand,e,["SelectForAdd"])},o.prototype.SelectForAddPAControl=function(e){p.callFunction(e.ExecutePersonalizationCommand,e,["SelectForAddPAControl"])},o.prototype.SelectForAddApp=function(e){p.callFunction(e.ExecutePersonalizationCommand,e,["SelectForAddApp"])},o.prototype.SelectForMove=function(e,s,l){var u=this;if(void 0===s&&(s=!1),!this.selectedForMove&&e){this.selectedForMove=e,this.shouldTarget=!1,this.shouldSubTarget=!0;var t=this.getElementOrHeader(this.selectedForMove.Name,this.selectedForMove.element);t.classList.add(p.ui.personalizationClasses.selectedForMove),this.setDragTarget&&(this.dragTarget=t),p.ax.personalizationUtil.addClassToBreakableGroups(t,p.ui.personalizationClasses.selectedForMove),this.updateAccessibilityDescriptionForMove(!0),this.currentApprovedPositions=[],p.callFunction(this.selectedForMove.ExecutePersonalizationCommand,this.selectedForMove,["SelectForMove"],function(){var t,e;if(u.selectedForMove){var o=u.selectedForMove.Root,n=JSON.parse(o.PersonalizationData());u.currentApprovedPositions=[],u.currentApprovedPositions.formName=o.FormName,u.currentPosition=void 0;try{for(var i=__values(n),r=i.next();!r.done;r=i.next()){var a=r.value.split(",");u.currentApprovedPositions.push(a)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}u.shouldSubTarget&&s&&u.EventHandler.subTarget(u,u.moveTarget,l)}})}else if(this.selectedForMove){if(void 0!==this.currentPosition&&this.currentApprovedPositions&&this.currentApprovedPositions[this.currentPosition]){var o=this.currentApprovedPositions[this.currentPosition].join(",");p.callFunction(this.selectedForMove.ExecutePersonalizationCommand,this.selectedForMove,["MoveControl",o],function(){p.layout.reflowRootForm()})}p.async(function(){u.resetMove()},void 0,"Reset move only after onclick is fired so that it can stop onclick propagation")}},o.prototype.resetMove=function(){this.selectedForMove&&(this.selectedForMove=void 0,$(p.ui.selector().css(p.ui.personalizationClasses.selectedForMove).toString()).removeClass(p.ui.personalizationClasses.selectedForMove),this.updateAccessibilityDescriptionForMove()),this.draggableObject&&(this.draggableObject.destroy(),this.draggableObject=void 0),this.shouldTarget=!0,this.shouldSubTarget=!1,this.resetDragTarget(),this.clearApprovedPositionIndicator()},o.prototype.UpdateMoveToLocationKeyboard=function(e){if(this.selectedForMove){var t=this.currentApprovedPositions.length;if(0!==t){var o,n=e.which,i=0;if(n===p.ui.KeyCodes.upArrow||n===p.ui.KeyCodes.leftArrow||n===p.ui.KeyCodes.tab&&e.shiftKey)i=-1;else{if(n!==p.ui.KeyCodes.downArrow&&n!==p.ui.KeyCodes.rightArrow&&(n!==p.ui.KeyCodes.tab||e.shiftKey))return;i=1}if(void 0===this.currentPosition){var r=this.currentApprovedPositions.map(function(e){return e[1]}).indexOf(this.selectedForMove.Name);1===i?this.currentPosition=r:-1===i&&(this.currentPosition=r?r-1:t-1)}o=0===this.currentPosition&&-1===i?t-1:(this.currentPosition+i)%t,this.currentPosition=o,this.highlightCurrentApprovedPosition()}}},o.prototype.UpdateMoveToLocation=function(e,t){var o,n="";if(e){for(var i=void 0,r=e.element;void 0===o&&r;){n=(i=p.ui.getLiveControl(r))&&i.Name;for(var a=0;a<this.currentApprovedPositions.length&&n;a++)if(this.currentApprovedPositions[a][1]===n){o=a;break}void 0===o&&(r=r.parentElement)}e=p.ui.getLiveControl(r)}if(!e||void 0===o||n===this.selectedForMove.Name)return this.currentPosition=void 0,void this.clearApprovedPositionIndicator();if(this.mouseIsOverFirstHalfOfControl(e,t)){var s=this.currentApprovedPositions[o][0];o&&o--;for(var l=this.currentApprovedPositions[o][0];0<o&&l!==s;)o--,l=this.currentApprovedPositions[o][0]}this.currentApprovedPositions[o][1]!==this.selectedForMove.Name&&(this.currentApprovedPositions[o+1]&&this.currentApprovedPositions[o+1][1]===this.selectedForMove.Name||(this.currentPosition=o,this.highlightCurrentApprovedPosition()))},o.prototype.UpdatePersonalizedControls=function(){var s=this;p.value(this.waitForAsyncDataRetrieval)||$.when.apply($.when,this.getWaitFormRenderResources()).done(function(){var e="",t="";switch(s.Mode()){case p.ax.personalizationMode.hide:e=p.ax.personalizableProperties.Visible+"_false",t=p.ui.personalizationClasses.hidden;break;case p.ax.personalizationMode.addToSummary:e=p.ax.personalizableProperties.FastTabSummary+"_true",t=p.ui.personalizationClasses.summary;break;case p.ax.personalizationMode.skip:e=p.ax.personalizableProperties.CanFocus+"_false",t=p.ui.personalizationClasses.skipped;break;case p.ax.personalizationMode.lock:e=p.ax.personalizableProperties.AllowEdit+"_false",t=p.ui.personalizationClasses.locked;break;case p.ax.personalizationMode.mandatory:e=p.ax.personalizableProperties.Mandatory+"_true",t=p.ui.personalizationClasses.personalizedAsMandatory}if(s.resetIndicators(),s._applyPersonalizableClasses(s.currentPersonalizableControls,p.ui.personalizationClasses.canBePersonalized),s._applyPersonalizableClasses(s.currentNonPersonalizableControls,p.ui.personalizationClasses.cannotBePersonalized),s.toggleNonPersonalizableDocumentSurfaces(!1),e)for(var o in e=e.toLowerCase(),s.currentPersonalizations)if(s.currentPersonalizations[o]&&s.currentPersonalizations[o][e])for(var n=s.getPersonalizedFormByName(o),i=s.currentPersonalizations[o][e],r=i.length-1;0<=r;r--){var a=i[r];s._addClassToNestedControl(a,n,p.ui.personalizationClasses.personalized,!0),s._addClassToNestedControl(a,n,t)}})},o.prototype.modeChanged=function(e){this.isInitialized&&""!==e&&(this.CurrentSelectedHelpText(this.CurrentHelpText()),this.setDragTarget=!1,this.resetDragTarget(),this.resetMove(),this.PreviewOn(!0),e===p.ax.personalizationMode.hide&&this.PreviewOn(!1),this.updateFormPersonalizationData(),e===p.ax.personalizationMode.move&&(this.setDragTarget=!0),e===p.ax.personalizationMode.addAField?this.getPersonalizableControl=p.ax.personalizationUtil.getPersonalizableContainerControl:e===p.ax.personalizationMode.addPAControl||e===p.ax.personalizationMode.addApp?this.getPersonalizableControl=p.ax.personalizationUtil.getPersonalizableAppContainerControl:this.getPersonalizableControl=p.ax.personalizationUtil.getPersonalizableControl,this.EventHandler=p.ax.personalizationModeEventHandlers[e])},o.prototype.SendToolbarAction=function(e){var t=this.currentVisibleForms[0];if(t&&(p.callFunction(t.ExecutePersonalizationCommand,t,["ToolbarAction_"+e]),e===p.ax.personalizationMode.open)){var o=p.context(p.shell.getActiveForm());o&&"FormRunConfigurationViewSelection"===o.FormName&&p.getFunction(o.Close)()}},o.prototype.initToolBar=function(e){var n=this;if(this.toolbar||(this.toolbar=p.ui.createControl("PersonalizationToolbar",this)),this.TabbingHandlerDispose||(this.TabbingHandlerDispose=p.util.tabbingContainer(this.toolbar,p.label("FormPersonalization_RegionTitle"))),this.CurrentHelpText(""),this.potentialTarget=void 0,this.shouldTarget=!0,this.shouldSubTarget=!1,this.selectedForMove=void 0,this.getPersonalizableControl=p.ax.personalizationUtil.getPersonalizableControl,this.ShowMoreMenu(!1),"visible"!==this.toolbar.style.visibility){var t=document.getElementById("mainPane");this.toolbar.parentNode||t.appendChild(this.toolbar),this.rootFormElement=p.shell.getCurrentDialog()||p.shell.getCurrentRootForm();var o=p.context(this.rootFormElement);this.getCurrentlyVisibleForms(o),this.SendToolbarAction(p.ui.personalizationToolbarEvents.ActionOpen),this._positionToolbar(),this.toolbar.style.visibility="visible",this.Mode(p.ax.personalizationMode.select,!0);var i=p.context($(this.toolbar).find('[aria-pressed="true"]')[0]);i&&i.HelpText&&this.CurrentHelpText(p.value(i.HelpText)),this.CurrentSelectedHelpText(this.CurrentHelpText()),this.addHandlers()}p.shell.disableContextMenu=!0,this._navigationCompleteEventSubscriberID=p.shell.subscribeToNavigationCompleteEvent(this.onNavigation),$(document.body).on("resetShellOnNavigation.formPersonalization",this.onNavigation),$.when(p.deferred.onTrue(function(){return!p.clientBusy()})).done(function(){n.FocusToolbar();var e=document.getElementsByClassName("personalizationToolbarGripper")[0];if(e&&(n.toolBarDragElement_hammer=new Hammer(e),n.toolBarDragElement_hammer.add(new Hammer.Pan({direction:Hammer.DIRECTION_ALL,threshold:0})),n.toolBarDragElement_hammer.on("pan",function(e){return n.handleDrag(e)}),n.lastPosX=e.offsetLeft,n.lastPosY=e.offsetTop),p.value(n.AddAppModeEnabled)){var t=document.getElementById("PersonalizationToolbar_More"),o=p.context(t);o&&(o.HelpText=p.label("FormPersonalization_MoreButton_ToolTip_AppsFlight"))}}),e&&e()},o.prototype.ensureLoaded=function(){var e=this;"resolved"===this.htmlLoaded.state()||this.htmlLoading||(this.htmlLoading=!0,p.requireResourceBundle("/resources/templates/FormPersonalization",function(){e.htmlLoading=!1,e.htmlLoaded.resolve()}))},o.prototype.FocusToolbar=function(){$(this.toolbar).find(".personalizationToolbar-symbolButton").first().focus()},o.prototype.closeToolbarCleanup=function(){this.SavePendingPersonalization(),this.toolbar.style.visibility="hidden";var e=document.getElementById("mainPane");this.toolbar.parentNode&&e&&e.removeChild(this.toolbar),this.removeHandlers(),this.removeNavigationHandlers(),this.resetPotentialTarget(),this.resetIndicators(),this.clearRootForm(),this.Mode()===p.ax.personalizationMode.move&&this.resetMove(),this.PreviewOn(!0),this.Mode(""),this.toolBarDragElement_hammer&&this.toolBarDragElement_hammer.destroy(),$(window).trigger(p.ui.personalizationToolbarEvents.ToolbarClosed,[this]),p.shell.disableContextMenu=!1},o.prototype.SystemCloseToolbar=function(){this.closeToolbarCleanup(),this.SendToolbarAction(p.ui.personalizationToolbarEvents.ActionSystemClose)},o.prototype.setToolbarControlButtonState=function(){var e=p.ui.findControl("__PersonalizationToolbar",this.rootFormElement);e&&(e.IsExportEnabled&&this.ExportButtonEnabled(e.IsExportEnabled()),e.IsAddAppModeEnabled&&this.AddAppModeEnabled(e.IsAddAppModeEnabled()),e.IsAddAPageModeEnabled&&this.AddAPageModeEnabled(e.IsAddAPageModeEnabled()),e.IsAddPowerAppModeEnabled&&this.AddPowerAppModeEnabled(e.IsAddPowerAppModeEnabled()))},o.prototype._canUpdateFormPersonalizaData=function(e){return e!==p.ax.personalizationMode.move&&e!==p.ax.personalizationMode.addAField&&e!==p.ax.personalizationMode.hide&&e!==p.ax.personalizationMode.lock&&e!==p.ax.personalizationMode.skip&&e!==p.ax.personalizationMode.addToSummary&&e!==p.ax.personalizationMode.mandatory},o.prototype.showHiddenFields=function(e){var t,o;try{for(var n=__values(this.currentVisibleForms),i=n.next();!i.done;i=n.next()){var r=i.value;r&&r.ShowOrHideHiddenFields&&r.ShowOrHideHiddenFields(e)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(o=n.return)&&o.call(n)}finally{if(t)throw t.error}}},o.prototype._getSymbolClass=function(e){var t="";switch(e){case p.ax.personalizationMode.select:t=p.ui.personalizationModeSymbolClasses.Click;break;case p.ax.personalizationMode.move:t=p.ui.personalizationModeSymbolClasses.Move;break;case p.ax.personalizationMode.hide:t=p.ui.personalizationModeSymbolClasses.HideItem;break;case p.ax.personalizationMode.addToSummary:t=p.ui.personalizationModeSymbolClasses.SummaryField;break;case p.ax.personalizationMode.skip:t=p.ui.personalizationModeSymbolClasses.SkipTab;break;case p.ax.personalizationMode.lock:t=p.ui.personalizationModeSymbolClasses.Uneditable;break;default:t=p.ui.personalizationModeSymbolClasses.Click}return t},o.prototype.handleDrag=function(e){var t=this.toolbar;this.isDragging||(this.isDragging=!0,this.lastPosX=t.offsetLeft,this.lastPosY=t.offsetTop);var o=e.deltaX+this.lastPosX,n=e.deltaY+this.lastPosY;0<$(window).width()-(o+this.toolbar.offsetWidth)&&(t.style.left=o<0?"0px":o+"px"),0<$(window).height()-(n+this.toolbar.offsetHeight)&&(t.style.top=n<0?"0px":n+"px"),e.isFinal&&(this.isDragging=!1)},o.prototype._positionToolbar=function(){this.toolbar.style.top="";var e=$(window).width()/2-$(this.toolbar).width()/2;this.toolbar.style.left=e+"px"},o.prototype.canModeHandleKey=function(e){var t=e.which;return this.EventHandler&&-1!==this.EventHandler.acceptedKeyCodes.indexOf(t)},o.prototype.addHandlers=function(){this.throttledOnMouseMove=p.ax.personalizationUtil.throttle(this.OnMouseMove,50),this.throttledOnKeyDown=p.ax.personalizationUtil.throttle(this.OnKeyDown,10,!0),document.body.addEventListener("touchmove",this.throttledOnMouseMove,!0),document.body.addEventListener("mousemove",this.throttledOnMouseMove,!0),document.body.addEventListener("click",this.OnClick,!0),document.body.addEventListener("keydown",this.throttledOnKeyDown,!0),document.body.addEventListener("touchenter",this.BlockEventHandler,!0),document.body.addEventListener("mouseenter",this.BlockEventHandler,!0),document.body.addEventListener("focus",this.OnFocus,!0);for(var e=this.toolbar.getElementsByClassName("button"),t=0;t<e.length;t++)$(e[t]).on("mouseenter.toolbar",this.updateCurrentHelpText),$(e[t]).on("focus.toolbar",this.updateCurrentHelpText);this.toolbar.addEventListener("mouseleave",this.updateCurrentHelpText)},o.prototype.removeHandlers=function(){document.body.removeEventListener("touchmove",this.throttledOnMouseMove,!0),document.body.removeEventListener("mousemove",this.throttledOnMouseMove,!0),document.body.removeEventListener("click",this.OnClick,!0),document.body.removeEventListener("keydown",this.throttledOnKeyDown,!0),document.body.removeEventListener("touchenter",this.BlockEventHandler,!0),document.body.removeEventListener("mouseenter",this.BlockEventHandler,!0),document.body.removeEventListener("focus",this.OnFocus,!0);for(var e=this.toolbar.getElementsByClassName("button"),t=0;t<e.length;t++)$(e[t]).off(".toolbar");this.toolbar.removeEventListener("mouseleave",this.updateCurrentHelpText)},o.prototype.removeNavigationHandlers=function(){$(document.body).off("resetShellOnNavigation.formPersonalization"),this._navigationCompleteEventSubscriberID&&p.shell.unsubscribeToNavigationCompleteEvent(this._navigationCompleteEventSubscriberID),this._navigationCompleteEventSubscriberID=void 0,this.TabbingHandlerDispose&&(this.TabbingHandlerDispose(),this.TabbingHandlerDispose=void 0)},o.prototype._handleKeyDown=function(e,o){var t=o.which,n=!0,i=!1,r=this.getPersonalizableControl(e);if(r&&this.canModeHandleKey(o)&&(n=this.EventHandler.onKeyDown(this,r,o)),!0===n){p.ax.formPersonalizationPane.formPersonalizationController.qtip?p.util.isShortcutKeyPressed(o,this.Shortcuts.Escape.Keys)&&p.ax.formPersonalizationPane.formPersonalizationController.destroyQTip():p.util.handleShortcuts(this,o),$.each(this.PropagatedShortcuts,function(e,t){if(p.util.isShortcutKeyPressed(o,t.Keys))return!(i=!0)});var a=t===p.ui.KeyCodes.f5,s=this.targetIsInteractable(e),l=this.targetIsClickable(e),u=t===p.ui.KeyCodes.tab&&!this.shouldSubTarget;i=i||a||s||u||l}return!1!==n&&!1!==i},o.prototype.moveStart=function(e){p.util.isFlightEnabled(p.reactGrid.featureName)&&(this.dragTarget=this.getElementOrHeader(null,this.dragTarget,!0));var t=this.getPersonalizableControl(this.dragTarget);this.selectedForMove=void 0,this.SelectForMove(t,!0,e),p.shell.cancelExtendedEventLoop()},o.prototype.moveStop=function(){this.SelectForMove()},o.prototype.mouseIsOverFirstHalfOfControl=function(e,t){var o=this.getElementOrHeader(e.Name,e.element),n=$(o).offset(),i=n&&n.top,r=i+$(o).outerHeight(),a=t.changedTouches,s=a&&a.length&&0<a[0].clientY?a[0].clientY:t.clientY;return this.controlLayoutHorizontal(e)&&(r=(i=n&&n.left)+$(o).outerWidth(),s=a&&a.length&&0<a[0].clientX?a[0].clientX:t.clientX),s<(i+r)/2},o.prototype.resetDragTarget=function(){this.dragTarget=void 0,this.moveTarget=void 0},o.prototype._checkIfFormIsNonPersonalizable=function(e){var t=!1;return this.nonPersonalizationForms[e]&&(t=!0),t},o.prototype._isNonPersonalizableForm=function(e){var t=!1;return e&&e.Root&&(this._checkIfFormIsNonPersonalizable(e.Root.FormName)||e.Root.Root&&this._checkIfFormIsNonPersonalizable(e.Root.Root.FormName))&&(t=!0),t},o.prototype.targetIsPersonalizing=function(e){return 0!==$(e).addBack().closest(p.ui.selector().css(p.ui.personalizationClasses.isPersonalizing).toString()).length},o.prototype.targetIsInteractable=function(e){var t=p.context(e);return!this.targetIsPersonalizing(e)&&!$(e).addBack().closest(".navigationBar").length&&!$(e).addBack().closest(".asidePane").length&&!$(e).addBack().closest(".modulesPane").length||"OverflowButton"===(null==t?void 0:t.TypeName)||"FactBoxToggleExpand"===(null==t?void 0:t.Name)},o.prototype.targetIsClickable=function(e){var t=p.ax.personalizationUtil.getPersonalizableControl(e);return!(!t||!t.isControlAvailableForExpando)&&t.isControlAvailableForExpando()&&!p.ax.personalizationUtil.isControlSelectedForMove(t)},o.prototype.isReactGridScrollbar=function(e){return e&&e.classList&&(e.classList.contains("ScrollbarLayout_face")||e.classList.contains("ScrollbarLayout_main"))},o.prototype.isReactGridReorderHandle=function(e){return e&&e.classList&&e.classList.contains("fixedDataTableCellLayout_columnReorderContainer")},o.prototype.IsPropertyEligibleForPendingPersonalization=function(e){return e===p.ax.personalizableProperties.Visible||e===p.ax.personalizableProperties.FastTabSummary||e===p.ax.personalizableProperties.CanFocus||e===p.ax.personalizableProperties.AllowEdit||e===p.ax.personalizableProperties.Mandatory},o.prototype.controlLayoutHorizontal=function(e){if(!e)return!1;var t=e.isInGrid&&e.isInGrid(),o=!1;return(e instanceof p.controls.PivotItem||e instanceof p.controls.SectionPage)&&(o=p.value(e.getParent().Style)===p.ui.autoValue),t||o},o.prototype._destroyExpandoQtip=function(){this.secondaryOptionQtip&&(this.secondaryOptionQtip.destroy&&this.secondaryOptionQtip.destroy(),this.secondaryOptionQtip=null,this.currentTargetControl&&(this.currentTargetControl.element.classList.remove(p.ui.personalizationClasses.personalizedElement),this.currentTargetControl=null))},o.prototype._canShowExpandoQtip=function(e){var t=p.ax.personalizationUtil.getPersonalizableControl(e);return!(!(this.targetIsClickable(e)&&t.Root&&t.Root.FormName)||this.currentNonPersonalizableControls.hasOwnProperty(t.Root.FormName)&&(!this.currentNonPersonalizableControls[t.Root.FormName]||this.currentNonPersonalizableControls[t.Root.FormName].hasOwnProperty(t.Name))||this.isDragging||p.ax.formPersonalizationPane.formPersonalizationController.qtip)},o.prototype._showExpandoQtip=function(o,n){var i=this,e=$(n).hasClass("ignore-first-focus"),r=p.ax.personalizationUtil.getPersonalizableControl(n),a=this.Mode?this.Mode():void 0;if(!e)if(r&&this._canShowExpandoQtip(n)){if(this.resetPotentialTarget(),this.secondaryOptionQtip&&this.currentTargetControl!==r&&this._destroyExpandoQtip(),!this.secondaryOptionQtip){var t,s=function(){p.ax.personalizationModeEventHandlers[a].onClick(i,r),i._canUpdateFormPersonalizaData(a)&&i.updateFormPersonalizationData(),o.stopPropagation(),a!==p.ax.personalizationMode.move&&a!==p.ax.personalizationMode.select&&i._focusExpandoTargetElement(r),p.log.stopPropagation&&p.log.stopPropagation("Stop propagation in show expando qtip")},l=function(e){var t=e.which;p.ax.personalizationUtil.isActionKey(t)?(i._handleKeyDown(n,e),o.stopPropagation(),p.log.stopPropagation&&p.log.stopPropagation("Stop propagation in key down handler of expando qtip"),a!==p.ax.personalizationMode.move&&a!==p.ax.personalizationMode.select&&i._focusExpandoTargetElement(r)):t===p.ui.KeyCodes.rightArrow&&p.util.handleShortcuts(i,e)},u=this._getSymbolClass(a);r instanceof p.controls.PivotItem&&(t=r.getPersonalizableTarget()),t=t||r.element,$(t).qtip({content:'<button class="personalizationToolbar-symbolButton button secondaryQtipButton secondaryQtipSymbol" type="button" data-dyn-image-type="Image" data-dyn-button-display="ImageOnly" data-dyn-button-display="ImageOnly"><div class="button-container secondaryQtipSymbol"><span data-dyn-image-type="Symbol" class="button-commandRing secondaryQtipSymbol '+u+'"></span></div></button>',events:{show:function(){$(".qtip-content").click(s),$(".secondaryQtipButton").keydown(l)}},hide:"unfocus",position:{at:"top left",my:"top right",target:$(t)},show:!1,style:{classes:"secondaryQtipContent secondaryQtipSymbol"}}).qtip("api"),this.secondaryOptionQtip=$(t).qtip("api"),this.secondaryOptionQtip.show(),p.async(function(){t&&i.secondaryOptionQtip&&i.secondaryOptionQtip.tooltip&&i.secondaryOptionQtip.tooltip.width&&i.secondaryOptionQtip.tooltip.css({left:$(t).offset().left-i.secondaryOptionQtip.tooltip.width()-2,top:$(t).offset().top})},void 0,"delay applying qTip styles"),this.currentTargetControl=r}}else{if($(n).hasClass("secondaryQtipSymbol")||$(n).hasClass("secondaryQtipContent")||$(n).hasClass("qtip-content"))return o.stopPropagation(),p.log.stopPropagation&&p.log.stopPropagation("Stop propagation in show expando qtip"),!1;this._destroyExpandoQtip()}return!0},o.prototype._focusExpandoTargetElement=function(e){var t;e&&e.getExpandoPersonalizationFocusTarget&&(t=e.getExpandoPersonalizationFocusTarget()),t&&(e.Root&&e.Root.setControlFocus&&e.Root.setControlFocus(t[0],!0),document.activeElement!==t[0]&&(t.focus(),p.log.focus&&p.log.focus("Focus: Form(Form.Id: %s)->_focusExpandoTargetElement header of container control name: %s",e.Root.Id,e.Name)))},o.prototype.updateAccessibilityDescriptionForTarget=function(e){if(this.targetIsPersonalizing(e)&&!this.selectedForMove){var t=$("#PersonalizationToolbar_LiveHelp");t.empty();var o=void 0,n=this.getPersonalizableControl(e);o=n?this.getPersonalizedStateMessage(n):p.label("FormPersonalization_CannotBePersonalized"),t.append(o)}},o.prototype.updateAccessibilityDescriptionForMove=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=null);var o,n=$("#PersonalizationToolbar_LiveHelp");if(n.empty(),e)o=p.label("FormPersonalization_SelectedForMove");else if(t){var i=p.context(t);if(!i){var r=$(t).addBack().closest("[data-dyn-controlname]")[0];i=p.context(r)}if(i){var a=p.value(i.Label);a&&(o=p.format(p.label("FormPersonalization_MoveNextTo"),a))}}else o=p.label("FormPersonalization_UnselectedForMove");n.append(o)},o.prototype.getPersonalizedStateMessage=function(e){return e.element.classList.contains(p.ui.personalizationClasses.personalized)?p.label("FormPersonalization_IsPersonalized"):p.label("FormPersonalization_CanBePersonalized")},o.prototype.ApplyPersonalizations=function(e,t,o,n){var i=this.getPersonalizedFormByName(e);if(i)if(this.IsPropertyEligibleForPendingPersonalization(t)){if(n){var r=n.Name,a=n instanceof p.controls.Group;this.QueuePendingPersonalizations(e,t,o,r);var s=!1,l=void 0;switch(t){case p.ax.personalizableProperties.Visible:s="true"===o.toLowerCase(),l=p.ui.personalizationClasses.hidden;break;case p.ax.personalizableProperties.FastTabSummary:s="false"===o.toLowerCase(),l=p.ui.personalizationClasses.summary;break;case p.ax.personalizableProperties.CanFocus:s="true"===o.toLowerCase(),l=p.ui.personalizationClasses.skipped;break;case p.ax.personalizableProperties.AllowEdit:s="true"===o.toLowerCase(),l=p.ui.personalizationClasses.locked;break;case p.ax.personalizableProperties.Mandatory:s="false"===o.toLowerCase(),l=p.ui.personalizationClasses.personalizedAsMandatory}this._addClassToNestedControl(r,i,p.ui.personalizationClasses.personalized,a,s),this._addClassToNestedControl(r,i,l,a,s)}}else{var u=void 0;if(n&&n.PersistPersonalization)u=n;else{var d=p.context(i[0]);d&&d.PersistPersonalization&&(u=d)}u&&p.callFunction(u.PersistPersonalization,u,[t,o])}},o.prototype.QueuePendingPersonalizations=function(e,t,o,n){if(this.IsPropertyEligibleForPendingPersonalization(t)){var i=n+":"+t;this._multiplePersonalizations.hasOwnProperty(e)||(this._multiplePersonalizations[e]={}),this._multiplePersonalizations[e][i]=o}},o.prototype.SavePendingPersonalization=function(){var t,e;for(var o in this._multiplePersonalizations)if(this._multiplePersonalizations.hasOwnProperty(o)){var n=this._multiplePersonalizations[o],i=[];for(var r in n)if(n.hasOwnProperty(r)){var a=r.split(":"),s=a[0],l=a[1],u=n[r];this.currentPersonalizationsControlPropertyMap.hasOwnProperty(o)&&this.currentPersonalizationsControlPropertyMap[o].hasOwnProperty(r)&&this.currentPersonalizationsControlPropertyMap[o][r].toLowerCase()===u.toLowerCase()||i.push({__type:"FormRunConfigurationPropertyClass:#Dynamics.AX.Application",ControlValue:s,DocumentExtensionValue:"",ExtensionValue:"",PropertyValue:l,ValueValue:n[r]})}if(0<i.length){var d=JSON.stringify({PropertyList:i}),c=void 0;try{for(var p=(t=void 0,__values(this.currentVisibleForms)),h=p.next();!h.done;h=p.next()){var m=h.value;if(m&&m.FormName===o){c=m;break}}}catch(e){t={error:e}}finally{try{h&&!h.done&&(e=p.return)&&e.call(p)}finally{if(t)throw t.error}}c&&c.SavePendingPersonalization&&c.SavePendingPersonalization(d)}}this._multiplePersonalizations={}},o.prototype.updateFormPersonalizationData=function(e){var t,o,n=this;void 0===e&&(e=!1),this.waitForAsyncDataRetrieval(!0),this.rootFormElement=p.shell.getCurrentDialog()||p.shell.getCurrentRootForm();var i=p.context(this.rootFormElement);if(i&&p.value(i.AllowExplicitPersonalization)){(this.Mode?this.Mode():void 0)===p.ax.personalizationMode.hide&&this.showHiddenFields(!0),e&&this.getCurrentlyVisibleForms(i);var r=[],a=function(e){var t,o=$.Deferred();t=o,p.callFunction(e.UpdatePersonalizationData,e,[n.Mode()],function(){t.resolve()}),r.push(o.promise())};try{for(var s=__values(this.currentVisibleForms),l=s.next();!l.done;l=s.next())a(l.value)}catch(e){t={error:e}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(t)throw t.error}}$.when.apply($.when,r).done(function(){n.currentPersonalizations={},n.currentPersonalizableControls={},n.currentNonPersonalizableControls={},n.currentPersonalizationsControlPropertyMap={},n.mapFormPersonalizationData(),n.waitForAsyncDataRetrieval(!1),n.setToolbarControlButtonState(),p.deferred.onTrue(function(){return!p.value(p.ui.layout)}).done(function(){n.UpdatePersonalizedControls()})})}},o.prototype.mapFormPersonalizationData=function(){var t,e;try{for(var o=__values(this.currentVisibleForms),n=o.next();!n.done;n=o.next()){var i=n.value,r=i.FormName;this.currentPersonalizations[r]={},this.currentPersonalizableControls[r]={},this.currentNonPersonalizableControls[r]={},this.currentPersonalizationsControlPropertyMap[r]={};for(var a=JSON.parse(i.PersonalizationData()),s=a.Configurations,l=s.length-1;0<=l;l--){var u=s[l],d=u.PropertyValue+"_"+u.ValueValue,c=u.ControlValue+":"+u.PropertyValue;d=d.toLowerCase(),this.currentPersonalizations[r][d]||(this.currentPersonalizations[r][d]=[]),this.currentPersonalizations[r][d].push(u.ControlValue),this.currentPersonalizationsControlPropertyMap[r][c]=u.ValueValue,this.QueuePendingPersonalizations(r,u.PropertyValue,u.ValueValue,u.ControlValue)}var p=a.PersonalizableControls;for(l=p.length-1;0<=l;l--){var h=p[l];this.currentPersonalizableControls[r][h]=!0}var m=a.NonPersonalizableControls;for(l=m.length-1;0<=l;l--)h=m[l],this.currentNonPersonalizableControls[r][h]=!0}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},o.prototype._applyPersonalizableClasses=function(e,t){for(var o in e){var n=this.getPersonalizedFormByName(o);for(var i in e[o])this._addClassToNestedControl(i,n,t)}},o.prototype.HandleHideForChildControls=function(e,t,o){var n,i;if(void 0===o&&(o=!1),e)if(p.value(e.isContainer)||e.Children&&0<e.Children().length){var r=[];if(e instanceof p.controls.Part?r=e.getChildForms():e instanceof p.controls.ReactList?r=e.getColumnsOptions():e.Children&&(r=e.Children()),r&&0<r.length)try{for(var a=__values(r),s=a.next();!s.done;s=a.next()){var l=s.value;if(l){var u=$(l.element),d=l.Root&&l.Root.FormName?l.Root.FormName:l.FormName;if(!t&&l.Name&&d&&this._multiplePersonalizations[d]){var c=l.Name+":"+p.ax.personalizableProperties.Visible;this._multiplePersonalizations[d][c]&&"false"===this._multiplePersonalizations[d][c].toLowerCase()&&this.ApplyPersonalizations(d,p.ax.personalizableProperties.Visible,"True",l)}p.value(l.isContainer)||l.Children&&0<l.Children().length?this.HandleHideForChildControls(l,t,o):t&&!p.ax.personalizationUtil.checkIfSummaryField(l.TypeName)&&p.value(l.Required)&&(o?u.removeClass(p.ui.personalizationClasses.mandatory):u.addClass(p.ui.personalizationClasses.mandatory))}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}}else t&&!p.ax.personalizationUtil.checkIfSummaryField(e.TypeName)&&p.value(e.Required)&&(o?$(e.element).removeClass(p.ui.personalizationClasses.mandatory):$(e.element).addClass(p.ui.personalizationClasses.mandatory))},o.prototype._addClassToNestedControl=function(e,t,i,r,a){var s=this;void 0===r&&(r=!1),void 0===a&&(a=!1);var l=this.Mode?this.Mode():void 0,o=p.ui.selector().attr("data-dyn-controlname",e).toString(),n=t.find(o).add(o,t[0]);function u(e){if(e.getPersonalizableTarget){var t=$(e.getPersonalizableTarget());t&&(a?t.removeClass(i):t.addClass(i))}}if(0===n.length&&(n=$("[data-dyn-controlName='"+e+"']")),1===n.length){var d=p.context(n[0]);!l||l===p.ax.personalizationMode.hide&&i===p.ui.personalizationClasses.cannotBePersonalized&&d&&"AppBarSection"===d.TypeName||(a?n.removeClass(i):n.addClass(i),d&&(u(d),l===p.ax.personalizationMode.hide&&i===p.ui.personalizationClasses.personalized&&this.HandleHideForChildControls(d,!0,a)),r&&p.ax.personalizationUtil.addClassToBreakableGroups(n[0],i,l,a))}else if(1<n.length){var c=t.attr("data-dyn-form-name");n.each(function(e,t){var o=t,n=p.ui.getLiveControl(o);!l||l===p.ax.personalizationMode.hide&&i===p.ui.personalizationClasses.cannotBePersonalized&&n&&"AppBarSection"===n.TypeName||n&&n.Root&&n.Root.FormName===c&&(a?o.classList.remove(i):o.classList.add(i),u(n),l===p.ax.personalizationMode.hide&&i===p.ui.personalizationClasses.personalized&&s.HandleHideForChildControls(n,!0,a),r&&p.ax.personalizationUtil.addClassToBreakableGroups(o,i,l,a))})}},o.prototype.addPositionIndicator=function(e,t){if(e){var o=p.ui.getLiveControl(e);if(o&&o.Root&&o.Root.UseReactGrid()){e=this.getElementOrHeader(o.Name,e,!0);var n=p.ui.getLiveControl(e);n&&n.listControl&&n.listControl.scrollColumnIntoViewIfNeeded(n.Name)}e.scrollIntoViewIfNeeded(),e.classList.add(t),this.updateAccessibilityDescriptionForMove(!1,e),o&&this.controlLayoutHorizontal(o)&&e.classList.add(p.ui.personalizationClasses.movePositionHorizontal)}},o.prototype.highlightCurrentApprovedPosition=function(){function n(e,t){var o;void 0===t&&(t=null);var n,i,r="data-dyn-controlname";return(i=e)&&(i instanceof p.controls.List||i instanceof p.controls.ReactList)||null!==(o=null==t?void 0:t.isInGrid)&&void 0!==o&&o.call(t)?r="data-dyn-columnname":(n=e)&&p.value(n.TypeName)===p.ui.TabStyle.vertical&&(r="data-dyn-mappedtab"),r}this.clearApprovedPositionIndicator();var e=this.currentApprovedPositions[this.currentPosition],t=e[0],o=e[1],i=this.getPersonalizedFormByName(this.currentApprovedPositions.formName)[0];if(o){var r=p.context(i.querySelector(p.ui.selector().attr("data-dyn-controlname",t).toString())),a=p.context(i.querySelector(p.ui.selector().attr("data-dyn-controlname",o).toString())),s=n(r,a),l=i.querySelector(p.ui.selector().attr(s,o).toString());if(l){l=this.getElementOrHeader(o,l);var u=p.layout.getTailBreakableGroup(l);l=u||l,this.addPositionIndicator(l,p.ui.personalizationClasses.movePositionAfter)}}else if(t){var d=null;d=0===t.indexOf("FormDesign",0)?(t=t.split(":")[1],i.querySelector(p.ui.selector().attr("data-dyn-form-name",t).desc().css("formContainer").desc().css("rootContent").desc().attr("data-dyn-controlname").toString())):function(e){if(!e)return null;var t=p.context(e),o=n(t);return e.querySelector(p.ui.selector().attr(o).toString())}(i.querySelector(p.ui.selector().attr("data-dyn-controlname",t).toString())),this.addPositionIndicator(d,p.ui.personalizationClasses.movePositionBefore)}},o.prototype.clearApprovedPositionIndicator=function(){$(p.ui.selector().css(p.ui.personalizationClasses.movePositionBefore).toString()).removeClass(p.ui.personalizationClasses.movePositionBefore),$(p.ui.selector().css(p.ui.personalizationClasses.movePositionAfter).toString()).removeClass(p.ui.personalizationClasses.movePositionAfter),$(p.ui.selector().css(p.ui.personalizationClasses.movePositionHorizontal).toString()).removeClass(p.ui.personalizationClasses.movePositionHorizontal)},o.prototype.toggleNonPersonalizableDocumentSurfaces=function(o){$("iframe").each(function(e,t){$(t).css("pointer-events",o?"all":"none")})},o.prototype.resetIndicators=function(){this.toggleNonPersonalizableDocumentSurfaces(!0),$(p.ui.selector().css(p.ui.personalizationClasses.canBePersonalized).toString()).removeClass(p.ui.personalizationClasses.canBePersonalized),$(p.ui.selector().css(p.ui.personalizationClasses.cannotBePersonalized).toString()).removeClass(p.ui.personalizationClasses.cannotBePersonalized);var e=$(p.ui.selector().css(p.ui.personalizationClasses.personalized).toString());e.removeClass(p.ui.personalizationClasses.personalized),e.removeClass(p.ui.personalizationClasses.hidden),e.removeClass(p.ui.personalizationClasses.summary),e.removeClass(p.ui.personalizationClasses.skipped),e.removeClass(p.ui.personalizationClasses.locked)},o.prototype.getCurrentlyVisibleForms=function(e){if(e&&p.value(e.AllowExplicitPersonalization)){this.currentVisibleForms=[],this.rootFormElement.classList.add(p.ui.personalizationClasses.isPersonalizing),this.currentVisibleForms.push(e);var t=e.GetAllPartForms();this.currentVisibleForms=this.currentVisibleForms.concat(t);var o=e.GetAllFactBoxForms();this.currentVisibleForms=this.currentVisibleForms.concat(o)}},o.prototype.getPersonalizedFormByName=function(e){var t=$(this.rootFormElement);return t=t.attr("data-dyn-form-name")===e?t:t.find(p.ui.selector().attr("data-dyn-form-name",e).toString())},o.prototype.getWaitFormRenderResources=function(){function e(e){var t,o=$.Deferred();t=o,p.deferred.onTrue(function(){return!e.waitForAsyncRender()}).done(function(){t.resolve()}),n.push(o.promise())}var t,o,n=[];try{for(var i=__values(this.currentVisibleForms),r=i.next();!r.done;r=i.next())e(r.value)}catch(e){t={error:e}}finally{try{r&&!r.done&&(o=i.return)&&o.call(i)}finally{if(t)throw t.error}}return n},o.prototype.clearRootForm=function(){this.rootFormElement&&this.rootFormElement.classList.remove(p.ui.personalizationClasses.isPersonalizing),this.rootFormElement=void 0},t=o,e.formPersonalizationToolbar=t}($dyn=$dyn||{}),function(r){var e,t,o,n,i,a,s,l;Globalize.addCultureInfo("en",{messages:{FormPersonalization_AddAnApp:"Add an app",FormPersonalization_AddAnApp_ToolTip:"Select the area of the form you wish to add an app to. Then configure the app in the dialog that opens.",FormPersonalization_AddAPage:"Add a page",FormPersonalization_AddButton:"Add a field",FormPersonalization_AddButton_ToolTip:"Add a field that is not yet part of this page. Select a region to add a field to, and the add field slider will appear with field choices.",FormPersonalization_AddFieldMode:"Enable Insert a Field mode",FormPersonalization_AddMenu:"Insert",FormPersonalization_AddMenuToolTip:"Insert a control on the page",FormPersonalization_AddPA:"Add an app from Power Apps",FormPersonalization_AddPA_ToolTip:"Select the area of the form you wish to add a PowerApp to. Then configure the PowerApp in the dialog that opens.",FormPersonalization_AddPAControlMode:"Enable Insert a PowerApp mode",FormPersonalization_CanBePersonalized:"Can be personalized",FormPersonalization_CannotBePersonalized:"Cannot be personalized",FormPersonalization_Clear:"Clear personalization on this page",FormPersonalization_ClearButton:"Clear",FormPersonalization_CloseButton:"Close",FormPersonalization_Exit:"Exit personalization mode",FormPersonalization_Export:"Export personalization",FormPersonalization_ExportButton:"Export",FormPersonalization_HideButton:"Hide/View",FormPersonalization_HideButton_ToolTip:"Click elements you want to hide or make visible.",FormPersonalization_HideMode:"Enable Hide mode",FormPersonalization_Import:"Import personalization",FormPersonalization_ImportButton:"Import",FormPersonalization_IsPersonalized:"Has been personalized",FormPersonalization_LockButton:"Lock field",FormPersonalization_LockButton_ToolTip:"Select the fields to lock to prevent changes.",FormPersonalization_LockMode:"Enable Lock mode",FormPersonalization_MandatoryButton:"Require",FormPersonalization_MandatoryButton_ToolTip:"Select the fields you want to be required for data entry",FormPersonalization_MandatoryControlHidden:"You have hidden a required field. This field will be shown if it has no value when a save is attempted.",FormPersonalization_MoreButton:"More",FormPersonalization_MoreButton_ToolTip:"Add a PowerApp to this page, or clear, import, or export personalizations for this page",FormPersonalization_MoreButton_ToolTip_AppsFlight:"Add an app to this page, or clear, import, or export personalizations for this page",FormPersonalization_MoveButton:"Move",FormPersonalization_MoveButton_ToolTip:"Select an element and drag to a new location, or use tab and the arrow keys to choose the new location and space/enter to confirm.",FormPersonalization_MoveMode:"Enable Move mode",FormPersonalization_MoveNextTo:"Move next to {0}",FormPersonalization_PreviewButton:"Preview",FormPersonalization_RegionTitle:"Personalization toolbar",FormPersonalization_SelectButton:"Select",FormPersonalization_SelectButton_ToolTip:"Select an element to open a dialog and change its properties.",FormPersonalization_SelectedForMove:"Selected for move",FormPersonalization_SelectMode:"Enable Select mode",FormPersonalization_SkipButton:"Skip in tab",FormPersonalization_SkipButton_ToolTip:"Select the fields to be skipped when tabbing.",FormPersonalization_SkipMode:"Enable Skip mode",FormPersonalization_SummaryMode:"Enable Summary mode",FormPersonalization_TabSummaryButton:"Show in header",FormPersonalization_TabSummaryButton_ToolTip:"Select the fields to show in a collapsed section header.",FormPersonalization_ToggleFocus:"Toggle focus between the personalization toolbar and the page content",FormPersonalization_UnselectedForMove:"Unselected for move"}}),$(window).on(r.forms.Events.personalize,function(e){e.preventDefault(),r.ax.formPersonalizationPane.formPersonalizationController.destroyQTip(),r.ax.formPersonalizationPane.formPersonalizationToolbar.LaunchToolbar()}),e=r.ax||(r.ax={}),(t=e.personalizationMode||(e.personalizationMode={})).open="open",t.select="select",t.move="move",t.hide="hide",t.mandatory="mandatory",t.addToSummary="addToSummary",t.skip="skip",t.lock="lock",t.addAField="addAField",t.addPAControl="addPAControl",t.addApp="addApp",(o=e.personalizableProperties||(e.personalizableProperties={})).AllowEdit="AllowEdit",o.CanFocus="CanFocus",o.FastTabSummary="FastTabSummary",o.Mandatory="PersonalizationMandatory",o.Visible="Visible",e.personalizationModeEventHandlers={addAField:{acceptedKeyCodes:[r.ui.KeyCodes.enter,r.ui.KeyCodes.spacebar],onClick:function(e,t){e.SelectForAdd(t)},onKeyDown:function(e,t,o){var n=o.which;r.ax.personalizationUtil.isActionKey(n)&&e.SelectForAdd(t)}},addApp:{acceptedKeyCodes:[r.ui.KeyCodes.enter,r.ui.KeyCodes.spacebar],onClick:function(e,t){e.SelectForAddApp(t)},onKeyDown:function(e,t,o){var n=o.which;r.ax.personalizationUtil.isActionKey(n)&&e.SelectForAddApp(t)}},addPAControl:{acceptedKeyCodes:[r.ui.KeyCodes.enter,r.ui.KeyCodes.spacebar],onClick:function(e,t){e.SelectForAddPAControl(t)},onKeyDown:function(e,t,o){var n=o.which;r.ax.personalizationUtil.isActionKey(n)&&e.SelectForAddPAControl(t)}},addToSummary:{acceptedKeyCodes:[r.ui.KeyCodes.enter,r.ui.KeyCodes.spacebar],onClick:function(e,t){e.SelectForAddToSummary(t)},onKeyDown:function(e,t,o){var n=o.which;r.ax.personalizationUtil.isActionKey(n)&&e.SelectForAddToSummary(t)}},hide:{acceptedKeyCodes:[r.ui.KeyCodes.enter,r.ui.KeyCodes.spacebar],onClick:function(e,t){e.SelectForHide(t)},onKeyDown:function(e,t,o){var n=o.which;r.ax.personalizationUtil.isActionKey(n)&&e.SelectForHide(t)}},lock:{acceptedKeyCodes:[r.ui.KeyCodes.enter,r.ui.KeyCodes.spacebar],onClick:function(e,t){e.SelectForLock(t)},onKeyDown:function(e,t,o){var n=o.which;r.ax.personalizationUtil.isActionKey(n)&&e.SelectForLock(t)}},mandatory:{acceptedKeyCodes:[r.ui.KeyCodes.enter,r.ui.KeyCodes.spacebar],onClick:function(e,t){e.SelectForMandatory(t)},onKeyDown:function(e,t,o){var n=o.which;r.ax.personalizationUtil.isActionKey(n)&&e.SelectForMandatory(t)}},move:{acceptedKeyCodes:[r.ui.KeyCodes.upArrow,r.ui.KeyCodes.downArrow,r.ui.KeyCodes.leftArrow,r.ui.KeyCodes.rightArrow,r.ui.KeyCodes.tab,r.ui.KeyCodes.enter,r.ui.KeyCodes.spacebar,r.ui.KeyCodes.esc],onClick:function(e,t){if(e.resetMove(),e.resetPotentialTarget(),e.SelectForMove(t),e.shouldTarget=!0,e.dragTarget){var o=new Hammer(e.dragTarget);o.add(new Hammer.Pan({direction:Hammer.DIRECTION_ALL,threshold:0})),e.isDragging=!1,(e.draggableObject=o).on("pan",e._handleDrag)}},onKeyDown:function(e,t,o){var n=!0,i=o.which;return r.ax.personalizationUtil.isActionKey(i)?(e.resetPotentialTarget(),e.SelectForMove(t),e.shouldTarget=!0):i===r.ui.KeyCodes.esc?(e.selectedForMove&&(n=!1),e.resetMove()):e.UpdateMoveToLocationKeyboard(o),n},subTarget:function(e,t,o){e.UpdateMoveToLocation(t,o)}},select:{acceptedKeyCodes:[r.ui.KeyCodes.enter,r.ui.KeyCodes.spacebar],onClick:function(e,t){e.SelectForQuickPersonalization(t)},onKeyDown:function(e,t,o){var n=o.which;r.ax.personalizationUtil.isActionKey(n)&&e.SelectForQuickPersonalization(t)}},skip:{acceptedKeyCodes:[r.ui.KeyCodes.enter,r.ui.KeyCodes.spacebar],onClick:function(e,t){e.SelectForSkip(t)},onKeyDown:function(e,t,o){var n=o.which;r.ax.personalizationUtil.isActionKey(n)&&e.SelectForSkip(t)}}},(n=e.formPersonalizationPane||(e.formPersonalizationPane={})).paneName="FormPersonalizationPane",n.formPersonalizationController=new r.ax.formPersonalizationController,n.formPersonalizationToolbar=new r.ax.formPersonalizationToolbar,n.qTipDestroyed=new r.eventHost,i=r.ui||(r.ui={}),(a=i.personalizationClasses||(i.personalizationClasses={})).canBePersonalized="personalization-canBePersonalized",a.cannotBePersonalized="personalization-cannotBePersonalized",a.dragClone="personalization-dragClone",a.draggable="ui-draggable",a.dragging="ui-draggable-dragging",a.hidden="personalized-hidden",a.isPersonalizing="isPersonalizing",a.locked="personalized-locked",a.mandatory="personalized-mandatory",a.movePositionAfter="personalization-movePositionAfter",a.movePositionBefore="personalization-movePositionBefore",a.movePositionHorizontal="personalization-movePositionHorizontal",a.personalized="personalization-personalized",a.personalizedAsMandatory="personalizedAsMandatory",a.personalizedElement="personalization-personalizedElement",a.potentialTarget="personalization-potentialTarget",a.selectedForMove="personalization-selectedForMove",a.skipped="personalized-skipped",a.summary="personalized-summary",(s=i.personalizationModeSymbolClasses||(i.personalizationModeSymbolClasses={})).Click="Click-symbol",s.HideItem="HideItem-symbol",s.Move="Move-symbol",s.SkipTab="SkipTab-symbol",s.SummaryField="SummaryField-symbol",s.Uneditable="Uneditable-symbol",(l=i.personalizationToolbarEvents||(i.personalizationToolbarEvents={})).ActionOpen="open",l.ActionSystemClose="systemClose",l.ActionUserClose="close",l.ToolbarClosed="personalizationToolbarClosed"}($dyn=$dyn||{}),function(v){var e,t;e=v.ax||(v.ax={}),(t=e.personalizationUtil||(e.personalizationUtil={})).canBePersonalizedInCurrentMode=function(e,t){return v.ax.formPersonalizationPane.formPersonalizationToolbar.currentPersonalizableControls&&!!v.ax.formPersonalizationPane.formPersonalizationToolbar.currentPersonalizableControls[t]&&!!v.ax.formPersonalizationPane.formPersonalizationToolbar.currentPersonalizableControls[t][e]},t.isPersonalizationModeTurnedOn=function(){return!!(v.ax.formPersonalizationPane&&v.ax.formPersonalizationPane.formPersonalizationToolbar&&v.ax.formPersonalizationPane.formPersonalizationToolbar.Mode&&""!==v.value(v.ax.formPersonalizationPane.formPersonalizationToolbar.Mode))},t.currentPersonalizationMode=function(){if(v.ax.formPersonalizationPane&&v.ax.formPersonalizationPane.formPersonalizationToolbar&&v.ax.formPersonalizationPane.formPersonalizationToolbar.Mode&&v.value(v.ax.formPersonalizationPane.formPersonalizationToolbar.Mode))return v.value(v.ax.formPersonalizationPane.formPersonalizationToolbar.Mode)},t.forceUpdateFormPersonalizationData=function(){var e;if(v.ax.formPersonalizationPane&&v.ax.formPersonalizationPane.formPersonalizationToolbar&&(e=v.ax.formPersonalizationPane.formPersonalizationToolbar),e&&e.Mode&&""!==e.Mode()){e.savePendingPersonalizationAndCallUpdatePersonalizationData(!0);var t=function(){v.async(function(){""!==e.Mode()&&e.savePendingPersonalizationAndCallUpdatePersonalizationData(!0)})};$(document.body).on(v.forms.Events.partCreated,t);var o=function(){$(document.body).off(v.forms.Events.partCreated,t),$(window).off(v.ui.personalizationToolbarEvents.ToolbarClosed,o)};$(window).on(v.ui.personalizationToolbarEvents.ToolbarClosed,o)}},t.checkIfSummaryField=function(e){switch(e){case"InputSummary":case"MultilineInputSummary":case"RealSummary":case"IntegerSummary":case"Int64Summary":case"DateSummary":case"DateTimeSummary":case"TimeSummary":case"ComboBoxSummary":return!0;default:return!1}},t.addClassToBreakableGroups=function(e,t,o,n){void 0===n&&(n=!1),setTimeout(function(){v.layout.getBreakableGroups(e).forEach(function(e){n?e.classList.remove(t):e.classList.add(t)})})},t.isActionKey=function(e){return e===v.ui.KeyCodes.enter||e===v.ui.KeyCodes.spacebar},t.isControlPersonalizable=function(e){return"SysPAMenuButton"===e.Name||v.value(e.AllowPersonalization)},t.isControlSelectedForMove=function(e){if(e&&v.ax.personalizationUtil.isPersonalizationModeTurnedOn()&&v.ax.formPersonalizationPane.formPersonalizationToolbar&&v.ax.personalizationUtil.currentPersonalizationMode()===v.ax.personalizationMode.move){var t=v.ax.formPersonalizationPane.formPersonalizationToolbar.getElementOrHeader(e.Name,e.element);if(t&&$(t).hasClass(v.ui.personalizationClasses.selectedForMove))return!0}return!1},t.getPersonalizableControl=function(e){var t,o,n,i=v.ui.getLiveControl(e);if(!i){var r=$(e).addBack().closest("[data-dyn-controlname]")[0];if(!(i=v.ui.getLiveControl(r)))return null}i instanceof v.controls.SectionPageHeader&&(i=i.GetSectionPage()),v.context(i.element)?t=i.element:v.context(e)&&(t=e),t?(o=v.serverForm&&v.serverForm.getElementControlParams(t))&&(n=v.value(o.Name)):n=v.value(i.Name);var a=i,s=n||v.value(i.Name),l=i.Root&&i.Root.findControl&&i.Root.findControl(s);if(l&&(o=v.serverForm&&v.serverForm.getElementControlParams(l))&&(n=v.value(o.Name)),o&&n&&i&&i.Root&&(i.Root.findControl||v.logError("formPersonalization:getPersonalizableControl has a control whose root do not have findcontrol function"),n=(l=i.Root.findControl&&i.Root.findControl(n))?(a=v.ui.getLiveControl(l)).Name:(a=null,"")),n){for(var u=a&&a.Root&&a.Root.FormName,d=v.ax.personalizationUtil.canBePersonalizedInCurrentMode(n,u);!d&&a&&v.ax.formPersonalizationPane.formPersonalizationToolbar.Mode()===v.ax.personalizationMode.move&&!v.ax.personalizationUtil.checkIfSummaryField(a.TypeName);){var c=$(a.element).parents("[data-dyn-controlname]")[0];d=(a=v.ui.getLiveControl(c))&&v.ax.personalizationUtil.canBePersonalizedInCurrentMode(a.Name,u)}if(a&&a.Root){var p=!!v.value(a.PersistPersonalization)&&!!v.value(a.ExecutePersonalizationCommand),h=v.ax.personalizationUtil.isControlPersonalizable(a),m=v.value(a.Root.AllowExplicitPersonalization)&&h;if(p&&m&&d)return a}}return null},t.getPersonalizableAppContainerControl=function(e){for(var t=["AppBarSection","Section","VerticalTabs","Panorama","Pivot"],o=$(e).addBack().parents(),n=0;n<o.length;n++){var i=o[n],r=i.getAttribute("data-dyn-role");if(-1!==t.indexOf(r)){var a=v.context(i);if(a&&a.Root){if("Pivot"===r&&!v.value(a.ShowHeaders))return null;var s=a.Root.FormName,l=v.value(a.Root.AllowExplicitPersonalization)&&v.value(a.AllowPersonalization),u=v.ax.personalizationUtil.canBePersonalizedInCurrentMode(a.Name,s);if(l&&u)return a}}}return null},t.getPersonalizableContainerControl=function(e){for(var t=["List","ReactList","Group","SectionPage"],o=$(e).addBack().parents(),n=0;n<o.length;n++){var i=o[n],r=i.getAttribute("data-dyn-role");if(-1!==t.indexOf(r)){var a=v.context(i);if(a&&a.Root){var s=a.Root.FormName,l=v.value(a.Root.AllowExplicitPersonalization)&&v.value(a.AllowPersonalization),u=v.ax.personalizationUtil.canBePersonalizedInCurrentMode(a.Name,s);if(l&&u)return a}}}return null},t.throttle=function(t,o,n){void 0===n&&(n=!1);var i=!1;return function(){if(i){if(n){var e=arguments[0];e.stopPropagation(),e.preventDefault(),v.log.stopPropagation&&v.log.stopPropagation("Throttle event during Personalization")}}else t.apply(t,arguments),i=!0,setTimeout(function(){i=!1},o)}},t.forceUpdatePersonalizationClasses=function(){var e;v.ax.formPersonalizationPane&&v.ax.formPersonalizationPane.formPersonalizationToolbar&&(e=v.ax.formPersonalizationPane.formPersonalizationToolbar),e&&e.Mode&&""!==e.Mode()&&e.UpdatePersonalizedControls()}}($dyn=$dyn||{}),function(t){var e,o,n;Globalize.addCultureInfo("en",{messages:{HelpMenu_ShowHelp:"Show help",HelpPane_Title:"Help"}}),e=t.ax||(t.ax={}),(n=o=e.helpPane||(e.helpPane={})).paneIsOpen=t.observable(!1),n.close=function(){n.pane&&t.shell.hideAsidePane(n.pane.targetElement),n.paneIsOpen(!1)},n.open=function(){if(n.pane)n.refreshHelp&&n.refreshHelp();else{n.pane={name:"HelpPane",role:"Dialog",templateId:"HelpPane"},t.shell.createForm(n.pane);var e=t.context(n.pane.targetElement);e.DisplayTarget=t.forms.DisplayTarget.AsidePane,e.PreventAutoClose(!0)}t.shell.open({form:t.context(n.pane.targetElement)}),n.paneIsOpen(!0)},n.getPart=function(){var e=document.getElementById("helppane_content");return t.context(e)},e.Shortcuts={OpenHelpPane_Alternative:{Keys:{alt:!0,shift:!0,keyCode:t.ui.KeyCodes.letterA},Handler:function(){!1===t.shell.hasRestrictedInternet()&&t.shell.openHelpPane()},Description:t.label("HelpMenu_ShowHelp"),Category:t.ui.ShortcutCategory.Navigate},OpenHelpPane_Primary:{Keys:{ctrl:!0,shift:!0,keyCode:t.ui.KeyCodes.forwardslash},Handler:function(){!1===t.shell.hasRestrictedInternet()&&t.shell.openHelpPane()},Description:t.label("HelpMenu_ShowHelp"),Category:t.ui.ShortcutCategory.Navigate}},t.shell.openHelpPane=o.open,$(document).on("keydown",function(e){e.isPropagationStopped()||t.util.handleShortcuts(t.ax,e)})}($dyn=$dyn||{});__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(r){var e,a,t;function o(e,t,o,n){var i=a.call(this,e,t,o,n)||this;return i.notifyPending=!1,i.usingDisposable(r.observe(i.getActiveFormName,function(e){return i.isNotifyPending(e)})),r.ax.helpPane.refreshHelp=function(){var e=r.context(r.shell.getActiveForm());e?r.callFunction(i.RefreshHelp,i,[e.FormName]):r.callFunction(i.RefreshHelp,i,[i.formName])},i}e=r.controls||(r.controls={}),a=r.ui.Control,__extends(o,a),o.prototype.getActiveFormName=function(){if(r.ax.helpPane.pane&&r.shell.getActiveAsideForm()===r.ax.helpPane.pane.targetElement||r.ax.appDesigner.pane&&r.shell.getActiveAsideForm()===r.ax.appDesigner.pane.targetElement||r.ax.taskRecording.pane&&r.shell.getActiveAsideForm()===r.ax.taskRecording.pane.targetElement){var e=r.value(r.activeForm);if(e){var t=r.context(e);if(t)return r.value(t.FormName)}}},o.prototype.isNotifyPending=function(e){var o=this;e&&this.ContextChanged&&(this.formName=e,this.notifyPending||(this.notifyPending=!0,r.observe(r.clientBusy,function(e){if(!1===e){if(o.notifyPending){var t=r.shell&&r.shell.ProductId?[o.formName,r.shell.ProductId]:[o.formName];r.callFunction(o.ContextChanged,o,t),o.notifyPending=!1}return!1}})))},t=o,e.HelpContextTracker=t}($dyn=$dyn||{}),function(i){!function(e){var t;Globalize.addCultureInfo("en",{messages:{Tracing_PaneTitle:"Tracing",Tracing_Start:"Trace"}}),(t=e._tracing||(e._tracing={})).style="task-recorder-button",t.started=i.observable(!1),t.paneIsOpen=i.observable(!1),t.open=function(){t.pane||(t.pane={name:"TracingPane",role:"Dialog",templateId:"TracingPane"},i.shell.createForm(t.pane),i.context(t.pane.targetElement).DisplayTarget=i.forms.DisplayTarget.AsidePane),i.shell.open({form:i.context(t.pane.targetElement)}),t.paneIsOpen(!0)};var o=(n.prototype.RequestClose=function(){i.ax._tracing.paneIsOpen(!1)},n);function n(){}e._tracingPane=o}(i.ax||(i.ax={}))}($dyn=$dyn||{}),function(i){var e,t;Globalize.addCultureInfo("en",{messages:{WindowManager_HostClosed:"This window is now read-only because the connection with the host window was lost."}}),$(window).on("Popout",function(e){e.preventDefault(),i.callWhenNotBusy(i.serverForm._popout)}),(e=i.serverForm||(i.serverForm={}))._popoutWindowSizePercentage=.8,e._windowId=0,e._popout=function(){var e=null,t=i.shell.getCurrentRootForm(),o=null;if(t&&t.dynOptions&&t.dynOptions._serverId&&(e=(o=i.context(t)).Id),o){var n={userDefined1:i.serverForm._windowId};i.telemetry.addFormActionEvent(o,i.telemetry.ActionEvents.formPopout,n)}i.serverForm._windowManager.prePopout({rootId:e})},(t=e._WindowManagerFunction||(e._WindowManagerFunction={})).prePopout="prePopout",t.windowLoadCallback="windowLoadCallback",t.closeWindow="closeWindow",t.hostClosed="hostClosed",t.globalBlocked="globalBlocked",t.globalUnBlocked="globalUnBlocked",t.requestClosePopout="requestClosePopout",t.forceClosePopout="forceClosePopout",t.notifyFormReserialized="notifyFormReserialized",t.notifyFormDetached="notifyFormDetached",t.notifyFocusWindow="notifyFocusWindow",t.transferUserSettings="transferUserSettings",t.transferShellSettings="transferShellSettings"}($dyn=$dyn||{}),function(l){var e,t;function o(){var o=this;this.isPoppingOut=!1,this.channelsToFlush=0,this.channelIdToSubscription={},this._focusedWindowId=0,this.currentRootId=0,this._nextWindowId=0,this.windows={},this.windowCount=l.observable(0),this._currentReserializedForms={},this.windowCountToClose=0,this.windowClosedCompleted=0,this.windowCloseSuccess=!0,this.windowCloseSuccessCallback=null,this.windowCloseErrorCallback=null,this._windowLoadTimeout=1e4,this.handleMessages=function(e){if(e.origin===l.util.getOrigin(l.util.location.location)){var t=e.data;"object"==typeof t&&"WindowManager"===t.source&&(t.newWindow=e.source,o.Commands[t.commandName].call(o,t))}}}e=l.serverForm||(l.serverForm={}),Object.defineProperty(o.prototype,"_interactionManager",{get:function(){return l.serverForm.interactionManager},enumerable:!1,configurable:!0}),o.prototype.getNextWindowId=function(){return this._nextWindowId++},o.prototype.prePopout=function(e){var t=e.rootId;if(!t||this.isPoppingOut)return!1;if(this.isPoppingOut=!0,this.currentRootId=t,this._interactionManager.hasQueuedInteractions()){for(var o=this._interactionManager._channelPool,n=o.length-1;0<=n;n--){var i=o[n];if(0<i.interactionQueue.length){var r=i.interactionReceived.subscribe(this.onChannelFlush.bind(this));this.channelIdToSubscription[i.channel.channelId]=r,this.channelsToFlush++}}this._interactionManager.flushAllChannels()}else this.popoutForm();return!0},o.prototype.onChannelFlush=function(e){var t=this;if(e){var o=e.Channel,n=this.channelIdToSubscription[o.channel.channelId];n||l.log.server&&l.log.server("A subscription ID is required to unsubscribe successfully."),delete this.channelIdToSubscription[o.channel.channelId],o.interactionReceived.unsubscribe(n),this.channelsToFlush--,0===this.channelsToFlush&&$.when(l.deferred.onTrue(function(){return l.value(l.async.pending)<=1})).done(function(){t.popoutForm()})}},o.prototype.popoutForm=function(){var e=this;l.async.pending.increment("WindowManager: Popout start.");var t=this.currentRootId,o=this.getNextWindowId(),n=700,i=700;if(l.parentWindow){var r=$(l.parentWindow).width()*l.serverForm._popoutWindowSizePercentage;n<=r&&(n=r,i=$(l.parentWindow).height()*l.serverForm._popoutWindowSizePercentage)}var a=l.util.parseUrl(window.location);a.query={popout:o,rootId:t,newPopout:!0,debug:l.util.location.query.debug};var s=a.relativeUrl();this.openWindow(s,"_blank","location=no, resizable=yes, width="+n+", height="+i)?(l.log.focus&&l.log.focus("Focus: Window %s opened",o),this._windowLoadTimeoutId=window.setTimeout(function(){e.windowLoadCallbackTimedOut()},this._windowLoadTimeout)):(this.isPoppingOut=!1,l.async.pending.decrement("WindowManager: Popout end - Failed to open new window."))},o.prototype.windowLoadCallback=function(e){var t=e.newWindow,o=e.windowId,n=e.rootId;this._windowLoadTimeoutId&&clearTimeout(this._windowLoadTimeoutId),l.log.navigation&&l.log.navigation("WindowManager: windowLoadCallback called from windowId:%s and rootId:%s",o,n),this.windows[o]=t,this.incrementWindowCount();var i=this._interactionManager,r=new l.serverForm.InteractionHandlerProxy(t);if(i.addWindowHandler(o,r),n){var a=i.getWindowIdFromRootId(n);if(i._prepFormForPopout(n,a),i.addRootId(n,o),this.transferUserSettings(o),this.transferShellSettings(o),!r.reserializeForm(n))return l.log.navigation&&l.log.navigation("WindowManager: reserializeForm failed. See previously logged errors in the console."),i.addRootId(n,a),this.isPoppingOut=!1,void l.async.pending.decrement("WindowManager: Popout end - Failed to open new window successfully.");l.async.pending.increment("WindowManager: Reserialize form "+n+" start."),this._currentReserializedForms[n]={originalWindowId:a,windowId:o}}this.isPoppingOut=!1,l.async.pending.decrement("WindowManager: Popout end - Opened new window successfully.")},o.prototype.notifyFormReserialized=function(e){var t=e.rootId?e.rootId:e,o=this._currentReserializedForms[t].originalWindowId;l.async.pending.increment("WindowManager: Detach form "+t+" from window "+o),this._interactionManager.detachFormForPopout(t,o)||l.async.pending.decrement("WindowManager: Detach form "+t+" from window "+o+" failed."),delete this._currentReserializedForms[t],l.async.pending.decrement("WindowManager: Reserialize form "+t+" finished.")},o.prototype.notifyFormDetached=function(e){var t=e.rootId?e.rootId:e;l.async.pending.decrement("WindowManager: Detach form "+t+" finished.")},o.prototype.isFocused=function(){return this._focusedWindowId===l.serverForm._windowId},o.prototype.focusWindow=function(){this.notifyFocusWindow({id:l.serverForm._windowId})},o.prototype.notifyFocusWindow=function(e){this._focusedWindowId=e.id,this._broadcastFocusWindow(e.id)},o.prototype.transferUserSettings=function(e){var t=l.user().pack(),o=this.windows[e];if(o){var n={commandName:l.serverForm._WindowManagerFunction.transferUserSettings,packedUserSettings:t,source:"WindowManagerPopout"};l.postMessage(o,{data:n})}},o.prototype.transferShellSettings=function(e){var t=l.shell.pack(),o=this.windows[e];if(o){var n={commandName:l.serverForm._WindowManagerFunction.transferShellSettings,packedShellSettings:t,source:"WindowManagerPopout"};l.postMessage(o,{data:n})}},o.prototype.closeWindow=function(e){var t=e&&e.windowId;if(t){if(l.log.navigation&&l.log.navigation("WindowManager: closeWindow - Closing Popout Window %s",t),t===this._nextWindowId-1)for(var o in this.isPoppingOut&&(this.isPoppingOut=!1),this._currentReserializedForms)if(t===this._currentReserializedForms[o].windowId){var n=this._currentReserializedForms[o].originalWindowId;l.async.pending.decrement("WindowManager: Reserialize form "+o+" failed to load on window "+t+"."),l.log.navigation&&l.log.navigation("WindowManager: Window %s was closed before it could finish reserializing form %s.",t,o),l.log.navigation&&l.log.navigation("WindowManager: Restoring form %s to window %s.",o,n),this._interactionManager.addRootId(o,n)}if(this.windowCloseSuccessCallback)this.windowClosedCompleted++,this.windowCloseSuccess=this.windowCloseSuccess&&l.value(e.windowCloseSuccess),this.tryCallCloseCallbacks();else{var i=!!e.closeForms;this._interactionManager.cleanupPopout(t,i)}l.value(e.windowCloseSuccess)&&this.cleanupWindow(t)}else l.log.navigation&&l.log.navigation("WindowManager: closeWindow - Closing Host Window"),l.serverForm._windowManager.notifyHostClosed(),l.serverForm.endSession()},o.prototype.notifyHostClosed=function(){this._postMessageToChildrenWindows(l.serverForm._WindowManagerFunction.hostClosed)},o.prototype.notifyBlock=function(e,t){e?l.shell.blockUserInteractionNoWait(t):l.shell.blockUserInteraction(t),this._postMessageToChildrenWindows(l.serverForm._WindowManagerFunction.globalBlocked)},o.prototype.notifyUnBlock=function(){l.shell.unBlockUserInteraction(),this._postMessageToChildrenWindows(l.serverForm._WindowManagerFunction.globalUnBlocked)},o.prototype.requestCloseAllPopouts=function(e,t){if(this.windowCountToClose=0,this.windowClosedCompleted=0,this.windowCloseSuccess=!0,this.windowCloseSuccessCallback=null,this.windowCloseErrorCallback=null,l.debug.popoutKeepOpen)e();else{for(var o in"function"==typeof e?this.windowCloseSuccessCallback=e:l.logWarning("WindowManager:  closeAllPopouts should be called with a success callback."),"function"==typeof t?this.windowCloseErrorCallback=t:l.logWarning("WindowManager:  closeAllPopouts should be called with an error callback."),this.windows){var n=this.windows[o];if(n){var i={commandName:l.serverForm._WindowManagerFunction.requestClosePopout,source:"WindowManagerPopout"};l.postMessage(n,{data:i})&&this.windowCountToClose++}}this.tryCallCloseCallbacks()}},o.prototype.forceCloseAllPopouts=function(){this._postMessageToChildrenWindows(l.serverForm._WindowManagerFunction.forceClosePopout)},o.prototype.hasMultipleWindows=function(){for(var e in this.windows)if(this.windows[e])return!0;return!1},o.prototype.getAllWindows=function(){var e=[l.parentWindow];if(l.value(this.windowCount))for(var t in this.windows)this.windows[t]&&e.push(this.windows[t]);return e},o.prototype.openWindow=function(e,t,o){return l.shell.openWindow({url:e,target:t,features:o})},o.prototype.windowLoadCallbackTimedOut=function(){l.log.navigation&&l.log.navigation("WindowManager: windowLoadCallbackTimedOut called after %d ms.",this._windowLoadTimeout),this.isPoppingOut=!1,l.async.pending.decrement("WindowManager: Popout end - New window failed to call the windowLoadCallback in a timely manner.")},o.prototype._broadcastFocusWindow=function(e){this._postMessageToChildrenWindows(l.serverForm._WindowManagerFunction.notifyFocusWindow,{id:e})},o.prototype._postMessageToChildrenWindows=function(e,t){for(var o in this.windows){var n=this.windows[o];n&&((t=t||{}).source="WindowManagerPopout",t.commandName=e,l.postMessage(n,{data:t}))}},o.prototype.tryCallCloseCallbacks=function(){this.windowClosedCompleted===this.windowCountToClose&&(this.windowCloseSuccess?this.windowCloseSuccessCallback():this.windowCloseErrorCallback(),this.windowCloseSuccessCallback=null,this.windowCloseErrorCallback=null)},o.prototype.cleanupWindow=function(e){delete this.windows[e],this.decrementWindowCount()},o.prototype.incrementWindowCount=function(){var e=l.peek(this.windowCount);e++,this.windowCount(e)},o.prototype.decrementWindowCount=function(){var e=l.peek(this.windowCount);e--,this.windowCount(e)},t=o,(e._WindowManager=t).prototype.Commands={closeWindow:l.serverForm._WindowManager.prototype.closeWindow,notifyFocusWindow:l.serverForm._WindowManager.prototype.notifyFocusWindow,notifyFormDetached:l.serverForm._WindowManager.prototype.notifyFormDetached,notifyFormReserialized:l.serverForm._WindowManager.prototype.notifyFormReserialized,prePopout:l.serverForm._WindowManager.prototype.prePopout,windowLoadCallback:l.serverForm._WindowManager.prototype.windowLoadCallback},e._windowManager=new t}($dyn=$dyn||{}),function(n){var e,t;function o(){var o=this;this.closeForms=!0,this.windowCloseSuccess=!0,this.handleMessages=function(e){if(e.origin===n.util.getOrigin(n.util.location.location)){var t=e.data;"object"==typeof t&&"WindowManagerPopout"===t.source&&o.Commands[t.commandName].call(o,t)}},this.closeWindow=function(){var e={closeForms:o.closeForms,commandName:n.serverForm._WindowManagerFunction.closeWindow,source:"WindowManager",windowCloseSuccess:o.windowCloseSuccess,windowId:n.serverForm._windowId};return o._postMessageToParentWindow(e)}}e=n.serverForm||(n.serverForm={}),o.prototype.prePopout=function(e){return e.source="WindowManager",e.commandName=n.serverForm._WindowManagerFunction.prePopout,this._postMessageToParentWindow(e)},o.prototype.windowLoadCallback=function(e){this.focusWindow();var t={commandName:n.serverForm._WindowManagerFunction.windowLoadCallback,rootId:e.rootId,source:"WindowManager",windowId:e.windowId};return this._postMessageToParentWindow(t)},o.prototype.notifyFormReserialized=function(e){var t={commandName:n.serverForm._WindowManagerFunction.notifyFormReserialized,rootId:e,source:"WindowManager"};return this._postMessageToParentWindow(t)},o.prototype.notifyFormDetached=function(e){var t={commandName:n.serverForm._WindowManagerFunction.notifyFormDetached,rootId:e,source:"WindowManager"};return this._postMessageToParentWindow(t)},o.prototype.closePopoutWindow=function(e){this.closeForms=e,window.close()},o.prototype.hostClosed=function(){n.showMessageBox({callback:function(){$("#DisconnectedDiv").show(),n.warn({Message:n.label("WindowManager_HostClosed"),Label:"WindowManager_HostClosed"})},showOkButton:!0,Text:n.label("WindowManager_HostClosed")}),n.parentWindow={postMessage:function(){}}},o.prototype.globalUnBlocked=function(){n.log.navigation&&n.log.navigation("WindowManager: globalUnBlocked called"),n.shell.unBlockUserInteraction()},o.prototype.globalBlocked=function(){n.log.navigation&&n.log.navigation("WindowManager: globalBlocked called"),n.shell.blockUserInteractionNoWait("WindowManager: globalBlocked")},o.prototype.requestCloseAllPopouts=function(e,t){"function"==typeof e?e():n.logWarning("WindowManagerPopout: closeAllPopouts should be called with a callback.")},o.prototype.requestClosePopout=function(){var e=this;n.shell.closeWindowFormsBeforeNavigating(function(){e.windowCloseSuccess=!0,e.closePopoutWindow(!0)},function(){e.windowCloseSuccess=!1,e.closeForms=!0,n.serverForm._windowManager.closeWindow()})},o.prototype.forceClosePopout=function(){this.closePopoutWindow(!0)},o.prototype.isFocused=function(){return this._focusedWindowId===n.serverForm._windowId},o.prototype.focusWindow=function(){this.notifyFocusWindow({id:n.serverForm._windowId}),this._broadcastFocusWindow(n.serverForm._windowId)},o.prototype.notifyFocusWindow=function(e){this._focusedWindowId=e.id},o.prototype.transferUserSettings=function(e){e&&n.user().unpack(e.packedUserSettings)},o.prototype.transferShellSettings=function(e){e&&n.shell.unpack(e.packedShellSettings)},o.prototype._postMessageToParentWindow=function(e){if(n.parentWindow)return n.postMessage(n.parentWindow,{data:e});n.logError("Trying to post message to parentWindow which does not exist.")},o.prototype._broadcastFocusWindow=function(e){var t={commandName:n.serverForm._WindowManagerFunction.notifyFocusWindow,id:e,source:"WindowManager"};this._postMessageToParentWindow(t)},t=o,(e._WindowManagerPopout=t).prototype.Commands={forceClosePopout:n.serverForm._WindowManagerPopout.prototype.forceClosePopout,globalBlocked:n.serverForm._WindowManagerPopout.prototype.globalBlocked,globalUnBlocked:n.serverForm._WindowManagerPopout.prototype.globalUnBlocked,hostClosed:n.serverForm._WindowManagerPopout.prototype.hostClosed,notifyFocusWindow:n.serverForm._WindowManagerPopout.prototype.notifyFocusWindow,requestClosePopout:n.serverForm._WindowManagerPopout.prototype.requestClosePopout,transferShellSettings:n.serverForm._WindowManagerPopout.prototype.transferShellSettings,transferUserSettings:n.serverForm._WindowManagerPopout.prototype.transferUserSettings}}($dyn=$dyn||{}),function(r){var e,t;e=r.serverForm||(r.serverForm={}),(t=e.ProxyMessageCenterManager||(e.ProxyMessageCenterManager={})).getMessageIds=function(e){for(var t=[],o=0,n=r.length(e);o<n;o++){var i=e[o];i instanceof r.messaging.Message?t.push(i.Id):i instanceof r.messaging.PrefixRootMessage&&r.serverForm.ProxyMessageCenterManager.getPrefixMessageIds(i.prefixSection,t)}return t},t.getPrefixMessageIds=function(e,t){for(var o=0;o<e.messages.length;o++){var n=e.messages[o];n instanceof r.messaging.Message?t.push(n.Id):n instanceof r.messaging.PrefixRootMessage&&r.serverForm.ProxyMessageCenterManager.getPrefixMessageIds(n.prefixSection,t)}void 0!==e.prefixSection&&r.serverForm.ProxyMessageCenterManager.getPrefixMessageIds(e.prefixSection,t)},t.AddMessage=function(e){r.serverForm.ProxyMessageCenterManager.AddMessages([e])},t.AddMessages=function(e){var t={commandName:"ReplayMessageOnMainWindow",messageIds:r.serverForm.ProxyMessageCenterManager.getMessageIds(e),source:"MessageCenter"};return r.postMessage(r.parentWindow,{data:t})},t.ClearMessages=function(){return r.postMessage(r.parentWindow,{data:{commandName:"ClearMessages",source:"MessageCenter"}})},t.RemoveMessages=function(e){for(var t=0,o=r.length(e);t<o;t++){var n=e[t];r.serverForm.ProxyMessageCenterManager.RemoveMessage(n.messageId)}},t.RemoveMessage=function(e){var t={commandName:"RemoveMessage",messageId:e,source:"MessageCenter"};return r.postMessage(r.parentWindow,{data:t})},t.GetMessage=function(e){return null}}($dyn=$dyn||{}),function(y){!function(g){g.getPropertyName=function(e){var t=e.lastIndexOf("_field");return-1!==t?e.substr(0,t):e},g.isModel=function(e){return!(!e||!e._properties)};var e=(Object.defineProperty(t.prototype,"collectionIndex",{get:function(){return this._collectionIndex||(this._collectionIndex=y.observable()),y.value(this._collectionIndex)},set:function(e){this._collectionIndex?this._collectionIndex(e):this._collectionIndex=y.observable(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isActionable",{get:function(){return!!this.parent&&(this.parent.UseReactGrid?!!this.parent.activeRecord_mastertrackingid&&this.parent.activeRecord_mastertrackingid()===this.masterTrackingId:this.parent.selectedIndex()===this.collectionIndex)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSelected",{get:function(){return!!this.parent&&(this.parent.UseReactGrid?!!this.parent.internalActiveMasterTrackingId&&this.parent.internalActiveMasterTrackingId()===this.masterTrackingId:this.parent.selectedIndex()===this.collectionIndex)},set:function(e){this.parent&&(e?(this.parent.UseReactGrid&&this.parent.internalActiveMasterTrackingId(this.masterTrackingId),this.parent.selectedIndex(this.collectionIndex)):(this.parent.UseReactGrid&&y.value(this.parent.internalActiveMasterTrackingId)===this.masterTrackingId&&this.parent.internalActiveMasterTrackingId(""),this.parent.selectedIndex()===this.collectionIndex&&this.parent.selectedIndex(-1)))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMarked",{get:function(){return this.parent&&this.parent.UseReactGrid?y.util.stringToBoolean(this.getValue(y.reactGrid.ISMARKED_NAME)):!!(this.parent&&this.parent.markedIndexes&&void 0!==this.collectionIndex&&this.parent.markedIndexes()[this.collectionIndex])},set:function(e){if(this.parent&&this.parent.UseReactGrid)this.setValue(y.reactGrid.ISMARKED_NAME,e.toString(),!1,this._formId);else{var t=this.parent&&this.parent.markedIndexes;t&&void 0!==this.collectionIndex&&(t()[this.collectionIndex]=e)}},enumerable:!1,configurable:!0}),t.prototype.getPropertyNames=function(){return this._properties?Object.keys(this._properties):[]},t.prototype.doesPropertyExist=function(e){return e===y.reactGrid.ISSELECTED_NAME||e===y.reactGrid.ISMARKED_NAME||e===y.reactGrid.ISACTIONABLE_NAME||e===y.reactGrid.ISACTIVE_NAME||void 0!==this._properties[e]},t.prototype.removeProperty=function(e){e!==y.reactGrid.ISSELECTED_NAME&&e!==y.reactGrid.ISMARKED_NAME&&e!==y.reactGrid.ISACTIONABLE_NAME&&void 0!==this._properties[e]&&delete this._properties[e]},t.prototype.getValue=function(e){var t;if(this.parent&&this.parent.UseReactGrid&&e===y.reactGrid.ISSELECTED_NAME)t=this.isSelected;else if(this.parent&&this.parent.UseReactGrid&&e===y.reactGrid.ISMARKED_NAME)t=y.util.stringToBoolean(y.value(this._getProperty(y.reactGrid.ISMARKED_NAME)));else if(this.parent&&this.parent.UseReactGrid&&e===y.reactGrid.ISACTIONABLE_NAME)t=this.isActionable;else{if(this.parent&&this.parent.UseReactGrid&&e===y.reactGrid.ISACTIVE_NAME)return!!this.parent.activeDataRowTrackingId&&this.parent.activeDataRowTrackingId()===this.masterTrackingId;t=this._getProperty(e)}return y.value(t)},t.prototype.setValue=function(e,t,o,n){var i,r=this;if(void 0===o&&(o=!1),e!==y.reactGrid.ISMARKED_NAME||this.parent&&this.parent.UseReactGrid){var a=this._getProperty(e),s=a();if(s!==t){if(this.parent&&this.parent.UseReactGrid){var l=void 0,u="",d="",c=!1;if(n&&y.reactGrid.GroupingManager.flightEnabled()){if(c=(d=g.getCollectionName(y.value(this.parent.masterDataSourceName)))===this.collectionName)u=this.getValue(y.reactGrid.PARENT_GROUP_KEY);else{var p=this.getRelated(d,this.collectionIndex);p&&(u=p.getValue(y.reactGrid.PARENT_GROUP_KEY))}n&&d&&u&&(l=y.reactGrid.GroupingManager.getGroup(n,d,u))}if(e===y.reactGrid.ISMARKED_NAME){var h=y.util.stringToBoolean(t);if(void 0!==s||h){var m=h?1:-1;y.setValue(this.parent,"markedCount",y.value(this.parent.markedCount)+m),null!==(i=this.parent.fieldsWithTotals)&&void 0!==i&&i.length&&this.parent.fieldsWithTotals.forEach(function(e){var t=r.getValue(e);void 0!==t&&(h||(t*=-1),r.parent._addMarkedFieldTotal(e,t),r.parent._updateMarkedFieldMinMax(e,t,h))}),l&&c&&y.reactGrid.GroupingManager.adjustMarkedCountForHierarchy(n,d,u,m)}}else if(this.parent.fieldsWithTotals&&0<=this.parent.fieldsWithTotals.indexOf(e)){var v=void 0===s?t:t-s;this.parent._addFieldTotal(e,v),this.parent._updateFieldMinMax(e,t),void 0!==s&&this.parent._updateFieldMinMaxOnDelete(e,s),l&&(y.reactGrid.GroupingManager.addFieldTotalForHierarchy(n,d,u,this.collectionName,e,v),y.reactGrid.GroupingManager.updateFieldMinMaxForHierarchy(n,d,u,this.collectionName,e,t)),this.isMarked&&(this.parent._addMarkedFieldTotal(e,v),this.parent._updateMarkedFieldMinMax(e,t,!0),void 0!==s&&this.parent._updateMarkedFieldMinMax(a,s,!1))}}a(t),this._propertyChangedHost&&this.addChange(),o&&void 0!==this.masterTrackingId&&y.serverForm.ModelManager.modelVersions[n]&&(y.serverForm.ModelManager.modelVersions[n][this.masterTrackingId]=y.serverForm.ModelManager.getLastVersion()),!this.parent||this.parent._pendingCollectionChange&&!o||this.parent.addChange({collectionIndex:this.collectionIndex,modelId:this.id,propertyName:e})}}else this.parent&&void 0!==this.collectionIndex&&this.parent.setMarked(this.collectionIndex,"true"===t)},t.prototype.deserialize=function(e,t){var o=this;if(e){y.debug.general&&(this.dynPrevDescriptors||(this.dynPrevDescriptors=[]),this.dynPrevDescriptors.push(e));var n=this.parent&&this.parent.UseReactGrid;this.id=e.Id;var i=!0;if(e.Properties&&void 0!==e.Properties.MasterTrackingId&&null!==e.Properties.MasterTrackingId&&(y.serverForm.ModelManager.isValidTrackingId(e.Properties.MasterTrackingId)||(e.Properties.MasterTrackingId=y.serverForm.ModelManager.generateValidTrackingId()),e.Properties.MasterTrackingId!==this.masterTrackingId&&(n||(i=!1),this.masterTrackingId=e.Properties.MasterTrackingId,y.serverForm.ModelManager.modelVersions[t]||(y.serverForm.ModelManager.modelVersions[t]={}),y.serverForm.ModelManager.modelVersions[t][this.masterTrackingId]=y.serverForm.ModelManager.getLastVersion())),y.serverForm.ModelManager.trackModel(this,t),e.Name&&(this.collectionName=y.serverForm.getCollectionName(e.Name)),e.Properties)for(var r in e.Properties){var a=e.Properties[r];r=y.serverForm.getPropertyName(r),n&&r===y.reactGrid.ISMARKED_NAME&&y.value(this.parent.clientMarking)?(this.serverMarkingValue=y.util.stringToBoolean(a),this.clientMarkingObserver||(this.clientMarkingObserver=y.observe(this.parent.clientMarking,function(e){if(!e)return o.serverMarkingValue!==o.isMarked&&(o.isMarked=o.serverMarkingValue),o.clientMarkingObserver=void 0,!1},this,void 0,!0))):this.setValue(r,a,i,t)}if(this.collectionName&&this.collectionName.endsWith("_form")&&void 0===this.getValue("UseReactGrid")){var s=y.util.isFlightEnabled(y.reactGrid.featureName)&&e.Properties&&"1"!==e.Properties.ForceLegacyGrid;this.setValue("UseReactGrid",s,!1,t)}if(e.ChildModelCollections)for(var r in this._relatedCollections||(this._relatedCollections={}),e.ChildModelCollections){var l=e.ChildModelCollections[r];r=y.serverForm.getCollectionName(r),l.Name=r,this.getRelatedCollection(r).deserialize(l,t)}}},t.prototype.getRelated=function(e,t){if(e===this.collectionName)return this;if(this.parent)return y.value(this.parent.getRelated(e,void 0!==t?t:this.collectionIndex));var o=y.value(this.getRelatedCollection(e));if(o){if(void 0!==t)return t<0||t>=o.items().length?o.valuesIfEmpty():o.items()[t];if(o.UseReactGrid){var n=y.value(o.internalActiveMasterTrackingId);if(n){var i=o.name+"_"+n;return g.ModelManager.getModel(i,this._formId)}return o.valuesIfEmpty()}var r=y.value(o.selectedIndex);return r<0||r>=o.items().length?o.activeRecordModel()?o.activeRecordModel():o.valuesIfEmpty():o.items()[r]}},t.prototype.getRelatedCollection=function(e){this._relatedCollections||(this._relatedCollections={});var t=this._relatedCollections[e];if(!t){if(this.parent)return this.parent.getRelatedCollection(e);t=this._relatedCollections[e]=new g.ModelCollection(this,e)}return t},t.prototype.getVersion=function(){return void 0!==this.masterTrackingId&&void 0!==this._formId&&g.ModelManager.modelVersions[this._formId]&&void 0!==g.ModelManager.modelVersions[this._formId][this.masterTrackingId]?g.ModelManager.modelVersions[this._formId][this.masterTrackingId]:-1},t.prototype._getProperty=function(e,t){var o=this._properties[e];return o||((o=this._properties[e]=y.observable(t)).__modelField=e),o},t.prototype.addChange=function(){y.serverForm.UpdateModelManager.pushModelChange(this.id)},t);function t(e){var t=this;this.parent=e,this.propertyChanged=function(){return t._propertyChangedHost||(t._propertyChangedHost=new y.eventHost),t._propertyChangedHost},this._properties={},this.rowIndex=-1}g.Model=e,Object.defineProperty(e.prototype,"collectionIndex",{enumerable:!0})}(y.serverForm||(y.serverForm={}))}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=this&&this.__read||function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,i,r=o.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=r.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(o=r.return)&&o.call(r)}finally{if(i)throw i.error}}return a},__spreadArray=this&&this.__spreadArray||function(e,t,o){if(o||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||((n=n||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))};!function(Z){!function(Y){function E(e){if(e){var t=e.lastIndexOf("_ds");if(-1!==t)return e.substr(0,t)}return e}Y.getCollectionName=E,Y.isModelCollection=function(e){return!(!e||!e.items)};var e=(t.prototype.setMarked=function(e,t){var o=this;this.markedIndexes()[e]!==t&&(this._markedChanging||(Z.async(function(){o.markedIndexes(o.markedIndexes().slice(0)),o._markedChanging=!1},0,"Marked indexes changed"),this._markedChanging=!0),this.markedIndexes()[e]=t)},t.prototype.addChange=function(e){void 0!==e.collectionIndex&&Y.UpdateModelManager.pushModelCollectionChange(this.id)},t.prototype.getRelated=function(e,t){if(this.parent&&this.parent.getRelated)return this.parent.getRelated(e,t)},t.prototype.getRelatedCollection=function(e){if(this.parent&&this.parent.getRelatedCollection)return this.parent.getRelatedCollection(e)},t.prototype.mergeModelUpdates=function(e,t){var o,n,i,r,a,s;if(e&&t&&!(Object.keys(t).length<=0)&&this.UseReactGrid)if(e.SpliceOperations&&e.SpliceOperations.length){for(var l=0,u=e.SpliceOperations.length;l<u;l++)for(var d=e.SpliceOperations[l],c=d.Insert?d.Insert.length:0,p=0;p<c;p++)if(t[d.Insert[p].Id]){var h=null===(o=d.Insert[p].Item.Properties)||void 0===o?void 0:o.MasterTrackingId,m=null===(n=t[d.Insert[p].Id].Descriptor.Properties)||void 0===n?void 0:n.MasterTrackingId;(v=null===(i=t[d.Insert[p].Id].Descriptor.Properties)||void 0===i?void 0:i.dataSourceName_internal)&&v!==e.Name||h&&h!==m||(d.Insert[p].Item=t[d.Insert[p].Id].Descriptor,delete t[d.Insert[p].Id],Z.log.reactList&&Z.log.reactList("merged update model interaction with splice operation (Id: %s)",d.Insert[p].Id))}}else if(e.Items&&e.Items.length)for(l=0,u=e.Items.length;l<u;l++)if(t[e.Items[l].Id]){var v,g=null===(r=e.Items[l].Item.Properties)||void 0===r?void 0:r.MasterTrackingId;m=null===(a=t[e.Items[l].Id].Descriptor.Properties)||void 0===a?void 0:a.MasterTrackingId,(v=null===(s=t[e.Items[l].Id].Descriptor.Properties)||void 0===s?void 0:s.dataSourceName_internal)&&v!==e.Name||g&&g!==m||(e.Items[l].Item=t[e.Items[l].Id].Descriptor,delete t[e.Items[l].Id],Z.log.reactList&&Z.log.reactList("merged update model interaction with data item (Id: %s)",e.Items[l].Id))}},t.prototype.mergeExtraModelUpdates=function(e,t){var o,n,i,r,a,s;if(e&&t&&!(Object.keys(t).length<=0)&&this.UseReactGrid)if(e.SpliceOperations&&e.SpliceOperations.length){for(var l=0,u=e.SpliceOperations.length;l<u;l++)for(var d=e.SpliceOperations[l],c=d.Insert?d.Insert.length:0,p=0;p<c;p++)for(var h in t)if(t[h]){var m=t[h],v=null===(o=d.Insert[p].Item.Properties)||void 0===o?void 0:o.MasterTrackingId,g=null===(n=m.Descriptor.Properties)||void 0===n?void 0:n.dataSourceName_internal,y=null===(i=m.Descriptor.Properties)||void 0===i?void 0:i.MasterTrackingId;if(g&&e.Name===g&&y&&v===y){for(var f in m.Descriptor.Properties)"masterTrackingId"!==f&&void 0===d.Insert[p].Item.Properties[f]&&(d.Insert[p].Item.Properties[f]=m.Descriptor.Properties[f]);delete t[h],Z.log.reactList&&Z.log.reactList("merged extra update model interaction with splice operation (Id: %s, MasterTrackingId: %s)",h,y)}}}else if(e.Items&&e.Items.length)for(l=0,u=e.Items.length;l<u;l++)for(var h in t)if(t[h]){m=t[h];var b=null===(r=e.Items[l].Item.Properties)||void 0===r?void 0:r.MasterTrackingId;if(g=null===(a=m.Descriptor.Properties)||void 0===a?void 0:a.dataSourceName_internal,y=null===(s=m.Descriptor.Properties)||void 0===s?void 0:s.MasterTrackingId,g&&e.Name===g&&y&&b===y){for(var f in m.Descriptor.Properties)"masterTrackingId"!==f&&void 0===e.Items[l].Item.Properties[f]&&(e.Items[l].Item.Properties[f]=m.Descriptor.Properties[f]);delete t[h],Z.log.reactList&&Z.log.reactList("merged extra update model interaction with data item (Id: %s, MasterTrackingId: %s)",h,y)}}},t.prototype._addFieldTotal=function(e,t){var o=this.totals[e];o||(o=new ControlLibrary.BigNumber({initialValue:0}),this.totals[e]=o),o.add(t),this.totalsVersion++},t.prototype._addMarkedFieldTotal=function(e,t){if(null!=t&&0!==t){var o=this.markedTotals[e];o||(o=new ControlLibrary.BigNumber({initialValue:0}),this.markedTotals[e]=o),o.add(t),this.markedTotalsVersion++}},t.prototype._updateMarkedFieldMinMax=function(e,t,o,n){var i=this;if(void 0===n&&(n=!1),Z.controls.ReactList.extendedAggregationEnabled()&&null!=t){var r=new ControlLibrary.BigNumber({initialValue:t});if(o){var a="".concat(e,"_").concat("Max"),s=!1;(u=this.markedTotals[a])&&1!==r.CompareToBigNumber(u)||(this.markedTotals[a]=r,s=!0);var l="".concat(e,"_").concat("Min");(d=this.markedTotals[l])&&1!==d.CompareToBigNumber(r)||(this.markedTotals[l]=r,s=!0),s&&!n&&this.markedTotalsVersion++}else{a="".concat(e,"_").concat("Max");var u=this.markedTotals[a],d=(l="".concat(e,"_").concat("Min"),this.markedTotals[l]);0!==(null==u?void 0:u.CompareToBigNumber(r))&&0!==(null==d?void 0:d.CompareToBigNumber(r))||(this.fieldsToCalculateMinMax[e]=!0,this.addedFieldMinMaxCalcAction||(this.addPostUpdateAction(function(){i.clearExistingMinMaxOnUnMark(),i.calculateNewMinMaxOnUnMark(),i.fieldsToCalculateMinMax={},i.addedFieldMinMaxCalcAction=!1}),this.addedFieldMinMaxCalcAction=!0))}}},t.prototype._updateFieldMinMax=function(e,t,o){if(void 0===o&&(o=!1),Z.controls.ReactList.extendedAggregationEnabled()){var n=new ControlLibrary.BigNumber({initialValue:t}),i=!1,r="".concat(e,"_").concat("Max"),a=this.totals[r];a&&1!==n.CompareToBigNumber(a)||(this.totals[r]=n,i=!0);var s="".concat(e,"_").concat("Min"),l=this.totals[s];l&&1!==l.CompareToBigNumber(n)||(this.totals[s]=n,i=!0),i&&!o&&this.totalsVersion++}},t.prototype.deserialize=function(V,H){var G,z,U=this;if(V){if(Z.debug.general&&(this.dynPrevDescriptors||(this.dynPrevDescriptors=[]),this.dynPrevDescriptors.push(V)),this.id=V.Id,Y.ModelManager.trackModelCollection(this,H),V.Name&&(this.name=E(V.Name)),void 0!==V.MasterDataSourceName&&null!==V.MasterDataSourceName&&V.MasterDataSourceName!==Z.value(this.masterDataSourceName)&&(this.masterDataSourceName(V.MasterDataSourceName),this.name!==E(V.MasterDataSourceName)&&Y.ModelManager.trackChildCollection(V.MasterDataSourceName,H,this.id)),V.ValuesIfEmpty&&(this.UseReactGrid?V.ValuesIfEmpty.Item&&V.ValuesIfEmpty.Item.Properties&&(V.ValuesIfEmpty.Item.Properties.MasterTrackingId="valuesIfEmpty",this.valuesIfEmpty(this.deserializeModel(V.ValuesIfEmpty,-1,H))):this.valuesIfEmpty(this.deserializeModel(V.ValuesIfEmpty,0,H))),void 0!==V.FetchedDataStartPosition&&null!==V.FetchedDataStartPosition&&this.FetchedDataStartPosition(V.FetchedDataStartPosition),this.UseReactGrid&&V.FieldsWithTotals&&this.rawFieldsWithTotals!==V.FieldsWithTotals)try{this.fieldsWithTotals=JSON.parse(V.FieldsWithTotals),this.rawFieldsWithTotals=V.FieldsWithTotals}catch(e){}var W=!1;if(V.SpliceOperations){if(0<V.SpliceOperations.length)if(this._pendingCollectionChange=!0,this.UseReactGrid&&"ClientMessageLog"!==this.name)for(var K=Z.reactGrid.GroupingManager.flightEnabled(),q=E(Z.value(this.masterDataSourceName)),j=q===this.name,e=function(e,t){var o,n,i,r,a=V.SpliceOperations[e];if(a.ClearCache){if(Q.clearModels(H),!1===a.FastFetch&&null!==(z=null===(G=Z.DataCacheManager)||void 0===G?void 0:G[H])&&void 0!==z&&z[Q.name]){var s=Object.keys(Z.DataCacheManager[H][Q.name]);0<s.length&&Z.DataCacheManager[H][Q.name][s[0]].turnOffFastFetch()}W=!0}else if(void 0!==a.MarkAll){if(Q.RowsMarkedByDefault(a.MarkAll),!Z.value(Q.clientMarking)){var l=Z.value(Q.items);try{for(var u=(o=void 0,__values(l)),d=u.next();!d.done;d=u.next())(D=d.value).isMarked=a.MarkAll}catch(e){o={error:e}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(o)throw o.error}}}}else{var c=a.Insert?a.Insert.length:0;if(0<c){var p=0,h=!1,m=void 0,v=a.Insert[0];if(v.Item.Properties.previous_MasterTrackingId){var g=Q.name+"_"+v.Item.Properties.previous_MasterTrackingId;m=Y.ModelManager.getModel(g,H)}var y=void 0,f=a.Insert[a.Insert.length-1];if(f.Item.Properties.next_MasterTrackingId){var b=Q.name+"_"+f.Item.Properties.next_MasterTrackingId;y=Y.ModelManager.getModel(b,H)}if(m)p=Z.value(m.collectionIndex)+1,y||(h=!0);else if(!y){var C=Q.name+"_"+v.Item.Properties.MasterTrackingId,w=Y.ModelManager.getModel(C,H),_=Q.name+"_"+f.Item.Properties.MasterTrackingId,S=Y.ModelManager.getModel(_,H);w?(p=Z.value(w.collectionIndex),S||(h=!0)):S||W||(Q.clearModels(H),W=!0)}h||(Y.ModelManager.insertedRecordsAbove=!0,Y.ModelManager.activeRootId=H);for(var I=!1,T=[],x=0;x<c;x++){var F=a.Insert[x];if(F.Item.Properties.MasterTrackingId){var k=Q.name+"_"+F.Item.Properties.MasterTrackingId;(D=Y.ModelManager.getModel(k,H))?(Q.deserializeModel(F,x+p,H),0<T.length&&Z.isObservableArray(Q.items)&&((i=Q.items).splice.apply(i,__spreadArray([T[0].collectionIndex,0],__read(T),!1)),I=!0,T=[])):T.push(Q.deserializeModel(F,x+p,H))}else Z.log.reactList&&Z.log.reactList("splice insert with no master tracking id: "+F.Id)}if(0<T.length&&Z.isObservableArray(Q.items)){if((r=Q.items).splice.apply(r,__spreadArray([T[0].collectionIndex,0],__read(T),!1)),I=!0,h){var P=T[T.length-1].collectionIndex;if(P<Z.length(Q.items)-1)for(x=P+1;x<Z.length(Q.items);x++)Z.value(Q.items)[x].collectionIndex=x;if(K&&j){var R="",M=T[0].collectionIndex-1;if(0<=M&&H&&q){var E=Q.items()[M];E&&(R=E.getValue(Z.reactGrid.PARENT_GROUP_KEY))}var N=T.slice();Q.addPostUpdateAction(function(){Z.reactGrid.GroupingManager.addNewRowsToGroupingManger(H,q,N,R)})}}T=[]}if(I&&!h){var A=Z.length(Q.items);for(x=c+p;x<A;x++)Z.value(Q.items)[x].collectionIndex=x;K&&j&&H&&q&&Q.addPostUpdateAction(function(){Z.reactGrid.GroupingManager.updateHeadersAndRerender(H,q)})}}else if(!W&&0<a.Delete&&a.MasterTrackingIndex){var D;if(k=Q.name+"_"+a.MasterTrackingIndex,D=Y.ModelManager.getModel(k,H)){var L=D.collectionIndex;if(D.isSelected&&(D.isSelected=!1),Z.isObservableArray(Q.items)){var O=Q.items.splice(L,a.Delete);for(x=L;x<Z.length(Q.items);x++)Z.value(Q.items)[x].collectionIndex=x;if(O&&O.length){var B=-1,$=0;O.forEach(function(l){var u="";if(H&&q&&K&&(u=l.getValue(Z.reactGrid.PARENT_GROUP_KEY)),U.fieldsWithTotals&&U.fieldsWithTotals.length&&U.fieldsWithTotals.forEach(function(e){var t,o,n=l.getValue(e);if(null!=n&&""!==n){if(U._updateFieldMinMaxOnDelete(e,n),u&&Z.controls.ReactList.extendedAggregationEnabled()){var i=Z.reactGrid.GroupingManager.isFieldMinMaxForHierarchy(H,q,u,U.name,e,n);if(0<(null==i?void 0:i.length)){try{for(var r=(t=void 0,__values(i)),a=r.next();!a.done;a=r.next()){var s=a.value;U.groupsToCalculateMinMax[s]||(U.groupsToCalculateMinMax[s]=[]),U.groupsToCalculateMinMax[s].push(e)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}U.addedGroupMinMaxCalcAction||(U.addPostUpdateAction(function(){Z.reactGrid.GroupingManager.calculateMinMax(H,q,U.name,U.groupsToCalculateMinMax),U.groupsToCalculateMinMax={},U.addedGroupMinMaxCalcAction=!1}),U.addedGroupMinMaxCalcAction=!0)}}0!==n&&(n*=-1,U._addFieldTotal(e,n),l.isMarked&&U._addMarkedFieldTotal(e,n),u&&Z.reactGrid.GroupingManager.addFieldTotalForHierarchy(H,q,u,U.name,e,n))}}),l.isMarked&&(Z.setValue(U,"markedCount",Z.value(U.markedCount)-1),u&&j&&Z.reactGrid.GroupingManager.adjustMarkedCountForHierarchy(H,q,u,-1)),j&&K){if(u){var e=Z.reactGrid.GroupingManager.removeFromGroup(H,q,u,l.masterTrackingId,l.getValue("previous_MasterTrackingId"),l.getValue("next_MasterTrackingId"));e&&0<=e.firstIndex&&0<e.deleteCount&&((-1===B||e.firstIndex<B)&&(B=e.firstIndex),$+=e.deleteCount)}-1!==l.rowIndex&&((-1===B||l.rowIndex<B)&&(B=l.rowIndex),$++)}var t=l.getValue("recId_internal");t&&U.recIdToTrackingId[t]&&delete U.recIdToTrackingId[t];var o=U.name+"_"+l.masterTrackingId;Y.ModelManager.deleteModel(o,H)}),K&&j&&0<=B&&0<$&&Z.reactGrid.GroupingManager.removeRowsFromGroupingManager(H,q,B,$)}}}}}},Q=this,t=0,o=V.SpliceOperations.length;t<o;t++)e(t);else{var n=Z.value(this.items).slice(0);for(t=0,o=V.SpliceOperations.length;t<o;t++){var i=V.SpliceOperations[t];if(!i.MasterTrackingIndex)if(void 0!==i.Delete&&null!==i.Delete&&void 0!==i.Index&&null!==i.Index){for(var r=i.Insert?i.Insert.length:0,a=[i.Index,i.Delete],s=Array.prototype.slice.call(a,0),l=0;l<r;l++)s.push(!1);var u=Z.value(this.markedIndexes);Array.prototype.splice.apply(u,s);for(var d=0;d<r;d++)a.push(this.deserializeModel(i.Insert[d],d+i.Index,H));Array.prototype.splice.apply(n,a),this.markedIndexes(u),this.markedIndexes.valueChanged.raise()}else Z.logWarning("Unexpected ModelCollection splice operation descriptor format: %o",i)}var c=0,p=V.SpliceOperations[0];for(p&&void 0!==p.Index&&null!==p.Index&&(c=p.Index),t=c,o=n.length;t<o;t++)n[t].collectionIndex=t;this.items(n)}}else if(V.Items){this._pendingCollectionChange=!0;var h=[],m=this.name.endsWith("_lvds"),v=this.name.endsWith("_tableds_");for(t=0,o=V.Items.length;t<o;t++)if(!this.UseReactGrid||m||v||"ClientMessageLog"===this.name)h.push(this.deserializeModel(V.Items[t],t,H));else if(V.Items[t].Item.Properties.MasterTrackingId){var g=this.name+"_"+V.Items[t].Item.Properties.MasterTrackingId,y=!!Y.ModelManager.getModel(g,H),f=this.deserializeModel(V.Items[t],y?void 0:h.length,H);y||h.push(f)}else Z.log.reactList&&Z.log.reactList("Item without master tracking id: "+V.Items[t].Id);if(!this.UseReactGrid||m||v)this.items(h);else if(h.length)if(0===Z.length(this.items))this.items(h);else{var b=!1,C=!1,w=Z.length(this.items),_=0;if(Y.ModelManager.lastRequestedLoadDirection===Z.ui.ScrollDirection.up)b=!0;else if(Y.ModelManager.lastRequestedLoadDirection===Z.ui.ScrollDirection.none){var S=h[0].getValue("previous_MasterTrackingId"),I=h[h.length-1].getValue("next_MasterTrackingId");if(I===this.items()[0].masterTrackingId)b=!0;else if(S!==this.items()[w-1].masterTrackingId){var T=S&&Y.ModelManager.getModel(this.name+"_"+S,H);T&&-1!==T.collectionIndex&&(C=!0,_=T.collectionIndex+1,Z.log.reactList&&(I&&Y.ModelManager.getModel(this.name+"_"+I,H)||Z.log.reactList("Unexpected scenario of updating items collection. Next model not found in cache.")))}}var x=Z.value(this.items);for(b?(_=h.length,this.items(h.concat(x))):C?(x.splice.apply(x,__spreadArray([_,0],__read(h),!1)),this.items(x)):(_=x.length,this.items(x.concat(h))),t=_;t<Z.length(this.items);t++)Z.value(this.items)[t].collectionIndex=t}}if(void 0===V.ActiveRecordIndex||null===V.ActiveRecordIndex||this.UseReactGrid&&-1!==Z.value(this.selectedIndex)&&Z.value(this.clientMarking)||this.selectedIndex(V.ActiveRecordIndex),V.ActiveRecordModel&&(V.ActiveRecordModel.length&&!this.UseReactGrid?this.activeRecordModel(this.deserializeModel(V.ActiveRecordModel[0],void 0,H)):this.activeRecordModel(null)),void 0!==V.IsLastPage&&null!==V.IsLastPage&&this.hasNextPage(!V.IsLastPage),void 0!==V.CurrentPageIndex&&null!==V.CurrentPageIndex&&this.pageIndex(V.CurrentPageIndex),void 0!==V.ClientPageSize&&null!==V.ClientPageSize&&this.clientPageSize(V.ClientPageSize),void 0!==V.CacheSize&&null!==V.CacheSize&&this.CacheSize(V.CacheSize),void 0!==V.DataAbove&&null!==V.DataAbove&&this.DataAbove(!!V.DataAbove),void 0!==V.DataBelow&&null!==V.DataBelow&&this.DataBelow(!!V.DataBelow),void 0!==V.IsDirty&&null!==V.IsDirty&&(this.IsDirty=V.IsDirty),void 0!==V.IsCrossCompany&&null!==V.IsCrossCompany&&(this.IsCrossCompany=V.IsCrossCompany),this.UseReactGrid){var F=Z.value(this.internalActiveMasterTrackingId),k=F&&0<parseInt(F,10),P=!1,R="";if(W&&k&&this.activeRowRecId){var M=this.recIdToTrackingId[this.activeRowRecId];P=!0,M?R=M:F=""}V.ActiveMasterTrackingId?("0"===V.ActiveMasterTrackingId&&(V.ActiveMasterTrackingId=""),this.activeRecord_mastertrackingid(V.ActiveMasterTrackingId),""!==F&&Z.value(this.clientMarking)||(P=!0,R=V.ActiveMasterTrackingId)):W&&this.activeRecord_mastertrackingid(""),P&&this.internalActiveMasterTrackingId(R)}}},t.prototype.deserializeModel=function(e,t,o){if(e){var n,i=e.Id;return e.Id&&(n=Y.ModelManager.getModel(i,o)),e.Item?(n||(i=e.Item.Id,this.UseReactGrid&&e.Item.Properties.MasterTrackingId&&(i=this.name+"_"+e.Item.Properties.MasterTrackingId,e.Item.Properties.recId_internal&&(this.recIdToTrackingId[e.Item.Properties.recId_internal]=e.Item.Properties.MasterTrackingId)),n=(n=Y.ModelManager.getModel(i,o))||new Y.Model(this)),void 0!==t&&(n.collectionIndex=t),n.collectionName=this.name,n.deserialize(e.Item,o),n.parent=this):void 0!==n.CollectionIndex&&(n.collectionIndex=n.CollectionIndex),n}},t.prototype.generateClientTrackingId=function(){return this.clientCreatedTrackingId--,this.clientCreatedTrackingId},t.prototype.executePostUpdateActions=function(){var t,e;if(this.postUpdateActions&&0<this.postUpdateActions.length){try{for(var o=__values(this.postUpdateActions),n=o.next();!n.done;n=o.next())(0,n.value)()}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this.postUpdateActions=[]}},t.prototype.addPostUpdateAction=function(e){this.postUpdateActions||(this.postUpdateActions=[]),e&&(this.postUpdateActions.push(e),Y.UpdateModelManager.pushPostUpdateModelCollectionChange(this.id))},t.prototype.getTrackingIdByRecId=function(e){var t;return null!==(t=this.recIdToTrackingId[e])&&void 0!==t?t:""},t.prototype._updateFieldMinMaxOnDelete=function(e,t){var o=this;if(Z.controls.ReactList.extendedAggregationEnabled()){var n=new ControlLibrary.BigNumber({initialValue:t}),i="".concat(e,"_").concat("Max"),r=this.totals[i],a="".concat(e,"_").concat("Min"),s=this.totals[a];0!==(null==r?void 0:r.CompareToBigNumber(n))&&0!==(null==s?void 0:s.CompareToBigNumber(n))||(this.fieldsToCalculateMinMax[e]=!0,this.addedFieldMinMaxCalcAction||(this.addPostUpdateAction(function(){o.clearExistingMinMax(),o.calculateNewMinMax(),o.fieldsToCalculateMinMax={},o.addedFieldMinMaxCalcAction=!1}),this.addedFieldMinMaxCalcAction=!0))}},t.prototype.clearModels=function(e){for(var t=-1,o=0;o<Z.length(this.items);o++){var n=this.items()[o];if(n&&n.masterTrackingId&&parseInt(n.masterTrackingId,10)<0){t=o;break}var i=this.name+"_"+n.masterTrackingId,r=Y.ModelManager.models[e];!Y.isModel(r)&&r[i]&&delete r[i]}Z.isObservableArray(this.items)&&(-1<t?this.items.splice(0,t):this.items.clear()),Z.log.reactList&&Z.log.reactList("Cache cleared for "+this.name+" on form "+e),this.recIdToTrackingId={},this.totals={},this.totalsVersion=0,this.markedTotals={},this.markedTotalsVersion=0,Z.setValue(this,"markedCount",0),this.onClear.raise()},t.prototype.clearExistingMinMax=function(){if(Z.controls.ReactList.extendedAggregationEnabled())for(var e in this.fieldsToCalculateMinMax)if(this.fieldsToCalculateMinMax[e]){var t="".concat(e,"_").concat("Max"),o="".concat(e,"_").concat("Min");this.totals[t]&&delete this.totals[t],this.totals[o]&&delete this.totals[o]}},t.prototype.calculateNewMinMax=function(){if(Z.controls.ReactList.extendedAggregationEnabled()){for(var e=0,t=Z.length(this.items);e<t;e++)for(var o in this.fieldsToCalculateMinMax)this.fieldsToCalculateMinMax[o]&&this._updateFieldMinMax(o,Z.value(this.items)[e].getValue(o),!0);this.totalsVersion++}},t.prototype.clearExistingMinMaxOnUnMark=function(){if(Z.controls.ReactList.extendedAggregationEnabled())for(var e in this.fieldsToCalculateMinMax)if(this.fieldsToCalculateMinMax[e]){var t="".concat(e,"_").concat("Max"),o="".concat(e,"_").concat("Min");this.markedTotals[t]&&delete this.markedTotals[t],this.markedTotals[o]&&delete this.markedTotals[o]}},t.prototype.calculateNewMinMaxOnUnMark=function(){if(Z.controls.ReactList.extendedAggregationEnabled()){for(var e=0,t=Z.length(this.items);e<t;e++)if(Z.value(this.items)[e].isMarked)for(var o in this.fieldsToCalculateMinMax)this.fieldsToCalculateMinMax[o]&&this._updateMarkedFieldMinMax(o,Z.value(this.items)[e].getValue(o),!0,!0);this.markedTotalsVersion++}},t);function t(e,t){var n=this;this.parent=e,this.itemsChanged=function(){return n._itemsChangedHost||(n._itemsChangedHost=new Z.eventHost),n._itemsChangedHost},this.name=t,this.UseReactGrid=e&&e.getValue("UseReactGrid"),this.selectedIndex=Z.observable(-1),this.hasNextPage=Z.observable(!1),this.pageIndex=Z.observable(0),this.CacheSize=Z.observable(0),this.FetchedDataStartPosition=Z.observable(0),this.DataAbove=Z.observable(!1),this.DataBelow=Z.observable(!1),this.RowsMarkedByDefault=Z.observable(!1),this.valuesIfEmpty=Z.observable(),this.activeRecordModel=Z.observable(),this.clientPageSize=Z.observable(25),this.masterDataSourceName=Z.observable(),this.markedIndexes=Z.observable([]),this.IsDirty=!1,this.IsCrossCompany=!1,this.UseReactGrid?(this.items=Z.observableArray([]),this.activeRecord_mastertrackingid=Z.observable(""),this.internalActiveMasterTrackingId=Z.observable(""),this.activeDataRowTrackingId=Z.observable(""),this.clientCreatedTrackingId=0,this.numberOfClientRows=0,this.clientGridSizeLimited=!1,this.totals={},this.totalsVersion=0,this.markedTotals={},this.markedTotalsVersion=0,this.markedCount=Z.observable(0),this.clientMarking=Z.observable(!1),this.onClear=new Z.eventHost,this.fieldsToCalculateMinMax={},this.groupsToCalculateMinMax={},this.addedFieldMinMaxCalcAction=!1,this.addedGroupMinMaxCalcAction=!1,this.recIdToTrackingId={},Z.observe(this.internalActiveMasterTrackingId,function(e){if(e&&!e.startsWith(Z.reactGrid.GROUP_HEADER_PREFIX)){n.activeDataRowTrackingId(e);var t=n.name+"_"+e,o=Z.serverForm.ModelManager.getModel(t,n._formId);n.activeRowRecId=o?o.getValue("recId_internal"):""}else n.activeRowRecId=""})):this.items=Z.observable([])}Y.ModelCollection=e}(Z.serverForm||(Z.serverForm={}))}($dyn=$dyn||{}),function(e){var s,l;s=e.serverForm||(e.serverForm={}),(l=s.ModelManager||(s.ModelManager={})).models={},l.collections={},l.masterToChildCollectionIds={},l.lastRequestedLoadDirection=e.ui.ScrollDirection.none,l.lastReceivedLoadDirection=e.ui.ScrollDirection.none,l.activeRootId="",l.modelVersions={},l.nextId=0,l.insertedRecordsAbove=!1,l._validTrackingIdCounter=1,l._validTrackingIdPrefix="_trackingId_",l.version=1,l.trackModel=function(e,t){if(e){e.id||(e.id=(l.nextId++).toString());var o=e.id;if(t){l.models[t]||(l.models[t]={}),e._formId=t,e.parent&&e.parent.UseReactGrid&&e.masterTrackingId&&(o=e.collectionName+"_"+e.masterTrackingId);var n=l.models[t];s.isModel(n)||(n[o]=e)}else l.models[e.id]=e}},l.trackModelCollection=function(e,t){if(e)if(e.id||(e.id=(l.nextId++).toString()),t){l.collections[t]||(l.collections[t]={}),e._formId=t;var o=l.collections[t];s.isModelCollection(o)||(o[e.id]=e)}else l.collections[e.id]=e},l.getChildCollectionIds=function(e,t){if(l.masterToChildCollectionIds&&l.masterToChildCollectionIds[t]&&l.masterToChildCollectionIds[t][e])return l.masterToChildCollectionIds[t][e]},l.trackChildCollection=function(e,t,o){e&&t&&o&&(l.masterToChildCollectionIds[t]||(l.masterToChildCollectionIds[t]={}),l.masterToChildCollectionIds[t][e]||(l.masterToChildCollectionIds[t][e]=[]),l.masterToChildCollectionIds[t][e].push(o))},l.getModel=function(e,t){if(e){if(s.isModel(l.models[e]))return l.models[e];if(t){if((i=l.models[t])&&!s.isModel(i))return i[e]}else for(var o=Object.keys(l.models),n=o.length-1;0<=n;n--){var i;if((i=l.models[o[n]])&&!s.isModel(i)&&i[e])return i[e]}}},l.getModelCollection=function(e,t){if(e){if(s.isModelCollection(l.collections[e]))return l.collections[e];if(t){if((i=l.collections[t])&&!s.isModelCollection(i))return i[e]}else for(var o=Object.keys(l.collections),n=o.length-1;0<=n;n--){var i;if((i=l.collections[o[n]])&&!s.isModelCollection(i)&&i[e])return i[e]}}},l.deleteModel=function(e,t){var o=l.models[t];return!(!o||!o[e])&&(delete o[e],!0)},l.removeFormModelsAndCollections=function(e){var t=l.models[e];if(t){for(var o in t){var n=t[o];n&&n._propertyChangedHost&&n._propertyChangedHost.clear()}delete l.models[e]}var i=l.collections[e];if(!s.isModelCollection(i))for(var r in i)if(i[r]){var a=i[r];a._itemsChangedHost&&a._itemsChangedHost.clear(),a.onClear&&a.onClear.clear()}delete l.collections[e],delete l.modelVersions[e],delete l.masterToChildCollectionIds[e]},l._updateVersion=function(){l.version++},l.getLastVersion=function(){return l.version},l.isValidTrackingId=function(e){return e&&"0"!==e},l.generateValidTrackingId=function(){var e=l._validTrackingIdPrefix+l._validTrackingIdCounter;return l._validTrackingIdCounter++,e}}($dyn=$dyn||{}),function(i){var r,a;r=i.serverForm||(i.serverForm={}),(a=r.UpdateModelManager||(r.UpdateModelManager={}))._collectionChanges={},a._modelChanges={},a._postUpdateModelCollectionChanges={},a.pushModelCollectionChange=function(e){void 0===a._collectionChanges&&(a._collectionChanges={}),e&&(a._collectionChanges[e]=!0)},a.pushModelChange=function(e){void 0===a._modelChanges&&(a._modelChanges={}),e&&(a._modelChanges[e]=!0)},a.pushPostUpdateModelCollectionChange=function(e){void 0===a._postUpdateModelCollectionChanges&&(a._postUpdateModelCollectionChanges={}),e&&(a._postUpdateModelCollectionChanges[e]=!0)},a.raiseChanges=function(){for(var e in i.log.server&&i.log.server("ServerForm: Changes to model collections %o",a._collectionChanges),a._collectionChanges){if(a._collectionChanges[e])i.log.verboseServer&&i.log.verboseServer("ServerForm: Rows to update in %s: %o",e,Object.keys(a._collectionChanges[e])),(t=r.ModelManager.getModelCollection(e))&&t._itemsChangedHost?t._itemsChangedHost.raise():t||i.logWarning("ServerForm: Invalid collection ",e)}for(var e in a._postUpdateModelCollectionChanges){var t;if(a._postUpdateModelCollectionChanges[e])(t=r.ModelManager.getModelCollection(e))&&t.executePostUpdateActions&&t.executePostUpdateActions()}for(var o in i.log.server&&i.log.server("ServerForm: Changes to model  %o",a._modelChanges),a._modelChanges){i.log.verboseServer&&i.log.verboseServer("ServerForm: Full update in %s: %o",o,a._modelChanges[o]);var n=r.ModelManager.getModel(o);n&&n._propertyChangedHost?n._propertyChangedHost.raise():n||i.logWarning("ServerForm: Invalid model",o)}a.clearChanges()},a.clearChanges=function(){for(var e in r.ModelManager.collections){var t=r.ModelManager.collections[e];if(r.isModelCollection(t))t._pendingCollectionChange=void 0;else for(var o in t)t[o]&&(t[o]._pendingCollectionChange=void 0)}a._collectionChanges=void 0,a._modelChanges=void 0,a._postUpdateModelCollectionChanges=void 0}}($dyn=$dyn||{}),function(c){!function(e){var t;(t=e.InteractionChannelType||(e.InteractionChannelType={})).default="default",t.byRootId="byRootId",t.byElement="byElement",t.byChannel="byChannel",t.available="available",t.any="any";var o=(n.prototype.toString=function(){return"[channel: ".concat(0===this.channel.channelId?"default":this.channel.channelId,", pending: ").concat(c.length(this.interactionQueue),"]")},n.prototype.setStaticLoadRequestComplete=function(e){},n.prototype.queueInteraction=function(e){c.log.server&&c.log.server("ServerForm: Entering queueInteraction"),this.processingInteractions?(c.logError(c.format(c.label("ServerForm_QueueError"),"function"==typeof e.details?e.details():e.$type)),c.log.server&&c.log.server("ServerForm: Interaction %o",e),e.FailureCallbackId&&c.serverForm.interactionManager.invokeCallback(e.FailureCallbackId)):(e.windowId!==this.currentWindowId&&(this.process(!0),c.log.server&&c.log.server("InteractionChannel: Channel "+this.channel.channelId+" updating currentWindowId from "+this.currentWindowId+" to "+e.windowId+" in function sendInteractions."),this.currentWindowId=e.windowId),e.TargetId?(e.windowId=void 0,this.interactionQueue.push(e),c.log.server&&c.log.server("ServerForm: Queuing interaction: %o",e),void 0!==e.NoAsyncIncrement&&null!==e.NoAsyncIncrement&&!0===e.NoAsyncIncrement||c.async.pending.increment("queue interaction"),e.Throttle&&e.ThrottleValue||c.async.nonThrottled++):c.logError(c.format(c.label("ServerForm_MissingTargetId"),e))),c.log.server&&c.log.server("ServerForm: Leaving queueInteraction")},n.prototype.queueCommandInteraction=function(e,t,o,n,i){var r={$type:c.serverForm.InteractionType.command,CallbackId:n,CommandName:e,FailureCallbackId:i,TargetId:t};return r.RootId=o,this.queueInteraction(r),r},n.prototype.queueCallbackCommandInteraction=function(e){this.queueInteraction(e)},n.prototype.queueThrottledCommandInteraction=function(e,t){for(var o=!1,n=!1,i=0,r=this.interactionQueue.length;i<r;i++){var a=this.interactionQueue[i];if(a.Throttle&&a.ThrottleId===e.ThrottleId&&0<a.ThrottleValue){a.ResetThrottleTime||(e.ThrottleTimestamp=a.ThrottleTimestamp),this.interactionQueue.splice(i,1),n=!0,a.CallbackId&&(e.CallbackId=a.CallbackId),a.FailureCallbackId&&(e.FailureCallbackId=a.FailureCallbackId),a.ThrottleCallback&&a.ThrottleCallback(),c.log.interactionThrottle&&c.log.interactionThrottle("InteractionThrottle: Interaction removed from the queue"),void 0!==a.NoAsyncIncrement&&null!==a.NoAsyncIncrement&&!0===a.NoAsyncIncrement||(c.async.pending.decrement("dequeue interaction"),a.decrementWindowAsyncPending&&a.decrementWindowAsyncPending()),1===r&&e.ResetThrottleTime&&(o=!0);break}}o&&this._cancelDelayProcess(),c.serverForm.interactionManager.registerCallback(e,t),this.queueInteraction(e),0<e.ThrottleValue?!o&&n||this.delayProcess(e):this.process()},n.prototype.removePendingPersonalization=function(e,t){for(var o=0,n=this.interactionQueue.length;o<n;o++){var i=this.interactionQueue[o];if("PersistPersonalization"===i.CommandName&&i.TargetId===e&&i.PositionalParameters[0]===t){this.interactionQueue.splice(o,1);break}}},n.prototype.process=function(e){if(c.log.server&&c.log.server("ServerForm: Entering process"),0<this.interactionQueue.length&&!c.flags.useDesignTimeView)if(this.processingInteractions)c.logWarning(c.format(c.label("ServerForm_ProcessError"),this.interactionQueue.length)),c.log.server&&c.log.server("ServerForm: Interactions %o",this.interactionQueue);else{this._interactionStart=window.performance.now();var t=[],o=window.performance.now(),n=!1;if(0<this.interactionQueue.length){var i=this.interactionQueue;t=[];for(var r=i.length-1;0<=r;r--){if(!(s=i[r]).Throttle||o-s.ThrottleTimestamp>=s.ThrottleValue){s.Telemetry&&(n=!0),t=i.slice(0,r+1),this.interactionQueue.splice(0,r+1);break}c.log.server&&c.log.server("ServerForm: Not processing interaction %o",s),c.log.server&&c.log.server("Throttle Value: %s ms, Time spent in queue %s ms",s.ThrottleValue,o-s.ThrottleTimestamp)}r=0;for(var a=t.length;r<a;r++){var s;if((s=t[r]).beforeExecute&&s.beforeExecute(),s.ShouldBlockOnExecution){var l=s.CommandName?s.CommandName:s.$type;if("function"==typeof s.ShouldBlockDeferred){var u=s.ShouldBlockDeferred();c.log.blockUserInteraction&&c.log.blockUserInteraction("BlockUserInteraction: InteractionChannel->Process - CommandName: %s is blocking. Immediate=%s",s.CommandName,!u),c.serverForm.interactionManager.incrementGlobalBlockingFlag(!u,l)}else c.log.blockUserInteraction&&c.log.blockUserInteraction("BlockUserInteraction: InteractionChannel->Process - CommandName: %s is blocking. Immediate=%s",s.CommandName,!s.ShouldBlockDeferred),c.serverForm.interactionManager.incrementGlobalBlockingFlag(!s.ShouldBlockDeferred,l)}}}c.log.server&&c.log.server("ServerForm: Process interactions request (deferred)");var d=this.currentWindowId;if(0<t.length){for(n&&c.telemetry._addInteractions(t),c.log.server&&c.log.server("ServerForm: Processing interactions, Count: %d, %O",t.length,t),this.channel.sendInteractions(t,d,e),c.serverForm.resetSessionTimeout(!1),r=0,a=t.length;r<a;r++)t[r].Throttle&&t[r].ThrottleValue||void 0!==t[r].EventData&&null!==t[r].EventData||c.async.nonThrottled--,void 0!==t[r].NoAsyncIncrement&&null!==t[r].NoAsyncIncrement&&!0===t[r].NoAsyncIncrement||c.async.pending.decrement("dequeue interaction");c.async.throttledCommandProcessing=!1}}c.log.server&&c.log.server("ServerForm: Leaving process")},n.prototype.hasPendingResponse=function(e){return void 0===e&&(e=!1),!!this.channel&&this.channel.hasPendingResponse(e)},n.prototype.registerInteractionReceivedCallback=function(e,t){this.channel.interactionReceived.subscribe(this._onInteractionReceived.bind(this)),this.interactionReceived.subscribe(e.bind(t))},n.prototype._cancelDelayProcess=function(){this._processingTimeout&&(this._processingTimeout.cancel(),c.log.interactionThrottle&&c.log.interactionThrottle("InteractionThrottle: InteractionChannel->delayProcess - Cancel timeout"))},n.prototype.delayProcess=function(e){var t,o=this;e.ThrottleTimestamp=window.performance.now(),this._processingTimeout=c.async(function(){c.log.interactionThrottle&&c.log.interactionThrottle("InteractionThrottle: InteractionChannel->delayProcess - Timeout called"),c.async.throttledCommandProcessing=!0,o.process()},(null!==(t=c.util.converters.numberString(e.ThrottleValue))&&void 0!==t?t:0)+50,"InteractionThrottle: InteractionChannel->delayProcess"),c.log.server&&c.log.server("ServerForm: Leaving delayProcess")},n.prototype._onInteractionReceived=function(e){var t=e;(t.Channel=this).interactionReceived.raise(t)},n);function n(e){this.interactionQueue=[],this.interactionReceived=new c.eventHost,this.channel=e}e.InteractionChannel=o}(c.serverForm||(c.serverForm={}))}($dyn=$dyn||{}),function(A){!function(e){var t;(t=e.InteractionManagerFunction||(e.InteractionManagerFunction={})).queueCallbackCommandInteraction="queueCallbackCommandInteraction",t.queueThrottledCommandInteraction="queueThrottledCommandInteraction",t.queueInteraction="queueInteraction",t.queueTelemetryEvent="queueTelemetryEvent",t.flushTelemetryEvents="flushTelemetryEvents",t.removePendingPersonalization="removePendingPersonalization",e.defaultChannelPoolSize=3;var o=(n.prototype.init=function(){for(var e=1,t=this._channelPoolSize;e<t;e++){var o=new A.serverForm.ReliableChannel(e),n=new A.serverForm.InteractionChannel(o);n.registerInteractionReceivedCallback(this._onInteractionReceived,this),this._channelPool.push(n)}A.serverForm.defaultChannel().registerInteractionReceivedCallback(this._onInteractionReceived,this),this._channelPool.push(A.serverForm.defaultChannel()),this._nextUnusedChannelId=10},n.prototype.reset=function(){this._channelPoolSize=A.serverForm.defaultChannelPoolSize,this._channelPool=[],this._formToChannelMap={},this._nextAvailableChannel=0,this.init()},n.prototype.queueCallbackCommandInteraction=function(e,t,o,n,i){var r=this._getInteractionChannelByType(o);r?(this.registerCallback(e,t),i&&this.registerFailureCallback(e,i),r.queueCallbackCommandInteraction(e),n&&r.process()):A.logError("An initialized interaction channel is required")},n.prototype.queueThrottledCommandInteraction=function(e,t,o,n,i,r){var a=this._getInteractionChannelByType(o);a?(i&&(e.ThrottleCallback=i),r&&this.registerFailureCallback(e,r),a.queueThrottledCommandInteraction(e,t),n&&a.process()):A.logError("An initialized interaction channel is required")},n.prototype.queueInteraction=function(e,t,o,n){var i=this._getInteractionChannelByType(t);i?(n&&this.registerFailureCallback(e,n),i.queueInteraction(e),o&&i.process()):A.logError("An initialized interaction channel is required")},n.prototype.queueTelemetryEvent=function(e){A.telemetry._eventQueue.push(e)},n.prototype.flushTelemetryEvents=function(){if(!this._isClientDisconnected&&0<A.length(A.telemetry._eventQueue)){var e=[],t={$type:A.serverForm.InteractionType.eventData,EventData:A.telemetry._eventQueue.slice()};e.unshift(t),A.telemetry.clearEvents(),this.sendTelemetryEvents(e)}},n.prototype.removePendingPersonalization=function(e,t,o){var n=this._getInteractionChannelByType(o);n?n.removePendingPersonalization(e,t):A.logError("An initialized interaction channel is required")},n.prototype.flushAllChannels=function(){for(var e=this._channelPool.length-1;0<=e;e--)this._channelPool[e].process()},n.prototype.channelPool=function(){return this._channelPool.slice(0)},n.prototype.updateMapOnFormDelete=function(e){e&&(this._formToChannelMap[e]&&delete this._formToChannelMap[e],void 0!==this._rootIdToWindowId[e]&&delete this._rootIdToWindowId[e])},n.prototype.addWindowHandler=function(e,t){this._windowIdToHandler[e],this._windowIdToHandler[e]=t},n.prototype.addRootId=function(e,t){this._rootIdToWindowId[e]=t},n.prototype.getClientWindowForFormId=function(e){var t=this.getWindowIdFromRootId(e);return this._windowIdToHandler[t].window},n.prototype.getWindowIdFromRootId=function(e,t){var o=this._rootIdToWindowId[e];return null==o&&(o=null!=t?t:A.serverForm._windowId),o},n.prototype._prepFormForPopout=function(e,t){var o=this._windowIdToHandler[t];return!!o&&o._prepFormForPopout(e)},n.prototype.detachFormForPopout=function(e,t){var o=this._windowIdToHandler[t];return!!o&&o.detachFormForPopout(e)},n.prototype.registerCallback=function(e,t){if(t){if(!e.CallbackId){var o=(this._commandCallbackIdAllocator++).toString();e.CallbackId=o}this.commandCallbacks[e.CallbackId]=t}},n.prototype.registerFailureCallback=function(e,t){if(t){if(!e.FailureCallbackId){var o=(this._commandCallbackIdAllocator++).toString();e.FailureCallbackId=o}this.commandCallbacks[e.FailureCallbackId]=t}},n.prototype.unregisterCallback=function(e){this.commandCallbacks[e]&&delete this.commandCallbacks[e]},n.prototype.invokeCallback=function(e,t){var o=this.commandCallbacks[e];if(!o)return A.logError(A.format("Callback with id: %d was not defined in the list of commandCallbacks",e)),!1;if("function"==typeof o)o(t);else if("object"==typeof o&&o._functionId&&o.windowId){var n=this._windowIdToHandler[o.windowId],i={callback:o};this._createCallbackFunction(n,i,"callback"),i.callback(t)}return!0},n.prototype.cleanupPopout=function(e,t){delete this._windowIdToHandler[e];var o=[];for(var n in this._rootIdToWindowId)this._rootIdToWindowId[n]==e&&o.push(n);for(var i=0,r=o.length;i<r;i++){var a=o[i];if(t){var s={$type:A.serverForm.InteractionType.command,CommandName:"RequestCloseCancel",RootId:a,TargetId:a},l={channelType:A.serverForm.InteractionChannelType.byRootId,rootId:a};A.serverForm.interactionManager.queueInteraction(s,l,!0)}delete this._rootIdToWindowId[a]}},n.prototype.hasQueuedInteractions=function(){for(var e=0,t=0,o=this._channelPool.length;t<o;t++){var n=this._channelPool[t];n.interactionQueue&&(e+=n.interactionQueue.length)}return 0<e},n.prototype.hasPendingResponse=function(e){void 0===e&&(e=!1);for(var t=0,o=this._channelPool.length;t<o;t++)if(this._channelPool[t].hasPendingResponse(e))return!0;return!1},n.prototype.processingInteractions=function(){for(var e=0,t=this._channelPool.length;e<t;e++)if(this._channelPool[e].processingInteractions)return!0;return!1},n.prototype.getRootFormId=function(){var e=A.shell.getCurrentRootForm();return e&&e.dynOptions&&e.dynOptions._serverId?A.context(e).Id:null},n.prototype.incrementGlobalBlockingFlag=function(e,t){this._globalBlockingCount++,1===this._globalBlockingCount&&A.serverForm._windowManager.notifyBlock(e,t)},n.prototype.decrementGlobalBlockingFlag=function(){0<this._globalBlockingCount&&(this._globalBlockingCount--,0===this._globalBlockingCount&&A.serverForm._windowManager.notifyUnBlock())},n.prototype.resetGlobalBlockingFlag=function(){var e=0<this._globalBlockingCount;this._globalBlockingCount=0,e&&A.serverForm._windowManager.notifyUnBlock()},n.prototype._getInteractionChannelByType=function(e){var t;switch(e.channelType){case A.serverForm.InteractionChannelType.byRootId:t=this._getInteractionChannelByRootId(e.rootId);break;case A.serverForm.InteractionChannelType.byElement:t=this._getInteractionChannelByElement(e.element);break;case A.serverForm.InteractionChannelType.available:t=this._getAvailableInteractionChannel();break;case A.serverForm.InteractionChannelType.any:t=this._getInteractionChannel(!e.formPart);break;case A.serverForm.InteractionChannelType.byChannel:t=e.channel;break;default:A.serverForm.defaultChannel&&(t=A.serverForm.defaultChannel())}return t},n.prototype._getInteractionChannelByRootId=function(e){return e&&this._formToChannelMap[e]?this._formToChannelMap[e]:A.serverForm.defaultChannel?A.serverForm.defaultChannel():void 0},n.prototype._getInteractionChannelByElement=function(e){var t=A.serverForm.interactionHandler.getRootIdByElement(e);return this._getInteractionChannelByRootId(t)},n.prototype._getAvailableInteractionChannel=function(){for(var e=0;e<this._channelPoolSize;e++){var t=this._getInteractionChannel(!1);if(!t.processingInteractions)return t}return A.logError("Unable to find a non-default interaction channel that is currently idle"),null},n.prototype._getInteractionChannel=function(e){if(!e){var t=this._channelPool[this._nextAvailableChannel];return this._nextAvailableChannel++,this._nextAvailableChannel===this._channelPoolSize&&(this._nextAvailableChannel=0),t}if(A.serverForm.defaultChannel)return A.serverForm.defaultChannel()},n.prototype.sendTelemetryEvents=function(e){if(e){var t={Interactions:e},o=A.browserActivity.usePreviousActivityKey?A.browserActivity.getPreviousActivityId():A.util.newGuid();$.ajax({data:JSON.stringify(t),url:"Services/TelemetryManager.svc/ProcessEventData",type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",headers:{"ms-dyn-aid":o,"ms-dyn-bsid":A.browserActivity.BrowserSessionActivity.Id,"ms-dyn-csrftoken":A.serverForm.getCsrfTokenValue(),"ms-dyn-sid":A.serverForm.defaultChannel?A.serverForm.defaultChannel().channel.serverSessionId:""},beforeSend:function(e,t){A.browserActivity.usePreviousActivityKey?A.browserActivity.usePreviousActivityKey=!1:A.browserActivity&&A.browserActivity.newInteraction(o),A.ui.PerformanceTimer&&A.ui.PerformanceTimer._addAction("ProcessEventData"),A.ui.PerformanceTimer&&A.ui.PerformanceTimer._startAjax(o)},complete:function(){A.ui.PerformanceTimer&&A.ui.PerformanceTimer._stopAjax()},timeout:6e4})}},n.prototype.updateMap=function(e,t){if(e.RootId){if(e.$type===A.serverForm.InteractionType.updateViewModel&&"ClientUserSession"===e.Descriptor.TypeName)return;e.$type===A.serverForm.InteractionType.changeViewModelId?this._formToChannelMap[e.PreviousValue]&&(delete this._formToChannelMap[e.PreviousValue],this._formToChannelMap[e.NewValue]=t):this._formToChannelMap[e.RootId]=t}},n.prototype.reconstructCallbackFunctions=function(e){var t=e.interaction;if(t){var o=A.serverForm.interactionManager._windowIdToHandler[t.windowId];for(var n in t)t[n]&&void 0!==t[n]._functionId&&null!==t[n]._functionId&&(A.log.navigation&&A.log.navigation("InteractionManager: reconstructing callback function: "+n+", with functionId: "+t[n]._functionId+", on Window: "+t.windowId),this._createCallbackFunction(o,t,n));e.throttleCallback&&this._createCallbackFunction(o,e,"throttleCallback")}},n.prototype._createCallbackFunction=function(t,e,o){var n={_functionId:e[o]._functionId,callbackName:o,source:"callback"};e[o]=function(e){if(n._result=e,t)return A.postMessage(t.window,{data:n})}},n.prototype._onInteractionReceived=function(e){e&&this._processInteractions(e.Channel,e.Interactions,e.WindowId)},n.prototype._processInteractions=function(e,t,o){var n;!A.debug.profileInteractions||this._inboundBlocked||A.serverForm._profileInteractionsStarted||(console.profile("profileInteractions"),n=A.serverForm._profileInteractionsStarted=!0),A.serverForm.processingInteractions(!0),e.processingInteractions=!0,this._processInteractionsTask&&this._processInteractionsTask.start(t.length.toString());var i,r,a,s=[],l={},u={},d={},c={};for(var p in this._windowIdToHandler)u[p]=[],c[p]=[];function h(e,t){var o=l[e];o||(o=[],l[e]=o),o.push(t)}function m(e,t){var o=c[t];if(0<o.length){var n=A.serverForm.createClientMessageLogInteraction(o);e=e.concat([n])}return e}o=o||A.serverForm._windowId;for(var v=0,g=t.length;v<g;v++){var y=t[v],f=y,b=y,C=this._rootIdToWindowId[y.RootId];switch(this.updateMap(y,e),y.$type){case A.serverForm.InteractionType.changeViewModelId:h(y.NewValue,y);break;case A.serverForm.InteractionType.commandCallback:s.push(y);break;default:if(f.Descriptor&&"ClientMessageLog"===f.Descriptor.Name&&f.Descriptor.Items){for(var w=0,_=f.Descriptor.Items.length;w<_;w++){var S=f.Descriptor.Items[w];S.Item&&S.Item.Properties&&S.Item.Properties.formUniqueId&&(i=S.Item.Properties.formUniqueId,r=S,a=void 0,(a=d[i])||(a=[],d[i]=a),a.push(r))}continue}if(h(y.RootId,y),b.Descriptor&&("ClientUserSession"===b.Descriptor.Name||"ClientNotifications"===b.Descriptor.Name)){this.addRootId(y.RootId,A.serverForm._windowId);continue}if(b.Descriptor&&b.Descriptor.ValueProperties){var I=b.Descriptor.ValueProperties.anchorRootId;void 0!==I&&(C=this._rootIdToWindowId[I])}void 0===C&&(C=o),this.addRootId(y.RootId,C)}b.Descriptor&&b.Descriptor.ValueProperties&&b.Descriptor.ValueProperties.InlineLoadingKey&&(b.Descriptor.ValueProperties.InlineLoadingKey=b.Descriptor.ValueProperties.InlineLoadingKey+"_"+e.channel.channelId)}this._bucketCommandCallbacks(s,u);var T=this._windowIdToHandler;for(var x in l){var F=this.getWindowIdFromRootId(x),k=l[x];if(E=u[F])for(w=0,g=k.length;w<g;w++)E.push(k[w])}for(var x in d){F=this.getWindowIdFromRootId(x,o);var P=d[x],R=c[F];if(R){for(w=0,g=P.length;w<g;w++)R.push(P[w]);0!=F&&A.serverForm.messageInteractionBuffer.addMessages(P)}}for(var M in A.serverForm.messageInteractionBuffer.advanceBuffer(),u){var E;if((E=(E=u[M])&&m(E,M))&&0<E.length){var N=T[M];N&&N.processInteractions(E)}}this._processInteractionsTask&&this._processInteractionsTask.stop(),e.processingInteractions=!1,A.serverForm.processingInteractions(!1),A.debug.profileInteractions&&n&&(console.profileEnd(),n=A.serverForm._profileInteractionsStarted=!1)},n.prototype._bucketCommandCallbacks=function(e,t){for(var o=0,n=e.length;o<n;o++){var i=e[o];if(A.log.server&&A.log.server("ServerForm: Handling callback interaction: %o",i),i.CallbackId in this.commandCallbacks){var r=this.commandCallbacks[i.CallbackId];i.callback=r;var a=i.callback.windowId;t[a=a||A.serverForm._windowId]&&t[a].push(i),delete this.commandCallbacks[i.CallbackId],delete i.CallbackId}i.UnusedCallbackId in this.commandCallbacks&&(delete this.commandCallbacks[i.UnusedCallbackId],delete i.UnusedCallbackId)}},n);function n(){this._channelPool=[],this._isClientDisconnected=!1,this._channelPoolSize=A.serverForm.defaultChannelPoolSize,this._formToChannelMap={},this._nextAvailableChannel=0,this._windowIdToHandler={},this._rootIdToWindowId={},this.commandCallbacks={},this._commandCallbackIdAllocator=1,this._globalBlockingCount=0,this._inboundBlocked=!1,this._isChannelBlocking=!1,this._processInteractionsTask=new A.PerformanceTask("processInteractions",!0),this.handleMessages=function(e){if(e.origin===A.util.getOrigin(A.util.location.location)){var t=e.data;if("object"==typeof t&&"InteractionManager"===t.source)switch(t.interaction&&t.interaction.CommandName&&"Reserialize"===t.interaction.CommandName&&A.serverForm.interactionManager.addRootId(t.interaction.TargetId,t.interaction.windowId),A.serverForm.interactionManager.reconstructCallbackFunctions(t),t.commandName){case A.serverForm.InteractionManagerFunction.queueCallbackCommandInteraction:A.serverForm.interactionManager.queueCallbackCommandInteraction(t.interaction,t.callback,t.channelOptions,t.shouldProcess,t.failureCallback);break;case A.serverForm.InteractionManagerFunction.queueThrottledCommandInteraction:A.serverForm.interactionManager.queueThrottledCommandInteraction(t.interaction,t.callback,t.channelOptions,t.shouldProcess,t.throttleCallback,t.failureCallback);break;case A.serverForm.InteractionManagerFunction.queueInteraction:A.serverForm.interactionManager.queueInteraction(t.interaction,t.channelOptions,t.shouldProcess,t.failureCallback);break;case A.serverForm.InteractionManagerFunction.queueTelemetryEvent:A.serverForm.interactionManager.queueTelemetryEvent(t.event);break;case A.serverForm.InteractionManagerFunction.flushTelemetryEvents:A.serverForm.interactionManager.flushTelemetryEvents();break;case A.serverForm.InteractionManagerFunction.removePendingPersonalization:A.serverForm.interactionManager.removePendingPersonalization(t.targetId,t.property,t.channelOptions)}}}}e.InteractionManager=o,e.interactionManager=new o}(A.serverForm||(A.serverForm={}))}($dyn=$dyn||{}),function(s){var e,t;function o(){this.asyncMessageCount=0}e=s.serverForm||(s.serverForm={}),o.prototype.queueCallbackCommandInteraction=function(e,t,o,n,i){if(this._canQueueInteraction(o)){e.windowId=s.serverForm._windowId;var r={source:"InteractionManager",commandName:s.serverForm.InteractionManagerFunction.queueCallbackCommandInteraction,interaction:e,callback:t,channelOptions:o,shouldProcess:n,failureCallback:i};this._postMessageToParentWindow(r)}else s.logError(s.format(s.label("ServerForm_QueueError"),"function"==typeof e.details?e.details():e.$type)),s.log.server&&s.log.server("ServerForm: Interaction %o",e)},o.prototype.queueThrottledCommandInteraction=function(e,t,o,n,i,r){if(this._canQueueInteraction(o)){e.windowId=s.serverForm._windowId;var a={source:"InteractionManager",commandName:s.serverForm.InteractionManagerFunction.queueThrottledCommandInteraction,interaction:e,channelOptions:o,shouldProcess:n,callback:t,throttleCallback:i,failureCallback:r};this._postMessageToParentWindow(a)}else s.logError(s.format(s.label("ServerForm_QueueError"),"function"==typeof e.details?e.details():e.$type)),s.log.server&&s.log.server("ServerForm: Interaction %o",e)},o.prototype.queueInteraction=function(e,t,o,n){if(this._canQueueInteraction(t)){e.windowId=s.serverForm._windowId;var i={source:"InteractionManager",commandName:s.serverForm.InteractionManagerFunction.queueInteraction,interaction:e,channelOptions:t,shouldProcess:o,failureCallback:n};this._postMessageToParentWindow(i)}else s.logError(s.format(s.label("ServerForm_QueueError"),"function"==typeof e.details?e.details():e.$type)),s.log.server&&s.log.server("ServerForm: Interaction %o",e)},o.prototype.queueTelemetryEvent=function(e){var t={source:"InteractionManager",commandName:s.serverForm.InteractionManagerFunction.queueTelemetryEvent,event:e};this._postMessageToParentWindow(t)},o.prototype.flushTelemetryEvents=function(){var e={source:"InteractionManager",commandName:s.serverForm.InteractionManagerFunction.flushTelemetryEvents};this._postMessageToParentWindow(e)},o.prototype.removePendingPersonalization=function(e,t,o){if(this._canQueueInteraction(o)){var n={source:"InteractionManager",commandName:s.serverForm.InteractionManagerFunction.removePendingPersonalization,targetId:e,property:t,channelOptions:o};this._postMessageToParentWindow(n)}else s.logError(s.format(s.label("ServerForm_QueueError"),"removePendingPersonalization"))},o.prototype.hasPendingResponse=function(){return s.value(s.clientBusy)},o.prototype.reset=function(){},o.prototype._canQueueInteraction=function(e){return!s.serverForm.interactionHandler.processingInteractions||e.channelType===s.serverForm.InteractionChannelType.available},o.prototype._postMessageToParentWindow=function(e){if(s.parentWindow){this.stripCallbackFunctions(e);var t=s.postMessage(s.parentWindow,{data:e});return this.restoreCallbackFunctions(e),t}s.logError("Trying to post message to parentWindow which does not exist.")},o.prototype.stripCallbackFunctions=function(e){var t=e.interaction;if(t&&(void 0===t.NoAsyncIncrement||null===t.NoAsyncIncrement||!0!==t.NoAsyncIncrement)){var o=this.asyncMessageCount++;s.async.pending.increment("InteractionManagerProxy: Async message id "+o+", Post message to parent window start."),t.decrementWindowAsyncPending=function(){s.async.pending.decrement("InteractionManagerProxy: Async message id "+o+", Post message to parent window end.")}}for(var n in t)"beforeExecute"!==n?("ShouldBlockDeferred"===n&&"function"==typeof t[n]&&(t[n]=t[n]()),"function"==typeof t[n]&&this._createCallbackObject(t,n)):(t[n](),delete t[n]);for(var i=["callback","failureCallback","throttleCallback"],r=0;r<i.length;r++){var a=i[r];e[a]&&(this._createCallbackObject(e,a),e[a].windowId=t.windowId)}},o.prototype.restoreCallbackFunctions=function(e){var t=e.interaction;for(var o in t)t[o]&&void 0!==t[o]._functionId&&null!==t[o]._functionId&&(t[o]=s.serverForm.idToWindowFunction[t[o]._functionId])},o.prototype._createCallbackObject=function(e,t){s.serverForm.idToWindowFunction[s.serverForm.windowFunctionId]=e[t],e[t]={_functionId:s.serverForm.windowFunctionId},s.serverForm.windowFunctionId++},t=o,e.InteractionManagerProxy=t}($dyn=$dyn||{}),function(d){var e,i,t,o,n,r,a,s,l,u,c;Globalize.addCultureInfo("en",{messages:{ServerForm_DiagnosticsMessage:"Unexpected server error: '{0}' - {1}",ServerForm_GenericError:"An error has occurred. Please contact your system administrator.",ServerForm_InternalError:"An internal error has occurred. Please contact your system administrator.",ServerForm_LostConnection:"Sorry, we lost the connection temporarily. Please be patient while we reconnect you.",ServerForm_MissingTargetId:"Missing target id for interaction: {0}.",ServerForm_ProcessError:"Ignoring process {0} interactions. Process was called while we were processing interactions.",ServerForm_QueueError:"Ignoring queue interaction of type: {0}. The interaction was queued while we were processing interactions.",ServerForm_ServerTimeout:"The server took too long to respond. Please contact your system administrator.",ServerForm_SessionEndError:"We've lost your connection. Click Close to continue working.",ServerForm_SystemMaintenance:"This system will be temporarily unavailable starting at {0} due to scheduled maintenance. Please save your changes and logout before the maintenance begins.",ServerForm_UnknownError:"Unknown error occurred. Please contact the System Administrator.",ServerForm_UnknownUserError:"You are not authorized to login with your current credentials. You will be redirected to the login page in a few seconds.",WindowManager_CannotReloadPopout:"A popout window cannot be reloaded. Please close the popout window."}}),d.ajax=function(e){return $.ajax(e)},d.postMessage=function(e,t){var o=d.util.getOrigin(d.util.location.location);try{e.postMessage(t.data,o)}catch(e){return d.logError("Failed to postMessage to window with data: ",t.data),d.logError(e.message),!1}return!0},(e=d.shell||(d.shell={})).IsUnloading=!1,e.defaultForm={elementCreated:function(e){d.serverForm&&d.serverForm.getForm(e)},menuItem:"Action:SysLoadStartPage"},window.addEventListener("beforeunload",function(){d.shell.IsUnloading=!0}),d.util.waitForClientBusy=function(){return!!d.serverForm&&d.serverForm.interactionManager.hasPendingResponse(!0)},i=d.serverForm||(d.serverForm={}),(t=i.TimeValues||(i.TimeValues={}))[t.FiveSeconds=5]="FiveSeconds",t[t.ThirtySeconds=30]="ThirtySeconds",t[t.TwoMinutes=120]="TwoMinutes",t[t.FiveMinutes=300]="FiveMinutes",t[t.TenMinutes=600]="TenMinutes",t[t.ThirtyMinutes=1800]="ThirtyMinutes",(o=i.InteractionType||(i.InteractionType={})).createViewModel="CreateViewModelInteraction",o.updateViewModel="UpdateViewModelInteraction",o.deleteViewModel="DeleteViewModelInteraction",o.changeViewModelId="ChangeViewModelIdInteraction",o.createModel="CreateModelInteraction",o.updateModel="UpdateModelInteraction",o.updateModelCollection="UpdateModelCollectionInteraction",o.getForm="GetFormInteraction",o.command="CommandInteraction",o.propertyChange="PropertyChangeInteraction",o.commandCallback="CommandCallbackInteraction",o.eventData="EventDataInteraction",o.getNavigationPane="GetNavigationPaneInteraction",o.getTileKpiValuesInteraction="GetTileKpiValuesInteraction",o.getNavigationTileClick="GetNavigationTileClickInteraction",o.getMenuStructureInteraction="GetMenuStructureInteraction",o.setLookupValue="SetLookupValueInteraction",o.navigate="NavigationInteraction",o.taskRecorderInteraction="TaskRecorderInteraction",o.clientRestrictedInternetInteraction="ClientRestrictedInternetInteraction",o.restoreServerSession="RestoreServerSessionInteraction",(i.CommandName||(i.CommandName={})).propertyChange="PropertyChangeInteractionCommand",(n=i.FormOpenMethod||(i.FormOpenMethod={}))[n.Display=0]="Display",n[n.Output=1]="Output",n[n.Action=2]="Action",n[n.Form=3]="Form",(r=i.FormOpenMethod||(i.FormOpenMethod={})).find=function(e){var t=r,o=t[e];if(void 0===o)for(var n in e=e.toLowerCase(),d.serverForm.FormOpenMethod)if(n.toLowerCase()===e&&"function"!=typeof n){o=t[n];break}return o},(a=i.FormViewOption||(i.FormViewOption={}))[a.Auto=0]="Auto",a[a.Grid=1]="Grid",a[a.Details=2]="Details",a[a.Header=3]="Header",a[a.Hub=5]="Hub",(s=i.FormViewOption||(i.FormViewOption={})).find=function(e){var t=s,o=t[e];if(void 0===o)for(var n in d.serverForm.FormViewOption)if(0===n.localeCompare(e,void 0,{sensitivity:"accent"})&&"function"!=typeof n){o=t[n];break}return o},(l=i.ValueType||(i.ValueType={}))[l.other=0]="other",l[l.string=1]="string",l[l.object=2]="object",l[l.serialized=3]="serialized",l[l.collection=4]="collection",(u=i.MessageType||(i.MessageType={})).message="Message:#Microsoft.Dynamics.Client.InteractionService.Communication",u.reliableMessage="ReliableChannelMessage:#Microsoft.Dynamics.Client.InteractionService.Communication.Reliable",(c=i.RequestHeaderKeys||(i.RequestHeaderKeys={})).sessionKey="ms-dyn-sid",c.companyKey="ms-dyn-cmp",c.partitionKey="ms-dyn-prt",c.languageKey="ms-dyn-lng",c.clientSessionKey="ms-dyn-bsid",c.activityKey="ms-dyn-aid",c.hostNameKey="ms-dyn-fqhn",c.namespaceKey="ms-dyn-namespace",c.tenantKey="ms-dyn-tenant",c.roleKey="ms-dyn-role",c.tokenKey="ms-dyn-csrftoken",c.sessionWaitTimeout="ms-dyn-sid-timeout",c.affinity="ApplicationGatewayAffinity",c.sfAffinity="ms-dyn-affinity",c.sessionLoggableKey="ms-dyn-slk",c.aosId="ms-dyn-aosid",i.cachedPartFormInteractions={},i.partFormCacheUpdated=new d.eventHost,i.maximumThrottleTime=9999,i.sessionExpired=!1,i.enableSessionTimeout=!0,i.sessionTimeoutRemainWarningTime=30,i.sessionTimeoutRemainWarningShown=!1,i.maxWaitTimeToRetry=2e3,i.sessionInitiationTimeout=3e5,i.sessionRequestTimeout=15e3,i.maxRetryTimeWhenIncompleteRequest=6e4,i.retryTimeWhenIncompleteRequest=15e3,i.sessionWaitTimeoutOnRetry=1e4,i.pingInterval=12e4,i.pingFlightName="CLIServerFormPing",i.processingInteractions=d.observable(!1),i.aosDraining=!1,i.setSessionTimeoutRemainWarningTime=function(){d.serverForm.sessionTimeout>1e3*d.serverForm.TimeValues.ThirtyMinutes?d.serverForm.sessionTimeoutRemainWarningTime=d.serverForm.TimeValues.FiveMinutes:d.serverForm.sessionTimeout>1e3*d.serverForm.TimeValues.TenMinutes?d.serverForm.sessionTimeoutRemainWarningTime=d.serverForm.TimeValues.TwoMinutes:d.serverForm.sessionTimeoutRemainWarningTime=d.serverForm.TimeValues.ThirtySeconds},i.setWebClientStatefulSessionTimeoutInSeconds=function(){d.user()&&!isNaN(parseInt(d.user().WebClientStatefulSessionTimeoutInSeconds(),10))?(d.serverForm.sessionTimeout=1e3*parseInt(d.user().WebClientStatefulSessionTimeoutInSeconds(),10),d.serverForm.setSessionTimeoutRemainWarningTime(),d.serverForm.resetSessionTimeout()):(d.serverForm.sessionTimeout=36e5,d.serverForm.setSessionTimeoutRemainWarningTime())},i.setMaxWaitTimeToFailInMinutes=function(){d.user()&&!isNaN(parseInt(d.user().MaxWaitTimeToFailInMinutes(),10))?d.serverForm.maxWaitTimeToFail=60*parseInt(d.user().MaxWaitTimeToFailInMinutes(),10)*1e3:d.serverForm.maxWaitTimeToFail=6e5},d.serverForm.setWebClientStatefulSessionTimeoutInSeconds(),d.serverForm.setMaxWaitTimeToFailInMinutes(),i.resetSessionTimeout=function(e){var t=void 0===e||e;if(!d.serverForm.sessionTimeoutId||d.serverForm.sessionTimeoutRemainWarningShown||d.serverForm.sessionExpired||(clearTimeout(d.serverForm.sessionTimeoutId),clearTimeout(d.serverForm.sessionTimeoutIdWarning)),d.serverForm.enableSessionTimeout&&!d.serverForm.sessionTimeoutRemainWarningShown&&!d.serverForm.sessionExpired&&(d.serverForm.sessionTimeoutId=window.setTimeout(function(){var e=d.value(d.user);e&&d.value(e.SessionExpireAutoLogoff)?d.shell.logOut():(d.serverForm.endSession(),d.serverForm.sessionExpired=!0,d.serverForm.reset(),d.serverForm._pingTimeoutId&&(clearInterval(d.serverForm._pingTimeoutId),d.serverForm._pingTimeoutId=0,d.log.server&&d.log.server("ServerForm: Ping interval with id %s has been cleared",d.serverForm._pingTimeoutId)),d.boot.monitoringInterval&&(clearInterval(d.boot.monitoringInterval),d.boot.monitoringInterval=void 0),d.showTimeoutDialog({type:"Reconnect"}))},d.serverForm.sessionTimeout),d.serverForm.sessionTimeoutIdWarning=window.setTimeout(function(){d.serverForm.sessionTimeoutRemainWarningShown=!0,d.showTimeoutDialog({type:"Logout",timerCountDown:d.serverForm.sessionTimeoutRemainWarningTime})},d.serverForm.sessionTimeout-1e3*(d.serverForm.sessionTimeoutRemainWarningTime+d.serverForm.TimeValues.FiveSeconds)),d.serverForm.interactionManager&&d.serverForm.interactionManager.channelPool&&t)){var o=d.serverForm.interactionManager.channelPool();if(o)for(var n=0;n<o.length;n++){var i=o[n],r=i&&i.channel?i.channel:void 0;r&&r.serverSessionId&&r._lastStartTime&&window.performance.now()-r._lastStartTime>d.serverForm.sessionTimeout/2&&d.serverForm.keepSessionAlive(i)}}},window.setTimeout(function(){if(d.serverForm&&d.serverForm.enableSessionTimeout){d.serverForm.resetSessionTimeout();var e=function(){return d.serverForm.resetSessionTimeout()};window.addEventListener("mousedown",e,!0),window.addEventListener("keydown",e,!0)}},1e3),i.restoreCurrentSession=function(){var e={$type:d.serverForm.InteractionType.restoreServerSession,ServerSessionId:d.serverForm.defaultChannel().channel.serverSessionId,ShouldBlockOnExecution:!0,TargetId:"0_0"};d.serverForm.defaultChannel._instance=null,d.serverForm.interactionManager.reset();var t={channel:d.serverForm.defaultChannel(),channelType:d.serverForm.InteractionChannelType.byChannel};d.serverForm.interactionManager.queueInteraction(e,t,!0)},i.endSession=function(e){d.shell.unregisterAllUnsavedChanges();var t=[];if(d.serverForm.interactionManager&&d.serverForm.interactionManager.channelPool){var o=d.serverForm.interactionManager.channelPool();if(o)for(var n=0;n<o.length;n++){var i=o[n];i&&i.channel&&i.channel.serverSessionId&&(!e||e!==i.channel.serverSessionId)&&(t.push(i.channel.serverSessionId),i.channel.serverSessionId=void 0)}}if(0<t.length){var r="Services/SessionManager.svc/EndSessions",a=JSON.stringify(t);navigator.sendBeacon?navigator.sendBeacon(r,a):$.ajax({async:!1,contentType:"application/json; charset=utf-8",data:a,dataType:"json",headers:{"ms-dyn-aid":d.util.newGuid(),"ms-dyn-bsid":d.browserActivity.BrowserSessionActivity.Id,"ms-dyn-csrftoken":d.serverForm.getCsrfTokenValue()},timeout:6e4,type:"POST",url:r})}},i._debugDescriptor=function(e,t){if(d.debug.general){var o=e.dynPrevDescriptors;(o=o||[]).push(t),e.dynPrevDescriptors=o}},i.getForm=function(e){var t;if(d.serverForm.aosDraining){var o=e.NavigationPath&&0<e.NavigationPath.length,n=d.value(d.ax.taskRecording.isRecording)||d.value(d.ax.taskRecording.taskGuidePlaybackState),i=d.value(d.ax._tracing.started),r=d.value(d.shell.isAsidePaneOpen);!o||n||i||r||(d.serverForm.endSession(),d.serverForm.reset(),d.ax.helpPane.pane=void 0,d.ax.taskRecording.pane=void 0,d.ax._tracing.pane=void 0,d.serverForm.clearAffinity())}d.debug.trackFormPerformance&&null!==(t=e.targetElement)&&void 0!==t&&t.dynPerformance&&(e.targetElement.dynPerformance.requestStart=window.performance.now());var a=e.menuItem?"MenuItem":"Form",s=e.menuItem?e.menuItem:e.name,l={targetType:a};d.telemetry.addPerformanceEvent(s,"0",d.telemetry.PerformanceEvents.openStart,l),d.serverForm.interactionHandler.getForm(e)},i.registerForm=function(e){var t=e.targetElement,o=t.getAttribute("data-dyn-formid");d.serverForm.interactionHandler.forms[o]=t},i.initialForm=function(){var e=d.util.location.query,t=e.q,o=e.pagetype;return e.popout?{elementCreated:void 0}:e.f?{elementCreated:d.serverForm.getForm,name:e.f.toLowerCase(),pagetype:o,recordcontext:t,role:"Form"}:e.mi?{elementCreated:d.serverForm.getForm,menuItem:e.mi.toLowerCase(),pagetype:o,recordcontext:t,role:"Form"}:d.shell.defaultForm},i.infologModel=new d.serverForm.Model,d.serverForm.infologModel.id="ClientMessageLog",d.serverForm.ModelManager.trackModel(d.serverForm.infologModel),i.infologCollection=d.serverForm.infologModel.getRelatedCollection("ClientMessageLog"),d.serverForm.infologCollection.id="ClientMessageLog",d.serverForm.ModelManager.trackModelCollection(d.serverForm.infologCollection),d.observe(d.serverForm.infologCollection.items,function(e){var t=new Array;if(e){for(var o=0,n=e.length;o<n;o++){var i=e[o],r=parseInt(i.getValue("kind"),10),a=new d.messaging.Message;if(a.text=i.getValue("text"),a.stackTrace=i.getValue("stackTrace"),a.messageId=i.getValue("messageId"),a.type=r,a.type===d.messaging.MessageType.systemMaintenance){var s=moment.utc(a.text).toDate();s=moment(s).format("YYYY-MM-DD HH:mm"),a.text=d.format(d.label("ServerForm_SystemMaintenance"),s)}a.timeStampMomentUtc=moment.utc(i.getValue("timeStamp")),a.Id=i.id,a.formName=i.getValue("formContext");var l=i.getValue("formUniqueId");a.formUniqueId="0_0"===l?"":l;var u=i.getValue("parentFormUniqueId");a.parentFormId="0_0"===u?"":u,a.targetName=i.getValue("messageContext"),a.destination=i.getValue("destination"),a.activityId=i.getValue("activityId"),a.ActionMessageText=i.getValue("actionText"),a.isStaticAction=d.util.stringToBoolean(i.getValue("isStaticAction")),a.elapsedTimeSinceArrival=d.observable(""),"0"==i.getValue("deleteMessage")?a.deleteMessage=!1:a.deleteMessage=!0,t.push(a)}0<t.length&&(d.messageManager.addMessages(t),d.serverForm.infologCollection.items([]))}}),i.keepSessionAlive=function(e){var t={$type:d.serverForm.InteractionType.command,CommandName:"KeepAlive",RootId:0,TargetId:"0_0"};d.serverForm.interactionManager.queueInteraction(t,{channelType:d.serverForm.InteractionChannelType.byChannel,channel:e},!0)},i.updateTrigger=function(r,a,e){if(a){var s=!0,l="Value";e&&(void 0===e.ChangeValue||e.ChangeValue,s=void 0===e.AutoPostback||e.AutoPostback,l=e.command),a&&void 0!==a.__triggerId&&a.valueChanged.unsubscribe(a.__triggerId);var u=d.peek(a);a.__triggerId=a.valueChanged.subscribe(function(e,t){if(!a.__bindingUpdating){var o=d.peek(a);if(o!==u||t){var n={$type:d.serverForm.InteractionType.propertyChange,PropertyName:l,RootId:d.serverForm.interactionHandler.getRootIdByElement(r._element),TargetId:r._serverId,beforeExecute:function(){n.NewValue=$.isPlainObject(o)||$.isArray(o)?JSON.stringify(o):o}};n.RootId=d.serverForm.interactionHandler.getRootIdByElement(r._element),s||(n.NoAsyncIncrement=!0);var i={channelType:d.serverForm.InteractionChannelType.byRootId,rootId:n.RootId};d.serverForm.interactionManager.queueInteraction(n,i,s)}}u=d.value})}},i.getControlParams=function(e,t){if(!e||!t)return null;var o,n=t._allControls;return n&&((o=n[e.toLowerCase()])||e!==t._name||(o=t)),o},i.getElementControlParams=function(e){var t,o;try{o=d.rootElement(e)}catch(e){}if(o&&o.dynOptions)for(var n=$(e).parents().addBack(),i=n.length-1;0<=i;i--){var r=void 0;if(r=n[i].hasAttribute("data-dyn-columnname")?n[i].getAttribute("data-dyn-columnname"):n[i].getAttribute("data-dyn-controlname"),t=d.serverForm.getControlParams(r,o.dynOptions))break}return t},i.getElement=function(e,t){var o=d.serverForm.getControlParams(e,t);return o?o._element:null},i.getModel=function(e){var t;return d.serverForm.ModelManager.models[e]&&d.serverForm.ModelManager.models[e][e]?t=d.serverForm.ModelManager.models[e][e]:((t=new d.serverForm.Model).id=e,d.serverForm.ModelManager.trackModel(t,e)),t},i.saveTransitState=function(e){d.context(d.serverForm.interactionHandler.getFormElement(e)).serializeTransitState.raise()},i.init=function(){d.DynReact.ModuleStore._requestMenuStructure=function(e,t,o){if(d.serverForm){var n={$type:d.serverForm.InteractionType.getMenuStructureInteraction,CommandName:"GetMenuStructureInteraction",ShouldBlockOnExecution:!1,TargetId:e};o&&o.menuItem&&(n.NamedParameters={Args1:o.menuItem}),o&&o.state&&(n.NamedParameters={Args1:o.state}),d.serverForm.interactionManager.queueCallbackCommandInteraction(n,t,{},!0)}else d.logError("Access to $dyn.serverForm is required for retrieving the menu structure.")},d.serverForm.defaultChannel=function(){if(!d.serverForm.defaultChannel._instance){var e=new d.serverForm.ReliableChannel;d.serverForm.defaultChannel._instance=new d.serverForm.InteractionChannel(e),e.enableSessionTimeout=d.serverForm.enableSessionTimeout}return d.serverForm.defaultChannel._instance};var e=d.util.location.query;e.popout?d.serverForm.initPopout(e):d.serverForm.initHost(),window.addEventListener("unload",d.serverForm._windowManager.closeWindow),d.shell.hasRestrictedInternet.valueChanged.subscribe(function(e){var t=d.value(d.user);t&&!d.value(t.ClientConnectivityEnabled)||d.serverForm.sendClientRestrictedInternetInteraction({internetRestricted:d.value(e)})})},i.sendClientRestrictedInternetInteraction=function(e){if(d.serverForm){var t={$type:d.serverForm.InteractionType.clientRestrictedInternetInteraction,CommandName:"ClientInternetRestrictedInteraction",InternetRestricted:e.internetRestricted,PriorityPosition:!0,ShouldBlockOnExecution:!1,TargetId:"setClientRestrictedInternet"};d.serverForm.interactionManager.queueCallbackCommandInteraction(t,function(){},{},!0)}else d.logError("Access to $dyn.serverForm is required for set the system information.")},i.createClientMessageLogInteraction=function(e){return{$type:d.serverForm.InteractionType.updateModelCollection,Descriptor:{Id:"ClientMessageLog",Items:e,Name:"ClientMessageLog"},RootId:"ClientMessageLog"}},i.initPopout=function(e){d.serverForm.interactionManager=new d.serverForm.InteractionManagerProxy,d.serverForm.idToWindowFunction={},d.serverForm.windowFunctionId=0,d.serverForm.interactionHandler=new d.serverForm.InteractionHandler,d.serverForm._windowManager=new d.serverForm._WindowManagerPopout,window.addEventListener("message",d.serverForm.interactionHandler.handleMessages),window.addEventListener("message",d.serverForm._windowManager.handleMessages),d.serverForm.initPopoutMessageCenter(),d.serverForm._windowId=parseInt(e.popout,10);var t=e.rootId;window.opener?d.parentWindow=window.opener.$dyn.parentWindow:d.logError("Cannot set parent window for popout window; please contact your administrator."),e.newPopout?(d.ui.updateQueryStringParameter("newPopout",null),d.serverForm.compilation.StaticLoader.staticLoaderOn=!1,d.ui.updateQueryStringParameter("popout",e.popout),d.serverForm._windowManager.windowLoadCallback({window:window,windowId:d.serverForm._windowId,rootId:t})):d.errorMessageBox({callback:function(){window.close()},Label:"WindowManager_CannotReloadPopout",Text:d.label("WindowManager_CannotReloadPopout")})},i.initPopoutMessageCenter=function(){d.messageManager&&d.messageManager.messageHandlers&&d.messageManager.messageHandlers.clientMessageHandler&&d.messageManager.messageHandlers.clientMessageHandler.messageCenter&&(d.messageManager.messageHandlers.clientMessageHandler.messageCenter=d.serverForm.ProxyMessageCenterManager)},i.initHost=function(){d.serverForm.interactionManager=new d.serverForm.InteractionManager,d.serverForm.interactionManager.init(),window.addEventListener("message",d.serverForm.interactionManager.handleMessages),d.serverForm.interactionHandler=new d.serverForm.InteractionHandler,d.serverForm._windowManager=new d.serverForm._WindowManager,window.addEventListener("message",function(e){if(e.origin===d.util.getOrigin(d.util.location.location)){var t=e.data;if("object"==typeof t&&"MessageCenter"===t.source)if("ReplayMessageOnMainWindow"===t.commandName){for(var o=[],n=d.serverForm.messageInteractionBuffer.getMessagesInOrder(),i=0;i<n.length;i++)for(var r=0;r<t.messageIds.length;r++)t.messageIds[r]===n[i].Id&&o.push(n[i]);var a=d.serverForm.createClientMessageLogInteraction(o);d.serverForm.interactionHandler.processInteractions([a])}else"RemoveMessage"===t.commandName?d.messageManager.messageHandlers.clientMessageHandler.messageCenter.RemoveMessage(t.messageId):"ClearMessages"===t.commandName&&d.messageManager.messageHandlers.clientMessageHandler.messageCenter.ClearMessages()}}),window.addEventListener("message",d.serverForm._windowManager.handleMessages),d.serverForm._windowId=d.serverForm._windowManager.getNextWindowId(),d.serverForm.interactionManager.addWindowHandler(d.serverForm._windowId,d.serverForm.interactionHandler),d.parentWindow=window},i.closeAllPopouts=function(e,t){return d.serverForm._windowManager.requestCloseAllPopouts(e,t)},i.forceCloseAllPopouts=function(){d.serverForm._windowManager&&d.serverForm._windowManager.forceCloseAllPopouts&&d.serverForm._windowManager.forceCloseAllPopouts()},i.pingReset=function(){d.serverForm._pingTimeoutId&&(clearInterval(d.serverForm._pingTimeoutId),d.log.server&&d.log.server("ServerForm: Ping interval with id %s has been cleared",d.serverForm._pingTimeoutId)),d.util.isFlightEnabled(d.serverForm.pingFlightName)?(d.serverForm._pingTimeoutId=window.setInterval(function(){var n=window.performance.now(),o=(new Date).toString(),e={type:"POST"};e.url=d.util.resolveVirtualPath("/ping"),e.cache=!1,e.beforeSend=function(e){d.serverForm.setCsrfToken(e);var t=d.util.newGuid();e.setRequestHeader(d.serverForm.RequestHeaderKeys.clientSessionKey,d.browserActivity.BrowserSessionActivity.Id),e.setRequestHeader(d.serverForm.RequestHeaderKeys.activityKey,t),d.browserActivity&&d.browserActivity.newInteraction(t),d.log.server&&d.log.server("ServerForm: Ping request sent at %s",o),d.ui.PerformanceTimer&&d.ui.PerformanceTimer._addAction("Ping"),d.ui.PerformanceTimer&&d.ui.PerformanceTimer._startAjax(t)},e.success=function(e,t,o){d.ui.PerformanceTimer&&d.ui.PerformanceTimer._stopAjax(),n=window.performance.now()-n,d.telemetry.pingCount<5&&(d.telemetry.addPingEvent(n),d.telemetry.pingCount++),d.log.server&&d.log.server("ServerForm: Ping response received in %s ms",n)},e.error=function(e,t,o){d.ui.PerformanceTimer&&d.ui.PerformanceTimer._stopAjax(),d.logError(o)},e.timeout=6e4,$.ajax(e)},d.serverForm.pingInterval),d.log.server&&d.log.server("ServerForm: New ping interval with id %s has been set",d.serverForm._pingTimeoutId)):d.log.server&&d.log.server("ServerForm: Ping is disabled via flighting and will not be reset.")},i.getCsrfTokenValue=function(){for(var e=d.serverForm.RequestHeaderKeys.tokenKey+"=",t=document.cookie.split(";"),o=0;o<t.length;o++){var n=t[o].trim();if(0===n.indexOf(e))return n.substr(e.length)}},i.setCsrfToken=function(e){var t=d.serverForm.getCsrfTokenValue();t&&e.setRequestHeader(d.serverForm.RequestHeaderKeys.tokenKey,t)},i.clearAffinity=function(){function e(e){var t=e+"=";if(-1<document.cookie.indexOf(t)){var o=new Date;o.setTime(o.getTime()-864e5),document.cookie=e+"=; expires="+o.toUTCString()+"; path=/; domain="+d.util.location.authority}}e(d.serverForm.RequestHeaderKeys.affinity),e(d.serverForm.RequestHeaderKeys.sfAffinity)},i.isInteractionCommand=function(e){return"function"==typeof e&&e._interactionCommand},i.CommandsAffectingSave=["SetValue","SetSelectedItem","ResolveChanges","NavigationAction","set_IsValid","ChangeSelectedIndex","ValueChanged"],i.PropertiesAffectingSave=["IsValid"],i.couldInteractionAffectSave=function(e){var t=!1;if(e)if("CommandInteraction"===e.$type){var o=e;i.CommandsAffectingSave.includes(o.CommandName)&&(t=!0)}else if("PropertyChangeInteraction"===e.$type){var n=e;i.PropertiesAffectingSave.includes(n.PropertyName)&&(t=!0)}return t},i.reset=function(e){d.serverForm.forceCloseAllPopouts(),d.shell.resetShellOnNavigation();var t=document.getElementById("PrimaryConductor");t&&(t.textContent=""),$(d.value(d.shell.dialogStack)).each(function(e,t){$(t).remove()}),$(d.value(d.shell.stack)).each(function(e,t){var o=d.context(t);o&&o.dialogStack()&&$(d.value(o.dialogStack)).each(function(e,t){$(t).remove()})}),d.shell.stack.clear(),d.shell.dialogStack.clear(),d.shell.activeMessageBox=null,$(document.body).off(),$(document).off(),d.messageManager.clear(),d.shell.browserInit(),d.telemetry.addSessionBeginEvent(),d.serverForm.defaultChannel._instance=null,d.serverForm.interactionManager&&d.serverForm.interactionManager.reset(),e&&delete d.serverForm.compilation.formsCache[e.toLowerCase()],window.focus()},i.trackRenderTime=function(e,t){if(d.debug.trackFormPerformance&&window.localStorage){var o=window.localStorage.getItem("$dyn.serverForm.performance");o&&(d.serverForm.performance=JSON.parse(o)),d.serverForm.performance||(d.serverForm.performance={}),d.serverForm.performance[e]||(d.serverForm.performance[e]=[]),d.serverForm.performance[e].unshift(Globalize.format(new Date,"MM/dd hh:mm")+" - "+t);try{window.localStorage.setItem("$dyn.serverForm.performance",JSON.stringify(d.serverForm.performance))}catch(e){d.util.localStorageErorrHandler(e.name)}}},i.resetPerfTracking=function(e,t){if(d.debug.trackFormPerformance&&window.localStorage){d.serverForm.performance={};try{window.localStorage.setItem("$dyn.serverForm.performance",JSON.stringify(d.serverForm.performance))}catch(e){d.util.localStorageErorrHandler(e.name)}}},d.ui.PerformanceTimer&&d.ui.PerformanceTimer._addNavBarButton()}($dyn=$dyn||{}),function(c){var e,t;function o(){this.datasourceMap={},this.propertyStates={}}e=c.serverForm||(c.serverForm={}),o.prototype.setProperty=function(e,t,o,n){var i=o?o.slice(0):[];if(e){var r=this.propertyStates[e];if(r)if(r[t])for(var a=0,s=i.length;a<s;a++){var l=r[t][a];if(null!=i[a]&&(c.isObservable(l)?l(i[a]):r[t][a]=i[a],this.datasourceMap[e])){var u=c.value(this.datasourceMap[e]);if(u&&u.items()[a]&&c.serverForm.ModelManager.modelVersions[n]){var d=u.items()[a].masterTrackingId;c.serverForm.ModelManager.modelVersions[n][d]=c.serverForm.ModelManager.getLastVersion()}else c.logWarning("$dyn.serverForm.VirtualizedProperties.setProperty: cannot find corresponding model for virtualized property - control: %s, property: %s, index: %s , formId: %s",e,t,a,n)}}else r[t]=i;else(r={})[t]=i;this.propertyStates[e]=r,this.getItemsChangedTrigger(e,t).raise()}},o.prototype.getProperty=function(e,t,o,n){null==o&&(o=0);var i=this.propertyStates[e],r=(i=i||(this.propertyStates[e]={}))[t],a=(r=r||(i[t]=[]))[o];if(void 0===a){if(o<0)return n;a=n}var s=a;return c.isObservable(a)||(s=r[o]=c.observable(a)),s},o.prototype.getItemsChangedTrigger=function(e,t){var o=this.propertyStates[e];if(o&&o[t]){var n=o[t];return n._itemsChanged||(n._itemsChanged=new c.eventHost),n._itemsChanged}},t=o,e.VirtualizedProperties=t,e.getVirtualValue=function(n,i,r,e){var a=e.dynVirtualizedProperties,t=c.computed(function(){var e=0,t=c.value(r);t&&(e=c.value(t.collectionIndex));var o=a.getProperty(n,i,e);return c.peek(o)});return c.serverForm.subscribeToVirtualizedPropertyChange(n,i,e,function(){t.valueChanged.raise()}),t},e.subscribeToVirtualizedPropertyChange=function(e,t,o,n){o.dynVirtualizedProperties.getItemsChangedTrigger(e,t).subscribe(n)}}($dyn=$dyn||{}),function(e){var t,o;function n(){this.buffer=[],this.bufferSize=5,this.currentIndex=0}t=e.serverForm||(e.serverForm={}),n.prototype.advanceBuffer=function(){this.currentIndex=(this.currentIndex+1)%this.bufferSize,this.buffer[this.currentIndex]=[]},n.prototype.addMessages=function(e){this.buffer[this.currentIndex]||(this.buffer[this.currentIndex]=[]),this.buffer[this.currentIndex]=this.buffer[this.currentIndex].concat(e)},n.prototype.getMessagesInOrder=function(){for(var e=[],t=0;t<this.bufferSize;t++){var o=this.buffer[(t+this.currentIndex)%this.bufferSize];o&&(e=e.concat(o))}return e},o=n,t.MessageInteractionBuffer=o,t.messageInteractionBuffer=new o}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(F){var e;(e=F.bindingFunctions||(F.bindingFunctions={})).$rowLabel=function(e){return F.getFieldObservable("_RowLabel_",e)},e.$command=function(S,I){function e(e,t,o,n,i,r){var a,s,l,u=this;F.log.blockUserInteraction&&F.log.blockUserInteraction("BlockUserInteraction: Interaction created CommandName: %s",I.CommandName);var d=I.Properties.ShouldBlockDeferred,c={$type:F.serverForm.InteractionType.command,CallbackId:"",CommandName:I.CommandName,complete:null,completeCommand:null,details:function(){return F.format("[Command interaction: role='{0}', command='{1}']",S._element.getAttribute("data-dyn-role"),I.CommandName)},FailureCallbackId:"",NamedParameters:{},NoAsyncIncrement:!1,PositionalParameters:null,PriorityPosition:!1,ResetThrottleTime:!1,RootId:0,ShouldBlockDeferred:function(){return d},ShouldBlockOnExecution:I.Properties.ShouldBlockOnExecution,TargetId:S._serverId,Throttle:!1,ThrottleFirst:!1,ThrottleId:"0",ThrottleTimestamp:0,ThrottleValue:0};c.RootId=F.serverForm.interactionHandler.getRootIdByElement(S._element),(e instanceof $.Event||e instanceof Event)&&(e=void 0),void 0!==e&&($.isArray(e)?(c.PositionalParameters=e,e=void 0):$.isPlainObject(e)||(F.logWarning("Arguments should be a plain object for named parameters or an array for positioned parameters: %O",e),e={Arg1:e}));var p=F.controlOptions(S._element);if(I.ParameterBindings){e=e||{};var h=Object.keys(I.ParameterBindings);try{for(var m=__values(h),v=m.next();!v.done;v=m.next()){var g=v.value,y=I.ParameterBindings[g];y&&(e[g]=F.value(p[y]))}}catch(e){a={error:e}}finally{try{v&&!v.done&&(s=m.return)&&s.call(m)}finally{if(a)throw a.error}}}c.beforeExecute=function(){n&&(F.logWarning("beforeExecuteCallback should not be provided, barring exceptional cases, until this public api is refactored"),n(c))},c.completeCommand=function(){c.complete&&c.complete()},c.complete=o,c.NamedParameters=e,c.ShouldBlockOnExecution=c.ShouldBlockOnExecution&&!(u&&u.IgnoreBlockingDiv&&u.IgnoreBlockingDiv(I.CommandName))||u&&u.ForceBlockingDiv&&u.ForceBlockingDiv(I.CommandName),c.Telemetry=F.util.stringToBoolean(I.Properties.Telemetry);var f=Math.min(null!==(l=I.Properties.ThrottleValue)&&void 0!==l?l:0,F.serverForm.maximumThrottleTime),b=I.Properties.ThrottleFirst,C=I.Properties.ThrottleGroup;c.ThrottleFirst=b,I.Properties.ResetThrottleTime&&(c.ResetThrottleTime=I.Properties.ResetThrottleTime),null!=C?(c.ThrottleId=c.RootId+"_"+C,c.Throttle=!0):0<f&&(c.ThrottleId=p.Id+"_"+I.CommandName),0<f&&(b=F.util.stringToBoolean(b),c.Throttle=x||b,c.Throttle&&(c.ThrottleValue=f),b||(x=!0,T&&T.cancel(),T=F.async(function(){x=!1,T=void 0},f,"Toggle throttle command"))),I.Properties.ExecuteImmediate||(c.NoAsyncIncrement=!0);var w=!1;(I.Properties.ExecuteImmediate||0<f&&!c.Throttle)&&(w=!0),I.Properties.PriorityPosition&&(c.PriorityPosition=!0);var _={channelType:F.serverForm.InteractionChannelType.byRootId,rootId:c.RootId};t?c.Throttle?F.serverForm.interactionManager.queueThrottledCommandInteraction(c,t,_,w,i,r):F.serverForm.interactionManager.queueCallbackCommandInteraction(c,t,_,w,r):c.Throttle?F.serverForm.interactionManager.queueThrottledCommandInteraction(c,null,_,w,i,r):F.serverForm.interactionManager.queueInteraction(c,_,w,r)}var T,x=!1;return e._interactionCommand=!0,e}}($dyn=$dyn||{}),function(b){(b.serverForm||(b.serverForm={})).serializers={},b.serverForm.serializers.json=b.serverForm.serializers[b.serverForm.ValueType.serialized]={deserialize:function(e){return void 0!==e&&""!==e?JSON.parse(e):void 0}},b.serverForm.serializers.plain=b.serverForm.serializers[b.serverForm.ValueType.string]={deserialize:function(e){return e}},b.serverForm.serializers[b.serverForm.ValueType.collection]={deserialize:function(e){var t=new Array;if(e)for(var o=e.$values,n=0,i=o.length;n<i;n++)t.push(JSON.parse(o[n]));return t}},b.serverForm.serializers.default=b.serverForm.serializers[b.serverForm.ValueType.object]={deserialize:function(e,t,o){if(e)return e&&e.$type&&e.$values?(e=e.$values,b.serverForm.serializers.default.deserialize(e,t,o)):e}},b.serverForm.serializers.InteractionCommand={deserialize:function(e,t){return b.bindingFunctions.$command(t,e)}},b.serverForm.serializers.Navigate={deserialize:function(e,l){var u=b.bindingFunctions.$command(l,e);return function(e,t){var o,n=b.serverForm.interactionHandler;if(l&&l._element){var i=b.controlOptions(l._element);i&&(o=b.value(i.FormName))}if(o&&b.serverForm.compilation.StaticLoader.staticLoaderOn){var r={name:o},a=b.shell.createForm(r),s=a.getAttribute("data-dyn-formid");n.blockInbound(!0),b.debug.trackFormPerformance&&a.dynPerformance&&(a.dynPerformance.requestStart=window.performance.now());u([s],function(){var e=b.serverForm.interactionHandler.getFormElement(s);e&&b.value(e.dynReadyState)===b.ui.ReadyState.request&&(e.dynReadyState(b.ui.ReadyState.aborted),b.shell._removeForm(e)),b.callFunction(t,this,arguments)}),b.serverForm.compilation.StaticLoader.load(o,a,s,n)}else u([])}}},b.serverForm.serializers.OpenPopup={deserialize:function(e,s){var l=b.bindingFunctions.$command(s,e);return function(e,t){var o;if(s&&(o=b.value(s.FormName)),o&&b.serverForm.compilation.StaticLoader.staticLoaderOn){var n=null,i=b.controlOptions(s._element);i&&(n=b.value(i.PopupId));var r=document.getElementById("form_"+n);if(n){var a=b.serverForm.interactionHandler;a.blockInbound(!0),b.debug.trackFormPerformance&&r.dynPerformance&&(r.dynPerformance.requestStart=window.performance.now()),l([n],t),b.serverForm.compilation.StaticLoader.load(o,r,n,a)}}else l([],t)}}},b.serverForm.serializers.InitPartForm={deserialize:function(e,t){var o=b.bindingFunctions.$command(t,e);return function(e){if(b.value(this.FormName))if(b.serverForm.compilation.StaticLoader.staticLoaderOn){var t=b.serverForm.interactionHandler;b.serverForm.compilation.StaticLoader.load(b.value(this.FormName),e,e.getAttribute("data-dyn-formid"),t)}else o([])}}},b.serverForm.serializers.ShouldCreatePartForm={deserialize:function(e,t){return function(i){var e=!0,r=this,a=i.partForm;if(b.value(r.LoadInline)){var t=null,o=function(){var n=b.serverForm.cachedPartFormInteractions[r._serverId];n&&(b.serverForm.partFormCacheUpdated.unsubscribe(t),b.async(function(){b.serverForm.registerForm({menuItem:b.value(r.ObjectName),targetElement:i.element}),b.serverForm.cachedPartFormInteractions[r._serverId]=null;var e=$('[data-dyn-role="PartForm"]',r.element)[0],t=n[0].RootId,o=e.getAttribute("data-dyn-clientid");n=[{$type:"ChangeViewModelIdInteraction",NewValue:t,PreviousValue:o,RootId:null,skipCache:!0}].concat(n),b.serverForm.interactionHandler.processInteractions(n),a.PartFormCreated(),b.setValue(r,"LoadInline",!1)},void 0,"Load inline PartForm descriptors."))};t=b.serverForm.partFormCacheUpdated.subscribe(o),o(),e=!1}if(e&&b.value(this.FormId)){var n=b.value(this.FormId),s={$type:b.serverForm.InteractionType.command,CommandName:"Reserialize",TargetId:n},l={channelType:b.serverForm.InteractionChannelType.byRootId,rootId:n};b.serverForm.interactionManager.queueInteraction(s,l,!0),e=!1}return e}}},b.serverForm.serializers.CreatePartForm={deserialize:function(e,t){return function(e){var t=this;if("Local"===e.mode){var o=e.partForm;b.async(function(){b.serverForm.registerForm({menuItem:b.value(t.ObjectName),targetElement:e.element}),b.callFunction(t.CreateForm,t,void 0,o.PartFormCreated.bind(o))},void 0,"Create part form local")}else"Remote"===e.mode&&b.async(function(){b.serverForm.getForm(e.resource)},void 0,"Create part form remote")}}},b.serverForm.serializers.GetTileData={deserialize:function(e,t){return function(){if(b.value(this.TileType)===b.ui.TileType.kpi){var e=b.value(this.KpiName);if(e){var t={$type:b.serverForm.InteractionType.getTileKpiValuesInteraction,CommandName:"GetTileKpiValuesInteraction",ShouldBlockOnExecution:!1,TargetId:e},o={channelType:b.serverForm.InteractionChannelType.available};b.serverForm.interactionManager.queueCallbackCommandInteraction(t,this.updateKpiFromJson,o,!0)}}else b.logWarning("Tiles: GetTileData was called by a non-KPI tile.")}}},b.serverForm.serializers.ChangeSelectedIndex={deserialize:function(v,e){var g=b.bindingFunctions.$command(e,v),y=$.extend(!0,{},v);y.Properties.ThrottleValue=0,y.Properties.ExecuteImmediate=!0;var f=b.bindingFunctions.$command(e,y);return function(e){function t(e){e.PositionalParameters[0]=p.recalculateRowIndex(o),u&&u()}var o=e[0],n=e[1],i=e[2],r=e[3],a=e[4],s=e[5],l=e[6],u=e[7],d=e[8],c=e[9],p=this,h=[o,n,i];l?h.push(!0):d&&h.push(!1),d&&h.push(!0);function m(){a&&a(!1)}if(r){b.log.server&&b.log.server("ServerForm: Send throttled change row interaction to row index %s",o);v.Properties.ShouldBlockOnExecution=!!c,g.call(this,h,a,s,t,function(){a&&a(-1)},m)}else b.log.server&&b.log.server("ServerForm: Send unthrottled change row interaction to row index %s",o),y.Properties.ShouldBlockOnExecution=!!c,f.call(this,h,a,s,t,null,m)}}},b.serverForm.serializers.SelectCell={deserialize:function(e,t){var a=b.bindingFunctions.$command(t,e),s=Object.create(e);s.Properties=Object.create(e.Properties),s.Properties.ThrottleValue=0,s.Properties.ExecuteImmediate=!0;var l=b.bindingFunctions.$command(t,s);return function(e){var t=e[0],o=e[1],n=e[2],i=e[3],r=e[4]||!1;n===b.ui.InputType.keyboard?a.call(this,[t,o,i]):(s.Properties.PriorityPosition=r,l.call(this,[t,o,i]))}}},b.serverForm.serializers.PersistPersonalization={deserialize:function(e,t){var o=b.bindingFunctions.$command(t,e),n=b.serverForm.interactionHandler.getRootIdByElement(t._element),i={channelType:b.serverForm.InteractionChannelType.byRootId,rootId:n};return function(e){b.serverForm.interactionManager.removePendingPersonalization(t._serverId,e[0],i),o.call(this,e)}}},b.serverForm.serializers.ActionInteractionCommand=b.serverForm.serializers.InteractionCommand}($dyn=$dyn||{});__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=this&&this.__read||function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,i,r=o.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(n=r.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(o=r.return)&&o.call(r)}finally{if(i)throw i.error}}return a},__spreadArray=this&&this.__spreadArray||function(e,t,o){if(o||2===arguments.length)for(var n,i=0,r=t.length;i<r;i++)!n&&i in t||((n=n||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))};!function(W){!function(M){var e;(e=M.InteractionHandlerFunction||(M.InteractionHandlerFunction={})).processInteractions="processInteractions",e.detachFormForPopout="detachFormForPopout",e._prepFormForPopout="_prepFormForPopout",e.reserializeForm="reserializeForm";var t=(o.prototype.getFormElement=function(e){var t=this.forms[e];return t=t||document.getElementById("form_"+e)},o.prototype.getForm=function(e){var t,i=e.targetElement;if(!i)throw new Error("options.targetElement is required");if(!W.popout||W.parentWindow){var r,a,o,n=i.getAttribute("data-dyn-formid");if(e.menuItem){var s=e.menuItem.split(":");s&&2===s.length?(a=s[1].toLowerCase(),r=W.serverForm.FormOpenMethod.find(s[0])):a=e.menuItem;var l=W.controlOptions(i);l=l||(i.dynOptions={}),W.setValue(l,"MenuItemName",a),r=r||W.serverForm.FormOpenMethod.Display}else a=e.name,r=W.serverForm.FormOpenMethod.Form;if(e.pagetype&&(o=W.serverForm.FormViewOption.find(e.pagetype)),i){var u=null==e.ShouldBlockOnExecution||e.ShouldBlockOnExecution;t={$type:W.serverForm.InteractionType.getForm,ArgFilter:e.DataFilter,NavigationPath:null!=e.NavigationPath&&1<e.NavigationPath.length?e.NavigationPath.slice(0,e.NavigationPath.length-1):void 0,ObjectName:a,OpenMethod:r,PageType:o,PartHostViewConfiguration:e.PartHostViewConfiguration,RecordContext:e.recordcontext,ShouldBlockOnExecution:u,TargetId:n}}else(t=e).$type=W.serverForm.InteractionType.getForm;this.forms[n]=i,e.callback||(e.callback=function(e){var t=0<e,o=W.context(i),n=!(!o||!W.value(o.IsOpen));t!=n&&W.log.server&&W.log.server.error("ServerForm: Unexpected form state after getForm interaction: %s, type: %s, openedForm: %s, isOpen: %s",a,r,t,n),t||n||(-1===e?W.log.server&&W.log.server("ServerForm: Removing form after unsuccessful getForm interaction: %s, type: %s",a,r):W.log.server&&W.log.server("ServerForm: No form return with getForm interaction: %s, type: %s",a,r),i.parentNode&&(i.parentNode.removeChild(i),W.unbind(i)))});var d={channelType:W.serverForm.InteractionChannelType.any,formPart:e.formPart};W.serverForm.compilation.StaticLoader.staticLoaderOn&&e.name&&!e.formPart?(this.blockInbound(!0),t.PartialDelta=!0,W.serverForm.interactionManager.queueCallbackCommandInteraction(t,e.callback,d,!0),W.serverForm.compilation.StaticLoader.load(e.name,i,n,this)):W.serverForm.interactionManager.queueCallbackCommandInteraction(t,e.callback,d,!0)}else W.log.server&&W.log.server("Cannot get form in popout window if we have no link to parent window.")},o.prototype._prepFormForPopout=function(e){W.serverForm.saveTransitState(e)},o.prototype.detachFormForPopout=function(e){var t=this.getFormElement(e),o=t&&t.dynOptions&&t.dynOptions._allControls;t.dynOptions._allControls=null;var n=W.context(t);return n&&(W.shell.browserHistory.goingBack=!1,n.detachedForPopout=!0,W.shell.close({form:n})),delete this.forms[e],W.serverForm.ModelManager.removeFormModelsAndCollections(e),o&&this._cleanupControls(o),W.serverForm._windowManager.notifyFormDetached(e),!0},o.prototype.reserializeForm=function(e){var t={context:W.serverForm.getModel(e),id:e,role:"Form"},o=(W.shell.createForm(t),{$type:W.serverForm.InteractionType.command,CommandName:"Reserialize",ShouldBlockOnExecution:!0,TargetId:e}),n={channelType:W.serverForm.InteractionChannelType.byRootId,rootId:e};W.serverForm.interactionManager.queueCallbackCommandInteraction(o,function(){W.serverForm._windowManager.notifyFormReserialized(e)},n,!0)},o.prototype.getRootIdByElement=function(e){return e.getAttribute("data-dyn-rootserverid")},o.prototype.handleMessages=function(e){if(e.origin===W.util.getOrigin(W.util.location.location)){var t=e.data;if("object"==typeof t&&"InteractionHandler"===t.source)switch(t.commandName){case W.serverForm.InteractionHandlerFunction.processInteractions:W.serverForm.interactionHandler.processInteractions(t.interactions);break;case W.serverForm.InteractionHandlerFunction.detachFormForPopout:W.serverForm.interactionHandler.detachFormForPopout(t.rootId);break;case W.serverForm.InteractionHandlerFunction._prepFormForPopout:W.serverForm.interactionHandler._prepFormForPopout(t.rootId);break;case W.serverForm.InteractionHandlerFunction.reserializeForm:W.serverForm.interactionHandler.reserializeForm(t.rootId)}"callback"===t.source&&("function"==typeof W.serverForm.idToWindowFunction[t._functionId]?(W.serverForm.idToWindowFunction[t._functionId](t._result),W.log.server&&W.log.server("InteractionHandler: Calling function with functionId: "+t._functionId)):W.log.server&&W.log.server("InteractionHandler: Cannot call window function with functionId: "+t._functionId+" as it does not exist in the mapping."),W.serverForm.idToWindowFunction[t._functionId]=null)}},o.prototype.processInteractions=function(e,t){if(!t&&!0===this._inboundBlocked)return null==this._penndingInboundInteractions&&(this._penndingInboundInteractions=[]),void this._penndingInboundInteractions.push.apply(this._penndingInboundInteractions,e);W.ui.updating(!0),W.ui.layout(!0),this.processingInteractions=!0;for(var o,n=[],i=[],r=[],a=[],s=[],l=[],u=[],d={},c={},p=0,h=e.length;p<h;p++)if((o=e[p]).Descriptor&&o.Descriptor.ValueProperties&&o.Descriptor.ValueProperties.InlineLoadingKey&&!o.skipCache){var m=o.RootId;if(!W.serverForm.interactionHandler.getFormElement(m)){var v=o.Descriptor.ValueProperties.InlineLoadingKey;d[m]=v}}var g={};for(p=0,h=e.length;p<h;p++)if(o=e[p],d[o.RootId])v=d[o.RootId],o.skipCache=!0,c[v]||(c[v]=[]),c[v].push(o);else switch(o.$type){case W.serverForm.InteractionType.createModel:case W.serverForm.InteractionType.updateModel:case W.serverForm.InteractionType.updateModelCollection:"ClientMessageLog"===o.RootId?i.push(o):r.push(o);break;case W.serverForm.InteractionType.changeViewModelId:n.push(o);break;case W.serverForm.InteractionType.createViewModel:case W.serverForm.InteractionType.updateViewModel:case W.serverForm.InteractionType.deleteViewModel:if(o.Descriptor&&"ClientUserSession"===o.Descriptor.Name)s.push(o);else if(o.Descriptor&&"ClientNotifications"===o.Descriptor.Name)l.push(o);else if(a.push(o),o.$type===W.serverForm.InteractionType.deleteViewModel){var y=void 0,f=this.getFormElement(o.TargetId);f&&(y=W.context(f))&&(y.willBeClosed=!0),g[o.TargetId]=y}break;case W.serverForm.InteractionType.setLookupValue:s.push(o);break;case W.serverForm.InteractionType.commandCallback:u.push(o);break;case W.serverForm.InteractionType.navigate:W.shell.navigateUrl(o.NamedParameters)}var b=!1;for(var v in c)W.serverForm.cachedPartFormInteractions[v]=c[v],b=!0;if(b&&W.serverForm.partFormCacheUpdated.raise(),this._handleChangeId(n),this._handleFormDeleteMessages(g,i),r=i.concat(r),W.serverForm.ModelManager._updateVersion(),this._handleViewInteractions(s),this._handleNotificationInteractions(l),this._handleModelInteractions(r),this._handleViewInteractions(a),this._handleCommandCallbacks(u),W.serverForm.ModelManager.insertedRecordsAbove){if(W.serverForm.ModelManager.lastReceivedLoadDirection===W.ui.ScrollDirection.none){W.serverForm.ModelManager.lastReceivedLoadDirection=W.ui.ScrollDirection.up;var C=!1;if(W.DataCacheManager[W.serverForm.ModelManager.activeRootId])for(var w in W.DataCacheManager[W.serverForm.ModelManager.activeRootId])if(W.DataCacheManager[W.serverForm.ModelManager.activeRootId][w])for(var _ in W.DataCacheManager[W.serverForm.ModelManager.activeRootId][w])if(W.DataCacheManager[W.serverForm.ModelManager.activeRootId][w][_]){var S=W.DataCacheManager[W.serverForm.ModelManager.activeRootId][w][_];if(S.hasRenderCallPending()){S.resetLoadDirection(),C=!0;break}}C||(W.serverForm.ModelManager.lastRequestedLoadDirection=W.ui.ScrollDirection.none,W.serverForm.ModelManager.lastReceivedLoadDirection=W.ui.ScrollDirection.none)}W.serverForm.ModelManager.insertedRecordsAbove=!1,W.serverForm.ModelManager.activeRootId=""}this.processingInteractions=!1,this._updatedTask&&this._updatedTask.start(),W.ui.updating(!1),this._updatedTask&&this._updatedTask.stop(),W.ui.layout(!1)},o.prototype.blockInbound=function(e){return void 0!==e&&this._inboundBlocked!==e&&(this._inboundBlocked=e,!this._inboundBlocked&&this._penndingInboundInteractions&&0<this._penndingInboundInteractions.length&&(this.processInteractions(this._penndingInboundInteractions),this._penndingInboundInteractions=null)),this._inboundBlocked},o.prototype.closeFormByRootId=function(e){var t=this.getFormElement(e);t&&this._closeForm(t),delete this.forms[e],W.DataCacheManager[e]&&delete W.DataCacheManager[e],W.GroupInfoManager[e]&&delete W.GroupInfoManager[e],W.serverForm.ModelManager.removeFormModelsAndCollections(e),W.serverForm.interactionManager&&W.serverForm.interactionManager.updateMapOnFormDelete&&W.serverForm.interactionManager.updateMapOnFormDelete(e)},o.prototype._cloneProperties=function(e,t,o){var n,i,r,a,s,d=null===(n=null==o?void 0:o._dataSourceContext)||void 0===n?void 0:n.current,c=Object.create(t);if(d&&d.DataSource instanceof W.serverForm.Model?d=c.DataSource=d.DataSource:c.DataSource=d,t&&t._descriptor){var l=t._name,p=null===(r=null===(i=null==o?void 0:o.context)||void 0===i?void 0:i.scopeVars)||void 0===r?void 0:r.$list,h=null==p?void 0:p.DataSource,u=null===(a=null==p?void 0:p.Root)||void 0===a?void 0:a.element,m=null===(s=null==p?void 0:p.Root)||void 0===s?void 0:s.DataSource,v=t._descriptor.virtualProperties,g=t._descriptor.virtualizedPropertyChanged;if(g&&g.subscribe(function(e){p&&e&&0<Object.keys(e).length&&(W.log.server&&W.log.server("ServerForm: List schema changed: %s - %o",p.Name,e),p.updateSchema())}),v)for(var y in v){var f=v[y];f=f||W.serverForm.getVirtualValue,c[y]=f(l,y,d,u),p&&W.serverForm.subscribeToVirtualizedPropertyChange(l,y,u,p.dataChanged)}var b=t._descriptor.referenceProperties,C=t._descriptor.referencePropertyChanged;if(C&&C.subscribe(function(e){p&&e&&0<e.length&&(W.log.server&&W.log.server("ServerForm: List schema changed: %s - %o",p.Name,e),p.updateSchema())}),b){var w=function(e){var t=b[e],o=c[e]=W.observable(),n=o.__ModelName=W.serverForm.getCollectionName(t.ModelName),i=o.__ModelFieldName=W.serverForm.getPropertyName(t.ModelFieldName),r=W.getModel(n,d);if(r){var a=W.getFieldObservable(i,r);W.oneWayBinding(a,o)}if(p&&m)if(t&&t.ModelName===m.collectionName)m.propertyChanged().subscribe(p.rerender);else{var s=m.getRelatedCollection(n);if(s)if(null==W.value(s.masterDataSourceName))var l=s.masterDataSourceName.valueChanged.subscribe(function(e){if(void 0!==e){var t=W.serverForm.getCollectionName(W.value(e));h&&h.__boundDataSource&&t===h.__boundDataSource.name?s.itemsChanged().subscribe(p.dataChanged):s.itemsChanged().subscribe(p.rerender),s.masterDataSourceName.valueChanged.unsubscribe(l)}});else{var u=W.serverForm.getCollectionName(W.value(s.masterDataSourceName));h&&h.__boundDataSource&&u===h.__boundDataSource.name?s.itemsChanged().subscribe(p.dataChanged):s.itemsChanged().subscribe(p.rerender)}}};for(var _ in b)w(_)}}return c},o.prototype.clone=function(e){var t=e.root;if(t){var o=t.element;if(o){var n=e.targetElement.getAttribute("data-dyn-controlname"),i=W.serverForm.getElement(n,o.dynOptions);if(i)return this._cloneProperties(e.targetElement,i.dynOptions,e)}else W.log.server&&W.log.server("ServerForm: Root not found: element: %o",e.targetElement)}},o.prototype._handleChangeId=function(e){for(var t=0,o=e.length;t<o;t++){var n=e[t],i=this.getFormElement(n.PreviousValue);this.forms[n.NewValue]=i,delete this.forms[n.PreviousValue];var r=W.context(i);if(r)r.Id=n.NewValue;else{if(!i)return void W.logError("Shell: Cannot update formId=%s: no such form element",n.PreviousValue);i.setAttribute("id","form_"+n.NewValue),i.setAttribute("data-dyn-formid",n.NewValue)}var a=W.serverForm.ModelManager.getModel(n.PreviousValue);delete W.serverForm.ModelManager.models[n.PreviousValue],a.id=n.NewValue,W.serverForm.ModelManager.trackModel(a,n.NewValue),a.parent&&a.parent.UseReactGrid&&(W.DataCacheManager[n.PreviousValue]&&(W.DataCacheManager[n.NewValue]=W.DataCacheManager[n.PreviousValue],delete W.DataCacheManager[n.PreviousValue]),W.GroupInfoManager[n.PreviousValue]&&(W.GroupInfoManager[n.NewValue]=W.GroupInfoManager[n.PreviousValue],delete W.GroupInfoManager[n.PreviousValue]))}},o.prototype._handleModelInteractions=function(e){var t,o,n,i,r,a;this._modelInteractionsTask&&this._modelInteractionsTask.start();var s=[],l=[],u={},d={};try{for(var c=__values(e),p=c.next();!p.done;p=c.next()){var h=p.value;if(h.$type===W.serverForm.InteractionType.createModel)l.push(h);else if(h.$type===W.serverForm.InteractionType.updateModel){var m=h.Descriptor.Id;if(u[m]){if(W.logWarning("Multiple updates for single model"),h.Descriptor.Properties)if(u[m].Descriptor.Properties.MasterTrackingId&&u[m].Descriptor.Properties.MasterTrackingId!==h.Descriptor.Properties.MasterTrackingId){var v=u[m];u[m]=h,d[m]=v}else for(var g in h.Descriptor.Properties)u[m].Descriptor.Properties[g]=h.Descriptor.Properties[g]}else u[m]=h}else h.$type===W.serverForm.InteractionType.updateModelCollection&&s.push(h)}}catch(e){t={error:e}}finally{try{p&&!p.done&&(o=c.return)&&o.call(c)}finally{if(t)throw t.error}}try{for(var y=__values(l),f=y.next();!f.done;f=y.next()){var b=f.value,C=b.RootId;W.log.server&&W.log.server("ServerForm: Adding record: %s, datasource: %s",b.Descriptor.Id,b.Descriptor.Name),this._handleUpdateModelInteraction(b,C)}}catch(e){n={error:e}}finally{try{f&&!f.done&&(i=y.return)&&i.call(y)}finally{if(n)throw n.error}}try{for(var w=__values(s),_=w.next();!_.done;_=w.next()){var S=_.value;W.log.server&&W.log.server("ServerForm: Updating data source: %s",S.Descriptor.Name);var I=W.serverForm.ModelManager.getModel(S.RootId);if(I){if(S.Descriptor&&S.Descriptor.Name){C=I._formId;var T=I.getRelatedCollection(W.serverForm.getCollectionName(S.Descriptor.Name));T.UseReactGrid&&(T.mergeModelUpdates(S.Descriptor,u),T.mergeExtraModelUpdates(S.Descriptor,d)),T.deserialize(S.Descriptor,C)}}else W.logError("ServerForm: Failed to find model for rootId=%s",S.RootId)}}catch(e){r={error:e}}finally{try{_&&!_.done&&(a=w.return)&&a.call(w)}finally{if(r)throw r.error}}for(var x=Object.keys(u),F=0,k=x.length;F<k;F++){var P=u[x[F]];W.log.server&&W.log.server("ServerForm: Updating record: %s",P.Descriptor.Id),this._handleUpdateModelInteraction(P)}var R=Object.keys(d);for(F=0,k=R.length;F<k;F++){var M=d[R[F]];W.log.server&&W.log.server("ServerForm: Updating record: %s",M.Descriptor.Id),this._handleUpdateModelInteraction(M)}this._modelInteractionsTask&&this._modelInteractionsTask.stop(),W.serverForm.UpdateModelManager.raiseChanges()},o.prototype._handleUpdateModelInteraction=function(e,t){var o,n,i,r,a=e.Descriptor.Id,s=!1,l="";if(W.util.isFlightEnabled(W.reactGrid.featureName)){var u=e.Descriptor.Properties.MasterTrackingId;l=e.Descriptor.Properties.dataSourceName_internal,u&&l&&e.RootId?(r=W.serverForm.ModelManager.getModel(e.RootId))&&r.getValue("UseReactGrid")&&(s=!0,a=(l=W.serverForm.getCollectionName(l))+"_"+u):e.Descriptor.Name&&0<e.Descriptor.Name.lastIndexOf("_form")||W.log.reactList&&W.log.reactList("updateModel with no mastertrackingid: "+e.Descriptor.Id)}var d,c,p,h=!1,m=!1,v=-1,g="",y=W.reactGrid.GroupingManager.flightEnabled(),f=W.serverForm.ModelManager.getModel(a);if(f)t=t||f._formId;else if(f=new W.serverForm.Model,s){d=r.getRelatedCollection(l),t=t||r._formId,f.parent=d,f.collectionName=d.name;var b=null===(n=e.Descriptor.Properties)||void 0===n?void 0:n.previous_MasterTrackingId,C=parseInt(b,10);if(!isNaN(b)&&0<C&&(c=M.ModelManager.getModel("".concat(l,"_").concat(b),t))){y&&(g=c.getValue(W.reactGrid.PARENT_GROUP_KEY));var w=c.collectionIndex;-1<w&&(v=w+1)}var _=null===(i=e.Descriptor.Properties)||void 0===i?void 0:i.next_MasterTrackingId,S=parseInt(_,10);if(!isNaN(S)&&0<S){var I=null==(p=M.ModelManager.getModel("".concat(l,"_").concat(_),t))?void 0:p.collectionIndex;-1===v&&-1<I&&(v=I)}-1<v&&(f.collectionIndex=v,h=!0,c&&!p&&(m=!0))}if(f.deserialize(e.Descriptor,t),h&&W.isObservableArray(d.items)){if(d.items.splice(v,0,f),c&&c.getValue("next_MasterTrackingId")!==f.masterTrackingId&&c.setValue("next_MasterTrackingId",f.masterTrackingId),p&&p.getValue("previous_MasterTrackingId")!==f.masterTrackingId&&p.setValue("previous_MasterTrackingId",f.masterTrackingId),!m){if(M.ModelManager.insertedRecordsAbove=!0,M.ModelManager.activeRootId=t,c&&void 0===c.collectionIndex){for(var T=[],x=c;x;)T.unshift(x),x=M.ModelManager.getModel("".concat(l,"_").concat(x.getValue("previous_MasterTrackingId")),t);0<T.length&&(T[0].collectionIndex=v,(o=d.items).splice.apply(o,__spreadArray([v,0],__read(T),!1)))}for(var F=v+1;F<W.length(d.items);F++)W.value(d.items)[F].collectionIndex=F}var k=M.getCollectionName(W.value(d.masterDataSourceName)),P=k===d.name;if(y&&P&&t&&k)if(m){var R=[f];d.addPostUpdateAction(function(){W.reactGrid.GroupingManager.addNewRowsToGroupingManger(t,k,R,g)})}else d.addPostUpdateAction(function(){W.reactGrid.GroupingManager.updateHeadersAndRerender(t,k)})}},o.prototype._handleFormDeleteMessages=function(e,t){var o,n,i,r,a,s,l=t[0],u=e?Object.keys(e):[];if(null!==(a=null==l?void 0:l.Descriptor)&&void 0!==a&&a.Items&&null!=u&&u.length)try{for(var d=__values(u),c=d.next();!c.done;c=d.next()){var p=c.value,h=e[p];try{for(var m=(i=void 0,__values(l.Descriptor.Items)),v=m.next();!v.done;v=m.next()){var g=v.value;(g.Item.Properties.formUniqueId==p||null!==(s=null==h?void 0:h.containsPartForm)&&void 0!==s&&s.call(h,g.Item.Properties.formUniqueId))&&(g.Item.Properties.formContext="",g.Item.Properties.formName="",g.Item.Properties.formUniqueId=""),g.Item.Properties.parentFormUniqueId==p&&(g.Item.Properties.parentFormUniqueId="")}}catch(e){i={error:e}}finally{try{v&&!v.done&&(r=m.return)&&r.call(m)}finally{if(i)throw i.error}}}}catch(e){o={error:e}}finally{try{c&&!c.done&&(n=d.return)&&n.call(d)}finally{if(o)throw o.error}}},o.prototype._handleNotificationInteractions=function(e){this._notificationsTask&&this._notificationsTask.start();for(var t=0,o=e.length;t<o;t++){var n=e[t].Descriptor.ValueProperties.Notifications;if(""!==n){var i=JSON.parse(n);W.AddNotifications(i)}}this._notificationsTask&&this._notificationsTask.stop()},o.prototype._handleViewInteractions=function(e){var t,o,n,i,r,a,s,l;if(this._viewInteractionsTask&&this._viewInteractionsTask.start(),0<e.length)for(var u,d=void 0,c=0,p=e.length;c<p;c++){var h=e[c],m=!0;if(this._viewInteractionTask&&this._viewInteractionTask.start(h.Descriptor&&h.Descriptor.Name),h.$type===W.serverForm.InteractionType.createViewModel||h.$type===W.serverForm.InteractionType.updateViewModel){var v=h.Descriptor;if(this._fixDescriptor(v),"ClientUserSession"===h.Descriptor.Name)u=W.user().element,W.value(u.dynReadyState)!==W.ui.ReadyState.ready&&(W.user().MaxWaitTimeToFailInMinutes.valueChanged.subscribe(W.serverForm.setMaxWaitTimeToFailInMinutes),W.user().WebClientStatefulSessionTimeoutInSeconds.valueChanged.subscribe(W.serverForm.setWebClientStatefulSessionTimeoutInSeconds)),W.setObservableValue(u,"dynReadyState",W.ui.ReadyState.ready),h.Descriptor.SerializedValueProperties&&h.Descriptor.SerializedValueProperties.AosDraining&&(W.serverForm.aosDraining=W.util.stringToBoolean(h.Descriptor.SerializedValueProperties.AosDraining));else if(h.RootId==v.Id){if(u=this.getFormElement(v.Id)){var g=u.getAttribute("data-dyn-role"),y=W.value(u.dynReadyState);!g||!v.TypeName||g===v.TypeName||y!==W.ui.ReadyState.loading&&y!==W.ui.ReadyState.request&&y!==W.ui.ReadyState.uninitialized||u.hasAttribute("data-dyn-childform")||(W.logError("ServerForm: Form role changed: old - %s, new - %s",g,v.TypeName),this._closeForm(u),W.debug.trackFormPerformance&&u.dynPerformance&&(d=u.dynPerformance),u=null)}if(!u){var f=W.serverForm.getModel(v.Id);if(u=this.forms[v.Id]=W.shell.createForm({context:f,id:v.Id,name:this._getFormName(v),role:v.TypeName}),W.debug.trackFormPerformance&&d&&(u.dynPerformance=d),v.ValueProperties){var b=v.ValueProperties.anchorRootId;if(b){var C=this.getFormElement(b),w=W.ui.findControl(v.ValueProperties.anchorId,C);if(w)if(null===(n=w.isInGrid)||void 0===n||!n.call(w)||null!==(i=w.isInTable)&&void 0!==i&&i.call(w)||null===(r=w.Root)||void 0===r||!r.UseReactGrid()||W.reactGrid.requestPopupOptions(w),w.Popup){var _=$(u);if(w.Popup(_),W.value(w.Visible)){if("MultilineInput"===w.TypeName){var S=w;if(!S.ShowLookupButton()){var I={flyout:_,highlyResponsive:!0,of:S.$inputElement,positionResize:!0,requestPopup:w.showPopup,routeMessagesToParent:!0,show:S.ShowFlyout};if(W.util.flyout(I,!1),S.flyoutDisposables)try{for(var T=(t=void 0,__values(S.flyoutDisposables)),x=T.next();!x.done;x=T.next())x.value.dispose()}catch(e){t={error:e}}finally{try{x&&!x.done&&(o=T.return)&&o.call(T)}finally{if(t)throw t.error}}S.flyoutDisposables=[I.showSubscriber,I.activeFlyoutSubscriber]}}W.value(w.ShowFlyout)||w.ShowFlyout(!0)}else W.log.server&&W.log.server("Serverform: a flyout was requested when it's anchor was not visible"),m=!1}else W.logError("anchorContext does not have a Popup");else W.setObservableValue(u,"dynReadyState",W.ui.ReadyState.aborted)}}W.value(u.dynReadyState)!==W.ui.ReadyState.aborted&&W.setObservableValue(u,"dynReadyState",W.ui.ReadyState.loading)}if(!u.getAttribute("data-dyn-role")){u.setAttribute("data-dyn-role",v.TypeName);var F=W.serverForm.ModelManager.getModel(u.getAttribute("data-dyn-formid"));W.dataBind(u,new W.DataContext(F));var k=W.context(u);k&&k.OnClientFormLoaded&&k.OnClientFormLoaded()}}else u=this.getFormElement(h.RootId);if(u){var P=W.value(u.dynReadyState);h.RootId==v.Id&&P!==W.ui.ReadyState.ready&&P!==W.ui.ReadyState.preloading&&(W.debug.trackFormPerformance&&u.dynPerformance&&(u.dynPerformance.requestEnd=window.performance.now(),u.dynPerformance.requestTime=u.dynPerformance.requestEnd-u.dynPerformance.requestStart),P!==W.ui.ReadyState.aborted&&W.setObservableValue(u,"dynReadyState",W.ui.ReadyState.loading),W.debug.trackFormPerformance&&u.dynPerformance&&(u.dynPerformance.loadingStart=window.performance.now()),u.setAttribute("data-dyn-serverid",v.Id),u.setAttribute("data-dyn-rootserverid",v.Id));var R=u.dynOptions||{};R._element=u;var M=W.dataSource(u),E=void 0;if(h.RootId==v.Id){if(!u.getAttribute("data-dyn-form-name")&&v.ValueProperties&&v.ValueProperties.FormName){var N=v.ValueProperties.FormName;u.setAttribute("data-dyn-form-name",N)}(E=R)._allControls||(E._allControls={}),R&&"PartForm"===R.TypeName||!v.ValueProperties||null===v.ValueProperties.RecordContext||void 0===v.ValueProperties.RecordContext||W.ui.updateQueryStringParameter("q",v.ValueProperties.RecordContext?v.ValueProperties.RecordContext:null)}else E=W.serverForm.getControlParams(v.Name,R);if(E&&this._applyDelta(R,E,v,M,!1),m){var A=W.value(u.dynReadyState),D=W.context(u);h.RootId==v.Id&&D&&(A===W.ui.ReadyState.aborted||W.value(D.IsFormReady)&&A===W.ui.ReadyState.loading)&&this._openForm(u),D&&W.isObservable(D.ActiveControl)&&A===W.ui.ReadyState.ready&&R.activeControlCreated&&D.ActiveControl.valueChanged.raise()}delete R.activeControlCreated}else W.log.server&&W.log.server("Serverform: Applying delta--no root element found! (expected id %s)",h&&h.RootId?h.RootId:"<unknown>")}else if(h.$type===W.serverForm.InteractionType.deleteViewModel)this.closeFormByRootId(h.RootId);else if(h.$type===W.serverForm.InteractionType.setLookupValue){u=this.getFormElement(h.RootId);var L=W.context(u),O=h.NamedParameters,B=W.ui.findControl(O.ControlName,u);if(!B&&L){var V=W.ui.findFlyoutControlElement(O.ControlName,L.Id);B=W.context(V)}if(B){var H=B;if(null===(a=H.isInGrid)||void 0===a||!a.call(H)||null!==(s=H.isInTable)&&void 0!==s&&s.call(H)||null===(l=H.Root)||void 0===l||!l.UseReactGrid())if(O.SyncValueFromModel)H.syncValues&&H.syncValues();else{var G=O.Value;if(H.ReferenceGroup)H.ReferenceGroup.setChildValue(H,G);else{if(void 0===H.IsServerLookupControl&&B.element){var z=B.element.getAttribute("data-dyn-serverid");H.IsServerLookupControl=null!=z}H.IsServerLookupControl?H.updateFormattedValue(G):(H.setValue(G),H.isDisplayedValueDirty&&H.isDisplayedValueDirty()&&H.syncValues())}}else H.listControl.setLookupValue(O.ControlName,O.Value,O.SyncValueFromModel)}}this._viewInteractionTask&&this._viewInteractionTask.stop(h.Descriptor&&h.Descriptor.Name)}this._viewInteractionsTask&&this._viewInteractionsTask.stop(),W.util.isFlightEnabled(W.reactGrid.featureName)&&W.reactGrid.appliedVirtualizedProperty&&(W.reactGrid.appliedVirtualizedProperty=!1,W.serverForm.UpdateModelManager.raiseChanges())},o.prototype._getFormName=function(e){var t=e.Name;return t.endsWith("_form")?t.substring(0,t.length-"_form".length):t},o.prototype._openForm=function(e){var t=W.context(e),o=t.FormName;if(this._openFormTask&&this._openFormTask.start(o),W.shell.open({form:t}),W.debug.trackFormPerformance&&e.dynPerformance&&(e.dynPerformance.loadingEnd=window.performance.now(),e.dynPerformance.loadTime=e.dynPerformance.loadingEnd-e.dynPerformance.loadingStart),W.value(e.dynReadyState)!==W.ui.ReadyState.aborted&&W.setObservableValue(e,"dynReadyState",W.ui.ReadyState.ready),W.debug.trackFormPerformance&&e.dynPerformance){e.dynPerformance.navigationTime=e.dynPerformance.loadingEnd-e.dynPerformance.navigationStart;var n=Math.round(e.dynPerformance.navigationTime),i={targetType:t.TypeName,duration:n};W.telemetry.addPerformanceEvent(o,t.Id,W.telemetry.PerformanceEvents.openStop,i),W.log.performance&&W.log.performance("performance: Form navigation time: %s, %s (ms)",o,n),W.log.performance&&W.log.performance("performance: Form load time: %s, %s (ms)",o,e.dynPerformance.loadTime),W.serverForm.trackRenderTime(o,e.dynPerformance.loadTime)}this._openFormTask&&this._openFormTask.stop(o)},o.prototype._closeForm=function(e){var t=null;if(e){e.dynOptions&&e.dynOptions._allControls&&(t=e.dynOptions._allControls,e.dynOptions._allControls=null),e.dynVirtualizedProperties&&(e.dynVirtualizedProperties=null);var o=W.context(e);if(o){for(var n=W.length(o.dialogStack)-1;0<=n;n--){var i=W.value(o.dialogStack)[n];this._closeForm(i)}o.PrepareClientOnlyClose&&o.PrepareClientOnlyClose(),W.shell.close({form:o})}t&&this._cleanupControls(t)}},o.prototype._cleanupControls=function(e){if(e)for(var t=Object.keys(e),o=0,n=t.length;o<n;o++){var i=e[t[o]]._element;i&&!i.parentNode&&W.unbind(i)}},o.prototype._applyVirtualizedProperty=function(t,e,o,n,i,r,a,s,l){if(i.VirtualizedProperties&&0<=i.VirtualizedProperties.indexOf(t)){var u=o._element.dynVirtualizedProperties;u=u||(o._element.dynVirtualizedProperties=new W.serverForm.VirtualizedProperties);var d=i.Name,c=n._descriptor,p=c.virtualProperties;(p=p||(c.virtualProperties={}))[t]=s;var h="";void 0===a?h=n.DataSourceName:(h=W.serverForm.getCollectionName(a),n.DataSourceName||(n.DataSourceName=h));var m=h&&r?r.getRelatedCollection(h):null;m&&!u.datasourceMap[d]&&(u.datasourceMap[d]=m);var v=W.serverForm.metadata[i.TypeName],g=void 0;if(v&&v.ValueProperties){var y=v.ValueProperties[t];y&&(g=y.DefaultVirtualValue)}var f=v.ValueProperties,b=(f=f||(v.ValueProperties={}))[t];b=b||f[t]||{};var C=e;if(C instanceof Array){u.setProperty(d,t,C,r._formId);var w="__virtualizedProperty_"+t;if(void 0===n[w]&&(H=t,G=g,e=n[w]=W.computed(function(){var e;m&&(e=W.value(m.selectedIndex));var t=u.getProperty(d,H,e,W.value(G));return G=t,W.value(t)}),n[w]._backingComputedObserver=W.observe(n[w],function(e){b.PropertyName?(W.context(n._element)||n)[t]=e:(W.isObservable(n[t])||(n[t]=n[w]),(0,n[t])(e))})),r&&r.getValue("UseReactGrid")){W.reactGrid.appliedVirtualizedProperty=!0;var _=i.VirtualizedPropertiesTrackingIds&&i.VirtualizedPropertiesTrackingIds[t],S=_&&_.length&&_.length===C.length,I=void 0,T=void 0;!S&&m&&(I=0,W.serverForm.ModelManager.lastRequestedLoadDirection!==W.ui.ScrollDirection.up&&(I=W.length(m.items)-m.numberOfClientRows-C.length));for(var x=0;x<C.length;x++)if(null!==C[x]){var F=void 0;if(S){if(!h&&null!=l&&l.DataSourceName&&(h=W.serverForm.getCollectionName(l.DataSourceName)),h){var k=h+"_"+_[x];F=W.serverForm.ModelManager.getModel(k)}}else if(m){if((T=x+I)<0||T>=W.length(m.items))continue;F=W.value(m.items)[T]}if(F)switch(t){case"DisplayOptions":var P=C[x],R={},M=!1,E={},N=!1;if(P){if(W.util.stringToBoolean(P.useBackColor)&&P.backcolor){M=!0;var A="rgb("+((16711680&P.backcolor)>>16)+","+((65280&P.backcolor)>>8)+","+(255&P.backcolor)+")";R.backgroundColor=A}if(W.util.stringToBoolean(P.useTextColor)&&P.textcolor){N=!0;var D="rgb("+((16711680&P.textcolor)>>16)+","+((65280&P.textcolor)>>8)+","+(255&P.textcolor)+")";E.color=D}W.util.stringToBoolean(P.fontWeight)&&(N=!0,E.fontWeight="bold"),W.util.stringToBoolean(P.fontStyle)&&(N=!0,E.fontStyle="italic"),P.textDecoration&&(N=!0,E.textDecoration=P.textDecoration)}if("ColorPlaceholder"===d&&"SysAppDesignerPane"===W.value(o.FormName)){var L="_VIRTUALIZED_AppIconAndColor_BackgroundColor";!F.doesPropertyExist(L)&&n.listControl&&n.listControl.applyVirtualizedPropertyFirstTime(),F.setValue(L,R.backgroundColor,!0,o.id)}else{var O="_VIRTUALIZED_"+d+"_ContainerStyle";M||(R=null),!F.doesPropertyExist(O)&&n.listControl&&n.listControl.applyVirtualizedPropertyFirstTime(),F.setValue(O,R,!0,o.id);var B="_VIRTUALIZED_"+d+"_InputStyle";N||(E=null),!F.doesPropertyExist(B)&&n.listControl&&n.listControl.applyVirtualizedPropertyFirstTime(),F.setValue(B,E,!0,o.id);var $="_VIRTUALIZED_"+d+"_UseColorOnSelectedRow",V=W.util.stringToBoolean(P.useColorOnSelectedRow);F.setValue($,V,!0,o.id)}break;case"IsCorrection":F.setValue("_VIRTUALIZED_"+d+"_"+t,W.util.stringToBoolean(C[x]),!0,o.id);break;default:F.setValue("_VIRTUALIZED_"+d+"_"+t,C[x],!0,o.id)}}}}}var H,G},o.prototype._applyProperties=function(e,t,o,n,i){var r,a,s;o.TypeName&&(t._typeName=o.TypeName),t._name=o.Name,t._serverId=o.Id,t._serverId&&t!==e&&(t._element.setAttribute("data-dyn-serverid",t._serverId),t._element.setAttribute("data-dyn-rootserverid",e._serverId));var l=o.VirtualizedProperties;o.ValueProperties&&o.ValueProperties.Resource&&(t._resource=o.ValueProperties.Resource,delete o.ValueProperties.Resource);var u=W.serverForm.controlAdapters[o.TypeName];u&&u(e,t,o,n,i);var d=t._descriptor;d=d||(t._descriptor={referencePropertyChanged:new W.eventHost,virtualizedPropertyChanged:new W.eventHost});var c=o.DataSourceName;c&&""!==c||!d||(c=d.DataSourceName);var p=W.serverForm.metadata[o.TypeName],h=(p=p||(W.serverForm.metadata[o.TypeName]=W.serverForm.metadata.Control)).ValueProperties;h=h||(p.ValueProperties={});var m=t._descriptor.virtualizedProperties;m=m||(t._descriptor.virtualizedProperties=[]);var v={};for(var g in o.ValueProperties){var y=o.ValueProperties[g],f=!!(l&&0<=l.indexOf(g));this._applyPropertyTask&&this._applyPropertyTask.start(g),R=(R=h[g])||h[g]||{};var b=y;if("object"==typeof y&&(b=W.serverForm.serializers.default.deserialize(y,t,e),f&&(-1===m.indexOf(g)&&(v[g]=!0,m.push(g)),this._applyVirtualizedProperty(g,b,e,t,o,n,c,R.Virtualizer,i))),R.PropertyName){if(!f){var C=!1;if(null!==(r=($=W.context(t._element)||t).isInGrid)&&void 0!==r&&r.call($)&&(null===(a=$.isInTable)||void 0===a||!a.call($))&&null!==(s=$.Root)&&void 0!==s&&s.UseReactGrid()){var w=W.reactGrid.COLUMN_PROPERTIES_TO_OBSERVE[R.PropertyName],_=!1;if(!w){var S=W.reactGrid.getControlProperties($._typeName);_=S&&S[R.PropertyName]}if(w||_){var I=W.isObservable(t[R.PropertyName]);W.setObservableValue(t,R.PropertyName,b),C=!0,!I&&$.listControl&&$.listControl.columnChanged()}}C||($[R.PropertyName]=b)}}else{W.isObservable(t[g])||((E=W.context(t._element))&&W.isObservable(E[g])?t[g]=E[g]:t[g]=W.observable());var T=t[g];W.disposeOneWayBinding(T),T.__bindingUpdating=!0,f||T(b),T.__bindingUpdating=!1,(G=this._getPropertyTrigger(g,o))&&((z={command:g}).TargetId=o.Id,G.ChangeAction&&G.ChangeAction.Properties&&(z.AutoPostback=G.ChangeAction.Properties.ProcessChanges),W.serverForm.updateTrigger(t,T,z)),W.debug.general&&(t[g].__unboundProp={name:g,options:t},delete t[g].__boundProp)}this._applyPropertyTask&&this._applyPropertyTask.stop(g)}for(var x in o.SerializedValueCollectionProperties){var F,k=o.SerializedValueCollectionProperties[x];f=!!(l&&0<=l.indexOf(x)),this._applyPropertyTask&&this._applyPropertyTask.start(x),R=(R=h[x])||h[x]||{},F=W.serverForm.serializers[W.serverForm.ValueType.collection].deserialize(k,t,e),f&&(-1===m.indexOf(x)&&(v[x]=!0,m.push(x)),this._applyVirtualizedProperty(x,F,e,t,o,n,c,R.Virtualizer,i)),W.isObservable(t[x])||((E=W.context(t._element))&&W.isObservable(E[x])?t[x]=E[x]:t[x]=W.observable()),T=t[x],W.disposeOneWayBinding(T),T.__bindingUpdating=!0,f||T(F),T.__bindingUpdating=!1,(G=this._getPropertyTrigger(x,o))&&((z={command:x}).TargetId=o.Id,G.ChangeAction&&G.ChangeAction.Properties&&(z.AutoPostback=G.ChangeAction.Properties.ProcessChanges),W.serverForm.updateTrigger(t,T,z)),W.debug.general&&(t[x].__unboundProp={name:x,options:t},delete t[x].__boundProp),this._applyPropertyTask&&this._applyPropertyTask.stop(x)}for(var P in o.SerializedValueProperties){var R,M,E,N=o.SerializedValueProperties[P];if(f=!!(l&&0<=l.indexOf(P)),this._applyPropertyTask&&this._applyPropertyTask.start(P),R=(R=h[P])||h[P]||{},M=W.serverForm.serializers[W.serverForm.ValueType.serialized].deserialize(N,t,e),f&&(-1===m.indexOf(P)&&(v[P]=!0,m.push(P)),this._applyVirtualizedProperty(P,M,e,t,o,n,c,R.Virtualizer,i)),R.PropertyName)f||(($=W.context(t._element)||t)[R.PropertyName]=M);else W.isObservable(t[P])||((E=W.context(t._element))&&W.isObservable(E[P])?t[P]=E[P]:t[P]=W.observable()),T=t[P],W.disposeOneWayBinding(T),T.__bindingUpdating=!0,f||T(M),T.__bindingUpdating=!1,(G=this._getPropertyTrigger(P,o))&&((z={command:P}).TargetId=o.Id,G.ChangeAction&&G.ChangeAction.Properties&&(z.AutoPostback=G.ChangeAction.Properties.ProcessChanges),W.serverForm.updateTrigger(t,T,z)),W.debug.general&&(t[P].__unboundProp={name:P,options:t},delete t[P].__boundProp),this._applyPropertyTask&&this._applyPropertyTask.stop(P)}0<Object.keys(v).length&&t._descriptor.virtualizedPropertyChanged.raise(v);var A=t._descriptor.referenceProperties;A=A||(t._descriptor.referenceProperties={});var D=[];for(var L in o.ReferenceProperties){this._applyPropertyTask&&this._applyPropertyTask.start(L);var O=o.ReferenceProperties[L],B=A[L];if(!this._areReferencePropertiesEqual(B,O)){A[L]=O,D.push(L);var $,V=W.serverForm.getCollectionName(O.ModelName),H=W.serverForm.getPropertyName(O.ModelFieldName);($=W.context(t._element)||t).FieldName=H,$.DataSourceName=V;var G,z,U=W.getFieldObservable(H,W.getModel(V,n));W.isObservable(t[L])||(t[L]=W.observable()),(T=t[L]).__ModelName=V,T.__ModelFieldName=H,W.oneWayBinding(U,T),(G=this._getPropertyTrigger(L,o))&&((z={command:L}).TargetId=o.Id,W.serverForm.updateTrigger(t,T,z)),W.debug.general&&(t[L].__boundProp={boundDataSource:n,boundProp:U,modelFieldName:H,modelName:V,name:L,options:t},delete t[L].__unboundProp)}0<D.length&&t._descriptor.referencePropertyChanged.raise(D),this._applyPropertyTask&&this._applyPropertyTask.stop(L)}this._applyCommands(e,t,o)},o.prototype._areReferencePropertiesEqual=function(e,t){return!(!e||!t||e.Name!=t.Name||e.ModelName!=t.ModelName||e.ModelFieldName!=t.ModelFieldName)},o.prototype._applyCommands=function(e,t,o){if(o.Commands)for(var n=Object.keys(o.Commands),i=0,r=n.length;i<r;i++){var a=n[i];this._applyCommandTask&&this._applyCommandTask.start(a);var s=o.Commands[a];s.TargetId=o.Id;var l=s.ValueTypeName,u=W.serverForm.serializers[l];u||(u=W.serverForm.serializers.InteractionCommand,W.logWarning("Unknown command serializer: %s, control type: %s, command: %s, descriptor: %o",l,o.TypeName,a,o));var d=u.deserialize(s,t,e),c=W.context(t._element)||t;W.setObservableValue(c,a,d),this._applyCommandTask&&this._applyCommandTask.stop(a)}},o.prototype._applyDelta=function(e,t,o,n,i){var r,a,s,l,u,d,c,p,h,m,v,g,y,f,b;if(void 0!==o.TypeName&&void 0!==t.TypeName&&t.TypeName!==o.TypeName&&W.log.server&&W.log.server("ServerForm: Control type mismatch for %s in descriptor and new TypeName - %s , current TypeName- %s",o.TypeName,t.TypeName),void 0===o.TypeName&&(o.TypeName=t.TypeName),this._applyDeltaTaskByName&&this._applyDeltaTaskByName.start(o.Name+"-"+o.TypeName),this._applyDeltaTask&&this._applyDeltaTask.start(o.TypeName),this._applyPropertiesByNameTask&&this._applyPropertiesByNameTask.start(o.Name+"-"+o.TypeName),this._applyPropertiesTask&&this._applyPropertiesTask.start(o.TypeName),i||(null!==(a=null===(r=W.context(t._element))||void 0===r?void 0:r.setUpdating)&&void 0!==a&&a.call(r,!0),this._applyProperties(e,t,o,n)),this._applyPropertiesTask&&this._applyPropertiesTask.stop(o.TypeName),this._applyPropertiesByNameTask&&this._applyPropertiesByNameTask.stop(o.Name+"-"+o.TypeName),W.serverForm._debugDescriptor(t._element,o),W.value(e._element.dynReadyState)!==W.ui.ReadyState.aborted){var C=o.ChildViewModels;if($.isArray(C)){var w=!1,_=[],S=W._getChildren(t._element),I=S().slice();I.length!==C.length&&(i||(w=!0));for(var T=0,x=C.length;T<x;T++){var F=C[T],k=n;if(this._fixDescriptor(F,o,k,e),F){var P=!1,R=W.serverForm.getControlParams(F.Name,e),M=R&&(null===(s=R.isInGrid)||void 0===s?void 0:s.call(R))&&W.value(null===(l=R.Root)||void 0===l?void 0:l.UseReactGrid);if(B=R?R._element:null)if(null==F.TypeName&&(F.TypeName=W.roleType(B)),W.roleType(B)===F.TypeName||B.getAttribute("data-dyn-role-orig")===F.TypeName){if(!W.context(B)&&!M){var E=W.templatedParentElement(B);E&&E!==t._element&&W.context(t._element)&&_.push(B)}}else P=!0,this._controlRoleFaultTask&&this._controlRoleFaultTask.start(F.Name+"-"+F.TypeName),B.dynTemplatedParent!==t._element||t._element.hasAttribute("data-dyn-container")||(B.parentNode!==t._element?(W.logError("Control has no parent."),B.remove&&B.remove()):t._element.removeChild(B),W.unbind(B)),void 0!==F.TypeName&&W.log.server&&W.log.server("ServerForm: Control type mismatch for %s in descriptor and new TypeName - %s , current TypeName- %s",F.Name,F.TypeName,W.roleType(B)),this._controlRoleFaultTask&&this._controlRoleFaultTask.stop(F.Name+"-"+F.TypeName);else P=!0;!P&&W.value(null===(u=null==R?void 0:R.Root)||void 0===u?void 0:u.UseReactGrid)&&!(null===(d=R.isInGrid)||void 0===d||!d.call(R))!=("RowTemplate"===t.TypeName||!(null===(c=t.isInGrid)||void 0===c||!c.call(t)))&&(P=!0);var N=void 0;"Table"===o.TypeName&&(void 0===o.DataSourceName&&(o.DataSourceName=o.Name+"_tableds_"),k=function(e,t,o){return W.computed(function(){return e.getRelatedCollection(t).items()[o]})}(k,o.DataSourceName,T)),P?((N=this._createControl(e,F,o,k))&&e&&N._name===W.value(e.ActiveControl)&&(e.activeControlCreated=!0),N&&N._typeName&&"List"===N._typeName&&(N.GetDataId||(N.GetDataId=function(e){return e.masterTrackingId}),N.GetDataVersion||(N.GetDataVersion=function(e){var t=0;return e.getVersion&&(t=e.getVersion()),t}),W.debug.gridPaging&&(N.InfiniteScroll=W.observable(!1))),B=N._element,W.context(t._element)&&_.push(B)):(N=B.dynOptions,W.context(B)||W.context(t._element)&&_.push(B));var A=I[T];i?t._element.appendChild(B):(P||A&&A.getAttribute("data-dyn-controlname")!==F.Name||T>=I.length)&&(t._element.hasAttribute("data-dyn-container")||(A&&A.parentNode===t._element?t._element.insertBefore(B,A):t._element.appendChild(B)),w=!0),this._applyDelta(e,N,F,k,P),B&&S.set(T,B)}}if(this._applyChildrenDeltaTask&&this._applyChildrenDeltaTask.start(o.Name+"-"+o.TypeName),w)for(S().length=C.length,S.valueChanged.raise(),T=0,x=I.length;T<x;T++)if(-1===S().indexOf(I[T])){var D=W.context(I[T]);if(D)null!==(p=D.Root)&&void 0!==p&&p.HasInvalidControls()&&(D.IsValid&&D.IsValid(!0),D.Children&&W.util.validateChildren(D)),t._element.hasAttribute("data-dyn-container")||(t._element.removeChild(D._element),$(D._element).off());else{var L=I[T].dynOptions;if(L&&null!==(h=L.isInGrid)&&void 0!==h&&h.call(L)&&W.value(null===(m=L.Root)||void 0===m?void 0:m.UseReactGrid)){if(null!==(v=L.Root)&&void 0!==v&&v.HasInvalidControls()){null!==(g=L.IsValid)&&void 0!==g&&g.call(L,!0);var O=W.value(W._getChildren(L._element));null!=O&&O.length&&W.util.validateDynChildren(L)}t._element.removeChild(L._element)}}}for(T=0,x=_.length;T<x;T++){var B=_[T];W.role(B.parentNode||B).dataBindChild(B,t._element.dynContext)}w&&null!==(y=W.context(t._element))&&void 0!==y&&y.Children.valueChanged.raise(),this._applyChildrenDeltaTask&&this._applyChildrenDeltaTask.stop(o.Name+"-"+o.TypeName)}i||null!==(b=null===(f=W.context(t._element))||void 0===f?void 0:f.setUpdating)&&void 0!==b&&b.call(f,!1),this._applyDeltaTask&&this._applyDeltaTask.stop(o.TypeName),this._applyDeltaTaskByName&&this._applyDeltaTaskByName.stop(o.Name+"-"+o.TypeName)}else W.log.server&&W.log.server("ServerForm: Applying delta for aborted form %s / %s -- only applying form level properties",e._element.id,W.context(e._element).Name)},o.prototype._propertyValue=function(e,t){var o;return t.ValueProperties&&(o=t.ValueProperties[e])||t.SerializedValueProperties&&(o=t.SerializedValueProperties[e])||t.SerializedValueCollectionProperties&&(o=t.SerializedValueCollectionProperties[e])?o:void 0},o.prototype._getPropertyTrigger=function(e,t){if(t.PropertyTriggers)return t.PropertyTriggers[e]},o.prototype._getCommand=function(e,t){if(t.Commands)return t.Commands[e]},o.prototype._fixDescriptor=function(e,t,o,n){switch(e.TypeName){case"HyperLink":case"AnchorButton":e.TagName="a";break;case"MenuItem":case"MenuItemButton":case"CommandButton":case"DropDialogButton":case"ToggleButton":case"Button":e.TagName="button";break;case"InputLabel":case"MultilineInputLabel":case"RealLabel":case"IntegerLabel":case"Int64Label":case"DateLabel":case"DateTimeLabel":case"TimeLabel":case"Label":n&&"SysBoxForm_form"===n._name&&e.ValueProperties&&"titleField"===e.ValueProperties.Style?e.TagName="h2":e.TagName="span";break;case"Grid":case"ListView":o&&o.getValue("UseReactGrid")?e.TypeName="ReactList":e.TypeName="List";break;case"ActionGroup":var i=e.Name;i&&"SystemDefinedButtonsButtonGroup_Form"===i.substr(0,36)&&(e.Classifiers=["actionGroup-right"]);break;case"CheckBox":e.TagName="label";break;case"Tile":e.TagName="div",e.ValueProperties&&(e.ValueProperties.TileType===W.ui.TileType.count?e.TypeName="CountTile":e.ValueProperties.TileType===W.ui.TileType.kpi?(e.TypeName="KPITile",e.ValueProperties.Url&&(e.TagName="a")):e.ValueProperties.TileType===W.ui.TileType.link&&(e.TypeName="LinkTile",e.TagName="a"))}e.TagName||(e.TagName="div");var r=this._propertyValue("Style",e);r&&(e.Classifiers&&-1===e.Classifiers.indexOf(r)?e.Classifiers.push(r):e.Classifiers=[r]);var a=this._propertyValue("ExtendedStyle",e);a&&(e.Classifiers&&-1===e.Classifiers.indexOf(a)?e.Classifiers.push(a):e.Classifiers=[a]);var s=this._propertyValue("PrimaryModelName",e);s&&(e.DataSourceName=s,delete e.ValueProperties.PrimaryModelName),(s=this._propertyValue("ListItemViewModelDescriptor",e))&&(e.ChildViewModels=s.ChildViewModels,delete e.ValueProperties.ListItemViewModelDescriptor);var l=this._getCommand("PersistPersonalization",e);l&&(l.ValueTypeName="PersistPersonalization")},o.prototype._createControl=function(e,t,o,n){this._createControlTask&&this._createControlTask.start(t.TypeName),this._createControlByNameTask&&this._createControlByNameTask.start(t.Name+"-"+t.TypeName);var i={},r=document.createElement(t.TagName);if(i._element=r,this._applyProperties(e,i,t,n,o),r.dynOptions=i,e._element?r.setAttribute("data-dyn-controlname",i._name):(r.setAttribute("id","form_"+i._serverId),r.setAttribute("data-dyn-formid",i._serverId)),i._resource&&W.resources._addUnresolvedElement(r,i._resource,e._element),r.setAttribute("data-dyn-role",i._typeName),e._allControls[t.Name.toLowerCase()]=i,t.Classifiers)for(var a=0,s=t.Classifiers.length;a<s;a++)try{r.classList.add(t.Classifiers[a])}catch(e){}return i.TypeName=t.TypeName,this._createControlByNameTask&&this._createControlByNameTask.stop(t.Name+"-"+t.TypeName),this._createControlTask&&this._createControlTask.stop(t.TypeName),i},o.prototype._handleCommandCallbacks=function(e){for(var t=0,o=e.length;t<o;t++){var n=e[t];W.log.server&&W.log.server("ServerForm: Handling callback interaction: %o",n);var i=void 0,r=n.callback._functionId;void 0!==r?(i=W.serverForm.idToWindowFunction[r],W.serverForm.idToWindowFunction[r]=null):i=n.callback,i||W.logError("ServerForm: Callback was undefined on the interaction or already removed from the map");var a=void 0;n.Result&&(a=n.Result);var s=void 0;a&&(s=W.serverForm.serializers[a.ValueType]),s=s||W.serverForm.serializers.default,a&&a.Value?i(s.deserialize(a.Value)):i()}W.util.isFlightEnabled(W.reactGrid.featureName)&&W.reactGrid.appliedVirtualizedProperty&&(W.reactGrid.appliedVirtualizedProperty=!1,W.serverForm.UpdateModelManager.raiseChanges())},o);function o(){this.forms={},this._updatedTask=new W.PerformanceTask("updatingCompleted",!0),this._modelInteractionsTask=new W.PerformanceTask("modelInteractions",!0),this._viewInteractionsTask=W.debug.performance?new W.PerformanceTask("viewInteractions",!0):null,this._viewInteractionTask=W.debug.performance?new W.PerformanceTask("viewInteraction",!0):null,this._notificationsTask=W.debug.performance?new W.PerformanceTask("notifications",!0):null,this._openFormTask=W.debug.performance?new W.PerformanceTask("openForm",!0):null,this._applyDeltaTask=W.debug.performance?new W.PerformanceTask("applyDelta"):null,this._applyDeltaTaskByName=W.debug.performance?new W.PerformanceTask("applyDelta.ByName"):null,this._applyCommandTask=W.debug.performance?new W.PerformanceTask("applyCommand"):null,this._applyPropertyTask=W.debug.performance?new W.PerformanceTask("applyProperty"):null,this._applyPropertiesTask=W.debug.performance?new W.PerformanceTask("applyProperties"):null,this._applyPropertiesByNameTask=W.debug.performance?new W.PerformanceTask("applyProperties.ByName"):null,this._applyChildrenDeltaTask=W.debug.performance?new W.PerformanceTask("applyChildrenDelta"):null,this._parentChangedTask=W.debug.performance?new W.PerformanceTask("parentChanged",!0):null,this._controlRoleFaultTask=W.debug.performance?new W.PerformanceTask("controlRoleFault",!0):null,this._createControlTask=W.debug.performance?new W.PerformanceTask("createControl"):null,this._createControlByNameTask=W.debug.performance?new W.PerformanceTask("createControl.ByName"):null}M.InteractionHandler=t,M.interactionHandler=new t}(W.serverForm||(W.serverForm={}))}($dyn=$dyn||{}),function(o){var e,t;function n(e){this.window=e}e=o.serverForm||(o.serverForm={}),n.prototype.processInteractions=function(e){var t={commandName:o.serverForm.InteractionHandlerFunction.processInteractions,interactions:e,source:"InteractionHandler"};return o.postMessage(this.window,{data:t})},n.prototype._prepFormForPopout=function(e){var t={commandName:o.serverForm.InteractionHandlerFunction._prepFormForPopout,rootId:e,source:"InteractionHandler"};return o.postMessage(this.window,{data:t})},n.prototype.detachFormForPopout=function(e){var t={commandName:o.serverForm.InteractionHandlerFunction.detachFormForPopout,rootId:e,source:"InteractionHandler"};return o.postMessage(this.window,{data:t})},n.prototype.reserializeForm=function(e){var t={commandName:o.serverForm.InteractionHandlerFunction.reserializeForm,rootId:e,source:"InteractionHandler"};return o.postMessage(this.window,{data:t})},t=n,e.InteractionHandlerProxy=t}($dyn=$dyn||{}),function(c){var e;function t(e,r,t,a,o){var s,n,l=c.serverForm.getCollectionName(t.DataSourceName),i=a&&a.getValue("UseReactGrid");if(r.DataSource){if(l&&l!==r.DataSource.__dataSourceName&&(s=r.DataSource.__dataSourceName,n=r.DataSource,c.disposeOneWayBinding(n),a)){u=a.getRelatedCollection(l);r.DataSource.__dataSourceName=l,r.DataSource.__boundDataSource=u,c.oneWayBinding(u.items,n)}}else if(n=r.DataSource=i?c.observableArray():c.observable(),l&&a){var u=a.getRelatedCollection(l);r.DataSource.__dataSourceName=l,r.DataSource.__boundDataSource=u,c.oneWayBinding(u.items,n),i&&u.itemsChanged().subscribe(function(){n.valueChanged.raise()})}function d(e,t,o){var n;if(r[t=t||e]){if(l&&l!==s){var i;if(n=r[t],c.disposeOneWayBinding(n),a)(i=a.getRelatedCollection(l))&&(c.oneWayBinding(i[e],n),r[t].__dataSourceName=l,r[t].__modelCollection=i)}}else n=r[t]=c.observable(o),l&&a&&(i=a.getRelatedCollection(l))&&(c.oneWayBinding(i[e],n),r[t].__dataSourceName=l,r[t].__modelCollection=i)}i&&"ReactList"===r._typeName?(d("activeRecord_mastertrackingid","SelectedRowTrackingId",""),d("internalActiveMasterTrackingId","InternalSelectedRowTrackingId",""),d("activeDataRowTrackingId","ActiveRowTrackingId"),d("DataAbove"),d("DataBelow"),d("CacheSize"),d("RowsMarkedByDefault"),d("pageIndex","PageIndex",0),d("clientPageSize","PageSize",0)):(d("selectedIndex","SelectedIndex",-1),d("CacheSize"),d("FetchedDataStartPosition"),d("DataAbove"),d("DataBelow"),d("markedIndexes","MarkedIndexes",[]))}(e=c.serverForm||(c.serverForm={})).controlAdapters={},e.controlAdapters.Table=t,e.controlAdapters.List=t,e.controlAdapters.ReactList=t}($dyn=$dyn||{}),function(o){var e;(e=o.telemetry||(o.telemetry={})).enabled=!0,e.pingCount=0,e._addInteractions=function(e){if(o.serverForm&&e&&0<o.length(o.telemetry._eventQueue)){var t={$type:o.serverForm.InteractionType.eventData,EventData:o.telemetry._eventQueue.slice()};e.unshift(t),o.async.pending.increment("queue telemetry interaction"),o.telemetry.clearEvents()}},e.flushTelemetryEvents=function(){o.serverForm&&o.serverForm.interactionManager&&o.serverForm.interactionManager.flushTelemetryEvents?o.serverForm.interactionManager.flushTelemetryEvents():o.log("$dyn.serverForm.interactionManager.flushTelemetryEvents() is undefined.")},e.addEventInternal=function(e){o.serverForm&&o.serverForm.interactionManager&&o.serverForm.interactionManager.queueTelemetryEvent(e)}}($dyn=$dyn||{});var $dyn;__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(g){var e,t;function o(e){this.pendingResponse=!1,this.pendingResponseCouldAffectSave=!1,this.channelId=e||0,this.serverSessionId=null,this.lastServerAcknowledgedSequenceNumber=0,this.lastServerProcessedSequenceNumber=0,this.nextClientSequenceNumber=0,this.inboundMessages=[],this.outboundMessages=[],this.sendWhenReceiveResponse=!1,this.interactionReceived=new g.eventHost,this.errorReceived=new g.eventHost,this.interactionSent=new g.eventHost;var t=g.user();t&&(this.partition=t.RequestPartition,this.company=t.Company,this.language=t.Language)}e=g.serverForm||(g.serverForm={}),o.prototype.hasPendingResponse=function(e){var t,o,n,i;void 0===e&&(e=!1);var r=!1;if(!this.pendingResponse||e&&!this.pendingResponseCouldAffectSave){if(this.serverRequestQueued)if(e){if(this.outboundMessages)try{for(var a=__values(this.outboundMessages),s=a.next();!s.done;s=a.next()){var l=s.value;if(l&&l.Interactions)try{for(var u=(n=void 0,__values(l.Interactions)),d=u.next();!d.done;d=u.next()){var c=d.value;if(g.serverForm.couldInteractionAffectSave(c)){r=!0;break}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}if(r)break}}catch(e){t={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(t)throw t.error}}}else r=!0}else r=!0;return r},o.prototype.sendInteractions=function(i,r,e){var a=this;if(i&&0<i.length){var t={Interactions:i,SequenceNumber:++this.nextClientSequenceNumber};if(i.some(function(e){return e.PriorityPosition}))if(0<this.outboundMessages.length){var o=this.outboundMessages[0].SequenceNumber;t.SequenceNumber=o,this.outboundMessages.unshift(t);for(var n=1;n<this.outboundMessages.length;n++)this.outboundMessages[n].SequenceNumber=o+n}else this.outboundMessages.push(t);else this.outboundMessages.push(t)}if(0<this.outboundMessages.length)if(null!=this._currentRequest)this.sendWhenReceiveResponse=!0,g.log.server&&g.log.server("ReliableChannel: Channel "+this.channelId+" updating currentWindowId from "+this.currentWindowId+" to "+r+" in function sendInteractions.  _currentRequest != null"),this.currentWindowId=r;else{this.sendWhenReceiveResponse=!1;var s=function(){var e,t,o;null!=i&&a.currentWindowId!==r&&(g.log.server&&g.log.server("ReliableChannel: Channel "+a.channelId+" updating currentWindowId from "+a.currentWindowId+" to "+r+" in function sendInteractions."),a.currentWindowId=r),a.company&&(e=a.company()),a.language&&(t=a.language()),a.partition&&(o=a.partition());var n={ChannelId:a.channelId,CompanyId:e,Language:t,LastAcknowledgedSequenceNumber:a.lastServerProcessedSequenceNumber,Messages:a.outboundMessages,Partition:o,WindowId:a.currentWindowId};a._currentRequest=a.beginRequest(n)};if(e)s();else if(this.serverRequestQueued)g.log.server&&g.log.server("ReliableChannel: Ignoring requests to sendInteractions in the same event loop. WindowId: "+r+" Interactions: "+i);else{var l=function(){return g.async(function(){g.peek(g.shell.extendedEventLoopOn)?(g.async.pending.increment("extendedEventLoopOn"),g.observe(g.shell.extendedEventLoopOn,function(e){if(!e)return g.async.pending.decrement("extendedEventLoopOn"),a.serverRequestQueued=l(),!1})):(a.serverRequestQueued=void 0,s())},void 0,"Delay server request")};this.serverRequestQueued=l()}}},o.prototype.beginRequest=function(n,i){var t,e,o,r,a=this,s={};i&&(s[g.serverForm.RequestHeaderKeys.sessionWaitTimeout]=g.serverForm.sessionWaitTimeoutOnRetry.toString());var l={data:JSON.stringify(n),url:g.serverForm.ReliableChannel.serviceAddress+"?",type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",success:this._preSuccess.bind(this),error:function(e,t,o){a._preError(e,t,o,n,i)},beforeSend:this._beforeSend.bind(this),timeout:null==this.serverSessionId?g.serverForm.sessionInitiationTimeout:g.serverForm.sessionRequestTimeout,headers:s};if(n.CompanyId&&(l.url+="cmp="+encodeURIComponent(n.CompanyId)+"&"),n.Language&&(l.url+="lng="+encodeURIComponent(n.Language)+"&"),n.Partition&&(l.url+="prt="+encodeURIComponent(n.Partition)),this._lastStartTime=window.performance.now(),this._initialStartTime||(this._initialStartTime=this._lastStartTime),this._serverRequestTask&&this._serverRequestTask.start(),g.async.pending.increment("begin request"),this.pendingResponse=!0,this.pendingResponseCouldAffectSave=!1,n&&n.Messages)try{for(var u=__values(n.Messages),d=u.next();!d.done;d=u.next()){var c=d.value;if(c&&c.Interactions)try{for(var p=(o=void 0,__values(c.Interactions)),h=p.next();!h.done;h=p.next()){var m=h.value;if(g.serverForm.couldInteractionAffectSave(m)){this.pendingResponseCouldAffectSave=!0;break}}}catch(e){o={error:e}}finally{try{h&&!h.done&&(r=p.return)&&r.call(p)}finally{if(o)throw o.error}}if(this.pendingResponseCouldAffectSave)break}}catch(e){t={error:e}}finally{try{d&&!d.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}var v=g.ajax(l);return g.flags.disablePing||g.flags.fromVS||g.serverForm.pingReset(),this.interactionSent.raise({Channel:this,Data:n}),v},o.prototype.receiveMessages=function(e){if(!e)return this.sendWhenReceiveResponse=!0,void g.logError("$dyn.serverForm.ReliableChannel.receiveMessages: Success callback fired with a null message set");g.assert(e.ChannelId===this.channelId,"Message got routed to the wrong channel.");var t=[];e.LastAcknowledgedSequenceNumber>this.lastServerAcknowledgedSequenceNumber&&(this.lastServerAcknowledgedSequenceNumber=e.LastAcknowledgedSequenceNumber,t=this._updateOutboundQueue());for(var o=0,n=e.Messages.length;o<n;o++){var i=e.Messages[o];null!=i&&(this.lastServerProcessedSequenceNumber>=i.SequenceNumber||this._addToInboundQueue(i))}for(this._processInboundMessages(e.WindowId),this._isChannelBlocking&&(g.serverForm.interactionManager.decrementGlobalBlockingFlag(),this._isChannelBlocking=!1),o=0,n=t.length;o<n;o++)t[o].completeCommand&&t[o].completeCommand(),t[o].decrementWindowAsyncPending&&t[o].decrementWindowAsyncPending(),t[o].ShouldBlockOnExecution&&g.serverForm.interactionManager.decrementGlobalBlockingFlag()},o.prototype._processInboundMessages=function(e){if(0<this.inboundMessages.length)for(;0<this.inboundMessages.length;){var t=this.inboundMessages[0];if(t.SequenceNumber!==this.lastServerProcessedSequenceNumber+1)break;this.lastServerProcessedSequenceNumber=t.SequenceNumber,this.inboundMessages.shift(),this.interactionReceived.raise({Channel:this,Interactions:t.Interactions,WindowId:e})}else this.interactionReceived.raise({Channel:this,Interactions:[],WindowId:e})},o.prototype._beforeSend=function(e){this.serverSessionId&&e.setRequestHeader(g.serverForm.RequestHeaderKeys.sessionKey,this.serverSessionId),g.serverForm.setCsrfToken(e);var t=g.util.newGuid();e.setRequestHeader(g.serverForm.RequestHeaderKeys.clientSessionKey,g.browserActivity.BrowserSessionActivity.Id),e.setRequestHeader(g.serverForm.RequestHeaderKeys.activityKey,t),g.browserActivity.newInteraction(t),g.ui.PerformanceTimer&&g.ui.PerformanceTimer._startAjax(t)},o.prototype._preSuccess=function(e,t,o){var n=this;if(g.ui.PerformanceTimer&&(g.ui.PerformanceTimer._stopAjax(),g.ui.PerformanceTimer._getRealTimeTrace&&g.ui.PerformanceTimer._getRealTimeTrace(o.getResponseHeader(g.serverForm.RequestHeaderKeys.sessionLoggableKey))),this._serverRequestTask&&this._serverRequestTask.stop(),g.debug.latency){var i=150;!0!==g.debug.latency&&(i=g.debug.latency),g.async(function(){n._success(e,t,o)},i,"Server request process success")}else this._success(e,t,o)},o.prototype._success=function(e,t,o){try{this.pendingResponse=!1;var n=window.performance.now();if(g.log.server&&g.log.server("ServerForm: Request completed: %o",n-this._lastStartTime),this._currentRequest=null,this._initialStartTime=null,!o)throw new Error("Invalid response event parameters.");var i=o.getResponseHeader(g.serverForm.RequestHeaderKeys.sessionKey);if(!i||!i)throw new Error("Server didn't return a session id.");if(g.browserActivity.TraceLogNodeName=o.getResponseHeader(g.serverForm.RequestHeaderKeys.hostNameKey),g.browserActivity.TraceLogNamespace=o.getResponseHeader(g.serverForm.RequestHeaderKeys.namespaceKey),g.browserActivity.TraceLogTenant=o.getResponseHeader(g.serverForm.RequestHeaderKeys.tenantKey),g.browserActivity.TraceLogRole=o.getResponseHeader(g.serverForm.RequestHeaderKeys.roleKey),g.browserActivity.aosId=o.getResponseHeader(g.serverForm.RequestHeaderKeys.aosId),this.serverSessionId){if(this.serverSessionId!==i)throw new Error("Session id mismatch.")}else this.serverSessionId=i;var r=e;this.receiveMessages(r),0<this.outboundMessages.length&&this.sendWhenReceiveResponse&&this.sendInteractions(null)}finally{g.async.pending.decrement("complete request (success)"),g.telemetry.clearPersistentEventStorage()}},o.prototype._cleanupAfterRequestError=function(){this._isChannelBlocking&&(g.serverForm.interactionManager.decrementGlobalBlockingFlag(),this._isChannelBlocking=!1),g.shell.forceUnBlockUserInteraction(),g.shell.isShellInitializing(!1),this._currentRequest=null,this._initialStartTime=null},o.prototype._preError=function(e,t,o,n,i){var r=this;if(g.ui.PerformanceTimer&&g.ui.PerformanceTimer._stopAjax(),e){if("timeout"!==t&&e.readyState<2)return g.telemetry.addCommunicationEvent(t,e.status,g.serverForm.retryTimeWhenIncompleteRequest,0,g.browserActivity.BrowserSessionActivity.Id,e.readyState),window.performance.now()-this._initialStartTime<g.serverForm.maxRetryTimeWhenIncompleteRequest?(g.async.pending.decrement("request failed (retrying)"),void g.async(function(){r._currentRequest=r.beginRequest(n,!0)},g.serverForm.retryTimeWhenIncompleteRequest,"Server request retry on error")):(this._showConnectionErrorDialog({ImageName:"Error",Tooltip:g.label("MessageBox_ErrorIcon"),Text:g.label("LostConnectionDialog_Message"),RetryText:g.label("LostConnectionDialog_RetryButtonText"),Callback:function(){r._isChannelBlocking||(g.log.blockUserInteraction&&g.log.blockUserInteraction("BlockUserInteraction: resending request after lost connection"),r._isChannelBlocking=!0,g.serverForm.interactionManager.incrementGlobalBlockingFlag(!0,"showConnectionErrorDialog:lostConnection")),r._currentRequest=r.beginRequest(n,!0),g.serverForm.interactionManager._isClientDisconnected=!1}}),g.serverForm.interactionManager._isClientDisconnected=!0,this._cleanupAfterRequestError(),void g.async.pending.decrement("request failed (offline)"));if(409===e.status||502===e.status||503===e.status||0===e.status||"timeout"===t){var a=window.performance.now()-this._lastStartTime,s=Math.max(g.serverForm.maxWaitTimeToRetry-a,0);409!==e.status&&g.telemetry.addCommunicationEvent(t,e.status,s,0,g.browserActivity.BrowserSessionActivity.Id,e.readyState);var l=window.performance.now()-this._initialStartTime<g.serverForm.maxWaitTimeToFail;if(this.serverSessionId&&l)g.async.pending.decrement("request failed (retrying)"),0===s?this._currentRequest=this.beginRequest(n,!0):g.async(function(){r._currentRequest=r.beginRequest(n,!0)},s,"Server request retry on error");else{if(409===e.status)return this._showConnectionErrorDialog({ImageName:"Info",Text:g.label("LongOperationDialog_Message"),RetryText:g.label("LongOperationDialog_RetryButtonText"),Callback:function(){r._isChannelBlocking||(g.log.blockUserInteraction&&g.log.blockUserInteraction("BlockUserInteraction: resending request after server doesn't respond"),r._isChannelBlocking=!0,g.serverForm.interactionManager.incrementGlobalBlockingFlag(!0,"showConnectionErrorDialog:noServerReponse")),r._currentRequest=r.beginRequest(n,!0),g.serverForm.interactionManager._isClientDisconnected=!1}}),g.serverForm.interactionManager._isClientDisconnected=!0,this._cleanupAfterRequestError(),void g.async.pending.decrement("request failed (took too long)");this._error(e,t,o)}}else this._error(e,t,o)}},o.prototype._showConnectionErrorDialog=function(e){g.showConnectionErrorDialog(e)},o.prototype._error=function(e,t,o){function n(e){function t(){var e=new g.util.UrlBuilder;e.fromLocation(location);var t=e.absoluteUrl();if(g.browserActivity&&g.browserActivity.TimeoutTimestamp>Date.now()){var o=g.browserActivity.BrowserSessionActivity.Id,n=g.browserActivity.BrowserInteractionActivity.Id,i=g.browserActivity.TimeoutTimestamp;e.query[g.shell.QueryStringKeys.browserActivityKey.toLowerCase()]=o,e.query[g.shell.QueryStringKeys.activityKey.toLowerCase()]=n,e.query[g.shell.QueryStringKeys.expirationKey.toLowerCase()]=i,t=e.absoluteUrl()}location.replace(t)}null!=e?window.setTimeout(t,e):t()}var i;try{this.pendingResponse=!1,g.serverForm.sessionTimeoutId&&window.clearTimeout(g.serverForm.sessionTimeoutId),g.serverForm._pingTimeoutId&&window.clearInterval(g.serverForm._pingTimeoutId);var r=null;try{r=JSON.parse(e.responseText)}catch(e){}if(null==this._currentRequest)g.logError&&g.logError("current request isn't defined");else if("timeout"===t)g.telemetry.handleClientError({},"ServerForm_ServerTimeout",{statusCode:this._currentRequest.status});else if(403===this._currentRequest.status)g.telemetry.handleClientError({Text:g.label("ServerForm_UnknownUserError"),showCloseButton:!1},"ServerForm_UnknownUserError",{statusCode:this._currentRequest.status}),window.setTimeout(function(){g.shell.logOut()},9e3);else if(400===this._currentRequest.status||500===this._currentRequest.status){var a=void 0,s=!1;if(r){var l=r.ErrorCode;void 0!==l&&(i=r.Message,3===l&&(s=!0,g.serverForm.sessionExpired||(a="ServerForm_SessionEndError",i=g.label(a)))),r.DiagnosticMesssage&&g.logError(g.format(g.label("ServerForm_DiagnosticsMessage"),i,r.DiagnosticMesssage))}i&&0!==i.length||(a="ServerForm_InternalError",i=g.label(a)),g.telemetry.handleClientError({Text:i,showCloseButton:s,callback:n},a,{statusCode:this._currentRequest.status})}else if(503===this._currentRequest.status||0===this._currentRequest.status){if(g.shell.IsUnloading)return this._currentRequest=null,void window.setTimeout(function(){g.isPageBeingRefreshed=!1},3e4);g.telemetry.handleClientError({},"ServerForm_LostConnection",{statusCode:this._currentRequest.status}),n(3e4)}else 401===this._currentRequest.status?g.shell.logOut():g.telemetry.handleClientError({},"ServerForm_GenericError",{statusCode:this._currentRequest.status});g.shell.forceUnBlockUserInteraction(),g.shell.isShellInitializing(!1),this._currentRequest=null,this._initialStartTime=null}finally{g.async.pending.decrement("complete request (error)"),this.errorReceived.raise({Channel:this,Message:i})}},o.prototype._updateOutboundQueue=function(){for(var e=[];0<this.outboundMessages.length&&this.outboundMessages[0].SequenceNumber<=this.lastServerAcknowledgedSequenceNumber;){for(var t=this.outboundMessages[0],o=0,n=t.Interactions.length;o<n;o++){var i=t.Interactions[o];(i.completeCommand||i.decrementWindowAsyncPending||i.ShouldBlockOnExecution)&&e.push(i),g.ui.PerformanceTimer&&"EventDataInteraction"!==i.$type&&g.ui.PerformanceTimer._addAction(i.CommandName||i.$type)}this.outboundMessages.shift()}return e},o.prototype._assertSequenceNumberNotUsed=function(e){for(var t=0,o=this.inboundMessages.length;t<o;t++)if(this.inboundMessages[t].SequenceNumber===e)return void g.assert(!1,"Message with the same sequence number already exists in the inbound queue.")},o.prototype._addToInboundQueue=function(e){g.assert(e,"Message cannot be null."),g.debug.serverForm&&this._assertSequenceNumberNotUsed(e.SequenceNumber);var t=this.inboundMessages.length;if(0===t||this.inboundMessages[t-1].SequenceNumber<e.SequenceNumber)this.inboundMessages.push(e);else if(this.inboundMessages[0].SequenceNumber>e.SequenceNumber)this.inboundMessages.unshift(e);else{g.assert(2<t,"Something wrong with the boundary insertion logic.");for(var o=t-1;0<o;o--){var n=this.inboundMessages[o].SequenceNumber;if(n<e.SequenceNumber)return void this.inboundMessages.splice(o+1,0,e);if(n===e.SequenceNumber)throw new Error("Duplicate sequence number")}g.assert(!1,"This statement should not be reached.")}},o.serviceAddress="Services/ReliableCommunicationManager.svc/ProcessMessages",t=o,(e.ReliableChannel=t).prototype._serverRequestTask=new g.PerformanceTask("serverRequest",!0)}($dyn=$dyn||{}),$dyn.serverForm.compilation={formsCache:{},getFormDefinition:function(n,i){if(n=n&&n.toLowerCase(),$dyn.serverForm.compilation.formsCache[n]){var e=$dyn.serverForm.compilation.formsCache[n];$dyn.async(function(){i(e)},50,"Get form definition callback")}else{var t={type:"GET"};$dyn.flags.useDesignTimeView?t.url="./webcontent/form/"+n+".json":t.url=$dyn.util.resolveVirtualPath("/webcontent/form/"+n),t.dataType="json",t.success=function(e,t,o){e=e&&($dyn.serverForm.compilation.formsCache[n]=$dyn.serverForm.compilation.generateViewModel(e)),i(e)},t.error=function(e,t,o){$dyn.logError(o),i()},$.ajax(t)}},generateViewModel:function(e){var t=e.TypeName,o={TypeName:t,Name:e.Name,ValueProperties:{},SerializedValueProperties:{},ReferenceProperties:{},Commands:{},PropertyTriggers:{}};if($dyn.serverForm.metadata[t]){if($dyn.serverForm.metadata[t].ValueProperties)for(var n=0,i=$dyn.serverForm.metadata[t].ValueProperties.length;n<i;n++){var r,a=$dyn.serverForm.metadata[t].ValueProperties[n];e.SerializedValueProperties&&e.SerializedValueProperties.hasOwnProperty(a.Name)?(o.SerializedValueProperties[a.Name]=e.SerializedValueProperties[a.Name],e.SerializedValueProperties[a.Name]=void 0,delete e.SerializedValueProperties[a.Name],r=!0):e.ValueProperties&&e.ValueProperties.hasOwnProperty(a.Name)&&(o.ValueProperties[a.Name]=e.ValueProperties[a.Name],e.ValueProperties[a.Name]=void 0,delete e.ValueProperties[a.Name],r=!0),r||(a.ValueType===$dyn.serverForm.ValueType.serialized?o.SerializedValueProperties[a.Name]=a.Value:o.ValueProperties[a.Name]=a.Value)}for(var s in e.Properties){var l=e.Properties[s];o.ValueProperties.hasOwnProperty(s)?o.ValueProperties[s]=l:o.SerializedValueProperties.hasOwnProperty(s)?o.SerializedValueProperties[s]=l:($dyn.log($dyn.format("Unknown property: {0}",s)),$dyn.flags.useDesignTimeView&&(o.ValueProperties[s]=l))}for(var s in e.ValueProperties)$dyn.log("Unknown property: %s-%s",e.TypeName,s),$dyn.flags.useDesignTimeView&&(o.ValueProperties[s]=l);for(var s in e.SerializedValueProperties)$dyn.log("Unknown property: %s-%s",e.TypeName,s),$dyn.flags.useDesignTimeView&&(o.SerializedValueProperties[s]=l);e.ReferenceProperties&&(o.ReferenceProperties=e.ReferenceProperties),$dyn.flags.useDesignTimeView||(e.Commands&&(o.Commands=e.Commands),$dyn.serverForm.metadata[t].Commands&&$.each($dyn.serverForm.metadata[t].Commands,function(e,t){o.Commands[t.CommandName]||(o.Commands[t.CommandName]=Object.create(t))}),e.PropertyTriggers&&(o.PropertyTriggers=e.PropertyTriggers)),$dyn.serverForm.metadata[t].PropertyTriggers&&$.each($dyn.serverForm.metadata[t].PropertyTriggers,function(e,t){o.PropertyTriggers[t.PropertyName]||(o.PropertyTriggers[t.PropertyName]=Object.create(t))})}return e.ChildViewModels&&(o.ChildViewModels=[],$.each(e.ChildViewModels,function(e,t){o.ChildViewModels.push($dyn.serverForm.compilation.generateViewModel(t))})),$dyn.serverForm.compilation.adapters[t]&&$dyn.serverForm.compilation.adapters[t](e,o),o}},$dyn.serverForm.compilation.adapters={},$dyn.serverForm.compilation.adapters.Grid=function(e,t){var o=void 0!==e.ValueProperties?e.ValueProperties:e.Properties;o&&(o.ListItemViewModelDescriptor&&t.ValueProperties.ListItemViewModelDescriptor&&(t.ValueProperties.ListItemViewModelDescriptor=$dyn.serverForm.compilation.generateViewModel(o.ListItemViewModelDescriptor)),o.Mode&&t.ValueProperties.Mode&&(t.ValueProperties.Mode=o.Mode),o.PrimaryModelName&&t.ValueProperties.PrimaryModelName&&(t.ValueProperties.PrimaryModelName=o.PrimaryModelName))},$dyn.serverForm.compilation.adapters.SectionPage=function(e,t){var o=void 0!==e.ValueProperties?e.ValueProperties:e.Properties;o.Expanded&&t.ValueProperties.Expanded&&(t.ValueProperties.Expanded=o.Expanded?1:0)},$dyn.serverForm.compilation.adapters.Image=function(e,t){t&&(t.PropertyTriggers=t.PropertyTriggers||{},t.PropertyTriggers.Value={PropertyName:"Value",ChangeAction:{ValueTypeName:$dyn.serverForm.CommandName.propertyChange,CommandName:"Value"}})},$dyn.serverForm.compilation.StaticLoader={staticLoaderOn:$dyn.debug.staticLoaderOn||$dyn.flags.useDesignTimeView,applyDescriptors:function(e,t,o){t.Id=o;var n={$type:$dyn.serverForm.InteractionType.createViewModel,Descriptor:t,RootId:o};$dyn.shell.isPreProcessing=!0,e.processInteractions([n],!0),$dyn.shell.isPreProcessing=!1},load:function(n,i,r,a){var e=this;i.dynReadyState("preloadRequest"),$dyn.debug.trackFormPerformance&&i.dynPerformance&&(i.dynPerformance.preloadRequestStart=performance.now());$dyn.async(function(){e.loadDefinition(n,function(e){if(i.dynReadyState()===$dyn.ui.ReadyState.preloadRequest){if($dyn.debug.trackFormPerformance&&i.dynPerformance&&(i.dynPerformance.preloadRequestEnd=performance.now(),i.dynPerformance.preloadRequestTime=i.dynPerformance.preloadRequestEnd-i.dynPerformance.preloadRequestStart),i.dynReadyState("preloading"),$dyn.debug.trackFormPerformance&&i.dynPerformance&&(i.dynPerformance.preloadingStart=performance.now()),null!=e){i.dynPreloaded=!0,void 0===r&&(r=i.getAttribute("data-dyn-formid"));var t=$dyn.context(i),o=t&&t.DataSource;o&&(o.collectionName=e.Name),$(i).closest(document.body).length?$dyn.serverForm.compilation.StaticLoader.applyDescriptors(a,e,r):$dyn.log("Ignoring applyDescriptors because the parent form was already closed.")}$dyn.debug.trackFormPerformance&&i.dynPerformance&&(i.dynPerformance.preloadingEnd=performance.now(),i.dynPerformance.preLoadingTime=i.dynPerformance.preloadingEnd-i.dynPerformance.preloadRequestStart),i.dynReadyState("request"),$dyn.log.server&&$dyn.log.server("ServerForm: Static loading completed: %s",n)}else $dyn.log.server&&$dyn.log.server("Attempted to set dynReadyState from %s to preloading",i.dynReadyState());a.blockInbound(!1)})},0,"StaticLoader load")},loadDefinition:function(e,t){$dyn.serverForm.compilation.getFormDefinition(e,t)}},function(o){var e;function t(e,t){return e.ValueProperties&&(t.ValueProperties=e.ValueProperties.concat(t.ValueProperties||[])),e.Commands&&(t.Commands=e.Commands.concat(t.Commands||[])),e.PropertyTriggers&&(t.PropertyTriggers=e.PropertyTriggers.concat(t.PropertyTriggers||[])),t}(e=o.serverForm||(o.serverForm={})).metadata={},e.metadata.Form={ValueProperties:[{Name:"Caption",ValueType:o.serverForm.ValueType.string},{Name:"FormName",ValueType:o.serverForm.ValueType.string},{Name:"MenuItemName",ValueType:o.serverForm.ValueType.string},{Name:"FormSetDefaultCompany",ValueType:o.serverForm.ValueType.string},{Name:"FormCompany",ValueType:o.serverForm.ValueType.string},{Name:"FormCompanyName",ValueType:o.serverForm.ValueType.string},{Name:"ActiveControl",ValueType:o.serverForm.ValueType.string},{Name:"Style",ValueType:o.serverForm.ValueType.string},{Name:"DisplayParameters",ValueType:o.serverForm.ValueType.string},{Name:"ArrangeMethod",ValueType:o.serverForm.ValueType.string},{Name:"UseArrange",ValueType:o.serverForm.ValueType.string},{Name:"IsInViewMode",ValueType:o.serverForm.ValueType.string},{Name:"Columns",ValueType:o.serverForm.ValueType.string},{Name:"OnSelectControlEnabled",ValueType:o.serverForm.ValueType.serialized},{Name:"IsFormReady",ValueType:o.serverForm.ValueType.serialized},{Name:"ShowLinkToGridView",ValueType:o.serverForm.ValueType.serialized},{Name:"DialogSize",ValueType:o.serverForm.ValueType.string},{Name:"Visible",ValueType:o.serverForm.ValueType.serialized},{Name:"ParentTitleFields",ValueType:o.serverForm.ValueType.string},{Name:"DefaultActionEnabled",ValueType:o.serverForm.ValueType.serialized},{Name:"CanSwitchViewMode",ValueType:o.serverForm.ValueType.serialized},{Name:"CurrentViewKey",ValueType:o.serverForm.ValueType.serialized},{Name:"PersonalizationViewsSaveModel",ValueType:o.serverForm.ValueType.serialized},{Name:"UnsavedViewChanges",ValueType:o.serverForm.ValueType.serialized},{Name:"PersonalizationViewsSaveModel",ValueType:o.serverForm.ValueType.serialized},{Name:"SaveLinkedViews",ValueType:o.serverForm.ValueType.serialized},{Name:"DisplayTarget",ValueType:o.serverForm.ValueType.serialized},{Name:"TriggerLocalRefresh",ValueType:o.serverForm.ValueType.serialized},{Name:"AllowRootNavigation",ValueType:o.serverForm.ValueType.serialized},{Name:"FactBoxPaneInitiallyExpanded",ValueType:o.serverForm.ValueType.serialized},{Name:"AllowExplicitPersonalization",ValueType:o.serverForm.ValueType.serialized},{Name:"RecordContext",ValueType:o.serverForm.ValueType.string},{Name:"AllowPersonalization",ValueType:o.serverForm.ValueType.serialized},{Name:"PersonalizationData",ValueType:o.serverForm.ValueType.serialized},{Name:"PersonalizedWidth",ValueType:o.serverForm.ValueType.serialized}],Commands:[{CommandName:"RequestClose",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!0,SendTelemetry:!0}},{CommandName:"OpenGridView",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"DefaultAction",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!0,SendTelemetry:!0}},{CommandName:"RequestCloseCancel",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!0,SendTelemetry:!0}},{CommandName:"PersistPersonalization",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"ExecutePersonalizationCommand",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!0}},{CommandName:"UpdatePersonalizationData",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!1,ShouldBlockOnExecution:!1}},{CommandName:"AddInfoStep",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"UpdateRecordContext",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"ExecuteShortcuts",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!0,SendTelemetry:!0}},{CommandName:"Filter",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}}]},e.metadata.Part={ValueProperties:[{Name:"Caption",ValueType:o.serverForm.ValueType.string},{Name:"MenuItemName",ValueType:o.serverForm.ValueType.string},{Name:"ObjectName",ValueType:o.serverForm.ValueType.string},{Name:"FormName",ValueType:o.serverForm.ValueType.string},{Name:"RunMode",ValueType:o.serverForm.ValueType.string},{Name:"FormId",ValueType:o.serverForm.ValueType.string},{Name:"Visible",ValueType:o.serverForm.ValueType.serialized},{Name:"Expanded",ValueType:o.serverForm.ValueType.serialized},{Name:"IsFirstChild",ValueType:o.serverForm.ValueType.serialized},{Name:"RefreshInterval",ValueType:o.serverForm.ValueType.serialized}],Commands:[{CommandName:"CreateForm",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"InitPartForm",ValueTypeName:"InitPartForm",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"ShouldCreatePartForm",ValueTypeName:"ShouldCreatePartForm",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"CreatePartForm",ValueTypeName:"CreatePartForm",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}}]},e.metadata.FactBox={ValueProperties:[{Name:"Caption",ValueType:o.serverForm.ValueType.string},{Name:"MenuItemName",ValueType:o.serverForm.ValueType.string},{Name:"ObjectName",ValueType:o.serverForm.ValueType.string},{Name:"FormName",ValueType:o.serverForm.ValueType.string},{Name:"RunMode",ValueType:o.serverForm.ValueType.string},{Name:"FormId",ValueType:o.serverForm.ValueType.string},{Name:"Visible",ValueType:o.serverForm.ValueType.serialized},{Name:"Expanded",ValueType:o.serverForm.ValueType.serialized}],Commands:[{CommandName:"CreateForm",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"Expand",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}},{CommandName:"SystemExpand",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"InitPartForm",ValueTypeName:"InitPartForm",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"ShouldCreatePartForm",ValueTypeName:"ShouldCreatePartForm",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"CreatePartForm",ValueTypeName:"CreatePartForm",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}}]},e.metadata.Dialog=e.metadata.DynamicsDialog=e.metadata.Form,e.metadata.Control={ValueProperties:[{Name:"CanHavePreview",Value:"false",ValueType:o.serverForm.ValueType.serialized},{Name:"HasPreview",ValueType:o.serverForm.ValueType.serialized},{Name:"Enabled",Value:"true",ValueType:o.serverForm.ValueType.serialized,Virtualizer:function(){return!0},DefaultVirtualValue:!1},{Name:"ExtendedStyle",PropertyName:"ExtendedStyle",ValueType:o.serverForm.ValueType.string},{Name:"Height",ValueType:o.serverForm.ValueType.string},{Name:"HorizontalSplitter",Value:"None",ValueType:o.serverForm.ValueType.string},{Name:"IsViewMode",ValueType:o.serverForm.ValueType.serialized},{Name:"PrimaryModelName",ValueType:o.serverForm.ValueType.string},{Name:"ServiceBoundary",ValueType:o.serverForm.ValueType.string},{Name:"Resource",ValueType:o.serverForm.ValueType.string},{Name:"Skip",ValueType:o.serverForm.ValueType.string},{Name:"VerticalSplitter",Value:"None",ValueType:o.serverForm.ValueType.string},{Name:"Visible",Value:"true",ValueType:o.serverForm.ValueType.serialized},{Name:"Width",ValueType:o.serverForm.ValueType.string},{Name:"HasContextMenuOptions",Value:"false",ValueType:o.serverForm.ValueType.serialized},{Name:"OnEnterEnabled",ValueType:o.serverForm.ValueType.string},{Name:"OnLeaveEnabled",ValueType:o.serverForm.ValueType.string},{Name:"AllowPersonalization",ValueType:o.serverForm.ValueType.serialized},{Name:"HelpText",ValueType:o.serverForm.ValueType.string}],Commands:[{CommandName:"GetContextMenuOptions",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}},{CommandName:"RequestEnhancedPreview",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}},{CommandName:"SelectedMenuOption",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}},{CommandName:"AddInfoStep",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"PersistPersonalization",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"ExecutePersonalizationCommand",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!0}}]},e.metadata.DocumentViewer=e.metadata.Control,e.metadata.Button=t(e.metadata.Control,{ValueProperties:[{Name:"ButtonDisplay",PropertyName:"ButtonDisplay",ValueType:o.serverForm.ValueType.string},{Name:"DefaultButton",PropertyName:"DefaultButton",Value:"false",ValueType:o.serverForm.ValueType.serialized},{Name:"ImageName",PropertyName:"ImageName",ValueType:o.serverForm.ValueType.string},{Name:"ImageType",PropertyName:"ImageType",ValueType:o.serverForm.ValueType.string},{Name:"IsBig",PropertyName:"IsBig",Value:"false",ValueType:o.serverForm.ValueType.serialized},{Name:"SaveRecord",PropertyName:"SaveRecord",Value:"false",ValueType:o.serverForm.ValueType.serialized},{Name:"Label",PropertyName:"Label",ValueType:o.serverForm.ValueType.string},{Name:"Style",PropertyName:"buttonStyle",ValueType:o.serverForm.ValueType.string},{Name:"HelpText",PropertyName:"HelpText",ValueType:o.serverForm.ValueType.string},{Name:"RequiresSelectedControl",PropertyName:"RequiresSelectedControl",Value:"false",ValueType:o.serverForm.ValueType.serialized},{Name:"CanAcquireFocus",PropertyName:"CanAcquireFocus",Value:"true",ValueType:o.serverForm.ValueType.serialized}],Commands:[{CommandName:"Click",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!0,SendTelemetry:!0}}]}),e.metadata.MenuItemSeparator=t(e.metadata.Control,{ValueProperties:[{Name:"Label",PropertyName:"Label",ValueType:o.serverForm.ValueType.string},{Name:"ShowLabel",PropertyName:"ShowLabel",ValueType:o.serverForm.ValueType.string}]}),e.metadata.ActionGroup=t(e.metadata.Control,{ValueProperties:[{Name:"Label",ValueType:o.serverForm.ValueType.string},{Name:"ShowLabel",ValueType:o.serverForm.ValueType.string},{Name:"UseArrange",ValueType:o.serverForm.ValueType.string},{Name:"ArrangeMethod",ValueType:o.serverForm.ValueType.string},{Name:"Columns",ValueType:o.serverForm.ValueType.string}]}),e.metadata.Tile=t(e.metadata.Button,{ValueProperties:[{Name:"FormName",PropertyName:"FormName",ValueType:o.serverForm.ValueType.string},{Name:"KpiName",PropertyName:"KpiName",ValueType:o.serverForm.ValueType.string},{Name:"MenuItemName",PropertyName:"MenuItemName",ValueType:o.serverForm.ValueType.string},{Name:"MenuItemType",PropertyName:"MenuItemType",ValueType:o.serverForm.ValueType.string},{Name:"TileType",PropertyName:"TileType",ValueType:o.serverForm.ValueType.string},{Name:"Url",PropertyName:"Url",ValueType:o.serverForm.ValueType.string},{Name:"Size",PropertyName:"Size",ValueType:o.serverForm.ValueType.string}],PropertyTriggers:[{PropertyName:"Url",ChangeAction:{ValueTypeName:o.serverForm.CommandName.propertyChange,CommandName:"Url"}}],Commands:[{CommandName:"GetTileData",ValueTypeName:"GetTileData",Properties:{ExecuteImmediate:!1,ShouldBlockOnExecution:!1}},{CommandName:"getData",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!1,ShouldBlockOnExecution:!1}},{CommandName:"ForceRefresh",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!1,ShouldBlockOnExecution:!1}}]}),e.metadata.DropDialogButton=t(e.metadata.Button,{ValueProperties:[{Name:"FormName",PropertyName:"FormName",ValueType:o.serverForm.ValueType.string}],Commands:[{CommandName:"Click",ValueTypeName:"Navigate"},{CommandName:"RequestPopup",ValueTypeName:"OpenPopup",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!0,SendTelemetry:!0}},{CommandName:"RequestClose",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!0,SendTelemetry:!0}}]}),e.metadata.MenuItemButton=e.metadata.Tile,e.metadata.CommandButton=t(e.metadata.Button,{ValueProperties:[{Name:"Command",PropertyName:"Command",ValueType:o.serverForm.ValueType.string},{Name:"Data",PropertyName:"Data",ValueType:o.serverForm.ValueType.string}]}),e.metadata.AnchorButton=t(e.metadata.Button,{ValueProperties:[{Name:"FormName",PropertyName:"FormName",ValueType:o.serverForm.ValueType.string},{Name:"MenuItemName",PropertyName:"MenuItemName",ValueType:o.serverForm.ValueType.string},{Name:"MenuItemType",PropertyName:"MenuItemType",ValueType:o.serverForm.ValueType.string},{Name:"Command",PropertyName:"Command",ValueType:o.serverForm.ValueType.string},{Name:"Data",PropertyName:"Data",ValueType:o.serverForm.ValueType.string}]}),e.metadata.MenuItem=e.metadata.AnchorButton,e.metadata.ToggleButton=t(e.metadata.Button,{ValueProperties:[{Name:"Toggled",PropertyName:"Toggled",ValueType:o.serverForm.ValueType.serialized},{Name:"Command",PropertyName:"Command",ValueType:o.serverForm.ValueType.string},{Name:"Data",PropertyName:"Data",ValueType:o.serverForm.ValueType.string}],Commands:[{CommandName:"SetToggled",ValueTypeName:"InteractionCommand"}]}),e.metadata.MenuButton=t(e.metadata.Button,{ValueProperties:[{Name:"HasBeenOpened",Value:"false",ValueType:o.serverForm.ValueType.serialized}]}),e.metadata.EditControl=t(e.metadata.Control,{ValueProperties:[{Name:"AllowEdit",Value:"true",ValueType:o.serverForm.ValueType.serialized,Virtualizer:function(){return!1},DefaultVirtualValue:!1},{Name:"IsValid",Value:"true",ValueType:o.serverForm.ValueType.serialized},{Name:"Style",ValueType:o.serverForm.ValueType.string},{Name:"Label",ValueType:o.serverForm.ValueType.string},{Name:"ShowLabel",Value:"true",ValueType:o.serverForm.ValueType.serialized},{Name:"Required",Value:"false",ValueType:o.serverForm.ValueType.serialized},{Name:"DisplayOptions",PropertyName:"DisplayOptions",ValueType:o.serverForm.ValueType.object,Virtualizer:o.serverForm.getVirtualValue},{Name:"IsFilterable",Value:"false",ValueType:o.serverForm.ValueType.serialized},{Name:"IsFiltered",Value:"false",ValueType:o.serverForm.ValueType.serialized},{Name:"SortDirection",ValueType:o.serverForm.ValueType.serialized},{Name:"ClientState",ValueType:o.serverForm.ValueType.string},{Name:"IsHyperlink",ValueType:o.serverForm.ValueType.serialized},{Name:"BackgroundColor",ValueType:o.serverForm.ValueType.string},{Name:"ForegroundColor",ValueType:o.serverForm.ValueType.string},{Name:"HelpText",ValueType:o.serverForm.ValueType.string}],PropertyTriggers:[{PropertyName:"ClientState",ChangeAction:{ValueTypeName:o.serverForm.CommandName.propertyChange,CommandName:"ClientState"}},{PropertyName:"IsValid",ChangeAction:{ValueTypeName:o.serverForm.CommandName.propertyChange,CommandName:"IsValid"}}],Commands:[{CommandName:"copy_Value",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"paste_Value",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"validate_Value",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"validate_Enabled",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"validate_EditMode",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}}]}),e.metadata.Input=t(e.metadata.EditControl,{ValueProperties:[{Name:"Alignment",ValueType:o.serverForm.ValueType.string},{Name:"DisplayHeight",ValueType:o.serverForm.ValueType.serialized},{Name:"LimitText",ValueType:o.serverForm.ValueType.string},{Name:"LookupButton",Value:"false",ValueType:o.serverForm.ValueType.serialized},{Name:"PlaceHolder",ValueType:o.serverForm.ValueType.string},{Name:"ReplaceOnLookup",Value:"true",ValueType:o.serverForm.ValueType.serialized},{Name:"LookupOnly",ValueType:o.serverForm.ValueType.string},{Name:"PasswordMode",ValueType:o.serverForm.ValueType.string},{Name:"IsEmptyPassword",ValueType:o.serverForm.ValueType.string},{Name:"Value",ValueType:o.serverForm.ValueType.string}],Commands:[{CommandName:"ExecuteHyperlink",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!0,SendTelemetry:!0}},{CommandName:"SetValue",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}},{CommandName:"RequestPopup",ValueTypeName:"OpenPopup",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}}]}),e.metadata.MultilineInput=e.metadata.Input,e.metadata.SegmentedEntry=e.metadata.Input,e.metadata.Integer=t(e.metadata.EditControl,{ValueProperties:[{Name:"Alignment",ValueType:o.serverForm.ValueType.string},{Name:"AllowNegative",ValueType:o.serverForm.ValueType.string},{Name:"DisplaceNegative",ValueType:o.serverForm.ValueType.string},{Name:"DisplayHeight",ValueType:o.serverForm.ValueType.serialized},{Name:"LimitText",ValueType:o.serverForm.ValueType.string},{Name:"LookupButton",Value:"false",ValueType:o.serverForm.ValueType.serialized},{Name:"PlaceHolder",ValueType:o.serverForm.ValueType.string},{Name:"ReplaceOnLookup",Value:"true",ValueType:o.serverForm.ValueType.serialized},{Name:"RotateSign",ValueType:o.serverForm.ValueType.string},{Name:"ShowZero",ValueType:o.serverForm.ValueType.string},{Name:"SignDisplay",ValueType:o.serverForm.ValueType.string},{Name:"Value",ValueType:o.serverForm.ValueType.string}],Commands:[{CommandName:"ExecuteHyperlink",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}},{CommandName:"SetValue",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}},{CommandName:"RequestPopup",ValueTypeName:"OpenPopup",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}}]}),e.metadata.Int64=e.metadata.Integer,e.metadata.Real=t(e.metadata.Integer,{ValueProperties:[{Name:"AutoInsSeparator",ValueType:o.serverForm.ValueType.string},{Name:"DecimalSeparator",ValueType:o.serverForm.ValueType.string},{Name:"FormatMST",ValueType:o.serverForm.ValueType.string},{Name:"MinNoOfDecimals",ValueType:o.serverForm.ValueType.string},{Name:"NoOfDecimals",ValueType:o.serverForm.ValueType.string},{Name:"ThousandSeparator",ValueType:o.serverForm.ValueType.string},{Name:"SupportsCorrection",Value:"false",ValueType:o.serverForm.ValueType.serialized},{Name:"IsCorrection",Value:"false",ValueType:o.serverForm.ValueType.serialized,Virtualizer:o.serverForm.getVirtualValue}]}),e.metadata.Date=t(e.metadata.EditControl,{ValueProperties:[{Name:"Alignment",ValueType:o.serverForm.ValueType.string},{Name:"DateDay",ValueType:o.serverForm.ValueType.string},{Name:"DateFormat",ValueType:o.serverForm.ValueType.string},{Name:"DateMonth",ValueType:o.serverForm.ValueType.string},{Name:"DateSeparator",ValueType:o.serverForm.ValueType.string},{Name:"DateYear",ValueType:o.serverForm.ValueType.string},{Name:"DisplayHeight",ValueType:o.serverForm.ValueType.serialized},{Name:"CanOpenLookupForm",Value:"false",ValueType:o.serverForm.ValueType.serialized},{Name:"LookupButton",Value:"false",ValueType:o.serverForm.ValueType.serialized},{Name:"PlaceHolder",ValueType:o.serverForm.ValueType.string},{Name:"ReplaceOnLookup",Value:"true",ValueType:o.serverForm.ValueType.serialized},{Name:"LimitText",ValueType:o.serverForm.ValueType.string},{Name:"MaxDateLabel",ValueType:o.serverForm.ValueType.string},{Name:"Value",ValueType:o.serverForm.ValueType.string}],Commands:[{CommandName:"ExecuteHyperlink",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}},{CommandName:"RequestPopup",ValueTypeName:"OpenPopup",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}},{CommandName:"SetValue",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}}]}),e.metadata.DateTime=t(e.metadata.Date,{ValueProperties:[{Name:"DisplayOption",ValueType:o.serverForm.ValueType.string},{Name:"ShowTimeZoneIndicator",ValueType:o.serverForm.ValueType.serialized},{Name:"TimeFormat",ValueType:o.serverForm.ValueType.string},{Name:"TimeHours",ValueType:o.serverForm.ValueType.serialized},{Name:"TimeMinute",ValueType:o.serverForm.ValueType.serialized},{Name:"TimeSeconds",ValueType:o.serverForm.ValueType.serialized},{Name:"TimeSeparator",ValueType:o.serverForm.ValueType.string},{Name:"TimeZoneIndicator",ValueType:o.serverForm.ValueType.string},{Name:"TimeZonePreference",ValueType:o.serverForm.ValueType.string},{Name:"TimeZoneName",ValueType:o.serverForm.ValueType.string}]}),e.metadata.Time=t(e.metadata.EditControl,{ValueProperties:[{Name:"Alignment",ValueType:o.serverForm.ValueType.string},{Name:"DisplayHeight",ValueType:o.serverForm.ValueType.serialized},{Name:"LimitText",ValueType:o.serverForm.ValueType.string},{Name:"LookupButton",Value:"false",ValueType:o.serverForm.ValueType.serialized},{Name:"PlaceHolder",ValueType:o.serverForm.ValueType.string},{Name:"ReplaceOnLookup",Value:"true",ValueType:o.serverForm.ValueType.serialized},{Name:"MaxDateLabel",ValueType:o.serverForm.ValueType.string},{Name:"TimeFormat",ValueType:o.serverForm.ValueType.string},{Name:"TimeHours",ValueType:o.serverForm.ValueType.serialized},{Name:"TimeMinute",ValueType:o.serverForm.ValueType.serialized},{Name:"TimeSeconds",ValueType:o.serverForm.ValueType.serialized},{Name:"TimeSeparator",ValueType:o.serverForm.ValueType.string},{Name:"Value",ValueType:o.serverForm.ValueType.string}],Commands:[{CommandName:"ExecuteHyperlink",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}},{CommandName:"SetValue",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}}]}),e.metadata.InputSummary=e.metadata.Input,e.metadata.MultilineInputSummary=e.metadata.Input,e.metadata.RealSummary=e.metadata.Real,e.metadata.IntegerSummary=e.metadata.Integer,e.metadata.Int64Summary=e.metadata.Int64,e.metadata.DateSummary=e.metadata.Date,e.metadata.DateTimeSummary=e.metadata.DateTime,e.metadata.TimeSummary=e.metadata.Time,e.metadata.InputLabel=e.metadata.Input,e.metadata.MultilineInputLabel=e.metadata.Input,e.metadata.RealLabel=e.metadata.Real,e.metadata.IntegerLabel=e.metadata.Integer,e.metadata.Int64Label=e.metadata.Int64,e.metadata.DateLabel=e.metadata.Date,e.metadata.DateTimeLabel=e.metadata.DateTime,e.metadata.TimeLabel=e.metadata.Time,e.metadata.Grid=t(e.metadata.Control,{ValueProperties:[{Name:"AllowEdit",ValueType:o.serverForm.ValueType.serialized},{Name:"HideSelection",PropertyName:"HideSelection",ValueType:o.serverForm.ValueType.serialized},{Name:"IsHeaderVisible",Value:"true",ValueType:o.serverForm.ValueType.serialized},{Name:"IsMarkingEnabled",ValueType:o.serverForm.ValueType.serialized},{Name:"InfiniteScroll",ValueType:o.serverForm.ValueType.serialized},{Name:"NavigationEnabled",ValueType:o.serverForm.ValueType.serialized},{Name:"IsSelectionIndicatorVisible",ValueType:o.serverForm.ValueType.serialized},{Name:"ListItemViewModelDescriptor",ValueType:o.serverForm.ValueType.other},{Name:"Mode",ValueType:o.serverForm.ValueType.string},{Name:"MarkAllRecords",ValueType:o.serverForm.ValueType.serialized},{Name:"NavigationActionLabel",ValueType:o.serverForm.ValueType.string},{Name:"VisibleColumnCount",ValueType:o.serverForm.ValueType.serialized},{Name:"VisibleRowCount",Value:"true",ValueType:o.serverForm.ValueType.serialized},{Name:"GroupBy",ValueType:o.serverForm.ValueType.string},{Name:"GridLines",ValueType:o.serverForm.ValueType.string},{Name:"FormName",ValueType:o.serverForm.ValueType.string},{Name:"ForcePrimaryNavigation",ValueType:o.serverForm.ValueType.string},{Name:"ExportAllowed",ValueType:o.serverForm.ValueType.serialized},{Name:"ExportLabel",ValueType:o.serverForm.ValueType.string},{Name:"FastEdit",ValueType:o.serverForm.ValueType.serialized},{Name:"AllowCreateOnKeyDown",ValueType:o.serverForm.ValueType.serialized},{Name:"HelpText",ValueType:o.serverForm.ValueType.string}],Commands:[{CommandName:"ChangeSelectedIndex",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!0,SendTelemetry:!0}},{CommandName:"LoadNextPage",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!0}},{CommandName:"LoadPreviousPage",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"Create",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!0}},{CommandName:"Delete",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!0}},{CommandName:"SetMarkAllRecordsMode",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"ToggleMark",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"NavigationAction",ValueTypeName:"Navigate",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!0,SendTelemetry:!0}},{CommandName:"ExportToExcel",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"LoadData",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"CreateNewRecord",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"CreateNewRecordOnKeyDown",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"SetClientViewStart",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!1,ShouldBlockOnExecution:!1}},{CommandName:"RecordabilityBeginGetData",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"LoadDataByTrackingId",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}}]}),e.metadata.List=e.metadata.ListView=e.metadata.Grid,e.metadata.Table=t(e.metadata.List,{ValueProperties:[{Name:"ColumnLabels",ValueType:o.serverForm.ValueType.serialized},{Name:"ShowRowLabels",ValueType:o.serverForm.ValueType.serialized},{Name:"RowIndex",ValueType:o.serverForm.ValueType.serialized},{Name:"ColumnIndex",ValueType:o.serverForm.ValueType.serialized}]}),e.metadata.Image=t(e.metadata.Control,{ValueProperties:[{Name:"ShowLabel",Value:"true",ValueType:o.serverForm.ValueType.serialized},{Name:"Label",ValueType:o.serverForm.ValueType.string},{Name:"Value",ValueType:o.serverForm.ValueType.string}],Commands:[{CommandName:"Click",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}}]}),e.metadata.Tree=t(e.metadata.Control,{ValueProperties:[{Name:"AllowEdit",PropertyName:"AllowEdit",Value:"true",ValueType:o.serverForm.ValueType.serialized},{Name:"Border",ValueType:o.serverForm.ValueType.string},{Name:"CascadeSelect",ValueType:o.serverForm.ValueType.string},{Name:"CheckBox",ValueType:o.serverForm.ValueType.serialized},{Name:"EditLabels",ValueType:o.serverForm.ValueType.serialized},{Name:"ExpandTree",ValueType:o.serverForm.ValueType.serialized},{Name:"HasButtons",ValueType:o.serverForm.ValueType.serialized},{Name:"RootNodeId",ValueType:o.serverForm.ValueType.serialized},{Name:"TreeNodes",ValueType:o.serverForm.ValueType.object},{Name:"SelectedItem",ValueType:o.serverForm.ValueType.string},{Name:"SingleSelect",ValueType:o.serverForm.ValueType.string},{Name:"ShowLabel",Value:"true",ValueType:o.serverForm.ValueType.serialized}],Commands:[{CommandName:"NodeNameChanged",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"Expanding",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}},{CommandName:"NodeChecked",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}},{CommandName:"SelectionChanged",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"SelectRange",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"ToggleSelection",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"Reserialize",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!1,ShouldBlockOnExecution:!1}}]}),e.metadata.EnumControl=t(e.metadata.EditControl,{ValueProperties:[{Name:"Items",ValueType:o.serverForm.ValueType.object},{Name:"SelectedItem",ValueType:o.serverForm.ValueType.string}],Commands:[{CommandName:"SetSelectedItem",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}}]}),e.metadata.ListBox=e.metadata.EnumControl,e.metadata.RadioButton=t(e.metadata.EnumControl,{ValueProperties:[{Name:"Columns",ValueType:o.serverForm.ValueType.string}]}),e.metadata.ComboBox=t(e.metadata.EnumControl,{ValueProperties:[{Name:"ComboType",ValueType:o.serverForm.ValueType.string}]}),e.metadata.ComboBoxSummary=e.metadata.ComboBox,e.metadata.CheckBox=t(e.metadata.Control,{ValueProperties:[{Name:"AllowEdit",Value:"true",ValueType:o.serverForm.ValueType.serialized,Virtualizer:function(){return!1},DefaultVirtualValue:!1},{Name:"Value",ValueType:o.serverForm.ValueType.string},{Name:"ShowLabel",Value:"true",ValueType:o.serverForm.ValueType.serialized},{Name:"Label",PropertyName:"Label",ValueType:o.serverForm.ValueType.string},{Name:"Style",ValueType:o.serverForm.ValueType.string},{Name:"IsFilterable",Value:"false",ValueType:o.serverForm.ValueType.serialized},{Name:"IsFiltered",Value:"false",ValueType:o.serverForm.ValueType.serialized},{Name:"SortDirection",ValueType:o.serverForm.ValueType.serialized},{Name:"HelpText",ValueType:o.serverForm.ValueType.string}],Commands:[{CommandName:"SetValue",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}},{CommandName:"copy_Value",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"paste_Value",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"validate_Value",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"validate_Enabled",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}},{CommandName:"validate_EditMode",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1}}]}),e.metadata.ReferenceGroup=t(e.metadata.EditControl,{ValueProperties:[{Name:"Alignment",ValueType:o.serverForm.ValueType.string}],Commands:[{CommandName:"RequestPopup",ValueTypeName:"OpenPopup",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}},{CommandName:"ResolveChanges",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}}]}),e.metadata.Label=t(e.metadata.Control,{ValueProperties:[{Name:"Style",ValueType:o.serverForm.ValueType.string},{Name:"Value",ValueType:o.serverForm.ValueType.string},{Name:"BackgroundColor",ValueType:o.serverForm.ValueType.string},{Name:"ForegroundColor",ValueType:o.serverForm.ValueType.string}],PropertyTriggers:[{PropertyName:"Value",ChangeAction:{ValueTypeName:o.serverForm.CommandName.propertyChange,CommandName:"Value"}}]}),e.metadata.ProgressBar=t(e.metadata.Control,{ValueProperties:[{Name:"IsIndeterminate",ValueType:o.serverForm.ValueType.serialized},{Name:"MaximumValue",ValueType:o.serverForm.ValueType.string},{Name:"MinimumValue",ValueType:o.serverForm.ValueType.string},{Name:"Step",ValueType:o.serverForm.ValueType.string},{Name:"Value",ValueType:o.serverForm.ValueType.string}],PropertyTriggers:[{PropertyName:"MaximumValue",ChangeAction:{ValueTypeName:o.serverForm.CommandName.propertyChange,CommandName:"MaximumValue"}},{PropertyName:"MinimumValue",ChangeAction:{ValueTypeName:o.serverForm.CommandName.propertyChange,CommandName:"MinimumValue"}},{PropertyName:"Step",ChangeAction:{ValueTypeName:o.serverForm.CommandName.propertyChange,CommandName:"Step"}},{PropertyName:"Value",ChangeAction:{ValueTypeName:o.serverForm.CommandName.propertyChange,CommandName:"Value"}}]}),e.metadata.Group=t(e.metadata.Control,{ValueProperties:[{Name:"ArrangeMethod",PropertyName:"ArrangeMethod",ValueType:o.serverForm.ValueType.string},{Name:"Columns",PropertyName:"Columns",ValueType:o.serverForm.ValueType.string},{Name:"FrameOptionButton",PropertyName:"FrameOptionButton",ValueType:o.serverForm.ValueType.string},{Name:"FrameOptionValue",ValueType:o.serverForm.ValueType.serialized},{Name:"FrameType",PropertyName:"FrameType",ValueType:o.serverForm.ValueType.string},{Name:"ShowLabel",PropertyName:"ShowLabel",Value:"true",ValueType:o.serverForm.ValueType.serialized},{Name:"Breakable",PropertyName:"Breakable",Value:"true",ValueType:o.serverForm.ValueType.serialized},{Name:"Style",PropertyName:"Style",ValueType:o.serverForm.ValueType.string},{Name:"AllowEdit",PropertyName:"AllowEdit",Value:"true",ValueType:o.serverForm.ValueType.serialized},{Name:"Label",PropertyName:"Label",ValueType:o.serverForm.ValueType.string},{Name:"UseArrange",PropertyName:"UseArrange",ValueType:o.serverForm.ValueType.serialized}],Commands:[{CommandName:"FrameOptionValueChanged",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}}]}),e.metadata.Card=t(e.metadata.Control,{ValueProperties:[{Name:"ArrangeMethod",ValueType:o.serverForm.ValueType.string},{Name:"Columns",ValueType:o.serverForm.ValueType.string},{Name:"FrameOptionButton",ValueType:o.serverForm.ValueType.string},{Name:"FrameOptionValue",ValueType:o.serverForm.ValueType.serialized},{Name:"FrameType",ValueType:o.serverForm.ValueType.string},{Name:"ShowLabel",Value:"true",ValueType:o.serverForm.ValueType.serialized},{Name:"Breakable",Value:"true",ValueType:o.serverForm.ValueType.serialized},{Name:"Style",ValueType:o.serverForm.ValueType.string},{Name:"AllowEdit",Value:"true",ValueType:o.serverForm.ValueType.serialized,Virtualizer:function(){return!1},DefaultVirtualValue:!1},{Name:"Label",ValueType:o.serverForm.ValueType.string},{Name:"UseArrange",ValueType:o.serverForm.ValueType.serialized}]}),e.metadata.Pivot=t(e.metadata.Control,{ValueProperties:[{Name:"ActiveItemName",ValueType:o.serverForm.ValueType.string},{Name:"IsPageView",Value:"false",ValueType:o.serverForm.ValueType.string},{Name:"ShowHeaders",Value:"true",ValueType:o.serverForm.ValueType.string},{Name:"Style",ValueType:o.serverForm.ValueType.string}]}),e.metadata.PivotItem=t(e.metadata.Control,{ValueProperties:[{Name:"ArrangeMethod",ValueType:o.serverForm.ValueType.string},{Name:"Columns",ValueType:o.serverForm.ValueType.string},{Name:"PanelStyle",ValueType:o.serverForm.ValueType.string},{Name:"Label",ValueType:o.serverForm.ValueType.string},{Name:"UseArrange",ValueType:o.serverForm.ValueType.serialized}],Commands:[{CommandName:"ActivateTab",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}}]}),e.metadata.Section=e.metadata.VerticalTabs=e.metadata.Panorama=e.metadata.DropList=e.metadata.Pivot,e.metadata.SectionPage=t(e.metadata.Control,{ValueProperties:[{Name:"ArrangeMethod",ValueType:o.serverForm.ValueType.string},{Name:"Columns",ValueType:o.serverForm.ValueType.string},{Name:"Expanded",ValueType:o.serverForm.ValueType.serialized},{Name:"FastTabExpanded",ValueType:o.serverForm.ValueType.string},{Name:"Label",ValueType:o.serverForm.ValueType.string},{Name:"UseArrange",ValueType:o.serverForm.ValueType.serialized}],Commands:[{CommandName:"ExpandedChanged",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}}]}),e.metadata.PanoramaItem=t(e.metadata.Control,{ValueProperties:[{Name:"ArrangeMethod",ValueType:o.serverForm.ValueType.string},{Name:"Columns",ValueType:o.serverForm.ValueType.string},{Name:"Label",ValueType:o.serverForm.ValueType.string},{Name:"UseArrange",ValueType:o.serverForm.ValueType.serialized}],Commands:[]}),e.metadata.ButtonGroup=t(e.metadata.Control,{ValueProperties:[{Name:"ArrangeMethod",PropertyName:"ArrangeMethod",ValueType:o.serverForm.ValueType.string},{Name:"Columns",PropertyName:"Columns",ValueType:o.serverForm.ValueType.string},{Name:"Label",PropertyName:"Label",ValueType:o.serverForm.ValueType.string},{Name:"UseArrange",PropertyName:"UseArrange",ValueType:o.serverForm.ValueType.serialized},{Name:"AlwaysInOverflow",PropertyName:"AlwaysInOverflow",ValueType:o.serverForm.ValueType.serialized}]}),e.metadata.Toolbar=t(e.metadata.Control,{ValueProperties:[{Name:"Label",ValueType:o.serverForm.ValueType.string}]}),e.metadata.AppBarSection=t(e.metadata.Control,{ValueProperties:[{Name:"IsPinnedOpen",ValueType:o.serverForm.ValueType.serialized},{Name:"LastActiveTabName",ValueType:o.serverForm.ValueType.serialized}]}),e.metadata.SectionPageHeader=t(e.metadata.Control,{}),e.metadata.AppBarTab=t(e.metadata.Control,{ValueProperties:[{Name:"ImageType",ValueType:o.serverForm.ValueType.string},{Name:"ImageName",ValueType:o.serverForm.ValueType.string},{Name:"Label",ValueType:o.serverForm.ValueType.string},{Name:"HasBeenOpened",ValueType:o.serverForm.ValueType.serialized},{Name:"IsInitiallyOpened",ValueType:o.serverForm.ValueType.serialized}],Commands:[{CommandName:"TabShown",ValueTypeName:"InteractionCommand",Properties:{ExecuteImmediate:!0,ShouldBlockOnExecution:!1,SendTelemetry:!0}}]}),e.metadata.AppBarGroup=e.metadata.Group,e.metadata.ToolbarGroup=t(e.metadata.ButtonGroup,{ValueProperties:[{Name:"ImageName",ValueType:o.serverForm.ValueType.string},{Name:"ImageType",ValueType:o.serverForm.ValueType.string},{Name:"HasBeenOpened",ValueType:o.serverForm.ValueType.serialized}]}),Object.keys(o.serverForm.metadata).forEach(function(t){o.serverForm.metadata[t].ValueProperties.forEach(function(e){o.serverForm.metadata[t].ValueProperties[e.Name]=e}),o.serverForm.metadata[t].Commands.forEach(function(e){o.serverForm.metadata[t].Commands[e.CommandName]=e})})}($dyn=$dyn||{}),function(b){(b.util||(b.util={})).newGuid=function(){function e(e){return Math.floor(Math.random()*e)}return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/x/g,function(){return"0123456789abcdef".charAt(e(16))}).replace("y","89ab".charAt(e(4)))};var e=(Object.defineProperty(t.prototype,"UtcTimestamp",{get:function(){return new Date(this.Timestamp).toISOString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"SearchStartTimestamp",{get:function(){return new Date(this.Timestamp-this.msTenMinutes)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"SearchEndTimestamp",{get:function(){return new Date(this.Timestamp+this.msTenMinutes)},enumerable:!1,configurable:!0}),t);function t(e){this.msTenMinutes=6e5,b.flags.staticGenerators?(this.Id="11111111-1111-1111-1111-111111111111",this.Timestamp=Date.UTC(0,0,0,0,0,0)):(this.Id=null!=e?e:"00000000-0000-0000-0000-000000000000",this.Timestamp=Date.now())}var o=(n.prototype.formatTraceLogUrl=function(e,t){var o="";if(this.TraceLogNodeName&&0<this.TraceLogNodeName.length){var n=b.format(this.searchTraceLogUrlTemplate,this.TraceLogNamespace,this.TraceLogTenant,this.TraceLogRole,this.TraceLogNodeName,e.toISOString().replace("T","+").replace(/:/g,"%3a"),t.toISOString().replace("T","+").replace(/:/g,"%3a"),this.BrowserSessionActivity.Id).match(this.pattern);o=n[1]+n[2]+n[3]}return o},Object.defineProperty(n.prototype,"SearchTraceLog",{get:function(){return b.flags.searchTraceLog},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"AOSRoleInstance",{get:function(){return this.TraceLogNodeName},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"SearchTraceLogUrl",{get:function(){return this.formatTraceLogUrl(this.BrowserInteractionActivity.SearchStartTimestamp,this.BrowserInteractionActivity.SearchEndTimestamp)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"FeedbackText",{get:function(){return b.format(this.feedbackText,this.BrowserSessionActivity.Id,new Date(this.BrowserSessionActivity.Timestamp).toISOString(),this.BrowserInteractionActivity.Id,new Date(this.BrowserInteractionActivity.Timestamp).toISOString())},enumerable:!1,configurable:!0}),n.prototype.newInteraction=function(e){this.BrowserInteractionActivity.Id=e,this.BrowserInteractionActivity.Timestamp=Date.now()},n.prototype.getPreviousActivityId=function(){return this.BrowserInteractionActivity.Id},n.prototype.resetBrowserSessionActivity=function(e,t){this.BrowserSessionActivity.Id=t?t.bid:b.util.newGuid(),this.BrowserSessionActivity.Timestamp=e,t.aid&&this.newInteraction(t.aid),b.performanceMark(b.format(this.setBrowserSessionActivityIDMark,this.BrowserSessionActivity.Id,this.BrowserSessionActivity.Timestamp))},n);function n(){this.setBrowserSessionActivityIDMark="SetBrowserSessionActivty ID:{0}, Timestamp {1}",this.pattern=/(.*)\..*(Z.*)\..*(Z.*)/,this.feedbackText=";[Browser[Session[Activity[ID:{0},Timestamp:{1}]],[Interaction[Activity[ID:{2},Timestamp:{3}]]",this.usePreviousActivityKey=!1,this.BrowserSessionActivity=new e(b.util.newGuid()),this.BrowserInteractionActivity=new e,this.TraceLogNodeName="",this.TraceLogNamespace="",this.TraceLogTenant="",this.TraceLogRole="",this.searchTraceLogUrlTemplate="https://test1.diagnostics.monitoring.core.windows.net/content/madashboard/madashboard.html?instance={0}%2f{1}%2f{2}%2f{3}%2f&tabpage=localsearch&table=TraceLog&start={4}&end={5}&query=%22browserSessionActivityId%3d%3d%22%22{6}%22%22%22%3bselect+ActivityId",this.searchTraceLogUrl="",this.aosRoleInstance="",this.aosId="",b.performanceMark(b.format(this.setBrowserSessionActivityIDMark,this.BrowserSessionActivity.Id,this.BrowserSessionActivity.Timestamp))}b.browserActivity=new o,function(a){if(b.telemetry.enabled){var n=b.roleHandlers.Control.prototype.initControl;b.roleHandlers.Control.prototype.initControl=function(e){if(n.apply(this,arguments),e){var t=e.TypeName;if(t){var o=b.telemetry.typeHandlers[t];o&&o.instrument(e)}}}}var e,t,o,i,r,s,l,u=1;if(a._eventQueue=[],a._areEventsStored=!1,a._storageKey="$dyn.telemetry.persistentEventQueue",a.addEvent=function(e){b.telemetry.enabled&&(e.EventGroupId=u,e.EventTimestamp=Date.now(),b.telemetry.addEventInternal?b.telemetry.addEventInternal(e):b.telemetry._eventQueue.push(e))},a.addPersistentEvent=function(e){if(b.telemetry.enabled&&(b.telemetry.addEvent(e),b.util.localStorageSupported())){var t=window.localStorage.getItem(b.telemetry._storageKey),o=[];t&&(o=JSON.parse(t)),o.push(e);try{b.telemetry._areEventsStored=!0,window.localStorage.setItem(b.telemetry._storageKey,JSON.stringify(o))}catch(e){b.util.localStorageErorrHandler(e.name)}}},a.clearEvents=function(){u++,b.telemetry._eventQueue.length=0},a.clearPersistentEventStorage=function(e){b.telemetry._areEventsStored&&(window.localStorage.removeItem(b.telemetry._storageKey),b.telemetry._areEventsStored=!1)},(e=a.TelemetryEventDataType||(a.TelemetryEventDataType={})).errorDisplayed="ErrorDisplayedEventData",e.performance="PerformanceEventData",e.action="ActionEventData",e.sessionAction="SessionActionEventData",e.userFeedback="UserFeedbackEventData",e.ping="PingEventData",e.navigationSearch="NavigationSearchEventData",e.navigation="NavigationEventData",e.actionSearch="ActionSearchEventData",e.communication="CommunicationEventData",a.createPerformanceEvent=function(){return{$type:b.telemetry.TelemetryEventDataType.performance}},a.createErrorEvent=function(){return{$type:b.telemetry.TelemetryEventDataType.errorDisplayed}},a.createActionEvent=function(){return{$type:b.telemetry.TelemetryEventDataType.action}},a.createSessionEvent=function(){return{$type:b.telemetry.TelemetryEventDataType.sessionAction}},a.createFeedbackEvent=function(){return{$type:b.telemetry.TelemetryEventDataType.userFeedback}},a.createPingEvent=function(){return{$type:b.telemetry.TelemetryEventDataType.ping}},a.createNavigationSearchEvent=function(){return{$type:b.telemetry.TelemetryEventDataType.navigationSearch}},a.createNavigationEvent=function(){return{$type:b.telemetry.TelemetryEventDataType.navigation}},a.createActionSearchEvent=function(){return{$type:b.telemetry.TelemetryEventDataType.actionSearch}},a.createCommunicationEvent=function(){return{$type:b.telemetry.TelemetryEventDataType.communication}},(t=a.PerformanceEvents||(a.PerformanceEvents={}))[t.openStart=0]="openStart",t[t.openStop=1]="openStop",t[t.renderStart=2]="renderStart",t[t.renderStop=3]="renderStop",t[t.preClient=4]="preClient",t[t.server=5]="server",t[t.postClient=6]="postClient",t[t.blockingDiv=7]="blockingDiv",(o=a.ActionEvents||(a.ActionEvents={}))[o.receivedFocus=0]="receivedFocus",o[o.valueChanged=1]="valueChanged",o[o.buttonClicked=2]="buttonClicked",o[o.copyOccurred=3]="copyOccurred",o[o.cutOccurred=4]="cutOccurred",o[o.pasteOccurred=5]="pasteOccurred",o[o.lookupActivated=6]="lookupActivated",o[o.jumpRefExecuted=7]="jumpRefExecuted",o[o.itemSelected=8]="itemSelected",o[o.itemUnselected=9]="itemUnselected",o[o.selectAll=10]="selectAll",o[o.unselectAll=11]="unselectAll",o[o.addItem=12]="addItem",o[o.removeItem=13]="removeItem",o[o.containerExpand=14]="containerExpand",o[o.containerCollapse=15]="containerCollapse",o[o.custom=16]="custom",o[o.hotKeyUsed=17]="hotKeyUsed",o[o.backNavigation=18]="backNavigation",o[o.previewDisplayed=19]="previewDisplayed",o[o.gridColumnSort=20]="gridColumnSort",o[o.gridColumnFilter=21]="gridColumnFilter",o[o.quickFilter=22]="quickFilter",o[o.filterDisplayFilter=23]="filterDisplayFilter",o[o.filterDisplayAddField=24]="filterDisplayAddField",o[o.filterDisplayReset=25]="filterDisplayReset",o[o.formPopout=26]="formPopout",o[o.keystrokeLoss=27]="keystrokeLoss",o[o.gridRequestTotals=28]="gridRequestTotals",o[o.gridPasteFromExcel=29]="gridPasteFromExcel",o[o.gridBulkEdit=30]="gridBulkEdit",(i=a.FeedbackType||(a.FeedbackType={}))[i.notSpecified=0]="notSpecified",i[i.positive=1]="positive",i[i.negative=2]="negative",(r=a.InputType||(a.InputType={}))[r.notSpecified=0]="notSpecified",r[r.mouse=1]="mouse",r[r.keyboard=2]="keyboard",(s=a.ErrorLocation||(a.ErrorLocation={}))[s.client=0]="client",s[s.server=1]="server",(l=a.SessionEvents||(a.SessionEvents={}))[l.begin=0]="begin",l[l.stateChange=1]="stateChange",a.createControlEvent=function(e,t){var o="",n="";if(e.Root&&(o=b.value(e.Root.FormName),e.Root.Id&&(n=e.Root.Id)),!o){var i=b.context(b.shell.getActiveForm());i&&(o=b.value(i.FormName),n=i.Id)}return t.FormName=o,t.FormUniqueId=n,t.TargetName=e.Name?e.Name:"",t.TargetType=e.TypeName?e.TypeName:"",t},a.addPerformanceEvent=function(e,t,o,n){if(null==o)return null;var i=null;return b.telemetry.enabled&&(n=n||{},(i=b.telemetry.createPerformanceEvent()).PerformanceEvent=o,i.FormName=e,n.forceLog||b.telemetry._shouldLogEvent(i)?(i.FormUniqueId=t,i.TargetName=n.targetName?n.targetName:"",i.TargetType=n.targetType?n.targetType:"",i.Duration=n.duration?n.duration:0,b.log("PerformanceEvent-Logged: eventArgs.PerformanceEvent:%s, eventArgs.FormName:%s, eventArgs.FormUniqueId: %s  eventArgs.TargetName: %s eventArgs.TargeType:%s eventArgs.Duration: %s",i.PerformanceEvent,i.FormName,i.FormUniqueId,i.TargetName,i.TargetType,i.Duration),b.telemetry.addEvent(i)):b.log("PerformanceEvent-Skipped: eventArgs.PerformanceEvent:%s, eventArgs.FormName:%s, eventArgs.FormUniqueId: %s  eventArgs.TargetName: %s eventArgs.TargeType:%s eventArgs.Duration: %s",i.PerformanceEvent,i.FormName,i.FormUniqueId,i.TargetName,i.TargetType,i.Duration)),i},a.isCriticalPerformanceEvent=function(e,t,o,n){var i=!1;return 1e3<e+t+o&&n!==b.label("PerformanceTimer_ClientAction")&&"ProcessEventData"!==n&&(i=!0),i},a.PerformanceTimer=function(e,t,o,n,i,r,a){var s=b.telemetry.isCriticalPerformanceEvent(e,t,o,n),l=b.telemetry.addPerformanceEvent("","",b.telemetry.PerformanceEvents.preClient,{targetName:n,duration:e,forceLog:s});b.telemetry.addPerformanceEvent("","",b.telemetry.PerformanceEvents.server,{targetName:n,duration:t,forceLog:s}),b.telemetry.addPerformanceEvent("","",b.telemetry.PerformanceEvents.postClient,{targetName:n,duration:o,forceLog:s}),b.telemetry.addPerformanceEvent("","",b.telemetry.PerformanceEvents.blockingDiv,{targetName:a,duration:r,forceLog:s}),(s||l&&b.telemetry._shouldLogEvent(l))&&(i&&(b.browserActivity.newInteraction(i),b.browserActivity.usePreviousActivityKey=!0),b.telemetry.flushTelemetryEvents&&b.telemetry.flushTelemetryEvents())},a.addSessionBeginEvent=function(){var e=null;if(b.telemetry.enabled&&((e=b.telemetry.createSessionEvent()).SessionAction=b.telemetry.SessionEvents.begin,b.telemetry._shouldLogEvent(e)&&$.ua)){var t="";$.ua.cpu&&$.ua.cpu.architecture?t=$.ua.cpu.architecture:navigator.cpuClass&&(t=navigator.cpuClass);var o="";navigator.systemLanguage&&(o=navigator.systemLanguage);var n="";navigator.userLanguage?n=navigator.userLanguage:navigator.language&&(n=navigator.language);var i=b.user(),r="missing";$.ua.os&&(r=$.ua.os.name+" "+$.ua.os.version);var a="";$.ua.device&&$.ua.device.type&&(a=$.ua.device.type);var s="missing",l="missing";$.ua.browser&&($.ua.browser.name&&(s=$.ua.browser.name),$.ua.browser.version&&(l=$.ua.browser.version)),e.UserAgent=navigator.userAgent,e.BrowserName=s,e.BrowserVersion=l,e.OperatingSystem=r,e.CpuClass=t,e.BrowserLanguage=n,e.OSLanguage=o,e.ApplicationLanguage=b.value(i.Language),e.Locale=b.value(i.Locale),e.Density=b.value(i.Density).toString(),e.Theme=b.value(i.Theme).toString(),e.ClientVersion=b.version.fullVerString,e.Device=a,e.TouchEnabled=b.util.isTouchEnabled(),e.ScreenResolution=screen.availWidth+"x"+screen.availHeight,e.ViewPortSize=window.innerWidth+"x"+window.innerHeight,b.telemetry.addEvent(e)}return e},a.addPingEvent=function(e){var t=null;return b.telemetry.enabled&&(t=b.telemetry.createPingEvent(),b.telemetry._shouldLogEvent(t)&&(t.RoundTripTime=e,b.telemetry.addEvent(t))),t},a.addErrorEvent=function(e){if(!e)return null;var t=null;if(b.telemetry.enabled)if(Array.isArray(e))for(var o=void 0,n=0;n<e.length;n++)o&&!e[n].formUniqueId&&(e[n].formUniqueId=o.FormUniqueId,e[n].formName=o.FormName),o=b.telemetry.addErrorEvent(e[n]);else(t=b.telemetry.createErrorEvent()).FormName=e.formName,t.FormUniqueId=e.formUniqueId,t.TargetName=e.targetName,b.telemetry._shouldLogEvent(t)&&(t.ErrorId=0,t.ErrorType=e.type,t.ErrorLocation=b.telemetry.ErrorLocation.client,t.ErrorLabel=e.errorLabel,t.CallStack=e.callStack,t.StatusCode=e.statusCode,b.telemetry.addEvent(t));return t},a.flushEventsAfterClientError=!0,a.addClientErrorEvent=function(e,t,o){if(b.telemetry.enabled){var n=b.context(b.shell.getCurrentRootForm()),i=new b.messaging.Message;if(i.errorLabel=e,i.callStack=t&&t.callStack?t.callStack:"",i.statusCode=t&&t.statusCode?t.statusCode:0,i.formName=n?n.FormName:"",i.formUniqueId=n?n.Id:"",i.type=b.messaging.MessageType.error,i.targetName="",i.callStack){var r=new RegExp(window.location.origin,"gi");i.callStack=i.callStack.replace(r,"")}b.telemetry.addErrorEvent(i),b.telemetry.flushEventsAfterClientError&&(o?b.logError(b.label(e)):b.telemetry.flushTelemetryEvents&&b.telemetry.flushTelemetryEvents())}},a.handleClientError=function(e,t,o){e.Label&&0!=e.Label.length||(e.Label=t),e.Text&&0!=e.Text.length||(e.Text=b.label(t));var n=b.value(b.clientInError);b.errorMessageBox(e,!0),b.telemetry.addClientErrorEvent(t,o,n)},a.addControlErrorEvent=function(e,t,o){if(!e)return null;var n={};if(n.errorLabel=t,n.callStack=o,n.targetName=e.Name,e.Root&&(n.formName=b.value(e.Root.FormName),e.Root.Id&&(n.formUniqueId=e.Root.Id)),!n.formName){var i=b.context(b.shell.getActiveForm());i&&(n.formName=b.value(i.FormName),n.formUniqueId=i.Id)}return b.telemetry.addErrorEvent(n)},a.addControlActionEvent=function(e,t,o,n,i){return e&&null!=o?(e.TelemetryOptions&&(e.TelemetryOptions=void 0,delete e.TelemetryOptions),n=n||{},t||((t=b.telemetry.createControlEvent(e,b.telemetry.createActionEvent())).ActionEvent=o),(i||b.telemetry._shouldLogEvent(t))&&(t.InputType=n.inputType?n.inputType:b.telemetry.InputType.notSpecified,t.UserDefined1=n.userDefined1?n.userDefined1:0,t.UserDefined2=n.userDefined2?n.userDefined2:0,t.ExtendedData=n.extendedData?n.extendedData:"",b.telemetry.addEvent(t)),t):null},a.addFormActionEvent=function(e,t,o){if(!e||null==t)return null;var n=null;return b.telemetry.enabled&&((n=b.telemetry.createActionEvent()).ActionEvent=t,n.FormName=e.FormName?e.FormName:"",n.FormUniqueId=e.Id?e.Id:"",b.telemetry._shouldLogEvent(n)&&(o=o||{},n.TargetName="",n.TargetType="Form",n.InputType=o.inputType?o.inputType:b.telemetry.InputType.notSpecified,n.UserDefined1=o.userDefined1?o.userDefined1:0,n.UserDefined2=o.userDefined2?o.userDefined2:0,n.ExtendedData=o.extendedData?o.extendedData:"",b.telemetry.addEvent(n))),n},a.addActionEvent=function(e,t,o,n){var i=null;return b.telemetry.enabled&&((i=b.telemetry.createActionEvent()).ActionEvent=e,i.TargetName=t,i.TargetType="",i.InputType=b.telemetry.InputType.notSpecified,i.FormName=n&&n.FormName?n.FormName:"",i.FormUniqueId=n&&n.Id?n.Id:"",o=o||{},i.UserDefined1=o.userDefined1?o.userDefined1:0,i.UserDefined2=o.userDefined2?o.userDefined2:0,i.ExtendedData=o.extendedData?o.extendedData:"",b.telemetry.addEvent(i)),i},a.addUserFeedbackEvent=function(e,t,o,n){var i=null;return b.telemetry.enabled&&((i=b.telemetry.createFeedbackEvent()).FormName=e,b.telemetry._shouldLogEvent(i)&&(i.FormUniqueId=t,i.FeedbackType=o||b.telemetry.FeedbackType.notSpecified,i.FeedbackText=n||"",i.FeedbackText+=b.browserActivity.FeedbackText,b.telemetry.addEvent(i))),i},a.addNavigationSearchEvent=function(e,t,o,n){var i=null;return b.telemetry.enabled&&(i=b.telemetry.createNavigationSearchEvent(),b.telemetry._shouldLogEvent(i)&&(i.RoundTripTime=e,i.Query=t,i.TargetIndex=o,i.TargetMenuItemDescription=n,b.telemetry.addEvent(i))),i},a.addNavigationEvent=function(e,t,o){var n=null;if(b.telemetry.enabled&&(n=b.telemetry.createNavigationEvent(),b.telemetry._shouldLogEvent(n))){var i="";if(o&&Array.isArray(o))for(var r=0;r<o.length;r++)0<i.length&&(i+="\\"),i+=o[r].toString();n.Feature=e,n.Path=i,n.NavigationItem=t,b.telemetry.addEvent(n)}return n},a.addCommunicationEvent=function(e,t,o,n,i,r){var a=null;return b.telemetry.enabled&&(a=b.telemetry.createCommunicationEvent(),b.telemetry._shouldLogEvent(a)&&(a.ResponseTextStatus=e,a.ResponseHTTPStatus=t,a.RequestTimeoutMilliseconds=o,a.RequestRetryCount=n,a.BrowserSessionActivityId=i,a.ReadyState=r,a.OriginalEventTimestamp=Date.now(),b.telemetry.addPersistentEvent(a))),a},a.addActionSearchEvent=function(e,t,o,n,i){if(!e||!t)return null;var r=null;return b.telemetry.enabled&&((r=b.telemetry.createActionSearchEvent()).FormName=e.FormName?e.FormName:"",r.FormUniqueId=e.Id?e.Id:"",b.telemetry._shouldLogEvent(r)&&(r.Query=t,r.TargetName=n||"",r.TargetPath=i||"",r.TargetIndex=o,b.telemetry.addEvent(r))),r},a.defaultConfiguration={excludedEvents:{action:!0,performance:!0,navigation:!0}},a.verboseConfiguration={},a.configuration||(a.configuration=a.defaultConfiguration),a.isEventExcluded=function(e,t,o){if(a.configuration&&a.configuration.excludedEvents){var n=a.configuration.excludedEvents.global;if("boolean"==typeof n)return n;n=n&&n[t];var i=a.configuration.excludedEvents[o];if("boolean"==typeof i)return i;i=i&&i[t];var r=a.configuration.excludedEvents[e];return"boolean"==typeof r?r:(r=r&&r[t],n||i||r||!1)}return!1},a._shouldLogEvent=function(e){var t=!0;if(a.configuration&&e){if(e.FormName&&a.configuration.excludedForms&&a.configuration.excludedForms[e.FormName])t=!1;else{var o=b.util.enumName(e.$type,b.telemetry.TelemetryEventDataType),n=void 0;switch(o){case"performance":n=b.util.enumName(e.PerformanceEvent,b.telemetry.PerformanceEvents);break;case"action":n=b.util.enumName(e.ActionEvent,b.telemetry.ActionEvents);break;case"sessionAction":n=b.util.enumName(e.SessionAction,b.telemetry.SessionEvents)}t=!b.telemetry.isEventExcluded(e.TargetType,n,o)}if(t&&a.configuration.includedForms){t=!1;var i=a.configuration.includedForms[e.FormName];if(i)if("boolean"==typeof i)t=i;else if(i.includedControls&&e.TargetName){var r=i.includedControls[e.TargetName];r&&("boolean"==typeof r?t=r:e.ActionEvent?t=r.includedEvents[b.util.enumName(e.ActionEvent,b.telemetry.ActionEvents)]:e.PerformanceEvent&&(t=r.includedEvents[b.util.enumName(e.PerformanceEvent,b.telemetry.PerformanceEvents)]))}}}return t},a.hasExcludedEvent=function(e){return a.configuration&&a.configuration.excludedEvents&&a.configuration.excludedEvents[e]},a.typeHandlers={},b.telemetry.typeHandlers.Button={instrument:function(t){if(t){var o,e=b.telemetry.hasExcludedEvent(t.TypeName),n=t.Clicked,i=t.keyDown,r=b.telemetry.ActionEvents.buttonClicked,a={inputType:b.telemetry.InputType.mouse};e&&b.telemetry.isEventExcluded(t.TypeName,b.util.enumName(r,b.telemetry.ActionEvents))||(t.keyDown=function(e){e.which==b.ui.KeyCodes.enter&&(t.TelemetryOptions={inputType:b.telemetry.InputType.keyboard}),b.applyFunction(i,t,arguments)},t.Clicked=function(e){t.TelemetryOptions?a.inputType=t.TelemetryOptions.inputType:e&&"click"==e.type?a.inputType=b.telemetry.InputType.mouse:a.inputType=b.telemetry.InputType.notSpecified,o=b.telemetry.addControlActionEvent(t,o,r,a),n.apply(this,arguments)})}}},b.telemetry.typeHandlers.CommandButton=b.telemetry.typeHandlers.Button,b.telemetry.typeHandlers.AnchorButton=b.telemetry.typeHandlers.Button,b.telemetry.typeHandlers.Tile=b.telemetry.typeHandlers.Button,b.telemetry.typeHandlers.ToggleButton=b.telemetry.typeHandlers.Button,b.telemetry.typeHandlers.MenuItemButton=b.telemetry.typeHandlers.Button,b.telemetry.typeHandlers.SymbolButton=b.telemetry.typeHandlers.Button,b.telemetry.typeHandlers.MenuButton={instrument:function(t){if(t){var o,e=b.telemetry.hasExcludedEvent(t.TypeName),n=b.telemetry.ActionEvents.buttonClicked;e&&b.telemetry.isEventExcluded(t.TypeName,b.util.enumName(n,b.telemetry.ActionEvents))||t.usingDisposable(b.observe(t.ShowFlyout,function(e){e&&(o=b.telemetry.addControlActionEvent(t,o,n,t.TelemetryOptions))}))}}},b.telemetry.typeHandlers.DropDialogButton=b.telemetry.typeHandlers.MenuButton,b.telemetry.typeHandlers.HyperLink={instrument:function(t){if(t){var o,e=b.telemetry.hasExcludedEvent(t.TypeName),n=t.clicked,i=t.keyDown,r=b.telemetry.ActionEvents.buttonClicked,a={inputType:b.telemetry.InputType.mouse};e&&b.telemetry.isEventExcluded(t.TypeName,b.util.enumName(r,b.telemetry.ActionEvents))||(t.keyDown=function(e){e.which==b.ui.KeyCodes.enter&&(t.TelemetryOptions={inputType:b.telemetry.InputType.keyboard}),b.applyFunction(i,t,arguments)},t.clicked=function(e){t.TelemetryOptions?a.inputType=t.TelemetryOptions.inputType:e&&"click"==e.type?a.inputType=b.telemetry.InputType.mouse:a.inputType=b.telemetry.InputType.notSpecified,o=b.telemetry.addControlActionEvent(t,o,r,a),n.apply(this,arguments)})}}},b.telemetry.typeHandlers.Input={instrument:function(o){if(o){var e,t=b.telemetry.hasExcludedEvent(o.TypeName);if(o.valueBinder){var n=o.valueBinder.setValue,i=b.telemetry.ActionEvents.valueChanged;t&&b.telemetry.isEventExcluded(o.TypeName,b.util.enumName(i,b.telemetry.ActionEvents))||(o.valueBinder.setValue=function(){e=b.telemetry.addControlActionEvent(o,e,i),b.applyFunction(n,o.valueBinder,arguments)})}var r,a,s=o.ExecuteHyperlink,l=b.telemetry.ActionEvents.jumpRefExecuted;t&&b.telemetry.isEventExcluded(o.TypeName,b.util.enumName(l,b.telemetry.ActionEvents))||(o.ExecuteHyperlink=function(){r=b.telemetry.addControlActionEvent(o,r,l,o.TelemetryOptions),b.applyFunction(s,o,arguments)});var u=b.telemetry.ActionEvents.lookupActivated;t&&b.telemetry.isEventExcluded(o.TypeName,b.util.enumName(u,b.telemetry.ActionEvents))||o.usingDisposable(b.observe(o.ShowFlyout,function(e){if(e){var t=o.TelemetryOptions?o.TelemetryOptions.inputType:void 0;t!==b.telemetry.InputType.keyboard&&t!==b.telemetry.InputType.mouse||(a=b.telemetry.addControlActionEvent(o,a,u,o.TelemetryOptions))}}))}}},b.telemetry.typeHandlers.String=b.telemetry.typeHandlers.Input,b.telemetry.typeHandlers.MultilineInput=b.telemetry.typeHandlers.Input,b.telemetry.typeHandlers.Int64=b.telemetry.typeHandlers.Input,b.telemetry.typeHandlers.Integer=b.telemetry.typeHandlers.Input,b.telemetry.typeHandlers.Real=b.telemetry.typeHandlers.Input,b.telemetry.typeHandlers.Date=b.telemetry.typeHandlers.Input,b.telemetry.typeHandlers.DateTime=b.telemetry.typeHandlers.Input,b.telemetry.typeHandlers.Time=b.telemetry.typeHandlers.Input,b.telemetry.typeHandlers.Image={instrument:function(t){if(t){var o,e=b.telemetry.hasExcludedEvent(t.TypeName),n=t.clicked,i=t.keyDown,r=b.telemetry.ActionEvents.buttonClicked,a={inputType:b.telemetry.InputType.mouse};e&&b.telemetry.isEventExcluded(t.TypeName,b.util.enumName(r,b.telemetry.ActionEvents))||(t.keyDown=function(e){e.which!==b.ui.KeyCodes.enter&&e.which!==b.ui.KeyCodes.spacebar||(t.TelemetryOptions={inputType:b.telemetry.InputType.keyboard}),b.applyFunction(i,t,arguments)},t.clicked=function(e){t.TelemetryOptions?a.inputType=t.TelemetryOptions.inputType:e&&"click"==e.type?a.inputType=b.telemetry.InputType.mouse:a.inputType=b.telemetry.InputType.notSpecified,o=b.telemetry.addControlActionEvent(t,o,r,a),n.apply(this,arguments)})}}},b.telemetry.typeHandlers.EnumControl={instrument:function(t){if(t){var o,n,e=b.telemetry.hasExcludedEvent(t.TypeName),i=b.telemetry.ActionEvents.itemSelected,r=t.setSelectedIndex;if(!e||!b.telemetry.isEventExcluded(t.TypeName,b.util.enumName(i,b.telemetry.ActionEvents))){var a=b.value(t.selectedIndex);t.setSelectedIndex=function(e){return e<b.length(t.Items)&&0<=e&&e!=a&&(n={userDefined1:(a=e)+1,userDefined2:b.length(t.Items)},t.TelemetryOptions&&(n.inputType=t.TelemetryOptions.inputType),o=b.telemetry.addControlActionEvent(t,o,i,n)),b.applyFunction(r,t,arguments)}}}}},b.telemetry.typeHandlers.ComboBox={instrument:function(t){if(t){b.telemetry.typeHandlers.EnumControl.instrument(t);var o,e=b.telemetry.hasExcludedEvent(t.TypeName),n=b.telemetry.ActionEvents.lookupActivated;e&&b.telemetry.isEventExcluded(t.TypeName,b.util.enumName(n,b.telemetry.ActionEvents))||t.usingDisposable(b.observe(t.isExpanded,function(e){e&&(o=b.telemetry.addControlActionEvent(t,o,n,t.TelemetryOptions))}))}}},b.telemetry.typeHandlers.ListBox=b.telemetry.typeHandlers.EnumControl,b.telemetry.typeHandlers.RadioButton=b.telemetry.typeHandlers.EnumControl,b.telemetry.typeHandlers.CheckBox={instrument:function(t){if(t){var o,n,e=b.telemetry.hasExcludedEvent(t.TypeName),i=t.toggleValue,r=b.telemetry.ActionEvents.valueChanged;e&&b.telemetry.isEventExcluded(t.TypeName,b.util.enumName(r,b.telemetry.ActionEvents))||(t.toggleValue=function(e){n=!e||"click"!=e.type&&"mousedown"!=e.type?e&&"keydown"==e.type?{inputType:b.telemetry.InputType.keyboard}:void 0:{inputType:b.telemetry.InputType.mouse},o=b.telemetry.addControlActionEvent(t,o,r,n),b.applyFunction(i,t,arguments)})}}},b.telemetry.typeHandlers.ReferenceGroup={instrument:function(o){if(o){var n,e=b.telemetry.hasExcludedEvent(o.TypeName),i=b.telemetry.ActionEvents.lookupActivated;e&&b.telemetry.isEventExcluded(o.TypeName,b.util.enumName(i,b.telemetry.ActionEvents))||o.usingDisposable(b.observe(o.ShowFlyout,function(e){if(e){var t=o.TelemetryOptions?o.TelemetryOptions.inputType:void 0;t!==b.telemetry.InputType.keyboard&&t!==b.telemetry.InputType.mouse||(n=b.telemetry.addControlActionEvent(o,n,i,o.TelemetryOptions))}}))}}},b.telemetry.typeHandlers.PanoramaItem={instrument:function(t){if(t){var o,e=b.telemetry.hasExcludedEvent(t.TypeName),n=t.HeaderClicked,i=t.keyDown,r={inputType:b.telemetry.InputType.mouse},a=b.telemetry.ActionEvents.buttonClicked;e&&b.telemetry.isEventExcluded(t.TypeName,b.util.enumName(a,b.telemetry.ActionEvents))||(t.keyDown=function(e){e.which==b.ui.KeyCodes.enter&&(t.TelemetryOptions={inputType:b.telemetry.InputType.keyboard}),b.callFunction(i,t,e)},t.HeaderClicked=function(e){t.TelemetryOptions?r.inputType=t.TelemetryOptions.inputType:e&&"click"==e.type?r.inputType=b.telemetry.InputType.mouse:r.inputType=b.telemetry.InputType.notSpecified,o=b.telemetry.addControlActionEvent(t,o,a,r),b.applyFunction(n,t,arguments)})}}},b.telemetry.typeHandlers.PivotItem={instrument:function(t){if(t){var o,e=b.telemetry.hasExcludedEvent(t.TypeName),n=t.Activate,i=t.keyDown,r={inputType:b.telemetry.InputType.mouse},a=b.telemetry.ActionEvents.itemSelected;e&&b.telemetry.isEventExcluded(t.TypeName,b.util.enumName(a,b.telemetry.ActionEvents))||(t.keyDown=function(e){e.which==b.ui.KeyCodes.enter&&(t.TelemetryOptions={inputType:b.telemetry.InputType.keyboard}),b.callFunction(i,t,e)},t.Activate=function(e){t.TelemetryOptions?r.inputType=t.TelemetryOptions.inputType:e&&"click"==e.type?r.inputType=b.telemetry.InputType.mouse:r.inputType=b.telemetry.InputType.notSpecified,o=b.telemetry.addControlActionEvent(t,o,a,r),b.applyFunction(n,t,arguments)})}}},b.telemetry.typeHandlers.SectionPage={instrument:function(t){if(t){var o,n,e=b.telemetry.hasExcludedEvent(t.TypeName),i=t.keyDown,r={inputType:b.telemetry.InputType.mouse};e&&b.telemetry.isEventExcluded(t.TypeName,b.util.enumName(b.telemetry.ActionEvents.containerExpand,b.telemetry.ActionEvents))&&b.telemetry.isEventExcluded(t.TypeName,b.util.enumName(b.telemetry.ActionEvents.containerCollapse,b.telemetry.ActionEvents))||(t.keyDown=function(e){e.which!=b.ui.KeyCodes.enter&&e.which!=b.ui.KeyCodes.spacebar||(t.TelemetryOptions={inputType:b.telemetry.InputType.keyboard}),b.callFunction(i,t,e)},t.recordTelemetry=function(e){t.TelemetryOptions?r.inputType=t.TelemetryOptions.inputType:e&&"click"==e.type?r.inputType=b.telemetry.InputType.mouse:r.inputType=b.telemetry.InputType.notSpecified,b.value(t.Expanded)?o=b.telemetry.addControlActionEvent(t,o,b.telemetry.ActionEvents.containerExpand,r):n=b.telemetry.addControlActionEvent(t,n,b.telemetry.ActionEvents.containerCollapse,r)})}}},b.telemetry.typeHandlers.AppBarTab={instrument:function(e){if(e){var t,o=b.telemetry.hasExcludedEvent(e.TypeName),n=e.TabShown,i=b.telemetry.ActionEvents.containerExpand;o&&b.telemetry.isEventExcluded(e.TypeName,b.util.enumName(i,b.telemetry.ActionEvents))||(e.TabShown=function(){t=b.telemetry.addControlActionEvent(e,t,i,e.TelemetryOptions),b.applyFunction(n,e,arguments)})}}},b.telemetry.typeHandlers.NavigationBar={instrument:function(e){if(e){var t,o,n=b.telemetry.hasExcludedEvent(e.TypeName),i={extendedData:"MessageCenter"},r={extendedData:"UserSettings"};n&&b.telemetry.isEventExcluded(e.TypeName,b.util.enumName(b.telemetry.ActionEvents.containerExpand,b.telemetry.ActionEvents))||(e.recordMessageCenterTelemetry=function(){e.TelemetryOptions&&(i.inputType=e.TelemetryOptions.inputType),t=b.telemetry.addControlActionEvent(e,t,b.telemetry.ActionEvents.containerExpand,i)},e.recordUserSettingsTelemetry=function(){e.TelemetryOptions&&(r.inputType=e.TelemetryOptions.inputType),o=b.telemetry.addControlActionEvent(e,o,b.telemetry.ActionEvents.containerExpand,r)})}}},b.telemetry.typeHandlers.User={instrument:function(e){if(e){var t,o=b.telemetry.hasExcludedEvent(e.TypeName),n=b.telemetry.ActionEvents.containerExpand;o&&b.telemetry.isEventExcluded(e.TypeName,b.util.enumName(n,b.telemetry.ActionEvents))||(e.recordTelemetry=function(){t=b.telemetry.addControlActionEvent(e,t,n,e.TelemetryOptions)})}}},b.telemetry.typeHandlers.Tree={instrument:function(o){if(o){var t,n,e=b.telemetry.hasExcludedEvent(o.TypeName),i=b.telemetry.ActionEvents.addItem;e&&b.telemetry.isEventExcluded(o.TypeName,b.util.enumName(i,b.telemetry.ActionEvents))||(o.RecordAddTelemetry=function(e){n={userDefined1:e},t=b.telemetry.addControlActionEvent(o,t,i,n)});var r,a,s=b.telemetry.ActionEvents.removeItem;e&&b.telemetry.isEventExcluded(o.TypeName,b.util.enumName(s,b.telemetry.ActionEvents))||(o.RecordRemoveTelemetry=function(e){a={userDefined1:e},r=b.telemetry.addControlActionEvent(o,r,s,a)});var l,u,d=b.telemetry.ActionEvents.valueChanged;e&&b.telemetry.isEventExcluded(o.TypeName,b.util.enumName(d,b.telemetry.ActionEvents))||(o.RecordEditTelemetry=function(e){u={userDefined1:e},l=b.telemetry.addControlActionEvent(o,l,d,u)});var c,p,h,m=o.CheckBoxClick;e&&b.telemetry.isEventExcluded(o.TypeName,b.util.enumName(b.telemetry.ActionEvents.itemSelected,b.telemetry.ActionEvents))&&b.telemetry.isEventExcluded(o.TypeName,b.util.enumName(b.telemetry.ActionEvents.itemUnselected,b.telemetry.ActionEvents))||(o.CheckBoxClick=function(e,t){h={extendedData:b.value(o.Name),userDefined1:e.NodeId()},o.TelemetryOptions?h.inputType=o.TelemetryOptions.inputType:t&&"click"==t.type?h.inputType=b.telemetry.InputType.mouse:h.inputType=b.telemetry.InputType.notSpecified,e.CheckedState()==b.ui.CheckedState.Checked?p=b.telemetry.addControlActionEvent(o,p,b.telemetry.ActionEvents.itemUnselected,h):c=b.telemetry.addControlActionEvent(o,c,b.telemetry.ActionEvents.itemSelected,h),b.applyFunction(m,o,arguments)});var v,g,y,f=o.ExpandCollapse;e&&b.telemetry.isEventExcluded(o.TypeName,b.util.enumName(b.telemetry.ActionEvents.containerCollapse,b.telemetry.ActionEvents))&&b.telemetry.isEventExcluded(o.TypeName,b.util.enumName(b.telemetry.ActionEvents.containerExpand,b.telemetry.ActionEvents))||(o.ExpandCollapse=function(e,t){o.Root&&!b.value(o.Root.Updating)&&(y={extendedData:b.value(o.Name),userDefined1:e.NodeId()},o.TelemetryOptions&&(y.inputType=o.TelemetryOptions.inputType),t?g=b.telemetry.addControlActionEvent(o,g,b.telemetry.ActionEvents.containerExpand,y):v=b.telemetry.addControlActionEvent(o,v,b.telemetry.ActionEvents.containerCollapse,y)),b.applyFunction(f,o,arguments)})}}},a.configuration&&a.configuration.excludedEvents)for(var d in a.configuration.excludedEvents){!0===a.configuration.excludedEvents[d]&&delete b.telemetry.typeHandlers[d]}if(a._lastFocused="",a._shouldLogFocusEvent=function(e){return!(!e||e.toLowerCase()===b.telemetry._lastFocused)&&(b.telemetry._lastFocused=e.toLowerCase(),!0)},a.initializeFocusTelemetry=function(){b.telemetry.keydownFocus=function(e){e&&e.which===b.ui.KeyCodes.tab&&(b.telemetry.keyboardFocus=!0)},b.telemetry.keyupFocus=function(){b.telemetry.keyboardFocus=!1},document.addEventListener("keydown",b.telemetry.keydownFocus,!0),document.addEventListener("keyup",b.telemetry.keyupFocus,!0),b.telemetry.mousedownFocus=function(e){b.telemetry.mouseFocus=!0},b.telemetry.mosueupFocus=function(){b.telemetry.mouseFocus=!1},document.addEventListener("mousedown",b.telemetry.mousedownFocus,!0),document.addEventListener("mouseup",b.telemetry.mosueupFocus,!0),b.telemetry.focusInHandler=function(e){var t=b.context(e.target);if(t&&b.telemetry._shouldLogFocusEvent(t.Name)){var o={};b.telemetry.keyboardFocus?o.inputType=b.telemetry.InputType.keyboard:b.telemetry.mouseFocus&&(o.inputType=b.telemetry.InputType.mouse),b.telemetry.addControlActionEvent(t,void 0,b.telemetry.ActionEvents.receivedFocus,o)}},document.addEventListener("focusin",b.telemetry.focusInHandler)},b.telemetry.enabled&&!b.telemetry.isEventExcluded("","receivedFocus","action")&&b.telemetry.initializeFocusTelemetry(),b.util.localStorageSupported()){var c=window.localStorage.getItem(b.telemetry._storageKey);if(c){var p=JSON.parse(c);p&&0<p.length&&(b.telemetry._areEventsStored=!0,p.forEach(function(e){b.telemetry.addEvent(e)}))}}}(b.telemetry||(b.telemetry={}))}($dyn=$dyn||{}),$dyn.survey={surveyElemId:"fno-survey",addSurvey:function(){document.getElementById(this.surveyElemId)||this._loadSurvey()},showSurvey:function(e){var t=document.getElementById(this.surveyElemId);if(!t)throw new Error("Survey is not in the page. Call $dyn.survey.addSurvey first.");t.config=e},_loadSurvey:function(){var e=document.createElement("script");e.src="Scripts/ext/survey.lib.umd.v1.0.10.min.js",e.onload=this._createSurvey,document.head.appendChild(e)},_createSurvey:function(){var e=document.createElement("survey-sdk");e.id=$dyn.survey.surveyElemId,document.body.appendChild(e)}};
//# sourceMappingURL=dyn-core.min-7.0.25142.1.js.map

// SIG // Begin signature block
// SIG // MIIoKAYJKoZIhvcNAQcCoIIoGTCCKBUCAQExDzANBglg
// SIG // hkgBZQMEAgEFADB3BgorBgEEAYI3AgEEoGkwZzAyBgor
// SIG // BgEEAYI3AgEeMCQCAQEEEBDgyQbOONQRoqMAEEvTUJAC
// SIG // AQACAQACAQACAQACAQAwMTANBglghkgBZQMEAgEFAAQg
// SIG // iKZ988D/dZ2OjJO7Efh2Nn8f5kORIiLPgQa6Bsd9SqOg
// SIG // gg12MIIF9DCCA9ygAwIBAgITMwAABIVemewOWS/N1wAA
// SIG // AAAEhTANBgkqhkiG9w0BAQsFADB+MQswCQYDVQQGEwJV
// SIG // UzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMH
// SIG // UmVkbW9uZDEeMBwGA1UEChMVTWljcm9zb2Z0IENvcnBv
// SIG // cmF0aW9uMSgwJgYDVQQDEx9NaWNyb3NvZnQgQ29kZSBT
// SIG // aWduaW5nIFBDQSAyMDExMB4XDTI1MDYxOTE4MjEzN1oX
// SIG // DTI2MDYxNzE4MjEzN1owdDELMAkGA1UEBhMCVVMxEzAR
// SIG // BgNVBAgTCldhc2hpbmd0b24xEDAOBgNVBAcTB1JlZG1v
// SIG // bmQxHjAcBgNVBAoTFU1pY3Jvc29mdCBDb3Jwb3JhdGlv
// SIG // bjEeMBwGA1UEAxMVTWljcm9zb2Z0IENvcnBvcmF0aW9u
// SIG // MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA
// SIG // wEpIdXKb7lKn26sXpXuywkhxGplTQXxROLmNRZBrAHVB
// SIG // f7546RNXZwA/bzDqsuWTuPSC4T+I4j/z9j5/WqPuUw7S
// SIG // pnEPqWXc2xu7eN8kVyQt5170xkK6KHT4vVEkIvayPtIM
// SIG // Ll0SgSCOy/pN5DJCi5ha7FlI84F1Qi2GumR+wQgCwHCV
// SIG // mU8Fj6Ik+B6akISXGCwe6X3rQFQngRFWQ/IrSkOkAOfy
// SIG // 0EfvV+nZUo+FcbWuCZ6cb4Eq5I1ws/rZSeuwAWeedZcN
// SIG // t0VlNbsn4AnxBYQX4sj0dlko7JD5fWqeqq3/HzUNbBmL
// SIG // p9qeCXV8XlACn9YVWv900F47z04kVwpyTwIDAQABo4IB
// SIG // czCCAW8wHwYDVR0lBBgwFgYKKwYBBAGCN0wIAQYIKwYB
// SIG // BQUHAwMwHQYDVR0OBBYEFLgmchogri2BNGlO4+UxamNO
// SIG // ZJKNMEUGA1UdEQQ+MDykOjA4MR4wHAYDVQQLExVNaWNy
// SIG // b3NvZnQgQ29ycG9yYXRpb24xFjAUBgNVBAUTDTIzMDAx
// SIG // Mis1MDUzNTkwHwYDVR0jBBgwFoAUSG5k5VAF04KqFzc3
// SIG // IrVtqMp1ApUwVAYDVR0fBE0wSzBJoEegRYZDaHR0cDov
// SIG // L3d3dy5taWNyb3NvZnQuY29tL3BraW9wcy9jcmwvTWlj
// SIG // Q29kU2lnUENBMjAxMV8yMDExLTA3LTA4LmNybDBhBggr
// SIG // BgEFBQcBAQRVMFMwUQYIKwYBBQUHMAKGRWh0dHA6Ly93
// SIG // d3cubWljcm9zb2Z0LmNvbS9wa2lvcHMvY2VydHMvTWlj
// SIG // Q29kU2lnUENBMjAxMV8yMDExLTA3LTA4LmNydDAMBgNV
// SIG // HRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4ICAQAo5qgK
// SIG // dgouLEx2XIvqpLRACrBZORzVRislkdqxRl7He3IIGdOB
// SIG // +VOEldHwC+nzhPXS77eCOxwRy4aRnROVIy8uDcS0xtmw
// SIG // wJHgFZsZndrillRisptWmqw8V379xgjeJkV/j5+HPqct
// SIG // 0v+ipLeXkgwCCLK8ysNyodkltYQsF1/5Nb+G/jR9RY5f
// SIG // ov8TybKVwhbmQeGguRS0+X4G0Sqp7FngHZ/A7K2EIU90
// SIG // Fy7ejb9/3TM7+xvwnaW3XKLpfBWJfrd3ZlzPkiApQt5d
// SIG // mntMDpTa0ONskBMnLj1OTqKi0/OY7Ge/uAmknHxSDZTu
// SIG // 5e2O6/8Wrqh20j0Na96CAvnu9ebNhtwpWWt8vfWmMdpZ
// SIG // 12HtbK3KyMfDQF01YosqV1Z/WRphJHzXHw4qhkMJJpec
// SIG // /Z5t6VogWevWnWgQWwBRI8iRuMtGu+m3pf+LAwlb2mcy
// SIG // zN0xW8VTvQUK42UbWyWW5At1wK6S6mUn8ed0rmHXXcT1
// SIG // /Kb3KhbhLvMHFHg9ObfcTWyeE7XQBAiZRItL7wcZZjOb
// SIG // cxV8tqmXqjzFx0kGKj4GfY70nGejcM5xQ9Pt95G88oTk
// SIG // s/1rhmwLuHB2RvICp5UFU+LgNg4nsfQzLNlh4qJDZJ2J
// SIG // S6FHll1tUKyS6ajvNky8ik2wTP6GRwHSHNJM6Ek66PW9
// SIG // /r459vNPQ9PkjjglWTCCB3owggVioAMCAQICCmEOkNIA
// SIG // AAAAAAMwDQYJKoZIhvcNAQELBQAwgYgxCzAJBgNVBAYT
// SIG // AlVTMRMwEQYDVQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQH
// SIG // EwdSZWRtb25kMR4wHAYDVQQKExVNaWNyb3NvZnQgQ29y
// SIG // cG9yYXRpb24xMjAwBgNVBAMTKU1pY3Jvc29mdCBSb290
// SIG // IENlcnRpZmljYXRlIEF1dGhvcml0eSAyMDExMB4XDTEx
// SIG // MDcwODIwNTkwOVoXDTI2MDcwODIxMDkwOVowfjELMAkG
// SIG // A1UEBhMCVVMxEzARBgNVBAgTCldhc2hpbmd0b24xEDAO
// SIG // BgNVBAcTB1JlZG1vbmQxHjAcBgNVBAoTFU1pY3Jvc29m
// SIG // dCBDb3Jwb3JhdGlvbjEoMCYGA1UEAxMfTWljcm9zb2Z0
// SIG // IENvZGUgU2lnbmluZyBQQ0EgMjAxMTCCAiIwDQYJKoZI
// SIG // hvcNAQEBBQADggIPADCCAgoCggIBAKvw+nIQHC6t2G6q
// SIG // ghBNNLrytlghn0IbKmvpWlCquAY4GgRJun/DDB7dN2vG
// SIG // EtgL8DjCmQawyDnVARQxQtOJDXlkh36UYCRsr55JnOlo
// SIG // XtLfm1OyCizDr9mpK656Ca/XllnKYBoF6WZ26DJSJhIv
// SIG // 56sIUM+zRLdd2MQuA3WraPPLbfM6XKEW9Ea64DhkrG5k
// SIG // NXimoGMPLdNAk/jj3gcN1Vx5pUkp5w2+oBN3vpQ97/vj
// SIG // K1oQH01WKKJ6cuASOrdJXtjt7UORg9l7snuGG9k+sYxd
// SIG // 6IlPhBryoS9Z5JA7La4zWMW3Pv4y07MDPbGyr5I4ftKd
// SIG // gCz1TlaRITUlwzluZH9TupwPrRkjhMv0ugOGjfdf8NBS
// SIG // v4yUh7zAIXQlXxgotswnKDglmDlKNs98sZKuHCOnqWbs
// SIG // YR9q4ShJnV+I4iVd0yFLPlLEtVc/JAPw0XpbL9Uj43Bd
// SIG // D1FGd7P4AOG8rAKCX9vAFbO9G9RVS+c5oQ/pI0m8GLhE
// SIG // fEXkwcNyeuBy5yTfv0aZxe/CHFfbg43sTUkwp6uO3+xb
// SIG // n6/83bBm4sGXgXvt1u1L50kppxMopqd9Z4DmimJ4X7Iv
// SIG // hNdXnFy/dygo8e1twyiPLI9AN0/B4YVEicQJTMXUpUMv
// SIG // dJX3bvh4IFgsE11glZo+TzOE2rCIF96eTvSWsLxGoGyY
// SIG // 0uDWiIwLAgMBAAGjggHtMIIB6TAQBgkrBgEEAYI3FQEE
// SIG // AwIBADAdBgNVHQ4EFgQUSG5k5VAF04KqFzc3IrVtqMp1
// SIG // ApUwGQYJKwYBBAGCNxQCBAweCgBTAHUAYgBDAEEwCwYD
// SIG // VR0PBAQDAgGGMA8GA1UdEwEB/wQFMAMBAf8wHwYDVR0j
// SIG // BBgwFoAUci06AjGQQ7kUBU7h6qfHMdEjiTQwWgYDVR0f
// SIG // BFMwUTBPoE2gS4ZJaHR0cDovL2NybC5taWNyb3NvZnQu
// SIG // Y29tL3BraS9jcmwvcHJvZHVjdHMvTWljUm9vQ2VyQXV0
// SIG // MjAxMV8yMDExXzAzXzIyLmNybDBeBggrBgEFBQcBAQRS
// SIG // MFAwTgYIKwYBBQUHMAKGQmh0dHA6Ly93d3cubWljcm9z
// SIG // b2Z0LmNvbS9wa2kvY2VydHMvTWljUm9vQ2VyQXV0MjAx
// SIG // MV8yMDExXzAzXzIyLmNydDCBnwYDVR0gBIGXMIGUMIGR
// SIG // BgkrBgEEAYI3LgMwgYMwPwYIKwYBBQUHAgEWM2h0dHA6
// SIG // Ly93d3cubWljcm9zb2Z0LmNvbS9wa2lvcHMvZG9jcy9w
// SIG // cmltYXJ5Y3BzLmh0bTBABggrBgEFBQcCAjA0HjIgHQBM
// SIG // AGUAZwBhAGwAXwBwAG8AbABpAGMAeQBfAHMAdABhAHQA
// SIG // ZQBtAGUAbgB0AC4gHTANBgkqhkiG9w0BAQsFAAOCAgEA
// SIG // Z/KGpZjgVHkaLtPYdGcimwuWEeFjkplCln3SeQyQwWVf
// SIG // Liw++MNy0W2D/r4/6ArKO79HqaPzadtjvyI1pZddZYSQ
// SIG // fYtGUFXYDJJ80hpLHPM8QotS0LD9a+M+By4pm+Y9G6XU
// SIG // tR13lDni6WTJRD14eiPzE32mkHSDjfTLJgJGKsKKELuk
// SIG // qQUMm+1o+mgulaAqPyprWEljHwlpblqYluSD9MCP80Yr
// SIG // 3vw70L01724lruWvJ+3Q3fMOr5kol5hNDj0L8giJ1h/D
// SIG // Mhji8MUtzluetEk5CsYKwsatruWy2dsViFFFWDgycSca
// SIG // f7H0J/jeLDogaZiyWYlobm+nt3TDQAUGpgEqKD6CPxNN
// SIG // ZgvAs0314Y9/HG8VfUWnduVAKmWjw11SYobDHWM2l4bf
// SIG // 2vP48hahmifhzaWX0O5dY0HjWwechz4GdwbRBrF1HxS+
// SIG // YWG18NzGGwS+30HHDiju3mUv7Jf2oVyW2ADWoUa9WfOX
// SIG // pQlLSBCZgB/QACnFsZulP0V3HjXG0qKin3p6IvpIlR+r
// SIG // +0cjgPWe+L9rt0uX4ut1eBrs6jeZeRhL/9azI2h15q/6
// SIG // /IvrC4DqaTuv/DDtBEyO3991bWORPdGdVk5Pv4BXIqF4
// SIG // ETIheu9BCrE/+6jMpF3BoYibV3FWTkhFwELJm3ZbCoBI
// SIG // a/15n8G9bW1qyVJzEw16UM0xghoKMIIaBgIBATCBlTB+
// SIG // MQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3Rv
// SIG // bjEQMA4GA1UEBxMHUmVkbW9uZDEeMBwGA1UEChMVTWlj
// SIG // cm9zb2Z0IENvcnBvcmF0aW9uMSgwJgYDVQQDEx9NaWNy
// SIG // b3NvZnQgQ29kZSBTaWduaW5nIFBDQSAyMDExAhMzAAAE
// SIG // hV6Z7A5ZL83XAAAAAASFMA0GCWCGSAFlAwQCAQUAoIGu
// SIG // MBkGCSqGSIb3DQEJAzEMBgorBgEEAYI3AgEEMBwGCisG
// SIG // AQQBgjcCAQsxDjAMBgorBgEEAYI3AgEVMC8GCSqGSIb3
// SIG // DQEJBDEiBCBo1oPzN2dMd1Ny9TMu97KGk4IWXVfbWTBH
// SIG // lMB6TWj7NDBCBgorBgEEAYI3AgEMMTQwMqAUgBIATQBp
// SIG // AGMAcgBvAHMAbwBmAHShGoAYaHR0cDovL3d3dy5taWNy
// SIG // b3NvZnQuY29tMA0GCSqGSIb3DQEBAQUABIIBAE0RlOnF
// SIG // jbpntmCNaLvZY1qTSFJ13vWLBDg/6x6Tdwn4T6a8YZa+
// SIG // DUDRzj6ordcYCxf+DyqgG6M73hIx/klF66SbTG9W8GqC
// SIG // NV7u1H1i7wN+jP51mkpJuG7uZqluGAwJ7L3ovS8qgMW1
// SIG // zFPoUbzNicrHlEsohKI8pTowHwi3d1UhfJPDan/aJHdU
// SIG // HU9rNjVRItgdN3ISPuLHKkHh65YPwkJh1I0eBUrL/nr0
// SIG // uXJtV+6qk3JEXb490ZLzXSba9b/o+Ef2kbU/Mxar3o0+
// SIG // uCkSOx3A1IsRDbsvBpXPBFWHsIW2pn4WelgzJbUbu+tG
// SIG // c/XLclcCci67WugGDkE4Lleh5t6hgheUMIIXkAYKKwYB
// SIG // BAGCNwMDATGCF4Awghd8BgkqhkiG9w0BBwKgghdtMIIX
// SIG // aQIBAzEPMA0GCWCGSAFlAwQCAQUAMIIBUgYLKoZIhvcN
// SIG // AQkQAQSgggFBBIIBPTCCATkCAQEGCisGAQQBhFkKAwEw
// SIG // MTANBglghkgBZQMEAgEFAAQgmaEUCm6HXrU4QDgVLZFd
// SIG // VePoSCvvWDOKSb93ozS2DFwCBmjwKTtzzhgTMjAyNTEw
// SIG // MzAwNjU0NTEuNDU4WjAEgAIB9KCB0aSBzjCByzELMAkG
// SIG // A1UEBhMCVVMxEzARBgNVBAgTCldhc2hpbmd0b24xEDAO
// SIG // BgNVBAcTB1JlZG1vbmQxHjAcBgNVBAoTFU1pY3Jvc29m
// SIG // dCBDb3Jwb3JhdGlvbjElMCMGA1UECxMcTWljcm9zb2Z0
// SIG // IEFtZXJpY2EgT3BlcmF0aW9uczEnMCUGA1UECxMeblNo
// SIG // aWVsZCBUU1MgRVNOOkRDMDAtMDVFMC1EOTQ3MSUwIwYD
// SIG // VQQDExxNaWNyb3NvZnQgVGltZS1TdGFtcCBTZXJ2aWNl
// SIG // oIIR6jCCByAwggUIoAMCAQICEzMAAAIDux5cADhsdMoA
// SIG // AQAAAgMwDQYJKoZIhvcNAQELBQAwfDELMAkGA1UEBhMC
// SIG // VVMxEzARBgNVBAgTCldhc2hpbmd0b24xEDAOBgNVBAcT
// SIG // B1JlZG1vbmQxHjAcBgNVBAoTFU1pY3Jvc29mdCBDb3Jw
// SIG // b3JhdGlvbjEmMCQGA1UEAxMdTWljcm9zb2Z0IFRpbWUt
// SIG // U3RhbXAgUENBIDIwMTAwHhcNMjUwMTMwMTk0MjQ2WhcN
// SIG // MjYwNDIyMTk0MjQ2WjCByzELMAkGA1UEBhMCVVMxEzAR
// SIG // BgNVBAgTCldhc2hpbmd0b24xEDAOBgNVBAcTB1JlZG1v
// SIG // bmQxHjAcBgNVBAoTFU1pY3Jvc29mdCBDb3Jwb3JhdGlv
// SIG // bjElMCMGA1UECxMcTWljcm9zb2Z0IEFtZXJpY2EgT3Bl
// SIG // cmF0aW9uczEnMCUGA1UECxMeblNoaWVsZCBUU1MgRVNO
// SIG // OkRDMDAtMDVFMC1EOTQ3MSUwIwYDVQQDExxNaWNyb3Nv
// SIG // ZnQgVGltZS1TdGFtcCBTZXJ2aWNlMIICIjANBgkqhkiG
// SIG // 9w0BAQEFAAOCAg8AMIICCgKCAgEAoZdDB+cAJzsfFIfE
// SIG // bYnRdCdMmhQxyWB06T70Udel9SsRg2H0/D63Bowiwomj
// SIG // rtytQ5lCFOEXOaJZ3Y2qaTbjoM8FKI+N1W2yceTxU2P2
// SIG // tWfNLaalT9DqCiZVJHwz0gSxYF1o+lYGskQiDbS7FGrM
// SIG // tMOYMrA+yCz2bokI2nHuSsQEoyn9jFV9anxM2AW0xjRI
// SIG // o0kAisMMnNHmr6+BaN1//rArrgLZE1orLFOuJPKyutI7
// SIG // BkQKYhEnX7h69MlgJnO40zjzXhgMeigi9pLaZxnoCw3d
// SIG // SJROgbugUsACBR6+8zsCJRaskLgntEkACwmyYbE/cvYs
// SIG // utUSQF7FNLtEwuWGJk0mxCO4NdHWMfFI/r4fSJy6CmAu
// SIG // Q6Sm99dW2FXdG8rW85X00bJUUyYKLZ3wgCBjC6hKpPf9
// SIG // lURrvZJSYtY/Z1X6smB2KzDzgV3K0GFtI5ijYzi+Owmh
// SIG // AKzc4QwYmtcF3SQDSqjLyfKUHtpvP3Im8gzPtQVWarjQ
// SIG // KL/TeLSReAArY19I41zQ1DLUmaFRUB/hZFnXz1sdbgSJ
// SIG // HPe0fsUS7j41MqR2eQNwAC0pHuE2kQb270wWMlth3pzk
// SIG // +52CykzuI8OUKunMN2fc0ykj0Og+ZcomKXrOUUdjHTLy
// SIG // UuHwnDyRXmlTr7lhUkPxBrVQUoYZiwfuXsMxc3aX9VLi
// SIG // ZrjkE08CAwEAAaOCAUkwggFFMB0GA1UdDgQWBBSyKVlA
// SIG // fhHnkNvbFntFXc8VkBiSfTAfBgNVHSMEGDAWgBSfpxVd
// SIG // AF5iXYP05dJlpxtTNRnpcjBfBgNVHR8EWDBWMFSgUqBQ
// SIG // hk5odHRwOi8vd3d3Lm1pY3Jvc29mdC5jb20vcGtpb3Bz
// SIG // L2NybC9NaWNyb3NvZnQlMjBUaW1lLVN0YW1wJTIwUENB
// SIG // JTIwMjAxMCgxKS5jcmwwbAYIKwYBBQUHAQEEYDBeMFwG
// SIG // CCsGAQUFBzAChlBodHRwOi8vd3d3Lm1pY3Jvc29mdC5j
// SIG // b20vcGtpb3BzL2NlcnRzL01pY3Jvc29mdCUyMFRpbWUt
// SIG // U3RhbXAlMjBQQ0ElMjAyMDEwKDEpLmNydDAMBgNVHRMB
// SIG // Af8EAjAAMBYGA1UdJQEB/wQMMAoGCCsGAQUFBwMIMA4G
// SIG // A1UdDwEB/wQEAwIHgDANBgkqhkiG9w0BAQsFAAOCAgEA
// SIG // kBDG3rA+kwtPEdKGAnUguOdgEKxn/zvPRkOeArYBLG8c
// SIG // 8Bg1VHJo1xXJ2iUkzXnQSlV5AYGsEaJz9S4MR+G881Y9
// SIG // nljZsxiMDtRZYZXQDzhwMywRB0aEmeKXXRbWkMaGm1Pz
// SIG // db1siAojetCLfOYJxeSQ+DDF8neqUvHgAyIuk7Y34Cj6
// SIG // LplmtARUP2hM41K3zzda+3KyvqpJi87cPxDUu83pn8se
// SIG // JBkYMGNVgXxapv5xZSQz0AYnKnlN3TqfYY+1qg9EXPv+
// SIG // FWesEI3rCMgpL+boVDcti4TQ4tpXmLQIiBaZo3zZOBp4
// SIG // C7wtk4/SKzjL9tEq8puSfxYe8lgIj3hrN8gN0GqY2U7X
// SIG // 6+zX86QSCUOMU/4nOFhlqoRpUZVQSObujo8N2cUmQi4N
// SIG // 70QuCmMqZIfBXSFqCoq44nRBpV7DTqPlD/2BuSoXm4rn
// SIG // UwcRnnHyQrrlLKSHUYUrRwELI7/3QKlgS5YaK6tjgmj/
// SIG // sBYRN1j4J58eaX5b5bo6HD4LDduPvnXR65dztRRWm1vJ
// SIG // tFJAx0igofEE8E5GDsLvfYhMQVVpW2GUc9qjiAYy/6Mx
// SIG // IbQgdGrioX0yy3rjRgVGgc/qGWfl/VABAqDIZBE42+mH
// SIG // zWiNU+71QGoroQaFfyQjkE/kWGa4MpMj6c6ZsDDRQQ9b
// SIG // 3Vv9vavZ5E1qBIXBDjtC/TcwggdxMIIFWaADAgECAhMz
// SIG // AAAAFcXna54Cm0mZAAAAAAAVMA0GCSqGSIb3DQEBCwUA
// SIG // MIGIMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGlu
// SIG // Z3RvbjEQMA4GA1UEBxMHUmVkbW9uZDEeMBwGA1UEChMV
// SIG // TWljcm9zb2Z0IENvcnBvcmF0aW9uMTIwMAYDVQQDEylN
// SIG // aWNyb3NvZnQgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3Jp
// SIG // dHkgMjAxMDAeFw0yMTA5MzAxODIyMjVaFw0zMDA5MzAx
// SIG // ODMyMjVaMHwxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpX
// SIG // YXNoaW5ndG9uMRAwDgYDVQQHEwdSZWRtb25kMR4wHAYD
// SIG // VQQKExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xJjAkBgNV
// SIG // BAMTHU1pY3Jvc29mdCBUaW1lLVN0YW1wIFBDQSAyMDEw
// SIG // MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA
// SIG // 5OGmTOe0ciELeaLL1yR5vQ7VgtP97pwHB9KpbE51yMo1
// SIG // V/YBf2xK4OK9uT4XYDP/XE/HZveVU3Fa4n5KWv64NmeF
// SIG // RiMMtY0Tz3cywBAY6GB9alKDRLemjkZrBxTzxXb1hlDc
// SIG // wUTIcVxRMTegCjhuje3XD9gmU3w5YQJ6xKr9cmmvHaus
// SIG // 9ja+NSZk2pg7uhp7M62AW36MEBydUv626GIl3GoPz130
// SIG // /o5Tz9bshVZN7928jaTjkY+yOSxRnOlwaQ3KNi1wjjHI
// SIG // NSi947SHJMPgyY9+tVSP3PoFVZhtaDuaRr3tpK56KTes
// SIG // y+uDRedGbsoy1cCGMFxPLOJiss254o2I5JasAUq7vnGp
// SIG // F1tnYN74kpEeHT39IM9zfUGaRnXNxF803RKJ1v2lIH1+
// SIG // /NmeRd+2ci/bfV+AutuqfjbsNkz2K26oElHovwUDo9Fz
// SIG // pk03dJQcNIIP8BDyt0cY7afomXw/TNuvXsLz1dhzPUNO
// SIG // wTM5TI4CvEJoLhDqhFFG4tG9ahhaYQFzymeiXtcodgLi
// SIG // Mxhy16cg8ML6EgrXY28MyTZki1ugpoMhXV8wdJGUlNi5
// SIG // UPkLiWHzNgY1GIRH29wb0f2y1BzFa/ZcUlFdEtsluq9Q
// SIG // BXpsxREdcu+N+VLEhReTwDwV2xo3xwgVGD94q0W29R6H
// SIG // XtqPnhZyacaue7e3PmriLq0CAwEAAaOCAd0wggHZMBIG
// SIG // CSsGAQQBgjcVAQQFAgMBAAEwIwYJKwYBBAGCNxUCBBYE
// SIG // FCqnUv5kxJq+gpE8RjUpzxD/LwTuMB0GA1UdDgQWBBSf
// SIG // pxVdAF5iXYP05dJlpxtTNRnpcjBcBgNVHSAEVTBTMFEG
// SIG // DCsGAQQBgjdMg30BATBBMD8GCCsGAQUFBwIBFjNodHRw
// SIG // Oi8vd3d3Lm1pY3Jvc29mdC5jb20vcGtpb3BzL0RvY3Mv
// SIG // UmVwb3NpdG9yeS5odG0wEwYDVR0lBAwwCgYIKwYBBQUH
// SIG // AwgwGQYJKwYBBAGCNxQCBAweCgBTAHUAYgBDAEEwCwYD
// SIG // VR0PBAQDAgGGMA8GA1UdEwEB/wQFMAMBAf8wHwYDVR0j
// SIG // BBgwFoAU1fZWy4/oolxiaNE9lJBb186aGMQwVgYDVR0f
// SIG // BE8wTTBLoEmgR4ZFaHR0cDovL2NybC5taWNyb3NvZnQu
// SIG // Y29tL3BraS9jcmwvcHJvZHVjdHMvTWljUm9vQ2VyQXV0
// SIG // XzIwMTAtMDYtMjMuY3JsMFoGCCsGAQUFBwEBBE4wTDBK
// SIG // BggrBgEFBQcwAoY+aHR0cDovL3d3dy5taWNyb3NvZnQu
// SIG // Y29tL3BraS9jZXJ0cy9NaWNSb29DZXJBdXRfMjAxMC0w
// SIG // Ni0yMy5jcnQwDQYJKoZIhvcNAQELBQADggIBAJ1Vffwq
// SIG // reEsH2cBMSRb4Z5yS/ypb+pcFLY+TkdkeLEGk5c9MTO1
// SIG // OdfCcTY/2mRsfNB1OW27DzHkwo/7bNGhlBgi7ulmZzpT
// SIG // Td2YurYeeNg2LpypglYAA7AFvonoaeC6Ce5732pvvinL
// SIG // btg/SHUB2RjebYIM9W0jVOR4U3UkV7ndn/OOPcbzaN9l
// SIG // 9qRWqveVtihVJ9AkvUCgvxm2EhIRXT0n4ECWOKz3+SmJ
// SIG // w7wXsFSFQrP8DJ6LGYnn8AtqgcKBGUIZUnWKNsIdw2Fz
// SIG // Lixre24/LAl4FOmRsqlb30mjdAy87JGA0j3mSj5mO0+7
// SIG // hvoyGtmW9I/2kQH2zsZ0/fZMcm8Qq3UwxTSwethQ/gpY
// SIG // 3UA8x1RtnWN0SCyxTkctwRQEcb9k+SS+c23Kjgm9swFX
// SIG // SVRk2XPXfx5bRAGOWhmRaw2fpCjcZxkoJLo4S5pu+yFU
// SIG // a2pFEUep8beuyOiJXk+d0tBMdrVXVAmxaQFEfnyhYWxz
// SIG // /gq77EFmPWn9y8FBSX5+k77L+DvktxW/tM4+pTFRhLy/
// SIG // AsGConsXHRWJjXD+57XQKBqJC4822rpM+Zv/Cuk0+CQ1
// SIG // ZyvgDbjmjJnW4SLq8CdCPSWU5nR0W2rRnj7tfqAxM328
// SIG // y+l7vzhwRNGQ8cirOoo6CGJ/2XBjU02N7oJtpQUQwXEG
// SIG // ahC0HVUzWLOhcGbyoYIDTTCCAjUCAQEwgfmhgdGkgc4w
// SIG // gcsxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpXYXNoaW5n
// SIG // dG9uMRAwDgYDVQQHEwdSZWRtb25kMR4wHAYDVQQKExVN
// SIG // aWNyb3NvZnQgQ29ycG9yYXRpb24xJTAjBgNVBAsTHE1p
// SIG // Y3Jvc29mdCBBbWVyaWNhIE9wZXJhdGlvbnMxJzAlBgNV
// SIG // BAsTHm5TaGllbGQgVFNTIEVTTjpEQzAwLTA1RTAtRDk0
// SIG // NzElMCMGA1UEAxMcTWljcm9zb2Z0IFRpbWUtU3RhbXAg
// SIG // U2VydmljZaIjCgEBMAcGBSsOAwIaAxUAza8UV/4s+rLN
// SIG // ZQQlxvD9SxcQ9HuggYMwgYCkfjB8MQswCQYDVQQGEwJV
// SIG // UzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMH
// SIG // UmVkbW9uZDEeMBwGA1UEChMVTWljcm9zb2Z0IENvcnBv
// SIG // cmF0aW9uMSYwJAYDVQQDEx1NaWNyb3NvZnQgVGltZS1T
// SIG // dGFtcCBQQ0EgMjAxMDANBgkqhkiG9w0BAQsFAAIFAOyt
// SIG // GxUwIhgPMjAyNTEwMjkyMzAwMzdaGA8yMDI1MTAzMDIz
// SIG // MDAzN1owdDA6BgorBgEEAYRZCgQBMSwwKjAKAgUA7K0b
// SIG // FQIBADAHAgEAAgIfMzAHAgEAAgIS4TAKAgUA7K5slQIB
// SIG // ADA2BgorBgEEAYRZCgQCMSgwJjAMBgorBgEEAYRZCgMC
// SIG // oAowCAIBAAIDB6EgoQowCAIBAAIDAYagMA0GCSqGSIb3
// SIG // DQEBCwUAA4IBAQBwWdTqymLF4A9xmNK7EB6NSU44GzQe
// SIG // 3YycbrIEcjE4eOpyW+0bnKBo2wBAM02W0XxbperG7QXJ
// SIG // 78fYZAJqMlM6UzsZeySgfgq4r3+AYE12m8BgFhB451BJ
// SIG // tmVaNVxKn6JEyi7xv2M+/BooLy8M2v5ln4vWZXGQuB3D
// SIG // rH8xT6rkZOT4iHGGE8LqMkxUsnUWrvTAZXqQDvOpWrw9
// SIG // hvoye1C8fKiE2tlUQQuW6nnDWQ2DUr3050uyvvopFQlY
// SIG // zr+7Ke8T9JsE42OiIgXmiyj3pOPIOsJt9rf/FCNDomON
// SIG // uujtbuoeMb7zB+s+zlnfDHHflWVEJ0KFswNA0PWwmWi+
// SIG // gEvmMYIEDTCCBAkCAQEwgZMwfDELMAkGA1UEBhMCVVMx
// SIG // EzARBgNVBAgTCldhc2hpbmd0b24xEDAOBgNVBAcTB1Jl
// SIG // ZG1vbmQxHjAcBgNVBAoTFU1pY3Jvc29mdCBDb3Jwb3Jh
// SIG // dGlvbjEmMCQGA1UEAxMdTWljcm9zb2Z0IFRpbWUtU3Rh
// SIG // bXAgUENBIDIwMTACEzMAAAIDux5cADhsdMoAAQAAAgMw
// SIG // DQYJYIZIAWUDBAIBBQCgggFKMBoGCSqGSIb3DQEJAzEN
// SIG // BgsqhkiG9w0BCRABBDAvBgkqhkiG9w0BCQQxIgQgkrhe
// SIG // aKpSgmS+o7b0KoPpBfBoCQi2Ms2MQG55unRUK2MwgfoG
// SIG // CyqGSIb3DQEJEAIvMYHqMIHnMIHkMIG9BCBLA90bcZb2
// SIG // k8RTmWZ6UMNA5LD5lXbqOUsivYfcPvoTLTCBmDCBgKR+
// SIG // MHwxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpXYXNoaW5n
// SIG // dG9uMRAwDgYDVQQHEwdSZWRtb25kMR4wHAYDVQQKExVN
// SIG // aWNyb3NvZnQgQ29ycG9yYXRpb24xJjAkBgNVBAMTHU1p
// SIG // Y3Jvc29mdCBUaW1lLVN0YW1wIFBDQSAyMDEwAhMzAAAC
// SIG // A7seXAA4bHTKAAEAAAIDMCIEIGbktW8yF+lyRHndaPQQ
// SIG // kGFXGicHvUQbA6D8pVdoqoh0MA0GCSqGSIb3DQEBCwUA
// SIG // BIICADgblJbaZ8pZQvIHuE9xA/eu+WRwqV5y/CB/HzpR
// SIG // kbLihTHfu2TqW7XvM4xLxhOaU5gocEBPVVMElbPTAfei
// SIG // q7khra2bj5yZ5WsUwQlW61bF594Wvbf1UcZ7VeQ15yHN
// SIG // WSWnr0ppToi9FQegrU1CUGVXGg7hEPInUZI32o4T5e5w
// SIG // f5L4lSX4TnF6+s2CjHs4jahEUAEkJxtwV3fqUn8WW2Ob
// SIG // GPiQi81fG37uioD84seOHNaBqZaMWKO4zaVIv9mxLBlL
// SIG // vTwAh2gEfwupuP826wqdCzU1tC9yBt7rL4y78f+RnRHH
// SIG // wiYPnimFSgIcday3T/IVw7PUpEAGnzz7f2XNo7H6bSGI
// SIG // NcnJoa1uUAfC3mEu9V8TWHL3auj/aYq2IYdti9qOHP6D
// SIG // pAnI8rYIlVdN48OnTjGFpx9LxUPJoTxMI+plCrnZIVXw
// SIG // 7Pf1iGDKd2i09EqEKwEbg/WMRz+YhMkwAvEbbreR87Bj
// SIG // tn9I4DxwB2XIxHSprrAgV/WaeULMoRlZxKAdhKoaqAYY
// SIG // VqEsYTxcmxG80XYMWM1+HSCNqzEL3+2S0/viI0pLyW46
// SIG // /VdzoLT0AzPIMaUq6HdXS559TAAULlw60LdMsv676Ujn
// SIG // xKQNc4W//ds2skirXI3WrZT/cfobKgIpjrVnCvogGpwb
// SIG // ttvqIM+agxiquWp3NZtE/h4dqhXL
// SIG // End signature block
